# arc_twitter v3.0-dev
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjc6
IjMuMC1kZXYiO3M6NjoiYXV0aG9yIjtzOjExOiJBbmR5IENhcnRlciI7czoxMDoiYXV0aG9y
X3VyaSI7czozMToiaHR0cDovL3JlZGhvdGNoaWxsaXByb2plY3QuY29tLyI7czoxMToiZGVz
Y3JpcHRpb24iO3M6NjA6IjxhIGhyZWY9Imh0dHA6Ly93d3cudHdpdHRlci5jb20iPlR3aXR0
ZXI8L2E+IGZvciBUZXh0cGF0dGVybiI7czo1OiJvcmRlciI7czoxOiI1IjtzOjQ6InR5cGUi
O3M6MToiMSI7czo1OiJmbGFncyI7czoxOiIzIjtzOjQ6ImhlbHAiO3M6MTY5OTE6Igk8aDEg
Y2xhc3M9InRpdGxlIj48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCAoYXJj
X3R3aXR0ZXIgZm9yIFRleHRwYXR0ZXJuKTwvaDE+CgoJPG9sPgoJCTxsaT48YSBocmVmPSIj
YXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2Fy
Y190d2l0dGVyX2luc3RhbGxhdGlvbiI+SW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxsYXRpb248
L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3RhZyI+VGhlIGFyY190d2l0
dGVyIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfc2VhcmNoX3Rh
ZyI+VGhlIGFyY190d2l0dGVyX3NlYXJjaCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0i
I2FyY190d2l0dGVyX3R3ZWV0X2J1dHRvbl90YWciPlRoZSBhcmNfdHdpdHRlcl90d2VldF9i
dXR0b24gdGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl9mb2xsb3df
YnV0dG9uX3RhZyI+VGhlIGFyY190d2l0dGVyX2ZvbGxvd19idXR0b24gdGFnPC9hPjwvbGk+
CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl90d2VldF91cmwiPlRoZSBhcmNfdHdpdHRl
cl90d2VldF91cmwgdGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl90
aW55dXJsIj5UaGUgYXJjX3R3aXR0ZXJfdGlueXVybCB0YWc8L2E+PC9saT4KCQk8bGk+PGEg
aHJlZj0iI2FyY190d2l0dGVyX2NhY2hpbmciPkNhY2hpbmc8L2E+PC9saT4KCQk8bGk+PGEg
aHJlZj0iI2FyY190d2l0dGVyX3ByZWZzIj5QcmVmZXJlbmNlczwvYT48L2xpPgoJCTxsaT48
YSBocmVmPSIjYXJjX3R3aXR0ZXJfYXJ0aWNsZSI+VHdlZXRpbmcgYXJ0aWNsZXM8L2E+PC9s
aT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX2FkbWluIj5UaGUgVHdpdHRlciB0YWI8
L2E+PC9saT4KCTwvb2w+CgoJPHA+PHNwYW4gY2xhc3M9ImNhcHMiPlRYUDwvc3Bhbj4gVHdl
ZXQgcHJvdmlkZXMgYWNjZXNzIHRvIHlvdXIgVHdpdHRlciBhY2NvdW50IHRocm91Z2ggYm90
aCB0aGUgYWRtaW4gaW50ZXJmYWNlIGFuZCB0aGUgcHVibGljIHNpZGUgb2YgeW91ciBzaXRl
LiBVcGRhdGUgVHdpdHRlciB3aGVuIHlvdSBwb3N0IGEgbmV3IGFydGljbGUgKHdpdGggYXJ0
aWNsZS1ieS1hcnRpY2xlIG9wdCBvdXQgb3B0aW9uKSwgdXBkYXRlIGFuZCB2aWV3IHlvdXIg
VHdpdHRlciBmZWVkIHRocm91Z2ggdGhlIGFkbWluIFR3aXR0ZXIgdGFiLCBhbmQgZGlzcGxh
eSBUd2l0dGVyIGZlZWRzIG9uIHlvdXIgc2l0ZS48L3A+CgoJPHA+UmVxdWlyZW1lbnRzOi08
L3A+CgoJPHVsPgoJCTxsaT5UZXh0cGF0dGVybiA0LjIrPC9saT4KCQk8bGk+PHNwYW4gY2xh
c3M9ImNhcHMiPlBIUDwvc3Bhbj4gNSBhbmQgY1VSTDwvbGk+Cgk8L3VsPgoKCTxoMiBjbGFz
cz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX2F1dGhvciI+QXV0aG9yPC9oMj4KCgk8cD48
YSBocmVmPSJodHRwOi8vcmVkaG90Y2hpbGxpcHJvamVjdC5jb20iPkFuZHkgQ2FydGVyPC9h
Pi4gRm9yIG90aGVyIFRleHRwYXR0ZXJuIHBsdWdpbnMgYnkgbWUgdmlzaXQgbXkgPGEgaHJl
Zj0iaHR0cDovL3JlZGhvdGNoaWxsaXByb2plY3QuY29tL3R4cCI+UGx1Z2lucyBwYWdlPC9h
Pi48L3A+CgoJPHA+VGhhbmtzIHRvIDxhIGhyZWY9Imh0dHA6Ly9tYW5mcmUubmV0LyI+TWlj
aGFlbCBNYW5mcmU8L2E+IGZvciBpbnNwaXJhdGlvbiBmb3IgdGhlIGFydGljbGUgdHdlZXQg
cGFydCBvZiB0aGlzIHBsdWdpbiBiYXNlZCBvbiBoaXMgPHNwYW4gY2xhc3M9InRhZyI+bWVt
X3R3aXR0ZXI8L3NwYW4+IHBsdWdpbi4gIEFkZGl0aW9uYWwgdGhhbmtzIHRvIHRoZSBncmVh
dCBUZXh0cGF0dGVybiBjb21tdW5pdHkgZm9yIGhlbHBpbmcgdG8gdGVzdCB0aGlzIHBsdWdp
biBhbmQgZm9yIHN1Z2dlc3RpbmcgbmV3IGZlYXR1cmVzLiBUaGUgT0F1dGggcGFydCBvZiB0
aGUgcGx1Z2luIGlzIHRoYW5rcyB0byA8YSBocmVmPSJodHRwOi8vdHdpdHRlci5jb20vYWJy
YWhhbSI+QWJyYWhhbSBXaWxsaWFtczwvYT4uPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIg
aWQ9ImFyY190d2l0dGVyX2luc3RhbGxhdGlvbiI+SW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxs
YXRpb248L2gyPgoKCTxwPlRvIGluc3RhbGwgZ28gdG8gdGhlICYjODIxNjtwbHVnaW5zJiM4
MjE3OyB0YWIgdW5kZXIgJiM4MjE2O2FkbWluJiM4MjE3OyBhbmQgcGFzdGUgdGhlIHBsdWdp
biBjb2RlIGludG8gdGhlICYjODIxNjtJbnN0YWxsIHBsdWdpbiYjODIxNzsgYm94LCAmIzgy
MTY7dXBsb2FkJiM4MjE3OyBhbmQgdGhlbiAmIzgyMTY7aW5zdGFsbCYjODIxNzsuIEZpbmFs
bHkgYWN0aXZhdGUgdGhlIHBsdWdpbi48L3A+CgoJPHA+QmVmb3JlIHlvdSBzdGFydCB1c2lu
ZyA8c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRlcjwvc3Bhbj4geW91IHdpbGwgbmVlZCB0
byBtYWtlIHN1cmUgdGhhdCB0aGUgY2FjaGUgZGlyZWN0b3J5IGlzIHdyaXRhYmxlLiBTZWUg
dGhlICYjODIxNjtDYWNoaW5nJiM4MjE3OyBzdWJzZWN0aW9uIGJlbG93IGZvciBmdXJ0aGVy
IGluZm9ybWF0aW9uLjwvcD4KCgk8cD48c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRlcjwv
c3Bhbj4gc2hvdWxkIG5vdyBiZSByZWFkeSBmb3IgdXNlIG9uIHRoZSBwdWJsaWMtc2lkZSBv
ZiB5b3VyIHNpdGUuPC9wPgoKCTxwPlRvIHVubG9jayB0aGUgYWRtaW4gZmVhdHVyZXMgb2Yg
dGhpcyBwbHVnaW4geW91IHdpbGwgbmVlZCB0byBhc3NvY2lhdGUgeW91ciBzaXRlIHdpdGgg
YSBUd2l0dGVyIGFjY291bnQgYnkgY29ubmVjdGluZyB0byBUd2l0dGVyIGZyb20gdGhlIHBs
dWdpbiYjODIxNztzIG9wdGlvbnMgc2NyZWVuLiBDbGljayBvbiB0aGUgbGluayB0byBjb25u
ZWN0IHRvIFR3aXR0ZXIsIHlvdSB3aWxsIGJlIGFza2VkIHRvIGxvZ2luIHRvIFR3aXR0ZXIs
IGNsaWNraW5nIHRoaXMgbGluayB3aWxsIHRlbXBvcmFyaWx5IHRha2UgeW91IHRvIHRoZSBU
d2l0dGVyIHNpdGUgd2hlcmUgeW91IHdpbGwgYmUgYXNrZWQgdG8gbG9naW4gYW5kIGFwcHJv
dmUgYWNjZXNzIGZvciA8c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCB0byBy
ZWFkIGFuZCB3cml0ZSB0byB5b3VyIFR3aXR0ZXIgYWNjb3VudC4gSWYgYWxsIGlzIHN1Y2Nl
c3NmdWwgeW91IHdpbGwgYmUgcmV0dXJuZWQgdG8gdGhlIG9wdGlvbnMgc2NyZWVuIGFuZCB5
b3VyIHVzZXIgbmFtZSB3aWxsIGFwcGVhci48L3A+CgoJPHA+QXQgYW55IHRpbWUgeW91IGNh
biBkaXNhc3NvY2lhdGUgeW91ciBUd2l0dGVyIGFjY291bnQgd2l0aCA8c3BhbiBjbGFzcz0i
Y2FwcyI+VFhQPC9zcGFuPiBUd2VldCB2aWEgeW91ciBUd2l0dGVyIGFjY291bnQgcHJlZmVy
ZW5jZXMgb24gdGhlIDxhIGhyZWY9Imh0dHA6Ly93d3cudHdpdHRlci5jb20iPlR3aXR0ZXIg
d2Vic2l0ZTwvYT4uPC9wPgoKCTxwPlRvIHVuaW5zdGFsbCA8c3BhbiBjbGFzcz0idGFnIj5h
cmNfdHdpdHRlcjwvc3Bhbj4gc2ltcGx5IGRlbGV0ZSB0aGUgcGx1Z2luIGZyb20gdGhlICYj
ODIxNjtQbHVnaW5zJiM4MjE3OyB0YWIuICBUaGlzIHdpbGwgcmVtb3ZlIHRoZSBwbHVnaW4g
Y29kZSwgZGVsZXRlIHJlbGF0ZWQgcHJlZmVyZW5jZXMgYW5kIGRyb3AgdGhlIDxzcGFuIGNs
YXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiB0YWJsZSBmcm9tIHlvdXIgVGV4dHBhdHRl
cm4gZGF0YWJhc2UuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVy
X3RhZyI+VGhlIGFyY190d2l0dGVyIHRhZzwvaDI+CgoJPGgzPlN5bnRheDwvaDM+CgoJPHA+
Jmx0O3R4cDphcmNfdHdpdHRlciB1c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDsgLyZn
dDs8L3A+CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmli
dXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJ
CQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD51c2VyPC90ZD4KCQkJ
PHRkPlR3aXR0ZXIgdXNlciBuYW1lPC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0ZXIgdXNl
cm5hbWU8L2VtPjwvdGQ+CgkJCTx0ZD51c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDs8
L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGltaXQ8L3RkPgoJCQk8dGQ+TWF4aW11bSBu
dW1iZXIgb2YgdHdlZXRzIHRvIGRpc3BsYXkgKG1heC4gMjAwKTwvdGQ+CgkJCTx0ZD4xMDwv
dGQ+CgkJCTx0ZD5saW1pdD0mcXVvdDsyNSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJ
CTx0ZD5kYXRlZm9ybWF0PC90ZD4KCQkJPHRkPkZvcm1hdCB0aGF0IHVwZGF0ZSBkYXRlcyB3
aWxsIGFwcGVhciBhczwvdGQ+CgkJCTx0ZD4gPGVtPkFyY2hpdmUgZGF0ZSBmb3JtYXQ8L2Vt
PjwvdGQ+CgkJCTx0ZD5kYXRlZm9ybWF0PSZxdW90OyViICVPZSwgJUk6JU0gJXAmcXVvdDs8
L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFiZWw8L3RkPgoJCQk8dGQ+TGFiZWwgZm9y
IHRoZSB0b3Agb2YgdGhlIGxpc3Q8L3RkPgoJCQk8dGQ+IDxlbT5ubyBsYWJlbDwvZW0+PC90
ZD4KCQkJPHRkPmxhYmVsPSZxdW90O015IFR3aXR0ZXIgdGltZWxpbmUmcXVvdDs8L3RkPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFiZWx0YWc8L3RkPgoJCQk8dGQ+SW5kZXBlbmRlbnQg
d3JhcHRhZyBmb3IgbGFiZWw8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJ
PHRkPmxhYmVsdGFnPSZxdW90O2gzJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRk
PmJyZWFrPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2Fw
cyI+SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyAod2l0aG91dCBicmFja2V0cyksIG9yIHN0cmlu
ZywgdXNlZCB0byBzZXBhcmF0ZSB0aGUgdXBkYXRlczwvdGQ+CgkJCTx0ZD5saTwvdGQ+CgkJ
CTx0ZD5icmVhaz0mcXVvdDticiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD53
cmFwdGFnPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2Fw
cyI+SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyB0byBiZSB1c2VkIGFzIHRoZSB3cmFwdGFnLCB3
aXRob3V0IGJyYWNrZXRzPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0
ZD53cmFwdGFnPSZxdW90O3VsJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNs
YXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+
Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGZvciB3cmFwdGFnPC90ZD4KCQkJ
PHRkPmFyY190d2l0dGVyPC90ZD4KCQkJPHRkPmNsYXNzPSZxdW90O3R3aXR0ZXImcXVvdDs8
L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3NfcG9zdGVkPC90ZD4KCQkJPHRkPjxz
cGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4g
Y2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gc3BhbiB0YWcgYXJvdW5kIHBvc3RlZCBkYXRl
PC90ZD4KCQkJPHRkPmFyY190d2l0dGVyLXBvc3RlZDwvdGQ+CgkJPC90cj4KCTwvdGFibGU+
CgoJPGgzPkV4YW1wbGUgdXNhZ2U8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXIgdXNl
cj0mcXVvdDtkcm1vbmtleW5pbmphJnF1b3Q7IGxpbWl0PSZxdW90OzUmcXVvdDsgd3JhcHRh
Zz0mcXVvdDt1bCZxdW90OyBicmVhaz0mcXVvdDtsaSZxdW90OyBkYXRlZm9ybWF0PSZxdW90
OyViICVPZSwgJUk6JU0gJXAmcXVvdDsgLyZndDs8L3A+CgoJPHA+UHJvZHVjZXMgYSBidWxs
ZXQgcG9pbnQgbGlzdCBvZiB0aGUgbGFzdCA1IFR3aXR0ZXIgdXBkYXRlcyBmcm9tIGRybW9u
a2V5bmluamEmIzgyMTc7cyBUd2l0dGVyIGZlZWQgd2l0aCBhIGRlZmluZWQgZGF0ZSBmb3Jt
YXQgdG8gb3ZlcnJpZGUgdGhlIGRlZmF1bHQgYXJjaGl2ZSBkYXRlIGZvcm1hdC48L3A+CgoJ
PGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfc2VhcmNoX3RhZyI+VGhlIGFy
Y190d2l0dGVyX3NlYXJjaCB0YWc8L2gyPgoKCTxoMz5TeW50YXg8L2gzPgoKCTxwPiZsdDt0
eHA6YXJjX3R3aXR0ZXJfc2VhcmNoIGhhc2h0YWdzPSZxdW90O3R4cCZxdW90OyAvJmd0Ozwv
cD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8
L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0
aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnNlYXJjaDwvdGQ+CgkJCTx0
ZD5Db21tYSBzZXBhcmF0ZWQgbGlzdCBvZiBzZWFyY2ggd29yZHM8L3RkPgoJCQk8dGQ+IDxl
bT51bnNldDwvZW0+PC90ZD4KCQkJPHRkPnNlYXJjaD0mcXVvdDt0eHAsdGV4dHBhdHRlcm4m
cXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aGFzaHRhZ3M8L3RkPgoJCQk8dGQ+
Q29tbWEgc2VwYXJhdGVkIGxpc3Qgb2YgaGFzaHRhZ3MgdG8gc2VhcmNoIGZvciAobm90IGlu
Y2x1ZGluZyB0aGUgaGFzaCk8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJ
PHRkPmhhc2h0YWdzPSZxdW90O3R4cCx0ZXh0cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4K
CQk8dHI+CgkJCTx0ZD5yZXBseTwvdGQ+CgkJCTx0ZD5Vc2VybmFtZSBvZiB0d2VldHMgaW4g
cmVwbHkgdG88L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJPHRkPnJlcGx5
PSZxdW90O3R3aXR0ZXImcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bWVudGlv
bjwvdGQ+CgkJCTx0ZD5Vc2VybmFtZSBvZiB1c2VyIG1lbnRpb25lZCBpbiB0d2VldHMgKDxp
PmkuZS48L2k+IHR3ZWV0cyBjb250YWluaW5nIEB1c2VybmFtZSk8L3RkPgoJCQk8dGQ+IDxl
bT51bnNldDwvZW0+PC90ZD4KCQkJPHRkPm1lbnRpb249JnF1b3Q7dHdpdHRlciZxdW90Ozwv
dGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5saW1pdDwvdGQ+CgkJCTx0ZD5NYXhpbXVtIG51
bWJlciBvZiB0d2VldHMgdG8gZGlzcGxheSAobWF4LiAyMDApPC90ZD4KCQkJPHRkPjEwPC90
ZD4KCQkJPHRkPmxpbWl0PSZxdW90OzI1JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJ
PHRkPmRhdGVmb3JtYXQ8L3RkPgoJCQk8dGQ+Rm9ybWF0IHRoYXQgdXBkYXRlIGRhdGVzIHdp
bGwgYXBwZWFyIGFzPC90ZD4KCQkJPHRkPiA8ZW0+QXJjaGl2ZSBkYXRlIGZvcm1hdDwvZW0+
PC90ZD4KCQkJPHRkPmRhdGVmb3JtYXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAlcCZxdW90Ozwv
dGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbDwvdGQ+CgkJCTx0ZD5MYWJlbCBmb3Ig
dGhlIHRvcCBvZiB0aGUgbGlzdDwvdGQ+CgkJCTx0ZD4gPGVtPm5vIGxhYmVsPC9lbT48L3Rk
PgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFiZWx0YWc8L3RkPgoJCQk8dGQ+SW5kZXBlbmRl
bnQgd3JhcHRhZyBmb3IgbGFiZWw8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPmJyZWFrPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJj
YXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyAod2l0aG91
dCBicmFja2V0cyksIG9yIHN0cmluZywgdXNlZCB0byBzZXBhcmF0ZSB0aGUgdXBkYXRlczwv
dGQ+CgkJCTx0ZD5saTwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD53cmFwdGFnPC90ZD4K
CQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+SFRNTDwvc3Bh
bj48L3NwYW4+IHRhZyB0byBiZSB1c2VkIGFzIHRoZSB3cmFwdGFnLCB3aXRob3V0IGJyYWNr
ZXRzPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJ
CTx0ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9
ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBmb3Igd3JhcHRhZzwv
dGQ+CgkJCTx0ZD5hcmNfdHdpdHRlcl9zZWFyY2g8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8
dGQ+Y2xhc3NfdXNlcjwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xh
c3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRv
IHNwYW4gdGFnIGFyb3VuZCB1c2VyIG5hbWU8L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXItdXNl
cjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzc19wb3N0ZWQ8L3RkPgoJCQk8dGQ+
PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFu
PiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byBzcGFuIHRhZyBhcm91bmQgcG9zdGVkIGRh
dGU8L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXItcG9zdGVkPC90ZD4KCQk8L3RyPgoJPC90YWJs
ZT4KCgk8aDM+RXhhbXBsZSB1c2FnZTwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl9z
ZWFyY2ggc2VhcmNoPSZxdW90O3BsdWdpbiZxdW90OyBoYXNodGFncz0mcXVvdDt0eHAsdGV4
dHBhdHRlcm4mcXVvdDsgbGltaXQ9JnF1b3Q7MjUmcXVvdDsgLyZndDs8L3A+CgoJPHA+UHJv
ZHVjZXMgYSBsaXN0IG9mIHR3ZWV0cyBjb250YWluaW5nIHRoZSB3b3JkICYjODIxNjtwbHVn
aW4mIzgyMTc7IGFuZCB0aGUgaGFzaHRhZ3MgJiM4MjE2OyN0eHAmIzgyMTc7IGFuZCAmIzgy
MTY7I3RleHRwYXR0ZXJuJiM4MjE3Oy4gVGhlIHRhZyB3aWxsIHJldHVybiBhIG1heGltdW0g
b2YgMjUgdHdlZXRzLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRl
cl9yZXR3ZWV0X3RhZyI+VGhlIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbiB0YWc8L2gyPgoK
CTxwPk91dHB1dHMgdGhlIFR3aXR0ZXIgdHdlZXQgYnV0dG9uIChmb3JtZXJseSAmbHQ7dHhw
OmFyY190d2l0dGVyX3JldHdlZXQgLyZndDspLjwvcD4KCgk8aDM+U3ludGF4PC9oMz4KCgk8
cD4mbHQ7dHhwOmFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbiAvJmd0OzwvcD4KCgk8aDM+VXNh
Z2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+
RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90
aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVzZXI8L3RkPgoJCQk8dGQ+VHdpdHRlciB1c2Vy
IG5hbWUgdG8gcXVvdGU8L3RkPgoJCQk8dGQ+IDxlbT5hcmNfdHdpdHRlciB1c2VybmFtZTwv
ZW0+PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZxdW90OzwvdGQ+CgkJ
PC90cj4KCQk8dHI+CgkJCTx0ZD51cmw8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMi
PjxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+PC9zcGFuPiB0byB0d2VldDwvdGQ+CgkJ
PC90cj4KCQk8dHI+CgkJCTx0ZD50ZXh0PC90ZD4KCQkJPHRkPlR3ZWV0IHRleHQ8L3RkPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+Zm9sbG93MTwvdGQ+CgkJCTx0ZD5TdWdnZXN0ZWQgVHdp
dHRlciBhY2NvdW50IHRvIGZvbGxvdywgZm9yIGV4YW1wbGUgeW91ciBvd248L3RkPgoJCQk8
dGQ+QSBUd2l0dGVyIHVzZXIgdG8gcmVjb21tZW5kPC90ZD4KCQkJPHRkPmZvbGxvdzE9JnF1
b3Q7VGV4dHBhdHRlcm4mcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Zm9sbG93
MjwvdGQ+CgkJCTx0ZD5BcyBmb2xsb3cxPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwv
dGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYW5nPC90ZD4KCQkJPHRkPkxhbmd1YWdlPC90
ZD4KCQkJPHRkPmVuPC90ZD4KCQkJPHRkPmxhbmc9JnF1b3Q7ZXMmcXVvdDs8L3RkPgoJCTwv
dHI+CgkJPHRyPgoJCQk8dGQ+Y291bnQ8L3RkPgoJCQk8dGQ+Q291bnQgYm94IHBvc2l0aW9u
LCBvcHRpb25zOiBub25lLCBob3Jpem9udGFsIG9yIHZlcnRpY2FsPC90ZD4KCQkJPHRkPmhv
cml6b250YWw8L3RkPgoJCQk8dGQ+Y291bnQ9JnF1b3Q7bm9uZSZxdW90OzwvdGQ+CgkJPC90
cj4KCQk8dHI+CgkJCTx0ZD5pbmNsdWRlX2pzPC90ZD4KCQkJPHRkPldoZXRoZXIgb3Igbm90
IHRvIGluY2x1ZGUgdGhlIHdpZGdldCBKYXZhU2NyaXB0PC90ZD4KCQkJPHRkPjE8L3RkPgoJ
CQk8dGQ+aW5jbHVkZV9qcz0mcXVvdDswJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJ
PHRkPm9wdGltaXNlX2pzPC90ZD4KCQkJPHRkPk9wdGltaXNlIHRoZSBKYXZhU2NyaXB0IGJ5
IHVzaW5nIGEgbG9jYWwgc2NyaXB0IHJhdGhlciB0aGFuIHRoYXQgaG9zdGVkIG9uIHRoZSBU
d2l0dGVyIHNpdGU8L3RkPgoJCQk8dGQ+MDwvdGQ+CgkJCTx0ZD5vcHRpbWlzZV9qcz0mcXVv
dDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRk
PjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bh
bj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gdGhlIHR3ZWV0IGJ1dHRvbjwvdGQ+CgkJ
CTx0ZD50d2l0dGVyLXNoYXJlLWJ1dHRvbjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPGgy
IGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfZm9sbG93X2J1dHRvbl90YWciPlRo
ZSBhcmNfdHdpdHRlcl9mb2xsb3dfYnV0dG9uIHRhZzwvaDI+CgoJPHA+T3V0cHV0cyB0aGUg
VHdpdHRlciBmb2xsb3cgYnV0dG9uIChhbiBhbHRlcm5hdGl2ZSB2ZXJzaW9uIGlzIGluY2x1
ZGVkIGluIGFyY190d2l0dGVyX2ludGVudHMpLjwvcD4KCgk8aDM+U3ludGF4PC9oMz4KCgk8
cD4mbHQ7dHhwOmFyY190d2l0dGVyX2ZvbGxvd19idXR0b24gLyZndDs8L3A+CgoJPGgzPlVz
YWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJPHRo
PkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBsZTwv
dGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD51c2VyPC90ZD4KCQkJPHRkPlR3aXR0ZXIgdXNl
ciBuYW1lIHRvIGZvbGxvdzwvdGQ+CgkJCTx0ZD4gPGVtPmFyY190d2l0dGVyIHVzZXJuYW1l
PC9lbT48L3RkPgoJCQk8dGQ+dXNlcj0mcXVvdDtkcm1vbmtleW5pbmphJnF1b3Q7PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhbmc8L3RkPgoJCQk8dGQ+TGFuZ3VhZ2U8L3RkPgoJ
CQk8dGQ+ZW48L3RkPgoJCQk8dGQ+bGFuZz0mcXVvdDtlcyZxdW90OzwvdGQ+CgkJPC90cj4K
CQk8dHI+CgkJCTx0ZD5jb3VudDwvdGQ+CgkJCTx0ZD5XaGV0aGVyIG9yIG5vdCB0aGUgZm9s
bG93ZXIgY291bnQgaXMgc2hvd248L3RkPgoJCQk8dGQ+MTwvdGQ+CgkJCTx0ZD5jb3VudD0m
cXVvdDswJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmluY2x1ZGVfanM8L3Rk
PgoJCQk8dGQ+V2hldGhlciBvciBub3QgdG8gaW5jbHVkZSB0aGUgd2lkZ2V0IEphdmFTY3Jp
cHQ8L3RkPgoJCQk8dGQ+MTwvdGQ+CgkJCTx0ZD5pbmNsdWRlX2pzPSZxdW90OzAmcXVvdDs8
L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+b3B0aW1pc2VfanM8L3RkPgoJCQk8dGQ+T3B0
aW1pc2UgdGhlIEphdmFTY3JpcHQgYnkgdXNpbmcgYSBsb2NhbCBzY3JpcHQgcmF0aGVyIHRo
YW4gdGhhdCBob3N0ZWQgb24gdGhlIFR3aXR0ZXIgc2l0ZTwvdGQ+CgkJCTx0ZD4wPC90ZD4K
CQkJPHRkPm9wdGltaXNlX2pzPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJ
CQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNz
PSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byB0
aGUgZm9sbG93IGJ1dHRvbjwvdGQ+CgkJCTx0ZD50d2l0dGVyLWZvbGxvdy1idXR0b248L3Rk
PgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0
dGVyX3R3ZWV0X3VybCI+YXJjX3R3aXR0ZXJfdHdlZXRfdXJsPC9oMj4KCgk8cD5SZXR1cm5z
IHRoZSA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPiBvZiB0aGUgVHdpdHRlciBzdGF0
dXMgZm9yIGFuIGFydGljbGUuPC9wPgoKCTxoMz5TeW50YXg8L2gzPgoKCTxwPiZsdDt0eHA6
YXJjX3R3aXR0ZXJfdHdlZXRfdXJsIC8mZ3Q7PC9wPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0
ZXJfdHdlZXRfdXJsJmd0O0xpbmsgdGV4dCZsdDsvdHhwOmFyY190d2l0dGVyX3R3ZWV0X3Vy
bCZndDs8L3A+CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0
cmlidXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3Ro
PgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5pZDwvdGQ+CgkJ
CTx0ZD5UZXh0cGF0dGVybiBhcnRpY2xlIElEPC90ZD4KCQkJPHRkPiA8ZW0+Y3VycmVudCBh
cnRpY2xlPC9lbT48L3RkPgoJCQk8dGQ+aWQ9JnF1b3Q7MSZxdW90OzwvdGQ+CgkJPC90cj4K
CQk8dHI+CgkJCTx0ZD50aXRsZTwvdGQ+CgkJCTx0ZD5UaXRsZSBhdHRyaWJ1dGUgb2YgdGhl
IGxpbms8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4K
CQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFz
cz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8g
dGhlIGxpbms8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJPC90
YWJsZT4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl90aW55dXJsIj5h
cmNfdHdpdHRlcl90aW55dXJsPC9oMj4KCgk8cD5SZXR1cm5zIHRoZSBzaG9ydGVuZWQgPHNw
YW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4gb2YgdGhlIGFydGljbGUgdXNlZCBmb3IgdGhl
IFR3aXR0ZXIgdXBkYXRlLjwvcD4KCgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFy
Y190d2l0dGVyX3Rpbnl1cmwgLyZndDs8L3A+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl90
aW55dXJsJmd0O0xpbmsgdGV4dCZsdDsvdHhwOmFyY190d2l0dGVyX3Rpbnl1cmwmZ3Q7PC9w
PgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwv
dGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRo
PkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aWQ8L3RkPgoJCQk8dGQ+VGV4
dHBhdHRlcm4gYXJ0aWNsZSBJRDwvdGQ+CgkJCTx0ZD4gPGVtPmN1cnJlbnQgYXJ0aWNsZTwv
ZW0+PC90ZD4KCQkJPHRkPmlkPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJ
CQk8dGQ+dGl0bGU8L3RkPgoJCQk8dGQ+VGl0bGUgYXR0cmlidXRlIG9mIHRoZSBsaW5rPC90
ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5j
bGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMi
PkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHRoZSBsaW5r
PC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJ
PGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfY2FjaGluZyI+Q2FjaGluZzwv
aDI+CgoJPHA+SW4gb3JkZXIgdG8gcHJldmVudCBleGNlc3NpdmUgcmVwZWF0aXRpdmUgY2Fs
bHMgdG8gdGhlIFR3aXR0ZXIgd2Vic2l0ZSBpdCBpcyByZWNvbW1lbmRlZCB0byBjYWNoZSBy
ZXN1bHRzLiBUd2l0dGVyIGxpbWl0cyB0aGUgbnVtYmVyIG9mIGNhbGxzIHRocm91Z2ggdGhl
IDxzcGFuIGNsYXNzPSJjYXBzIj5BUEk8L3NwYW4+LCBhbmQgY29udGludW91cyBjYWxscyB3
aWxsIHJlc3VsdCBpbiBUd2l0dGVyIGNsb3NpbmcgdG8gZnVydGhlciByZXF1ZXN0cy4gQnkg
ZGVmYXVsdCwgYXJjX3R3aXR0ZXIgY2FjaGVzIGZvciAzMCBtaW51dGUgaW50ZXJ2YWxzLjwv
cD4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJPHRoPkRlc2Ny
aXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJ
PC90cj4KCQk8dHI+CgkJCTx0ZD5jYWNoaW5nPC90ZD4KCQkJPHRkPiYjODIxNjsxJiM4MjE3
OyB0byBjYWNoZSBmZWVkLCAmIzgyMTY7MCYjODIxNzsgdG8gdHVybiBjYWNoaW5nIG9mZiAo
bm90IHJlY29tbWVuZGVkKTwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQkJPHRkPmNhY2hpbmc9JnF1
b3Q7MSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jYWNoZV9kaXI8L3RkPgoJ
CQk8dGQ+QWJzb2x1dGUgcGF0aCB0byB0aGUgY2FjaGUgZGlyZWN0b3J5IChtdXN0IGJlIHdy
aXRhYmxlKTwvdGQ+CgkJCTx0ZD4gPGVtPmFyY190d2l0dGVyIHByZWZlcmVuY2VzPC9lbT48
L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2FjaGVfdGltZTwvdGQ+CgkJCTx0ZD5UaW1l
IGluIG1pbnV0ZXMgdGhhdCB0aGUgY2FjaGUgZmlsZXMgYXJlIHN0b3JlZCBiZWZvcmUgYmVp
bmcgcmVmcmVzaGVkPC90ZD4KCQkJPHRkPjU8L3RkPgoJCQk8dGQ+Y2FjaGVfdGltZT0mcXVv
dDszMCZxdW90OzwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPHA+VGhlIGFkbWluIHNpZGUg
b2YgdGhpcyBwbHVnaW4gZW5mb3JjZXMgY2FjaGluZywgYXBhcnQgZnJvbSB3aGVuIGl0IGlz
IHBvc3RpbmcgdG8gVHdpdHRlciAoPGk+ZS5nLjwvaT4gd2hlbiBwb3N0aW5nIG9yIGRlbGV0
aW5nIGFuIHVwZGF0ZSkuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0
dGVyX3ByZWZzIj5QcmVmZXJlbmNlczwvaDI+CgoJPHA+WW91IGNhbiBhY2Nlc3MgdGhlIHBs
dWdpbnMgY29yZSBwcmVmZXJlbmNlcyBmcm9tIGVpdGhlciB0aGUgUHJlZmVyZW5jZXMgb3Ig
UGx1Z2lucyB0YWJzIGluIGFkbWluLiBTZXR1cCB5b3VyIFR3aXR0ZXIgYWNjb3VudCAoeW91
IHdpbGwgYmUgYXNrZWQgdG8gY29ubmVjdCB2aWEgVHdpdHRlciBhbmQgdGhpcyBuZWVkcyBk
b2luZyBiZWZvcmUgeW91IGNhbiB1c2UgdGhlIHBsdWdpbikgYW5kIGNoYW5nZSB0aGUgY2Fj
aGUgZGlyZWN0b3J5IHVzaW5nIGFyY190d2l0dGVyJiM4MjE3O3MgcHJlZmVyZW5jZXMuIFdp
dGhvdXQgcHJvdmlkaW5nIHlvdXIgYWNjb3VudCBsb2dpbiBkZXRhaWxzIHRoZSBhZG1pbiBh
cmVhIGZlYXR1cmVzIG9mIHRoaXMgcGx1Z2luIHdpbGwgYmUgaW5hY3RpdmUuPC9wPgoKCTxw
PllvdSBjYW4gc2VsZWN0IHRoZSA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPiBzaG9y
dGVuZXIgbWV0aG9kIHlvdSB3YW50IHRvIHVzZSB0byBsaW5rIGJhY2sgdG8geW91ciBhcnRp
Y2xlIG9uIFR3aXR0ZXIuIFBsZWFzZSBub3RlIHRoYXQgaWYgeW91IHNlbGVjdCBzbWRfc2hv
cnRfdXJsIHlvdSB3aWxsIG5lZWQgdG8gaGF2ZSBpbnN0YWxsZWQgYW5kIGFjdGl2YXRlZCB0
aGUgPGEgaHJlZj0iaHR0cDovL3RleHRwYXR0ZXJuLm9yZy9wbHVnaW5zLzEwOTkvc21kX3No
b3J0X3VybCI+PHNwYW4gY2xhc3M9InRhZyI+c21kX3Nob3J0X3VybDwvc3Bhbj4gcGx1Z2lu
PC9hPiBkZXZlbG9wZWQgYnkgU3RlZiBEYXdzb24uPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlv
biIgaWQ9ImFyY190d2l0dGVyX2FydGljbGUiPlR3ZWV0aW5nIGFydGljbGVzPC9oMj4KCgk8
cD5CeSBkZWZhdWx0IGFyY190d2l0dGVyIHdpbGwgcG9zdCBhbiB1cGRhdGUgdG8gVHdpdHRl
ciBpbmNsdWRpbmcgYSBzaG9ydGVuZWQgPHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4g
dG8geW91ciBhcnRpY2xlLiBPbmx5IGxpdmUgYW5kIGFjdGl2ZSBhcnRpY2xlcyB3aWxsIGJl
IHNlbnQgdG8gVHdpdHRlciwgPGk+aS5lLjwvaT4gYXJ0aWNsZXMgcG9zdGVkIGluIHRoZSBm
dXR1cmUgb3IgYXMgc3RpY2t5IGFydGljbGVzIHdpbGwgbm90IGJlIHNlbnQuIElmIHlvdXIg
YXJ0aWNsZSBpcyBzdWNjZXNzZnVsbHkgc3VibWl0dGVkIHRvIFR3aXR0ZXIgdGhlIHVwZGF0
ZSB3aWxsIGFwcGVhciBpbiBwbGFjZSBvZiB0aGUgVHdpdHRlciBvcHRpb24gb24gdGhlIHJp
Z2h0LWhhbmQtc2lkZSBvZiB0aGUgYXJ0aWNsZSBlZGl0IHNjcmVlbi48L3A+CgoJPHA+VHdl
ZXRzIGFyZSBzZW50IGluIHRoZSBmb2xsb3dpbmcgZm9ybWF0OiA8ZW0+VHdlZXQgcHJlZml4
PC9lbT4gPGVtPkFydGljbGUgdGl0bGU8L2VtPiA8ZW0+U2hvcnRlbmVkIDxzcGFuIGNsYXNz
PSJjYXBzIj5VUkw8L3NwYW4+PC9lbT4gPGVtPlR3ZWV0IHN1ZmZpeDwvZW0+LiBZb3UgY2Fu
IGNoYW5nZSB0aGUgcHJlZml4IGFuZCBzdWZmaXggb24gYW4gYXJ0aWNsZS1ieS1hcnRpY2xl
IGJhc2lzIGJ5IGNoYW5naW5nIHRoZSB0d2VldCBvcHRpb25zIHVuZGVyICYjODIxNjtVcGRh
dGUgVHdpdHRlciYjODIxNzsgb24gdGhlIGFydGljbGUgZWRpdG9yIHNjcmVlbi4gVGhlIGRl
ZmF1bHQgPGVtPlR3ZWV0IHByZWZpeDwvZW0+IGNhbiBiZSBzZXQgdW5kZXIgdGhlIDxzcGFu
IGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiBwcmVmZXJlbmNlcyBzY3JlZW4gKHRo
ZSBkZWZhdWx0IG9uIGluc3RhbGxhdGlvbiBpcyAmIzgyMjA7SnVzdCBwb3N0ZWQ6JiM4MjIx
OykuPC9wPgoKCTxwPlBsZWFzZSBub3RlIHRoYXQgb25jZSBhbiBhcnRpY2xlIGhhcyBiZWVu
IHR3ZWV0ZWQgdGhlIHR3ZWV0IGNhbm5vdCBiZSBlZGl0ZWQuPC9wPgoKCTxoMiBjbGFzcz0i
c2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX2FkbWluIj5UaGUgVHdpdHRlciB0YWI8L2gyPgoK
CTxwPlVuZGVyIHRoZSBFeHRlbnNpb25zIHRhYiAodGhpcyBjYW4gYmUgY2hhbmdlZCBmcm9t
IHRoZSBwbHVnaW4mIzgyMTc7cyBwcmVmZXJlbmNlIHBhZ2UpIGEgbmV3IFR3aXR0ZXIgdGFi
IHNob3VsZCBhcHBlYXIgb25jZSB5b3UgaGF2ZSBjb25uZWN0ZWQgeW91ciBzaXRlIHRvIHlv
dXIgVHdpdHRlciBhY2NvdW50LiBGcm9tIGhlcmUgeW91IHdpbGwgYmUgYWJsZSB0byBzdWJt
aXQgbmV3IFR3aXR0ZXIgdXBkYXRlcywgdmlldyBiYXNpYyBhY2NvdW50IHN0YXRpc3RpY3Ms
IGFuZCBjaGVjayBvdXQgeW91ciByZWNlbnQgdXBkYXRlcyAoaW5jbHVkaW5nIHRoZSBvcHRp
b24gdG8gZGVsZXRlIHlvdXIgdHdlZXRzKS48L3A+IjtzOjQ6ImNvZGUiO3M6NzQ4MTA6Imds
b2JhbCAkcHJlZnMsJHR4cGNmZywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksJGFyY190d2l0
dGVyX2NvbnN1bWVyU2VjcmV0OwoKJGFyY190d2l0dGVyID0gYXJyYXkoKTsKCiRhcmNfdHdp
dHRlcl9jb25zdW1lcktleSA9ICduS2NYc2x3elpoQmQwa2ZLTWV0blBBJzsKJGFyY190d2l0
dGVyX2NvbnN1bWVyU2VjcmV0ID0gJ0M2blNQQ0wzZWVIR1RCaEtDZ3dkOW9jbGN1RDBzckI4
V1ZrZlhRWUM1NCc7CgphZGRfcHJpdnMoJ3BsdWdpbl9wcmVmcy5hcmNfdHdpdHRlcicsJzEs
MicpOwpyZWdpc3Rlcl9jYWxsYmFjaygnYXJjX3R3aXR0ZXJfaW5zdGFsbCcsJ3BsdWdpbl9s
aWZlY3ljbGUuYXJjX3R3aXR0ZXInLCAnaW5zdGFsbGVkJyk7CnJlZ2lzdGVyX2NhbGxiYWNr
KCdhcmNfdHdpdHRlcl91bmluc3RhbGwnLCdwbHVnaW5fbGlmZWN5Y2xlLmFyY190d2l0dGVy
JywgJ2RlbGV0ZWQnKTsKcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY190d2l0dGVyX3ByZWZzJywn
cGx1Z2luX3ByZWZzLmFyY190d2l0dGVyJyk7CgovKgogKiBTZXR1cCBpbml0aWFsIHByZWZl
cmVuY2VzIGlmIG5vdCBpbiB0aGUgdHhwX3ByZWZzIHRhYmxlLgogKi8KaWYgKCFpc3NldCgk
cHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSkpCiAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJf
dXNlcicsICcnLCAnYXJjX3R3aXR0ZXInLCAxLCAndGV4dF9pbnB1dCcpOwppZiAoIWlzc2V0
KCRwcmVmc1snYXJjX3R3aXR0ZXJfcHJlZml4J10pKQogIHNldF9wcmVmKCdhcmNfdHdpdHRl
cl9wcmVmaXgnLCdKdXN0IHBvc3RlZDonLCAnYXJjX3R3aXR0ZXInLCAyLCAndGV4dF9pbnB1
dCcpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10pKQogIHNl
dF9wcmVmKCdhcmNfdHdpdHRlcl9jYWNoZV9kaXInLCR0eHBjZmdbJ3R4cGF0aCddLiRwcmVm
c1sndGVtcGRpciddLCAnYXJjX3R3aXR0ZXInLCAxLCAndGV4dF9pbnB1dCcpOwppZiAoIWlz
c2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCddKSkKICBzZXRfcHJlZign
YXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcsIDEsICdhcmNfdHdpdHRlcicsIDIsICd5ZXNu
b1JhZGlvJyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl91cmxfbWV0aG9kJ10p
KQogIHNldF9wcmVmKCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJywgJ3Rpbnl1cmwnLCAnYXJj
X3R3aXR0ZXInLCAyLAogICAgJ2FyY190d2l0dGVyX3VybF9tZXRob2Rfc2VsZWN0Jyk7Cmlm
ICghaXNzZXQoJHByZWZzWydhcmNfc2hvcnRfdXJsJ10pKQogIHNldF9wcmVmKCdhcmNfc2hv
cnRfdXJsJywgMCwgJ2FyY190d2l0dGVyJywgMiwgJ3llc25vUmFkaW8nKTsKaWYgKCFpc3Nl
dCgkcHJlZnNbJ2FyY19zaG9ydF9zaXRlX3VybCddKSkKICBzZXRfcHJlZignYXJjX3Nob3J0
X3NpdGVfdXJsJywgJHByZWZzWydzaXRldXJsJ10sICdhcmNfdHdpdHRlcicsIDIsICd0ZXh0
X2lucHV0Jyk7Ci8vIE1ha2Ugc3VyZSB0aGF0IHRoZSBUd2l0dGVyIHRhYiBoYXMgYmVlbiBk
ZWZpbmVkCmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl90YWInXSkpIHsKICBzZXRf
cHJlZignYXJjX3R3aXR0ZXJfdGFiJywgJ2V4dGVuc2lvbnMnLCAnYXJjX3R3aXR0ZXInLCAy
LAogICAgJ2FyY190d2l0dGVyX3RhYl9zZWxlY3QnKTsKICAgICRwcmVmc1snYXJjX3R3aXR0
ZXJfdGFiJ10gPSAnZXh0ZW5zaW9ucyc7Cn0KCi8vIENoZWNrIGlmIGFyY19zaG9ydF91cmwg
aXMgZW5hYmxlZAppZiAoJHByZWZzWydhcmNfc2hvcnRfdXJsJ10gfHwgJHByZWZzWydhcmNf
dHdpdHRlcl91cmxfbWV0aG9kJ109PSdhcmNfdHdpdHRlcicpIHsKICByZWdpc3Rlcl9jYWxs
YmFjaygnYXJjX3Nob3J0X3VybF9yZWRpcmVjdCcsICd0eHBfZGllJywgNDA0KTsKfQoKaWYg
KEB0eHBpbnRlcmZhY2UgPT0gJ2FkbWluJykgewogICAgaWYgKCFlbXB0eSgkcHJlZnNbJ2Fy
Y190d2l0dGVyX3VzZXInXSkKICAgICAgICAmJiAhZW1wdHkoJHByZWZzWydhcmNfdHdpdHRl
cl9hY2Nlc3NUb2tlbiddKQogICAgICAgICYmICFlbXB0eSgkcHJlZnNbJ2FyY190d2l0dGVy
X2FjY2Vzc1Rva2VuU2VjcmV0J10pICkgewoKICAgICAgICBpZiAoJHByZWZzWydhcmNfdHdp
dHRlcl90YWInXSkgewogICAgICAgICAgICBhZGRfcHJpdnMoJ2FyY19hZG1pbl90d2l0dGVy
JywgJzEsMiwzLDQnKTsKICAgICAgICAgICAgcmVnaXN0ZXJfdGFiKCRwcmVmc1snYXJjX3R3
aXR0ZXJfdGFiJ10sICdhcmNfYWRtaW5fdHdpdHRlcicsICdUd2l0dGVyJyk7CiAgICAgICAg
ICAgIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYWRtaW5fdHdpdHRlcicsICdhcmNfYWRtaW5f
dHdpdHRlcicpOwogICAgICAgIH0KCiAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19h
cnRpY2xlX3R3ZWV0JywgJ3BpbmcnKTsKICAgICAgICByZWdpc3Rlcl9jYWxsYmFjaygnYXJj
X2FydGljbGVfdHdlZXQnLCAnYXJ0aWNsZScsICdlZGl0JywgMSk7CiAgICAgICAgcmVnaXN0
ZXJfY2FsbGJhY2soJ2FyY19hcHBlbmRfdHdpdHRlcicsICdhcnRpY2xlX3VpJywgJ3N0YXR1
cycpOwogICAgfQp9CgovKgogICAgUHVibGljLXNpZGUgZnVuY3Rpb25zCiAgICA9PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09CiovCgpmdW5jdGlvbiBhcmNfdHdpdHRlcigkYXR0cykKewogIGdsb2JhbCAkcHJlZnMs
JGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7
CgogIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAndXNlcicgICAgICA9PiAkcHJlZnNbJ2Fy
Y190d2l0dGVyX3VzZXInXSwKICAgICdwYXNzd29yZCcgID0+ICcnLAogICAgJ3RpbWVsaW5l
JyAgPT4gJ3VzZXInLAogICAgJ2xpbWl0JyAgICAgPT4gJzEwJywKICAgICdyZXR3ZWV0cycg
ID0+IGZhbHNlLAogICAgJ2RhdGVmb3JtYXQnPT4gJHByZWZzWydhcmNoaXZlX2RhdGVmb3Jt
YXQnXSwKICAgICdjYWNoaW5nJyAgID0+ICcxJywKICAgICdjYWNoZV9kaXInID0+ICRwcmVm
c1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10sCiAgICAnY2FjaGVfdGltZSc9PiAnNScsCiAg
ICAnbGFiZWwnICAgICA9PiAnJywKICAgICdsYWJlbHRhZycgID0+ICcnLAogICAgJ2JyZWFr
JyAgICAgPT4gJ2xpJywKICAgICd3cmFwdGFnJyAgID0+ICcnLAogICAgJ2NsYXNzJyAgICAg
PT4gX19GVU5DVElPTl9fLAogICAgJ2NsYXNzX3Bvc3RlZCcgPT4gX19GVU5DVElPTl9fLict
cG9zdGVkJwogICAgKSwkYXR0cykpOwoKICAkdHdpdCA9IG5ldyBhcmNfVHdpdHRlcigkYXJj
X3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCk7Cgog
IGlmICgkY2FjaGluZykgeyAgLy8gdHVybiBvbiBjYWNoaW5nLCByZWNvbW1lbmRlZCAoZGVm
YXVsdCkKICAgICR0d2l0LT5zZXRDYWNoaW5nKHRydWUpOwogICAgJHR3aXQtPmNhY2hlRGly
KCRjYWNoZV9kaXIpOwogICAgJHR3aXQtPmNhY2hlVGltZSgkY2FjaGVfdGltZSk7CiAgfSBl
bHNlIHsgIC8vIHR1cm4gb2ZmIGNhY2hpbmcsIG5vdCByZWNvbW1lbmRlZCBvdGhlciB0aGFu
IGZvciB0ZXN0aW5nCiAgICAkdHdpdC0+c2V0Q2FjaGluZyhmYWxzZSk7CiAgfQoKICBzd2l0
Y2ggKCR0aW1lbGluZSkgewogICAgY2FzZSAnaG9tZSc6IGNhc2UgJ2ZyaWVuZHMnOgogICAg
ICAkdGltZWxpbmUgPSAnc3RhdHVzZXMvZnJpZW5kc190aW1lbGluZSc7IGJyZWFrOwogICAg
Y2FzZSAnbWVudGlvbnMnOgogICAgICAkdGltZWxpbmUgPSAnc3RhdHVzZXMvbWVudGlvbnMn
OyBicmVhazsKICAgIGNhc2UgJ3VzZXInOiBkZWZhdWx0OiAkdGltZWxpbmUgPSAnc3RhdHVz
ZXMvdXNlcl90aW1lbGluZSc7CiAgfQoKICAkb3V0ID0gYXJyYXkoKTsKICAkeG1sID0gJHR3
aXQtPmdldCgkdGltZWxpbmUKICAgICwgYXJyYXkoJ3NjcmVlbl9uYW1lJz0+JHVzZXIsJ2Nv
dW50Jz0+JGxpbWl0LCdpbmNsdWRlX3J0cyc9PiRyZXR3ZWV0cykpOwogIGlmICgkeG1sKSB7
CiAgICAkdHdlZXRzID0gQCR4bWwtPnhwYXRoKCcvc3RhdHVzZXMvc3RhdHVzJyk7CiAgICBp
ZiAoJHR3ZWV0cykgZm9yZWFjaCAoJHR3ZWV0cyBhcyAkdHdlZXQpIHsKICAgICAgJHRpbWUg
PSBzdHJ0b3RpbWUoaHRtbGVudGl0aWVzKCR0d2VldC0+Y3JlYXRlZF9hdCkpOwogICAgICAk
ZGF0ZSA9IHNhZmVfc3RyZnRpbWUoJGRhdGVmb3JtYXQsJHRpbWUpOwogICAgICAkb3V0W10g
PSBhcmNfVHdpdHRlcjo6bWFrZUxpbmtzKGh0bWxlbnRpdGllcygkdHdlZXQtPnRleHQsIEVO
VF9RVU9URVMsJ1VURi04JykpCiAgICAgICAgLicgJy50YWcoaHRtbGVudGl0aWVzKCRkYXRl
KSwnc3BhbicsJyBjbGFzcz0iJy4kY2xhc3NfcG9zdGVkLiciJyk7CiAgICB9CgogICAgcmV0
dXJuIGRvTGFiZWwoJGxhYmVsLCAkbGFiZWx0YWcpLmRvV3JhcCgkb3V0LCAkd3JhcHRhZywg
JGJyZWFrLCAkY2xhc3MpOwogIH0KCn0KCmZ1bmN0aW9uIGFyY190d2l0dGVyX3NlYXJjaCgk
YXR0cykKewogICAgZ2xvYmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRh
cmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAog
ICAgICAgICd1c2VyJyAgICAgID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLAogICAg
ICAgICdzZWFyY2gnICAgID0+ICcnLAogICAgICAgICdoYXNodGFncycgID0+ICcnLAogICAg
ICAgICd1c2VyJyAgICAgID0+ICcnLAogICAgICAgICdyZXBseScgICAgID0+ICcnLAogICAg
ICAgICdtZW50aW9uJyAgID0+ICcnLAogICAgICAgICdsaW1pdCcgICAgID0+ICcxMCcsCiAg
ICAgICAgJ2xhbmcnICAgICAgPT4gJycsCiAgICAgICAgJ2RhdGVmb3JtYXQnPT4gJHByZWZz
WydhcmNoaXZlX2RhdGVmb3JtYXQnXSwKICAgICAgICAnY2FjaGluZycgICA9PiAnMScsCiAg
ICAgICAgJ2NhY2hlX2RpcicgPT4gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXSwK
ICAgICAgICAnY2FjaGVfdGltZSc9PiAnNScsCiAgICAgICAgJ2xhYmVsJyAgICAgPT4gJycs
CiAgICAgICAgJ2xhYmVsdGFnJyAgPT4gJycsCiAgICAgICAgJ2JyZWFrJyAgICAgPT4gJ2xp
JywKICAgICAgICAnd3JhcHRhZycgICA9PiAnJywKICAgICAgICAnY2xhc3MnICAgICA9PiBf
X0ZVTkNUSU9OX18sCiAgICAgICAgJ2NsYXNzX3Bvc3RlZCcgPT4gX19GVU5DVElPTl9fLict
cG9zdGVkJywKICAgICAgICAnY2xhc3NfdXNlcicgICA9PiBfX0ZVTkNUSU9OX18uJy11c2Vy
JwogICAgKSwkYXR0cykpOwoKICAgICAgICAkdHdpdCA9IG5ldyBhcmNfVHdpdHRlcigkYXJj
X3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3Vt
ZXJTZWNyZXQpOwoKICAgICAgICBpZiAoJGNhY2hpbmcpIHsgIC8vIHR1cm4gb24gY2FjaGlu
ZywgcmVjb21tZW5kZWQgKGRlZmF1bHQpCiAgICAgICAgICAgICR0d2l0LT5zZXRDYWNoaW5n
KHRydWUpOwogICAgICAgICAgICAkdHdpdC0+Y2FjaGVEaXIoJGNhY2hlX2Rpcik7CiAgICAg
ICAgICAgICR0d2l0LT5jYWNoZVRpbWUoJGNhY2hlX3RpbWUpOwogICAgICAgIH0gZWxzZSB7
ICAvLyB0dXJuIG9mZiBjYWNoaW5nLCBub3QgcmVjb21tZW5kZWQgb3RoZXIgdGhhbiBmb3Ig
dGVzdGluZwogICAgICAgICAgICAkdHdpdC0+c2V0Q2FjaGluZyhmYWxzZSk7CiAgICAgICAg
fQoKICAgICAgICAvLyBjb25zdHJ1Y3Qgc2VhcmNoIHF1ZXJ5CiAgICAgICAgaWYgKCFlbXB0
eSgkc2VhcmNoKSkgewogICAgICAgICAgICAkdGVybXMgPSBleHBsb2RlKCcsJywkc2VhcmNo
KTsgJHRlcm1zID0gYXJyYXlfbWFwKCd0cmltJywkdGVybXMpOwogICAgICAgICAgICAkc2Vh
cmNoID0gaW1wbG9kZSgnICcsJHRlcm1zKTsKICAgICAgICB9CiAgICAgICAgaWYgKCRoYXNo
dGFncykgewogICAgICAgICAgICAkaGFzaGVzID0gZXhwbG9kZSgnLCcsJGhhc2h0YWdzKTsg
JGhhc2hlcyA9IGFycmF5X21hcCgndHJpbScsJGhhc2hlcyk7CiAgICAgICAgICAgICRzZWFy
Y2guPSAoKCRzZWFyY2gpPycgJzonJykuJyMnLmltcGxvZGUoJyAjJywkaGFzaGVzKTsKICAg
ICAgICB9CiAgICAgICAgaWYgKCRyZXBseSkgewogICAgICAgICAgICAkc2VhcmNoLj0gKCgk
c2VhcmNoKT8nICc6JycpLid0bzonLnRyaW0oJHJlcGx5KTsKICAgICAgICB9CiAgICAgICAg
aWYgKCR1c2VyKSB7CiAgICAgICAgICAgICRzZWFyY2guPSAoKCRzZWFyY2gpPycgJzonJyku
J2Zyb206Jy50cmltKCR1c2VyKTsKICAgICAgICB9CiAgICAgICAgaWYgKCRtZW50aW9uKSB7
CiAgICAgICAgICAgICRzZWFyY2guPSAoKCRzZWFyY2gpPycgJzonJykuJ0AnLnRyaW0oJG1l
bnRpb24pOwogICAgICAgIH0KCiAgICAgICAgaWYgKGVtcHR5KCRzZWFyY2gpKSB7CiAgICAg
ICAgICAgIHJldHVybiAnJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkc2VhcmNo
ID0gdXJsZW5jb2RlKCRzZWFyY2gpOwogICAgICAgIH0KCiAgICAgICAgJG91dCA9IGFycmF5
KCk7CiAgICAgICAgJHR3ZWV0cyA9ICR0d2l0LT5nZXQoJ2h0dHA6Ly9zZWFyY2gudHdpdHRl
ci5jb20vc2VhcmNoLmF0b20/cT0nLiRzZWFyY2gKICAgICAgICAgICAgLCBhcnJheSgncnBw
Jz0+JGxpbWl0LCdsYW5nJz0+JGxhbmcpKTsKCiAgICAgICAgaWYgKCR0d2VldHMpIHsgZm9y
ZWFjaCAoJHR3ZWV0cy0+ZW50cnkgYXMgJHR3ZWV0KSB7CiAgICAgICAgICAgIHByZWdfbWF0
Y2goIi8oLiopIFwoKC4qKVwpLyIsJHR3ZWV0LT5hdXRob3ItPm5hbWUsJG1hdGNoZXMpOwog
ICAgICAgICAgICBsaXN0KCRhdXRob3IsJHVuYW1lLCRuYW1lKSA9ICRtYXRjaGVzOwogICAg
ICAgICAgICAkdGltZSA9IHN0cnRvdGltZShodG1sZW50aXRpZXMoJHR3ZWV0LT5wdWJsaXNo
ZWQpKTsKICAgICAgICAgICAgJGRhdGUgPSBzYWZlX3N0cmZ0aW1lKCRkYXRlZm9ybWF0LCR0
aW1lKTsKICAgICAgICAgICAgJHRleHQgPSAkdHdlZXQtPnRpdGxlOwogICAgICAgICAgICAk
b3V0W10gPSB0YWcoaHJlZihodG1sZW50aXRpZXMoJHVuYW1lKSwkdHdlZXQtPmF1dGhvci0+
dXJpLAogICAgICAgICAgICAgICAgJyB0aXRsZT0iJy5odG1sZW50aXRpZXMoJG5hbWUpLici
JykuJzogJywnc3BhbicKICAgICAgICAgICAgICAgICAgICAsJyBjbGFzcz0iJy4kY2xhc3Nf
dXNlci4nIicpCiAgICAgICAgICAgICAgICAuYXJjX1R3aXR0ZXI6Om1ha2VMaW5rcyhodG1s
ZW50aXRpZXMoJHRleHQsIEVOVF9RVU9URVMsJ1VURi04JykpCiAgICAgICAgICAgICAgICAu
JyAnLnRhZyhodG1sZW50aXRpZXMoJGRhdGUpLCdzcGFuJwogICAgICAgICAgICAgICAgICAg
ICwnIGNsYXNzPSInLiRjbGFzc19wb3N0ZWQuJyInKTsKICAgICAgICB9IHJldHVybiBkb0xh
YmVsKCRsYWJlbCwgJGxhYmVsdGFnKQogICAgICAgICAgICAuZG9XcmFwKCRvdXQsICR3cmFw
dGFnLCAkYnJlYWssICRjbGFzcyk7IH0KCn0KCmZ1bmN0aW9uIGFyY190d2l0dGVyX3R3ZWV0
KCRhdHRzKSB7CiAgICBnbG9iYWwgJHRoaXNhcnRpY2xlOwoKICAgIGV4dHJhY3QobEF0dHMo
YXJyYXkoCiAgICAgICdpZCcgICAgICAgID0+ICR0aGlzYXJ0aWNsZVsndGhpc2lkJ10sCiAg
ICAgICdpbmNsdWRlX3VybCcgICA9PiB0cnVlCiAgICApLCRhdHRzKSk7CgogICAgaWYgKCRp
ZCkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBm
cm9tCiAgICAgICR0d2VldCA9ICgkaW5jbHVkZV91cmwpID8gc2FmZV9yb3coInR3ZWV0Iiwg
J2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKQogICAgICAgIDogc2FmZV9yb3co
IlJFUExBQ0UodHdlZXQsQ09OQ0FUKCcgJyx0aW55dXJsKSwnJykgQVMgdHdlZXQiCiAgICAg
ICAgICAsICdhcmNfdHdpdHRlcicsICJhcnRpY2xlX2lkPXskaWR9Iik7CiAgICB9CgogICAg
aWYgKCR0d2VldFsndHdlZXQnXSkgewogICAgICByZXR1cm4gYXJjX1R3aXR0ZXI6Om1ha2VM
aW5rcygKICAgICAgICBodG1sZW50aXRpZXMoJHR3ZWV0Wyd0d2VldCddLCBFTlRfUVVPVEVT
LCdVVEYtOCcpKTsKICAgIH0KfQoKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdHdlZXRfdXJsKCRh
dHRzLCAkdGhpbmc9bnVsbCkgewogICAgZ2xvYmFsICR0aGlzYXJ0aWNsZSwkcHJlZnM7Cgog
ICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgJ2lkJyAgICAgID0+ICR0aGlzYXJ0aWNs
ZVsndGhpc2lkJ10sCiAgICAgICd0aXRsZScgICA9PiAnJywKICAgICAgJ2NsYXNzJyAgID0+
ICcnCiAgICApLCRhdHRzKSk7CgogICAgaWYgKCRpZCkgewogICAgICAvLyBGZXRjaCBhcmNf
dHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBmcm9tCiAgICAgICR0d2VldCA9IHNhZmVf
cm93KCJ0d2VldF9pZCIKICAgICAgICAsICdhcmNfdHdpdHRlcicsICJhcnRpY2xlX2lkPXsk
aWR9Iik7CiAgICB9CgogICAgaWYgKCR0d2VldFsndHdlZXRfaWQnXSkgewogICAgICAkdXJs
ID0gImh0dHA6Ly90d2l0dGVyLmNvbS8iLiRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLiIv
c3RhdHVzLyIuJHR3ZWV0Wyd0d2VldF9pZCddOwogICAgICBpZiAoJHRoaW5nPT09bnVsbCkg
ewogICAgICAgIHJldHVybiAkdXJsOwogICAgICB9CiAgICAgIHJldHVybiBocmVmKHBhcnNl
KCR0aGluZyksICR1cmwsCiAgICAgICAgKCR0aXRsZSA/ICcgdGl0bGU9IicuJHRpdGxlLici
JyA6ICcnKQogICAgICAgIC4oJGNsYXNzID8gJyBjbGFzcz0iJy4kY2xhc3MuJyInIDogJycp
KTsKICAgIH0KfQoKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdGlueXVybCgkYXR0cywgJHRoaW5n
PW51bGwpIHsKICAgIGdsb2JhbCAkdGhpc2FydGljbGU7CgogICAgZXh0cmFjdChsQXR0cyhh
cnJheSgKICAgICAgJ2lkJyAgICAgID0+ICR0aGlzYXJ0aWNsZVsndGhpc2lkJ10sCiAgICAg
ICd0aXRsZScgICA9PiAnJywKICAgICAgJ2NsYXNzJyAgID0+ICcnCiAgICApLCRhdHRzKSk7
CgogICAgaWYgKCRpZCkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBi
dWlsZCB0d2VldCBmcm9tCiAgICAgICR0d2VldCA9IHNhZmVfcm93KCJ0aW55dXJsIgogICAg
ICAgICwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKTsKICAgIH0KCiAgICBp
ZiAoJHR3ZWV0Wyd0aW55dXJsJ10pIHsKICAgICAgaWYgKCR0aGluZz09PW51bGwpIHsKICAg
ICAgICByZXR1cm4gJHR3ZWV0Wyd0aW55dXJsJ107CiAgICAgIH0KCiAgICAgIHJldHVybiBo
cmVmKHBhcnNlKCR0aGluZyksICR0d2VldFsndGlueXVybCddLAogICAgICAgICgkdGl0bGUg
PyAnIHRpdGxlPSInLiR0aXRsZS4nIicgOiAnJykKICAgICAgICAuKCRjbGFzcyA/ICcgY2xh
c3M9IicuJGNsYXNzLiciJyA6ICcnKSk7CiAgICB9Cn0KCi8qCiAqIFB1YmxpYyB0YWcgZm9y
IG91dHB1dHRpbmcgd2lkZ2V0IEpTCiAqLwpmdW5jdGlvbiBhcmNfdHdpdHRlcl93aWRnZXRf
anMoJGF0dHMpCnsKICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAgICdvcHRpbWlzZScg
PT4gZmFsc2UKICAgICksJGF0dHMpKTsKCiAgcmV0dXJuIF9hcmNfdHdpdHRlcl93aWRnZXRf
anMoJG9wdGltaXNlKTsKfQoKZnVuY3Rpb24gX2FyY190d2l0dGVyX3dpZGdldF9qcygkb3B0
aW1pc2U9dHJ1ZSkKewogIGdsb2JhbCAkYXJjX3R3aXR0ZXI7CgogIC8vIENoZWNrIGlmIHdp
ZGdldCBKUyBoYXMgYWxyZWFkeSBiZWVuIG91dHB1dAogIGlmICgkYXJjX3R3aXR0ZXJbJ3dp
ZGdldF9qcyddKSByZXR1cm47CgogIGlmICgkb3B0aW1pc2U9PWZhbHNlKSB7CiAgICByZXR1
cm4gJzxzY3JpcHQgc3JjPSJodHRwOi8vcGxhdGZvcm0udHdpdHRlci5jb20vd2lkZ2V0cy5q
cyIgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij48L3NjcmlwdD4nOwogIH0KCiAgJGpzID0gPDw8
SlMKPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPgooZnVuY3Rpb24oKSB7CiAgaWYg
KHdpbmRvdy5fX3R3aXR0ZXJJbnRlbnRIYW5kbGVyKSByZXR1cm47CiAgdmFyIGludGVudFJl
Z2V4ID0gL3R3aXR0ZXJcLmNvbShcOlxkezIsNH0pP1wvaW50ZW50XC8oXHcrKS8sCiAgICAg
IHdpbmRvd09wdGlvbnMgPSAnc2Nyb2xsYmFycz15ZXMscmVzaXphYmxlPXllcyx0b29sYmFy
PW5vLGxvY2F0aW9uPXllcycsCiAgICAgIHdpZHRoID0gNTUwLAogICAgICBoZWlnaHQgPSA0
MjAsCiAgICAgIHdpbkhlaWdodCA9IHNjcmVlbi5oZWlnaHQsCiAgICAgIHdpbldpZHRoID0g
c2NyZWVuLndpZHRoOwoKICBmdW5jdGlvbiBoYW5kbGVJbnRlbnQoZSkgewogICAgZSA9IGUg
fHwgd2luZG93LmV2ZW50OwogICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxl
bWVudCwKICAgICAgICBtLCBsZWZ0LCB0b3A7CgogICAgd2hpbGUgKHRhcmdldCAmJiB0YXJn
ZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPT0gJ2EnKSB7CiAgICAgIHRhcmdldCA9IHRh
cmdldC5wYXJlbnROb2RlOwogICAgfQoKICAgIGlmICh0YXJnZXQgJiYgdGFyZ2V0Lm5vZGVO
YW1lLnRvTG93ZXJDYXNlKCkgPT09ICdhJyAmJiB0YXJnZXQuaHJlZikgewogICAgICBtID0g
dGFyZ2V0LmhyZWYubWF0Y2goaW50ZW50UmVnZXgpOwogICAgICBpZiAobSkgewogICAgICAg
IGxlZnQgPSBNYXRoLnJvdW5kKCh3aW5XaWR0aCAvIDIpIC0gKHdpZHRoIC8gMikpOwogICAg
ICAgIHRvcCA9IDA7CgogICAgICAgIGlmICh3aW5IZWlnaHQgPiBoZWlnaHQpIHsKICAgICAg
ICAgIHRvcCA9IE1hdGgucm91bmQoKHdpbkhlaWdodCAvIDIpIC0gKGhlaWdodCAvIDIpKTsK
ICAgICAgICB9CgogICAgICAgIHdpbmRvdy5vcGVuKHRhcmdldC5ocmVmLCAnaW50ZW50Jywg
d2luZG93T3B0aW9ucyArICcsd2lkdGg9JyArIHdpZHRoICsKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICcsaGVpZ2h0PScgKyBoZWlnaHQgKyAnLGxlZnQ9
JyArIGxlZnQgKyAnLHRvcD0nICsgdG9wKTsKICAgICAgICBlLnJldHVyblZhbHVlID0gZmFs
c2U7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCAmJiBlLnByZXZlbnREZWZhdWx0KCk7CiAg
ICAgIH0KICAgIH0KICB9CgogIGlmIChkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKSB7CiAg
ICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUludGVudCwgZmFs
c2UpOwogIH0gZWxzZSBpZiAoZG9jdW1lbnQuYXR0YWNoRXZlbnQpIHsKICAgIGRvY3VtZW50
LmF0dGFjaEV2ZW50KCdvbmNsaWNrJywgaGFuZGxlSW50ZW50KTsKICB9CiAgd2luZG93Ll9f
dHdpdHRlckludGVudEhhbmRsZXIgPSB0cnVlOwp9KCkpOwo8L3NjcmlwdD4KSlM7CiAgJGFy
Y190d2l0dGVyWyd3aWRnZXRfanMnXSA9IHRydWU7CiAgcmV0dXJuICRqczsKfQoKLy8gRGVw
cmVjYXRlZCBhcmNfdHdpdHRlcl9yZXR3ZWV0IHRhZywgdXNlIGFyY190d2l0dGVyX3R3ZWV0
X2J1dHRvbiBpbnN0ZWFkCmZ1bmN0aW9uIGFyY190d2l0dGVyX3JldHdlZXQoJGF0dHMsICR0
aGluZz1udWxsKQp7CiAgcmV0dXJuIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbigkYXR0cywg
JHRoaW5nPW51bGwpOwp9CmZ1bmN0aW9uIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbigkYXR0
cywgJHRoaW5nPW51bGwpCnsKICAgIGdsb2JhbCAkcHJlZnMsJGFyY190d2l0dGVyX2NvbnN1
bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CiAgICBnbG9iYWwgJHRoaXNh
cnRpY2xlOwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICAgJ3VzZXInICAgICAg
ICA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSwgLy8gdmlhIHVzZXIgYWNjb3VudAog
ICAgICAgICd1cmwnICAgICAgICAgPT4gJycsCiAgICAgICAgJ3RleHQnICAgICAgICA9PiAn
JywKICAgICAgICAnZm9sbG93MScgICAgID0+ICcnLAogICAgICAgICdmb2xsb3cyJyAgICAg
PT4gJycsCiAgICAgICAgJ2xhbmcnICAgICAgICA9PiAnJywKICAgICAgICAnY291bnQnICAg
ICAgID0+ICdob3Jpem9udGFsJywKICAgICAgICAnaW5jbHVkZV9qcycgID0+IHRydWUsCiAg
ICAgICAgJ29wdGltaXNlX2pzJyA9PiBmYWxzZSwKICAgICAgICAnd3JhcHRhZycgICAgID0+
ICcnLAogICAgICAgICdjbGFzcycgICAgICAgPT4gJ3R3aXR0ZXItc2hhcmUtYnV0dG9uJwog
ICAgKSwkYXR0cykpOwoKICAgICRxID0gJyc7IC8vIHF1ZXJ5IHN0cmluZwoKICAgIGlmICgk
aWQ9JHRoaXNhcnRpY2xlWyd0aGlzaWQnXSkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRl
ciBzdHVmZiB0byBidWlsZCB0d2VldCBmcm9tCiAgICAgICRyb3cgPSBzYWZlX3JvdygiUkVQ
TEFDRSh0d2VldCxDT05DQVQoJyAnLHRpbnl1cmwpLCcnKSBBUyB0d2VldCx0aW55dXJsIgog
ICAgICAgICwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKTsKCiAgICAgIGlm
ICgkdXJsPT0nJykgewogICAgICAgICR1cmwgPSAoJHVybCkgPyAkdXJsIDogcGVybWxpbmt1
cmwoJHRoaXNhcnRpY2xlKTsKICAgICAgICAkcSA9ICd1cmw9Jy51cmxlbmNvZGUoJHVybCk7
CiAgICAgIH0KICAgICAgaWYgKCR0ZXh0PT0nJykgewogICAgICAgICR0ZXh0ID0gKCRyb3db
J3R3ZWV0J10pID8gJHJvd1sndHdlZXQnXSA6ICR0aGlzYXJ0aWNsZVsndGl0bGUnXTsKICAg
ICAgfQogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLid0ZXh0PScudXJsZW5jb2Rl
KCR0ZXh0KTsKICAgIH0KICAgIGlmICgkdXNlcikgewogICAgICAkcSAuPSAoJHEgPyAnJmFt
cDsnIDogJycpLid2aWE9Jy51cmxlbmNvZGUoJHVzZXIpOwogICAgfQogICAgaWYgKCRmb2xs
b3cxJiYkZm9sbG93MikgewogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidyZWxh
dGVkPScudXJsZW5jb2RlKCRmb2xsb3cxLic6Jy4kZm9sbG93Mik7CiAgICB9IGVsc2VpZiAo
JGZvbGxvdzF8fCRmb2xsb3cyKSB7CiAgICAgICRxIC49ICgkcSA/ICcmYW1wOycgOiAnJyku
J3JlbGF0ZWQ9Jy51cmxlbmNvZGUoJGZvbGxvdzEuJGZvbGxvdzIpOwogICAgfQoKICAgIHN3
aXRjaCAoJGxhbmcpIHsKICAgICAgY2FzZSAnZnInOiBicmVhazsgY2FzZSAnZGUnOiBicmVh
azsgY2FzZSAnZXMnOiBicmVhazsgY2FzZSAnanAnOiBicmVhazsKICAgICAgZGVmYXVsdDoK
ICAgICAgICAkbGFuZyA9ICdlbic7CiAgICB9CiAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDog
JycpLidsYW5nPScudXJsZW5jb2RlKCRsYW5nKTsKCiAgICBzd2l0Y2ggKCRjb3VudCkgewog
ICAgICBjYXNlICdub25lJzogYnJlYWs7IGNhc2UgJ3ZlcnRpY2FsJzogYnJlYWs7CiAgICAg
IGRlZmF1bHQ6CiAgICAgICAgJGNvdW50ID0gJ2hvcml6b250YWwnOwogICAgfQogICAgJHEg
Lj0gKCRxID8gJyZhbXA7JyA6ICcnKS4nY291bnQ9Jy51cmxlbmNvZGUoJGNvdW50KTsKCiAg
ICAkdGhpbmcgPSAoJHRoaW5nPT09bnVsbCkgPyAnVHdlZXQnIDogcGFyc2UoJHRoaW5nKTsK
CiAgICAkaHRtbCA9IGhyZWYoJHRoaW5nLCdodHRwOi8vdHdpdHRlci5jb20vc2hhcmU/Jy4k
cQogICAgICAsICcgY2xhc3M9IicuJGNsYXNzLiciJyk7CgogICAgJGpzID0gKCRpbmNsdWRl
X2pzKSA/IF9hcmNfdHdpdHRlcl93aWRnZXRfanMoJG9wdGltaXNlX2pzP3RydWU6ZmFsc2Up
IDogJyc7CgogICAgcmV0dXJuICRqcy4kaHRtbDsKfQoKLyoKICogVHdpdHRlciBGb2xsb3cg
YnV0dG9uCiAqLwpmdW5jdGlvbiBhcmNfdHdpdHRlcl9mb2xsb3dfYnV0dG9uKCRhdHRzLCAk
dGhpbmc9bnVsbCkKewogICAgZ2xvYmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJL
ZXksICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKICAgIGdsb2JhbCAkdGhpc2FydGlj
bGU7CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgICAndXNlcicgICAgICAgID0+
ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLCAvLyB2aWEgdXNlciBhY2NvdW50CiAgICAg
ICAgJ2xhbmcnICAgICAgICA9PiAnJywKICAgICAgICAnY291bnQnICAgICAgID0+IHRydWUs
CiAgICAgICAgJ2luY2x1ZGVfanMnICA9PiB0cnVlLAogICAgICAgICdvcHRpbWlzZV9qcycg
PT4gZmFsc2UsCiAgICAgICAgJ2NsYXNzJyAgICAgICA9PiAndHdpdHRlci1mb2xsb3ctYnV0
dG9uJwogICAgKSwkYXR0cykpOwoKICAgICRhdHRzID0gJyc7IC8vIGRhdGEgYXR0cmlidXRl
cwoKICAgIHN3aXRjaCAoJGxhbmcpIHsKICAgICAgY2FzZSAnZnInOiBicmVhazsgY2FzZSAn
ZGUnOiBicmVhazsgY2FzZSAnZXMnOiBicmVhazsgY2FzZSAnanAnOiBicmVhazsKICAgICAg
ZGVmYXVsdDoKICAgICAgICAkbGFuZyA9ICdlbic7CiAgICB9CiAgICAkYXR0cyAuPSAnIGRh
dGEtbGFuZz0iJy51cmxlbmNvZGUoJGxhbmcpLiciJzsKCiAgICAkYXR0cyAuPSAnIGRhdGEt
c2hvdy1jb3VudD0iJy4oJGNvdW50Pyd0cnVlJzonZmFsc2UnKS4nIic7CgogICAgJHRoaW5n
ID0gKCR0aGluZz09PW51bGwpID8gJ0ZvbGxvdyBAJy4kdXNlciA6IHBhcnNlKCR0aGluZyk7
CgogICAgJGh0bWwgPSBocmVmKCR0aGluZywnaHR0cDovL3R3aXR0ZXIuY29tLycudXJsZW5j
b2RlKCR1c2VyKQogICAgICAsICcgY2xhc3M9IicuJGNsYXNzLiciJy4kYXR0cyk7CgogICAg
JGpzID0gKCRpbmNsdWRlX2pzKSA/IF9hcmNfdHdpdHRlcl93aWRnZXRfanMoJG9wdGltaXNl
X2pzP3RydWU6ZmFsc2UpIDogJyc7CgogICAgcmV0dXJuICRqcy4kaHRtbDsKfQoKLyoKICAg
IEFkbWluLXNpZGUgZnVuY3Rpb25zCiAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiovCgovLyBJbnN0YWxsYXRp
b24gZnVuY3Rpb24gLSBidWlsZHMgTXlTUUwgdGFibGUKZnVuY3Rpb24gYXJjX3R3aXR0ZXJf
aW5zdGFsbCgpCnsKCiAgICAvLyBGb3IgZmlyc3QgaW5zdGFsbCwgY3JlYXRlIHRhYmxlIGZv
ciB0d2VldHMKICAgICRzcWwgPSAiQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgIi5QRlgu
ImFyY190d2l0dGVyICI7CiAgICAkc3FsLj0gIihhcmNfdHdpdHRlcmlkIElOVEVHRVIgQVVU
T19JTkNSRU1FTlQgUFJJTUFSWSBLRVksCiAgICAgICAgYXJ0aWNsZV9pZCBJTlRFR0VSKDEx
KSwKICAgICAgICB0d2VldF9pZCBCSUdJTlQoMjApLAogICAgICAgIHR3ZWV0IFZBUkNIQVIo
MTQwKSwKICAgICAgICB0aW55dXJsIFZBUkNIQVIoMzApKTsiOwoKICAgIGlmICghc2FmZV9x
dWVyeSgkc3FsKSkgewogICAgICAgIHJldHVybiAnRXJyb3IgLSB1bmFibGUgdG8gY3JlYXRl
IGFyY190d2l0dGVyIHRhYmxlJzsKICAgIH0KCn0KCi8vIFVuaW5zdGFsbCBmdW5jdGlvbiAt
IGRlbGV0ZXMgTXlTUUwgdGFibGUgYW5kIHJlbGF0ZWQgcHJlZmVyZW5jZXMKZnVuY3Rpb24g
YXJjX3R3aXR0ZXJfdW5pbnN0YWxsKCkKewoKICAgICRzcWwgPSAiRFJPUCBUQUJMRSBJRiBF
WElTVFMgIi5QRlguImFyY190d2l0dGVyOyI7CiAgICBpZiAoIXNhZmVfcXVlcnkoJHNxbCkp
IHsKICAgICAgICByZXR1cm4gJ0Vycm9yIC0gdW5hYmxlIHRvIGRlbGV0ZSBhcmNfdHdpdHRl
ciB0YWJsZSc7CiAgICB9CgogICAgJHNxbCA9ICJERUxFVEUgRlJPTSAgIi5QRlguInR4cF9w
cmVmcyBXSEVSRSBldmVudD0nYXJjX3R3aXR0ZXInOyI7CiAgICBpZiAoIXNhZmVfcXVlcnko
JHNxbCkpIHsKICAgICAgICByZXR1cm4gJ0Vycm9yIC0gdW5hYmxlIHRvIGRlbGV0ZSBhcmNf
dHdpdHRlciBwcmVmZXJlbmNlcyc7CiAgICB9Cgp9CmZ1bmN0aW9uIGFyY190d2l0dGVyX3Vy
bF9tZXRob2Rfc2VsZWN0KCRuYW1lLCAkdmFsKQp7CiAgICAkbWV0aG9kcyA9IGFycmF5KCd0
aW55dXJsJyA9PiAnVGlueXVybCcsCiAgICAgICdpc2dkJyA9PiAnSXMuZ2QnLAogICAgICAn
YXJjX3R3aXR0ZXInID0+ICdUWFAgVHdlZXQnLAogICAgICAnc21kJyA9PiAnc21kX3Nob3J0
X3VybCcpOwogICAgcmV0dXJuIHNlbGVjdElucHV0KCRuYW1lLCAkbWV0aG9kcywgJHZhbCk7
Cn0KZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCgkbmFtZSwgJHZhbCkKewogICAg
JHRhYnMgPSBhcnJheSgnY29udGVudCcgPT4gJ0NvbnRlbnQnLAogICAgICAgICdleHRlbnNp
b25zJyA9PiAnRXh0ZW5zaW9ucycsCiAgICAgICAgJycgPT4gJ0hpZGRlbicpOwogICAgcmV0
dXJuIHNlbGVjdElucHV0KCRuYW1lLCAkdGFicywgJHZhbCk7Cn0KLy8gUHJvdmlkZSBpbnRl
cmZhY2UgZm9yIHNldHRpbmcgcHJlZmVyZW5jZXMKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfcHJl
ZnMoJGV2ZW50LCRzdGVwKQp7CgogICAgZ2xvYmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29u
c3VtZXJLZXksJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgICR1c2VyICAgICAg
ICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ107CiAgICAkcHJlZml4ICAgICAgICA9
ICRwcmVmc1snYXJjX3R3aXR0ZXJfcHJlZml4J107CiAgICAkdHdlZXRfZGVmYXVsdCA9ICRw
cmVmc1snYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCddOwogICAgJHVybF9tZXRob2QgICAg
PSAkcHJlZnNbJ2FyY190d2l0dGVyX3VybF9tZXRob2QnXTsKICAgICRzaG9ydF91cmwgICAg
ID0gJHByZWZzWydhcmNfc2hvcnRfdXJsJ107CiAgICAkc2hvcnRfc2l0ZV91cmw9ICRwcmVm
c1snYXJjX3Nob3J0X3NpdGVfdXJsJ107CiAgICAkY2FjaGVfZGlyICAgICA9ICRwcmVmc1sn
YXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ107CiAgICAkdGFiICAgICAgICAgICA9ICRwcmVmc1sn
YXJjX3R3aXR0ZXJfdGFiJ107CgogICAgc3dpdGNoICgkc3RlcCkgewogICAgICAgIGNhc2Ug
J3ByZWZzX3NhdmUnOiBwYWdldG9wKCdUWFAgVHdlZXQnLCAnUHJlZmVyZW5jZXMgc2F2ZWQn
KTsgYnJlYWs7CiAgICAgICAgY2FzZSAncmVnaXN0ZXInOiBwYWdldG9wKCdUWFAgVHdlZXQn
LCdDb25uZWN0IHRvIFR3aXR0ZXInKTsgYnJlYWs7CiAgICAgICAgY2FzZSAndmFsaWRhdGUn
OgogICAgICAgIGRlZmF1bHQ6IHBhZ2V0b3AoJ1RYUCBUd2VldCcpOwogICAgfQoKICAgICRo
dG1sID0gJyc7CgogICAgaWYgKCRzdGVwPT0ncmVnaXN0ZXInKSB7IC8vIE9BdXRoIHJlZ2lz
dHJhdGlvbiBwcm9jZXNzCiAgICAgICAgJHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190
d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVy
U2VjcmV0KTsKCiAgICAgICAgLy8gQnVpbGQgYSBjYWxsYmFjayBVUkwgZm9yIFR3aXR0ZXIg
dG8gcmV0dXJuIHRvIHRoZSBuZXh0IHN0YWdlCiAgICAgICAgJGNhbGxiYWNrVVJMID0gJHR3
aXQtPmNhbGxiYWNrVVJMKCRldmVudCwndmFsaWRhdGUnKTsKCiAgICAgICAgJHJlcXVlc3Qg
PSAkdHdpdC0+Z2V0UmVxdWVzdFRva2VuKCRjYWxsYmFja1VSTCk7CiAgICAgICAgJHJlcXVl
c3RfdG9rZW4gPSAkcmVxdWVzdFsib2F1dGhfdG9rZW4iXTsKICAgICAgICAkcmVxdWVzdF90
b2tlbl9zZWNyZXQgPSAkcmVxdWVzdFsib2F1dGhfdG9rZW5fc2VjcmV0Il07CgogICAgICAg
IHNldF9wcmVmKCdhcmNfdHdpdHRlcl9yZXF1ZXN0VG9rZW4nLCRyZXF1ZXN0X3Rva2VuCiAg
ICAgICAgICAgICwgJ2FyY190d2l0dGVyJywyKTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3
aXR0ZXJfcmVxdWVzdFRva2VuU2VjcmV0JywkcmVxdWVzdF90b2tlbl9zZWNyZXQKICAgICAg
ICAgICAgLCAnYXJjX3R3aXR0ZXInLDIpOwoKICAgICAgICAkaHRtbC49IHN0YXJ0VGFibGUo
J2VkaXQnKS4KICAgICAgICAgICAgICAgIHRyKHRkKAogICAgICAgICAgICAgICAgICAgICgn
PHA+Jy5ocmVmKCdTaWduLWluIHRvIFR3aXR0ZXInCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAsJHR3aXQtPmdldEF1dGhvcml6ZVVSTCgkcmVxdWVzdCkpCiAgICAgICAgICAgICAg
ICAgICAgICAgIC4nIGFuZCBmb2xsb3cgdGhlIGluc3RydWN0aW9ucyB0byBhbGxvdyBUWFAg
VHdlZXQgdG8gdXNlIHlvdXIgYWNjb3VudC4gSWYgeW91IGFyZSBhbHJlYWR5IHNpZ25lZCBp
biB0byBUd2l0dGVyIHRoZW4gdGhhdCBhY2NvdW50IHdpbGwgYmUgYXNzb2NpYXRlZCB3aXRo
IFRYUCBUd2VldCBzbyB5b3UgbWF5IG5lZWQgdG8gc2lnbiBvdXQgZmlyc3QgaWYgeW91IHdh
bnQgdG8gdXNlIGEgZGlmZmVyZW50IGFjY291bnQuPC9wPicpCiAgICAgICAgICAgICAgICAp
KS5lbmRUYWJsZSgpOwogICAgfSBlbHNlaWYgKCRzdGVwPT0ndmFsaWRhdGUnKSB7CiAgICAg
ICAgJHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAg
ICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190
d2l0dGVyX3JlcXVlc3RUb2tlbiddCiAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRl
cl9yZXF1ZXN0VG9rZW5TZWNyZXQnXSk7CiAgICAgICAgLy8gQXNrIFR3aXR0ZXIgZm9yIGFu
IGFjY2VzcyB0b2tlbiAoYW5kIGFuIGFjY2VzcyB0b2tlbiBzZWNyZXQpCiAgICAgICAgJHJl
cXVlc3QgPSAkdHdpdC0+Z2V0QWNjZXNzVG9rZW4oIGdwcygnb2F1dGhfdmVyaWZpZXInKSAp
OwogICAgICAgICRhY2Nlc3NfdG9rZW4gPSAkcmVxdWVzdFsnb2F1dGhfdG9rZW4nXTsKICAg
ICAgICAkYWNjZXNzX3Rva2VuX3NlY3JldCA9ICRyZXF1ZXN0WydvYXV0aF90b2tlbl9zZWNy
ZXQnXTsKICAgICAgICAkdXNlciA9ICRyZXF1ZXN0WydzY3JlZW5fbmFtZSddOwogICAgICAg
IC8vIFN0b3JlIHRoZSBhY2Nlc3MgdG9rZW4gYW5kIHNlY3JldAogICAgICAgIHNldF9wcmVm
KCdhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbicsJGFjY2Vzc190b2tlbiwgJ2FyY190d2l0dGVy
JywyKTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQn
LCRhY2Nlc3NfdG9rZW5fc2VjcmV0CiAgICAgICAgICAgICwgJ2FyY190d2l0dGVyJywyKTsK
ICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdXNlcicsJHVzZXIpOwogICAgICAgICRw
cmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXSA9ICRhY2Nlc3NfdG9rZW47CiAgICAg
ICAgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddID0gJGFjY2Vzc190
b2tlbl9zZWNyZXQ7CiAgICAgICAgdW5zZXQoJHR3aXQpOwogICAgfQoKICAgIGlmICgkc3Rl
cD09InByZWZzX3NhdmUiKSB7CiAgICAgICAgJHByZWZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdp
dHRlcl9wcmVmaXgnKSk7CiAgICAgICAgJHR3ZWV0X2RlZmF1bHQgPSBncHMoJ2FyY190d2l0
dGVyX3R3ZWV0X2RlZmF1bHQnKTsKICAgICAgICAkdXJsX21ldGhvZCA9IGdwcygnYXJjX3R3
aXR0ZXJfdXJsX21ldGhvZCcpOwogICAgICAgICRzaG9ydF91cmwgPSBncHMoJ2FyY19zaG9y
dF91cmwnKTsKICAgICAgICAkc2hvcnRfc2l0ZV91cmwgPSBncHMoJ2FyY19zaG9ydF9zaXRl
X3VybCcpOwogICAgICAgICRjYWNoZV9kaXIgPSBncHMoJ2FyY190d2l0dGVyX2NhY2hlX2Rp
cicpOwogICAgICAgICR0YWIgPSBncHMoJ2FyY190d2l0dGVyX3RhYicpOwogICAgICAgIGlm
IChzdHJsZW4oJHByZWZpeCk8PTIwKSB7CiAgICAgICAgICAgIHNldF9wcmVmKCdhcmNfdHdp
dHRlcl9wcmVmaXgnLCRwcmVmaXgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICRw
cmVmaXggPSAkcHJlZnNbJ2FyY190d2l0dGVyX3ByZWZpeCddOwogICAgICAgIH0KICAgICAg
ICAkdHdlZXRfZGVmYXVsdCA9ICgkdHdlZXRfZGVmYXVsdCkgPyAxIDogMDsKICAgICAgICAk
c2hvcnRfdXJsID0gKCRzaG9ydF91cmwpID8gMSA6IDA7CiAgICAgICAgaWYgKCEkc2hvcnRf
c2l0ZV91cmwpICRzaG9ydF9zaXRlX3VybCA9ICRwcmVmc1snc2l0ZXVybCddOwogICAgICAg
IHNldF9wcmVmKCdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0JywkdHdlZXRfZGVmYXVsdCk7
CiAgICAgICAgc2V0X3ByZWYoJ2FyY19zaG9ydF91cmwnLCRzaG9ydF91cmwpOwogICAgICAg
IHNldF9wcmVmKCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJywkdXJsX21ldGhvZCk7CiAgICAg
ICAgc2V0X3ByZWYoJ2FyY19zaG9ydF9zaXRlX3VybCcsJHNob3J0X3NpdGVfdXJsKTsKICAg
ICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJywkY2FjaGVfZGlyKTsKICAg
ICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdGFiJywkdGFiKTsKICAgIH0KCiAgICBpZiAo
ICRzdGVwIT0ncmVnaXN0ZXInICkgewogICAgICAgIGlmICggaXNzZXQoJHByZWZzWydhcmNf
dHdpdHRlcl9hY2Nlc3NUb2tlbiddKQogICAgICAgICYmIGlzc2V0KCRwcmVmc1snYXJjX3R3
aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSkgKSB7CiAgICAgICAgICAgICR0d2l0ID0gbmV3
IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAgICAg
LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNj
ZXNzVG9rZW4nXQogICAgICAgICAgICAgICAgLCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vz
c1Rva2VuU2VjcmV0J10pOwogICAgICAgICAgICAkcmVnaXN0ZXJVUkwgPSAkdHdpdC0+Y2Fs
bGJhY2tVUkwoJGV2ZW50LCdyZWdpc3RlcicpOwogICAgICAgICAgICAkaHRtbC49IHN0YXJ0
VGFibGUoJ2xpc3QnKS5mb3JtKAogICAgICAgICAgICAgICAgdHIoCiAgICAgICAgICAgICAg
ICAgICAgdGRjcyhoZWQoJ1R3aXR0ZXIgYWNjb3VudCBkZXRhaWxzJywgMiksMikKICAgICAg
ICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0
ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX3VzZXIiPlR3aXR0ZXIgdXNlcm5hbWU8L2xh
YmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJp
Z2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50
ZCgKICAgICAgICAgICAgICAgICAgICAgICAgKCRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlcidd
KSA/CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdXNlci4nICgnLmhyZWYoJ1JlLWNv
bm5lY3QnLCRyZWdpc3RlclVSTCkuJyknCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6
ICc8ZW0+dW5rbm93bjwvZW0+JwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmhyZWYo
J0Nvbm5lY3QgdG8gVHdpdHRlcicsJHJlZ2lzdGVyVVJMKSkKICAgICAgICAgICAgICAgICkK
ICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVHdl
ZXQgc2V0dGluZ3MnLCAyKSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAg
LnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJf
Y2FjaGVfZGlyIj5Ud2VldCBwcmVmaXg8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAg
ICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxl
OyInKQogICAgICAgICAgICAgICAgICAgIC50ZChmSW5wdXQoJ3RleHQnLCdhcmNfdHdpdHRl
cl9wcmVmaXgnLCRwcmVmaXgsJycsJycsJycsJycsJycsJ2FyY190d2l0dGVyX3ByZWZpeCcp
KQogICAgICAgICAgICAgICAgKS50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJl
bCBmb3I9ImFyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQiPlR3ZWV0IGFydGljbGVzIGJ5IGRl
ZmF1bHQ8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQt
YWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAg
ICAgICAgIC50ZCh5ZXNub1JhZGlvKCdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0JywgJHR3
ZWV0X2RlZmF1bHQsICcnLCAnYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcpKQogICAgICAg
ICAgICAgICAgKS50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFy
Y190d2l0dGVyX3VybF9tZXRob2QiPlVSTCBzaG9ydG5lcjwvbGFiZWw+JywKICAgICAgICAg
ICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFs
aWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKGFyY190d2l0dGVyX3Vy
bF9tZXRob2Rfc2VsZWN0KCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJywkdXJsX21ldGhvZCkp
CiAgICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdU
WFAgVHdlZXQgc2hvcnQgVVJMJywgMiksMikKICAgICAgICAgICAgICAgICkKICAgICAgICAg
ICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY19z
aG9ydF91cmwiPkVuYWJsZSBUWFAgVHdlZXQgc2hvcnQgVVJMIHJlZGlyZWN0PC9sYWJlbD4n
LAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsg
dmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoeWVz
bm9SYWRpbygnYXJjX3Nob3J0X3VybCcsICRzaG9ydF91cmwsICcnLCAnYXJjX3Nob3J0X3Vy
bCcpKSwKICAgICAgICAgICAgICAgICAgICAnIGlkPSJhcmNfc2hvcnRfdXJsLW9uX29mZiIn
CiAgICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVs
IGZvcj0iYXJjX3Nob3J0X3NpdGVfdXJsIj5UWFAgVHdlZXQgc2hvcnQgc2l0ZSBVUkw8L2xh
YmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJp
Z2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50
ZChmSW5wdXQoJ3RleHQnLCdhcmNfc2hvcnRfc2l0ZV91cmwnLCRzaG9ydF9zaXRlX3VybCwn
JywnJywnJywnJywnJywnYXJjX3Nob3J0X3NpdGVfdXJsJykpLAogICAgICAgICAgICAgICAg
ICAgICcgaWQ9ImFyY19zaG9ydF9zaXRlX3VybC1vcHRpb24iJwogICAgICAgICAgICAgICAg
KS50cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVHdpdHRlciB0YWInLCAyKSwy
KQogICAgICAgICAgICAgICAgKS50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJl
bCBmb3I9ImFyY190d2l0dGVyX3RhYiI+TG9jYXRpb24gb2YgVHdpdHRlciB0YWI8L2xhYmVs
PicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0
OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50ZChh
cmNfdHdpdHRlcl90YWJfc2VsZWN0KCdhcmNfdHdpdHRlcl90YWInLCR0YWIpKQogICAgICAg
ICAgICAgICAgKS50cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnQ2FjaGUnLCAy
KSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAogICAgICAgICAg
ICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfY2FjaGVfZGlyIj5DYWNo
ZSBkaXJlY3Rvcnk8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9
InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAg
ICAgICAgICAgICAgIC50ZChmSW5wdXQoJ3RleHQnLCdhcmNfdHdpdHRlcl9jYWNoZV9kaXIn
LCRjYWNoZV9kaXIsJycsJycsJycsJycsJycsJ2FyY190d2l0dGVyX2NhY2hlX2RpcicpKQog
ICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAogICAgICAgICAgICAgICAg
ICAgIHRkYSgKICAgICAgICAgICAgICAgICAgICAgICAgZklucHV0KCdzdWJtaXQnLCAnU3Vi
bWl0JywgZ1R4dCgnc2F2ZV9idXR0b24nKSwgJ3B1Ymxpc2gnKQogICAgICAgICAgICAgICAg
ICAgICAgICAubi5zSW5wdXQoJ3ByZWZzX3NhdmUnKQogICAgICAgICAgICAgICAgICAgICAg
ICAubi5lSW5wdXQoJ3BsdWdpbl9wcmVmcy5hcmNfdHdpdHRlcicpCiAgICAgICAgICAgICAg
ICAgICAgLCAnIGNvbHNwYW49IjIiIGNsYXNzPSJub2xpbmUiJykpKQogICAgICAgICAgICAg
ICAgLmVuZFRhYmxlKCk7CiAgICAgICAgfSBlbHNlaWYgKCAkc3RlcCE9J3JlZ2lzdGVyJyAp
IHsKICAgICAgICAgICAgJHJlZ2lzdGVyVVJMID0gYXJjX3R3aXR0ZXI6OmNhbGxiYWNrVVJM
KCRldmVudCwncmVnaXN0ZXInKTsKICAgICAgICAgICAgJGh0bWwuPSBzdGFydFRhYmxlKCds
aXN0JykuZm9ybSgKICAgICAgICAgICAgICAgIHRyKAogICAgICAgICAgICAgICAgICAgIHRk
Y3MoaGVkKCdUd2l0dGVyIGFjY291bnQgZGV0YWlscycsIDIpLDIpCiAgICAgICAgICAgICAg
ICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFi
ZWwgZm9yPSJhcmNfdHdpdHRlcl91c2VyIj5Ud2l0dGVyIHVzZXJuYW1lPC9sYWJlbD4nLAog
ICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVy
dGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoCiAgICAg
ICAgICAgICAgICAgICAgICAgICgnPGVtPnVua25vd248L2VtPiAoJwogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgLmhyZWYoJ0Nvbm5lY3QgdG8gVHdpdHRlcicsJHJlZ2lzdGVyVVJM
KS4nKScpCiAgICAgICAgICAgICAgICApKSkKICAgICAgICAgICAgICAgIC5lbmRUYWJsZSgp
OwogICAgICAgIH0KICAgIH0KCiAgICAvLyBTZXQgalF1ZXJ5IGZvciBzd2l0Y2hpbmcgb24v
b2ZmIHJlbGV2YW50IGFyY19zaG9ydF91cmwgZmllbGRzCiAgICAkanMgPSA8PDxKUwo8c2Ny
aXB0IGxhbmd1YWdlPSJqYXZhc2NyaXB0IiB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPgokKGRv
Y3VtZW50KS5yZWFkeShmdW5jdGlvbigpewogIHZhciBvbm9mZiA9ICQoJyNhcmNfc2hvcnRf
dXJsLW9uX29mZicpOwogIHZhciBhcmNfc2hvcnRfdXJsX29mZiA9ICQoJyNhcmNfc2hvcnRf
dXJsLWFyY19zaG9ydF91cmwtMCcpOwogIHZhciB1cmwgPSAkKCcjYXJjX3Nob3J0X3NpdGVf
dXJsLW9wdGlvbicpOwogIHZhciB1cmxfbWV0aG9kID0gJCgnc2VsZWN0W25hbWU9ImFyY190
d2l0dGVyX3VybF9tZXRob2QiXScpOwoKICBpZiAoYXJjX3Nob3J0X3VybF9vZmYuYXR0cign
Y2hlY2tlZCcpPT10cnVlCiAgJiYgJCgnb3B0aW9uOnNlbGVjdGVkJywgdXJsX21ldGhvZCku
dmFsKCkhPSdhcmNfdHdpdHRlcicpIHsKICAgIHVybC5oaWRlKCk7CiAgfQogICQoJ2lucHV0
Jywgb25vZmYpLmNoYW5nZShmdW5jdGlvbigpewogICAgaWYgKCQoJ29wdGlvbjpzZWxlY3Rl
ZCcsIHVybF9tZXRob2QpLnZhbCgpIT0nYXJjX3R3aXR0ZXInKSB7CiAgICAgIGFyY19zaG9y
dF91cmxfb2ZmLmF0dHIoJ2NoZWNrZWQnKT09dHJ1ZSA/IHVybC5oaWRlKCkgOiB1cmwuc2hv
dygpOwogICAgfQogIH0pOwoKICBpZiAoJCgnb3B0aW9uOnNlbGVjdGVkJywgdXJsX21ldGhv
ZCkudmFsKCk9PSdhcmNfdHdpdHRlcicpIHsKICAgIG9ub2ZmLmhpZGUoKTsgdXJsLnNob3co
KTsKICB9CiAgdXJsX21ldGhvZC5jaGFuZ2UoZnVuY3Rpb24oKXsKICAgIGlmICgkKCdvcHRp
b246c2VsZWN0ZWQnLCB1cmxfbWV0aG9kKS52YWwoKT09J2FyY190d2l0dGVyJykgewogICAg
ICBvbm9mZi50b2dnbGUoKTsgdXJsLnNob3coKTsKICAgIH0gZWxzZSB7CiAgICAgIG9ub2Zm
LnRvZ2dsZSgpOwogICAgICBhcmNfc2hvcnRfdXJsX29mZi5hdHRyKCdjaGVja2VkJyk9PXRy
dWUgPyB1cmwuaGlkZSgpIDogdXJsLnNob3coKTsKICAgIH0KICB9KQp9KTsKPC9zY3JpcHQ+
CkpTOwoKICAgIGVjaG8gJGpzLiRodG1sOwp9CgovLyBBZGQgVHdpdHRlciB0YWIgdG8gVGV4
dHBhdHRlcm4KZnVuY3Rpb24gYXJjX2FkbWluX3R3aXR0ZXIoJGV2ZW50LCRzdGVwKQp7CiAg
ICBnbG9iYWwgJHByZWZzLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRl
cl9jb25zdW1lclNlY3JldDsKCiAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJjX3R3
aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJT
ZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXQogICAgICAgICAgICAs
ICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSk7CgogICAgJHR3aXQt
PmNhY2hlRGlyKCRwcmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10pOwoKICAgICR4bWwg
PSAkdHdpdC0+Z2V0KCd1c2Vycy9zaG93JwogICAgICAgICwgYXJyYXkoJ3NjcmVlbl9uYW1l
Jz0+JHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10pKTsKICAgICR0d2l0dGVyVXNlciA9IEAk
eG1sLT54cGF0aCgnL3VzZXInKTsKICAgICR0d2l0dGVyVXNlciA9ICR0d2l0dGVyVXNlclsw
XTsKICAgICR0d2l0dGVyVXNlclVSTCA9ICdodHRwOi8vd3d3LnR3aXR0ZXIuY29tLycuJHR3
aXR0ZXJVc2VyLT5zY3JlZW5fbmFtZTsKCiAgICBpZiAoJHN0ZXA9PSJ0d2VldCIpIHsgLy8g
cG9zdCBhbiB1cGRhdGUgdG8gVHdpdHRlcgoKICAgICAgICAvLyBmZXRjaCBhbmQgY2xlYW4g
bWVzc2FnZQogICAgICAgICRtZXNzYWdlID0gc3RyaXBfdGFncyhncHMoJ21lc3NhZ2UnKSk7
CiAgICAgICAgJGNvdW50ID0gc3RybGVuKCRtZXNzYWdlKTsKCiAgICAgICAgaWYgKCRjb3Vu
dDw9MTQwICYmICRjb3VudD4wKSB7IC8vIHBvc3QgdXBkYXRlCiAgICAgICAgICAgICRyZXN1
bHQgPSAkdHdpdC0+cG9zdCgnc3RhdHVzZXMvdXBkYXRlJywgYXJyYXkoJ3N0YXR1cycgPT4g
JG1lc3NhZ2UpKTsKICAgICAgICB9IGVsc2UgeyAvLyBtZXNzYWdlIHRvbyBsb25nLCBKYXZh
U2NyaXB0IGludGVyZmFjZSBzaG91bGQgcHJldmVudCB0aGlzCiAgICAgICAgICAgICRyZXN1
bHQgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHBhZ2V0b3AoJ1R3aXR0ZXInLAogICAg
ICAgICAgICAoKCRyZXN1bHQhPWZhbHNlKT8nVHdpdHRlciB1cGRhdGVkJzonRXJyb3IgdXBk
YXRpbmcgVHdpdHRlcicpKTsKCiAgICB9IGVsc2VpZiAoJHN0ZXA9PSJkZWxldGUiKSB7IC8v
IGRlbGV0ZSBhbiB1cGRhdGUgZnJvbSBUd2l0dGVyCgogICAgICAgICRpZCA9IHN0cmlwX3Rh
Z3MoZ3BzKCdpZCcpKTsKICAgICAgICBpZiAoJGlkKSB7CiAgICAgICAgICAgICR0d2l0LT5k
ZWxldGUoJ3N0YXR1c2VzL2Rlc3Ryb3knLiRpZCk7CiAgICAgICAgICAgIHNhZmVfZGVsZXRl
KCdhcmNfdHdpdHRlcicsInR3ZWV0X2lkID0gJGlkIik7CiAgICAgICAgfQoKICAgICAgICBw
YWdldG9wKCdUd2l0dGVyJywnVHdpdHRlciB1cGRhdGVkJyk7CgogICAgfSBlbHNlIHsKCiAg
ICAgICAgcGFnZXRvcCgnVHdpdHRlcicpOwoKICAgIH0KCiAgICAvLyBQcmVwYXJlIEphdmFT
Y3JpcHQgdG8gY3JlYXRlIFR3aXR0ZXIgdXBkYXRlIGludGVyZmFjZQoKICAgICRqcyA9ICc8
c2NyaXB0IGxhbmd1YWdlPSJqYXZhc2NyaXB0IiB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPic7
CiAgICAkanMuPSAiJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXsKICAgICAgICAgICAg
dmFyIGNvdW50ZXJTdHlsZSA9ICdmb250LXdlaWdodDpib2xkO2Zsb2F0OnJpZ2h0O2ZvbnQt
c2l6ZToyZW07bGluZS1oZWlnaHQ6MS4yZW07JzsKICAgICAgICAgICAgJCgnI3R3ZWV0Y291
bnQnKS5hdHRyKCdzdHlsZScsIGNvdW50ZXJTdHlsZSsnY29sb3I6I2NjYzsnKTsKICAgICAg
ICAgICAgJCgnI21lc3NhZ2UnKS5rZXl1cChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAg
IHZhciBjb3VudCA9IDE0MC0kKCcjbWVzc2FnZScpLnZhbCgpLmxlbmd0aDsKICAgICAgICAg
ICAgICAgICQoJyN0d2VldGNvdW50JykuaHRtbChjb3VudCsnJyk7IC8vIGhhY2sgdG8gZm9y
Y2Ugb3V0cHV0IG9mIDAKICAgICAgICAgICAgICAgIGlmIChjb3VudDwwKSB7CiAgICAgICAg
ICAgICAgICAgICAgJCgnaW5wdXQucHVibGlzaCcpLmF0dHIoJ2Rpc2FibGVkJywgJ2Rpc2Fi
bGVkJyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICQo
J2lucHV0LnB1Ymxpc2gnKS5hdHRyKCdkaXNhYmxlZCcsICcnKTsKICAgICAgICAgICAgICAg
IH0KICAgICAgICAgICAgICAgIGlmIChjb3VudDwwKSB7CiAgICAgICAgICAgICAgICAgICAg
JCgnI3R3ZWV0Y291bnQnKS5hdHRyKCdzdHlsZScsIGNvdW50ZXJTdHlsZSsnY29sb3I6I2Yw
MDsnKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY291bnQ8MTApIHsKICAgICAgICAg
ICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0eWxlJywgY291bnRlclN0eWxl
Kydjb2xvcjojMDAwOycpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg
ICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0eWxlJywgY291bnRlclN0eWxlKydj
b2xvcjojY2NjOycpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAg
IH0pOyI7CiAgICAkanMuPSAiPC9zY3JpcHQ+IjsKCiAgICAkb3V0ID0gJyc7CiAgICAkeG1s
ID0gJHR3aXQtPmdldCgnc3RhdHVzZXMvdXNlcl90aW1lbGluZScKICAgICAgICAsIGFycmF5
KCdzY3JlZW5fbmFtZSc9PiRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLCdjb3VudCc9PjI1
KSk7CiAgICAkdHdlZXRzID0gQCR4bWwtPnhwYXRoKCcvc3RhdHVzZXMvc3RhdHVzJyk7CiAg
ICBpZiAoJHR3ZWV0cykgZm9yZWFjaCAoJHR3ZWV0cyBhcyAkdHdlZXQpIHsKICAgICAgICAk
dGltZSA9IHN0cnRvdGltZShodG1sZW50aXRpZXMoJHR3ZWV0LT5jcmVhdGVkX2F0KSk7CiAg
ICAgICAgJGRhdGUgPSBzYWZlX3N0cmZ0aW1lKCRwcmVmc1snYXJjaGl2ZV9kYXRlZm9ybWF0
J10sJHRpbWUpOwogICAgICAgICRvdXQuPSB0cih0ZCgkZGF0ZSwnc3BhbicpCiAgICAgICAg
ICAgIC50ZChhcmNfVHdpdHRlcjo6bWFrZUxpbmtzKGh0bWxlbnRpdGllcygkdHdlZXQtPnRl
eHQKICAgICAgICAgICAgICAgICwgRU5UX1FVT1RFUywnVVRGLTgnKSkpCiAgICAgICAgICAg
IC50ZChkTGluaygnYXJjX2FkbWluX3R3aXR0ZXInLCdkZWxldGUnLCdpZCcsJHR3ZWV0LT5p
ZCwnJykpCiAgICAgICAgICAgICk7CiAgICB9CgogICAgJGh0bWwgPSBzdGFydFRhYmxlKCdl
ZGl0JykKICAgICAgICAgICAgLnRyKHRkKAogICAgICAgICAgICBncmFmKCc8aW1nIHNyYz0i
Jy4kdHdpdHRlclVzZXItPnByb2ZpbGVfaW1hZ2VfdXJsLiciIGFsdD0iVHdpdHRlciBhdmF0
YXIiIC8+JwogICAgICAgICAgICAsJyBzdHlsZT0iZmxvYXQ6bGVmdDtwYWRkaW5nOjJweDsi
JykKICAgICAgICAgICAgLmdyYWYoaHJlZigkdHdpdHRlclVzZXItPm5hbWUsJHR3aXR0ZXJV
c2VyVVJMKSwnIHN0eWxlPSJmb250LXNpemU6MS4yZW07Zm9udC13ZWlnaHQ6Ym9sZDsiJykK
ICAgICAgICAgICAgLmdyYWYoaHJlZigkdHdpdHRlclVzZXItPmZyaWVuZHNfY291bnQuJyBm
b2xsb3dpbmcnLCR0d2l0dGVyVXNlclVSTC4nL2ZvbGxvd2luZycpCiAgICAgICAgICAgIC4n
LCAnLmhyZWYoJHR3aXR0ZXJVc2VyLT5mb2xsb3dlcnNfY291bnQuJyBmb2xsb3dlcnMnLCR0
d2l0dGVyVXNlclVSTC4nL2ZvbGxvd2VycycpCiAgICAgICAgICAgIC4nLCAnLmhyZWYoJHR3
aXR0ZXJVc2VyLT5zdGF0dXNlc19jb3VudC4nIHVwZGF0ZXMnLCR0d2l0dGVyVXNlclVSTCkp
KSkKICAgICAgICAgICAgLnRyKHRkKGZvcm0oCiAgICAgICAgICAgIGdyYWYoIlVwZGF0ZSBU
d2l0dGVyLi4uPHNwYW4gaWQ9J3R3ZWV0Y291bnQnIHN0eWxlPSdmb250LXdlaWdodDpib2xk
O2Zsb2F0OnJpZ2h0Oyc+MTQwPC9zcGFuPiIpCiAgICAgICAgICAgIC50ZXh0X2FyZWEoJ21l
c3NhZ2UnLCc1MCcsJzU1MCcsJycsJ21lc3NhZ2UnKQogICAgICAgICAgICAuZUlucHV0KCdh
cmNfYWRtaW5fdHdpdHRlcicpCiAgICAgICAgICAgIC5zSW5wdXQoJ3R3ZWV0JykuYnIKICAg
ICAgICAgICAgLmZJbnB1dCgnc3VibWl0JywndXBkYXRlJyxnVHh0KCdVcGRhdGUnKSwncHVi
bGlzaCcpCiAgICAgICAgKSkpCiAgICAgICAgLmVuZFRhYmxlKCk7CgogICAgLy8gQXR0YWNo
IHJlY2VudCBUd2l0dGVyIHVwZGF0ZXMKCiAgICAkaHRtbC49IHN0YXJ0VGFibGUoJ2xpc3Qn
LCcnLCcnLCcnLCc5MCUnKQogICAgICAgIC4kb3V0CiAgICAgICAgLmVuZFRhYmxlKCk7Cgog
ICAgLy8gT3V0cHV0IEphdmFTY3JpcHQgYW5kIEhUTUwKCiAgICBlY2hvICRqcy4kaHRtbDsK
fQoKLy8gQWRkIFR3aXR0ZXIgb3B0aW9ucyB0byBhcnRpY2xlIGFydGljbGUgc2NyZWVuCmZ1
bmN0aW9uIGFyY19hcHBlbmRfdHdpdHRlcigkZXZlbnQsICRzdGVwLCAkZGF0YSwgJHJzMSkK
ewogICAgZ2xvYmFsICRwcmVmcywgJGFyY190d2l0dGVyOwogICAgJHByZWZpeCA9IHRyaW0o
Z3BzKCdhcmNfdHdpdHRlcl9wcmVmaXgnKSk7CiAgICAkcHJlZml4ID0gKCRwcmVmaXgpID8g
JHByZWZpeCA6ICRwcmVmc1snYXJjX3R3aXR0ZXJfcHJlZml4J107CiAgICAkc3VmZml4ID0g
dHJpbShncHMoJ2FyY190d2l0dGVyX3N1ZmZpeCcpKTsKCiAgICBpZiAoJHJzMVsnSUQnXSkg
ewogICAgICAgICRzcWwgPSAiU0VMRUNUIHR3ZWV0X2lkLHR3ZWV0IEZST00gIi5QRlguImFy
Y190d2l0dGVyIFdIRVJFIGFydGljbGVfaWQ9Ii4kcnMxWydJRCddLiI7IjsKICAgICAgICAk
cnMyID0gc2FmZV9xdWVyeSgkc3FsKTsgJHJzMiA9IG5leHRSb3coJHJzMik7CiAgICB9IGVs
c2UgeyAvLyBuZXcgYXJ0aWNsZQogICAgICAgICRyczIgPSAnJzsKICAgIH0KCiAgICBpZiAo
JHJzMVsnSUQnXSAmJiAkcnMyWyd0d2VldF9pZCddKSB7CiAgICAgICAgJGNvbnRlbnQgPSBh
cmNfVHdpdHRlcjo6bWFrZUxpbmtzKCRyczJbJ3R3ZWV0J10pOwogICAgICAgIHJldHVybiAk
ZGF0YS5maWVsZHNldCgkY29udGVudCwgJ1R3aXR0ZXIgdXBkYXRlJywgJ2FyY190d2l0dGVy
Jyk7CiAgICB9IGVsc2UgewogICAgICAgICR2YXIgPSBncHMoJ2FyY190d2VldF90aGlzJyk7
CiAgICAgICAgJHZhciA9ICgkcnMxWydJRCddJiYhJHZhcikgPyAwIDogJHByZWZzWydhcmNf
dHdpdHRlcl90d2VldF9kZWZhdWx0J107CiAgICAgICAgJGNvbnRlbnQgID0gdGFnKHllc25v
UmFkaW8oJ2FyY190d2VldF90aGlzJywgJHZhciwgJycsICdhcmNfdHdlZXRfdGhpcycpLCdw
Jyk7CiAgICAgICAgJGNvbnRlbnQgLj0gdGFnKGhyZWYoJ09wdGlvbnMnLCcjYXJjX3R3aXR0
ZXJfb3B0aW9ucycpLCdwJywnIGNsYXNzPSJwbGFpbiBsZXZlciIgc3R5bGU9Im1hcmdpbi10
b3A6NXB4OyInKTsKICAgICAgICAkY29udGVudCAuPSB0YWcodGFnKHRhZygnVHdlZXQgcHJl
Zml4JywnbGFiZWwnLCAnIGZvcj0iYXJjX3R3aXR0ZXJfcHJlZml4IicpCiAgICAgICAgICAg
IC5mSW5wdXQoJ3RleHQnLCdhcmNfdHdpdHRlcl9wcmVmaXgnLCRwcmVmaXgsJ2VkaXQnLCcn
LCcnLCcyMicsJycsJ2FyY190d2l0dGVyX3ByZWZpeCcpLCdwJykKICAgICAgICAgICAgLnRh
Zyh0YWcoJ1R3ZWV0IHN1ZmZpeCAoZWcgI2hhc2h0YWdzKScsJ2xhYmVsJywgJyBmb3I9ImFy
Y190d2l0dGVyX3N1ZmZpeCInKQogICAgICAgICAgICAuZklucHV0KCd0ZXh0JywnYXJjX3R3
aXR0ZXJfc3VmZml4Jywkc3VmZml4LCdlZGl0JywnJywnJywnMjInLCcnLCdhcmNfdHdpdHRl
cl9zdWZmaXgnKSwncCcpCiAgICAgICAgICAgICwnZGl2JywnIGlkPSJhcmNfdHdpdHRlcl9v
cHRpb25zIiBjbGFzcz0idG9nZ2xlIiBzdHlsZT0iZGlzcGxheTpub25lIicpOwogICAgICAg
IGlmIChpc3NldCgkYXJjX3R3aXR0ZXJbJ2Vycm9yJ10pKSB7CiAgICAgICAgICAgICRjb250
ZW50IC49ICc8cD4nLiRhcmNfdHdpdHRlclsnZXJyb3InXS4nPC9wPic7CiAgICAgICAgfQog
ICAgICAgIHJldHVybiAkZGF0YS5maWVsZHNldCgkY29udGVudCwgJ1VwZGF0ZSBUd2l0dGVy
JywgJ2FyY190d2l0dGVyJyk7CiAgICB9Cgp9CgovLyBVcGRhdGUgVHdpdHRlciB3aXRoIHBv
c3RlZCBhcnRpY2xlCmZ1bmN0aW9uIGFyY19hcnRpY2xlX3R3ZWV0KCRldmVudCwkc3RlcCkK
ewogICAgZ2xvYmFsICRwcmVmcywgJGFyY190d2l0dGVyLCAkYXJjX3R3aXR0ZXJfY29uc3Vt
ZXJLZXkKICAgICAgICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiAgICAkYXJ0
aWNsZV9pZCA9IGVtcHR5KCRHTE9CQUxTWydJRCddKSA/IGdwcygnSUQnKSA6ICRHTE9CQUxT
WydJRCddOwogICAgaWYgKCFlbXB0eSgkYXJ0aWNsZV9pZCkpIHsKCiAgICAgICAgaW5jbHVk
ZV9vbmNlIHR4cGF0aC4nL3B1Ymxpc2gvdGFnaGFuZGxlcnMucGhwJzsKCiAgICAgICAgJGFy
dGljbGUgPSBzYWZlX3JvdygiSUQsIFRpdGxlLCBTZWN0aW9uLCBQb3N0ZWQiLCAndGV4dHBh
dHRlcm4nLAogICAgICAgICAgICAiSUQ9eyRhcnRpY2xlX2lkfSBBTkQgU3RhdHVzPTQgQU5E
IG5vdygpPj1Qb3N0ZWQiKTsKCiAgICAgICAgaWYgKCRhcnRpY2xlICYmIGdwcygnYXJjX3R3
ZWV0X3RoaXMnKSkgeyAvLyB0d2VldCBhcnRpY2xlCgogICAgICAgICAgICAvLyBOZWVkIHRv
IG1hbnVhbGx5IHVwZGF0ZSB0aGUgJ1VSTCBvbmx5IHRpdGxlJyBiZWZvcmUgYnVpbGRpbmcg
dGhlCiAgICAgICAgICAgIC8vIFVSTAogICAgICAgICAgICAkYXJ0aWNsZVsndXJsX3RpdGxl
J10gPSBncHMoJ3VybF90aXRsZScpOwogICAgICAgICAgICAvLyBNYWtlIHNob3J0IFVSTAog
ICAgICAgICAgICAkdXJsID0gcGVybWxpbmt1cmwoJGFydGljbGUpOwogICAgICAgICAgICAk
c2hvcnRfdXJsID0gYXJjX3Nob3J0ZW5fdXJsKCR1cmwsJHByZWZzWydhcmNfdHdpdHRlcl91
cmxfbWV0aG9kJ10sCiAgICAgICAgICAgICAgICBhcnJheSgnaWQnPT4kYXJ0aWNsZV9pZCkp
OwoKICAgICAgICAgICAgaWYgKCEkc2hvcnRfdXJsKSB7IC8vIEZhaWxlZCB0byBvYnRhaW4g
YSBzaG9ydGVuZWQgVVJMLCBkbyBub3QgdHdlZXQhCiAgICAgICAgICAgICAgICAkYXJjX3R3
aXR0ZXJbJ2Vycm9yJ10gPSAnVW5hYmxlIHRvIG9idGFpbiBhIHNob3J0IFVSTCBmb3IgdGhp
cyBhcnRpY2xlLic7CgogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAg
ICB9CgogICAgICAgICAgICAvLyBDb25zdHJ1Y3QgVHdpdHRlciB1cGRhdGUKICAgICAgICAg
ICAgJHByZWZpeCAgPSB0cmltKGdwcygnYXJjX3R3aXR0ZXJfcHJlZml4JykpOwogICAgICAg
ICAgICAkcHJlX2xlbiA9IHN0cmxlbigkcHJlZml4KTsKICAgICAgICAgICAgJHByZWZpeCAg
PSAoJHByZWZpeCAmJiAkcHJlX2xlbjw9MjApID8gJHByZWZpeC4nICcgOiAnJzsKICAgICAg
ICAgICAgJHN1ZmZpeCAgPSB0cmltKGdwcygnYXJjX3R3aXR0ZXJfc3VmZml4JykpOwogICAg
ICAgICAgICAkc3VmX2xlbiA9IHN0cmxlbigkc3VmZml4KTsKICAgICAgICAgICAgJHN1ZmZp
eCAgPSAoJHN1ZmZpeCAmJiAkc3VmX2xlbjw9NDApID8gJyAnLiRzdWZmaXggOiAnJzsKICAg
ICAgICAgICAgJHVybF9sZW4gPSBzdHJsZW4oJHNob3J0X3VybCkrMTsgLy8gY291bnQgVVJM
IGxlbmd0aCArIDEgZm9yIHByZWZpeGVkIHNwYWNlCiAgICAgICAgICAgIGlmICgkcHJlZml4
KSAkcHJlX2xlbiArPSAxOwogICAgICAgICAgICBpZiAoJHN1ZmZpeCkgJHN1Zl9sZW4gKz0g
MTsKICAgICAgICAgICAgaWYgKChzdHJsZW4oJGFydGljbGVbJ1RpdGxlJ10pKyR1cmxfbGVu
KyRwcmVfbGVuKyRzdWZfbGVuKT4xNDApIHsKICAgICAgICAgICAgICAgICRhcnRpY2xlWydU
aXRsZSddID0gc3Vic3RyKCRhcnRpY2xlWydUaXRsZSddLDAsMTM1LSR1cmxfbGVuLSRwcmVf
bGVuLSRzdWZfbGVuKS4nLi4uJzsKICAgICAgICAgICAgfQogICAgICAgICAgICAkdHdlZXQg
PSAkcHJlZml4LiRhcnRpY2xlWydUaXRsZSddLiIgIi4kc2hvcnRfdXJsLiRzdWZmaXg7Cgog
ICAgICAgICAgICAvLyBVcGRhdGUgVHdpdHRlcgogICAgICAgICAgICAkdHdpdCA9IG5ldyBh
cmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgICAgICwg
JGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vz
c1Rva2VuJ10KICAgICAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NU
b2tlblNlY3JldCddKTsKICAgICAgICAgICAgJHJlc3VsdCA9ICR0d2l0LT5wb3N0KCdzdGF0
dXNlcy91cGRhdGUnLCBhcnJheSgnc3RhdHVzJyA9PiAkdHdlZXQpKTsKCiAgICAgICAgICAg
ICR0d2VldF9pZCA9IChpc19vYmplY3QoJHJlc3VsdCkpID8gJHJlc3VsdFswXS0+aWQgOiAw
OwoKICAgICAgICAgICAgaWYgKCR0d2VldF9pZCkgewoKICAgICAgICAgICAgICAgICR0d2Vl
dCA9IGFkZHNsYXNoZXMoJHR3ZWV0KTsKCiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgYXJj
X3R3aXR0ZXIgdGFibGUgd2l0aCB0d2VldAogICAgICAgICAgICAgICAgJHNxbCA9ICJJTlNF
UlQgSU5UTyAiLlBGWC4iYXJjX3R3aXR0ZXIgKGFydGljbGVfaWQsdHdlZXRfaWQsdHdlZXQs
dGlueXVybCkgIjsKICAgICAgICAgICAgICAgICRzcWwuPSAiVkFMVUVTKCRhcnRpY2xlX2lk
LCR0d2VldF9pZCxcIiR0d2VldFwiLCckc2hvcnRfdXJsJyk7IjsKICAgICAgICAgICAgICAg
IHNhZmVfcXVlcnkoJHNxbCk7CgogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CgogICAg
ICAgICAgICB9IGVsc2UgewoKICAgICAgICAgICAgICAgICRhcmNfdHdpdHRlclsnZXJyb3In
XSA9ICdUd2l0dGVyIHJlc3BvbnNlOiAnCiAgICAgICAgICAgICAgICAgICAgLiR0d2l0LT5o
dHRwX2NvZGU7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICB9
CgogICAgICAgIH0KCiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwoKfQoKLyoKICogU2hvcnRl
biBVUkxzIHVzaW5nIHZhcmlvdXMgbWV0aG9kcwogKi8KCmZ1bmN0aW9uIGFyY19zaG9ydGVu
X3VybCgkdXJsLCAkbWV0aG9kPScnLCAkYXR0cz1hcnJheSgpKQp7CiAgZ2xvYmFsICRwcmVm
czsKCiAgJGNoID0gY3VybF9pbml0KCk7CiAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX0hF
QURFUiwgMCk7CiAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCB0
cnVlKTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVElNRU9VVCwgMTApOwoKICBzd2l0
Y2ggKCRtZXRob2QpIHsKICAgIGNhc2UgJ3NtZCc6IC8vIGNyZWF0ZSBhIHNob3J0ZW5lZCBV
UkwgdXNpbmcgU01EIFNob3J0IFVSTAogICAgICByZXR1cm4gKCRhdHRzWydpZCddKSA/IGh1
LiRhdHRzWydpZCddIDogZmFsc2U7IGJyZWFrOwogICAgY2FzZSAnYXJjX3R3aXR0ZXInOiAv
LyBuYXRpdmUgVVJMIHNob3J0ZW5pbmcKCiAgICAgIHJldHVybiAoJGF0dHNbJ2lkJ10pID8g
UFJPVE9DT0wuJHByZWZzWydhcmNfc2hvcnRfc2l0ZV91cmwnXS4nLycuJGF0dHNbJ2lkJ10g
OiBmYWxzZTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAnaXNnZCc6CgogICAgICAkdSA9ICdo
dHRwOi8vaXMuZ2QvYXBpLnBocD9sb25ndXJsPScudXJsZW5jb2RlKCR1cmwpOwogICAgICBj
dXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVVJMLCAkdSk7CgogICAgICAkdGlueXVybCA9IGN1
cmxfZXhlYygkY2gpOwogICAgICBpZiAoJHRpbnl1cmwhPSdFcnJvcicgJiYgJHRpbnl1cmwh
PScnKSB7CiAgICAgICAgcmV0dXJuICR0aW55dXJsOwogICAgICB9IGVsc2UgewogICAgICAg
IHRyaWdnZXJfZXJyb3IoJ2FyY190d2l0dGVyIGZhaWxlZCB0byBnZXQgYSBpcy5nZCBVUkwg
Zm9yICcKICAgICAgICAgICAgLiR1cmwsRV9VU0VSX1dBUk5JTkcpOwogICAgICB9CiAgICAg
IGJyZWFrOwoKICAgIGNhc2UgJ3Rpbnl1cmwnOiBkZWZhdWx0OiAvLyBjcmVhdGUgYSBzaG9y
dGVuZWQgVVJMIHVzaW5nIFRpbnlVUkwKCiAgICAgICR1ID0gJ2h0dHA6Ly90aW55dXJsLmNv
bS9hcGktY3JlYXRlLnBocD91cmw9Jy51cmxlbmNvZGUoJHVybCk7CiAgICAgIGN1cmxfc2V0
b3B0KCRjaCwgQ1VSTE9QVF9VUkwsICR1KTsKICAgICAgJHRpbnl1cmwgPSBjdXJsX2V4ZWMo
JGNoKTsKICAgICAgaWYgKCR0aW55dXJsIT0nRXJyb3InICYmICR0aW55dXJsIT0nJykgewog
ICAgICAgIHJldHVybiAkdGlueXVybDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0cmlnZ2Vy
X2Vycm9yKCdhcmNfdHdpdHRlciBmYWlsZWQgdG8gZ2V0IGEgVGlueVVSTCBmb3IgJy4kdXJs
LEVfVVNFUl9XQVJOSU5HKTsKICAgICAgfQoKICB9CgogIHJldHVybiBmYWxzZTsgLy8gZmFp
bAoKfQoKLyoKICogU2hvcnRlbmVkIFVSTCByZWRpcmVjdCBiYXNlZCBvbiBzbWRfc2hvcnRf
dXJsCiAqLwpmdW5jdGlvbiBhcmNfc2hvcnRfdXJsX3JlZGlyZWN0KCRldmVudCwgJHN0ZXAp
IHsKICBnbG9iYWwgJHByZWZzOwoKICAkaGF2ZV9pZCA9IDA7CgogIC8vIENoZWNrIGlmIHRo
ZXJlIGlzIGFuIGF2YWlsYWJsZSBzaG9ydCBzaXRlIHVybCBhbmQgaWYgaXQgaXMgYmVpbmcg
dXNlZCBpbgogIC8vIHRoaXMgaW5zdGFuY2UKICAkc2hvcnRfc2l0ZV91cmwgPSAkcHJlZnNb
J2FyY19zaG9ydF9zaXRlX3VybCddOwogIGlmICgkc2hvcnRfc2l0ZV91cmwpIHsKICAgICRz
aG9ydF9zaXRlX3VybCA9IFBST1RPQ09MLiRzaG9ydF9zaXRlX3VybC4nLyc7CiAgICAkdXJs
X3BhcnRzID0gcGFyc2VfdXJsKCRzaG9ydF9zaXRlX3VybCk7CiAgICAkcmUgPSAnI14nLiR1
cmxfcGFydHNbJ3BhdGgnXS4nKFswLTldLiopIyc7CiAgICAkaGF2ZV9pZCA9IHByZWdfbWF0
Y2goJHJlLCAkX1NFUlZFUlsnUkVRVUVTVF9VUkknXSwgJG0pOwogIH0KCiAgLy8gRmFsbCBi
YWNrIHRvIHN0YW5kYXJkIHNpdGUgdXJsIChzbWRfc2hvcnRfdXJsIGJlaGF2aW91cikKICBp
ZiAoJGhhdmVfaWQpIHsKICAgICR1cmxfcGFydHMgPSBwYXJzZV91cmwoaHUpOwogICAgJHJl
ID0gJyNeJy4kdXJsX3BhcnRzWydwYXRoJ10uJyhbMC05XS4qKSMnOwogICAgJGhhdmVfaWQg
PSBwcmVnX21hdGNoKCRyZSwgJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ10sICRtKTsKICB9Cgog
IC8vIERvIHRoZSByZWRpcmVjdCBpZiB3ZSd2ZSBnb3QgYW4gYXJ0aWNsZSBpZAogIGlmICgk
aGF2ZV9pZCkgewoJICAkaWQgPSAkbVsxXTsKCSAgJHBlcm1saW5rID0gcGVybWxpbmt1cmxf
aWQoJGlkKTsKCgkgIGlmICgkcGVybWxpbmspIHsKCQkgIG9iX2VuZF9jbGVhbigpOwoKCQkg
IC8vIFN0dXBpZCwgb3ZlciB0aGUgdG9wIGhlYWRlciBzZXR0aW5nIGZvciBJRQoJCSAgaGVh
ZGVyKCJTdGF0dXM6IDMwMSIpOwoJCSAgaGVhZGVyKCJIVFRQLzEuMCAzMDEgTW92ZWQgUGVy
bWFuZW50bHkiKTsKCQkgIGhlYWRlcigiTG9jYXRpb246ICIuJHBlcm1saW5rLCBUUlVFLCAz
MDEpOwoKCQkgIC8vIEluIGNhc2UgdGhlIGhlYWRlcigpIG1ldGhvZCBmYWlscywgZmFsbCBi
YWNrIG9uIGEgY2xhc3NpYyByZWRpcmVjdAoJCSAgZWNobyAnPGh0bWw+PGhlYWQ+PE1FVEEg
SFRUUC1FUVVJVj0iUmVmcmVzaCIgQ09OVEVOVD0iMDtVUkw9JwoJCSAgICAuJHBlcm1saW5r
LiciPjwvaGVhZD48Ym9keT48L2JvZHk+PC9odG1sPic7CgkJICBkaWUoKTsKCSAgfQogIH0K
Cn0KCi8qCiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiovCgpjbGFzcyBhcmNfdHdpdHRl
ciBleHRlbmRzIFR3aXR0ZXJPQXV0aCB7CiAgICAvLyBDYWNoaW5nIHZhcmlhYmxlcwogICAg
cHJpdmF0ZSAkX2NhY2hlID0gdHJ1ZTsKICAgIHByaXZhdGUgJF9jYWNoZV9kaXIgPSAnLi90
bXAnOwogICAgcHJpdmF0ZSAkX2NhY2hlX3RpbWUgPSAxODAwOyAvLyAzMCBtaW51dGUgY2Fj
aGUKCiAgICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkY29uc3VtZXJfa2V5LCAkY29uc3VtZXJf
c2VjcmV0LCAkb2F1dGhfdG9rZW4gPSBOVUxMCiAgICAgICAgLCAkb2F1dGhfdG9rZW5fc2Vj
cmV0ID0gTlVMTCkKICAgIHsKICAgICAgICBwYXJlbnQ6Ol9fY29uc3RydWN0KCRjb25zdW1l
cl9rZXksICRjb25zdW1lcl9zZWNyZXQsICRvYXV0aF90b2tlbgogICAgICAgICAgICAsICRv
YXV0aF90b2tlbl9zZWNyZXQpOwogICAgICAgICR0aGlzLT5mb3JtYXQgPSAneG1sJzsKICAg
ICAgICAkdGhpcy0+dGltZW91dCA9IDE1OwogICAgICAgICR0aGlzLT5jb25uZWN0dGltZW91
dCA9IDE1OwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjYWxsYmFja1VSTCgkZXZlbnQs
JHN0ZXApCiAgICB7CiAgICAgICAgcmV0dXJuIGh1Lid0ZXh0cGF0dGVybi9pbmRleC5waHA/
ZXZlbnQ9Jy4kZXZlbnQuJyZhbXA7c3RlcD0nLiRzdGVwOwogICAgfQoKICAgIC8vIGNyZWF0
ZSBUd2l0dGVyIGFuZCBleHRlcm5hbCBsaW5rcyBpbiB0ZXh0CiAgICBwdWJsaWMgc3RhdGlj
IGZ1bmN0aW9uIG1ha2VMaW5rcygkdGV4dCkKICAgIHsKICAgICAgICAkdXJsID0gJy9cYiho
dHRwfGh0dHBzfGZ0cCk6XC9cLyhbQS1aMC05XVtBLVowLTlfLV0qKD86XC5bQS1aMC05XVtB
LVowLTlfLV0qKSspOj8oXGQrKT9cLz8oW1wvXHcrXC5dKylcYi9pJzsKICAgICAgICAkdGV4
dCA9IHByZWdfcmVwbGFjZSgkdXJsLCAiPGEgaHJlZj0nJDAnPiQwPC9hPiIsICR0ZXh0KTsK
ICAgICAgICAkdXJsID0gJy9cYihefFxzKXd3dy4oW2Etel9BLVowLTldKykoKFwuW2Etel0r
KSspXGIvaSc7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2UoJHVybCwgIjxhIGhyZWY9
J2h0dHA6Ly93d3cuJDIkMyc+d3d3LiQyJDM8L2E+IiwgJHRleHQpOwogICAgICAgICR0ZXh0
ID0gcHJlZ19yZXBsYWNlKCIvKF58XHMpQChbYS16X0EtWjAtOV0rKS8iLAogICAgICAgICAg
ICAiJDFAPGEgaHJlZj0naHR0cDovL3R3aXR0ZXIuY29tLyQyJz4kMjwvYT4iLCR0ZXh0KTsK
ICAgICAgICAkdGV4dCA9IHByZWdfcmVwbGFjZSgiLyhefFxzKShcIyhbYS16X0EtWjAtOTpf
LV0rKSkvIiwKICAgICAgICAgICAgIiQxPGEgaHJlZj0naHR0cDovL3R3aXR0ZXIuY29tL3Nl
YXJjaD9xPSUyMyQzJz4kMjwvYT4iLCR0ZXh0KTsKICAgICAgICByZXR1cm4gJHRleHQ7CiAg
fQoKICAgIHB1YmxpYyBmdW5jdGlvbiBnZXQoJHVybCwgJHBhcmFtcyA9IGFycmF5KCkpCiAg
ICB7CiAgICAgICAgJGFwaV91cmwgPSBtZDUoJHVybC51cmxlbmNvZGUoc2VyaWFsaXplKCRw
YXJhbXMpKSk7CiAgICAgICAgJGRhdGEgPSAnJzsKCiAgICAgICAgaWYgKCR0aGlzLT5fY2Fj
aGUpIHsgLy8gY2hlY2sgZm9yIGNhY2hlZCB4bWwKCiAgICAgICAgICAgICRkYXRhID0gJHRo
aXMtPl9yZXRyaWV2ZUNhY2hlKCRhcGlfdXJsKTsKCiAgICAgICAgfQogICAgICAgIGlmIChl
bXB0eSgkZGF0YSkpIHsKICAgICAgICAgICAgJGRhdGEgPSBwYXJlbnQ6OmdldCgkdXJsLCAk
cGFyYW1zKTsKICAgICAgICAgICAgaWYgKCR0aGlzLT5odHRwX2NvZGU9PT0yMDAgJiYgJHht
bD1zaW1wbGV4bWxfbG9hZF9zdHJpbmcoJGRhdGEpKSB7IC8vIHNhdmUgY2FjaGUKICAgICAg
ICAgICAgICAgICRmaWxlID0gJHRoaXMtPl9jYWNoZV9kaXIuJy8nLiRhcGlfdXJsOwogICAg
ICAgICAgICAgICAgZmlsZV9wdXRfY29udGVudHMoJGZpbGUsJGRhdGEsTE9DS19FWCk7CiAg
ICAgICAgICAgICAgICByZXR1cm4gJHhtbDsKICAgICAgICAgICAgfSBlbHNlIHsgLy8gZmFp
bGVkIHRvIHJldHJpZXZlIGRhdGEgZnJvbSBUd2l0dGVyCgogICAgICAgICAgICAgICAgaWYg
KCR0aGlzLT5fY2FjaGUpIHsgLy8gYXR0ZW1wdCB0byBmb3JjZSBjYWNoZWQgeG1sIHJldHVy
bgoKICAgICAgICAgICAgICAgICAgICAkZGF0YSA9ICR0aGlzLT5fcmV0cmlldmVDYWNoZSgk
YXBpX3VybCx0cnVlKTsKICAgICAgICAgICAgICAgICAgICBpZiAoJGRhdGEpIHJldHVybiBA
c2ltcGxleG1sX2xvYWRfc3RyaW5nKCRkYXRhKTsKCiAgICAgICAgICAgICAgICB9CgogICAg
ICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAgfQogICAgICAgIH0gZWxz
ZSB7IC8vIHJldHVybiBjYWNoZWQgeG1sCiAgICAgICAgICAgIHJldHVybiBAc2ltcGxleG1s
X2xvYWRfc3RyaW5nKCRkYXRhKTsKICAgICAgICB9CiAgICB9IC8vZW5kIGdldCgpCgogICAg
ZnVuY3Rpb24gcG9zdCgkdXJsLCAkcGFyYW1zID0gYXJyYXkoKSkKICAgIHsKICAgICAgICAk
ZGF0YSA9IHBhcmVudDo6cG9zdCgkdXJsLCRwYXJhbXMpOwogICAgICAgIHJldHVybiBzaW1w
bGV4bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlbGV0ZSgk
dXJsLCAkcGFyYW1zID0gYXJyYXkoKSkKICAgIHsKICAgICAgICAkZGF0YSA9IHBhcmVudDo6
ZGVsZXRlKCR1cmwsJHBhcmFtcyk7CiAgICAgICAgcmV0dXJuIHNpbXBsZXhtbF9sb2FkX3N0
cmluZygkZGF0YSk7CiAgICB9CgogICAgLy8gQ2FjaGUgbWV0aG9kcwoKICAgIHB1YmxpYyBm
dW5jdGlvbiBzZXRDYWNoaW5nKCRjYWNoZT10cnVlKQogICAgewogICAgICAgICR0aGlzLT5f
Y2FjaGUgPSAoJGNhY2hlKSA/IHRydWUgOiBmYWxzZTsKICAgICAgICByZXR1cm4gdHJ1ZTsK
ICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gY2FjaGVEaXIoJGxvYykKICAgIHsKICAgICAg
ICAkdGhpcy0+X2NhY2hlX2RpciA9ICRsb2M7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9
CgogICAgcHVibGljIGZ1bmN0aW9uIGNhY2hlVGltZSgkbWlucykKICAgIHsKICAgICAgICAk
dGhpcy0+X2NhY2hlX3RpbWUgPSAkbWlucyo2MDsgLy8gY29udmVydCBtaW51dGVzIGludG8g
c2Vjb25kcwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHByaXZhdGUgZnVuY3Rp
b24gX3JldHJpZXZlQ2FjaGUoJHVybCwkb3ZlcmlkZV90aW1lb3V0PWZhbHNlKQogICAgewog
ICAgICAgICRmaWxlID0gJHRoaXMtPl9jYWNoZV9kaXIuJy8nLiR1cmw7CiAgICAgICAgaWYg
KGZpbGVfZXhpc3RzKCRmaWxlKSkgewoKICAgICAgICAgICAgJGRpZmYgPSB0aW1lKCkgLSBm
aWxlbXRpbWUoJGZpbGUpOwogICAgICAgICAgICBpZiAoJG92ZXJpZGVfdGltZW91dCB8fCAk
ZGlmZiA8ICR0aGlzLT5fY2FjaGVfdGltZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZp
bGVfZ2V0X2NvbnRlbnRzKCRmaWxlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAg
ICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICB9IGVsc2Ugewog
ICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQp9CgovKgogKiBBYnJh
aGFtIFdpbGxpYW1zIChhYnJhaGFtQGFicmFoLmFtKSBodHRwOi8vYWJyYWguYW0KICoKICog
VGhlIGZpcnN0IFBIUCBMaWJyYXJ5IHRvIHN1cHBvcnQgT0F1dGggZm9yIFR3aXR0ZXIncyBS
RVNUIEFQSS4KICovCgovKioKICogVHdpdHRlciBPQXV0aCBjbGFzcwogKi8KY2xhc3MgVHdp
dHRlck9BdXRoIHsKICAvKiBDb250YWlucyB0aGUgbGFzdCBIVFRQIHN0YXR1cyBjb2RlIHJl
dHVybmVkLiAqLwogIHB1YmxpYyAkaHR0cF9jb2RlOwogIC8qIENvbnRhaW5zIHRoZSBsYXN0
IEFQSSBjYWxsLiAqLwogIHB1YmxpYyAkdXJsOwogIC8qIFNldCB1cCB0aGUgQVBJIHJvb3Qg
VVJMLiAqLwogIHB1YmxpYyAkaG9zdCA9ICJodHRwczovL2FwaS50d2l0dGVyLmNvbS8xLyI7
CiAgLyogU2V0IHRpbWVvdXQgZGVmYXVsdC4gKi8KICBwdWJsaWMgJHRpbWVvdXQgPSAzMDsK
ICAvKiBTZXQgY29ubmVjdCB0aW1lb3V0LiAqLwogIHB1YmxpYyAkY29ubmVjdHRpbWVvdXQg
PSAzMDsKICAvKiBWZXJpZnkgU1NMIENlcnQuICovCiAgcHVibGljICRzc2xfdmVyaWZ5cGVl
ciA9IEZBTFNFOwogIC8qIFJlc3BvbnMgZm9ybWF0LiAqLwogIHB1YmxpYyAkZm9ybWF0ID0g
J2pzb24nOwogIC8qIERlY29kZSByZXR1cm5lZCBqc29uIGRhdGEuICovCiAgcHVibGljICRk
ZWNvZGVfanNvbiA9IFRSVUU7CiAgLyogQ29udGFpbnMgdGhlIGxhc3QgSFRUUCBoZWFkZXJz
IHJldHVybmVkLiAqLwogIHB1YmxpYyAkaHR0cF9pbmZvOwogIC8qIFNldCB0aGUgdXNlcmFn
bmV0LiAqLwogIHB1YmxpYyAkdXNlcmFnZW50ID0gJ1R3aXR0ZXJPQXV0aCB2MC4yLjAtYmV0
YTInOwogIC8qIEltbWVkaWF0ZWx5IHJldHJ5IHRoZSBBUEkgY2FsbCBpZiB0aGUgcmVzcG9u
c2Ugd2FzIG5vdCBzdWNjZXNzZnVsLiAqLwogIC8vcHVibGljICRyZXRyeSA9IFRSVUU7CgoK
CgogIC8qKgogICAqIFNldCBBUEkgVVJMUwogICAqLwogIGZ1bmN0aW9uIGFjY2Vzc1Rva2Vu
VVJMKCkgIHsgcmV0dXJuICdodHRwczovL2FwaS50d2l0dGVyLmNvbS9vYXV0aC9hY2Nlc3Nf
dG9rZW4nOyB9CiAgZnVuY3Rpb24gYXV0aGVudGljYXRlVVJMKCkgeyByZXR1cm4gJ2h0dHBz
Oi8vdHdpdHRlci5jb20vb2F1dGgvYXV0aGVudGljYXRlJzsgfQogIGZ1bmN0aW9uIGF1dGhv
cml6ZVVSTCgpICAgIHsgcmV0dXJuICdodHRwczovL3R3aXR0ZXIuY29tL29hdXRoL2F1dGhv
cml6ZSc7IH0KICBmdW5jdGlvbiByZXF1ZXN0VG9rZW5VUkwoKSB7IHJldHVybiAnaHR0cHM6
Ly9hcGkudHdpdHRlci5jb20vb2F1dGgvcmVxdWVzdF90b2tlbic7IH0KCiAgLyoqCiAgICog
RGVidWcgaGVscGVycwogICAqLwogIGZ1bmN0aW9uIGxhc3RTdGF0dXNDb2RlKCkgeyByZXR1
cm4gJHRoaXMtPmh0dHBfc3RhdHVzOyB9CiAgZnVuY3Rpb24gbGFzdEFQSUNhbGwoKSB7IHJl
dHVybiAkdGhpcy0+bGFzdF9hcGlfY2FsbDsgfQoKICAvKioKICAgKiBjb25zdHJ1Y3QgVHdp
dHRlck9BdXRoIG9iamVjdAogICAqLwogIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRjb25zdW1l
cl9rZXksICRjb25zdW1lcl9zZWNyZXQsICRvYXV0aF90b2tlbiA9IE5VTEwsICRvYXV0aF90
b2tlbl9zZWNyZXQgPSBOVUxMKSB7CiAgICAkdGhpcy0+c2hhMV9tZXRob2QgPSBuZXcgT0F1
dGhTaWduYXR1cmVNZXRob2RfSE1BQ19TSEExKCk7CiAgICAkdGhpcy0+Y29uc3VtZXIgPSBu
ZXcgT0F1dGhDb25zdW1lcigkY29uc3VtZXJfa2V5LCAkY29uc3VtZXJfc2VjcmV0KTsKICAg
IGlmICghZW1wdHkoJG9hdXRoX3Rva2VuKSAmJiAhZW1wdHkoJG9hdXRoX3Rva2VuX3NlY3Jl
dCkpIHsKICAgICAgJHRoaXMtPnRva2VuID0gbmV3IE9BdXRoQ29uc3VtZXIoJG9hdXRoX3Rv
a2VuLCAkb2F1dGhfdG9rZW5fc2VjcmV0KTsKICAgIH0gZWxzZSB7CiAgICAgICR0aGlzLT50
b2tlbiA9IE5VTEw7CiAgICB9CiAgfQoKCiAgLyoqCiAgICogR2V0IGEgcmVxdWVzdF90b2tl
biBmcm9tIFR3aXR0ZXIKICAgKgogICAqIEByZXR1cm5zIGEga2V5L3ZhbHVlIGFycmF5IGNv
bnRhaW5pbmcgb2F1dGhfdG9rZW4gYW5kIG9hdXRoX3Rva2VuX3NlY3JldAogICAqLwogIGZ1
bmN0aW9uIGdldFJlcXVlc3RUb2tlbigkb2F1dGhfY2FsbGJhY2sgPSBOVUxMKSB7CiAgICAk
cGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICBpZiAoIWVtcHR5KCRvYXV0aF9jYWxsYmFjaykp
IHsKICAgICAgJHBhcmFtZXRlcnNbJ29hdXRoX2NhbGxiYWNrJ10gPSAkb2F1dGhfY2FsbGJh
Y2s7CiAgICB9CiAgICAkcmVxdWVzdCA9ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHRoaXMtPnJl
cXVlc3RUb2tlblVSTCgpLCAnR0VUJywgJHBhcmFtZXRlcnMpOwogICAgJHRva2VuID0gT0F1
dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKCRyZXF1ZXN0KTsKICAgICR0aGlzLT50b2tlbiA9
IG5ldyBPQXV0aENvbnN1bWVyKCR0b2tlblsnb2F1dGhfdG9rZW4nXSwgJHRva2VuWydvYXV0
aF90b2tlbl9zZWNyZXQnXSk7CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAgLyoqCiAgICog
R2V0IHRoZSBhdXRob3JpemUgVVJMCiAgICoKICAgKiBAcmV0dXJucyBhIHN0cmluZwogICAq
LwogIGZ1bmN0aW9uIGdldEF1dGhvcml6ZVVSTCgkdG9rZW4sICRzaWduX2luX3dpdGhfdHdp
dHRlciA9IFRSVUUpIHsKICAgIGlmIChpc19hcnJheSgkdG9rZW4pKSB7CiAgICAgICR0b2tl
biA9ICR0b2tlblsnb2F1dGhfdG9rZW4nXTsKICAgIH0KICAgIGlmIChlbXB0eSgkc2lnbl9p
bl93aXRoX3R3aXR0ZXIpKSB7CiAgICAgIHJldHVybiAkdGhpcy0+YXV0aG9yaXplVVJMKCkg
LiAiP29hdXRoX3Rva2VuPXskdG9rZW59IjsKICAgIH0gZWxzZSB7CiAgICAgICByZXR1cm4g
JHRoaXMtPmF1dGhlbnRpY2F0ZVVSTCgpIC4gIj9vYXV0aF90b2tlbj17JHRva2VufSI7CiAg
ICB9CiAgfQoKICAvKioKICAgKiBFeGNoYW5nZSByZXF1ZXN0IHRva2VuIGFuZCBzZWNyZXQg
Zm9yIGFuIGFjY2VzcyB0b2tlbiBhbmQKICAgKiBzZWNyZXQsIHRvIHNpZ24gQVBJIGNhbGxz
LgogICAqCiAgICogQHJldHVybnMgYXJyYXkoIm9hdXRoX3Rva2VuIiA9PiAidGhlLWFjY2Vz
cy10b2tlbiIsCiAgICogICAgICAgICAgICAgICAgIm9hdXRoX3Rva2VuX3NlY3JldCIgPT4g
InRoZS1hY2Nlc3Mtc2VjcmV0IiwKICAgKiAgICAgICAgICAgICAgICAidXNlcl9pZCIgPT4g
Ijk0MzY5OTIiLAogICAqICAgICAgICAgICAgICAgICJzY3JlZW5fbmFtZSIgPT4gImFicmFo
YW0iKQogICAqLwogIGZ1bmN0aW9uIGdldEFjY2Vzc1Rva2VuKCRvYXV0aF92ZXJpZmllciA9
IEZBTFNFKSB7CiAgICAkcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICBpZiAoIWVtcHR5KCRv
YXV0aF92ZXJpZmllcikpIHsKICAgICAgJHBhcmFtZXRlcnNbJ29hdXRoX3ZlcmlmaWVyJ10g
PSAkb2F1dGhfdmVyaWZpZXI7CiAgICB9CiAgICAkcmVxdWVzdCA9ICR0aGlzLT5vQXV0aFJl
cXVlc3QoJHRoaXMtPmFjY2Vzc1Rva2VuVVJMKCksICdHRVQnLCAkcGFyYW1ldGVycyk7CiAg
ICAkdG9rZW4gPSBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMoJHJlcXVlc3QpOwogICAg
JHRoaXMtPnRva2VuID0gbmV3IE9BdXRoQ29uc3VtZXIoJHRva2VuWydvYXV0aF90b2tlbidd
LCAkdG9rZW5bJ29hdXRoX3Rva2VuX3NlY3JldCddKTsKICAgIHJldHVybiAkdG9rZW47CiAg
fQoKICAvKioKICAgKiBPbmUgdGltZSBleGNoYW5nZSBvZiB1c2VybmFtZSBhbmQgcGFzc3dv
cmQgZm9yIGFjY2VzcyB0b2tlbiBhbmQgc2VjcmV0LgogICAqCiAgICogQHJldHVybnMgYXJy
YXkoIm9hdXRoX3Rva2VuIiA9PiAidGhlLWFjY2Vzcy10b2tlbiIsCiAgICogICAgICAgICAg
ICAgICAgIm9hdXRoX3Rva2VuX3NlY3JldCIgPT4gInRoZS1hY2Nlc3Mtc2VjcmV0IiwKICAg
KiAgICAgICAgICAgICAgICAidXNlcl9pZCIgPT4gIjk0MzY5OTIiLAogICAqICAgICAgICAg
ICAgICAgICJzY3JlZW5fbmFtZSIgPT4gImFicmFoYW0iLAogICAqICAgICAgICAgICAgICAg
ICJ4X2F1dGhfZXhwaXJlcyIgPT4gIjAiKQogICAqLwogIGZ1bmN0aW9uIGdldFhBdXRoVG9r
ZW4oJHVzZXJuYW1lLCAkcGFzc3dvcmQpIHsKICAgICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsK
ICAgICRwYXJhbWV0ZXJzWyd4X2F1dGhfdXNlcm5hbWUnXSA9ICR1c2VybmFtZTsKICAgICRw
YXJhbWV0ZXJzWyd4X2F1dGhfcGFzc3dvcmQnXSA9ICRwYXNzd29yZDsKICAgICRwYXJhbWV0
ZXJzWyd4X2F1dGhfbW9kZSddID0gJ2NsaWVudF9hdXRoJzsKICAgICRyZXF1ZXN0ID0gJHRo
aXMtPm9BdXRoUmVxdWVzdCgkdGhpcy0+YWNjZXNzVG9rZW5VUkwoKSwgJ1BPU1QnLCAkcGFy
YW1ldGVycyk7CiAgICAkdG9rZW4gPSBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMoJHJl
cXVlc3QpOwogICAgJHRoaXMtPnRva2VuID0gbmV3IE9BdXRoQ29uc3VtZXIoJHRva2VuWydv
YXV0aF90b2tlbiddLCAkdG9rZW5bJ29hdXRoX3Rva2VuX3NlY3JldCddKTsKICAgIHJldHVy
biAkdG9rZW47CiAgfQoKICAvKioKICAgKiBHRVQgd3JhcHBlciBmb3Igb0F1dGhSZXF1ZXN0
LgogICAqLwogIGZ1bmN0aW9uIGdldCgkdXJsLCAkcGFyYW1ldGVycyA9IGFycmF5KCkpIHsK
ICAgICRyZXNwb25zZSA9ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHVybCwgJ0dFVCcsICRwYXJh
bWV0ZXJzKTsKICAgIGlmICgkdGhpcy0+Zm9ybWF0ID09PSAnanNvbicgJiYgJHRoaXMtPmRl
Y29kZV9qc29uKSB7CiAgICAgIHJldHVybiBqc29uX2RlY29kZSgkcmVzcG9uc2UpOwogICAg
fQogICAgcmV0dXJuICRyZXNwb25zZTsKICB9CgogIC8qKgogICAqIFBPU1Qgd3JhcHBlciBm
b3Igb0F1dGhSZXF1ZXN0LgogICAqLwogIGZ1bmN0aW9uIHBvc3QoJHVybCwgJHBhcmFtZXRl
cnMgPSBhcnJheSgpKSB7CiAgICAkcmVzcG9uc2UgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR1
cmwsICdQT1NUJywgJHBhcmFtZXRlcnMpOwogICAgaWYgKCR0aGlzLT5mb3JtYXQgPT09ICdq
c29uJyAmJiAkdGhpcy0+ZGVjb2RlX2pzb24pIHsKICAgICAgcmV0dXJuIGpzb25fZGVjb2Rl
KCRyZXNwb25zZSk7CiAgICB9CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoqCiAg
ICogREVMRVRFIHdyYXBwZXIgZm9yIG9BdXRoUmVxZXVzdC4KICAgKi8KICBmdW5jdGlvbiBk
ZWxldGUoJHVybCwgJHBhcmFtZXRlcnMgPSBhcnJheSgpKSB7CiAgICAkcmVzcG9uc2UgPSAk
dGhpcy0+b0F1dGhSZXF1ZXN0KCR1cmwsICdERUxFVEUnLCAkcGFyYW1ldGVycyk7CiAgICBp
ZiAoJHRoaXMtPmZvcm1hdCA9PT0gJ2pzb24nICYmICR0aGlzLT5kZWNvZGVfanNvbikgewog
ICAgICByZXR1cm4ganNvbl9kZWNvZGUoJHJlc3BvbnNlKTsKICAgIH0KICAgIHJldHVybiAk
cmVzcG9uc2U7CiAgfQoKICAvKioKICAgKiBGb3JtYXQgYW5kIHNpZ24gYW4gT0F1dGggLyBB
UEkgcmVxdWVzdAogICAqLwogIGZ1bmN0aW9uIG9BdXRoUmVxdWVzdCgkdXJsLCAkbWV0aG9k
LCAkcGFyYW1ldGVycykgewogICAgaWYgKHN0cnJwb3MoJHVybCwgJ2h0dHBzOi8vJykgIT09
IDAgJiYgc3RycnBvcygkdXJsLCAnaHR0cDovLycpICE9PSAwKSB7CiAgICAgICR1cmwgPSAi
eyR0aGlzLT5ob3N0fXskdXJsfS57JHRoaXMtPmZvcm1hdH0iOwogICAgfQogICAgJHJlcXVl
c3QgPSBPQXV0aFJlcXVlc3Q6OmZyb21fY29uc3VtZXJfYW5kX3Rva2VuKCR0aGlzLT5jb25z
dW1lciwgJHRoaXMtPnRva2VuLCAkbWV0aG9kLCAkdXJsLCAkcGFyYW1ldGVycyk7CiAgICAk
cmVxdWVzdC0+c2lnbl9yZXF1ZXN0KCR0aGlzLT5zaGExX21ldGhvZCwgJHRoaXMtPmNvbnN1
bWVyLCAkdGhpcy0+dG9rZW4pOwogICAgc3dpdGNoICgkbWV0aG9kKSB7CiAgICBjYXNlICdH
RVQnOgogICAgICByZXR1cm4gJHRoaXMtPmh0dHAoJHJlcXVlc3QtPnRvX3VybCgpLCAnR0VU
Jyk7CiAgICBkZWZhdWx0OgogICAgICByZXR1cm4gJHRoaXMtPmh0dHAoJHJlcXVlc3QtPmdl
dF9ub3JtYWxpemVkX2h0dHBfdXJsKCksICRtZXRob2QsICRyZXF1ZXN0LT50b19wb3N0ZGF0
YSgpKTsKICAgIH0KICB9CgogIC8qKgogICAqIE1ha2UgYW4gSFRUUCByZXF1ZXN0CiAgICoK
ICAgKiBAcmV0dXJuIEFQSSByZXN1bHRzCiAgICovCiAgZnVuY3Rpb24gaHR0cCgkdXJsLCAk
bWV0aG9kLCAkcG9zdGZpZWxkcyA9IE5VTEwpIHsKICAgICR0aGlzLT5odHRwX2luZm8gPSBh
cnJheSgpOwogICAgJGNpID0gY3VybF9pbml0KCk7CiAgICAvKiBDdXJsIHNldHRpbmdzICov
CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfVVNFUkFHRU5ULCAkdGhpcy0+dXNlcmFn
ZW50KTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9DT05ORUNUVElNRU9VVCwgJHRo
aXMtPmNvbm5lY3R0aW1lb3V0KTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9USU1F
T1VULCAkdGhpcy0+dGltZW91dCk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfUkVU
VVJOVFJBTlNGRVIsIFRSVUUpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0hUVFBI
RUFERVIsIGFycmF5KCdFeHBlY3Q6JykpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BU
X1NTTF9WRVJJRllQRUVSLCAkdGhpcy0+c3NsX3ZlcmlmeXBlZXIpOwogICAgY3VybF9zZXRv
cHQoJGNpLCBDVVJMT1BUX0hFQURFUkZVTkNUSU9OLCBhcnJheSgkdGhpcywgJ2dldEhlYWRl
cicpKTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9IRUFERVIsIEZBTFNFKTsKCiAg
ICBzd2l0Y2ggKCRtZXRob2QpIHsKICAgICAgY2FzZSAnUE9TVCc6CiAgICAgICAgY3VybF9z
ZXRvcHQoJGNpLCBDVVJMT1BUX1BPU1QsIFRSVUUpOwogICAgICAgIGlmICghZW1wdHkoJHBv
c3RmaWVsZHMpKSB7CiAgICAgICAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfUE9TVEZJ
RUxEUywgJHBvc3RmaWVsZHMpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2Fz
ZSAnREVMRVRFJzoKICAgICAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfQ1VTVE9NUkVR
VUVTVCwgJ0RFTEVURScpOwogICAgICAgIGlmICghZW1wdHkoJHBvc3RmaWVsZHMpKSB7CiAg
ICAgICAgICAkdXJsID0gInskdXJsfT97JHBvc3RmaWVsZHN9IjsKICAgICAgICB9CiAgICB9
CgogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1VSTCwgJHVybCk7CiAgICAkcmVzcG9u
c2UgPSBjdXJsX2V4ZWMoJGNpKTsKICAgICR0aGlzLT5odHRwX2NvZGUgPSBjdXJsX2dldGlu
Zm8oJGNpLCBDVVJMSU5GT19IVFRQX0NPREUpOwogICAgJHRoaXMtPmh0dHBfaW5mbyA9IGFy
cmF5X21lcmdlKCR0aGlzLT5odHRwX2luZm8sIGN1cmxfZ2V0aW5mbygkY2kpKTsKICAgICR0
aGlzLT51cmwgPSAkdXJsOwogICAgY3VybF9jbG9zZSAoJGNpKTsKICAgIHJldHVybiAkcmVz
cG9uc2U7CiAgfQoKICAvKioKICAgKiBHZXQgdGhlIGhlYWRlciBpbmZvIHRvIHN0b3JlLgog
ICAqLwogIGZ1bmN0aW9uIGdldEhlYWRlcigkY2gsICRoZWFkZXIpIHsKICAgICRpID0gc3Ry
cG9zKCRoZWFkZXIsICc6Jyk7CiAgICBpZiAoIWVtcHR5KCRpKSkgewogICAgICAka2V5ID0g
c3RyX3JlcGxhY2UoJy0nLCAnXycsIHN0cnRvbG93ZXIoc3Vic3RyKCRoZWFkZXIsIDAsICRp
KSkpOwogICAgICAkdmFsdWUgPSB0cmltKHN1YnN0cigkaGVhZGVyLCAkaSArIDIpKTsKICAg
ICAgJHRoaXMtPmh0dHBfaGVhZGVyWyRrZXldID0gJHZhbHVlOwogICAgfQogICAgcmV0dXJu
IHN0cmxlbigkaGVhZGVyKTsKICB9Cn0KCmNsYXNzIE9BdXRoRXhjZXB0aW9uIGV4dGVuZHMg
RXhjZXB0aW9uIHsKICAvLyBwYXNzCn0KCmNsYXNzIE9BdXRoQ29uc3VtZXIgewogIHB1Ymxp
YyAka2V5OwogIHB1YmxpYyAkc2VjcmV0OwoKICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgka2V5
LCAkc2VjcmV0LCAkY2FsbGJhY2tfdXJsPU5VTEwpIHsKICAgICR0aGlzLT5rZXkgPSAka2V5
OwogICAgJHRoaXMtPnNlY3JldCA9ICRzZWNyZXQ7CiAgICAkdGhpcy0+Y2FsbGJhY2tfdXJs
ID0gJGNhbGxiYWNrX3VybDsKICB9CgogIGZ1bmN0aW9uIF9fdG9TdHJpbmcoKSB7CiAgICBy
ZXR1cm4gIk9BdXRoQ29uc3VtZXJba2V5PSR0aGlzLT5rZXksc2VjcmV0PSR0aGlzLT5zZWNy
ZXRdIjsKICB9Cn0KCmNsYXNzIE9BdXRoVG9rZW4gewogIC8vIGFjY2VzcyB0b2tlbnMgYW5k
IHJlcXVlc3QgdG9rZW5zCiAgcHVibGljICRrZXk7CiAgcHVibGljICRzZWNyZXQ7CgogIC8q
KgogICAqIGtleSA9IHRoZSB0b2tlbgogICAqIHNlY3JldCA9IHRoZSB0b2tlbiBzZWNyZXQK
ICAgKi8KICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgka2V5LCAkc2VjcmV0KSB7CiAgICAkdGhp
cy0+a2V5ID0gJGtleTsKICAgICR0aGlzLT5zZWNyZXQgPSAkc2VjcmV0OwogIH0KCiAgLyoq
CiAgICogZ2VuZXJhdGVzIHRoZSBiYXNpYyBzdHJpbmcgc2VyaWFsaXphdGlvbiBvZiBhIHRv
a2VuIHRoYXQgYSBzZXJ2ZXIKICAgKiB3b3VsZCByZXNwb25kIHRvIHJlcXVlc3RfdG9rZW4g
YW5kIGFjY2Vzc190b2tlbiBjYWxscyB3aXRoCiAgICovCiAgZnVuY3Rpb24gdG9fc3RyaW5n
KCkgewogICAgcmV0dXJuICJvYXV0aF90b2tlbj0iIC4KICAgICAgICAgICBPQXV0aFV0aWw6
OnVybGVuY29kZV9yZmMzOTg2KCR0aGlzLT5rZXkpIC4KICAgICAgICAgICAiJm9hdXRoX3Rv
a2VuX3NlY3JldD0iIC4KICAgICAgICAgICBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2
KCR0aGlzLT5zZWNyZXQpOwogIH0KCiAgZnVuY3Rpb24gX190b1N0cmluZygpIHsKICAgIHJl
dHVybiAkdGhpcy0+dG9fc3RyaW5nKCk7CiAgfQp9CgovKioKICogQSBjbGFzcyBmb3IgaW1w
bGVtZW50aW5nIGEgU2lnbmF0dXJlIE1ldGhvZAogKiBTZWUgc2VjdGlvbiA5ICgiU2lnbmlu
ZyBSZXF1ZXN0cyIpIGluIHRoZSBzcGVjCiAqLwphYnN0cmFjdCBjbGFzcyBPQXV0aFNpZ25h
dHVyZU1ldGhvZCB7CiAgLyoqCiAgICogTmVlZHMgdG8gcmV0dXJuIHRoZSBuYW1lIG9mIHRo
ZSBTaWduYXR1cmUgTWV0aG9kIChpZSBITUFDLVNIQTEpCiAgICogQHJldHVybiBzdHJpbmcK
ICAgKi8KICBhYnN0cmFjdCBwdWJsaWMgZnVuY3Rpb24gZ2V0X25hbWUoKTsKCiAgLyoqCiAg
ICogQnVpbGQgdXAgdGhlIHNpZ25hdHVyZQogICAqIE5PVEU6IFRoZSBvdXRwdXQgb2YgdGhp
cyBmdW5jdGlvbiBNVVNUIE5PVCBiZSB1cmxlbmNvZGVkLgogICAqIHRoZSBlbmNvZGluZyBp
cyBoYW5kbGVkIGluIE9BdXRoUmVxdWVzdCB3aGVuIHRoZSBmaW5hbAogICAqIHJlcXVlc3Qg
aXMgc2VyaWFsaXplZAogICAqIEBwYXJhbSBPQXV0aFJlcXVlc3QgJHJlcXVlc3QKICAgKiBA
cGFyYW0gT0F1dGhDb25zdW1lciAkY29uc3VtZXIKICAgKiBAcGFyYW0gT0F1dGhUb2tlbiAk
dG9rZW4KICAgKiBAcmV0dXJuIHN0cmluZwogICAqLwogIGFic3RyYWN0IHB1YmxpYyBmdW5j
dGlvbiBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKTsKCiAg
LyoqCiAgICogVmVyaWZpZXMgdGhhdCBhIGdpdmVuIHNpZ25hdHVyZSBpcyBjb3JyZWN0CiAg
ICogQHBhcmFtIE9BdXRoUmVxdWVzdCAkcmVxdWVzdAogICAqIEBwYXJhbSBPQXV0aENvbnN1
bWVyICRjb25zdW1lcgogICAqIEBwYXJhbSBPQXV0aFRva2VuICR0b2tlbgogICAqIEBwYXJh
bSBzdHJpbmcgJHNpZ25hdHVyZQogICAqIEByZXR1cm4gYm9vbAogICAqLwogIHB1YmxpYyBm
dW5jdGlvbiBjaGVja19zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuLCAk
c2lnbmF0dXJlKSB7CiAgICAkYnVpbHQgPSAkdGhpcy0+YnVpbGRfc2lnbmF0dXJlKCRyZXF1
ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7CiAgICByZXR1cm4gJGJ1aWx0ID09ICRzaWduYXR1
cmU7CiAgfQp9CgovKioKICogVGhlIEhNQUMtU0hBMSBzaWduYXR1cmUgbWV0aG9kIHVzZXMg
dGhlIEhNQUMtU0hBMSBzaWduYXR1cmUgYWxnb3JpdGhtIGFzIGRlZmluZWQgaW4gW1JGQzIx
MDRdCiAqIHdoZXJlIHRoZSBTaWduYXR1cmUgQmFzZSBTdHJpbmcgaXMgdGhlIHRleHQgYW5k
IHRoZSBrZXkgaXMgdGhlIGNvbmNhdGVuYXRlZCB2YWx1ZXMgKGVhY2ggZmlyc3QKICogZW5j
b2RlZCBwZXIgUGFyYW1ldGVyIEVuY29kaW5nKSBvZiB0aGUgQ29uc3VtZXIgU2VjcmV0IGFu
ZCBUb2tlbiBTZWNyZXQsIHNlcGFyYXRlZCBieSBhbiAnJicKICogY2hhcmFjdGVyIChBU0NJ
SSBjb2RlIDM4KSBldmVuIGlmIGVtcHR5LgogKiAgIC0gQ2hhcHRlciA5LjIgKCJITUFDLVNI
QTEiKQogKi8KY2xhc3MgT0F1dGhTaWduYXR1cmVNZXRob2RfSE1BQ19TSEExIGV4dGVuZHMg
T0F1dGhTaWduYXR1cmVNZXRob2QgewogIGZ1bmN0aW9uIGdldF9uYW1lKCkgewogICAgcmV0
dXJuICJITUFDLVNIQTEiOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25hdHVy
ZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pIHsKICAgICRiYXNlX3N0cmluZyA9ICRy
ZXF1ZXN0LT5nZXRfc2lnbmF0dXJlX2Jhc2Vfc3RyaW5nKCk7CiAgICAkcmVxdWVzdC0+YmFz
ZV9zdHJpbmcgPSAkYmFzZV9zdHJpbmc7CgogICAgJGtleV9wYXJ0cyA9IGFycmF5KAogICAg
ICAkY29uc3VtZXItPnNlY3JldCwKICAgICAgKCR0b2tlbikgPyAkdG9rZW4tPnNlY3JldCA6
ICIiCiAgICApOwoKICAgICRrZXlfcGFydHMgPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMz
OTg2KCRrZXlfcGFydHMpOwogICAgJGtleSA9IGltcGxvZGUoJyYnLCAka2V5X3BhcnRzKTsK
CiAgICByZXR1cm4gYmFzZTY0X2VuY29kZShoYXNoX2htYWMoJ3NoYTEnLCAkYmFzZV9zdHJp
bmcsICRrZXksIHRydWUpKTsKICB9Cn0KCi8qKgogKiBUaGUgUExBSU5URVhUIG1ldGhvZCBk
b2VzIG5vdCBwcm92aWRlIGFueSBzZWN1cml0eSBwcm90ZWN0aW9uIGFuZCBTSE9VTEQgb25s
eSBiZSB1c2VkCiAqIG92ZXIgYSBzZWN1cmUgY2hhbm5lbCBzdWNoIGFzIEhUVFBTLiBJdCBk
b2VzIG5vdCB1c2UgdGhlIFNpZ25hdHVyZSBCYXNlIFN0cmluZy4KICogICAtIENoYXB0ZXIg
OS40ICgiUExBSU5URVhUIikKICovCmNsYXNzIE9BdXRoU2lnbmF0dXJlTWV0aG9kX1BMQUlO
VEVYVCBleHRlbmRzIE9BdXRoU2lnbmF0dXJlTWV0aG9kIHsKICBwdWJsaWMgZnVuY3Rpb24g
Z2V0X25hbWUoKSB7CiAgICByZXR1cm4gIlBMQUlOVEVYVCI7CiAgfQoKICAvKioKICAgKiBv
YXV0aF9zaWduYXR1cmUgaXMgc2V0IHRvIHRoZSBjb25jYXRlbmF0ZWQgZW5jb2RlZCB2YWx1
ZXMgb2YgdGhlIENvbnN1bWVyIFNlY3JldCBhbmQKICAgKiBUb2tlbiBTZWNyZXQsIHNlcGFy
YXRlZCBieSBhICcmJyBjaGFyYWN0ZXIgKEFTQ0lJIGNvZGUgMzgpLCBldmVuIGlmIGVpdGhl
ciBzZWNyZXQgaXMKICAgKiBlbXB0eS4gVGhlIHJlc3VsdCBNVVNUIGJlIGVuY29kZWQgYWdh
aW4uCiAgICogICAtIENoYXB0ZXIgOS40LjEgKCJHZW5lcmF0aW5nIFNpZ25hdHVyZXMiKQog
ICAqCiAgICogUGxlYXNlIG5vdGUgdGhhdCB0aGUgc2Vjb25kIGVuY29kaW5nIE1VU1QgTk9U
IGhhcHBlbiBpbiB0aGUgU2lnbmF0dXJlTWV0aG9kLCBhcwogICAqIE9BdXRoUmVxdWVzdCBo
YW5kbGVzIHRoaXMhCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25hdHVyZSgk
cmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pIHsKICAgICRrZXlfcGFydHMgPSBhcnJheSgK
ICAgICAgJGNvbnN1bWVyLT5zZWNyZXQsCiAgICAgICgkdG9rZW4pID8gJHRva2VuLT5zZWNy
ZXQgOiAiIgogICAgKTsKCiAgICAka2V5X3BhcnRzID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVf
cmZjMzk4Nigka2V5X3BhcnRzKTsKICAgICRrZXkgPSBpbXBsb2RlKCcmJywgJGtleV9wYXJ0
cyk7CiAgICAkcmVxdWVzdC0+YmFzZV9zdHJpbmcgPSAka2V5OwoKICAgIHJldHVybiAka2V5
OwogIH0KfQoKLyoqCiAqIFRoZSBSU0EtU0hBMSBzaWduYXR1cmUgbWV0aG9kIHVzZXMgdGhl
IFJTQVNTQS1QS0NTMS12MV81IHNpZ25hdHVyZSBhbGdvcml0aG0gYXMgZGVmaW5lZCBpbgog
KiBbUkZDMzQ0N10gc2VjdGlvbiA4LjIgKG1vcmUgc2ltcGx5IGtub3duIGFzIFBLQ1MjMSks
IHVzaW5nIFNIQS0xIGFzIHRoZSBoYXNoIGZ1bmN0aW9uIGZvcgogKiBFTVNBLVBLQ1MxLXYx
XzUuIEl0IGlzIGFzc3VtZWQgdGhhdCB0aGUgQ29uc3VtZXIgaGFzIHByb3ZpZGVkIGl0cyBS
U0EgcHVibGljIGtleSBpbiBhCiAqIHZlcmlmaWVkIHdheSB0byB0aGUgU2VydmljZSBQcm92
aWRlciwgaW4gYSBtYW5uZXIgd2hpY2ggaXMgYmV5b25kIHRoZSBzY29wZSBvZiB0aGlzCiAq
IHNwZWNpZmljYXRpb24uCiAqICAgLSBDaGFwdGVyIDkuMyAoIlJTQS1TSEExIikKICovCmFi
c3RyYWN0IGNsYXNzIE9BdXRoU2lnbmF0dXJlTWV0aG9kX1JTQV9TSEExIGV4dGVuZHMgT0F1
dGhTaWduYXR1cmVNZXRob2QgewogIHB1YmxpYyBmdW5jdGlvbiBnZXRfbmFtZSgpIHsKICAg
IHJldHVybiAiUlNBLVNIQTEiOwogIH0KCiAgLy8gVXAgdG8gdGhlIFNQIHRvIGltcGxlbWVu
dCB0aGlzIGxvb2t1cCBvZiBrZXlzLiBQb3NzaWJsZSBpZGVhcyBhcmU6CiAgLy8gKDEpIGRv
IGEgbG9va3VwIGluIGEgdGFibGUgb2YgdHJ1c3RlZCBjZXJ0cyBrZXllZCBvZmYgb2YgY29u
c3VtZXIKICAvLyAoMikgZmV0Y2ggdmlhIGh0dHAgdXNpbmcgYSB1cmwgcHJvdmlkZWQgYnkg
dGhlIHJlcXVlc3RlcgogIC8vICgzKSBzb21lIHNvcnQgb2Ygc3BlY2lmaWMgZGlzY292ZXJ5
IGNvZGUgYmFzZWQgb24gcmVxdWVzdAogIC8vCiAgLy8gRWl0aGVyIHdheSBzaG91bGQgcmV0
dXJuIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBjZXJ0aWZpY2F0ZQogIHByb3Rl
Y3RlZCBhYnN0cmFjdCBmdW5jdGlvbiBmZXRjaF9wdWJsaWNfY2VydCgmJHJlcXVlc3QpOwoK
ICAvLyBVcCB0byB0aGUgU1AgdG8gaW1wbGVtZW50IHRoaXMgbG9va3VwIG9mIGtleXMuIFBv
c3NpYmxlIGlkZWFzIGFyZToKICAvLyAoMSkgZG8gYSBsb29rdXAgaW4gYSB0YWJsZSBvZiB0
cnVzdGVkIGNlcnRzIGtleWVkIG9mZiBvZiBjb25zdW1lcgogIC8vCiAgLy8gRWl0aGVyIHdh
eSBzaG91bGQgcmV0dXJuIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBjZXJ0aWZp
Y2F0ZQogIHByb3RlY3RlZCBhYnN0cmFjdCBmdW5jdGlvbiBmZXRjaF9wcml2YXRlX2NlcnQo
JiRyZXF1ZXN0KTsKCiAgcHVibGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25hdHVyZSgkcmVxdWVz
dCwgJGNvbnN1bWVyLCAkdG9rZW4pIHsKICAgICRiYXNlX3N0cmluZyA9ICRyZXF1ZXN0LT5n
ZXRfc2lnbmF0dXJlX2Jhc2Vfc3RyaW5nKCk7CiAgICAkcmVxdWVzdC0+YmFzZV9zdHJpbmcg
PSAkYmFzZV9zdHJpbmc7CgogICAgLy8gRmV0Y2ggdGhlIHByaXZhdGUga2V5IGNlcnQgYmFz
ZWQgb24gdGhlIHJlcXVlc3QKICAgICRjZXJ0ID0gJHRoaXMtPmZldGNoX3ByaXZhdGVfY2Vy
dCgkcmVxdWVzdCk7CgogICAgLy8gUHVsbCB0aGUgcHJpdmF0ZSBrZXkgSUQgZnJvbSB0aGUg
Y2VydGlmaWNhdGUKICAgICRwcml2YXRla2V5aWQgPSBvcGVuc3NsX2dldF9wcml2YXRla2V5
KCRjZXJ0KTsKCiAgICAvLyBTaWduIHVzaW5nIHRoZSBrZXkKICAgICRvayA9IG9wZW5zc2xf
c2lnbigkYmFzZV9zdHJpbmcsICRzaWduYXR1cmUsICRwcml2YXRla2V5aWQpOwoKICAgIC8v
IFJlbGVhc2UgdGhlIGtleSByZXNvdXJjZQogICAgb3BlbnNzbF9mcmVlX2tleSgkcHJpdmF0
ZWtleWlkKTsKCiAgICByZXR1cm4gYmFzZTY0X2VuY29kZSgkc2lnbmF0dXJlKTsKICB9Cgog
IHB1YmxpYyBmdW5jdGlvbiBjaGVja19zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwg
JHRva2VuLCAkc2lnbmF0dXJlKSB7CiAgICAkZGVjb2RlZF9zaWcgPSBiYXNlNjRfZGVjb2Rl
KCRzaWduYXR1cmUpOwoKICAgICRiYXNlX3N0cmluZyA9ICRyZXF1ZXN0LT5nZXRfc2lnbmF0
dXJlX2Jhc2Vfc3RyaW5nKCk7CgogICAgLy8gRmV0Y2ggdGhlIHB1YmxpYyBrZXkgY2VydCBi
YXNlZCBvbiB0aGUgcmVxdWVzdAogICAgJGNlcnQgPSAkdGhpcy0+ZmV0Y2hfcHVibGljX2Nl
cnQoJHJlcXVlc3QpOwoKICAgIC8vIFB1bGwgdGhlIHB1YmxpYyBrZXkgSUQgZnJvbSB0aGUg
Y2VydGlmaWNhdGUKICAgICRwdWJsaWNrZXlpZCA9IG9wZW5zc2xfZ2V0X3B1YmxpY2tleSgk
Y2VydCk7CgogICAgLy8gQ2hlY2sgdGhlIGNvbXB1dGVkIHNpZ25hdHVyZSBhZ2FpbnN0IHRo
ZSBvbmUgcGFzc2VkIGluIHRoZSBxdWVyeQogICAgJG9rID0gb3BlbnNzbF92ZXJpZnkoJGJh
c2Vfc3RyaW5nLCAkZGVjb2RlZF9zaWcsICRwdWJsaWNrZXlpZCk7CgogICAgLy8gUmVsZWFz
ZSB0aGUga2V5IHJlc291cmNlCiAgICBvcGVuc3NsX2ZyZWVfa2V5KCRwdWJsaWNrZXlpZCk7
CgogICAgcmV0dXJuICRvayA9PSAxOwogIH0KfQoKY2xhc3MgT0F1dGhSZXF1ZXN0IHsKICBw
cml2YXRlICRwYXJhbWV0ZXJzOwogIHByaXZhdGUgJGh0dHBfbWV0aG9kOwogIHByaXZhdGUg
JGh0dHBfdXJsOwogIC8vIGZvciBkZWJ1ZyBwdXJwb3NlcwogIHB1YmxpYyAkYmFzZV9zdHJp
bmc7CiAgcHVibGljIHN0YXRpYyAkdmVyc2lvbiA9ICcxLjAnOwogIHB1YmxpYyBzdGF0aWMg
JFBPU1RfSU5QVVQgPSAncGhwOi8vaW5wdXQnOwoKICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgk
aHR0cF9tZXRob2QsICRodHRwX3VybCwgJHBhcmFtZXRlcnM9TlVMTCkgewogICAgQCRwYXJh
bWV0ZXJzIG9yICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgICRwYXJhbWV0ZXJzID0gYXJy
YXlfbWVyZ2UoIE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycyhwYXJzZV91cmwoJGh0dHBf
dXJsLCBQSFBfVVJMX1FVRVJZKSksICRwYXJhbWV0ZXJzKTsKICAgICR0aGlzLT5wYXJhbWV0
ZXJzID0gJHBhcmFtZXRlcnM7CiAgICAkdGhpcy0+aHR0cF9tZXRob2QgPSAkaHR0cF9tZXRo
b2Q7CiAgICAkdGhpcy0+aHR0cF91cmwgPSAkaHR0cF91cmw7CiAgfQoKCiAgLyoqCiAgICog
YXR0ZW1wdCB0byBidWlsZCB1cCBhIHJlcXVlc3QgZnJvbSB3aGF0IHdhcyBwYXNzZWQgdG8g
dGhlIHNlcnZlcgogICAqLwogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZnJvbV9yZXF1ZXN0
KCRodHRwX21ldGhvZD1OVUxMLCAkaHR0cF91cmw9TlVMTCwgJHBhcmFtZXRlcnM9TlVMTCkg
ewogICAgJHNjaGVtZSA9ICghaXNzZXQoJF9TRVJWRVJbJ0hUVFBTJ10pIHx8ICRfU0VSVkVS
WydIVFRQUyddICE9ICJvbiIpCiAgICAgICAgICAgICAgPyAnaHR0cCcKICAgICAgICAgICAg
ICA6ICdodHRwcyc7CiAgICBAJGh0dHBfdXJsIG9yICRodHRwX3VybCA9ICRzY2hlbWUgLgog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnOi8vJyAuICRfU0VSVkVSWydIVFRQX0hP
U1QnXSAuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc6JyAuCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICRfU0VSVkVSWydTRVJWRVJfUE9SVCddIC4KICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ107CiAgICBAJGh0
dHBfbWV0aG9kIG9yICRodHRwX21ldGhvZCA9ICRfU0VSVkVSWydSRVFVRVNUX01FVEhPRCdd
OwoKICAgIC8vIFdlIHdlcmVuJ3QgaGFuZGVkIGFueSBwYXJhbWV0ZXJzLCBzbyBsZXQncyBm
aW5kIHRoZSBvbmVzIHJlbGV2YW50IHRvCiAgICAvLyB0aGlzIHJlcXVlc3QuCiAgICAvLyBJ
ZiB5b3UgcnVuIFhNTC1SUEMgb3Igc2ltaWxhciB5b3Ugc2hvdWxkIHVzZSB0aGlzIHRvIHBy
b3ZpZGUgeW91ciBvd24KICAgIC8vIHBhcnNlZCBwYXJhbWV0ZXItbGlzdAogICAgaWYgKCEk
cGFyYW1ldGVycykgewogICAgICAvLyBGaW5kIHJlcXVlc3QgaGVhZGVycwogICAgICAkcmVx
dWVzdF9oZWFkZXJzID0gT0F1dGhVdGlsOjpnZXRfaGVhZGVycygpOwoKICAgICAgLy8gUGFy
c2UgdGhlIHF1ZXJ5LXN0cmluZyB0byBmaW5kIEdFVCBwYXJhbWV0ZXJzCiAgICAgICRwYXJh
bWV0ZXJzID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKCRfU0VSVkVSWydRVUVSWV9T
VFJJTkcnXSk7CgogICAgICAvLyBJdCdzIGEgUE9TVCByZXF1ZXN0IG9mIHRoZSBwcm9wZXIg
Y29udGVudC10eXBlLCBzbyBwYXJzZSBQT1NUCiAgICAgIC8vIHBhcmFtZXRlcnMgYW5kIGFk
ZCB0aG9zZSBvdmVycmlkaW5nIGFueSBkdXBsaWNhdGVzIGZyb20gR0VUCiAgICAgIGlmICgk
aHR0cF9tZXRob2QgPT0gIlBPU1QiCiAgICAgICAgICAmJiBAc3Ryc3RyKCRyZXF1ZXN0X2hl
YWRlcnNbIkNvbnRlbnQtVHlwZSJdLAogICAgICAgICAgICAgICAgICAgICAiYXBwbGljYXRp
b24veC13d3ctZm9ybS11cmxlbmNvZGVkIikKICAgICAgICAgICkgewogICAgICAgICRwb3N0
X2RhdGEgPSBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMoCiAgICAgICAgICBmaWxlX2dl
dF9jb250ZW50cyhzZWxmOjokUE9TVF9JTlBVVCkKICAgICAgICApOwogICAgICAgICRwYXJh
bWV0ZXJzID0gYXJyYXlfbWVyZ2UoJHBhcmFtZXRlcnMsICRwb3N0X2RhdGEpOwogICAgICB9
CgogICAgICAvLyBXZSBoYXZlIGEgQXV0aG9yaXphdGlvbi1oZWFkZXIgd2l0aCBPQXV0aCBk
YXRhLiBQYXJzZSB0aGUgaGVhZGVyCiAgICAgIC8vIGFuZCBhZGQgdGhvc2Ugb3ZlcnJpZGlu
ZyBhbnkgZHVwbGljYXRlcyBmcm9tIEdFVCBvciBQT1NUCiAgICAgIGlmIChAc3Vic3RyKCRy
ZXF1ZXN0X2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSwgMCwgNikgPT0gIk9BdXRoICIpIHsK
ICAgICAgICAkaGVhZGVyX3BhcmFtZXRlcnMgPSBPQXV0aFV0aWw6OnNwbGl0X2hlYWRlcigK
ICAgICAgICAgICRyZXF1ZXN0X2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXQogICAgICAgICk7
CiAgICAgICAgJHBhcmFtZXRlcnMgPSBhcnJheV9tZXJnZSgkcGFyYW1ldGVycywgJGhlYWRl
cl9wYXJhbWV0ZXJzKTsKICAgICAgfQoKICAgIH0KCiAgICByZXR1cm4gbmV3IE9BdXRoUmVx
dWVzdCgkaHR0cF9tZXRob2QsICRodHRwX3VybCwgJHBhcmFtZXRlcnMpOwogIH0KCiAgLyoq
CiAgICogcHJldHR5IG11Y2ggYSBoZWxwZXIgZnVuY3Rpb24gdG8gc2V0IHVwIHRoZSByZXF1
ZXN0CiAgICovCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBmcm9tX2NvbnN1bWVyX2FuZF90
b2tlbigkY29uc3VtZXIsICR0b2tlbiwgJGh0dHBfbWV0aG9kLCAkaHR0cF91cmwsICRwYXJh
bWV0ZXJzPU5VTEwpIHsKICAgIEAkcGFyYW1ldGVycyBvciAkcGFyYW1ldGVycyA9IGFycmF5
KCk7CiAgICAkZGVmYXVsdHMgPSBhcnJheSgib2F1dGhfdmVyc2lvbiIgPT4gT0F1dGhSZXF1
ZXN0OjokdmVyc2lvbiwKICAgICAgICAgICAgICAgICAgICAgICJvYXV0aF9ub25jZSIgPT4g
T0F1dGhSZXF1ZXN0OjpnZW5lcmF0ZV9ub25jZSgpLAogICAgICAgICAgICAgICAgICAgICAg
Im9hdXRoX3RpbWVzdGFtcCIgPT4gT0F1dGhSZXF1ZXN0OjpnZW5lcmF0ZV90aW1lc3RhbXAo
KSwKICAgICAgICAgICAgICAgICAgICAgICJvYXV0aF9jb25zdW1lcl9rZXkiID0+ICRjb25z
dW1lci0+a2V5KTsKICAgIGlmICgkdG9rZW4pCiAgICAgICRkZWZhdWx0c1snb2F1dGhfdG9r
ZW4nXSA9ICR0b2tlbi0+a2V5OwoKICAgICRwYXJhbWV0ZXJzID0gYXJyYXlfbWVyZ2UoJGRl
ZmF1bHRzLCAkcGFyYW1ldGVycyk7CgogICAgcmV0dXJuIG5ldyBPQXV0aFJlcXVlc3QoJGh0
dHBfbWV0aG9kLCAkaHR0cF91cmwsICRwYXJhbWV0ZXJzKTsKICB9CgogIHB1YmxpYyBmdW5j
dGlvbiBzZXRfcGFyYW1ldGVyKCRuYW1lLCAkdmFsdWUsICRhbGxvd19kdXBsaWNhdGVzID0g
dHJ1ZSkgewogICAgaWYgKCRhbGxvd19kdXBsaWNhdGVzICYmIGlzc2V0KCR0aGlzLT5wYXJh
bWV0ZXJzWyRuYW1lXSkpIHsKICAgICAgLy8gV2UgaGF2ZSBhbHJlYWR5IGFkZGVkIHBhcmFt
ZXRlcihzKSB3aXRoIHRoaXMgbmFtZSwgc28gYWRkIHRvIHRoZSBsaXN0CiAgICAgIGlmIChp
c19zY2FsYXIoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdKSkgewogICAgICAgIC8vIFRoaXMg
aXMgdGhlIGZpcnN0IGR1cGxpY2F0ZSwgc28gdHJhbnNmb3JtIHNjYWxhciAoc3RyaW5nKQog
ICAgICAgIC8vIGludG8gYW4gYXJyYXkgc28gd2UgY2FuIGFkZCB0aGUgZHVwbGljYXRlcwog
ICAgICAgICR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSA9IGFycmF5KCR0aGlzLT5wYXJhbWV0
ZXJzWyRuYW1lXSk7CiAgICAgIH0KCiAgICAgICR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXVtd
ID0gJHZhbHVlOwogICAgfSBlbHNlIHsKICAgICAgJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVd
ID0gJHZhbHVlOwogICAgfQogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGdldF9wYXJhbWV0ZXIo
JG5hbWUpIHsKICAgIHJldHVybiBpc3NldCgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pID8g
JHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdIDogbnVsbDsKICB9CgogIHB1YmxpYyBmdW5jdGlv
biBnZXRfcGFyYW1ldGVycygpIHsKICAgIHJldHVybiAkdGhpcy0+cGFyYW1ldGVyczsKICB9
CgogIHB1YmxpYyBmdW5jdGlvbiB1bnNldF9wYXJhbWV0ZXIoJG5hbWUpIHsKICAgIHVuc2V0
KCR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSk7CiAgfQoKICAvKioKICAgKiBUaGUgcmVxdWVz
dCBwYXJhbWV0ZXJzLCBzb3J0ZWQgYW5kIGNvbmNhdGVuYXRlZCBpbnRvIGEgbm9ybWFsaXpl
ZCBzdHJpbmcuCiAgICogQHJldHVybiBzdHJpbmcKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24g
Z2V0X3NpZ25hYmxlX3BhcmFtZXRlcnMoKSB7CiAgICAvLyBHcmFiIGFsbCBwYXJhbWV0ZXJz
CiAgICAkcGFyYW1zID0gJHRoaXMtPnBhcmFtZXRlcnM7CgogICAgLy8gUmVtb3ZlIG9hdXRo
X3NpZ25hdHVyZSBpZiBwcmVzZW50CiAgICAvLyBSZWY6IFNwZWM6IDkuMS4xICgiVGhlIG9h
dXRoX3NpZ25hdHVyZSBwYXJhbWV0ZXIgTVVTVCBiZSBleGNsdWRlZC4iKQogICAgaWYgKGlz
c2V0KCRwYXJhbXNbJ29hdXRoX3NpZ25hdHVyZSddKSkgewogICAgICB1bnNldCgkcGFyYW1z
WydvYXV0aF9zaWduYXR1cmUnXSk7CiAgICB9CgogICAgcmV0dXJuIE9BdXRoVXRpbDo6YnVp
bGRfaHR0cF9xdWVyeSgkcGFyYW1zKTsKICB9CgogIC8qKgogICAqIFJldHVybnMgdGhlIGJh
c2Ugc3RyaW5nIG9mIHRoaXMgcmVxdWVzdAogICAqCiAgICogVGhlIGJhc2Ugc3RyaW5nIGRl
ZmluZWQgYXMgdGhlIG1ldGhvZCwgdGhlIHVybAogICAqIGFuZCB0aGUgcGFyYW1ldGVycyAo
bm9ybWFsaXplZCksIGVhY2ggdXJsZW5jb2RlZAogICAqIGFuZCB0aGUgY29uY2F0ZWQgd2l0
aCAmLgogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBnZXRfc2lnbmF0dXJlX2Jhc2Vfc3RyaW5n
KCkgewogICAgJHBhcnRzID0gYXJyYXkoCiAgICAgICR0aGlzLT5nZXRfbm9ybWFsaXplZF9o
dHRwX21ldGhvZCgpLAogICAgICAkdGhpcy0+Z2V0X25vcm1hbGl6ZWRfaHR0cF91cmwoKSwK
ICAgICAgJHRoaXMtPmdldF9zaWduYWJsZV9wYXJhbWV0ZXJzKCkKICAgICk7CgogICAgJHBh
cnRzID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkcGFydHMpOwoKICAgIHJldHVy
biBpbXBsb2RlKCcmJywgJHBhcnRzKTsKICB9CgogIC8qKgogICAqIGp1c3QgdXBwZXJjYXNl
cyB0aGUgaHR0cCBtZXRob2QKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZ2V0X25vcm1hbGl6
ZWRfaHR0cF9tZXRob2QoKSB7CiAgICByZXR1cm4gc3RydG91cHBlcigkdGhpcy0+aHR0cF9t
ZXRob2QpOwogIH0KCiAgLyoqCiAgICogcGFyc2VzIHRoZSB1cmwgYW5kIHJlYnVpbGRzIGl0
IHRvIGJlCiAgICogc2NoZW1lOi8vaG9zdC9wYXRoCiAgICovCiAgcHVibGljIGZ1bmN0aW9u
IGdldF9ub3JtYWxpemVkX2h0dHBfdXJsKCkgewogICAgJHBhcnRzID0gcGFyc2VfdXJsKCR0
aGlzLT5odHRwX3VybCk7CgogICAgJHBvcnQgPSBAJHBhcnRzWydwb3J0J107CiAgICAkc2No
ZW1lID0gJHBhcnRzWydzY2hlbWUnXTsKICAgICRob3N0ID0gJHBhcnRzWydob3N0J107CiAg
ICAkcGF0aCA9IEAkcGFydHNbJ3BhdGgnXTsKCiAgICAkcG9ydCBvciAkcG9ydCA9ICgkc2No
ZW1lID09ICdodHRwcycpID8gJzQ0MycgOiAnODAnOwoKICAgIGlmICgoJHNjaGVtZSA9PSAn
aHR0cHMnICYmICRwb3J0ICE9ICc0NDMnKQogICAgICAgIHx8ICgkc2NoZW1lID09ICdodHRw
JyAmJiAkcG9ydCAhPSAnODAnKSkgewogICAgICAkaG9zdCA9ICIkaG9zdDokcG9ydCI7CiAg
ICB9CiAgICByZXR1cm4gIiRzY2hlbWU6Ly8kaG9zdCRwYXRoIjsKICB9CgogIC8qKgogICAq
IGJ1aWxkcyBhIHVybCB1c2FibGUgZm9yIGEgR0VUIHJlcXVlc3QKICAgKi8KICBwdWJsaWMg
ZnVuY3Rpb24gdG9fdXJsKCkgewogICAgJHBvc3RfZGF0YSA9ICR0aGlzLT50b19wb3N0ZGF0
YSgpOwogICAgJG91dCA9ICR0aGlzLT5nZXRfbm9ybWFsaXplZF9odHRwX3VybCgpOwogICAg
aWYgKCRwb3N0X2RhdGEpIHsKICAgICAgJG91dCAuPSAnPycuJHBvc3RfZGF0YTsKICAgIH0K
ICAgIHJldHVybiAkb3V0OwogIH0KCiAgLyoqCiAgICogYnVpbGRzIHRoZSBkYXRhIG9uZSB3
b3VsZCBzZW5kIGluIGEgUE9TVCByZXF1ZXN0CiAgICovCiAgcHVibGljIGZ1bmN0aW9uIHRv
X3Bvc3RkYXRhKCkgewogICAgcmV0dXJuIE9BdXRoVXRpbDo6YnVpbGRfaHR0cF9xdWVyeSgk
dGhpcy0+cGFyYW1ldGVycyk7CiAgfQoKICAvKioKICAgKiBidWlsZHMgdGhlIEF1dGhvcml6
YXRpb246IGhlYWRlcgogICAqLwogIHB1YmxpYyBmdW5jdGlvbiB0b19oZWFkZXIoJHJlYWxt
PW51bGwpIHsKICAgICRmaXJzdCA9IHRydWU7CiAgaWYoJHJlYWxtKSB7CiAgICAgICRvdXQg
PSAnQXV0aG9yaXphdGlvbjogT0F1dGggcmVhbG09IicgLiBPQXV0aFV0aWw6OnVybGVuY29k
ZV9yZmMzOTg2KCRyZWFsbSkgLiAnIic7CiAgICAgICRmaXJzdCA9IGZhbHNlOwogICAgfSBl
bHNlCiAgICAgICRvdXQgPSAnQXV0aG9yaXphdGlvbjogT0F1dGgnOwoKICAgICR0b3RhbCA9
IGFycmF5KCk7CiAgICBmb3JlYWNoICgkdGhpcy0+cGFyYW1ldGVycyBhcyAkayA9PiAkdikg
ewogICAgICBpZiAoc3Vic3RyKCRrLCAwLCA1KSAhPSAib2F1dGgiKSBjb250aW51ZTsKICAg
ICAgaWYgKGlzX2FycmF5KCR2KSkgewogICAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlv
bignQXJyYXlzIG5vdCBzdXBwb3J0ZWQgaW4gaGVhZGVycycpOwogICAgICB9CiAgICAgICRv
dXQgLj0gKCRmaXJzdCkgPyAnICcgOiAnLCc7CiAgICAgICRvdXQgLj0gT0F1dGhVdGlsOjp1
cmxlbmNvZGVfcmZjMzk4NigkaykgLgogICAgICAgICAgICAgICc9IicgLgogICAgICAgICAg
ICAgIE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJHYpIC4KICAgICAgICAgICAgICAn
Iic7CiAgICAgICRmaXJzdCA9IGZhbHNlOwogICAgfQogICAgcmV0dXJuICRvdXQ7CiAgfQoK
ICBwdWJsaWMgZnVuY3Rpb24gX190b1N0cmluZygpIHsKICAgIHJldHVybiAkdGhpcy0+dG9f
dXJsKCk7CiAgfQoKCiAgcHVibGljIGZ1bmN0aW9uIHNpZ25fcmVxdWVzdCgkc2lnbmF0dXJl
X21ldGhvZCwgJGNvbnN1bWVyLCAkdG9rZW4pIHsKICAgICR0aGlzLT5zZXRfcGFyYW1ldGVy
KAogICAgICAib2F1dGhfc2lnbmF0dXJlX21ldGhvZCIsCiAgICAgICRzaWduYXR1cmVfbWV0
aG9kLT5nZXRfbmFtZSgpLAogICAgICBmYWxzZQogICAgKTsKICAgICRzaWduYXR1cmUgPSAk
dGhpcy0+YnVpbGRfc2lnbmF0dXJlKCRzaWduYXR1cmVfbWV0aG9kLCAkY29uc3VtZXIsICR0
b2tlbik7CiAgICAkdGhpcy0+c2V0X3BhcmFtZXRlcigib2F1dGhfc2lnbmF0dXJlIiwgJHNp
Z25hdHVyZSwgZmFsc2UpOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25hdHVy
ZSgkc2lnbmF0dXJlX21ldGhvZCwgJGNvbnN1bWVyLCAkdG9rZW4pIHsKICAgICRzaWduYXR1
cmUgPSAkc2lnbmF0dXJlX21ldGhvZC0+YnVpbGRfc2lnbmF0dXJlKCR0aGlzLCAkY29uc3Vt
ZXIsICR0b2tlbik7CiAgICByZXR1cm4gJHNpZ25hdHVyZTsKICB9CgogIC8qKgogICAqIHV0
aWwgZnVuY3Rpb246IGN1cnJlbnQgdGltZXN0YW1wCiAgICovCiAgcHJpdmF0ZSBzdGF0aWMg
ZnVuY3Rpb24gZ2VuZXJhdGVfdGltZXN0YW1wKCkgewogICAgcmV0dXJuIHRpbWUoKTsKICB9
CgogIC8qKgogICAqIHV0aWwgZnVuY3Rpb246IGN1cnJlbnQgbm9uY2UKICAgKi8KICBwcml2
YXRlIHN0YXRpYyBmdW5jdGlvbiBnZW5lcmF0ZV9ub25jZSgpIHsKICAgICRtdCA9IG1pY3Jv
dGltZSgpOwogICAgJHJhbmQgPSBtdF9yYW5kKCk7CgogICAgcmV0dXJuIG1kNSgkbXQgLiAk
cmFuZCk7IC8vIG1kNXMgbG9vayBuaWNlciB0aGFuIG51bWJlcnMKICB9Cn0KCmNsYXNzIE9B
dXRoU2VydmVyIHsKICBwcm90ZWN0ZWQgJHRpbWVzdGFtcF90aHJlc2hvbGQgPSAzMDA7IC8v
IGluIHNlY29uZHMsIGZpdmUgbWludXRlcwogIHByb3RlY3RlZCAkdmVyc2lvbiA9ICcxLjAn
OyAgICAgICAgICAgICAvLyBoaSBibGFpbmUKICBwcm90ZWN0ZWQgJHNpZ25hdHVyZV9tZXRo
b2RzID0gYXJyYXkoKTsKCiAgcHJvdGVjdGVkICRkYXRhX3N0b3JlOwoKICBmdW5jdGlvbiBf
X2NvbnN0cnVjdCgkZGF0YV9zdG9yZSkgewogICAgJHRoaXMtPmRhdGFfc3RvcmUgPSAkZGF0
YV9zdG9yZTsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBhZGRfc2lnbmF0dXJlX21ldGhvZCgk
c2lnbmF0dXJlX21ldGhvZCkgewogICAgJHRoaXMtPnNpZ25hdHVyZV9tZXRob2RzWyRzaWdu
YXR1cmVfbWV0aG9kLT5nZXRfbmFtZSgpXSA9CiAgICAgICRzaWduYXR1cmVfbWV0aG9kOwog
IH0KCiAgLy8gaGlnaCBsZXZlbCBmdW5jdGlvbnMKCiAgLyoqCiAgICogcHJvY2VzcyBhIHJl
cXVlc3RfdG9rZW4gcmVxdWVzdAogICAqIHJldHVybnMgdGhlIHJlcXVlc3QgdG9rZW4gb24g
c3VjY2VzcwogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBmZXRjaF9yZXF1ZXN0X3Rva2VuKCYk
cmVxdWVzdCkgewogICAgJHRoaXMtPmdldF92ZXJzaW9uKCRyZXF1ZXN0KTsKCiAgICAkY29u
c3VtZXIgPSAkdGhpcy0+Z2V0X2NvbnN1bWVyKCRyZXF1ZXN0KTsKCiAgICAvLyBubyB0b2tl
biByZXF1aXJlZCBmb3IgdGhlIGluaXRpYWwgdG9rZW4gcmVxdWVzdAogICAgJHRva2VuID0g
TlVMTDsKCiAgICAkdGhpcy0+Y2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIs
ICR0b2tlbik7CgogICAgLy8gUmV2IEEgY2hhbmdlCiAgICAkY2FsbGJhY2sgPSAkcmVxdWVz
dC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfY2FsbGJhY2snKTsKICAgICRuZXdfdG9rZW4gPSAk
dGhpcy0+ZGF0YV9zdG9yZS0+bmV3X3JlcXVlc3RfdG9rZW4oJGNvbnN1bWVyLCAkY2FsbGJh
Y2spOwoKICAgIHJldHVybiAkbmV3X3Rva2VuOwogIH0KCiAgLyoqCiAgICogcHJvY2VzcyBh
biBhY2Nlc3NfdG9rZW4gcmVxdWVzdAogICAqIHJldHVybnMgdGhlIGFjY2VzcyB0b2tlbiBv
biBzdWNjZXNzCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGZldGNoX2FjY2Vzc190b2tlbigm
JHJlcXVlc3QpIHsKICAgICR0aGlzLT5nZXRfdmVyc2lvbigkcmVxdWVzdCk7CgogICAgJGNv
bnN1bWVyID0gJHRoaXMtPmdldF9jb25zdW1lcigkcmVxdWVzdCk7CgogICAgLy8gcmVxdWly
ZXMgYXV0aG9yaXplZCByZXF1ZXN0IHRva2VuCiAgICAkdG9rZW4gPSAkdGhpcy0+Z2V0X3Rv
a2VuKCRyZXF1ZXN0LCAkY29uc3VtZXIsICJyZXF1ZXN0Iik7CgogICAgJHRoaXMtPmNoZWNr
X3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwoKICAgIC8vIFJldiBB
IGNoYW5nZQogICAgJHZlcmlmaWVyID0gJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRo
X3ZlcmlmaWVyJyk7CiAgICAkbmV3X3Rva2VuID0gJHRoaXMtPmRhdGFfc3RvcmUtPm5ld19h
Y2Nlc3NfdG9rZW4oJHRva2VuLCAkY29uc3VtZXIsICR2ZXJpZmllcik7CgogICAgcmV0dXJu
ICRuZXdfdG9rZW47CiAgfQoKICAvKioKICAgKiB2ZXJpZnkgYW4gYXBpIGNhbGwsIGNoZWNr
cyBhbGwgdGhlIHBhcmFtZXRlcnMKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gdmVyaWZ5X3Jl
cXVlc3QoJiRyZXF1ZXN0KSB7CiAgICAkdGhpcy0+Z2V0X3ZlcnNpb24oJHJlcXVlc3QpOwog
ICAgJGNvbnN1bWVyID0gJHRoaXMtPmdldF9jb25zdW1lcigkcmVxdWVzdCk7CiAgICAkdG9r
ZW4gPSAkdGhpcy0+Z2V0X3Rva2VuKCRyZXF1ZXN0LCAkY29uc3VtZXIsICJhY2Nlc3MiKTsK
ICAgICR0aGlzLT5jaGVja19zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2Vu
KTsKICAgIHJldHVybiBhcnJheSgkY29uc3VtZXIsICR0b2tlbik7CiAgfQoKICAvLyBJbnRl
cm5hbHMgZnJvbSBoZXJlCiAgLyoqCiAgICogdmVyc2lvbiAxCiAgICovCiAgcHJpdmF0ZSBm
dW5jdGlvbiBnZXRfdmVyc2lvbigmJHJlcXVlc3QpIHsKICAgICR2ZXJzaW9uID0gJHJlcXVl
c3QtPmdldF9wYXJhbWV0ZXIoIm9hdXRoX3ZlcnNpb24iKTsKICAgIGlmICghJHZlcnNpb24p
IHsKICAgICAgLy8gU2VydmljZSBQcm92aWRlcnMgTVVTVCBhc3N1bWUgdGhlIHByb3RvY29s
IHZlcnNpb24gdG8gYmUgMS4wIGlmIHRoaXMgcGFyYW1ldGVyIGlzIG5vdCBwcmVzZW50Lgog
ICAgICAvLyBDaGFwdGVyIDcuMCAoIkFjY2Vzc2luZyBQcm90ZWN0ZWQgUmVzc291cmNlcyIp
CiAgICAgICR2ZXJzaW9uID0gJzEuMCc7CiAgICB9CiAgICBpZiAoJHZlcnNpb24gIT09ICR0
aGlzLT52ZXJzaW9uKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiT0F1dGgg
dmVyc2lvbiAnJHZlcnNpb24nIG5vdCBzdXBwb3J0ZWQiKTsKICAgIH0KICAgIHJldHVybiAk
dmVyc2lvbjsKICB9CgogIC8qKgogICAqIGZpZ3VyZSBvdXQgdGhlIHNpZ25hdHVyZSB3aXRo
IHNvbWUgZGVmYXVsdHMKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGdldF9zaWduYXR1cmVf
bWV0aG9kKCYkcmVxdWVzdCkgewogICAgJHNpZ25hdHVyZV9tZXRob2QgPQogICAgICAgIEAk
cmVxdWVzdC0+Z2V0X3BhcmFtZXRlcigib2F1dGhfc2lnbmF0dXJlX21ldGhvZCIpOwoKICAg
IGlmICghJHNpZ25hdHVyZV9tZXRob2QpIHsKICAgICAgLy8gQWNjb3JkaW5nIHRvIGNoYXB0
ZXIgNyAoIkFjY2Vzc2luZyBQcm90ZWN0ZWQgUmVzc291cmNlcyIpIHRoZSBzaWduYXR1cmUt
bWV0aG9kCiAgICAgIC8vIHBhcmFtZXRlciBpcyByZXF1aXJlZCwgYW5kIHdlIGNhbid0IGp1
c3QgZmFsbGJhY2sgdG8gUExBSU5URVhUCiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlv
bignTm8gc2lnbmF0dXJlIG1ldGhvZCBwYXJhbWV0ZXIuIFRoaXMgcGFyYW1ldGVyIGlzIHJl
cXVpcmVkJyk7CiAgICB9CgogICAgaWYgKCFpbl9hcnJheSgkc2lnbmF0dXJlX21ldGhvZCwK
ICAgICAgICAgICAgICAgICAgYXJyYXlfa2V5cygkdGhpcy0+c2lnbmF0dXJlX21ldGhvZHMp
KSkgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAgICAgIlNpZ25hdHVy
ZSBtZXRob2QgJyRzaWduYXR1cmVfbWV0aG9kJyBub3Qgc3VwcG9ydGVkICIgLgogICAgICAg
ICJ0cnkgb25lIG9mIHRoZSBmb2xsb3dpbmc6ICIgLgogICAgICAgIGltcGxvZGUoIiwgIiwg
YXJyYXlfa2V5cygkdGhpcy0+c2lnbmF0dXJlX21ldGhvZHMpKQogICAgICApOwogICAgfQog
ICAgcmV0dXJuICR0aGlzLT5zaWduYXR1cmVfbWV0aG9kc1skc2lnbmF0dXJlX21ldGhvZF07
CiAgfQoKICAvKioKICAgKiB0cnkgdG8gZmluZCB0aGUgY29uc3VtZXIgZm9yIHRoZSBwcm92
aWRlZCByZXF1ZXN0J3MgY29uc3VtZXIga2V5CiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBn
ZXRfY29uc3VtZXIoJiRyZXF1ZXN0KSB7CiAgICAkY29uc3VtZXJfa2V5ID0gQCRyZXF1ZXN0
LT5nZXRfcGFyYW1ldGVyKCJvYXV0aF9jb25zdW1lcl9rZXkiKTsKICAgIGlmICghJGNvbnN1
bWVyX2tleSkgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIkludmFsaWQgY29u
c3VtZXIga2V5Iik7CiAgICB9CgogICAgJGNvbnN1bWVyID0gJHRoaXMtPmRhdGFfc3RvcmUt
Pmxvb2t1cF9jb25zdW1lcigkY29uc3VtZXJfa2V5KTsKICAgIGlmICghJGNvbnN1bWVyKSB7
CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiSW52YWxpZCBjb25zdW1lciIpOwog
ICAgfQoKICAgIHJldHVybiAkY29uc3VtZXI7CiAgfQoKICAvKioKICAgKiB0cnkgdG8gZmlu
ZCB0aGUgdG9rZW4gZm9yIHRoZSBwcm92aWRlZCByZXF1ZXN0J3MgdG9rZW4ga2V5CiAgICov
CiAgcHJpdmF0ZSBmdW5jdGlvbiBnZXRfdG9rZW4oJiRyZXF1ZXN0LCAkY29uc3VtZXIsICR0
b2tlbl90eXBlPSJhY2Nlc3MiKSB7CiAgICAkdG9rZW5fZmllbGQgPSBAJHJlcXVlc3QtPmdl
dF9wYXJhbWV0ZXIoJ29hdXRoX3Rva2VuJyk7CiAgICAkdG9rZW4gPSAkdGhpcy0+ZGF0YV9z
dG9yZS0+bG9va3VwX3Rva2VuKAogICAgICAkY29uc3VtZXIsICR0b2tlbl90eXBlLCAkdG9r
ZW5fZmllbGQKICAgICk7CiAgICBpZiAoISR0b2tlbikgewogICAgICB0aHJvdyBuZXcgT0F1
dGhFeGNlcHRpb24oIkludmFsaWQgJHRva2VuX3R5cGUgdG9rZW46ICR0b2tlbl9maWVsZCIp
OwogICAgfQogICAgcmV0dXJuICR0b2tlbjsKICB9CgogIC8qKgogICAqIGFsbC1pbi1vbmUg
ZnVuY3Rpb24gdG8gY2hlY2sgdGhlIHNpZ25hdHVyZSBvbiBhIHJlcXVlc3QKICAgKiBzaG91
bGQgZ3Vlc3MgdGhlIHNpZ25hdHVyZSBtZXRob2QgYXBwcm9wcmlhdGVseQogICAqLwogIHBy
aXZhdGUgZnVuY3Rpb24gY2hlY2tfc2lnbmF0dXJlKCYkcmVxdWVzdCwgJGNvbnN1bWVyLCAk
dG9rZW4pIHsKICAgIC8vIHRoaXMgc2hvdWxkIHByb2JhYmx5IGJlIGluIGEgZGlmZmVyZW50
IG1ldGhvZAogICAgJHRpbWVzdGFtcCA9IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1
dGhfdGltZXN0YW1wJyk7CiAgICAkbm9uY2UgPSBAJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIo
J29hdXRoX25vbmNlJyk7CgogICAgJHRoaXMtPmNoZWNrX3RpbWVzdGFtcCgkdGltZXN0YW1w
KTsKICAgICR0aGlzLT5jaGVja19ub25jZSgkY29uc3VtZXIsICR0b2tlbiwgJG5vbmNlLCAk
dGltZXN0YW1wKTsKCiAgICAkc2lnbmF0dXJlX21ldGhvZCA9ICR0aGlzLT5nZXRfc2lnbmF0
dXJlX21ldGhvZCgkcmVxdWVzdCk7CgogICAgJHNpZ25hdHVyZSA9ICRyZXF1ZXN0LT5nZXRf
cGFyYW1ldGVyKCdvYXV0aF9zaWduYXR1cmUnKTsKICAgICR2YWxpZF9zaWcgPSAkc2lnbmF0
dXJlX21ldGhvZC0+Y2hlY2tfc2lnbmF0dXJlKAogICAgICAkcmVxdWVzdCwKICAgICAgJGNv
bnN1bWVyLAogICAgICAkdG9rZW4sCiAgICAgICRzaWduYXR1cmUKICAgICk7CgogICAgaWYg
KCEkdmFsaWRfc2lnKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiSW52YWxp
ZCBzaWduYXR1cmUiKTsKICAgIH0KICB9CgogIC8qKgogICAqIGNoZWNrIHRoYXQgdGhlIHRp
bWVzdGFtcCBpcyBuZXcgZW5vdWdoCiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBjaGVja190
aW1lc3RhbXAoJHRpbWVzdGFtcCkgewogICAgaWYoICEgJHRpbWVzdGFtcCApCiAgICAgIHRo
cm93IG5ldyBPQXV0aEV4Y2VwdGlvbigKICAgICAgICAnTWlzc2luZyB0aW1lc3RhbXAgcGFy
YW1ldGVyLiBUaGUgcGFyYW1ldGVyIGlzIHJlcXVpcmVkJwogICAgICApOwoKICAgIC8vIHZl
cmlmeSB0aGF0IHRpbWVzdGFtcCBpcyByZWNlbnRpc2gKICAgICRub3cgPSB0aW1lKCk7CiAg
ICBpZiAoYWJzKCRub3cgLSAkdGltZXN0YW1wKSA+ICR0aGlzLT50aW1lc3RhbXBfdGhyZXNo
b2xkKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigKICAgICAgICAiRXhwaXJl
ZCB0aW1lc3RhbXAsIHlvdXJzICR0aW1lc3RhbXAsIG91cnMgJG5vdyIKICAgICAgKTsKICAg
IH0KICB9CgogIC8qKgogICAqIGNoZWNrIHRoYXQgdGhlIG5vbmNlIGlzIG5vdCByZXBlYXRl
ZAogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gY2hlY2tfbm9uY2UoJGNvbnN1bWVyLCAkdG9r
ZW4sICRub25jZSwgJHRpbWVzdGFtcCkgewogICAgaWYoICEgJG5vbmNlICkKICAgICAgdGhy
b3cgbmV3IE9BdXRoRXhjZXB0aW9uKAogICAgICAgICdNaXNzaW5nIG5vbmNlIHBhcmFtZXRl
ci4gVGhlIHBhcmFtZXRlciBpcyByZXF1aXJlZCcKICAgICAgKTsKCiAgICAvLyB2ZXJpZnkg
dGhhdCB0aGUgbm9uY2UgaXMgdW5pcXVlaXNoCiAgICAkZm91bmQgPSAkdGhpcy0+ZGF0YV9z
dG9yZS0+bG9va3VwX25vbmNlKAogICAgICAkY29uc3VtZXIsCiAgICAgICR0b2tlbiwKICAg
ICAgJG5vbmNlLAogICAgICAkdGltZXN0YW1wCiAgICApOwogICAgaWYgKCRmb3VuZCkgewog
ICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIk5vbmNlIGFscmVhZHkgdXNlZDogJG5v
bmNlIik7CiAgICB9CiAgfQoKfQoKY2xhc3MgT0F1dGhEYXRhU3RvcmUgewogIGZ1bmN0aW9u
IGxvb2t1cF9jb25zdW1lcigkY29uc3VtZXJfa2V5KSB7CiAgICAvLyBpbXBsZW1lbnQgbWUK
ICB9CgogIGZ1bmN0aW9uIGxvb2t1cF90b2tlbigkY29uc3VtZXIsICR0b2tlbl90eXBlLCAk
dG9rZW4pIHsKICAgIC8vIGltcGxlbWVudCBtZQogIH0KCiAgZnVuY3Rpb24gbG9va3VwX25v
bmNlKCRjb25zdW1lciwgJHRva2VuLCAkbm9uY2UsICR0aW1lc3RhbXApIHsKICAgIC8vIGlt
cGxlbWVudCBtZQogIH0KCiAgZnVuY3Rpb24gbmV3X3JlcXVlc3RfdG9rZW4oJGNvbnN1bWVy
LCAkY2FsbGJhY2sgPSBudWxsKSB7CiAgICAvLyByZXR1cm4gYSBuZXcgdG9rZW4gYXR0YWNo
ZWQgdG8gdGhpcyBjb25zdW1lcgogIH0KCiAgZnVuY3Rpb24gbmV3X2FjY2Vzc190b2tlbigk
dG9rZW4sICRjb25zdW1lciwgJHZlcmlmaWVyID0gbnVsbCkgewogICAgLy8gcmV0dXJuIGEg
bmV3IGFjY2VzcyB0b2tlbiBhdHRhY2hlZCB0byB0aGlzIGNvbnN1bWVyCiAgICAvLyBmb3Ig
dGhlIHVzZXIgYXNzb2NpYXRlZCB3aXRoIHRoaXMgdG9rZW4gaWYgdGhlIHJlcXVlc3QgdG9r
ZW4KICAgIC8vIGlzIGF1dGhvcml6ZWQKICAgIC8vIHNob3VsZCBhbHNvIGludmFsaWRhdGUg
dGhlIHJlcXVlc3QgdG9rZW4KICB9Cgp9CgpjbGFzcyBPQXV0aFV0aWwgewogIHB1YmxpYyBz
dGF0aWMgZnVuY3Rpb24gdXJsZW5jb2RlX3JmYzM5ODYoJGlucHV0KSB7CiAgaWYgKGlzX2Fy
cmF5KCRpbnB1dCkpIHsKICAgIHJldHVybiBhcnJheV9tYXAoYXJyYXkoJ09BdXRoVXRpbCcs
ICd1cmxlbmNvZGVfcmZjMzk4NicpLCAkaW5wdXQpOwogIH0gZWxzZSBpZiAoaXNfc2NhbGFy
KCRpbnB1dCkpIHsKICAgIHJldHVybiBzdHJfcmVwbGFjZSgKICAgICAgJysnLAogICAgICAn
ICcsCiAgICAgIHN0cl9yZXBsYWNlKCclN0UnLCAnficsIHJhd3VybGVuY29kZSgkaW5wdXQp
KQogICAgKTsKICB9IGVsc2UgewogICAgcmV0dXJuICcnOwogIH0KfQoKCiAgLy8gVGhpcyBk
ZWNvZGUgZnVuY3Rpb24gaXNuJ3QgdGFraW5nIGludG8gY29uc2lkZXJhdGlvbiB0aGUgYWJv
dmUKICAvLyBtb2RpZmljYXRpb25zIHRvIHRoZSBlbmNvZGluZyBwcm9jZXNzLiBIb3dldmVy
LCB0aGlzIG1ldGhvZCBkb2Vzbid0CiAgLy8gc2VlbSB0byBiZSB1c2VkIGFueXdoZXJlIHNv
IGxlYXZpbmcgaXQgYXMgaXMuCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiB1cmxkZWNvZGVf
cmZjMzk4Nigkc3RyaW5nKSB7CiAgICByZXR1cm4gdXJsZGVjb2RlKCRzdHJpbmcpOwogIH0K
CiAgLy8gVXRpbGl0eSBmdW5jdGlvbiBmb3IgdHVybmluZyB0aGUgQXV0aG9yaXphdGlvbjog
aGVhZGVyIGludG8KICAvLyBwYXJhbWV0ZXJzLCBoYXMgdG8gZG8gc29tZSB1bmVzY2FwaW5n
CiAgLy8gQ2FuIGZpbHRlciBvdXQgYW55IG5vbi1vYXV0aCBwYXJhbWV0ZXJzIGlmIG5lZWRl
ZCAoZGVmYXVsdCBiZWhhdmlvdXIpCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBzcGxpdF9o
ZWFkZXIoJGhlYWRlciwgJG9ubHlfYWxsb3dfb2F1dGhfcGFyYW1ldGVycyA9IHRydWUpIHsK
ICAgICRwYXR0ZXJuID0gJy8oKFstX2Etel0qKT0oIihbXiJdKikifChbXixdKikpLD8pLyc7
CiAgICAkb2Zmc2V0ID0gMDsKICAgICRwYXJhbXMgPSBhcnJheSgpOwogICAgd2hpbGUgKHBy
ZWdfbWF0Y2goJHBhdHRlcm4sICRoZWFkZXIsICRtYXRjaGVzLCBQUkVHX09GRlNFVF9DQVBU
VVJFLCAkb2Zmc2V0KSA+IDApIHsKICAgICAgJG1hdGNoID0gJG1hdGNoZXNbMF07CiAgICAg
ICRoZWFkZXJfbmFtZSA9ICRtYXRjaGVzWzJdWzBdOwogICAgICAkaGVhZGVyX2NvbnRlbnQg
PSAoaXNzZXQoJG1hdGNoZXNbNV0pKSA/ICRtYXRjaGVzWzVdWzBdIDogJG1hdGNoZXNbNF1b
MF07CiAgICAgIGlmIChwcmVnX21hdGNoKCcvXm9hdXRoXy8nLCAkaGVhZGVyX25hbWUpIHx8
ICEkb25seV9hbGxvd19vYXV0aF9wYXJhbWV0ZXJzKSB7CiAgICAgICAgJHBhcmFtc1skaGVh
ZGVyX25hbWVdID0gT0F1dGhVdGlsOjp1cmxkZWNvZGVfcmZjMzk4NigkaGVhZGVyX2NvbnRl
bnQpOwogICAgICB9CiAgICAgICRvZmZzZXQgPSAkbWF0Y2hbMV0gKyBzdHJsZW4oJG1hdGNo
WzBdKTsKICAgIH0KCiAgICBpZiAoaXNzZXQoJHBhcmFtc1sncmVhbG0nXSkpIHsKICAgICAg
dW5zZXQoJHBhcmFtc1sncmVhbG0nXSk7CiAgICB9CgogICAgcmV0dXJuICRwYXJhbXM7CiAg
fQoKICAvLyBoZWxwZXIgdG8gdHJ5IHRvIHNvcnQgb3V0IGhlYWRlcnMgZm9yIHBlb3BsZSB3
aG8gYXJlbid0IHJ1bm5pbmcgYXBhY2hlCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBnZXRf
aGVhZGVycygpIHsKICAgIGlmIChmdW5jdGlvbl9leGlzdHMoJ2FwYWNoZV9yZXF1ZXN0X2hl
YWRlcnMnKSkgewogICAgICAvLyB3ZSBuZWVkIHRoaXMgdG8gZ2V0IHRoZSBhY3R1YWwgQXV0
aG9yaXphdGlvbjogaGVhZGVyCiAgICAgIC8vIGJlY2F1c2UgYXBhY2hlIHRlbmRzIHRvIHRl
bGwgdXMgaXQgZG9lc24ndCBleGlzdAogICAgICAkaGVhZGVycyA9IGFwYWNoZV9yZXF1ZXN0
X2hlYWRlcnMoKTsKCiAgICAgIC8vIHNhbml0aXplIHRoZSBvdXRwdXQgb2YgYXBhY2hlX3Jl
cXVlc3RfaGVhZGVycyBiZWNhdXNlCiAgICAgIC8vIHdlIGFsd2F5cyB3YW50IHRoZSBrZXlz
IHRvIGJlIENhc2VkLUxpa2UtVGhpcyBhbmQgYXJoKCkKICAgICAgLy8gcmV0dXJucyB0aGUg
aGVhZGVycyBpbiB0aGUgc2FtZSBjYXNlIGFzIHRoZXkgYXJlIGluIHRoZQogICAgICAvLyBy
ZXF1ZXN0CiAgICAgICRvdXQgPSBhcnJheSgpOwogICAgICBmb3JlYWNoKCAkaGVhZGVycyBB
UyAka2V5ID0+ICR2YWx1ZSApIHsKICAgICAgICAka2V5ID0gc3RyX3JlcGxhY2UoCiAgICAg
ICAgICAgICIgIiwKICAgICAgICAgICAgIi0iLAogICAgICAgICAgICB1Y3dvcmRzKHN0cnRv
bG93ZXIoc3RyX3JlcGxhY2UoIi0iLCAiICIsICRrZXkpKSkKICAgICAgICAgICk7CiAgICAg
ICAgJG91dFska2V5XSA9ICR2YWx1ZTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgLy8g
b3RoZXJ3aXNlIHdlIGRvbid0IGhhdmUgYXBhY2hlIGFuZCBhcmUganVzdCBnb2luZyB0byBo
YXZlIHRvIGhvcGUKICAgICAgLy8gdGhhdCAkX1NFUlZFUiBhY3R1YWxseSBjb250YWlucyB3
aGF0IHdlIG5lZWQKICAgICAgJG91dCA9IGFycmF5KCk7CiAgICAgIGlmKCBpc3NldCgkX1NF
UlZFUlsnQ09OVEVOVF9UWVBFJ10pICkKICAgICAgICAkb3V0WydDb250ZW50LVR5cGUnXSA9
ICRfU0VSVkVSWydDT05URU5UX1RZUEUnXTsKICAgICAgaWYoIGlzc2V0KCRfRU5WWydDT05U
RU5UX1RZUEUnXSkgKQogICAgICAgICRvdXRbJ0NvbnRlbnQtVHlwZSddID0gJF9FTlZbJ0NP
TlRFTlRfVFlQRSddOwoKICAgICAgZm9yZWFjaCAoJF9TRVJWRVIgYXMgJGtleSA9PiAkdmFs
dWUpIHsKICAgICAgICBpZiAoc3Vic3RyKCRrZXksIDAsIDUpID09ICJIVFRQXyIpIHsKICAg
ICAgICAgIC8vIHRoaXMgaXMgY2hhb3MsIGJhc2ljYWxseSBpdCBpcyBqdXN0IHRoZXJlIHRv
IGNhcGl0YWxpemUgdGhlIGZpcnN0CiAgICAgICAgICAvLyBsZXR0ZXIgb2YgZXZlcnkgd29y
ZCB0aGF0IGlzIG5vdCBhbiBpbml0aWFsIEhUVFAgYW5kIHN0cmlwIEhUVFAKICAgICAgICAg
IC8vIGNvZGUgZnJvbSBwcnplbWVrCiAgICAgICAgICAka2V5ID0gc3RyX3JlcGxhY2UoCiAg
ICAgICAgICAgICIgIiwKICAgICAgICAgICAgIi0iLAogICAgICAgICAgICB1Y3dvcmRzKHN0
cnRvbG93ZXIoc3RyX3JlcGxhY2UoIl8iLCAiICIsIHN1YnN0cigka2V5LCA1KSkpKQogICAg
ICAgICAgKTsKICAgICAgICAgICRvdXRbJGtleV0gPSAkdmFsdWU7CiAgICAgICAgfQogICAg
ICB9CiAgICB9CiAgICByZXR1cm4gJG91dDsKICB9CgogIC8vIFRoaXMgZnVuY3Rpb24gdGFr
ZXMgYSBpbnB1dCBsaWtlIGE9YiZhPWMmZD1lIGFuZCByZXR1cm5zIHRoZSBwYXJzZWQKICAv
LyBwYXJhbWV0ZXJzIGxpa2UgdGhpcwogIC8vIGFycmF5KCdhJyA9PiBhcnJheSgnYicsJ2Mn
KSwgJ2QnID0+ICdlJykKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHBhcnNlX3BhcmFtZXRl
cnMoICRpbnB1dCApIHsKICAgIGlmICghaXNzZXQoJGlucHV0KSB8fCAhJGlucHV0KSByZXR1
cm4gYXJyYXkoKTsKCiAgICAkcGFpcnMgPSBleHBsb2RlKCcmJywgJGlucHV0KTsKCiAgICAk
cGFyc2VkX3BhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgZm9yZWFjaCAoJHBhaXJzIGFzICRw
YWlyKSB7CiAgICAgICRzcGxpdCA9IGV4cGxvZGUoJz0nLCAkcGFpciwgMik7CiAgICAgICRw
YXJhbWV0ZXIgPSBPQXV0aFV0aWw6OnVybGRlY29kZV9yZmMzOTg2KCRzcGxpdFswXSk7CiAg
ICAgICR2YWx1ZSA9IGlzc2V0KCRzcGxpdFsxXSkgPyBPQXV0aFV0aWw6OnVybGRlY29kZV9y
ZmMzOTg2KCRzcGxpdFsxXSkgOiAnJzsKCiAgICAgIGlmIChpc3NldCgkcGFyc2VkX3BhcmFt
ZXRlcnNbJHBhcmFtZXRlcl0pKSB7CiAgICAgICAgLy8gV2UgaGF2ZSBhbHJlYWR5IHJlY2ll
dmVkIHBhcmFtZXRlcihzKSB3aXRoIHRoaXMgbmFtZSwgc28gYWRkIHRvIHRoZSBsaXN0CiAg
ICAgICAgLy8gb2YgcGFyYW1ldGVycyB3aXRoIHRoaXMgbmFtZQoKICAgICAgICBpZiAoaXNf
c2NhbGFyKCRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSkpIHsKICAgICAgICAgIC8v
IFRoaXMgaXMgdGhlIGZpcnN0IGR1cGxpY2F0ZSwgc28gdHJhbnNmb3JtIHNjYWxhciAoc3Ry
aW5nKSBpbnRvIGFuIGFycmF5CiAgICAgICAgICAvLyBzbyB3ZSBjYW4gYWRkIHRoZSBkdXBs
aWNhdGVzCiAgICAgICAgICAkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl0gPSBhcnJh
eSgkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl0pOwogICAgICAgIH0KCiAgICAgICAg
JHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdW10gPSAkdmFsdWU7CiAgICAgIH0gZWxz
ZSB7CiAgICAgICAgJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdID0gJHZhbHVlOwog
ICAgICB9CiAgICB9CiAgICByZXR1cm4gJHBhcnNlZF9wYXJhbWV0ZXJzOwogIH0KCiAgcHVi
bGljIHN0YXRpYyBmdW5jdGlvbiBidWlsZF9odHRwX3F1ZXJ5KCRwYXJhbXMpIHsKICAgIGlm
ICghJHBhcmFtcykgcmV0dXJuICcnOwoKICAgIC8vIFVybGVuY29kZSBib3RoIGtleXMgYW5k
IHZhbHVlcwogICAgJGtleXMgPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KGFycmF5
X2tleXMoJHBhcmFtcykpOwogICAgJHZhbHVlcyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3Jm
YzM5ODYoYXJyYXlfdmFsdWVzKCRwYXJhbXMpKTsKICAgICRwYXJhbXMgPSBhcnJheV9jb21i
aW5lKCRrZXlzLCAkdmFsdWVzKTsKCiAgICAvLyBQYXJhbWV0ZXJzIGFyZSBzb3J0ZWQgYnkg
bmFtZSwgdXNpbmcgbGV4aWNvZ3JhcGhpY2FsIGJ5dGUgdmFsdWUgb3JkZXJpbmcuCiAgICAv
LyBSZWY6IFNwZWM6IDkuMS4xICgxKQogICAgdWtzb3J0KCRwYXJhbXMsICdzdHJjbXAnKTsK
CiAgICAkcGFpcnMgPSBhcnJheSgpOwogICAgZm9yZWFjaCAoJHBhcmFtcyBhcyAkcGFyYW1l
dGVyID0+ICR2YWx1ZSkgewogICAgICBpZiAoaXNfYXJyYXkoJHZhbHVlKSkgewogICAgICAg
IC8vIElmIHR3byBvciBtb3JlIHBhcmFtZXRlcnMgc2hhcmUgdGhlIHNhbWUgbmFtZSwgdGhl
eSBhcmUgc29ydGVkIGJ5IHRoZWlyIHZhbHVlCiAgICAgICAgLy8gUmVmOiBTcGVjOiA5LjEu
MSAoMSkKICAgICAgICBuYXRzb3J0KCR2YWx1ZSk7CiAgICAgICAgZm9yZWFjaCAoJHZhbHVl
IGFzICRkdXBsaWNhdGVfdmFsdWUpIHsKICAgICAgICAgICRwYWlyc1tdID0gJHBhcmFtZXRl
ciAuICc9JyAuICRkdXBsaWNhdGVfdmFsdWU7CiAgICAgICAgfQogICAgICB9IGVsc2Ugewog
ICAgICAgICRwYWlyc1tdID0gJHBhcmFtZXRlciAuICc9JyAuICR2YWx1ZTsKICAgICAgfQog
ICAgfQogICAgLy8gRm9yIGVhY2ggcGFyYW1ldGVyLCB0aGUgbmFtZSBpcyBzZXBhcmF0ZWQg
ZnJvbSB0aGUgY29ycmVzcG9uZGluZyB2YWx1ZSBieSBhbiAnPScgY2hhcmFjdGVyIChBU0NJ
SSBjb2RlIDYxKQogICAgLy8gRWFjaCBuYW1lLXZhbHVlIHBhaXIgaXMgc2VwYXJhdGVkIGJ5
IGFuICcmJyBjaGFyYWN0ZXIgKEFTQ0lJIGNvZGUgMzgpCiAgICByZXR1cm4gaW1wbG9kZSgn
JicsICRwYWlycyk7CiAgfQp9IjtzOjM6Im1kNSI7czozMjoiM2NlZGQyZTI1MDc0ODQxZWI1
ZjQwNzc3YWQ0YWRmNmMiO30=
