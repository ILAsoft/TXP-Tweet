# arc_twitter v3.0
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjM6
IjMuMCI7czo2OiJhdXRob3IiO3M6MTE6IkFuZHkgQ2FydGVyIjtzOjEwOiJhdXRob3JfdXJp
IjtzOjMxOiJodHRwOi8vcmVkaG90Y2hpbGxpcHJvamVjdC5jb20vIjtzOjExOiJkZXNjcmlw
dGlvbiI7czo2MDoiPGEgaHJlZj0iaHR0cDovL3d3dy50d2l0dGVyLmNvbSI+VHdpdHRlcjwv
YT4gZm9yIFRleHRwYXR0ZXJuIjtzOjU6Im9yZGVyIjtzOjE6IjUiO3M6NDoidHlwZSI7czox
OiIxIjtzOjU6ImZsYWdzIjtzOjE6IjMiO3M6NDoiaGVscCI7czoxNjk5MToiCTxoMSBjbGFz
cz0idGl0bGUiPjxzcGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0IChhcmNfdHdp
dHRlciBmb3IgVGV4dHBhdHRlcm4pPC9oMT4KCgk8b2w+CgkJPGxpPjxhIGhyZWY9IiNhcmNf
dHdpdHRlcl9hdXRob3IiPkF1dGhvcjwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3
aXR0ZXJfaW5zdGFsbGF0aW9uIj5JbnN0YWxsYXRpb24gLyBVbmluc3RhbGxhdGlvbjwvYT48
L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfdGFnIj5UaGUgYXJjX3R3aXR0ZXIg
dGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl9zZWFyY2hfdGFnIj5U
aGUgYXJjX3R3aXR0ZXJfc2VhcmNoIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJj
X3R3aXR0ZXJfdHdlZXRfYnV0dG9uX3RhZyI+VGhlIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRv
biB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX2ZvbGxvd19idXR0
b25fdGFnIj5UaGUgYXJjX3R3aXR0ZXJfZm9sbG93X2J1dHRvbiB0YWc8L2E+PC9saT4KCQk8
bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3R3ZWV0X3VybCI+VGhlIGFyY190d2l0dGVyX3R3
ZWV0X3VybCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3Rpbnl1
cmwiPlRoZSBhcmNfdHdpdHRlcl90aW55dXJsIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVm
PSIjYXJjX3R3aXR0ZXJfY2FjaGluZyI+Q2FjaGluZzwvYT48L2xpPgoJCTxsaT48YSBocmVm
PSIjYXJjX3R3aXR0ZXJfcHJlZnMiPlByZWZlcmVuY2VzPC9hPjwvbGk+CgkJPGxpPjxhIGhy
ZWY9IiNhcmNfdHdpdHRlcl9hcnRpY2xlIj5Ud2VldGluZyBhcnRpY2xlczwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfYWRtaW4iPlRoZSBUd2l0dGVyIHRhYjwvYT48
L2xpPgoJPC9vbD4KCgk8cD48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCBw
cm92aWRlcyBhY2Nlc3MgdG8geW91ciBUd2l0dGVyIGFjY291bnQgdGhyb3VnaCBib3RoIHRo
ZSBhZG1pbiBpbnRlcmZhY2UgYW5kIHRoZSBwdWJsaWMgc2lkZSBvZiB5b3VyIHNpdGUuIFVw
ZGF0ZSBUd2l0dGVyIHdoZW4geW91IHBvc3QgYSBuZXcgYXJ0aWNsZSAod2l0aCBhcnRpY2xl
LWJ5LWFydGljbGUgb3B0IG91dCBvcHRpb24pLCB1cGRhdGUgYW5kIHZpZXcgeW91ciBUd2l0
dGVyIGZlZWQgdGhyb3VnaCB0aGUgYWRtaW4gVHdpdHRlciB0YWIsIGFuZCBkaXNwbGF5IFR3
aXR0ZXIgZmVlZHMgb24geW91ciBzaXRlLjwvcD4KCgk8cD5SZXF1aXJlbWVudHM6LTwvcD4K
Cgk8dWw+CgkJPGxpPlRleHRwYXR0ZXJuIDQuMis8L2xpPgoJCTxsaT48c3BhbiBjbGFzcz0i
Y2FwcyI+UEhQPC9zcGFuPiA1IGFuZCBjVVJMPC9saT4KCTwvdWw+CgoJPGgyIGNsYXNzPSJz
ZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2gyPgoKCTxwPjxhIGhy
ZWY9Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbSI+QW5keSBDYXJ0ZXI8L2E+LiBG
b3Igb3RoZXIgVGV4dHBhdHRlcm4gcGx1Z2lucyBieSBtZSB2aXNpdCBteSA8YSBocmVmPSJo
dHRwOi8vcmVkaG90Y2hpbGxpcHJvamVjdC5jb20vdHhwIj5QbHVnaW5zIHBhZ2U8L2E+Ljwv
cD4KCgk8cD5UaGFua3MgdG8gPGEgaHJlZj0iaHR0cDovL21hbmZyZS5uZXQvIj5NaWNoYWVs
IE1hbmZyZTwvYT4gZm9yIGluc3BpcmF0aW9uIGZvciB0aGUgYXJ0aWNsZSB0d2VldCBwYXJ0
IG9mIHRoaXMgcGx1Z2luIGJhc2VkIG9uIGhpcyA8c3BhbiBjbGFzcz0idGFnIj5tZW1fdHdp
dHRlcjwvc3Bhbj4gcGx1Z2luLiAgQWRkaXRpb25hbCB0aGFua3MgdG8gdGhlIGdyZWF0IFRl
eHRwYXR0ZXJuIGNvbW11bml0eSBmb3IgaGVscGluZyB0byB0ZXN0IHRoaXMgcGx1Z2luIGFu
ZCBmb3Igc3VnZ2VzdGluZyBuZXcgZmVhdHVyZXMuIFRoZSBPQXV0aCBwYXJ0IG9mIHRoZSBw
bHVnaW4gaXMgdGhhbmtzIHRvIDxhIGhyZWY9Imh0dHA6Ly90d2l0dGVyLmNvbS9hYnJhaGFt
Ij5BYnJhaGFtIFdpbGxpYW1zPC9hPi48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0i
YXJjX3R3aXR0ZXJfaW5zdGFsbGF0aW9uIj5JbnN0YWxsYXRpb24gLyBVbmluc3RhbGxhdGlv
bjwvaDI+CgoJPHA+VG8gaW5zdGFsbCBnbyB0byB0aGUgJiM4MjE2O3BsdWdpbnMmIzgyMTc7
IHRhYiB1bmRlciAmIzgyMTY7YWRtaW4mIzgyMTc7IGFuZCBwYXN0ZSB0aGUgcGx1Z2luIGNv
ZGUgaW50byB0aGUgJiM4MjE2O0luc3RhbGwgcGx1Z2luJiM4MjE3OyBib3gsICYjODIxNjt1
cGxvYWQmIzgyMTc7IGFuZCB0aGVuICYjODIxNjtpbnN0YWxsJiM4MjE3Oy4gRmluYWxseSBh
Y3RpdmF0ZSB0aGUgcGx1Z2luLjwvcD4KCgk8cD5CZWZvcmUgeW91IHN0YXJ0IHVzaW5nIDxz
cGFuIGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiB5b3Ugd2lsbCBuZWVkIHRvIG1h
a2Ugc3VyZSB0aGF0IHRoZSBjYWNoZSBkaXJlY3RvcnkgaXMgd3JpdGFibGUuIFNlZSB0aGUg
JiM4MjE2O0NhY2hpbmcmIzgyMTc7IHN1YnNlY3Rpb24gYmVsb3cgZm9yIGZ1cnRoZXIgaW5m
b3JtYXRpb24uPC9wPgoKCTxwPjxzcGFuIGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFu
PiBzaG91bGQgbm93IGJlIHJlYWR5IGZvciB1c2Ugb24gdGhlIHB1YmxpYy1zaWRlIG9mIHlv
dXIgc2l0ZS48L3A+CgoJPHA+VG8gdW5sb2NrIHRoZSBhZG1pbiBmZWF0dXJlcyBvZiB0aGlz
IHBsdWdpbiB5b3Ugd2lsbCBuZWVkIHRvIGFzc29jaWF0ZSB5b3VyIHNpdGUgd2l0aCBhIFR3
aXR0ZXIgYWNjb3VudCBieSBjb25uZWN0aW5nIHRvIFR3aXR0ZXIgZnJvbSB0aGUgcGx1Z2lu
JiM4MjE3O3Mgb3B0aW9ucyBzY3JlZW4uIENsaWNrIG9uIHRoZSBsaW5rIHRvIGNvbm5lY3Qg
dG8gVHdpdHRlciwgeW91IHdpbGwgYmUgYXNrZWQgdG8gbG9naW4gdG8gVHdpdHRlciwgY2xp
Y2tpbmcgdGhpcyBsaW5rIHdpbGwgdGVtcG9yYXJpbHkgdGFrZSB5b3UgdG8gdGhlIFR3aXR0
ZXIgc2l0ZSB3aGVyZSB5b3Ugd2lsbCBiZSBhc2tlZCB0byBsb2dpbiBhbmQgYXBwcm92ZSBh
Y2Nlc3MgZm9yIDxzcGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0IHRvIHJlYWQg
YW5kIHdyaXRlIHRvIHlvdXIgVHdpdHRlciBhY2NvdW50LiBJZiBhbGwgaXMgc3VjY2Vzc2Z1
bCB5b3Ugd2lsbCBiZSByZXR1cm5lZCB0byB0aGUgb3B0aW9ucyBzY3JlZW4gYW5kIHlvdXIg
dXNlciBuYW1lIHdpbGwgYXBwZWFyLjwvcD4KCgk8cD5BdCBhbnkgdGltZSB5b3UgY2FuIGRp
c2Fzc29jaWF0ZSB5b3VyIFR3aXR0ZXIgYWNjb3VudCB3aXRoIDxzcGFuIGNsYXNzPSJjYXBz
Ij5UWFA8L3NwYW4+IFR3ZWV0IHZpYSB5b3VyIFR3aXR0ZXIgYWNjb3VudCBwcmVmZXJlbmNl
cyBvbiB0aGUgPGEgaHJlZj0iaHR0cDovL3d3dy50d2l0dGVyLmNvbSI+VHdpdHRlciB3ZWJz
aXRlPC9hPi48L3A+CgoJPHA+VG8gdW5pbnN0YWxsIDxzcGFuIGNsYXNzPSJ0YWciPmFyY190
d2l0dGVyPC9zcGFuPiBzaW1wbHkgZGVsZXRlIHRoZSBwbHVnaW4gZnJvbSB0aGUgJiM4MjE2
O1BsdWdpbnMmIzgyMTc7IHRhYi4gIFRoaXMgd2lsbCByZW1vdmUgdGhlIHBsdWdpbiBjb2Rl
LCBkZWxldGUgcmVsYXRlZCBwcmVmZXJlbmNlcyBhbmQgZHJvcCB0aGUgPHNwYW4gY2xhc3M9
InRhZyI+YXJjX3R3aXR0ZXI8L3NwYW4+IHRhYmxlIGZyb20geW91ciBUZXh0cGF0dGVybiBk
YXRhYmFzZS48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfdGFn
Ij5UaGUgYXJjX3R3aXR0ZXIgdGFnPC9oMj4KCgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7
dHhwOmFyY190d2l0dGVyIHVzZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZxdW90OyAvJmd0Ozwv
cD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8
L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0
aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVzZXI8L3RkPgoJCQk8dGQ+
VHdpdHRlciB1c2VyIG5hbWU8L3RkPgoJCQk8dGQ+IDxlbT5hcmNfdHdpdHRlciB1c2VybmFt
ZTwvZW0+PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZxdW90OzwvdGQ+
CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5saW1pdDwvdGQ+CgkJCTx0ZD5NYXhpbXVtIG51bWJl
ciBvZiB0d2VldHMgdG8gZGlzcGxheSAobWF4LiAyMDApPC90ZD4KCQkJPHRkPjEwPC90ZD4K
CQkJPHRkPmxpbWl0PSZxdW90OzI1JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRk
PmRhdGVmb3JtYXQ8L3RkPgoJCQk8dGQ+Rm9ybWF0IHRoYXQgdXBkYXRlIGRhdGVzIHdpbGwg
YXBwZWFyIGFzPC90ZD4KCQkJPHRkPiA8ZW0+QXJjaGl2ZSBkYXRlIGZvcm1hdDwvZW0+PC90
ZD4KCQkJPHRkPmRhdGVmb3JtYXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAlcCZxdW90OzwvdGQ+
CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbDwvdGQ+CgkJCTx0ZD5MYWJlbCBmb3IgdGhl
IHRvcCBvZiB0aGUgbGlzdDwvdGQ+CgkJCTx0ZD4gPGVtPm5vIGxhYmVsPC9lbT48L3RkPgoJ
CQk8dGQ+bGFiZWw9JnF1b3Q7TXkgVHdpdHRlciB0aW1lbGluZSZxdW90OzwvdGQ+CgkJPC90
cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbHRhZzwvdGQ+CgkJCTx0ZD5JbmRlcGVuZGVudCB3cmFw
dGFnIGZvciBsYWJlbDwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+
bGFiZWx0YWc9JnF1b3Q7aDMmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+YnJl
YWs8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5I
VE1MPC9zcGFuPjwvc3Bhbj4gdGFnICh3aXRob3V0IGJyYWNrZXRzKSwgb3Igc3RyaW5nLCB1
c2VkIHRvIHNlcGFyYXRlIHRoZSB1cGRhdGVzPC90ZD4KCQkJPHRkPmxpPC90ZD4KCQkJPHRk
PmJyZWFrPSZxdW90O2JyJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPndyYXB0
YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5I
VE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVzZWQgYXMgdGhlIHdyYXB0YWcsIHdpdGhv
dXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJPHRkPndy
YXB0YWc9JnF1b3Q7dWwmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8
L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8
L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgZm9yIHdyYXB0YWc8L3RkPgoJCQk8dGQ+
YXJjX3R3aXR0ZXI8L3RkPgoJCQk8dGQ+Y2xhc3M9JnF1b3Q7dHdpdHRlciZxdW90OzwvdGQ+
CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzc19wb3N0ZWQ8L3RkPgoJCQk8dGQ+PHNwYW4g
Y2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFz
cyBhdHRyaWJ1dGUgYXBwbGllZCB0byBzcGFuIHRhZyBhcm91bmQgcG9zdGVkIGRhdGU8L3Rk
PgoJCQk8dGQ+YXJjX3R3aXR0ZXItcG9zdGVkPC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8
aDM+RXhhbXBsZSB1c2FnZTwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlciB1c2VyPSZx
dW90O2RybW9ua2V5bmluamEmcXVvdDsgbGltaXQ9JnF1b3Q7NSZxdW90OyB3cmFwdGFnPSZx
dW90O3VsJnF1b3Q7IGJyZWFrPSZxdW90O2xpJnF1b3Q7IGRhdGVmb3JtYXQ9JnF1b3Q7JWIg
JU9lLCAlSTolTSAlcCZxdW90OyAvJmd0OzwvcD4KCgk8cD5Qcm9kdWNlcyBhIGJ1bGxldCBw
b2ludCBsaXN0IG9mIHRoZSBsYXN0IDUgVHdpdHRlciB1cGRhdGVzIGZyb20gZHJtb25rZXlu
aW5qYSYjODIxNztzIFR3aXR0ZXIgZmVlZCB3aXRoIGEgZGVmaW5lZCBkYXRlIGZvcm1hdCB0
byBvdmVycmlkZSB0aGUgZGVmYXVsdCBhcmNoaXZlIGRhdGUgZm9ybWF0LjwvcD4KCgk8aDIg
Y2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9zZWFyY2hfdGFnIj5UaGUgYXJjX3R3
aXR0ZXJfc2VhcmNoIHRhZzwvaDI+CgoJPGgzPlN5bnRheDwvaDM+CgoJPHA+Jmx0O3R4cDph
cmNfdHdpdHRlcl9zZWFyY2ggaGFzaHRhZ3M9JnF1b3Q7dHhwJnF1b3Q7IC8mZ3Q7PC9wPgoK
CTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwvdGg+
CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRoPkV4
YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+c2VhcmNoPC90ZD4KCQkJPHRkPkNv
bW1hIHNlcGFyYXRlZCBsaXN0IG9mIHNlYXJjaCB3b3JkczwvdGQ+CgkJCTx0ZD4gPGVtPnVu
c2V0PC9lbT48L3RkPgoJCQk8dGQ+c2VhcmNoPSZxdW90O3R4cCx0ZXh0cGF0dGVybiZxdW90
OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5oYXNodGFnczwvdGQ+CgkJCTx0ZD5Db21t
YSBzZXBhcmF0ZWQgbGlzdCBvZiBoYXNodGFncyB0byBzZWFyY2ggZm9yIChub3QgaW5jbHVk
aW5nIHRoZSBoYXNoKTwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+
aGFzaHRhZ3M9JnF1b3Q7dHhwLHRleHRwYXR0ZXJuJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0
cj4KCQkJPHRkPnJlcGx5PC90ZD4KCQkJPHRkPlVzZXJuYW1lIG9mIHR3ZWV0cyBpbiByZXBs
eSB0bzwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+cmVwbHk9JnF1
b3Q7dHdpdHRlciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5tZW50aW9uPC90
ZD4KCQkJPHRkPlVzZXJuYW1lIG9mIHVzZXIgbWVudGlvbmVkIGluIHR3ZWV0cyAoPGk+aS5l
LjwvaT4gdHdlZXRzIGNvbnRhaW5pbmcgQHVzZXJuYW1lKTwvdGQ+CgkJCTx0ZD4gPGVtPnVu
c2V0PC9lbT48L3RkPgoJCQk8dGQ+bWVudGlvbj0mcXVvdDt0d2l0dGVyJnF1b3Q7PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxpbWl0PC90ZD4KCQkJPHRkPk1heGltdW0gbnVtYmVy
IG9mIHR3ZWV0cyB0byBkaXNwbGF5IChtYXguIDIwMCk8L3RkPgoJCQk8dGQ+MTA8L3RkPgoJ
CQk8dGQ+bGltaXQ9JnF1b3Q7MjUmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+
ZGF0ZWZvcm1hdDwvdGQ+CgkJCTx0ZD5Gb3JtYXQgdGhhdCB1cGRhdGUgZGF0ZXMgd2lsbCBh
cHBlYXIgYXM8L3RkPgoJCQk8dGQ+IDxlbT5BcmNoaXZlIGRhdGUgZm9ybWF0PC9lbT48L3Rk
PgoJCQk8dGQ+ZGF0ZWZvcm1hdD0mcXVvdDslYiAlT2UsICVJOiVNICVwJnF1b3Q7PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsPC90ZD4KCQkJPHRkPkxhYmVsIGZvciB0aGUg
dG9wIG9mIHRoZSBsaXN0PC90ZD4KCQkJPHRkPiA8ZW0+bm8gbGFiZWw8L2VtPjwvdGQ+CgkJ
PC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbHRhZzwvdGQ+CgkJCTx0ZD5JbmRlcGVuZGVudCB3
cmFwdGFnIGZvciBsYWJlbDwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwv
dHI+CgkJPHRyPgoJCQk8dGQ+YnJlYWs8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMi
PjxzcGFuIGNsYXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnICh3aXRob3V0IGJy
YWNrZXRzKSwgb3Igc3RyaW5nLCB1c2VkIHRvIHNlcGFyYXRlIHRoZSB1cGRhdGVzPC90ZD4K
CQkJPHRkPmxpPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPndyYXB0YWc8L3RkPgoJCQk8
dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwv
c3Bhbj4gdGFnIHRvIGJlIHVzZWQgYXMgdGhlIHdyYXB0YWcsIHdpdGhvdXQgYnJhY2tldHM8
L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRk
PmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2Fw
cyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGZvciB3cmFwdGFnPC90ZD4K
CQkJPHRkPmFyY190d2l0dGVyX3NlYXJjaDwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5j
bGFzc191c2VyPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0i
Y2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gc3Bh
biB0YWcgYXJvdW5kIHVzZXIgbmFtZTwvdGQ+CgkJCTx0ZD5hcmNfdHdpdHRlci11c2VyPC90
ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzX3Bvc3RlZDwvdGQ+CgkJCTx0ZD48c3Bh
biBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNs
YXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHNwYW4gdGFnIGFyb3VuZCBwb3N0ZWQgZGF0ZTwv
dGQ+CgkJCTx0ZD5hcmNfdHdpdHRlci1wb3N0ZWQ8L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoK
CTxoMz5FeGFtcGxlIHVzYWdlPC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyX3NlYXJj
aCBzZWFyY2g9JnF1b3Q7cGx1Z2luJnF1b3Q7IGhhc2h0YWdzPSZxdW90O3R4cCx0ZXh0cGF0
dGVybiZxdW90OyBsaW1pdD0mcXVvdDsyNSZxdW90OyAvJmd0OzwvcD4KCgk8cD5Qcm9kdWNl
cyBhIGxpc3Qgb2YgdHdlZXRzIGNvbnRhaW5pbmcgdGhlIHdvcmQgJiM4MjE2O3BsdWdpbiYj
ODIxNzsgYW5kIHRoZSBoYXNodGFncyAmIzgyMTY7I3R4cCYjODIxNzsgYW5kICYjODIxNjsj
dGV4dHBhdHRlcm4mIzgyMTc7LiBUaGUgdGFnIHdpbGwgcmV0dXJuIGEgbWF4aW11bSBvZiAy
NSB0d2VldHMuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX3Jl
dHdlZXRfdGFnIj5UaGUgYXJjX3R3aXR0ZXJfdHdlZXRfYnV0dG9uIHRhZzwvaDI+CgoJPHA+
T3V0cHV0cyB0aGUgVHdpdHRlciB0d2VldCBidXR0b24gKGZvcm1lcmx5ICZsdDt0eHA6YXJj
X3R3aXR0ZXJfcmV0d2VldCAvJmd0OykuPC9wPgoKCTxoMz5TeW50YXg8L2gzPgoKCTxwPiZs
dDt0eHA6YXJjX3R3aXR0ZXJfdHdlZXRfYnV0dG9uIC8mZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwv
aDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNj
cmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+dXNlcjwvdGQ+CgkJCTx0ZD5Ud2l0dGVyIHVzZXIgbmFt
ZSB0byBxdW90ZTwvdGQ+CgkJCTx0ZD4gPGVtPmFyY190d2l0dGVyIHVzZXJuYW1lPC9lbT48
L3RkPgoJCQk8dGQ+dXNlcj0mcXVvdDtkcm1vbmtleW5pbmphJnF1b3Q7PC90ZD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPnVybDwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNw
YW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj48L3NwYW4+IHRvIHR3ZWV0PC90ZD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPnRleHQ8L3RkPgoJCQk8dGQ+VHdlZXQgdGV4dDwvdGQ+CgkJPC90
cj4KCQk8dHI+CgkJCTx0ZD5mb2xsb3cxPC90ZD4KCQkJPHRkPlN1Z2dlc3RlZCBUd2l0dGVy
IGFjY291bnQgdG8gZm9sbG93LCBmb3IgZXhhbXBsZSB5b3VyIG93bjwvdGQ+CgkJCTx0ZD5B
IFR3aXR0ZXIgdXNlciB0byByZWNvbW1lbmQ8L3RkPgoJCQk8dGQ+Zm9sbG93MT0mcXVvdDtU
ZXh0cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5mb2xsb3cyPC90
ZD4KCQkJPHRkPkFzIGZvbGxvdzE8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhbmc8L3RkPgoJCQk8dGQ+TGFuZ3VhZ2U8L3RkPgoJ
CQk8dGQ+ZW48L3RkPgoJCQk8dGQ+bGFuZz0mcXVvdDtlcyZxdW90OzwvdGQ+CgkJPC90cj4K
CQk8dHI+CgkJCTx0ZD5jb3VudDwvdGQ+CgkJCTx0ZD5Db3VudCBib3ggcG9zaXRpb24sIG9w
dGlvbnM6IG5vbmUsIGhvcml6b250YWwgb3IgdmVydGljYWw8L3RkPgoJCQk8dGQ+aG9yaXpv
bnRhbDwvdGQ+CgkJCTx0ZD5jb3VudD0mcXVvdDtub25lJnF1b3Q7PC90ZD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmluY2x1ZGVfanM8L3RkPgoJCQk8dGQ+V2hldGhlciBvciBub3QgdG8g
aW5jbHVkZSB0aGUgd2lkZ2V0IEphdmFTY3JpcHQ8L3RkPgoJCQk8dGQ+MTwvdGQ+CgkJCTx0
ZD5pbmNsdWRlX2pzPSZxdW90OzAmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+
b3B0aW1pc2VfanM8L3RkPgoJCQk8dGQ+T3B0aW1pc2UgdGhlIEphdmFTY3JpcHQgYnkgdXNp
bmcgYSBsb2NhbCBzY3JpcHQgcmF0aGVyIHRoYW4gdGhhdCBob3N0ZWQgb24gdGhlIFR3aXR0
ZXIgc2l0ZTwvdGQ+CgkJCTx0ZD4wPC90ZD4KCQkJPHRkPm9wdGltaXNlX2pzPSZxdW90OzEm
cXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNw
YW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBj
bGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byB0aGUgdHdlZXQgYnV0dG9uPC90ZD4KCQkJPHRk
PnR3aXR0ZXItc2hhcmUtYnV0dG9uPC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8aDIgY2xh
c3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9mb2xsb3dfYnV0dG9uX3RhZyI+VGhlIGFy
Y190d2l0dGVyX2ZvbGxvd19idXR0b24gdGFnPC9oMj4KCgk8cD5PdXRwdXRzIHRoZSBUd2l0
dGVyIGZvbGxvdyBidXR0b24gKGFuIGFsdGVybmF0aXZlIHZlcnNpb24gaXMgaW5jbHVkZWQg
aW4gYXJjX3R3aXR0ZXJfaW50ZW50cykuPC9wPgoKCTxoMz5TeW50YXg8L2gzPgoKCTxwPiZs
dDt0eHA6YXJjX3R3aXR0ZXJfZm9sbG93X2J1dHRvbiAvJmd0OzwvcD4KCgk8aDM+VXNhZ2U8
L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVz
Y3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVzZXI8L3RkPgoJCQk8dGQ+VHdpdHRlciB1c2VyIG5h
bWUgdG8gZm9sbG93PC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0ZXIgdXNlcm5hbWU8L2Vt
PjwvdGQ+CgkJCTx0ZD51c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDs8L3RkPgoJCTwv
dHI+CgkJPHRyPgoJCQk8dGQ+bGFuZzwvdGQ+CgkJCTx0ZD5MYW5ndWFnZTwvdGQ+CgkJCTx0
ZD5lbjwvdGQ+CgkJCTx0ZD5sYW5nPSZxdW90O2VzJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0
cj4KCQkJPHRkPmNvdW50PC90ZD4KCQkJPHRkPldoZXRoZXIgb3Igbm90IHRoZSBmb2xsb3dl
ciBjb3VudCBpcyBzaG93bjwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQkJPHRkPmNvdW50PSZxdW90
OzAmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aW5jbHVkZV9qczwvdGQ+CgkJ
CTx0ZD5XaGV0aGVyIG9yIG5vdCB0byBpbmNsdWRlIHRoZSB3aWRnZXQgSmF2YVNjcmlwdDwv
dGQ+CgkJCTx0ZD4xPC90ZD4KCQkJPHRkPmluY2x1ZGVfanM9JnF1b3Q7MCZxdW90OzwvdGQ+
CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5vcHRpbWlzZV9qczwvdGQ+CgkJCTx0ZD5PcHRpbWlz
ZSB0aGUgSmF2YVNjcmlwdCBieSB1c2luZyBhIGxvY2FsIHNjcmlwdCByYXRoZXIgdGhhbiB0
aGF0IGhvc3RlZCBvbiB0aGUgVHdpdHRlciBzaXRlPC90ZD4KCQkJPHRkPjA8L3RkPgoJCQk8
dGQ+b3B0aW1pc2VfanM9JnF1b3Q7MSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNh
cHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHRoZSBm
b2xsb3cgYnV0dG9uPC90ZD4KCQkJPHRkPnR3aXR0ZXItZm9sbG93LWJ1dHRvbjwvdGQ+CgkJ
PC90cj4KCTwvdGFibGU+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJf
dHdlZXRfdXJsIj5hcmNfdHdpdHRlcl90d2VldF91cmw8L2gyPgoKCTxwPlJldHVybnMgdGhl
IDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+IG9mIHRoZSBUd2l0dGVyIHN0YXR1cyBm
b3IgYW4gYXJ0aWNsZS48L3A+CgoJPGgzPlN5bnRheDwvaDM+CgoJPHA+Jmx0O3R4cDphcmNf
dHdpdHRlcl90d2VldF91cmwgLyZndDs8L3A+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl90
d2VldF91cmwmZ3Q7TGluayB0ZXh0Jmx0Oy90eHA6YXJjX3R3aXR0ZXJfdHdlZXRfdXJsJmd0
OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1
dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJ
CTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmlkPC90ZD4KCQkJPHRk
PlRleHRwYXR0ZXJuIGFydGljbGUgSUQ8L3RkPgoJCQk8dGQ+IDxlbT5jdXJyZW50IGFydGlj
bGU8L2VtPjwvdGQ+CgkJCTx0ZD5pZD0mcXVvdDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0
cj4KCQkJPHRkPnRpdGxlPC90ZD4KCQkJPHRkPlRpdGxlIGF0dHJpYnV0ZSBvZiB0aGUgbGlu
azwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8
dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJj
YXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byB0aGUg
bGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwvdHI+Cgk8L3RhYmxl
PgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX3Rpbnl1cmwiPmFyY190
d2l0dGVyX3Rpbnl1cmw8L2gyPgoKCTxwPlJldHVybnMgdGhlIHNob3J0ZW5lZCA8c3BhbiBj
bGFzcz0iY2FwcyI+VVJMPC9zcGFuPiBvZiB0aGUgYXJ0aWNsZSB1c2VkIGZvciB0aGUgVHdp
dHRlciB1cGRhdGUuPC9wPgoKCTxoMz5TeW50YXg8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3
aXR0ZXJfdGlueXVybCAvJmd0OzwvcD4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyX3Rpbnl1
cmwmZ3Q7TGluayB0ZXh0Jmx0Oy90eHA6YXJjX3R3aXR0ZXJfdGlueXVybCZndDs8L3A+CgoJ
PGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4K
CQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhh
bXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5pZDwvdGQ+CgkJCTx0ZD5UZXh0cGF0
dGVybiBhcnRpY2xlIElEPC90ZD4KCQkJPHRkPiA8ZW0+Y3VycmVudCBhcnRpY2xlPC9lbT48
L3RkPgoJCQk8dGQ+aWQ9JnF1b3Q7MSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD50aXRsZTwvdGQ+CgkJCTx0ZD5UaXRsZSBhdHRyaWJ1dGUgb2YgdGhlIGxpbms8L3RkPgoJ
CQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNz
PC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NT
PC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gdGhlIGxpbms8L3Rk
PgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8aDIg
Y2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9jYWNoaW5nIj5DYWNoaW5nPC9oMj4K
Cgk8cD5JbiBvcmRlciB0byBwcmV2ZW50IGV4Y2Vzc2l2ZSByZXBlYXRpdGl2ZSBjYWxscyB0
byB0aGUgVHdpdHRlciB3ZWJzaXRlIGl0IGlzIHJlY29tbWVuZGVkIHRvIGNhY2hlIHJlc3Vs
dHMuIFR3aXR0ZXIgbGltaXRzIHRoZSBudW1iZXIgb2YgY2FsbHMgdGhyb3VnaCB0aGUgPHNw
YW4gY2xhc3M9ImNhcHMiPkFQSTwvc3Bhbj4sIGFuZCBjb250aW51b3VzIGNhbGxzIHdpbGwg
cmVzdWx0IGluIFR3aXR0ZXIgY2xvc2luZyB0byBmdXJ0aGVyIHJlcXVlc3RzLiBCeSBkZWZh
dWx0LCBhcmNfdHdpdHRlciBjYWNoZXMgZm9yIDMwIG1pbnV0ZSBpbnRlcnZhbHMuPC9wPgoK
CTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRp
b248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPmNhY2hpbmc8L3RkPgoJCQk8dGQ+JiM4MjE2OzEmIzgyMTc7IHRv
IGNhY2hlIGZlZWQsICYjODIxNjswJiM4MjE3OyB0byB0dXJuIGNhY2hpbmcgb2ZmIChub3Qg
cmVjb21tZW5kZWQpPC90ZD4KCQkJPHRkPjE8L3RkPgoJCQk8dGQ+Y2FjaGluZz0mcXVvdDsx
JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNhY2hlX2RpcjwvdGQ+CgkJCTx0
ZD5BYnNvbHV0ZSBwYXRoIHRvIHRoZSBjYWNoZSBkaXJlY3RvcnkgKG11c3QgYmUgd3JpdGFi
bGUpPC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0ZXIgcHJlZmVyZW5jZXM8L2VtPjwvdGQ+
CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jYWNoZV90aW1lPC90ZD4KCQkJPHRkPlRpbWUgaW4g
bWludXRlcyB0aGF0IHRoZSBjYWNoZSBmaWxlcyBhcmUgc3RvcmVkIGJlZm9yZSBiZWluZyBy
ZWZyZXNoZWQ8L3RkPgoJCQk8dGQ+NTwvdGQ+CgkJCTx0ZD5jYWNoZV90aW1lPSZxdW90OzMw
JnF1b3Q7PC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8cD5UaGUgYWRtaW4gc2lkZSBvZiB0
aGlzIHBsdWdpbiBlbmZvcmNlcyBjYWNoaW5nLCBhcGFydCBmcm9tIHdoZW4gaXQgaXMgcG9z
dGluZyB0byBUd2l0dGVyICg8aT5lLmcuPC9pPiB3aGVuIHBvc3Rpbmcgb3IgZGVsZXRpbmcg
YW4gdXBkYXRlKS48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJf
cHJlZnMiPlByZWZlcmVuY2VzPC9oMj4KCgk8cD5Zb3UgY2FuIGFjY2VzcyB0aGUgcGx1Z2lu
cyBjb3JlIHByZWZlcmVuY2VzIGZyb20gZWl0aGVyIHRoZSBQcmVmZXJlbmNlcyBvciBQbHVn
aW5zIHRhYnMgaW4gYWRtaW4uIFNldHVwIHlvdXIgVHdpdHRlciBhY2NvdW50ICh5b3Ugd2ls
bCBiZSBhc2tlZCB0byBjb25uZWN0IHZpYSBUd2l0dGVyIGFuZCB0aGlzIG5lZWRzIGRvaW5n
IGJlZm9yZSB5b3UgY2FuIHVzZSB0aGUgcGx1Z2luKSBhbmQgY2hhbmdlIHRoZSBjYWNoZSBk
aXJlY3RvcnkgdXNpbmcgYXJjX3R3aXR0ZXImIzgyMTc7cyBwcmVmZXJlbmNlcy4gV2l0aG91
dCBwcm92aWRpbmcgeW91ciBhY2NvdW50IGxvZ2luIGRldGFpbHMgdGhlIGFkbWluIGFyZWEg
ZmVhdHVyZXMgb2YgdGhpcyBwbHVnaW4gd2lsbCBiZSBpbmFjdGl2ZS48L3A+CgoJPHA+WW91
IGNhbiBzZWxlY3QgdGhlIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+IHNob3J0ZW5l
ciBtZXRob2QgeW91IHdhbnQgdG8gdXNlIHRvIGxpbmsgYmFjayB0byB5b3VyIGFydGljbGUg
b24gVHdpdHRlci4gUGxlYXNlIG5vdGUgdGhhdCBpZiB5b3Ugc2VsZWN0IHNtZF9zaG9ydF91
cmwgeW91IHdpbGwgbmVlZCB0byBoYXZlIGluc3RhbGxlZCBhbmQgYWN0aXZhdGVkIHRoZSA8
YSBocmVmPSJodHRwOi8vdGV4dHBhdHRlcm4ub3JnL3BsdWdpbnMvMTA5OS9zbWRfc2hvcnRf
dXJsIj48c3BhbiBjbGFzcz0idGFnIj5zbWRfc2hvcnRfdXJsPC9zcGFuPiBwbHVnaW48L2E+
IGRldmVsb3BlZCBieSBTdGVmIERhd3Nvbi48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBp
ZD0iYXJjX3R3aXR0ZXJfYXJ0aWNsZSI+VHdlZXRpbmcgYXJ0aWNsZXM8L2gyPgoKCTxwPkJ5
IGRlZmF1bHQgYXJjX3R3aXR0ZXIgd2lsbCBwb3N0IGFuIHVwZGF0ZSB0byBUd2l0dGVyIGlu
Y2x1ZGluZyBhIHNob3J0ZW5lZCA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPiB0byB5
b3VyIGFydGljbGUuIE9ubHkgbGl2ZSBhbmQgYWN0aXZlIGFydGljbGVzIHdpbGwgYmUgc2Vu
dCB0byBUd2l0dGVyLCA8aT5pLmUuPC9pPiBhcnRpY2xlcyBwb3N0ZWQgaW4gdGhlIGZ1dHVy
ZSBvciBhcyBzdGlja3kgYXJ0aWNsZXMgd2lsbCBub3QgYmUgc2VudC4gSWYgeW91ciBhcnRp
Y2xlIGlzIHN1Y2Nlc3NmdWxseSBzdWJtaXR0ZWQgdG8gVHdpdHRlciB0aGUgdXBkYXRlIHdp
bGwgYXBwZWFyIGluIHBsYWNlIG9mIHRoZSBUd2l0dGVyIG9wdGlvbiBvbiB0aGUgcmlnaHQt
aGFuZC1zaWRlIG9mIHRoZSBhcnRpY2xlIGVkaXQgc2NyZWVuLjwvcD4KCgk8cD5Ud2VldHMg
YXJlIHNlbnQgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6IDxlbT5Ud2VldCBwcmVmaXg8L2Vt
PiA8ZW0+QXJ0aWNsZSB0aXRsZTwvZW0+IDxlbT5TaG9ydGVuZWQgPHNwYW4gY2xhc3M9ImNh
cHMiPlVSTDwvc3Bhbj48L2VtPiA8ZW0+VHdlZXQgc3VmZml4PC9lbT4uIFlvdSBjYW4gY2hh
bmdlIHRoZSBwcmVmaXggYW5kIHN1ZmZpeCBvbiBhbiBhcnRpY2xlLWJ5LWFydGljbGUgYmFz
aXMgYnkgY2hhbmdpbmcgdGhlIHR3ZWV0IG9wdGlvbnMgdW5kZXIgJiM4MjE2O1VwZGF0ZSBU
d2l0dGVyJiM4MjE3OyBvbiB0aGUgYXJ0aWNsZSBlZGl0b3Igc2NyZWVuLiBUaGUgZGVmYXVs
dCA8ZW0+VHdlZXQgcHJlZml4PC9lbT4gY2FuIGJlIHNldCB1bmRlciB0aGUgPHNwYW4gY2xh
c3M9InRhZyI+YXJjX3R3aXR0ZXI8L3NwYW4+IHByZWZlcmVuY2VzIHNjcmVlbiAodGhlIGRl
ZmF1bHQgb24gaW5zdGFsbGF0aW9uIGlzICYjODIyMDtKdXN0IHBvc3RlZDomIzgyMjE7KS48
L3A+CgoJPHA+UGxlYXNlIG5vdGUgdGhhdCBvbmNlIGFuIGFydGljbGUgaGFzIGJlZW4gdHdl
ZXRlZCB0aGUgdHdlZXQgY2Fubm90IGJlIGVkaXRlZC48L3A+CgoJPGgyIGNsYXNzPSJzZWN0
aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYWRtaW4iPlRoZSBUd2l0dGVyIHRhYjwvaDI+CgoJPHA+
VW5kZXIgdGhlIEV4dGVuc2lvbnMgdGFiICh0aGlzIGNhbiBiZSBjaGFuZ2VkIGZyb20gdGhl
IHBsdWdpbiYjODIxNztzIHByZWZlcmVuY2UgcGFnZSkgYSBuZXcgVHdpdHRlciB0YWIgc2hv
dWxkIGFwcGVhciBvbmNlIHlvdSBoYXZlIGNvbm5lY3RlZCB5b3VyIHNpdGUgdG8geW91ciBU
d2l0dGVyIGFjY291bnQuIEZyb20gaGVyZSB5b3Ugd2lsbCBiZSBhYmxlIHRvIHN1Ym1pdCBu
ZXcgVHdpdHRlciB1cGRhdGVzLCB2aWV3IGJhc2ljIGFjY291bnQgc3RhdGlzdGljcywgYW5k
IGNoZWNrIG91dCB5b3VyIHJlY2VudCB1cGRhdGVzIChpbmNsdWRpbmcgdGhlIG9wdGlvbiB0
byBkZWxldGUgeW91ciB0d2VldHMpLjwvcD4iO3M6NDoiY29kZSI7czo3NTY4NDoiZ2xvYmFs
ICRwcmVmcywkdHhwY2ZnLCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwkYXJjX3R3aXR0ZXJf
Y29uc3VtZXJTZWNyZXQ7CgokYXJjX3R3aXR0ZXIgPSBhcnJheSgpOwoKJGFyY190d2l0dGVy
X2NvbnN1bWVyS2V5ID0gJ25LY1hzbHd6WmhCZDBrZktNZXRuUEEnOwokYXJjX3R3aXR0ZXJf
Y29uc3VtZXJTZWNyZXQgPSAnQzZuU1BDTDNlZUhHVEJoS0Nnd2Q5b2NsY3VEMHNyQjhXVmtm
WFFZQzU0JzsKCmFkZF9wcml2cygncGx1Z2luX3ByZWZzLmFyY190d2l0dGVyJywnMSwyJyk7
CnJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfdHdpdHRlcl9pbnN0YWxsJywncGx1Z2luX2xpZmVj
eWNsZS5hcmNfdHdpdHRlcicsICdpbnN0YWxsZWQnKTsKcmVnaXN0ZXJfY2FsbGJhY2soJ2Fy
Y190d2l0dGVyX3VuaW5zdGFsbCcsJ3BsdWdpbl9saWZlY3ljbGUuYXJjX3R3aXR0ZXInLCAn
ZGVsZXRlZCcpOwpyZWdpc3Rlcl9jYWxsYmFjaygnYXJjX3R3aXR0ZXJfcHJlZnMnLCdwbHVn
aW5fcHJlZnMuYXJjX3R3aXR0ZXInKTsKCi8qCiAqIFNldHVwIGluaXRpYWwgcHJlZmVyZW5j
ZXMgaWYgbm90IGluIHRoZSB0eHBfcHJlZnMgdGFibGUuCiAqLwppZiAoIWlzc2V0KCRwcmVm
c1snYXJjX3R3aXR0ZXJfdXNlciddKSkKICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl91c2Vy
JywgJycsICdhcmNfdHdpdHRlcicsIDEsICd0ZXh0X2lucHV0Jyk7CmlmICghaXNzZXQoJHBy
ZWZzWydhcmNfdHdpdHRlcl9wcmVmaXgnXSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3By
ZWZpeCcsJ0p1c3QgcG9zdGVkOicsICdhcmNfdHdpdHRlcicsIDIsICd0ZXh0X2lucHV0Jyk7
CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl9zdWZmaXgnXSkpCiAgc2V0X3ByZWYo
J2FyY190d2l0dGVyX3N1ZmZpeCcsJycsICdhcmNfdHdpdHRlcicsIDIsICd0ZXh0X2lucHV0
Jyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXSkpCiAgc2V0
X3ByZWYoJ2FyY190d2l0dGVyX2NhY2hlX2RpcicsJHR4cGNmZ1sndHhwYXRoJ10uJHByZWZz
Wyd0ZW1wZGlyJ10sICdhcmNfdHdpdHRlcicsIDEsICd0ZXh0X2lucHV0Jyk7CmlmICghaXNz
ZXQoJHByZWZzWydhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0J10pKQogIHNldF9wcmVmKCdh
cmNfdHdpdHRlcl90d2VldF9kZWZhdWx0JywgMSwgJ2FyY190d2l0dGVyJywgMiwgJ3llc25v
UmFkaW8nKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX3VybF9tZXRob2QnXSkp
CiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3VybF9tZXRob2QnLCAndGlueXVybCcsICdhcmNf
dHdpdHRlcicsIDIsCiAgICAnYXJjX3R3aXR0ZXJfdXJsX21ldGhvZF9zZWxlY3QnKTsKaWYg
KCFpc3NldCgkcHJlZnNbJ2FyY19zaG9ydF91cmwnXSkpCiAgc2V0X3ByZWYoJ2FyY19zaG9y
dF91cmwnLCAwLCAnYXJjX3R3aXR0ZXInLCAyLCAneWVzbm9SYWRpbycpOwppZiAoIWlzc2V0
KCRwcmVmc1snYXJjX3Nob3J0X3NpdGVfdXJsJ10pKQogIHNldF9wcmVmKCdhcmNfc2hvcnRf
c2l0ZV91cmwnLCAkcHJlZnNbJ3NpdGV1cmwnXSwgJ2FyY190d2l0dGVyJywgMiwgJ3RleHRf
aW5wdXQnKTsKLy8gTWFrZSBzdXJlIHRoYXQgdGhlIFR3aXR0ZXIgdGFiIGhhcyBiZWVuIGRl
ZmluZWQKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddKSkgewogIHNldF9w
cmVmKCdhcmNfdHdpdHRlcl90YWInLCAnZXh0ZW5zaW9ucycsICdhcmNfdHdpdHRlcicsIDIs
CiAgICAnYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCcpOwogICAgJHByZWZzWydhcmNfdHdpdHRl
cl90YWInXSA9ICdleHRlbnNpb25zJzsKfQoKLy8gQ2hlY2sgaWYgYXJjX3Nob3J0X3VybCBp
cyBlbmFibGVkCmlmICgoaXNzZXQoJHByZWZzWydhcmNfc2hvcnRfdXJsJ10pJiYkcHJlZnNb
J2FyY19zaG9ydF91cmwnXSkKfHwgKGlzc2V0KCRwcmVmc1snYXJjX3Nob3J0X3VybF9tZXRo
b2QnXSkmJiRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddPT0nYXJjX3R3aXR0ZXIn
KSkgewogIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfc2hvcnRfdXJsX3JlZGlyZWN0JywgJ3R4
cF9kaWUnLCA0MDQpOwp9CgppZiAoQHR4cGludGVyZmFjZSA9PSAnYWRtaW4nKSB7CiAgICBp
ZiAoIWVtcHR5KCRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddKQogICAgICAgICYmICFlbXB0
eSgkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10pCiAgICAgICAgJiYgIWVtcHR5
KCRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSkgKSB7CgogICAgICAg
IGlmICgkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddKSB7CiAgICAgICAgICAgIGFkZF9wcml2
cygnYXJjX2FkbWluX3R3aXR0ZXInLCAnMSwyLDMsNCcpOwogICAgICAgICAgICByZWdpc3Rl
cl90YWIoJHByZWZzWydhcmNfdHdpdHRlcl90YWInXSwgJ2FyY19hZG1pbl90d2l0dGVyJywg
J1R3aXR0ZXInKTsKICAgICAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hZG1pbl90
d2l0dGVyJywgJ2FyY19hZG1pbl90d2l0dGVyJyk7CiAgICAgICAgfQoKICAgICAgICByZWdp
c3Rlcl9jYWxsYmFjaygnYXJjX2FydGljbGVfdHdlZXQnLCAncGluZycpOwogICAgICAgIHJl
Z2lzdGVyX2NhbGxiYWNrKCdhcmNfYXJ0aWNsZV90d2VldCcsICdhcnRpY2xlJywgJ2VkaXQn
LCAxKTsKICAgICAgICByZWdpc3Rlcl9jYWxsYmFjaygnYXJjX2FwcGVuZF90d2l0dGVyJywg
J2FydGljbGVfdWknLCAnc3RhdHVzJyk7CiAgICB9Cn0KCi8qCiAgICBQdWJsaWMtc2lkZSBm
dW5jdGlvbnMKICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0KKi8KCmZ1bmN0aW9uIGFyY190d2l0dGVyKCRhdHRz
KQp7CiAgZ2xvYmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdp
dHRlcl9jb25zdW1lclNlY3JldDsKCiAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICd1c2Vy
JyAgICAgID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLAogICAgJ3Bhc3N3b3JkJyAg
PT4gJycsCiAgICAndGltZWxpbmUnICA9PiAndXNlcicsCiAgICAnbGltaXQnICAgICA9PiAn
MTAnLAogICAgJ3JldHdlZXRzJyAgPT4gZmFsc2UsCiAgICAnZGF0ZWZvcm1hdCc9PiAkcHJl
ZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCddLAogICAgJ2NhY2hpbmcnICAgPT4gJzEnLAogICAg
J2NhY2hlX2RpcicgPT4gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXSwKICAgICdj
YWNoZV90aW1lJz0+ICc1JywKICAgICdsYWJlbCcgICAgID0+ICcnLAogICAgJ2xhYmVsdGFn
JyAgPT4gJycsCiAgICAnYnJlYWsnICAgICA9PiAnbGknLAogICAgJ3dyYXB0YWcnICAgPT4g
JycsCiAgICAnY2xhc3MnICAgICA9PiBfX0ZVTkNUSU9OX18sCiAgICAnY2xhc3NfcG9zdGVk
JyA9PiBfX0ZVTkNUSU9OX18uJy1wb3N0ZWQnCiAgICApLCRhdHRzKSk7CgogICR0d2l0ID0g
bmV3IGFyY19Ud2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVy
X2NvbnN1bWVyU2VjcmV0KTsKCiAgaWYgKCRjYWNoaW5nKSB7ICAvLyB0dXJuIG9uIGNhY2hp
bmcsIHJlY29tbWVuZGVkIChkZWZhdWx0KQogICAgJHR3aXQtPnNldENhY2hpbmcodHJ1ZSk7
CiAgICAkdHdpdC0+Y2FjaGVEaXIoJGNhY2hlX2Rpcik7CiAgICAkdHdpdC0+Y2FjaGVUaW1l
KCRjYWNoZV90aW1lKTsKICB9IGVsc2UgeyAgLy8gdHVybiBvZmYgY2FjaGluZywgbm90IHJl
Y29tbWVuZGVkIG90aGVyIHRoYW4gZm9yIHRlc3RpbmcKICAgICR0d2l0LT5zZXRDYWNoaW5n
KGZhbHNlKTsKICB9CgogIHN3aXRjaCAoJHRpbWVsaW5lKSB7CiAgICBjYXNlICdob21lJzog
Y2FzZSAnZnJpZW5kcyc6CiAgICAgICR0aW1lbGluZSA9ICdzdGF0dXNlcy9mcmllbmRzX3Rp
bWVsaW5lJzsgYnJlYWs7CiAgICBjYXNlICdtZW50aW9ucyc6CiAgICAgICR0aW1lbGluZSA9
ICdzdGF0dXNlcy9tZW50aW9ucyc7IGJyZWFrOwogICAgY2FzZSAndXNlcic6IGRlZmF1bHQ6
ICR0aW1lbGluZSA9ICdzdGF0dXNlcy91c2VyX3RpbWVsaW5lJzsKICB9CgogICRvdXQgPSBh
cnJheSgpOwogICR4bWwgPSAkdHdpdC0+Z2V0KCR0aW1lbGluZQogICAgLCBhcnJheSgnc2Ny
ZWVuX25hbWUnPT4kdXNlciwnY291bnQnPT4kbGltaXQsJ2luY2x1ZGVfcnRzJz0+JHJldHdl
ZXRzKSk7CiAgaWYgKCR4bWwpIHsKICAgICR0d2VldHMgPSBAJHhtbC0+eHBhdGgoJy9zdGF0
dXNlcy9zdGF0dXMnKTsKICAgIGlmICgkdHdlZXRzKSBmb3JlYWNoICgkdHdlZXRzIGFzICR0
d2VldCkgewogICAgICAkdGltZSA9IHN0cnRvdGltZShodG1sZW50aXRpZXMoJHR3ZWV0LT5j
cmVhdGVkX2F0KSk7CiAgICAgICRkYXRlID0gc2FmZV9zdHJmdGltZSgkZGF0ZWZvcm1hdCwk
dGltZSk7CiAgICAgICRvdXRbXSA9IGFyY19Ud2l0dGVyOjptYWtlTGlua3MoaHRtbGVudGl0
aWVzKCR0d2VldC0+dGV4dCwgRU5UX1FVT1RFUywnVVRGLTgnKSkKICAgICAgICAuJyAnLnRh
ZyhodG1sZW50aXRpZXMoJGRhdGUpLCdzcGFuJywnIGNsYXNzPSInLiRjbGFzc19wb3N0ZWQu
JyInKTsKICAgIH0KCiAgICByZXR1cm4gZG9MYWJlbCgkbGFiZWwsICRsYWJlbHRhZykuZG9X
cmFwKCRvdXQsICR3cmFwdGFnLCAkYnJlYWssICRjbGFzcyk7CiAgfQoKfQoKZnVuY3Rpb24g
YXJjX3R3aXR0ZXJfc2VhcmNoKCRhdHRzKQp7CiAgICBnbG9iYWwgJHByZWZzLCRhcmNfdHdp
dHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgIGV4
dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICAgJ3VzZXInICAgICAgPT4gJHByZWZzWydhcmNf
dHdpdHRlcl91c2VyJ10sCiAgICAgICAgJ3NlYXJjaCcgICAgPT4gJycsCiAgICAgICAgJ2hh
c2h0YWdzJyAgPT4gJycsCiAgICAgICAgJ3VzZXInICAgICAgPT4gJycsCiAgICAgICAgJ3Jl
cGx5JyAgICAgPT4gJycsCiAgICAgICAgJ21lbnRpb24nICAgPT4gJycsCiAgICAgICAgJ2xp
bWl0JyAgICAgPT4gJzEwJywKICAgICAgICAnbGFuZycgICAgICA9PiAnJywKICAgICAgICAn
ZGF0ZWZvcm1hdCc9PiAkcHJlZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCddLAogICAgICAgICdj
YWNoaW5nJyAgID0+ICcxJywKICAgICAgICAnY2FjaGVfZGlyJyA9PiAkcHJlZnNbJ2FyY190
d2l0dGVyX2NhY2hlX2RpciddLAogICAgICAgICdjYWNoZV90aW1lJz0+ICc1JywKICAgICAg
ICAnbGFiZWwnICAgICA9PiAnJywKICAgICAgICAnbGFiZWx0YWcnICA9PiAnJywKICAgICAg
ICAnYnJlYWsnICAgICA9PiAnbGknLAogICAgICAgICd3cmFwdGFnJyAgID0+ICcnLAogICAg
ICAgICdjbGFzcycgICAgID0+IF9fRlVOQ1RJT05fXywKICAgICAgICAnY2xhc3NfcG9zdGVk
JyA9PiBfX0ZVTkNUSU9OX18uJy1wb3N0ZWQnLAogICAgICAgICdjbGFzc191c2VyJyAgID0+
IF9fRlVOQ1RJT05fXy4nLXVzZXInCiAgICApLCRhdHRzKSk7CgogICAgICAgICR0d2l0ID0g
bmV3IGFyY19Ud2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAs
ICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCk7CgogICAgICAgIGlmICgkY2FjaGluZykg
eyAgLy8gdHVybiBvbiBjYWNoaW5nLCByZWNvbW1lbmRlZCAoZGVmYXVsdCkKICAgICAgICAg
ICAgJHR3aXQtPnNldENhY2hpbmcodHJ1ZSk7CiAgICAgICAgICAgICR0d2l0LT5jYWNoZURp
cigkY2FjaGVfZGlyKTsKICAgICAgICAgICAgJHR3aXQtPmNhY2hlVGltZSgkY2FjaGVfdGlt
ZSk7CiAgICAgICAgfSBlbHNlIHsgIC8vIHR1cm4gb2ZmIGNhY2hpbmcsIG5vdCByZWNvbW1l
bmRlZCBvdGhlciB0aGFuIGZvciB0ZXN0aW5nCiAgICAgICAgICAgICR0d2l0LT5zZXRDYWNo
aW5nKGZhbHNlKTsKICAgICAgICB9CgogICAgICAgIC8vIGNvbnN0cnVjdCBzZWFyY2ggcXVl
cnkKICAgICAgICBpZiAoIWVtcHR5KCRzZWFyY2gpKSB7CiAgICAgICAgICAgICR0ZXJtcyA9
IGV4cGxvZGUoJywnLCRzZWFyY2gpOyAkdGVybXMgPSBhcnJheV9tYXAoJ3RyaW0nLCR0ZXJt
cyk7CiAgICAgICAgICAgICRzZWFyY2ggPSBpbXBsb2RlKCcgJywkdGVybXMpOwogICAgICAg
IH0KICAgICAgICBpZiAoJGhhc2h0YWdzKSB7CiAgICAgICAgICAgICRoYXNoZXMgPSBleHBs
b2RlKCcsJywkaGFzaHRhZ3MpOyAkaGFzaGVzID0gYXJyYXlfbWFwKCd0cmltJywkaGFzaGVz
KTsKICAgICAgICAgICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/JyAnOicnKS4nIycuaW1wbG9k
ZSgnICMnLCRoYXNoZXMpOwogICAgICAgIH0KICAgICAgICBpZiAoJHJlcGx5KSB7CiAgICAg
ICAgICAgICRzZWFyY2guPSAoKCRzZWFyY2gpPycgJzonJykuJ3RvOicudHJpbSgkcmVwbHkp
OwogICAgICAgIH0KICAgICAgICBpZiAoJHVzZXIpIHsKICAgICAgICAgICAgJHNlYXJjaC49
ICgoJHNlYXJjaCk/JyAnOicnKS4nZnJvbTonLnRyaW0oJHVzZXIpOwogICAgICAgIH0KICAg
ICAgICBpZiAoJG1lbnRpb24pIHsKICAgICAgICAgICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/
JyAnOicnKS4nQCcudHJpbSgkbWVudGlvbik7CiAgICAgICAgfQoKICAgICAgICBpZiAoZW1w
dHkoJHNlYXJjaCkpIHsKICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0gZWxzZSB7
CiAgICAgICAgICAgICRzZWFyY2ggPSB1cmxlbmNvZGUoJHNlYXJjaCk7CiAgICAgICAgfQoK
ICAgICAgICAkb3V0ID0gYXJyYXkoKTsKICAgICAgICAkdHdlZXRzID0gJHR3aXQtPmdldCgn
aHR0cDovL3NlYXJjaC50d2l0dGVyLmNvbS9zZWFyY2guYXRvbT9xPScuJHNlYXJjaAogICAg
ICAgICAgICAsIGFycmF5KCdycHAnPT4kbGltaXQsJ2xhbmcnPT4kbGFuZykpOwoKICAgICAg
ICBpZiAoJHR3ZWV0cykgeyBmb3JlYWNoICgkdHdlZXRzLT5lbnRyeSBhcyAkdHdlZXQpIHsK
ICAgICAgICAgICAgcHJlZ19tYXRjaCgiLyguKikgXCgoLiopXCkvIiwkdHdlZXQtPmF1dGhv
ci0+bmFtZSwkbWF0Y2hlcyk7CiAgICAgICAgICAgIGxpc3QoJGF1dGhvciwkdW5hbWUsJG5h
bWUpID0gJG1hdGNoZXM7CiAgICAgICAgICAgICR0aW1lID0gc3RydG90aW1lKGh0bWxlbnRp
dGllcygkdHdlZXQtPnB1Ymxpc2hlZCkpOwogICAgICAgICAgICAkZGF0ZSA9IHNhZmVfc3Ry
ZnRpbWUoJGRhdGVmb3JtYXQsJHRpbWUpOwogICAgICAgICAgICAkdGV4dCA9ICR0d2VldC0+
dGl0bGU7CiAgICAgICAgICAgICRvdXRbXSA9IHRhZyhocmVmKGh0bWxlbnRpdGllcygkdW5h
bWUpLCR0d2VldC0+YXV0aG9yLT51cmksCiAgICAgICAgICAgICAgICAnIHRpdGxlPSInLmh0
bWxlbnRpdGllcygkbmFtZSkuJyInKS4nOiAnLCdzcGFuJwogICAgICAgICAgICAgICAgICAg
ICwnIGNsYXNzPSInLiRjbGFzc191c2VyLiciJykKICAgICAgICAgICAgICAgIC5hcmNfVHdp
dHRlcjo6bWFrZUxpbmtzKGh0bWxlbnRpdGllcygkdGV4dCwgRU5UX1FVT1RFUywnVVRGLTgn
KSkKICAgICAgICAgICAgICAgIC4nICcudGFnKGh0bWxlbnRpdGllcygkZGF0ZSksJ3NwYW4n
CiAgICAgICAgICAgICAgICAgICAgLCcgY2xhc3M9IicuJGNsYXNzX3Bvc3RlZC4nIicpOwog
ICAgICAgIH0gcmV0dXJuIGRvTGFiZWwoJGxhYmVsLCAkbGFiZWx0YWcpCiAgICAgICAgICAg
IC5kb1dyYXAoJG91dCwgJHdyYXB0YWcsICRicmVhaywgJGNsYXNzKTsgfQoKfQoKZnVuY3Rp
b24gYXJjX3R3aXR0ZXJfdHdlZXQoJGF0dHMpIHsKICAgIGdsb2JhbCAkdGhpc2FydGljbGU7
CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgJ2lkJyAgICAgICAgPT4gJHRoaXNh
cnRpY2xlWyd0aGlzaWQnXSwKICAgICAgJ2luY2x1ZGVfdXJsJyAgID0+IHRydWUKICAgICks
JGF0dHMpKTsKCiAgICBpZiAoJGlkKSB7CiAgICAgIC8vIEZldGNoIGFyY190d2l0dGVyIHN0
dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAgICAgJHR3ZWV0ID0gKCRpbmNsdWRlX3VybCkg
PyBzYWZlX3JvdygidHdlZXQiLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlkfSIp
CiAgICAgICAgOiBzYWZlX3JvdygiUkVQTEFDRSh0d2VldCxDT05DQVQoJyAnLHRpbnl1cmwp
LCcnKSBBUyB0d2VldCIKICAgICAgICAgICwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9
eyRpZH0iKTsKICAgIH0KCiAgICBpZiAoJHR3ZWV0Wyd0d2VldCddKSB7CiAgICAgIHJldHVy
biBhcmNfVHdpdHRlcjo6bWFrZUxpbmtzKAogICAgICAgIGh0bWxlbnRpdGllcygkdHdlZXRb
J3R3ZWV0J10sIEVOVF9RVU9URVMsJ1VURi04JykpOwogICAgfQp9CgpmdW5jdGlvbiBhcmNf
dHdpdHRlcl90d2VldF91cmwoJGF0dHMsICR0aGluZz1udWxsKSB7CiAgICBnbG9iYWwgJHRo
aXNhcnRpY2xlLCRwcmVmczsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAnaWQn
ICAgICAgPT4gJHRoaXNhcnRpY2xlWyd0aGlzaWQnXSwKICAgICAgJ3RpdGxlJyAgID0+ICcn
LAogICAgICAnY2xhc3MnICAgPT4gJycKICAgICksJGF0dHMpKTsKCiAgICBpZiAoJGlkKSB7
CiAgICAgIC8vIEZldGNoIGFyY190d2l0dGVyIHN0dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20K
ICAgICAgJHR3ZWV0ID0gc2FmZV9yb3coInR3ZWV0X2lkIgogICAgICAgICwgJ2FyY190d2l0
dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKTsKICAgIH0KCiAgICBpZiAoJHR3ZWV0Wyd0d2Vl
dF9pZCddKSB7CiAgICAgICR1cmwgPSAiaHR0cDovL3R3aXR0ZXIuY29tLyIuJHByZWZzWydh
cmNfdHdpdHRlcl91c2VyJ10uIi9zdGF0dXMvIi4kdHdlZXRbJ3R3ZWV0X2lkJ107CiAgICAg
IGlmICgkdGhpbmc9PT1udWxsKSB7CiAgICAgICAgcmV0dXJuICR1cmw7CiAgICAgIH0KICAg
ICAgcmV0dXJuIGhyZWYocGFyc2UoJHRoaW5nKSwgJHVybCwKICAgICAgICAoJHRpdGxlID8g
JyB0aXRsZT0iJy4kdGl0bGUuJyInIDogJycpCiAgICAgICAgLigkY2xhc3MgPyAnIGNsYXNz
PSInLiRjbGFzcy4nIicgOiAnJykpOwogICAgfQp9CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl90
aW55dXJsKCRhdHRzLCAkdGhpbmc9bnVsbCkgewogICAgZ2xvYmFsICR0aGlzYXJ0aWNsZTsK
CiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAnaWQnICAgICAgPT4gJHRoaXNhcnRp
Y2xlWyd0aGlzaWQnXSwKICAgICAgJ3RpdGxlJyAgID0+ICcnLAogICAgICAnY2xhc3MnICAg
PT4gJycKICAgICksJGF0dHMpKTsKCiAgICBpZiAoJGlkKSB7CiAgICAgIC8vIEZldGNoIGFy
Y190d2l0dGVyIHN0dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAgICAgJHR3ZWV0ID0gc2Fm
ZV9yb3coInRpbnl1cmwiCiAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17
JGlkfSIpOwogICAgfQoKICAgIGlmICgkdHdlZXRbJ3Rpbnl1cmwnXSkgewogICAgICBpZiAo
JHRoaW5nPT09bnVsbCkgewogICAgICAgIHJldHVybiAkdHdlZXRbJ3Rpbnl1cmwnXTsKICAg
ICAgfQoKICAgICAgcmV0dXJuIGhyZWYocGFyc2UoJHRoaW5nKSwgJHR3ZWV0Wyd0aW55dXJs
J10sCiAgICAgICAgKCR0aXRsZSA/ICcgdGl0bGU9IicuJHRpdGxlLiciJyA6ICcnKQogICAg
ICAgIC4oJGNsYXNzID8gJyBjbGFzcz0iJy4kY2xhc3MuJyInIDogJycpKTsKICAgIH0KfQoK
LyoKICogUHVibGljIHRhZyBmb3Igb3V0cHV0dGluZyB3aWRnZXQgSlMKICovCmZ1bmN0aW9u
IGFyY190d2l0dGVyX3dpZGdldF9qcygkYXR0cykKewogIGV4dHJhY3QobEF0dHMoYXJyYXko
CiAgICAgICAgJ29wdGltaXNlJyA9PiBmYWxzZQogICAgKSwkYXR0cykpOwoKICByZXR1cm4g
X2FyY190d2l0dGVyX3dpZGdldF9qcygkb3B0aW1pc2UpOwp9CgpmdW5jdGlvbiBfYXJjX3R3
aXR0ZXJfd2lkZ2V0X2pzKCRvcHRpbWlzZT10cnVlKQp7CiAgZ2xvYmFsICRhcmNfdHdpdHRl
cjsKCiAgLy8gQ2hlY2sgaWYgd2lkZ2V0IEpTIGhhcyBhbHJlYWR5IGJlZW4gb3V0cHV0CiAg
aWYgKCRhcmNfdHdpdHRlclsnd2lkZ2V0X2pzJ10pIHJldHVybjsKCiAgaWYgKCRvcHRpbWlz
ZT09ZmFsc2UpIHsKICAgIHJldHVybiAnPHNjcmlwdCBzcmM9Imh0dHA6Ly9wbGF0Zm9ybS50
d2l0dGVyLmNvbS93aWRnZXRzLmpzIiB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPjwvc2NyaXB0
Pic7CiAgfQoKICAkanMgPSA8PDxKUwo8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+
CihmdW5jdGlvbigpIHsKICBpZiAod2luZG93Ll9fdHdpdHRlckludGVudEhhbmRsZXIpIHJl
dHVybjsKICB2YXIgaW50ZW50UmVnZXggPSAvdHdpdHRlclwuY29tKFw6XGR7Miw0fSk/XC9p
bnRlbnRcLyhcdyspLywKICAgICAgd2luZG93T3B0aW9ucyA9ICdzY3JvbGxiYXJzPXllcyxy
ZXNpemFibGU9eWVzLHRvb2xiYXI9bm8sbG9jYXRpb249eWVzJywKICAgICAgd2lkdGggPSA1
NTAsCiAgICAgIGhlaWdodCA9IDQyMCwKICAgICAgd2luSGVpZ2h0ID0gc2NyZWVuLmhlaWdo
dCwKICAgICAgd2luV2lkdGggPSBzY3JlZW4ud2lkdGg7CgogIGZ1bmN0aW9uIGhhbmRsZUlu
dGVudChlKSB7CiAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7CiAgICB2YXIgdGFyZ2V0ID0g
ZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50LAogICAgICAgIG0sIGxlZnQsIHRvcDsKCiAgICB3
aGlsZSAodGFyZ2V0ICYmIHRhcmdldC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpICE9PSAnYScp
IHsKICAgICAgdGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGU7CiAgICB9CgogICAgaWYgKHRh
cmdldCAmJiB0YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2EnICYmIHRhcmdl
dC5ocmVmKSB7CiAgICAgIG0gPSB0YXJnZXQuaHJlZi5tYXRjaChpbnRlbnRSZWdleCk7CiAg
ICAgIGlmIChtKSB7CiAgICAgICAgbGVmdCA9IE1hdGgucm91bmQoKHdpbldpZHRoIC8gMikg
LSAod2lkdGggLyAyKSk7CiAgICAgICAgdG9wID0gMDsKCiAgICAgICAgaWYgKHdpbkhlaWdo
dCA+IGhlaWdodCkgewogICAgICAgICAgdG9wID0gTWF0aC5yb3VuZCgod2luSGVpZ2h0IC8g
MikgLSAoaGVpZ2h0IC8gMikpOwogICAgICAgIH0KCiAgICAgICAgd2luZG93Lm9wZW4odGFy
Z2V0LmhyZWYsICdpbnRlbnQnLCB3aW5kb3dPcHRpb25zICsgJyx3aWR0aD0nICsgd2lkdGgg
KwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyxoZWlnaHQ9
JyArIGhlaWdodCArICcsbGVmdD0nICsgbGVmdCArICcsdG9wPScgKyB0b3ApOwogICAgICAg
IGUucmV0dXJuVmFsdWUgPSBmYWxzZTsKICAgICAgICBlLnByZXZlbnREZWZhdWx0ICYmIGUu
cHJldmVudERlZmF1bHQoKTsKICAgICAgfQogICAgfQogIH0KCiAgaWYgKGRvY3VtZW50LmFk
ZEV2ZW50TGlzdGVuZXIpIHsKICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNr
JywgaGFuZGxlSW50ZW50LCBmYWxzZSk7CiAgfSBlbHNlIGlmIChkb2N1bWVudC5hdHRhY2hF
dmVudCkgewogICAgZG9jdW1lbnQuYXR0YWNoRXZlbnQoJ29uY2xpY2snLCBoYW5kbGVJbnRl
bnQpOwogIH0KICB3aW5kb3cuX190d2l0dGVySW50ZW50SGFuZGxlciA9IHRydWU7Cn0oKSk7
Cjwvc2NyaXB0PgpKUzsKICAkYXJjX3R3aXR0ZXJbJ3dpZGdldF9qcyddID0gdHJ1ZTsKICBy
ZXR1cm4gJGpzOwp9CgovLyBEZXByZWNhdGVkIGFyY190d2l0dGVyX3JldHdlZXQgdGFnLCB1
c2UgYXJjX3R3aXR0ZXJfdHdlZXRfYnV0dG9uIGluc3RlYWQKZnVuY3Rpb24gYXJjX3R3aXR0
ZXJfcmV0d2VldCgkYXR0cywgJHRoaW5nPW51bGwpCnsKICByZXR1cm4gYXJjX3R3aXR0ZXJf
dHdlZXRfYnV0dG9uKCRhdHRzLCAkdGhpbmc9bnVsbCk7Cn0KZnVuY3Rpb24gYXJjX3R3aXR0
ZXJfdHdlZXRfYnV0dG9uKCRhdHRzLCAkdGhpbmc9bnVsbCkKewogICAgZ2xvYmFsICRwcmVm
cywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3Jl
dDsKICAgIGdsb2JhbCAkdGhpc2FydGljbGU7CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgK
ICAgICAgICAndXNlcicgICAgICAgID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLCAv
LyB2aWEgdXNlciBhY2NvdW50CiAgICAgICAgJ3VybCcgICAgICAgICA9PiAnJywKICAgICAg
ICAndGV4dCcgICAgICAgID0+ICcnLAogICAgICAgICdmb2xsb3cxJyAgICAgPT4gJycsCiAg
ICAgICAgJ2ZvbGxvdzInICAgICA9PiAnJywKICAgICAgICAnbGFuZycgICAgICAgID0+ICcn
LAogICAgICAgICdjb3VudCcgICAgICAgPT4gJ2hvcml6b250YWwnLAogICAgICAgICdpbmNs
dWRlX2pzJyAgPT4gdHJ1ZSwKICAgICAgICAnb3B0aW1pc2VfanMnID0+IGZhbHNlLAogICAg
ICAgICd3cmFwdGFnJyAgICAgPT4gJycsCiAgICAgICAgJ2NsYXNzJyAgICAgICA9PiAndHdp
dHRlci1zaGFyZS1idXR0b24nCiAgICApLCRhdHRzKSk7CgogICAgJHEgPSAnJzsgLy8gcXVl
cnkgc3RyaW5nCgogICAgaWYgKCRpZD0kdGhpc2FydGljbGVbJ3RoaXNpZCddKSB7CiAgICAg
IC8vIEZldGNoIGFyY190d2l0dGVyIHN0dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAgICAg
JHJvdyA9IHNhZmVfcm93KCJSRVBMQUNFKHR3ZWV0LENPTkNBVCgnICcsdGlueXVybCksJycp
IEFTIHR3ZWV0LHRpbnl1cmwiCiAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9p
ZD17JGlkfSIpOwoKICAgICAgaWYgKCR1cmw9PScnKSB7CiAgICAgICAgJHVybCA9ICgkdXJs
KSA/ICR1cmwgOiBwZXJtbGlua3VybCgkdGhpc2FydGljbGUpOwogICAgICAgICRxID0gJ3Vy
bD0nLnVybGVuY29kZSgkdXJsKTsKICAgICAgfQogICAgICBpZiAoJHRleHQ9PScnKSB7CiAg
ICAgICAgJHRleHQgPSAoJHJvd1sndHdlZXQnXSkgPyAkcm93Wyd0d2VldCddIDogJHRoaXNh
cnRpY2xlWyd0aXRsZSddOwogICAgICB9CiAgICAgICRxIC49ICgkcSA/ICcmYW1wOycgOiAn
JykuJ3RleHQ9Jy51cmxlbmNvZGUoJHRleHQpOwogICAgfQogICAgaWYgKCR1c2VyKSB7CiAg
ICAgICRxIC49ICgkcSA/ICcmYW1wOycgOiAnJykuJ3ZpYT0nLnVybGVuY29kZSgkdXNlcik7
CiAgICB9CiAgICBpZiAoJGZvbGxvdzEmJiRmb2xsb3cyKSB7CiAgICAgICRxIC49ICgkcSA/
ICcmYW1wOycgOiAnJykuJ3JlbGF0ZWQ9Jy51cmxlbmNvZGUoJGZvbGxvdzEuJzonLiRmb2xs
b3cyKTsKICAgIH0gZWxzZWlmICgkZm9sbG93MXx8JGZvbGxvdzIpIHsKICAgICAgJHEgLj0g
KCRxID8gJyZhbXA7JyA6ICcnKS4ncmVsYXRlZD0nLnVybGVuY29kZSgkZm9sbG93MS4kZm9s
bG93Mik7CiAgICB9CgogICAgc3dpdGNoICgkbGFuZykgewogICAgICBjYXNlICdmcic6IGJy
ZWFrOyBjYXNlICdkZSc6IGJyZWFrOyBjYXNlICdlcyc6IGJyZWFrOyBjYXNlICdqcCc6IGJy
ZWFrOwogICAgICBkZWZhdWx0OgogICAgICAgICRsYW5nID0gJ2VuJzsKICAgIH0KICAgICRx
IC49ICgkcSA/ICcmYW1wOycgOiAnJykuJ2xhbmc9Jy51cmxlbmNvZGUoJGxhbmcpOwoKICAg
IHN3aXRjaCAoJGNvdW50KSB7CiAgICAgIGNhc2UgJ25vbmUnOiBicmVhazsgY2FzZSAndmVy
dGljYWwnOiBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICAkY291bnQgPSAnaG9yaXpv
bnRhbCc7CiAgICB9CiAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidjb3VudD0nLnVy
bGVuY29kZSgkY291bnQpOwoKICAgICR0aGluZyA9ICgkdGhpbmc9PT1udWxsKSA/ICdUd2Vl
dCcgOiBwYXJzZSgkdGhpbmcpOwoKICAgICRodG1sID0gaHJlZigkdGhpbmcsJ2h0dHA6Ly90
d2l0dGVyLmNvbS9zaGFyZT8nLiRxCiAgICAgICwgJyBjbGFzcz0iJy4kY2xhc3MuJyInKTsK
CiAgICAkanMgPSAoJGluY2x1ZGVfanMpID8gX2FyY190d2l0dGVyX3dpZGdldF9qcygkb3B0
aW1pc2VfanM/dHJ1ZTpmYWxzZSkgOiAnJzsKCiAgICByZXR1cm4gJGpzLiRodG1sOwp9Cgov
KgogKiBUd2l0dGVyIEZvbGxvdyBidXR0b24KICovCmZ1bmN0aW9uIGFyY190d2l0dGVyX2Zv
bGxvd19idXR0b24oJGF0dHMsICR0aGluZz1udWxsKQp7CiAgICBnbG9iYWwgJHByZWZzLCRh
cmNfdHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0Owog
ICAgZ2xvYmFsICR0aGlzYXJ0aWNsZTsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAg
ICAgICd1c2VyJyAgICAgICAgPT4gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sIC8vIHZp
YSB1c2VyIGFjY291bnQKICAgICAgICAnbGFuZycgICAgICAgID0+ICcnLAogICAgICAgICdj
b3VudCcgICAgICAgPT4gdHJ1ZSwKICAgICAgICAnaW5jbHVkZV9qcycgID0+IHRydWUsCiAg
ICAgICAgJ29wdGltaXNlX2pzJyA9PiBmYWxzZSwKICAgICAgICAnY2xhc3MnICAgICAgID0+
ICd0d2l0dGVyLWZvbGxvdy1idXR0b24nCiAgICApLCRhdHRzKSk7CgogICAgJGF0dHMgPSAn
JzsgLy8gZGF0YSBhdHRyaWJ1dGVzCgogICAgc3dpdGNoICgkbGFuZykgewogICAgICBjYXNl
ICdmcic6IGJyZWFrOyBjYXNlICdkZSc6IGJyZWFrOyBjYXNlICdlcyc6IGJyZWFrOyBjYXNl
ICdqcCc6IGJyZWFrOwogICAgICBkZWZhdWx0OgogICAgICAgICRsYW5nID0gJ2VuJzsKICAg
IH0KICAgICRhdHRzIC49ICcgZGF0YS1sYW5nPSInLnVybGVuY29kZSgkbGFuZykuJyInOwoK
ICAgICRhdHRzIC49ICcgZGF0YS1zaG93LWNvdW50PSInLigkY291bnQ/J3RydWUnOidmYWxz
ZScpLiciJzsKCiAgICAkdGhpbmcgPSAoJHRoaW5nPT09bnVsbCkgPyAnRm9sbG93IEAnLiR1
c2VyIDogcGFyc2UoJHRoaW5nKTsKCiAgICAkaHRtbCA9IGhyZWYoJHRoaW5nLCdodHRwOi8v
dHdpdHRlci5jb20vJy51cmxlbmNvZGUoJHVzZXIpCiAgICAgICwgJyBjbGFzcz0iJy4kY2xh
c3MuJyInLiRhdHRzKTsKCiAgICAkanMgPSAoJGluY2x1ZGVfanMpID8gX2FyY190d2l0dGVy
X3dpZGdldF9qcygkb3B0aW1pc2VfanM/dHJ1ZTpmYWxzZSkgOiAnJzsKCiAgICByZXR1cm4g
JGpzLiRodG1sOwp9CgovKgogICAgQWRtaW4tc2lkZSBmdW5jdGlvbnMKICAgID09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT0KKi8KCi8vIEluc3RhbGxhdGlvbiBmdW5jdGlvbiAtIGJ1aWxkcyBNeVNRTCB0YWJsZQpm
dW5jdGlvbiBhcmNfdHdpdHRlcl9pbnN0YWxsKCkKewoKICAgIC8vIEZvciBmaXJzdCBpbnN0
YWxsLCBjcmVhdGUgdGFibGUgZm9yIHR3ZWV0cwogICAgJHNxbCA9ICJDUkVBVEUgVEFCTEUg
SUYgTk9UIEVYSVNUUyAiLlBGWC4iYXJjX3R3aXR0ZXIgIjsKICAgICRzcWwuPSAiKGFyY190
d2l0dGVyaWQgSU5URUdFUiBBVVRPX0lOQ1JFTUVOVCBQUklNQVJZIEtFWSwKICAgICAgICBh
cnRpY2xlX2lkIElOVEVHRVIoMTEpLAogICAgICAgIHR3ZWV0X2lkIEJJR0lOVCgyMCksCiAg
ICAgICAgdHdlZXQgVkFSQ0hBUigxNDApLAogICAgICAgIHRpbnl1cmwgVkFSQ0hBUigzMCkp
OyI7CgogICAgaWYgKCFzYWZlX3F1ZXJ5KCRzcWwpKSB7CiAgICAgICAgcmV0dXJuICdFcnJv
ciAtIHVuYWJsZSB0byBjcmVhdGUgYXJjX3R3aXR0ZXIgdGFibGUnOwogICAgfQoKfQoKLy8g
VW5pbnN0YWxsIGZ1bmN0aW9uIC0gZGVsZXRlcyBNeVNRTCB0YWJsZSBhbmQgcmVsYXRlZCBw
cmVmZXJlbmNlcwpmdW5jdGlvbiBhcmNfdHdpdHRlcl91bmluc3RhbGwoKQp7CgogICAgJHNx
bCA9ICJEUk9QIFRBQkxFIElGIEVYSVNUUyAiLlBGWC4iYXJjX3R3aXR0ZXI7IjsKICAgIGlm
ICghc2FmZV9xdWVyeSgkc3FsKSkgewogICAgICAgIHJldHVybiAnRXJyb3IgLSB1bmFibGUg
dG8gZGVsZXRlIGFyY190d2l0dGVyIHRhYmxlJzsKICAgIH0KCiAgICAkc3FsID0gIkRFTEVU
RSBGUk9NICAiLlBGWC4idHhwX3ByZWZzIFdIRVJFIGV2ZW50PSdhcmNfdHdpdHRlcic7IjsK
ICAgIGlmICghc2FmZV9xdWVyeSgkc3FsKSkgewogICAgICAgIHJldHVybiAnRXJyb3IgLSB1
bmFibGUgdG8gZGVsZXRlIGFyY190d2l0dGVyIHByZWZlcmVuY2VzJzsKICAgIH0KCn0KZnVu
Y3Rpb24gYXJjX3R3aXR0ZXJfdXJsX21ldGhvZF9zZWxlY3QoJG5hbWUsICR2YWwpCnsKICAg
ICRtZXRob2RzID0gYXJyYXkoJ3Rpbnl1cmwnID0+ICdUaW55dXJsJywKICAgICAgJ2lzZ2Qn
ID0+ICdJcy5nZCcsCiAgICAgICdhcmNfdHdpdHRlcicgPT4gJ1RYUCBUd2VldCcsCiAgICAg
ICdzbWQnID0+ICdzbWRfc2hvcnRfdXJsJyk7CiAgICByZXR1cm4gc2VsZWN0SW5wdXQoJG5h
bWUsICRtZXRob2RzLCAkdmFsKTsKfQpmdW5jdGlvbiBhcmNfdHdpdHRlcl90YWJfc2VsZWN0
KCRuYW1lLCAkdmFsKQp7CiAgICAkdGFicyA9IGFycmF5KCdjb250ZW50JyA9PiAnQ29udGVu
dCcsCiAgICAgICAgJ2V4dGVuc2lvbnMnID0+ICdFeHRlbnNpb25zJywKICAgICAgICAnJyA9
PiAnSGlkZGVuJyk7CiAgICByZXR1cm4gc2VsZWN0SW5wdXQoJG5hbWUsICR0YWJzLCAkdmFs
KTsKfQovLyBQcm92aWRlIGludGVyZmFjZSBmb3Igc2V0dGluZyBwcmVmZXJlbmNlcwpmdW5j
dGlvbiBhcmNfdHdpdHRlcl9wcmVmcygkZXZlbnQsJHN0ZXApCnsKCiAgICBnbG9iYWwgJHBy
ZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNy
ZXQ7CgogICAgJHVzZXIgICAgICAgICAgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXTsK
ICAgICRwcmVmaXggICAgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl9wcmVmaXgnXTsKICAg
ICRzdWZmaXggICAgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl9zdWZmaXgnXTsKICAgICR0
d2VldF9kZWZhdWx0ID0gJHByZWZzWydhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0J107CiAg
ICAkdXJsX21ldGhvZCAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddOwog
ICAgJHNob3J0X3VybCAgICAgPSAkcHJlZnNbJ2FyY19zaG9ydF91cmwnXTsKICAgICRzaG9y
dF9zaXRlX3VybD0gJHByZWZzWydhcmNfc2hvcnRfc2l0ZV91cmwnXTsKICAgICRjYWNoZV9k
aXIgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXTsKICAgICR0YWIgICAg
ICAgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl90YWInXTsKCiAgICBzd2l0Y2ggKCRzdGVw
KSB7CiAgICAgICAgY2FzZSAncHJlZnNfc2F2ZSc6IHBhZ2V0b3AoJ1RYUCBUd2VldCcsICdQ
cmVmZXJlbmNlcyBzYXZlZCcpOyBicmVhazsKICAgICAgICBjYXNlICdyZWdpc3Rlcic6IHBh
Z2V0b3AoJ1RYUCBUd2VldCcsJ0Nvbm5lY3QgdG8gVHdpdHRlcicpOyBicmVhazsKICAgICAg
ICBjYXNlICd2YWxpZGF0ZSc6CiAgICAgICAgZGVmYXVsdDogcGFnZXRvcCgnVFhQIFR3ZWV0
Jyk7CiAgICB9CgogICAgJGh0bWwgPSAnJzsKCiAgICBpZiAoJHN0ZXA9PSdyZWdpc3Rlcicp
IHsgLy8gT0F1dGggcmVnaXN0cmF0aW9uIHByb2Nlc3MKICAgICAgICAkdHdpdCA9IG5ldyBh
cmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgLCAkYXJj
X3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQpOwoKICAgICAgICAvLyBCdWlsZCBhIGNhbGxiYWNr
IFVSTCBmb3IgVHdpdHRlciB0byByZXR1cm4gdG8gdGhlIG5leHQgc3RhZ2UKICAgICAgICAk
Y2FsbGJhY2tVUkwgPSAkdHdpdC0+Y2FsbGJhY2tVUkwoJGV2ZW50LCd2YWxpZGF0ZScpOwoK
ICAgICAgICAkcmVxdWVzdCA9ICR0d2l0LT5nZXRSZXF1ZXN0VG9rZW4oJGNhbGxiYWNrVVJM
KTsKICAgICAgICAkcmVxdWVzdF90b2tlbiA9ICRyZXF1ZXN0WyJvYXV0aF90b2tlbiJdOwog
ICAgICAgICRyZXF1ZXN0X3Rva2VuX3NlY3JldCA9ICRyZXF1ZXN0WyJvYXV0aF90b2tlbl9z
ZWNyZXQiXTsKCiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3JlcXVlc3RUb2tlbics
JHJlcXVlc3RfdG9rZW4KICAgICAgICAgICAgLCAnYXJjX3R3aXR0ZXInLDIpOwogICAgICAg
IHNldF9wcmVmKCdhcmNfdHdpdHRlcl9yZXF1ZXN0VG9rZW5TZWNyZXQnLCRyZXF1ZXN0X3Rv
a2VuX3NlY3JldAogICAgICAgICAgICAsICdhcmNfdHdpdHRlcicsMik7CgogICAgICAgICRo
dG1sLj0gc3RhcnRUYWJsZSgnZWRpdCcpLgogICAgICAgICAgICAgICAgdHIodGQoCiAgICAg
ICAgICAgICAgICAgICAgKCc8cD4nLmhyZWYoJ1NpZ24taW4gdG8gVHdpdHRlcicKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICwkdHdpdC0+Z2V0QXV0aG9yaXplVVJMKCRyZXF1ZXN0
KSkKICAgICAgICAgICAgICAgICAgICAgICAgLicgYW5kIGZvbGxvdyB0aGUgaW5zdHJ1Y3Rp
b25zIHRvIGFsbG93IFRYUCBUd2VldCB0byB1c2UgeW91ciBhY2NvdW50LiBJZiB5b3UgYXJl
IGFscmVhZHkgc2lnbmVkIGluIHRvIFR3aXR0ZXIgdGhlbiB0aGF0IGFjY291bnQgd2lsbCBi
ZSBhc3NvY2lhdGVkIHdpdGggVFhQIFR3ZWV0IHNvIHlvdSBtYXkgbmVlZCB0byBzaWduIG91
dCBmaXJzdCBpZiB5b3Ugd2FudCB0byB1c2UgYSBkaWZmZXJlbnQgYWNjb3VudC48L3A+JykK
ICAgICAgICAgICAgICAgICkpLmVuZFRhYmxlKCk7CiAgICB9IGVsc2VpZiAoJHN0ZXA9PSd2
YWxpZGF0ZScpIHsKICAgICAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJjX3R3aXR0
ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNy
ZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfcmVxdWVzdFRva2VuJ10KICAgICAgICAgICAgLCAk
cHJlZnNbJ2FyY190d2l0dGVyX3JlcXVlc3RUb2tlblNlY3JldCddKTsKICAgICAgICAvLyBB
c2sgVHdpdHRlciBmb3IgYW4gYWNjZXNzIHRva2VuIChhbmQgYW4gYWNjZXNzIHRva2VuIHNl
Y3JldCkKICAgICAgICAkcmVxdWVzdCA9ICR0d2l0LT5nZXRBY2Nlc3NUb2tlbiggZ3BzKCdv
YXV0aF92ZXJpZmllcicpICk7CiAgICAgICAgJGFjY2Vzc190b2tlbiA9ICRyZXF1ZXN0Wydv
YXV0aF90b2tlbiddOwogICAgICAgICRhY2Nlc3NfdG9rZW5fc2VjcmV0ID0gJHJlcXVlc3Rb
J29hdXRoX3Rva2VuX3NlY3JldCddOwogICAgICAgICR1c2VyID0gJHJlcXVlc3RbJ3NjcmVl
bl9uYW1lJ107CiAgICAgICAgLy8gU3RvcmUgdGhlIGFjY2VzcyB0b2tlbiBhbmQgc2VjcmV0
CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJywkYWNjZXNzX3Rv
a2VuLCAnYXJjX3R3aXR0ZXInLDIpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9h
Y2Nlc3NUb2tlblNlY3JldCcsJGFjY2Vzc190b2tlbl9zZWNyZXQKICAgICAgICAgICAgLCAn
YXJjX3R3aXR0ZXInLDIpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl91c2VyJywk
dXNlcik7CiAgICAgICAgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddID0gJGFj
Y2Vzc190b2tlbjsKICAgICAgICAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2Vj
cmV0J10gPSAkYWNjZXNzX3Rva2VuX3NlY3JldDsKICAgICAgICB1bnNldCgkdHdpdCk7CiAg
ICB9CgogICAgaWYgKCRzdGVwPT0icHJlZnNfc2F2ZSIpIHsKICAgICAgICAkcHJlZml4ID0g
dHJpbShncHMoJ2FyY190d2l0dGVyX3ByZWZpeCcpKTsKICAgICAgICAkc3VmZml4ID0gdHJp
bShncHMoJ2FyY190d2l0dGVyX3N1ZmZpeCcpKTsKICAgICAgICAkdHdlZXRfZGVmYXVsdCA9
IGdwcygnYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcpOwogICAgICAgICR1cmxfbWV0aG9k
ID0gZ3BzKCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJyk7CiAgICAgICAgJHNob3J0X3VybCA9
IGdwcygnYXJjX3Nob3J0X3VybCcpOwogICAgICAgICRzaG9ydF9zaXRlX3VybCA9IGdwcygn
YXJjX3Nob3J0X3NpdGVfdXJsJyk7CiAgICAgICAgJGNhY2hlX2RpciA9IGdwcygnYXJjX3R3
aXR0ZXJfY2FjaGVfZGlyJyk7CiAgICAgICAgJHRhYiA9IGdwcygnYXJjX3R3aXR0ZXJfdGFi
Jyk7CiAgICAgICAgaWYgKHN0cmxlbigkcHJlZml4KTw9MjApIHsKICAgICAgICAgICAgc2V0
X3ByZWYoJ2FyY190d2l0dGVyX3ByZWZpeCcsJHByZWZpeCk7CiAgICAgICAgfSBlbHNlIHsK
ICAgICAgICAgICAgJHByZWZpeCA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfcHJlZml4J107CiAg
ICAgICAgfQogICAgICAgIGlmIChzdHJsZW4oJHN1ZmZpeCk8PTIwKSB7CiAgICAgICAgICAg
IHNldF9wcmVmKCdhcmNfdHdpdHRlcl9zdWZmaXgnLCRzdWZmaXgpOwogICAgICAgIH0gZWxz
ZSB7CiAgICAgICAgICAgICRzdWZmaXggPSAkcHJlZnNbJ2FyY190d2l0dGVyX3N1ZmZpeCdd
OwogICAgICAgIH0KICAgICAgICAkdHdlZXRfZGVmYXVsdCA9ICgkdHdlZXRfZGVmYXVsdCkg
PyAxIDogMDsKICAgICAgICAkc2hvcnRfdXJsID0gKCRzaG9ydF91cmwpID8gMSA6IDA7CiAg
ICAgICAgaWYgKCEkc2hvcnRfc2l0ZV91cmwpICRzaG9ydF9zaXRlX3VybCA9ICRwcmVmc1sn
c2l0ZXVybCddOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0
JywkdHdlZXRfZGVmYXVsdCk7CiAgICAgICAgc2V0X3ByZWYoJ2FyY19zaG9ydF91cmwnLCRz
aG9ydF91cmwpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJywk
dXJsX21ldGhvZCk7CiAgICAgICAgc2V0X3ByZWYoJ2FyY19zaG9ydF9zaXRlX3VybCcsJHNo
b3J0X3NpdGVfdXJsKTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfY2FjaGVfZGly
JywkY2FjaGVfZGlyKTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdGFiJywkdGFi
KTsKICAgIH0KCiAgICBpZiAoICRzdGVwIT0ncmVnaXN0ZXInICkgewogICAgICAgIGlmICgg
aXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddKQogICAgICAgICYmIGlz
c2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSkgKSB7CiAgICAg
ICAgICAgICR0d2l0ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktl
eQogICAgICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQsICRwcmVm
c1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXQogICAgICAgICAgICAgICAgLCAkcHJlZnNb
J2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0J10pOwogICAgICAgICAgICAkcmVnaXN0
ZXJVUkwgPSAkdHdpdC0+Y2FsbGJhY2tVUkwoJGV2ZW50LCdyZWdpc3RlcicpOwogICAgICAg
ICAgICAkaHRtbC49IHN0YXJ0VGFibGUoJ2xpc3QnKS5mb3JtKAogICAgICAgICAgICAgICAg
dHIoCiAgICAgICAgICAgICAgICAgICAgdGRjcyhoZWQoJ1R3aXR0ZXIgYWNjb3VudCBkZXRh
aWxzJywgMiksMikKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50cigKICAg
ICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX3VzZXIiPlR3
aXR0ZXIgdXNlcm5hbWU8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5
bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAg
ICAgICAgICAgICAgICAgIC50ZCgKICAgICAgICAgICAgICAgICAgICAgICAgKCRwcmVmc1sn
YXJjX3R3aXR0ZXJfdXNlciddKSA/CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdXNl
ci4nICgnLmhyZWYoJ1JlLWNvbm5lY3QnLCRyZWdpc3RlclVSTCkuJyknCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICA6ICc8ZW0+dW5rbm93bjwvZW0+JwogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgLmhyZWYoJ0Nvbm5lY3QgdG8gVHdpdHRlcicsJHJlZ2lzdGVyVVJMKSkK
ICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAg
ICAgICB0ZGNzKGhlZCgnVHdlZXQgc2V0dGluZ3MnLCAyKSwyKQogICAgICAgICAgICAgICAg
KQogICAgICAgICAgICAgICAgLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVs
IGZvcj0iYXJjX3R3aXR0ZXJfcHJlZml4Ij5Ud2VldCBwcmVmaXg8L2xhYmVsPicsCiAgICAg
ICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNh
bC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50ZChmSW5wdXQoJ3Rl
eHQnLCdhcmNfdHdpdHRlcl9wcmVmaXgnLCRwcmVmaXgsJycsJycsJycsJycsJycsJ2FyY190
d2l0dGVyX3ByZWZpeCcpKQogICAgICAgICAgICAgICAgKS50cigKICAgICAgICAgICAgICAg
ICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX3N1ZmZpeCI+VHdlZXQgc3VmZml4
PC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWdu
OiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAg
ICAudGQoZklucHV0KCd0ZXh0JywnYXJjX3R3aXR0ZXJfc3VmZml4Jywkc3VmZml4LCcnLCcn
LCcnLCcnLCcnLCdhcmNfdHdpdHRlcl9zdWZmaXgnKSkKICAgICAgICAgICAgICAgICkudHIo
CiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl90d2Vl
dF9kZWZhdWx0Ij5Ud2VldCBhcnRpY2xlcyBieSBkZWZhdWx0PC9sYWJlbD4nLAogICAgICAg
ICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwt
YWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoeWVzbm9SYWRpbygn
YXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcsICR0d2VldF9kZWZhdWx0LCAnJywgJ2FyY190
d2l0dGVyX3R3ZWV0X2RlZmF1bHQnKSkKICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAg
ICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl91cmxfbWV0aG9kIj5V
Ukwgc2hvcnRuZXI8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9
InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAg
ICAgICAgICAgICAgIC50ZChhcmNfdHdpdHRlcl91cmxfbWV0aG9kX3NlbGVjdCgnYXJjX3R3
aXR0ZXJfdXJsX21ldGhvZCcsJHVybF9tZXRob2QpKQogICAgICAgICAgICAgICAgKS50cigK
ICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVFhQIFR3ZWV0IHNob3J0IFVSTCcsIDIp
LDIpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAg
ICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfc2hvcnRfdXJsIj5FbmFibGUgVFhQIFR3
ZWV0IHNob3J0IFVSTCByZWRpcmVjdDwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAg
ICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7
IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKHllc25vUmFkaW8oJ2FyY19zaG9ydF91cmwn
LCAkc2hvcnRfdXJsLCAnJywgJ2FyY19zaG9ydF91cmwnKSksCiAgICAgICAgICAgICAgICAg
ICAgJyBpZD0iYXJjX3Nob3J0X3VybC1vbl9vZmYiJwogICAgICAgICAgICAgICAgKS50cigK
ICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY19zaG9ydF9zaXRlX3Vy
bCI+VFhQIFR3ZWV0IHNob3J0IHNpdGUgVVJMPC9sYWJlbD4nLAogICAgICAgICAgICAgICAg
ICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1p
ZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoZklucHV0KCd0ZXh0JywnYXJjX3No
b3J0X3NpdGVfdXJsJywkc2hvcnRfc2l0ZV91cmwsJycsJycsJycsJycsJycsJ2FyY19zaG9y
dF9zaXRlX3VybCcpKSwKICAgICAgICAgICAgICAgICAgICAnIGlkPSJhcmNfc2hvcnRfc2l0
ZV91cmwtb3B0aW9uIicKICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAgICAgICAg
ICAgdGRjcyhoZWQoJ1R3aXR0ZXIgdGFiJywgMiksMikKICAgICAgICAgICAgICAgICkudHIo
CiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl90YWIi
PkxvY2F0aW9uIG9mIFR3aXR0ZXIgdGFiPC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAg
ICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRs
ZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCgn
YXJjX3R3aXR0ZXJfdGFiJywkdGFiKSkKICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAg
ICAgICAgICAgICAgdGRjcyhoZWQoJ0NhY2hlJywgMiksMikKICAgICAgICAgICAgICAgICkK
ICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBm
b3I9ImFyY190d2l0dGVyX2NhY2hlX2RpciI+Q2FjaGUgZGlyZWN0b3J5PC9sYWJlbD4nLAog
ICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVy
dGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoZklucHV0
KCd0ZXh0JywnYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJywkY2FjaGVfZGlyLCcnLCcnLCcnLCcn
LCcnLCdhcmNfdHdpdHRlcl9jYWNoZV9kaXInKSkKICAgICAgICAgICAgICAgICkKICAgICAg
ICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoCiAgICAgICAgICAgICAg
ICAgICAgICAgIGZJbnB1dCgnc3VibWl0JywgJ1N1Ym1pdCcsIGdUeHQoJ3NhdmVfYnV0dG9u
JyksICdwdWJsaXNoJykKICAgICAgICAgICAgICAgICAgICAgICAgLm4uc0lucHV0KCdwcmVm
c19zYXZlJykKICAgICAgICAgICAgICAgICAgICAgICAgLm4uZUlucHV0KCdwbHVnaW5fcHJl
ZnMuYXJjX3R3aXR0ZXInKQogICAgICAgICAgICAgICAgICAgICwgJyBjb2xzcGFuPSIyIiBj
bGFzcz0ibm9saW5lIicpKSkKICAgICAgICAgICAgICAgIC5lbmRUYWJsZSgpOwogICAgICAg
IH0gZWxzZWlmICggJHN0ZXAhPSdyZWdpc3RlcicgKSB7CiAgICAgICAgICAgICRyZWdpc3Rl
clVSTCA9IGFyY190d2l0dGVyOjpjYWxsYmFja1VSTCgkZXZlbnQsJ3JlZ2lzdGVyJyk7CiAg
ICAgICAgICAgICRodG1sLj0gc3RhcnRUYWJsZSgnbGlzdCcpLmZvcm0oCiAgICAgICAgICAg
ICAgICB0cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVHdpdHRlciBhY2NvdW50
IGRldGFpbHMnLCAyKSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRy
KAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfdXNl
ciI+VHdpdHRlciB1c2VybmFtZTwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAg
JyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7Iicp
CiAgICAgICAgICAgICAgICAgICAgLnRkKAogICAgICAgICAgICAgICAgICAgICAgICAoJzxl
bT51bmtub3duPC9lbT4gKCcKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5ocmVmKCdD
b25uZWN0IHRvIFR3aXR0ZXInLCRyZWdpc3RlclVSTCkuJyknKQogICAgICAgICAgICAgICAg
KSkpCiAgICAgICAgICAgICAgICAuZW5kVGFibGUoKTsKICAgICAgICB9CiAgICB9CgogICAg
Ly8gU2V0IGpRdWVyeSBmb3Igc3dpdGNoaW5nIG9uL29mZiByZWxldmFudCBhcmNfc2hvcnRf
dXJsIGZpZWxkcwogICAgJGpzID0gPDw8SlMKPHNjcmlwdCBsYW5ndWFnZT0iamF2YXNjcmlw
dCIgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24o
KXsKICB2YXIgb25vZmYgPSAkKCcjYXJjX3Nob3J0X3VybC1vbl9vZmYnKTsKICB2YXIgYXJj
X3Nob3J0X3VybF9vZmYgPSAkKCcjYXJjX3Nob3J0X3VybC1hcmNfc2hvcnRfdXJsLTAnKTsK
ICB2YXIgdXJsID0gJCgnI2FyY19zaG9ydF9zaXRlX3VybC1vcHRpb24nKTsKICB2YXIgdXJs
X21ldGhvZCA9ICQoJ3NlbGVjdFtuYW1lPSJhcmNfdHdpdHRlcl91cmxfbWV0aG9kIl0nKTsK
CiAgaWYgKGFyY19zaG9ydF91cmxfb2ZmLmF0dHIoJ2NoZWNrZWQnKT09dHJ1ZQogICYmICQo
J29wdGlvbjpzZWxlY3RlZCcsIHVybF9tZXRob2QpLnZhbCgpIT0nYXJjX3R3aXR0ZXInKSB7
CiAgICB1cmwuaGlkZSgpOwogIH0KICAkKCdpbnB1dCcsIG9ub2ZmKS5jaGFuZ2UoZnVuY3Rp
b24oKXsKICAgIGlmICgkKCdvcHRpb246c2VsZWN0ZWQnLCB1cmxfbWV0aG9kKS52YWwoKSE9
J2FyY190d2l0dGVyJykgewogICAgICBhcmNfc2hvcnRfdXJsX29mZi5hdHRyKCdjaGVja2Vk
Jyk9PXRydWUgPyB1cmwuaGlkZSgpIDogdXJsLnNob3coKTsKICAgIH0KICB9KTsKCiAgaWYg
KCQoJ29wdGlvbjpzZWxlY3RlZCcsIHVybF9tZXRob2QpLnZhbCgpPT0nYXJjX3R3aXR0ZXIn
KSB7CiAgICBvbm9mZi5oaWRlKCk7IHVybC5zaG93KCk7CiAgfQogIHVybF9tZXRob2QuY2hh
bmdlKGZ1bmN0aW9uKCl7CiAgICBpZiAoJCgnb3B0aW9uOnNlbGVjdGVkJywgdXJsX21ldGhv
ZCkudmFsKCk9PSdhcmNfdHdpdHRlcicpIHsKICAgICAgb25vZmYudG9nZ2xlKCk7IHVybC5z
aG93KCk7CiAgICB9IGVsc2UgewogICAgICBvbm9mZi50b2dnbGUoKTsKICAgICAgYXJjX3No
b3J0X3VybF9vZmYuYXR0cignY2hlY2tlZCcpPT10cnVlID8gdXJsLmhpZGUoKSA6IHVybC5z
aG93KCk7CiAgICB9CiAgfSkKfSk7Cjwvc2NyaXB0PgpKUzsKCiAgICBlY2hvICRqcy4kaHRt
bDsKfQoKLy8gQWRkIFR3aXR0ZXIgdGFiIHRvIFRleHRwYXR0ZXJuCmZ1bmN0aW9uIGFyY19h
ZG1pbl90d2l0dGVyKCRldmVudCwkc3RlcCkKewogICAgZ2xvYmFsICRwcmVmcywgJGFyY190
d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgogICAg
JHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAg
ICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0
dGVyX2FjY2Vzc1Rva2VuJ10KICAgICAgICAgICAgLCAkcHJlZnNbJ2FyY190d2l0dGVyX2Fj
Y2Vzc1Rva2VuU2VjcmV0J10pOwoKICAgICR0d2l0LT5jYWNoZURpcigkcHJlZnNbJ2FyY190
d2l0dGVyX2NhY2hlX2RpciddKTsKCiAgICAkeG1sID0gJHR3aXQtPmdldCgndXNlcnMvc2hv
dycKICAgICAgICAsIGFycmF5KCdzY3JlZW5fbmFtZSc9PiRwcmVmc1snYXJjX3R3aXR0ZXJf
dXNlciddKSk7CiAgICAkdHdpdHRlclVzZXIgPSBAJHhtbC0+eHBhdGgoJy91c2VyJyk7CiAg
ICAkdHdpdHRlclVzZXIgPSAkdHdpdHRlclVzZXJbMF07CiAgICAkdHdpdHRlclVzZXJVUkwg
PSAnaHR0cDovL3d3dy50d2l0dGVyLmNvbS8nLiR0d2l0dGVyVXNlci0+c2NyZWVuX25hbWU7
CgogICAgaWYgKCRzdGVwPT0idHdlZXQiKSB7IC8vIHBvc3QgYW4gdXBkYXRlIHRvIFR3aXR0
ZXIKCiAgICAgICAgLy8gZmV0Y2ggYW5kIGNsZWFuIG1lc3NhZ2UKICAgICAgICAkbWVzc2Fn
ZSA9IHN0cmlwX3RhZ3MoZ3BzKCdtZXNzYWdlJykpOwogICAgICAgICRjb3VudCA9IHN0cmxl
bigkbWVzc2FnZSk7CgogICAgICAgIGlmICgkY291bnQ8PTE0MCAmJiAkY291bnQ+MCkgeyAv
LyBwb3N0IHVwZGF0ZQogICAgICAgICAgICAkcmVzdWx0ID0gJHR3aXQtPnBvc3QoJ3N0YXR1
c2VzL3VwZGF0ZScsIGFycmF5KCdzdGF0dXMnID0+ICRtZXNzYWdlKSk7CiAgICAgICAgfSBl
bHNlIHsgLy8gbWVzc2FnZSB0b28gbG9uZywgSmF2YVNjcmlwdCBpbnRlcmZhY2Ugc2hvdWxk
IHByZXZlbnQgdGhpcwogICAgICAgICAgICAkcmVzdWx0ID0gZmFsc2U7CiAgICAgICAgfQoK
ICAgICAgICBwYWdldG9wKCdUd2l0dGVyJywKICAgICAgICAgICAgKCgkcmVzdWx0IT1mYWxz
ZSk/J1R3aXR0ZXIgdXBkYXRlZCc6J0Vycm9yIHVwZGF0aW5nIFR3aXR0ZXInKSk7CgogICAg
fSBlbHNlaWYgKCRzdGVwPT0iZGVsZXRlIikgeyAvLyBkZWxldGUgYW4gdXBkYXRlIGZyb20g
VHdpdHRlcgoKICAgICAgICAkaWQgPSBzdHJpcF90YWdzKGdwcygnaWQnKSk7CiAgICAgICAg
aWYgKCRpZCkgewogICAgICAgICAgICAkdHdpdC0+ZGVsZXRlKCdzdGF0dXNlcy9kZXN0cm95
Jy4kaWQpOwogICAgICAgICAgICBzYWZlX2RlbGV0ZSgnYXJjX3R3aXR0ZXInLCJ0d2VldF9p
ZCA9ICRpZCIpOwogICAgICAgIH0KCiAgICAgICAgcGFnZXRvcCgnVHdpdHRlcicsJ1R3aXR0
ZXIgdXBkYXRlZCcpOwoKICAgIH0gZWxzZSB7CgogICAgICAgIHBhZ2V0b3AoJ1R3aXR0ZXIn
KTsKCiAgICB9CgogICAgLy8gUHJlcGFyZSBKYXZhU2NyaXB0IHRvIGNyZWF0ZSBUd2l0dGVy
IHVwZGF0ZSBpbnRlcmZhY2UKCiAgICAkanMgPSAnPHNjcmlwdCBsYW5ndWFnZT0iamF2YXNj
cmlwdCIgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4nOwogICAgJGpzLj0gIiQoZG9jdW1lbnQp
LnJlYWR5KGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHZhciBjb3VudGVyU3R5bGUgPSAnZm9u
dC13ZWlnaHQ6Ym9sZDtmbG9hdDpyaWdodDtmb250LXNpemU6MmVtO2xpbmUtaGVpZ2h0OjEu
MmVtOyc7CiAgICAgICAgICAgICQoJyN0d2VldGNvdW50JykuYXR0cignc3R5bGUnLCBjb3Vu
dGVyU3R5bGUrJ2NvbG9yOiNjY2M7Jyk7CiAgICAgICAgICAgICQoJyNtZXNzYWdlJykua2V5
dXAoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB2YXIgY291bnQgPSAxNDAtJCgnI21l
c3NhZ2UnKS52YWwoKS5sZW5ndGg7CiAgICAgICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcp
Lmh0bWwoY291bnQrJycpOyAvLyBoYWNrIHRvIGZvcmNlIG91dHB1dCBvZiAwCiAgICAgICAg
ICAgICAgICBpZiAoY291bnQ8MCkgewogICAgICAgICAgICAgICAgICAgICQoJ2lucHV0LnB1
Ymxpc2gnKS5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpOwogICAgICAgICAgICAgICAg
fSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkKCdpbnB1dC5wdWJsaXNoJykuYXR0cign
ZGlzYWJsZWQnLCAnJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAo
Y291bnQ8MCkgewogICAgICAgICAgICAgICAgICAgICQoJyN0d2VldGNvdW50JykuYXR0cign
c3R5bGUnLCBjb3VudGVyU3R5bGUrJ2NvbG9yOiNmMDA7Jyk7CiAgICAgICAgICAgICAgICB9
IGVsc2UgaWYgKGNvdW50PDEwKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnI3R3ZWV0Y291
bnQnKS5hdHRyKCdzdHlsZScsIGNvdW50ZXJTdHlsZSsnY29sb3I6IzAwMDsnKTsKICAgICAg
ICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJCgnI3R3ZWV0Y291bnQn
KS5hdHRyKCdzdHlsZScsIGNvdW50ZXJTdHlsZSsnY29sb3I6I2NjYzsnKTsKICAgICAgICAg
ICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICB9KTsiOwogICAgJGpzLj0gIjwvc2Ny
aXB0PiI7CgogICAgJG91dCA9ICcnOwogICAgJHhtbCA9ICR0d2l0LT5nZXQoJ3N0YXR1c2Vz
L3VzZXJfdGltZWxpbmUnCiAgICAgICAgLCBhcnJheSgnc2NyZWVuX25hbWUnPT4kcHJlZnNb
J2FyY190d2l0dGVyX3VzZXInXSwnY291bnQnPT4yNSkpOwogICAgJHR3ZWV0cyA9IEAkeG1s
LT54cGF0aCgnL3N0YXR1c2VzL3N0YXR1cycpOwogICAgaWYgKCR0d2VldHMpIGZvcmVhY2gg
KCR0d2VldHMgYXMgJHR3ZWV0KSB7CiAgICAgICAgJHRpbWUgPSBzdHJ0b3RpbWUoaHRtbGVu
dGl0aWVzKCR0d2VldC0+Y3JlYXRlZF9hdCkpOwogICAgICAgICRkYXRlID0gc2FmZV9zdHJm
dGltZSgkcHJlZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCddLCR0aW1lKTsKICAgICAgICAkb3V0
Lj0gdHIodGQoJGRhdGUsJ3NwYW4nKQogICAgICAgICAgICAudGQoYXJjX1R3aXR0ZXI6Om1h
a2VMaW5rcyhodG1sZW50aXRpZXMoJHR3ZWV0LT50ZXh0CiAgICAgICAgICAgICAgICAsIEVO
VF9RVU9URVMsJ1VURi04JykpKQogICAgICAgICAgICAudGQoZExpbmsoJ2FyY19hZG1pbl90
d2l0dGVyJywnZGVsZXRlJywnaWQnLCR0d2VldC0+aWQsJycpKQogICAgICAgICAgICApOwog
ICAgfQoKICAgICRodG1sID0gc3RhcnRUYWJsZSgnZWRpdCcpCiAgICAgICAgICAgIC50cih0
ZCgKICAgICAgICAgICAgZ3JhZignPGltZyBzcmM9IicuJHR3aXR0ZXJVc2VyLT5wcm9maWxl
X2ltYWdlX3VybC4nIiBhbHQ9IlR3aXR0ZXIgYXZhdGFyIiAvPicKICAgICAgICAgICAgLCcg
c3R5bGU9ImZsb2F0OmxlZnQ7cGFkZGluZzoycHg7IicpCiAgICAgICAgICAgIC5ncmFmKGhy
ZWYoJHR3aXR0ZXJVc2VyLT5uYW1lLCR0d2l0dGVyVXNlclVSTCksJyBzdHlsZT0iZm9udC1z
aXplOjEuMmVtO2ZvbnQtd2VpZ2h0OmJvbGQ7IicpCiAgICAgICAgICAgIC5ncmFmKGhyZWYo
JHR3aXR0ZXJVc2VyLT5mcmllbmRzX2NvdW50LicgZm9sbG93aW5nJywkdHdpdHRlclVzZXJV
UkwuJy9mb2xsb3dpbmcnKQogICAgICAgICAgICAuJywgJy5ocmVmKCR0d2l0dGVyVXNlci0+
Zm9sbG93ZXJzX2NvdW50LicgZm9sbG93ZXJzJywkdHdpdHRlclVzZXJVUkwuJy9mb2xsb3dl
cnMnKQogICAgICAgICAgICAuJywgJy5ocmVmKCR0d2l0dGVyVXNlci0+c3RhdHVzZXNfY291
bnQuJyB1cGRhdGVzJywkdHdpdHRlclVzZXJVUkwpKSkpCiAgICAgICAgICAgIC50cih0ZChm
b3JtKAogICAgICAgICAgICBncmFmKCJVcGRhdGUgVHdpdHRlci4uLjxzcGFuIGlkPSd0d2Vl
dGNvdW50JyBzdHlsZT0nZm9udC13ZWlnaHQ6Ym9sZDtmbG9hdDpyaWdodDsnPjE0MDwvc3Bh
bj4iKQogICAgICAgICAgICAudGV4dF9hcmVhKCdtZXNzYWdlJywnNTAnLCc1NTAnLCcnLCdt
ZXNzYWdlJykKICAgICAgICAgICAgLmVJbnB1dCgnYXJjX2FkbWluX3R3aXR0ZXInKQogICAg
ICAgICAgICAuc0lucHV0KCd0d2VldCcpLmJyCiAgICAgICAgICAgIC5mSW5wdXQoJ3N1Ym1p
dCcsJ3VwZGF0ZScsZ1R4dCgnVXBkYXRlJyksJ3B1Ymxpc2gnKQogICAgICAgICkpKQogICAg
ICAgIC5lbmRUYWJsZSgpOwoKICAgIC8vIEF0dGFjaCByZWNlbnQgVHdpdHRlciB1cGRhdGVz
CgogICAgJGh0bWwuPSBzdGFydFRhYmxlKCdsaXN0JywnJywnJywnJywnOTAlJykKICAgICAg
ICAuJG91dAogICAgICAgIC5lbmRUYWJsZSgpOwoKICAgIC8vIE91dHB1dCBKYXZhU2NyaXB0
IGFuZCBIVE1MCgogICAgZWNobyAkanMuJGh0bWw7Cn0KCi8vIEFkZCBUd2l0dGVyIG9wdGlv
bnMgdG8gYXJ0aWNsZSBhcnRpY2xlIHNjcmVlbgpmdW5jdGlvbiBhcmNfYXBwZW5kX3R3aXR0
ZXIoJGV2ZW50LCAkc3RlcCwgJGRhdGEsICRyczEpCnsKICAgIGdsb2JhbCAkcHJlZnMsICRh
cmNfdHdpdHRlcjsKICAgICRwcmVmaXggPSB0cmltKGdwcygnYXJjX3R3aXR0ZXJfcHJlZml4
JykpOwogICAgJHByZWZpeCA9ICgkcHJlZml4KSA/ICRwcmVmaXggOiAkcHJlZnNbJ2FyY190
d2l0dGVyX3ByZWZpeCddOwogICAgJHN1ZmZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9z
dWZmaXgnKSk7CiAgICAkc3VmZml4ID0gKCRzdWZmaXgpID8gJHN1ZmZpeCA6ICRwcmVmc1sn
YXJjX3R3aXR0ZXJfc3VmZml4J107CgogICAgaWYgKCRyczFbJ0lEJ10pIHsKICAgICAgICAk
c3FsID0gIlNFTEVDVCB0d2VldF9pZCx0d2VldCBGUk9NICIuUEZYLiJhcmNfdHdpdHRlciBX
SEVSRSBhcnRpY2xlX2lkPSIuJHJzMVsnSUQnXS4iOyI7CiAgICAgICAgJHJzMiA9IHNhZmVf
cXVlcnkoJHNxbCk7ICRyczIgPSBuZXh0Um93KCRyczIpOwogICAgfSBlbHNlIHsgLy8gbmV3
IGFydGljbGUKICAgICAgICAkcnMyID0gJyc7CiAgICB9CgogICAgaWYgKCRyczFbJ0lEJ10g
JiYgJHJzMlsndHdlZXRfaWQnXSkgewogICAgICAgICRjb250ZW50ID0gYXJjX1R3aXR0ZXI6
Om1ha2VMaW5rcygkcnMyWyd0d2VldCddKTsKICAgICAgICByZXR1cm4gJGRhdGEuZmllbGRz
ZXQoJGNvbnRlbnQsICdUd2l0dGVyIHVwZGF0ZScsICdhcmNfdHdpdHRlcicpOwogICAgfSBl
bHNlIHsKICAgICAgICAkdmFyID0gZ3BzKCdhcmNfdHdlZXRfdGhpcycpOwogICAgICAgICR2
YXIgPSAoJHJzMVsnSUQnXSYmISR2YXIpID8gMCA6ICRwcmVmc1snYXJjX3R3aXR0ZXJfdHdl
ZXRfZGVmYXVsdCddOwogICAgICAgICRjb250ZW50ICA9IHRhZyh5ZXNub1JhZGlvKCdhcmNf
dHdlZXRfdGhpcycsICR2YXIsICcnLCAnYXJjX3R3ZWV0X3RoaXMnKSwncCcpOwogICAgICAg
ICRjb250ZW50IC49IHRhZyhocmVmKCdPcHRpb25zJywnI2FyY190d2l0dGVyX29wdGlvbnMn
KSwncCcsJyBjbGFzcz0icGxhaW4gbGV2ZXIiIHN0eWxlPSJtYXJnaW4tdG9wOjVweDsiJyk7
CiAgICAgICAgJGNvbnRlbnQgLj0gdGFnKHRhZyh0YWcoJ1R3ZWV0IHByZWZpeCcsJ2xhYmVs
JywgJyBmb3I9ImFyY190d2l0dGVyX3ByZWZpeCInKQogICAgICAgICAgICAuZklucHV0KCd0
ZXh0JywnYXJjX3R3aXR0ZXJfcHJlZml4JywkcHJlZml4LCdlZGl0JywnJywnJywnMjInLCcn
LCdhcmNfdHdpdHRlcl9wcmVmaXgnKSwncCcpCiAgICAgICAgICAgIC50YWcodGFnKCdUd2Vl
dCBzdWZmaXggKGVnICNoYXNodGFncyknLCdsYWJlbCcsICcgZm9yPSJhcmNfdHdpdHRlcl9z
dWZmaXgiJykKICAgICAgICAgICAgLmZJbnB1dCgndGV4dCcsJ2FyY190d2l0dGVyX3N1ZmZp
eCcsJHN1ZmZpeCwnZWRpdCcsJycsJycsJzIyJywnJywnYXJjX3R3aXR0ZXJfc3VmZml4Jyks
J3AnKQogICAgICAgICAgICAsJ2RpdicsJyBpZD0iYXJjX3R3aXR0ZXJfb3B0aW9ucyIgY2xh
c3M9InRvZ2dsZSIgc3R5bGU9ImRpc3BsYXk6bm9uZSInKTsKICAgICAgICBpZiAoaXNzZXQo
JGFyY190d2l0dGVyWydlcnJvciddKSkgewogICAgICAgICAgICAkY29udGVudCAuPSAnPHA+
Jy4kYXJjX3R3aXR0ZXJbJ2Vycm9yJ10uJzwvcD4nOwogICAgICAgIH0KICAgICAgICByZXR1
cm4gJGRhdGEuZmllbGRzZXQoJGNvbnRlbnQsICdVcGRhdGUgVHdpdHRlcicsICdhcmNfdHdp
dHRlcicpOwogICAgfQoKfQoKLy8gVXBkYXRlIFR3aXR0ZXIgd2l0aCBwb3N0ZWQgYXJ0aWNs
ZQpmdW5jdGlvbiBhcmNfYXJ0aWNsZV90d2VldCgkZXZlbnQsJHN0ZXApCnsKICAgIGdsb2Jh
bCAkcHJlZnMsICRhcmNfdHdpdHRlciwgJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAg
ICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgogICAgJGFydGljbGVfaWQgPSBl
bXB0eSgkR0xPQkFMU1snSUQnXSkgPyBncHMoJ0lEJykgOiAkR0xPQkFMU1snSUQnXTsKICAg
IGlmICghZW1wdHkoJGFydGljbGVfaWQpKSB7CgogICAgICAgIGluY2x1ZGVfb25jZSB0eHBh
dGguJy9wdWJsaXNoL3RhZ2hhbmRsZXJzLnBocCc7CgogICAgICAgICRhcnRpY2xlID0gc2Fm
ZV9yb3coIklELCBUaXRsZSwgU2VjdGlvbiwgUG9zdGVkIiwgJ3RleHRwYXR0ZXJuJywKICAg
ICAgICAgICAgIklEPXskYXJ0aWNsZV9pZH0gQU5EIFN0YXR1cz00IEFORCBub3coKT49UG9z
dGVkIik7CgogICAgICAgIGlmICgkYXJ0aWNsZSAmJiBncHMoJ2FyY190d2VldF90aGlzJykp
IHsgLy8gdHdlZXQgYXJ0aWNsZQoKICAgICAgICAgICAgLy8gTmVlZCB0byBtYW51YWxseSB1
cGRhdGUgdGhlICdVUkwgb25seSB0aXRsZScgYmVmb3JlIGJ1aWxkaW5nIHRoZQogICAgICAg
ICAgICAvLyBVUkwKICAgICAgICAgICAgJGFydGljbGVbJ3VybF90aXRsZSddID0gZ3BzKCd1
cmxfdGl0bGUnKTsKICAgICAgICAgICAgLy8gTWFrZSBzaG9ydCBVUkwKICAgICAgICAgICAg
JHVybCA9IHBlcm1saW5rdXJsKCRhcnRpY2xlKTsKICAgICAgICAgICAgJHNob3J0X3VybCA9
IGFyY19zaG9ydGVuX3VybCgkdXJsLCRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCdd
LAogICAgICAgICAgICAgICAgYXJyYXkoJ2lkJz0+JGFydGljbGVfaWQpKTsKCiAgICAgICAg
ICAgIGlmICghJHNob3J0X3VybCkgeyAvLyBGYWlsZWQgdG8gb2J0YWluIGEgc2hvcnRlbmVk
IFVSTCwgZG8gbm90IHR3ZWV0IQogICAgICAgICAgICAgICAgJGFyY190d2l0dGVyWydlcnJv
ciddID0gJ1VuYWJsZSB0byBvYnRhaW4gYSBzaG9ydCBVUkwgZm9yIHRoaXMgYXJ0aWNsZS4n
OwoKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAg
ICAgICAgLy8gQ29uc3RydWN0IFR3aXR0ZXIgdXBkYXRlCiAgICAgICAgICAgICRwcmVmaXgg
ID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3ByZWZpeCcpKTsKICAgICAgICAgICAgJHByZV9s
ZW4gPSBzdHJsZW4oJHByZWZpeCk7CiAgICAgICAgICAgICRwcmVmaXggID0gKCRwcmVmaXgg
JiYgJHByZV9sZW48PTIwKSA/ICRwcmVmaXguJyAnIDogJyc7CiAgICAgICAgICAgICRzdWZm
aXggID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3N1ZmZpeCcpKTsKICAgICAgICAgICAgJHN1
Zl9sZW4gPSBzdHJsZW4oJHN1ZmZpeCk7CiAgICAgICAgICAgICRzdWZmaXggID0gKCRzdWZm
aXggJiYgJHN1Zl9sZW48PTQwKSA/ICcgJy4kc3VmZml4IDogJyc7CiAgICAgICAgICAgICR1
cmxfbGVuID0gc3RybGVuKCRzaG9ydF91cmwpKzE7IC8vIGNvdW50IFVSTCBsZW5ndGggKyAx
IGZvciBwcmVmaXhlZCBzcGFjZQogICAgICAgICAgICBpZiAoJHByZWZpeCkgJHByZV9sZW4g
Kz0gMTsKICAgICAgICAgICAgaWYgKCRzdWZmaXgpICRzdWZfbGVuICs9IDE7CiAgICAgICAg
ICAgIGlmICgoc3RybGVuKCRhcnRpY2xlWydUaXRsZSddKSskdXJsX2xlbiskcHJlX2xlbisk
c3VmX2xlbik+MTQwKSB7CiAgICAgICAgICAgICAgICAkYXJ0aWNsZVsnVGl0bGUnXSA9IHN1
YnN0cigkYXJ0aWNsZVsnVGl0bGUnXSwwLDEzNS0kdXJsX2xlbi0kcHJlX2xlbi0kc3VmX2xl
bikuJy4uLic7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJHR3ZWV0ID0gJHByZWZpeC4k
YXJ0aWNsZVsnVGl0bGUnXS4iICIuJHNob3J0X3VybC4kc3VmZml4OwoKICAgICAgICAgICAg
Ly8gVXBkYXRlIFR3aXR0ZXIKICAgICAgICAgICAgJHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIo
JGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgICAgICAgICAsICRhcmNfdHdpdHRl
cl9jb25zdW1lclNlY3JldCwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddCiAg
ICAgICAgICAgICAgICAsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQn
XSk7CiAgICAgICAgICAgICRyZXN1bHQgPSAkdHdpdC0+cG9zdCgnc3RhdHVzZXMvdXBkYXRl
JywgYXJyYXkoJ3N0YXR1cycgPT4gJHR3ZWV0KSk7CgogICAgICAgICAgICAkdHdlZXRfaWQg
PSAoaXNfb2JqZWN0KCRyZXN1bHQpKSA/ICRyZXN1bHRbMF0tPmlkIDogMDsKCiAgICAgICAg
ICAgIGlmICgkdHdlZXRfaWQpIHsKCiAgICAgICAgICAgICAgICAkdHdlZXQgPSBhZGRzbGFz
aGVzKCR0d2VldCk7CgogICAgICAgICAgICAgICAgLy8gdXBkYXRlIGFyY190d2l0dGVyIHRh
YmxlIHdpdGggdHdlZXQKICAgICAgICAgICAgICAgICRzcWwgPSAiSU5TRVJUIElOVE8gIi5Q
RlguImFyY190d2l0dGVyIChhcnRpY2xlX2lkLHR3ZWV0X2lkLHR3ZWV0LHRpbnl1cmwpICI7
CiAgICAgICAgICAgICAgICAkc3FsLj0gIlZBTFVFUygkYXJ0aWNsZV9pZCwkdHdlZXRfaWQs
XCIkdHdlZXRcIiwnJHNob3J0X3VybCcpOyI7CiAgICAgICAgICAgICAgICBzYWZlX3F1ZXJ5
KCRzcWwpOwoKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgICAgICAgfSBl
bHNlIHsKCiAgICAgICAgICAgICAgICAkYXJjX3R3aXR0ZXJbJ2Vycm9yJ10gPSAnVHdpdHRl
ciByZXNwb25zZTogJwogICAgICAgICAgICAgICAgICAgIC4kdHdpdC0+aHR0cF9jb2RlOwog
ICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAgfQoKICAgICAgICB9
CgogICAgfQoKICAgIHJldHVybiBmYWxzZTsKCn0KCi8qCiAqIFNob3J0ZW4gVVJMcyB1c2lu
ZyB2YXJpb3VzIG1ldGhvZHMKICovCgpmdW5jdGlvbiBhcmNfc2hvcnRlbl91cmwoJHVybCwg
JG1ldGhvZD0nJywgJGF0dHM9YXJyYXkoKSkKewogIGdsb2JhbCAkcHJlZnM7CgogICRjaCA9
IGN1cmxfaW5pdCgpOwogIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9IRUFERVIsIDApOwog
IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgdHJ1ZSk7CiAgY3Vy
bF9zZXRvcHQoJGNoLCBDVVJMT1BUX1RJTUVPVVQsIDEwKTsKCiAgc3dpdGNoICgkbWV0aG9k
KSB7CiAgICBjYXNlICdzbWQnOiAvLyBjcmVhdGUgYSBzaG9ydGVuZWQgVVJMIHVzaW5nIFNN
RCBTaG9ydCBVUkwKICAgICAgcmV0dXJuICgkYXR0c1snaWQnXSkgPyBodS4kYXR0c1snaWQn
XSA6IGZhbHNlOyBicmVhazsKICAgIGNhc2UgJ2FyY190d2l0dGVyJzogLy8gbmF0aXZlIFVS
TCBzaG9ydGVuaW5nCgogICAgICByZXR1cm4gKCRhdHRzWydpZCddKSA/IFBST1RPQ09MLiRw
cmVmc1snYXJjX3Nob3J0X3NpdGVfdXJsJ10uJy8nLiRhdHRzWydpZCddIDogZmFsc2U7CiAg
ICAgIGJyZWFrOwoKICAgIGNhc2UgJ2lzZ2QnOgoKICAgICAgJHUgPSAnaHR0cDovL2lzLmdk
L2FwaS5waHA/bG9uZ3VybD0nLnVybGVuY29kZSgkdXJsKTsKICAgICAgY3VybF9zZXRvcHQo
JGNoLCBDVVJMT1BUX1VSTCwgJHUpOwoKICAgICAgJHRpbnl1cmwgPSBjdXJsX2V4ZWMoJGNo
KTsKICAgICAgaWYgKCR0aW55dXJsIT0nRXJyb3InICYmICR0aW55dXJsIT0nJykgewogICAg
ICAgIHJldHVybiAkdGlueXVybDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0cmlnZ2VyX2Vy
cm9yKCdhcmNfdHdpdHRlciBmYWlsZWQgdG8gZ2V0IGEgaXMuZ2QgVVJMIGZvciAnCiAgICAg
ICAgICAgIC4kdXJsLEVfVVNFUl9XQVJOSU5HKTsKICAgICAgfQogICAgICBicmVhazsKCiAg
ICBjYXNlICd0aW55dXJsJzogZGVmYXVsdDogLy8gY3JlYXRlIGEgc2hvcnRlbmVkIFVSTCB1
c2luZyBUaW55VVJMCgogICAgICAkdSA9ICdodHRwOi8vdGlueXVybC5jb20vYXBpLWNyZWF0
ZS5waHA/dXJsPScudXJsZW5jb2RlKCR1cmwpOwogICAgICBjdXJsX3NldG9wdCgkY2gsIENV
UkxPUFRfVVJMLCAkdSk7CiAgICAgICR0aW55dXJsID0gY3VybF9leGVjKCRjaCk7CiAgICAg
IGlmICgkdGlueXVybCE9J0Vycm9yJyAmJiAkdGlueXVybCE9JycpIHsKICAgICAgICByZXR1
cm4gJHRpbnl1cmw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdHJpZ2dlcl9lcnJvcignYXJj
X3R3aXR0ZXIgZmFpbGVkIHRvIGdldCBhIFRpbnlVUkwgZm9yICcuJHVybCxFX1VTRVJfV0FS
TklORyk7CiAgICAgIH0KCiAgfQoKICByZXR1cm4gZmFsc2U7IC8vIGZhaWwKCn0KCi8qCiAq
IFNob3J0ZW5lZCBVUkwgcmVkaXJlY3QgYmFzZWQgb24gc21kX3Nob3J0X3VybAogKi8KZnVu
Y3Rpb24gYXJjX3Nob3J0X3VybF9yZWRpcmVjdCgkZXZlbnQsICRzdGVwKSB7CiAgZ2xvYmFs
ICRwcmVmczsKCiAgJGhhdmVfaWQgPSAwOwoKICAvLyBDaGVjayBpZiB0aGVyZSBpcyBhbiBh
dmFpbGFibGUgc2hvcnQgc2l0ZSB1cmwgYW5kIGlmIGl0IGlzIGJlaW5nIHVzZWQgaW4KICAv
LyB0aGlzIGluc3RhbmNlCiAgJHNob3J0X3NpdGVfdXJsID0gJHByZWZzWydhcmNfc2hvcnRf
c2l0ZV91cmwnXTsKICBpZiAoJHNob3J0X3NpdGVfdXJsKSB7CiAgICAkc2hvcnRfc2l0ZV91
cmwgPSBQUk9UT0NPTC4kc2hvcnRfc2l0ZV91cmwuJy8nOwogICAgJHVybF9wYXJ0cyA9IHBh
cnNlX3VybCgkc2hvcnRfc2l0ZV91cmwpOwogICAgJHJlID0gJyNeJy4kdXJsX3BhcnRzWydw
YXRoJ10uJyhbMC05XS4qKSMnOwogICAgJGhhdmVfaWQgPSBwcmVnX21hdGNoKCRyZSwgJF9T
RVJWRVJbJ1JFUVVFU1RfVVJJJ10sICRtKTsKICB9CgogIC8vIEZhbGwgYmFjayB0byBzdGFu
ZGFyZCBzaXRlIHVybCAoc21kX3Nob3J0X3VybCBiZWhhdmlvdXIpCiAgaWYgKCRoYXZlX2lk
KSB7CiAgICAkdXJsX3BhcnRzID0gcGFyc2VfdXJsKGh1KTsKICAgICRyZSA9ICcjXicuJHVy
bF9wYXJ0c1sncGF0aCddLicoWzAtOV0uKikjJzsKICAgICRoYXZlX2lkID0gcHJlZ19tYXRj
aCgkcmUsICRfU0VSVkVSWydSRVFVRVNUX1VSSSddLCAkbSk7CiAgfQoKICAvLyBEbyB0aGUg
cmVkaXJlY3QgaWYgd2UndmUgZ290IGFuIGFydGljbGUgaWQKICBpZiAoJGhhdmVfaWQpIHsK
CSAgJGlkID0gJG1bMV07CgkgICRwZXJtbGluayA9IHBlcm1saW5rdXJsX2lkKCRpZCk7CgoJ
ICBpZiAoJHBlcm1saW5rKSB7CgkJICBvYl9lbmRfY2xlYW4oKTsKCgkJICAvLyBTdHVwaWQs
IG92ZXIgdGhlIHRvcCBoZWFkZXIgc2V0dGluZyBmb3IgSUUKCQkgIGhlYWRlcigiU3RhdHVz
OiAzMDEiKTsKCQkgIGhlYWRlcigiSFRUUC8xLjAgMzAxIE1vdmVkIFBlcm1hbmVudGx5Iik7
CgkJICBoZWFkZXIoIkxvY2F0aW9uOiAiLiRwZXJtbGluaywgVFJVRSwgMzAxKTsKCgkJICAv
LyBJbiBjYXNlIHRoZSBoZWFkZXIoKSBtZXRob2QgZmFpbHMsIGZhbGwgYmFjayBvbiBhIGNs
YXNzaWMgcmVkaXJlY3QKCQkgIGVjaG8gJzxodG1sPjxoZWFkPjxNRVRBIEhUVFAtRVFVSVY9
IlJlZnJlc2giIENPTlRFTlQ9IjA7VVJMPScKCQkgICAgLiRwZXJtbGluay4nIj48L2hlYWQ+
PGJvZHk+PC9ib2R5PjwvaHRtbD4nOwoJCSAgZGllKCk7CgkgIH0KICB9Cgp9CgovKgogKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKgoqLwoKY2xhc3MgYXJjX3R3aXR0ZXIgZXh0ZW5kcyBU
d2l0dGVyT0F1dGggewogICAgLy8gQ2FjaGluZyB2YXJpYWJsZXMKICAgIHByaXZhdGUgJF9j
YWNoZSA9IHRydWU7CiAgICBwcml2YXRlICRfY2FjaGVfZGlyID0gJy4vdG1wJzsKICAgIHBy
aXZhdGUgJF9jYWNoZV90aW1lID0gMTgwMDsgLy8gMzAgbWludXRlIGNhY2hlCgogICAgZnVu
Y3Rpb24gX19jb25zdHJ1Y3QoJGNvbnN1bWVyX2tleSwgJGNvbnN1bWVyX3NlY3JldCwgJG9h
dXRoX3Rva2VuID0gTlVMTAogICAgICAgICwgJG9hdXRoX3Rva2VuX3NlY3JldCA9IE5VTEwp
CiAgICB7CiAgICAgICAgcGFyZW50OjpfX2NvbnN0cnVjdCgkY29uc3VtZXJfa2V5LCAkY29u
c3VtZXJfc2VjcmV0LCAkb2F1dGhfdG9rZW4KICAgICAgICAgICAgLCAkb2F1dGhfdG9rZW5f
c2VjcmV0KTsKICAgICAgICAkdGhpcy0+Zm9ybWF0ID0gJ3htbCc7CiAgICAgICAgJHRoaXMt
PnRpbWVvdXQgPSAxNTsKICAgICAgICAkdGhpcy0+Y29ubmVjdHRpbWVvdXQgPSAxNTsKICAg
IH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gY2FsbGJhY2tVUkwoJGV2ZW50LCRzdGVwKQogICAg
ewogICAgICAgIHJldHVybiBwcmVnX3JlcGxhY2UoJy9cPy4qLycsICcnLFBST1RPQ09MLiRf
U0VSVkVSWydTRVJWRVJfTkFNRSddLiRfU0VSVkVSWydSRVFVRVNUX1VSSSddKQogICAgICAg
ICAgLic/ZXZlbnQ9Jy4kZXZlbnQuJyZhbXA7c3RlcD0nLiRzdGVwOwogICAgfQoKICAgIC8v
IGNyZWF0ZSBUd2l0dGVyIGFuZCBleHRlcm5hbCBsaW5rcyBpbiB0ZXh0CiAgICBwdWJsaWMg
c3RhdGljIGZ1bmN0aW9uIG1ha2VMaW5rcygkdGV4dCkKICAgIHsKICAgICAgICAkdXJsID0g
Jy9cYihodHRwfGh0dHBzfGZ0cCk6XC9cLyhbQS1aMC05XVtBLVowLTlfLV0qKD86XC5bQS1a
MC05XVtBLVowLTlfLV0qKSspOj8oXGQrKT9cLz8oW1wvXHcrXC5dKylcYi9pJzsKICAgICAg
ICAkdGV4dCA9IHByZWdfcmVwbGFjZSgkdXJsLCAiPGEgaHJlZj0nJDAnPiQwPC9hPiIsICR0
ZXh0KTsKICAgICAgICAkdXJsID0gJy9cYihefFxzKXd3dy4oW2Etel9BLVowLTldKykoKFwu
W2Etel0rKSspXGIvaSc7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2UoJHVybCwgIjxh
IGhyZWY9J2h0dHA6Ly93d3cuJDIkMyc+d3d3LiQyJDM8L2E+IiwgJHRleHQpOwogICAgICAg
ICR0ZXh0ID0gcHJlZ19yZXBsYWNlKCIvKF58XHMpQChbYS16X0EtWjAtOV0rKS8iLAogICAg
ICAgICAgICAiJDFAPGEgaHJlZj0naHR0cDovL3R3aXR0ZXIuY29tLyQyJz4kMjwvYT4iLCR0
ZXh0KTsKICAgICAgICAkdGV4dCA9IHByZWdfcmVwbGFjZSgiLyhefFxzKShcIyhbYS16X0Et
WjAtOTpfLV0rKSkvIiwKICAgICAgICAgICAgIiQxPGEgaHJlZj0naHR0cDovL3R3aXR0ZXIu
Y29tL3NlYXJjaD9xPSUyMyQzJz4kMjwvYT4iLCR0ZXh0KTsKICAgICAgICByZXR1cm4gJHRl
eHQ7CiAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBnZXQoJHVybCwgJHBhcmFtcyA9IGFycmF5
KCkpCiAgICB7CiAgICAgICAgJGFwaV91cmwgPSBtZDUoJHVybC51cmxlbmNvZGUoc2VyaWFs
aXplKCRwYXJhbXMpKSk7CiAgICAgICAgJGRhdGEgPSAnJzsKCiAgICAgICAgaWYgKCR0aGlz
LT5fY2FjaGUpIHsgLy8gY2hlY2sgZm9yIGNhY2hlZCB4bWwKCiAgICAgICAgICAgICRkYXRh
ID0gJHRoaXMtPl9yZXRyaWV2ZUNhY2hlKCRhcGlfdXJsKTsKCiAgICAgICAgfQogICAgICAg
IGlmIChlbXB0eSgkZGF0YSkpIHsKICAgICAgICAgICAgJGRhdGEgPSBwYXJlbnQ6OmdldCgk
dXJsLCAkcGFyYW1zKTsKICAgICAgICAgICAgaWYgKCR0aGlzLT5odHRwX2NvZGU9PT0yMDAg
JiYgJHhtbD1zaW1wbGV4bWxfbG9hZF9zdHJpbmcoJGRhdGEpKSB7IC8vIHNhdmUgY2FjaGUK
ICAgICAgICAgICAgICAgICRmaWxlID0gJHRoaXMtPl9jYWNoZV9kaXIuJy8nLiRhcGlfdXJs
OwogICAgICAgICAgICAgICAgZmlsZV9wdXRfY29udGVudHMoJGZpbGUsJGRhdGEsTE9DS19F
WCk7CiAgICAgICAgICAgICAgICByZXR1cm4gJHhtbDsKICAgICAgICAgICAgfSBlbHNlIHsg
Ly8gZmFpbGVkIHRvIHJldHJpZXZlIGRhdGEgZnJvbSBUd2l0dGVyCgogICAgICAgICAgICAg
ICAgaWYgKCR0aGlzLT5fY2FjaGUpIHsgLy8gYXR0ZW1wdCB0byBmb3JjZSBjYWNoZWQgeG1s
IHJldHVybgoKICAgICAgICAgICAgICAgICAgICAkZGF0YSA9ICR0aGlzLT5fcmV0cmlldmVD
YWNoZSgkYXBpX3VybCx0cnVlKTsKICAgICAgICAgICAgICAgICAgICBpZiAoJGRhdGEpIHJl
dHVybiBAc2ltcGxleG1sX2xvYWRfc3RyaW5nKCRkYXRhKTsKCiAgICAgICAgICAgICAgICB9
CgogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAgfQogICAgICAg
IH0gZWxzZSB7IC8vIHJldHVybiBjYWNoZWQgeG1sCiAgICAgICAgICAgIHJldHVybiBAc2lt
cGxleG1sX2xvYWRfc3RyaW5nKCRkYXRhKTsKICAgICAgICB9CiAgICB9IC8vZW5kIGdldCgp
CgogICAgZnVuY3Rpb24gcG9zdCgkdXJsLCAkcGFyYW1zID0gYXJyYXkoKSkKICAgIHsKICAg
ICAgICAkZGF0YSA9IHBhcmVudDo6cG9zdCgkdXJsLCRwYXJhbXMpOwogICAgICAgIHJldHVy
biBzaW1wbGV4bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRl
bGV0ZSgkdXJsLCAkcGFyYW1zID0gYXJyYXkoKSkKICAgIHsKICAgICAgICAkZGF0YSA9IHBh
cmVudDo6ZGVsZXRlKCR1cmwsJHBhcmFtcyk7CiAgICAgICAgcmV0dXJuIHNpbXBsZXhtbF9s
b2FkX3N0cmluZygkZGF0YSk7CiAgICB9CgogICAgLy8gQ2FjaGUgbWV0aG9kcwoKICAgIHB1
YmxpYyBmdW5jdGlvbiBzZXRDYWNoaW5nKCRjYWNoZT10cnVlKQogICAgewogICAgICAgICR0
aGlzLT5fY2FjaGUgPSAoJGNhY2hlKSA/IHRydWUgOiBmYWxzZTsKICAgICAgICByZXR1cm4g
dHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gY2FjaGVEaXIoJGxvYykKICAgIHsK
ICAgICAgICAkdGhpcy0+X2NhY2hlX2RpciA9ICRsb2M7CiAgICAgICAgcmV0dXJuIHRydWU7
CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGNhY2hlVGltZSgkbWlucykKICAgIHsKICAg
ICAgICAkdGhpcy0+X2NhY2hlX3RpbWUgPSAkbWlucyo2MDsgLy8gY29udmVydCBtaW51dGVz
IGludG8gc2Vjb25kcwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHByaXZhdGUg
ZnVuY3Rpb24gX3JldHJpZXZlQ2FjaGUoJHVybCwkb3ZlcmlkZV90aW1lb3V0PWZhbHNlKQog
ICAgewogICAgICAgICRmaWxlID0gJHRoaXMtPl9jYWNoZV9kaXIuJy8nLiR1cmw7CiAgICAg
ICAgaWYgKGZpbGVfZXhpc3RzKCRmaWxlKSkgewoKICAgICAgICAgICAgJGRpZmYgPSB0aW1l
KCkgLSBmaWxlbXRpbWUoJGZpbGUpOwogICAgICAgICAgICBpZiAoJG92ZXJpZGVfdGltZW91
dCB8fCAkZGlmZiA8ICR0aGlzLT5fY2FjaGVfdGltZSkgewogICAgICAgICAgICAgICAgcmV0
dXJuIGZpbGVfZ2V0X2NvbnRlbnRzKCRmaWxlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAg
ICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICB9IGVs
c2UgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQp9CgovKgog
KiBBYnJhaGFtIFdpbGxpYW1zIChhYnJhaGFtQGFicmFoLmFtKSBodHRwOi8vYWJyYWguYW0K
ICoKICogVGhlIGZpcnN0IFBIUCBMaWJyYXJ5IHRvIHN1cHBvcnQgT0F1dGggZm9yIFR3aXR0
ZXIncyBSRVNUIEFQSS4KICovCgovKioKICogVHdpdHRlciBPQXV0aCBjbGFzcwogKi8KY2xh
c3MgVHdpdHRlck9BdXRoIHsKICAvKiBDb250YWlucyB0aGUgbGFzdCBIVFRQIHN0YXR1cyBj
b2RlIHJldHVybmVkLiAqLwogIHB1YmxpYyAkaHR0cF9jb2RlOwogIC8qIENvbnRhaW5zIHRo
ZSBsYXN0IEFQSSBjYWxsLiAqLwogIHB1YmxpYyAkdXJsOwogIC8qIFNldCB1cCB0aGUgQVBJ
IHJvb3QgVVJMLiAqLwogIHB1YmxpYyAkaG9zdCA9ICJodHRwczovL2FwaS50d2l0dGVyLmNv
bS8xLyI7CiAgLyogU2V0IHRpbWVvdXQgZGVmYXVsdC4gKi8KICBwdWJsaWMgJHRpbWVvdXQg
PSAzMDsKICAvKiBTZXQgY29ubmVjdCB0aW1lb3V0LiAqLwogIHB1YmxpYyAkY29ubmVjdHRp
bWVvdXQgPSAzMDsKICAvKiBWZXJpZnkgU1NMIENlcnQuICovCiAgcHVibGljICRzc2xfdmVy
aWZ5cGVlciA9IEZBTFNFOwogIC8qIFJlc3BvbnMgZm9ybWF0LiAqLwogIHB1YmxpYyAkZm9y
bWF0ID0gJ2pzb24nOwogIC8qIERlY29kZSByZXR1cm5lZCBqc29uIGRhdGEuICovCiAgcHVi
bGljICRkZWNvZGVfanNvbiA9IFRSVUU7CiAgLyogQ29udGFpbnMgdGhlIGxhc3QgSFRUUCBo
ZWFkZXJzIHJldHVybmVkLiAqLwogIHB1YmxpYyAkaHR0cF9pbmZvOwogIC8qIFNldCB0aGUg
dXNlcmFnbmV0LiAqLwogIHB1YmxpYyAkdXNlcmFnZW50ID0gJ1R3aXR0ZXJPQXV0aCB2MC4y
LjAtYmV0YTInOwogIC8qIEltbWVkaWF0ZWx5IHJldHJ5IHRoZSBBUEkgY2FsbCBpZiB0aGUg
cmVzcG9uc2Ugd2FzIG5vdCBzdWNjZXNzZnVsLiAqLwogIC8vcHVibGljICRyZXRyeSA9IFRS
VUU7CgoKCgogIC8qKgogICAqIFNldCBBUEkgVVJMUwogICAqLwogIGZ1bmN0aW9uIGFjY2Vz
c1Rva2VuVVJMKCkgIHsgcmV0dXJuICdodHRwczovL2FwaS50d2l0dGVyLmNvbS9vYXV0aC9h
Y2Nlc3NfdG9rZW4nOyB9CiAgZnVuY3Rpb24gYXV0aGVudGljYXRlVVJMKCkgeyByZXR1cm4g
J2h0dHBzOi8vdHdpdHRlci5jb20vb2F1dGgvYXV0aGVudGljYXRlJzsgfQogIGZ1bmN0aW9u
IGF1dGhvcml6ZVVSTCgpICAgIHsgcmV0dXJuICdodHRwczovL3R3aXR0ZXIuY29tL29hdXRo
L2F1dGhvcml6ZSc7IH0KICBmdW5jdGlvbiByZXF1ZXN0VG9rZW5VUkwoKSB7IHJldHVybiAn
aHR0cHM6Ly9hcGkudHdpdHRlci5jb20vb2F1dGgvcmVxdWVzdF90b2tlbic7IH0KCiAgLyoq
CiAgICogRGVidWcgaGVscGVycwogICAqLwogIGZ1bmN0aW9uIGxhc3RTdGF0dXNDb2RlKCkg
eyByZXR1cm4gJHRoaXMtPmh0dHBfc3RhdHVzOyB9CiAgZnVuY3Rpb24gbGFzdEFQSUNhbGwo
KSB7IHJldHVybiAkdGhpcy0+bGFzdF9hcGlfY2FsbDsgfQoKICAvKioKICAgKiBjb25zdHJ1
Y3QgVHdpdHRlck9BdXRoIG9iamVjdAogICAqLwogIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRj
b25zdW1lcl9rZXksICRjb25zdW1lcl9zZWNyZXQsICRvYXV0aF90b2tlbiA9IE5VTEwsICRv
YXV0aF90b2tlbl9zZWNyZXQgPSBOVUxMKSB7CiAgICAkdGhpcy0+c2hhMV9tZXRob2QgPSBu
ZXcgT0F1dGhTaWduYXR1cmVNZXRob2RfSE1BQ19TSEExKCk7CiAgICAkdGhpcy0+Y29uc3Vt
ZXIgPSBuZXcgT0F1dGhDb25zdW1lcigkY29uc3VtZXJfa2V5LCAkY29uc3VtZXJfc2VjcmV0
KTsKICAgIGlmICghZW1wdHkoJG9hdXRoX3Rva2VuKSAmJiAhZW1wdHkoJG9hdXRoX3Rva2Vu
X3NlY3JldCkpIHsKICAgICAgJHRoaXMtPnRva2VuID0gbmV3IE9BdXRoQ29uc3VtZXIoJG9h
dXRoX3Rva2VuLCAkb2F1dGhfdG9rZW5fc2VjcmV0KTsKICAgIH0gZWxzZSB7CiAgICAgICR0
aGlzLT50b2tlbiA9IE5VTEw7CiAgICB9CiAgfQoKCiAgLyoqCiAgICogR2V0IGEgcmVxdWVz
dF90b2tlbiBmcm9tIFR3aXR0ZXIKICAgKgogICAqIEByZXR1cm5zIGEga2V5L3ZhbHVlIGFy
cmF5IGNvbnRhaW5pbmcgb2F1dGhfdG9rZW4gYW5kIG9hdXRoX3Rva2VuX3NlY3JldAogICAq
LwogIGZ1bmN0aW9uIGdldFJlcXVlc3RUb2tlbigkb2F1dGhfY2FsbGJhY2sgPSBOVUxMKSB7
CiAgICAkcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICBpZiAoIWVtcHR5KCRvYXV0aF9jYWxs
YmFjaykpIHsKICAgICAgJHBhcmFtZXRlcnNbJ29hdXRoX2NhbGxiYWNrJ10gPSAkb2F1dGhf
Y2FsbGJhY2s7CiAgICB9CiAgICAkcmVxdWVzdCA9ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHRo
aXMtPnJlcXVlc3RUb2tlblVSTCgpLCAnR0VUJywgJHBhcmFtZXRlcnMpOwogICAgJHRva2Vu
ID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKCRyZXF1ZXN0KTsKICAgICR0aGlzLT50
b2tlbiA9IG5ldyBPQXV0aENvbnN1bWVyKCR0b2tlblsnb2F1dGhfdG9rZW4nXSwgJHRva2Vu
WydvYXV0aF90b2tlbl9zZWNyZXQnXSk7CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAgLyoq
CiAgICogR2V0IHRoZSBhdXRob3JpemUgVVJMCiAgICoKICAgKiBAcmV0dXJucyBhIHN0cmlu
ZwogICAqLwogIGZ1bmN0aW9uIGdldEF1dGhvcml6ZVVSTCgkdG9rZW4sICRzaWduX2luX3dp
dGhfdHdpdHRlciA9IFRSVUUpIHsKICAgIGlmIChpc19hcnJheSgkdG9rZW4pKSB7CiAgICAg
ICR0b2tlbiA9ICR0b2tlblsnb2F1dGhfdG9rZW4nXTsKICAgIH0KICAgIGlmIChlbXB0eSgk
c2lnbl9pbl93aXRoX3R3aXR0ZXIpKSB7CiAgICAgIHJldHVybiAkdGhpcy0+YXV0aG9yaXpl
VVJMKCkgLiAiP29hdXRoX3Rva2VuPXskdG9rZW59IjsKICAgIH0gZWxzZSB7CiAgICAgICBy
ZXR1cm4gJHRoaXMtPmF1dGhlbnRpY2F0ZVVSTCgpIC4gIj9vYXV0aF90b2tlbj17JHRva2Vu
fSI7CiAgICB9CiAgfQoKICAvKioKICAgKiBFeGNoYW5nZSByZXF1ZXN0IHRva2VuIGFuZCBz
ZWNyZXQgZm9yIGFuIGFjY2VzcyB0b2tlbiBhbmQKICAgKiBzZWNyZXQsIHRvIHNpZ24gQVBJ
IGNhbGxzLgogICAqCiAgICogQHJldHVybnMgYXJyYXkoIm9hdXRoX3Rva2VuIiA9PiAidGhl
LWFjY2Vzcy10b2tlbiIsCiAgICogICAgICAgICAgICAgICAgIm9hdXRoX3Rva2VuX3NlY3Jl
dCIgPT4gInRoZS1hY2Nlc3Mtc2VjcmV0IiwKICAgKiAgICAgICAgICAgICAgICAidXNlcl9p
ZCIgPT4gIjk0MzY5OTIiLAogICAqICAgICAgICAgICAgICAgICJzY3JlZW5fbmFtZSIgPT4g
ImFicmFoYW0iKQogICAqLwogIGZ1bmN0aW9uIGdldEFjY2Vzc1Rva2VuKCRvYXV0aF92ZXJp
ZmllciA9IEZBTFNFKSB7CiAgICAkcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICBpZiAoIWVt
cHR5KCRvYXV0aF92ZXJpZmllcikpIHsKICAgICAgJHBhcmFtZXRlcnNbJ29hdXRoX3Zlcmlm
aWVyJ10gPSAkb2F1dGhfdmVyaWZpZXI7CiAgICB9CiAgICAkcmVxdWVzdCA9ICR0aGlzLT5v
QXV0aFJlcXVlc3QoJHRoaXMtPmFjY2Vzc1Rva2VuVVJMKCksICdHRVQnLCAkcGFyYW1ldGVy
cyk7CiAgICAkdG9rZW4gPSBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMoJHJlcXVlc3Qp
OwogICAgJHRoaXMtPnRva2VuID0gbmV3IE9BdXRoQ29uc3VtZXIoJHRva2VuWydvYXV0aF90
b2tlbiddLCAkdG9rZW5bJ29hdXRoX3Rva2VuX3NlY3JldCddKTsKICAgIHJldHVybiAkdG9r
ZW47CiAgfQoKICAvKioKICAgKiBPbmUgdGltZSBleGNoYW5nZSBvZiB1c2VybmFtZSBhbmQg
cGFzc3dvcmQgZm9yIGFjY2VzcyB0b2tlbiBhbmQgc2VjcmV0LgogICAqCiAgICogQHJldHVy
bnMgYXJyYXkoIm9hdXRoX3Rva2VuIiA9PiAidGhlLWFjY2Vzcy10b2tlbiIsCiAgICogICAg
ICAgICAgICAgICAgIm9hdXRoX3Rva2VuX3NlY3JldCIgPT4gInRoZS1hY2Nlc3Mtc2VjcmV0
IiwKICAgKiAgICAgICAgICAgICAgICAidXNlcl9pZCIgPT4gIjk0MzY5OTIiLAogICAqICAg
ICAgICAgICAgICAgICJzY3JlZW5fbmFtZSIgPT4gImFicmFoYW0iLAogICAqICAgICAgICAg
ICAgICAgICJ4X2F1dGhfZXhwaXJlcyIgPT4gIjAiKQogICAqLwogIGZ1bmN0aW9uIGdldFhB
dXRoVG9rZW4oJHVzZXJuYW1lLCAkcGFzc3dvcmQpIHsKICAgICRwYXJhbWV0ZXJzID0gYXJy
YXkoKTsKICAgICRwYXJhbWV0ZXJzWyd4X2F1dGhfdXNlcm5hbWUnXSA9ICR1c2VybmFtZTsK
ICAgICRwYXJhbWV0ZXJzWyd4X2F1dGhfcGFzc3dvcmQnXSA9ICRwYXNzd29yZDsKICAgICRw
YXJhbWV0ZXJzWyd4X2F1dGhfbW9kZSddID0gJ2NsaWVudF9hdXRoJzsKICAgICRyZXF1ZXN0
ID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdGhpcy0+YWNjZXNzVG9rZW5VUkwoKSwgJ1BPU1Qn
LCAkcGFyYW1ldGVycyk7CiAgICAkdG9rZW4gPSBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRl
cnMoJHJlcXVlc3QpOwogICAgJHRoaXMtPnRva2VuID0gbmV3IE9BdXRoQ29uc3VtZXIoJHRv
a2VuWydvYXV0aF90b2tlbiddLCAkdG9rZW5bJ29hdXRoX3Rva2VuX3NlY3JldCddKTsKICAg
IHJldHVybiAkdG9rZW47CiAgfQoKICAvKioKICAgKiBHRVQgd3JhcHBlciBmb3Igb0F1dGhS
ZXF1ZXN0LgogICAqLwogIGZ1bmN0aW9uIGdldCgkdXJsLCAkcGFyYW1ldGVycyA9IGFycmF5
KCkpIHsKICAgICRyZXNwb25zZSA9ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHVybCwgJ0dFVCcs
ICRwYXJhbWV0ZXJzKTsKICAgIGlmICgkdGhpcy0+Zm9ybWF0ID09PSAnanNvbicgJiYgJHRo
aXMtPmRlY29kZV9qc29uKSB7CiAgICAgIHJldHVybiBqc29uX2RlY29kZSgkcmVzcG9uc2Up
OwogICAgfQogICAgcmV0dXJuICRyZXNwb25zZTsKICB9CgogIC8qKgogICAqIFBPU1Qgd3Jh
cHBlciBmb3Igb0F1dGhSZXF1ZXN0LgogICAqLwogIGZ1bmN0aW9uIHBvc3QoJHVybCwgJHBh
cmFtZXRlcnMgPSBhcnJheSgpKSB7CiAgICAkcmVzcG9uc2UgPSAkdGhpcy0+b0F1dGhSZXF1
ZXN0KCR1cmwsICdQT1NUJywgJHBhcmFtZXRlcnMpOwogICAgaWYgKCR0aGlzLT5mb3JtYXQg
PT09ICdqc29uJyAmJiAkdGhpcy0+ZGVjb2RlX2pzb24pIHsKICAgICAgcmV0dXJuIGpzb25f
ZGVjb2RlKCRyZXNwb25zZSk7CiAgICB9CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAg
LyoqCiAgICogREVMRVRFIHdyYXBwZXIgZm9yIG9BdXRoUmVxZXVzdC4KICAgKi8KICBmdW5j
dGlvbiBkZWxldGUoJHVybCwgJHBhcmFtZXRlcnMgPSBhcnJheSgpKSB7CiAgICAkcmVzcG9u
c2UgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR1cmwsICdERUxFVEUnLCAkcGFyYW1ldGVycyk7
CiAgICBpZiAoJHRoaXMtPmZvcm1hdCA9PT0gJ2pzb24nICYmICR0aGlzLT5kZWNvZGVfanNv
bikgewogICAgICByZXR1cm4ganNvbl9kZWNvZGUoJHJlc3BvbnNlKTsKICAgIH0KICAgIHJl
dHVybiAkcmVzcG9uc2U7CiAgfQoKICAvKioKICAgKiBGb3JtYXQgYW5kIHNpZ24gYW4gT0F1
dGggLyBBUEkgcmVxdWVzdAogICAqLwogIGZ1bmN0aW9uIG9BdXRoUmVxdWVzdCgkdXJsLCAk
bWV0aG9kLCAkcGFyYW1ldGVycykgewogICAgaWYgKHN0cnJwb3MoJHVybCwgJ2h0dHBzOi8v
JykgIT09IDAgJiYgc3RycnBvcygkdXJsLCAnaHR0cDovLycpICE9PSAwKSB7CiAgICAgICR1
cmwgPSAieyR0aGlzLT5ob3N0fXskdXJsfS57JHRoaXMtPmZvcm1hdH0iOwogICAgfQogICAg
JHJlcXVlc3QgPSBPQXV0aFJlcXVlc3Q6OmZyb21fY29uc3VtZXJfYW5kX3Rva2VuKCR0aGlz
LT5jb25zdW1lciwgJHRoaXMtPnRva2VuLCAkbWV0aG9kLCAkdXJsLCAkcGFyYW1ldGVycyk7
CiAgICAkcmVxdWVzdC0+c2lnbl9yZXF1ZXN0KCR0aGlzLT5zaGExX21ldGhvZCwgJHRoaXMt
PmNvbnN1bWVyLCAkdGhpcy0+dG9rZW4pOwogICAgc3dpdGNoICgkbWV0aG9kKSB7CiAgICBj
YXNlICdHRVQnOgogICAgICByZXR1cm4gJHRoaXMtPmh0dHAoJHJlcXVlc3QtPnRvX3VybCgp
LCAnR0VUJyk7CiAgICBkZWZhdWx0OgogICAgICByZXR1cm4gJHRoaXMtPmh0dHAoJHJlcXVl
c3QtPmdldF9ub3JtYWxpemVkX2h0dHBfdXJsKCksICRtZXRob2QsICRyZXF1ZXN0LT50b19w
b3N0ZGF0YSgpKTsKICAgIH0KICB9CgogIC8qKgogICAqIE1ha2UgYW4gSFRUUCByZXF1ZXN0
CiAgICoKICAgKiBAcmV0dXJuIEFQSSByZXN1bHRzCiAgICovCiAgZnVuY3Rpb24gaHR0cCgk
dXJsLCAkbWV0aG9kLCAkcG9zdGZpZWxkcyA9IE5VTEwpIHsKICAgICR0aGlzLT5odHRwX2lu
Zm8gPSBhcnJheSgpOwogICAgJGNpID0gY3VybF9pbml0KCk7CiAgICAvKiBDdXJsIHNldHRp
bmdzICovCiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfVVNFUkFHRU5ULCAkdGhpcy0+
dXNlcmFnZW50KTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9DT05ORUNUVElNRU9V
VCwgJHRoaXMtPmNvbm5lY3R0aW1lb3V0KTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9Q
VF9USU1FT1VULCAkdGhpcy0+dGltZW91dCk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxP
UFRfUkVUVVJOVFJBTlNGRVIsIFRSVUUpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BU
X0hUVFBIRUFERVIsIGFycmF5KCdFeHBlY3Q6JykpOwogICAgY3VybF9zZXRvcHQoJGNpLCBD
VVJMT1BUX1NTTF9WRVJJRllQRUVSLCAkdGhpcy0+c3NsX3ZlcmlmeXBlZXIpOwogICAgY3Vy
bF9zZXRvcHQoJGNpLCBDVVJMT1BUX0hFQURFUkZVTkNUSU9OLCBhcnJheSgkdGhpcywgJ2dl
dEhlYWRlcicpKTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9IRUFERVIsIEZBTFNF
KTsKCiAgICBzd2l0Y2ggKCRtZXRob2QpIHsKICAgICAgY2FzZSAnUE9TVCc6CiAgICAgICAg
Y3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1BPU1QsIFRSVUUpOwogICAgICAgIGlmICghZW1w
dHkoJHBvc3RmaWVsZHMpKSB7CiAgICAgICAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRf
UE9TVEZJRUxEUywgJHBvc3RmaWVsZHMpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAg
ICAgY2FzZSAnREVMRVRFJzoKICAgICAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfQ1VT
VE9NUkVRVUVTVCwgJ0RFTEVURScpOwogICAgICAgIGlmICghZW1wdHkoJHBvc3RmaWVsZHMp
KSB7CiAgICAgICAgICAkdXJsID0gInskdXJsfT97JHBvc3RmaWVsZHN9IjsKICAgICAgICB9
CiAgICB9CgogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1VSTCwgJHVybCk7CiAgICAk
cmVzcG9uc2UgPSBjdXJsX2V4ZWMoJGNpKTsKICAgICR0aGlzLT5odHRwX2NvZGUgPSBjdXJs
X2dldGluZm8oJGNpLCBDVVJMSU5GT19IVFRQX0NPREUpOwogICAgJHRoaXMtPmh0dHBfaW5m
byA9IGFycmF5X21lcmdlKCR0aGlzLT5odHRwX2luZm8sIGN1cmxfZ2V0aW5mbygkY2kpKTsK
ICAgICR0aGlzLT51cmwgPSAkdXJsOwogICAgY3VybF9jbG9zZSAoJGNpKTsKICAgIHJldHVy
biAkcmVzcG9uc2U7CiAgfQoKICAvKioKICAgKiBHZXQgdGhlIGhlYWRlciBpbmZvIHRvIHN0
b3JlLgogICAqLwogIGZ1bmN0aW9uIGdldEhlYWRlcigkY2gsICRoZWFkZXIpIHsKICAgICRp
ID0gc3RycG9zKCRoZWFkZXIsICc6Jyk7CiAgICBpZiAoIWVtcHR5KCRpKSkgewogICAgICAk
a2V5ID0gc3RyX3JlcGxhY2UoJy0nLCAnXycsIHN0cnRvbG93ZXIoc3Vic3RyKCRoZWFkZXIs
IDAsICRpKSkpOwogICAgICAkdmFsdWUgPSB0cmltKHN1YnN0cigkaGVhZGVyLCAkaSArIDIp
KTsKICAgICAgJHRoaXMtPmh0dHBfaGVhZGVyWyRrZXldID0gJHZhbHVlOwogICAgfQogICAg
cmV0dXJuIHN0cmxlbigkaGVhZGVyKTsKICB9Cn0KCmNsYXNzIE9BdXRoRXhjZXB0aW9uIGV4
dGVuZHMgRXhjZXB0aW9uIHsKICAvLyBwYXNzCn0KCmNsYXNzIE9BdXRoQ29uc3VtZXIgewog
IHB1YmxpYyAka2V5OwogIHB1YmxpYyAkc2VjcmV0OwoKICBmdW5jdGlvbiBfX2NvbnN0cnVj
dCgka2V5LCAkc2VjcmV0LCAkY2FsbGJhY2tfdXJsPU5VTEwpIHsKICAgICR0aGlzLT5rZXkg
PSAka2V5OwogICAgJHRoaXMtPnNlY3JldCA9ICRzZWNyZXQ7CiAgICAkdGhpcy0+Y2FsbGJh
Y2tfdXJsID0gJGNhbGxiYWNrX3VybDsKICB9CgogIGZ1bmN0aW9uIF9fdG9TdHJpbmcoKSB7
CiAgICByZXR1cm4gIk9BdXRoQ29uc3VtZXJba2V5PSR0aGlzLT5rZXksc2VjcmV0PSR0aGlz
LT5zZWNyZXRdIjsKICB9Cn0KCmNsYXNzIE9BdXRoVG9rZW4gewogIC8vIGFjY2VzcyB0b2tl
bnMgYW5kIHJlcXVlc3QgdG9rZW5zCiAgcHVibGljICRrZXk7CiAgcHVibGljICRzZWNyZXQ7
CgogIC8qKgogICAqIGtleSA9IHRoZSB0b2tlbgogICAqIHNlY3JldCA9IHRoZSB0b2tlbiBz
ZWNyZXQKICAgKi8KICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgka2V5LCAkc2VjcmV0KSB7CiAg
ICAkdGhpcy0+a2V5ID0gJGtleTsKICAgICR0aGlzLT5zZWNyZXQgPSAkc2VjcmV0OwogIH0K
CiAgLyoqCiAgICogZ2VuZXJhdGVzIHRoZSBiYXNpYyBzdHJpbmcgc2VyaWFsaXphdGlvbiBv
ZiBhIHRva2VuIHRoYXQgYSBzZXJ2ZXIKICAgKiB3b3VsZCByZXNwb25kIHRvIHJlcXVlc3Rf
dG9rZW4gYW5kIGFjY2Vzc190b2tlbiBjYWxscyB3aXRoCiAgICovCiAgZnVuY3Rpb24gdG9f
c3RyaW5nKCkgewogICAgcmV0dXJuICJvYXV0aF90b2tlbj0iIC4KICAgICAgICAgICBPQXV0
aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCR0aGlzLT5rZXkpIC4KICAgICAgICAgICAiJm9h
dXRoX3Rva2VuX3NlY3JldD0iIC4KICAgICAgICAgICBPQXV0aFV0aWw6OnVybGVuY29kZV9y
ZmMzOTg2KCR0aGlzLT5zZWNyZXQpOwogIH0KCiAgZnVuY3Rpb24gX190b1N0cmluZygpIHsK
ICAgIHJldHVybiAkdGhpcy0+dG9fc3RyaW5nKCk7CiAgfQp9CgovKioKICogQSBjbGFzcyBm
b3IgaW1wbGVtZW50aW5nIGEgU2lnbmF0dXJlIE1ldGhvZAogKiBTZWUgc2VjdGlvbiA5ICgi
U2lnbmluZyBSZXF1ZXN0cyIpIGluIHRoZSBzcGVjCiAqLwphYnN0cmFjdCBjbGFzcyBPQXV0
aFNpZ25hdHVyZU1ldGhvZCB7CiAgLyoqCiAgICogTmVlZHMgdG8gcmV0dXJuIHRoZSBuYW1l
IG9mIHRoZSBTaWduYXR1cmUgTWV0aG9kIChpZSBITUFDLVNIQTEpCiAgICogQHJldHVybiBz
dHJpbmcKICAgKi8KICBhYnN0cmFjdCBwdWJsaWMgZnVuY3Rpb24gZ2V0X25hbWUoKTsKCiAg
LyoqCiAgICogQnVpbGQgdXAgdGhlIHNpZ25hdHVyZQogICAqIE5PVEU6IFRoZSBvdXRwdXQg
b2YgdGhpcyBmdW5jdGlvbiBNVVNUIE5PVCBiZSB1cmxlbmNvZGVkLgogICAqIHRoZSBlbmNv
ZGluZyBpcyBoYW5kbGVkIGluIE9BdXRoUmVxdWVzdCB3aGVuIHRoZSBmaW5hbAogICAqIHJl
cXVlc3QgaXMgc2VyaWFsaXplZAogICAqIEBwYXJhbSBPQXV0aFJlcXVlc3QgJHJlcXVlc3QK
ICAgKiBAcGFyYW0gT0F1dGhDb25zdW1lciAkY29uc3VtZXIKICAgKiBAcGFyYW0gT0F1dGhU
b2tlbiAkdG9rZW4KICAgKiBAcmV0dXJuIHN0cmluZwogICAqLwogIGFic3RyYWN0IHB1Ymxp
YyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2Vu
KTsKCiAgLyoqCiAgICogVmVyaWZpZXMgdGhhdCBhIGdpdmVuIHNpZ25hdHVyZSBpcyBjb3Jy
ZWN0CiAgICogQHBhcmFtIE9BdXRoUmVxdWVzdCAkcmVxdWVzdAogICAqIEBwYXJhbSBPQXV0
aENvbnN1bWVyICRjb25zdW1lcgogICAqIEBwYXJhbSBPQXV0aFRva2VuICR0b2tlbgogICAq
IEBwYXJhbSBzdHJpbmcgJHNpZ25hdHVyZQogICAqIEByZXR1cm4gYm9vbAogICAqLwogIHB1
YmxpYyBmdW5jdGlvbiBjaGVja19zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRv
a2VuLCAkc2lnbmF0dXJlKSB7CiAgICAkYnVpbHQgPSAkdGhpcy0+YnVpbGRfc2lnbmF0dXJl
KCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7CiAgICByZXR1cm4gJGJ1aWx0ID09ICRz
aWduYXR1cmU7CiAgfQp9CgovKioKICogVGhlIEhNQUMtU0hBMSBzaWduYXR1cmUgbWV0aG9k
IHVzZXMgdGhlIEhNQUMtU0hBMSBzaWduYXR1cmUgYWxnb3JpdGhtIGFzIGRlZmluZWQgaW4g
W1JGQzIxMDRdCiAqIHdoZXJlIHRoZSBTaWduYXR1cmUgQmFzZSBTdHJpbmcgaXMgdGhlIHRl
eHQgYW5kIHRoZSBrZXkgaXMgdGhlIGNvbmNhdGVuYXRlZCB2YWx1ZXMgKGVhY2ggZmlyc3QK
ICogZW5jb2RlZCBwZXIgUGFyYW1ldGVyIEVuY29kaW5nKSBvZiB0aGUgQ29uc3VtZXIgU2Vj
cmV0IGFuZCBUb2tlbiBTZWNyZXQsIHNlcGFyYXRlZCBieSBhbiAnJicKICogY2hhcmFjdGVy
IChBU0NJSSBjb2RlIDM4KSBldmVuIGlmIGVtcHR5LgogKiAgIC0gQ2hhcHRlciA5LjIgKCJI
TUFDLVNIQTEiKQogKi8KY2xhc3MgT0F1dGhTaWduYXR1cmVNZXRob2RfSE1BQ19TSEExIGV4
dGVuZHMgT0F1dGhTaWduYXR1cmVNZXRob2QgewogIGZ1bmN0aW9uIGdldF9uYW1lKCkgewog
ICAgcmV0dXJuICJITUFDLVNIQTEiOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGJ1aWxkX3Np
Z25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pIHsKICAgICRiYXNlX3N0cmlu
ZyA9ICRyZXF1ZXN0LT5nZXRfc2lnbmF0dXJlX2Jhc2Vfc3RyaW5nKCk7CiAgICAkcmVxdWVz
dC0+YmFzZV9zdHJpbmcgPSAkYmFzZV9zdHJpbmc7CgogICAgJGtleV9wYXJ0cyA9IGFycmF5
KAogICAgICAkY29uc3VtZXItPnNlY3JldCwKICAgICAgKCR0b2tlbikgPyAkdG9rZW4tPnNl
Y3JldCA6ICIiCiAgICApOwoKICAgICRrZXlfcGFydHMgPSBPQXV0aFV0aWw6OnVybGVuY29k
ZV9yZmMzOTg2KCRrZXlfcGFydHMpOwogICAgJGtleSA9IGltcGxvZGUoJyYnLCAka2V5X3Bh
cnRzKTsKCiAgICByZXR1cm4gYmFzZTY0X2VuY29kZShoYXNoX2htYWMoJ3NoYTEnLCAkYmFz
ZV9zdHJpbmcsICRrZXksIHRydWUpKTsKICB9Cn0KCi8qKgogKiBUaGUgUExBSU5URVhUIG1l
dGhvZCBkb2VzIG5vdCBwcm92aWRlIGFueSBzZWN1cml0eSBwcm90ZWN0aW9uIGFuZCBTSE9V
TEQgb25seSBiZSB1c2VkCiAqIG92ZXIgYSBzZWN1cmUgY2hhbm5lbCBzdWNoIGFzIEhUVFBT
LiBJdCBkb2VzIG5vdCB1c2UgdGhlIFNpZ25hdHVyZSBCYXNlIFN0cmluZy4KICogICAtIENo
YXB0ZXIgOS40ICgiUExBSU5URVhUIikKICovCmNsYXNzIE9BdXRoU2lnbmF0dXJlTWV0aG9k
X1BMQUlOVEVYVCBleHRlbmRzIE9BdXRoU2lnbmF0dXJlTWV0aG9kIHsKICBwdWJsaWMgZnVu
Y3Rpb24gZ2V0X25hbWUoKSB7CiAgICByZXR1cm4gIlBMQUlOVEVYVCI7CiAgfQoKICAvKioK
ICAgKiBvYXV0aF9zaWduYXR1cmUgaXMgc2V0IHRvIHRoZSBjb25jYXRlbmF0ZWQgZW5jb2Rl
ZCB2YWx1ZXMgb2YgdGhlIENvbnN1bWVyIFNlY3JldCBhbmQKICAgKiBUb2tlbiBTZWNyZXQs
IHNlcGFyYXRlZCBieSBhICcmJyBjaGFyYWN0ZXIgKEFTQ0lJIGNvZGUgMzgpLCBldmVuIGlm
IGVpdGhlciBzZWNyZXQgaXMKICAgKiBlbXB0eS4gVGhlIHJlc3VsdCBNVVNUIGJlIGVuY29k
ZWQgYWdhaW4uCiAgICogICAtIENoYXB0ZXIgOS40LjEgKCJHZW5lcmF0aW5nIFNpZ25hdHVy
ZXMiKQogICAqCiAgICogUGxlYXNlIG5vdGUgdGhhdCB0aGUgc2Vjb25kIGVuY29kaW5nIE1V
U1QgTk9UIGhhcHBlbiBpbiB0aGUgU2lnbmF0dXJlTWV0aG9kLCBhcwogICAqIE9BdXRoUmVx
dWVzdCBoYW5kbGVzIHRoaXMhCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25h
dHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pIHsKICAgICRrZXlfcGFydHMgPSBh
cnJheSgKICAgICAgJGNvbnN1bWVyLT5zZWNyZXQsCiAgICAgICgkdG9rZW4pID8gJHRva2Vu
LT5zZWNyZXQgOiAiIgogICAgKTsKCiAgICAka2V5X3BhcnRzID0gT0F1dGhVdGlsOjp1cmxl
bmNvZGVfcmZjMzk4Nigka2V5X3BhcnRzKTsKICAgICRrZXkgPSBpbXBsb2RlKCcmJywgJGtl
eV9wYXJ0cyk7CiAgICAkcmVxdWVzdC0+YmFzZV9zdHJpbmcgPSAka2V5OwoKICAgIHJldHVy
biAka2V5OwogIH0KfQoKLyoqCiAqIFRoZSBSU0EtU0hBMSBzaWduYXR1cmUgbWV0aG9kIHVz
ZXMgdGhlIFJTQVNTQS1QS0NTMS12MV81IHNpZ25hdHVyZSBhbGdvcml0aG0gYXMgZGVmaW5l
ZCBpbgogKiBbUkZDMzQ0N10gc2VjdGlvbiA4LjIgKG1vcmUgc2ltcGx5IGtub3duIGFzIFBL
Q1MjMSksIHVzaW5nIFNIQS0xIGFzIHRoZSBoYXNoIGZ1bmN0aW9uIGZvcgogKiBFTVNBLVBL
Q1MxLXYxXzUuIEl0IGlzIGFzc3VtZWQgdGhhdCB0aGUgQ29uc3VtZXIgaGFzIHByb3ZpZGVk
IGl0cyBSU0EgcHVibGljIGtleSBpbiBhCiAqIHZlcmlmaWVkIHdheSB0byB0aGUgU2Vydmlj
ZSBQcm92aWRlciwgaW4gYSBtYW5uZXIgd2hpY2ggaXMgYmV5b25kIHRoZSBzY29wZSBvZiB0
aGlzCiAqIHNwZWNpZmljYXRpb24uCiAqICAgLSBDaGFwdGVyIDkuMyAoIlJTQS1TSEExIikK
ICovCmFic3RyYWN0IGNsYXNzIE9BdXRoU2lnbmF0dXJlTWV0aG9kX1JTQV9TSEExIGV4dGVu
ZHMgT0F1dGhTaWduYXR1cmVNZXRob2QgewogIHB1YmxpYyBmdW5jdGlvbiBnZXRfbmFtZSgp
IHsKICAgIHJldHVybiAiUlNBLVNIQTEiOwogIH0KCiAgLy8gVXAgdG8gdGhlIFNQIHRvIGlt
cGxlbWVudCB0aGlzIGxvb2t1cCBvZiBrZXlzLiBQb3NzaWJsZSBpZGVhcyBhcmU6CiAgLy8g
KDEpIGRvIGEgbG9va3VwIGluIGEgdGFibGUgb2YgdHJ1c3RlZCBjZXJ0cyBrZXllZCBvZmYg
b2YgY29uc3VtZXIKICAvLyAoMikgZmV0Y2ggdmlhIGh0dHAgdXNpbmcgYSB1cmwgcHJvdmlk
ZWQgYnkgdGhlIHJlcXVlc3RlcgogIC8vICgzKSBzb21lIHNvcnQgb2Ygc3BlY2lmaWMgZGlz
Y292ZXJ5IGNvZGUgYmFzZWQgb24gcmVxdWVzdAogIC8vCiAgLy8gRWl0aGVyIHdheSBzaG91
bGQgcmV0dXJuIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBjZXJ0aWZpY2F0ZQog
IHByb3RlY3RlZCBhYnN0cmFjdCBmdW5jdGlvbiBmZXRjaF9wdWJsaWNfY2VydCgmJHJlcXVl
c3QpOwoKICAvLyBVcCB0byB0aGUgU1AgdG8gaW1wbGVtZW50IHRoaXMgbG9va3VwIG9mIGtl
eXMuIFBvc3NpYmxlIGlkZWFzIGFyZToKICAvLyAoMSkgZG8gYSBsb29rdXAgaW4gYSB0YWJs
ZSBvZiB0cnVzdGVkIGNlcnRzIGtleWVkIG9mZiBvZiBjb25zdW1lcgogIC8vCiAgLy8gRWl0
aGVyIHdheSBzaG91bGQgcmV0dXJuIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBj
ZXJ0aWZpY2F0ZQogIHByb3RlY3RlZCBhYnN0cmFjdCBmdW5jdGlvbiBmZXRjaF9wcml2YXRl
X2NlcnQoJiRyZXF1ZXN0KTsKCiAgcHVibGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25hdHVyZSgk
cmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pIHsKICAgICRiYXNlX3N0cmluZyA9ICRyZXF1
ZXN0LT5nZXRfc2lnbmF0dXJlX2Jhc2Vfc3RyaW5nKCk7CiAgICAkcmVxdWVzdC0+YmFzZV9z
dHJpbmcgPSAkYmFzZV9zdHJpbmc7CgogICAgLy8gRmV0Y2ggdGhlIHByaXZhdGUga2V5IGNl
cnQgYmFzZWQgb24gdGhlIHJlcXVlc3QKICAgICRjZXJ0ID0gJHRoaXMtPmZldGNoX3ByaXZh
dGVfY2VydCgkcmVxdWVzdCk7CgogICAgLy8gUHVsbCB0aGUgcHJpdmF0ZSBrZXkgSUQgZnJv
bSB0aGUgY2VydGlmaWNhdGUKICAgICRwcml2YXRla2V5aWQgPSBvcGVuc3NsX2dldF9wcml2
YXRla2V5KCRjZXJ0KTsKCiAgICAvLyBTaWduIHVzaW5nIHRoZSBrZXkKICAgICRvayA9IG9w
ZW5zc2xfc2lnbigkYmFzZV9zdHJpbmcsICRzaWduYXR1cmUsICRwcml2YXRla2V5aWQpOwoK
ICAgIC8vIFJlbGVhc2UgdGhlIGtleSByZXNvdXJjZQogICAgb3BlbnNzbF9mcmVlX2tleSgk
cHJpdmF0ZWtleWlkKTsKCiAgICByZXR1cm4gYmFzZTY0X2VuY29kZSgkc2lnbmF0dXJlKTsK
ICB9CgogIHB1YmxpYyBmdW5jdGlvbiBjaGVja19zaWduYXR1cmUoJHJlcXVlc3QsICRjb25z
dW1lciwgJHRva2VuLCAkc2lnbmF0dXJlKSB7CiAgICAkZGVjb2RlZF9zaWcgPSBiYXNlNjRf
ZGVjb2RlKCRzaWduYXR1cmUpOwoKICAgICRiYXNlX3N0cmluZyA9ICRyZXF1ZXN0LT5nZXRf
c2lnbmF0dXJlX2Jhc2Vfc3RyaW5nKCk7CgogICAgLy8gRmV0Y2ggdGhlIHB1YmxpYyBrZXkg
Y2VydCBiYXNlZCBvbiB0aGUgcmVxdWVzdAogICAgJGNlcnQgPSAkdGhpcy0+ZmV0Y2hfcHVi
bGljX2NlcnQoJHJlcXVlc3QpOwoKICAgIC8vIFB1bGwgdGhlIHB1YmxpYyBrZXkgSUQgZnJv
bSB0aGUgY2VydGlmaWNhdGUKICAgICRwdWJsaWNrZXlpZCA9IG9wZW5zc2xfZ2V0X3B1Ymxp
Y2tleSgkY2VydCk7CgogICAgLy8gQ2hlY2sgdGhlIGNvbXB1dGVkIHNpZ25hdHVyZSBhZ2Fp
bnN0IHRoZSBvbmUgcGFzc2VkIGluIHRoZSBxdWVyeQogICAgJG9rID0gb3BlbnNzbF92ZXJp
ZnkoJGJhc2Vfc3RyaW5nLCAkZGVjb2RlZF9zaWcsICRwdWJsaWNrZXlpZCk7CgogICAgLy8g
UmVsZWFzZSB0aGUga2V5IHJlc291cmNlCiAgICBvcGVuc3NsX2ZyZWVfa2V5KCRwdWJsaWNr
ZXlpZCk7CgogICAgcmV0dXJuICRvayA9PSAxOwogIH0KfQoKY2xhc3MgT0F1dGhSZXF1ZXN0
IHsKICBwcml2YXRlICRwYXJhbWV0ZXJzOwogIHByaXZhdGUgJGh0dHBfbWV0aG9kOwogIHBy
aXZhdGUgJGh0dHBfdXJsOwogIC8vIGZvciBkZWJ1ZyBwdXJwb3NlcwogIHB1YmxpYyAkYmFz
ZV9zdHJpbmc7CiAgcHVibGljIHN0YXRpYyAkdmVyc2lvbiA9ICcxLjAnOwogIHB1YmxpYyBz
dGF0aWMgJFBPU1RfSU5QVVQgPSAncGhwOi8vaW5wdXQnOwoKICBmdW5jdGlvbiBfX2NvbnN0
cnVjdCgkaHR0cF9tZXRob2QsICRodHRwX3VybCwgJHBhcmFtZXRlcnM9TlVMTCkgewogICAg
QCRwYXJhbWV0ZXJzIG9yICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgICRwYXJhbWV0ZXJz
ID0gYXJyYXlfbWVyZ2UoIE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycyhwYXJzZV91cmwo
JGh0dHBfdXJsLCBQSFBfVVJMX1FVRVJZKSksICRwYXJhbWV0ZXJzKTsKICAgICR0aGlzLT5w
YXJhbWV0ZXJzID0gJHBhcmFtZXRlcnM7CiAgICAkdGhpcy0+aHR0cF9tZXRob2QgPSAkaHR0
cF9tZXRob2Q7CiAgICAkdGhpcy0+aHR0cF91cmwgPSAkaHR0cF91cmw7CiAgfQoKCiAgLyoq
CiAgICogYXR0ZW1wdCB0byBidWlsZCB1cCBhIHJlcXVlc3QgZnJvbSB3aGF0IHdhcyBwYXNz
ZWQgdG8gdGhlIHNlcnZlcgogICAqLwogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZnJvbV9y
ZXF1ZXN0KCRodHRwX21ldGhvZD1OVUxMLCAkaHR0cF91cmw9TlVMTCwgJHBhcmFtZXRlcnM9
TlVMTCkgewogICAgJHNjaGVtZSA9ICghaXNzZXQoJF9TRVJWRVJbJ0hUVFBTJ10pIHx8ICRf
U0VSVkVSWydIVFRQUyddICE9ICJvbiIpCiAgICAgICAgICAgICAgPyAnaHR0cCcKICAgICAg
ICAgICAgICA6ICdodHRwcyc7CiAgICBAJGh0dHBfdXJsIG9yICRodHRwX3VybCA9ICRzY2hl
bWUgLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnOi8vJyAuICRfU0VSVkVSWydI
VFRQX0hPU1QnXSAuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc6JyAuCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICRfU0VSVkVSWydTRVJWRVJfUE9SVCddIC4KICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ107CiAg
ICBAJGh0dHBfbWV0aG9kIG9yICRodHRwX21ldGhvZCA9ICRfU0VSVkVSWydSRVFVRVNUX01F
VEhPRCddOwoKICAgIC8vIFdlIHdlcmVuJ3QgaGFuZGVkIGFueSBwYXJhbWV0ZXJzLCBzbyBs
ZXQncyBmaW5kIHRoZSBvbmVzIHJlbGV2YW50IHRvCiAgICAvLyB0aGlzIHJlcXVlc3QuCiAg
ICAvLyBJZiB5b3UgcnVuIFhNTC1SUEMgb3Igc2ltaWxhciB5b3Ugc2hvdWxkIHVzZSB0aGlz
IHRvIHByb3ZpZGUgeW91ciBvd24KICAgIC8vIHBhcnNlZCBwYXJhbWV0ZXItbGlzdAogICAg
aWYgKCEkcGFyYW1ldGVycykgewogICAgICAvLyBGaW5kIHJlcXVlc3QgaGVhZGVycwogICAg
ICAkcmVxdWVzdF9oZWFkZXJzID0gT0F1dGhVdGlsOjpnZXRfaGVhZGVycygpOwoKICAgICAg
Ly8gUGFyc2UgdGhlIHF1ZXJ5LXN0cmluZyB0byBmaW5kIEdFVCBwYXJhbWV0ZXJzCiAgICAg
ICRwYXJhbWV0ZXJzID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKCRfU0VSVkVSWydR
VUVSWV9TVFJJTkcnXSk7CgogICAgICAvLyBJdCdzIGEgUE9TVCByZXF1ZXN0IG9mIHRoZSBw
cm9wZXIgY29udGVudC10eXBlLCBzbyBwYXJzZSBQT1NUCiAgICAgIC8vIHBhcmFtZXRlcnMg
YW5kIGFkZCB0aG9zZSBvdmVycmlkaW5nIGFueSBkdXBsaWNhdGVzIGZyb20gR0VUCiAgICAg
IGlmICgkaHR0cF9tZXRob2QgPT0gIlBPU1QiCiAgICAgICAgICAmJiBAc3Ryc3RyKCRyZXF1
ZXN0X2hlYWRlcnNbIkNvbnRlbnQtVHlwZSJdLAogICAgICAgICAgICAgICAgICAgICAiYXBw
bGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIikKICAgICAgICAgICkgewogICAgICAg
ICRwb3N0X2RhdGEgPSBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMoCiAgICAgICAgICBm
aWxlX2dldF9jb250ZW50cyhzZWxmOjokUE9TVF9JTlBVVCkKICAgICAgICApOwogICAgICAg
ICRwYXJhbWV0ZXJzID0gYXJyYXlfbWVyZ2UoJHBhcmFtZXRlcnMsICRwb3N0X2RhdGEpOwog
ICAgICB9CgogICAgICAvLyBXZSBoYXZlIGEgQXV0aG9yaXphdGlvbi1oZWFkZXIgd2l0aCBP
QXV0aCBkYXRhLiBQYXJzZSB0aGUgaGVhZGVyCiAgICAgIC8vIGFuZCBhZGQgdGhvc2Ugb3Zl
cnJpZGluZyBhbnkgZHVwbGljYXRlcyBmcm9tIEdFVCBvciBQT1NUCiAgICAgIGlmIChAc3Vi
c3RyKCRyZXF1ZXN0X2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSwgMCwgNikgPT0gIk9BdXRo
ICIpIHsKICAgICAgICAkaGVhZGVyX3BhcmFtZXRlcnMgPSBPQXV0aFV0aWw6OnNwbGl0X2hl
YWRlcigKICAgICAgICAgICRyZXF1ZXN0X2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXQogICAg
ICAgICk7CiAgICAgICAgJHBhcmFtZXRlcnMgPSBhcnJheV9tZXJnZSgkcGFyYW1ldGVycywg
JGhlYWRlcl9wYXJhbWV0ZXJzKTsKICAgICAgfQoKICAgIH0KCiAgICByZXR1cm4gbmV3IE9B
dXRoUmVxdWVzdCgkaHR0cF9tZXRob2QsICRodHRwX3VybCwgJHBhcmFtZXRlcnMpOwogIH0K
CiAgLyoqCiAgICogcHJldHR5IG11Y2ggYSBoZWxwZXIgZnVuY3Rpb24gdG8gc2V0IHVwIHRo
ZSByZXF1ZXN0CiAgICovCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBmcm9tX2NvbnN1bWVy
X2FuZF90b2tlbigkY29uc3VtZXIsICR0b2tlbiwgJGh0dHBfbWV0aG9kLCAkaHR0cF91cmws
ICRwYXJhbWV0ZXJzPU5VTEwpIHsKICAgIEAkcGFyYW1ldGVycyBvciAkcGFyYW1ldGVycyA9
IGFycmF5KCk7CiAgICAkZGVmYXVsdHMgPSBhcnJheSgib2F1dGhfdmVyc2lvbiIgPT4gT0F1
dGhSZXF1ZXN0OjokdmVyc2lvbiwKICAgICAgICAgICAgICAgICAgICAgICJvYXV0aF9ub25j
ZSIgPT4gT0F1dGhSZXF1ZXN0OjpnZW5lcmF0ZV9ub25jZSgpLAogICAgICAgICAgICAgICAg
ICAgICAgIm9hdXRoX3RpbWVzdGFtcCIgPT4gT0F1dGhSZXF1ZXN0OjpnZW5lcmF0ZV90aW1l
c3RhbXAoKSwKICAgICAgICAgICAgICAgICAgICAgICJvYXV0aF9jb25zdW1lcl9rZXkiID0+
ICRjb25zdW1lci0+a2V5KTsKICAgIGlmICgkdG9rZW4pCiAgICAgICRkZWZhdWx0c1snb2F1
dGhfdG9rZW4nXSA9ICR0b2tlbi0+a2V5OwoKICAgICRwYXJhbWV0ZXJzID0gYXJyYXlfbWVy
Z2UoJGRlZmF1bHRzLCAkcGFyYW1ldGVycyk7CgogICAgcmV0dXJuIG5ldyBPQXV0aFJlcXVl
c3QoJGh0dHBfbWV0aG9kLCAkaHR0cF91cmwsICRwYXJhbWV0ZXJzKTsKICB9CgogIHB1Ymxp
YyBmdW5jdGlvbiBzZXRfcGFyYW1ldGVyKCRuYW1lLCAkdmFsdWUsICRhbGxvd19kdXBsaWNh
dGVzID0gdHJ1ZSkgewogICAgaWYgKCRhbGxvd19kdXBsaWNhdGVzICYmIGlzc2V0KCR0aGlz
LT5wYXJhbWV0ZXJzWyRuYW1lXSkpIHsKICAgICAgLy8gV2UgaGF2ZSBhbHJlYWR5IGFkZGVk
IHBhcmFtZXRlcihzKSB3aXRoIHRoaXMgbmFtZSwgc28gYWRkIHRvIHRoZSBsaXN0CiAgICAg
IGlmIChpc19zY2FsYXIoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdKSkgewogICAgICAgIC8v
IFRoaXMgaXMgdGhlIGZpcnN0IGR1cGxpY2F0ZSwgc28gdHJhbnNmb3JtIHNjYWxhciAoc3Ry
aW5nKQogICAgICAgIC8vIGludG8gYW4gYXJyYXkgc28gd2UgY2FuIGFkZCB0aGUgZHVwbGlj
YXRlcwogICAgICAgICR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSA9IGFycmF5KCR0aGlzLT5w
YXJhbWV0ZXJzWyRuYW1lXSk7CiAgICAgIH0KCiAgICAgICR0aGlzLT5wYXJhbWV0ZXJzWyRu
YW1lXVtdID0gJHZhbHVlOwogICAgfSBlbHNlIHsKICAgICAgJHRoaXMtPnBhcmFtZXRlcnNb
JG5hbWVdID0gJHZhbHVlOwogICAgfQogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGdldF9wYXJh
bWV0ZXIoJG5hbWUpIHsKICAgIHJldHVybiBpc3NldCgkdGhpcy0+cGFyYW1ldGVyc1skbmFt
ZV0pID8gJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdIDogbnVsbDsKICB9CgogIHB1YmxpYyBm
dW5jdGlvbiBnZXRfcGFyYW1ldGVycygpIHsKICAgIHJldHVybiAkdGhpcy0+cGFyYW1ldGVy
czsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiB1bnNldF9wYXJhbWV0ZXIoJG5hbWUpIHsKICAg
IHVuc2V0KCR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSk7CiAgfQoKICAvKioKICAgKiBUaGUg
cmVxdWVzdCBwYXJhbWV0ZXJzLCBzb3J0ZWQgYW5kIGNvbmNhdGVuYXRlZCBpbnRvIGEgbm9y
bWFsaXplZCBzdHJpbmcuCiAgICogQHJldHVybiBzdHJpbmcKICAgKi8KICBwdWJsaWMgZnVu
Y3Rpb24gZ2V0X3NpZ25hYmxlX3BhcmFtZXRlcnMoKSB7CiAgICAvLyBHcmFiIGFsbCBwYXJh
bWV0ZXJzCiAgICAkcGFyYW1zID0gJHRoaXMtPnBhcmFtZXRlcnM7CgogICAgLy8gUmVtb3Zl
IG9hdXRoX3NpZ25hdHVyZSBpZiBwcmVzZW50CiAgICAvLyBSZWY6IFNwZWM6IDkuMS4xICgi
VGhlIG9hdXRoX3NpZ25hdHVyZSBwYXJhbWV0ZXIgTVVTVCBiZSBleGNsdWRlZC4iKQogICAg
aWYgKGlzc2V0KCRwYXJhbXNbJ29hdXRoX3NpZ25hdHVyZSddKSkgewogICAgICB1bnNldCgk
cGFyYW1zWydvYXV0aF9zaWduYXR1cmUnXSk7CiAgICB9CgogICAgcmV0dXJuIE9BdXRoVXRp
bDo6YnVpbGRfaHR0cF9xdWVyeSgkcGFyYW1zKTsKICB9CgogIC8qKgogICAqIFJldHVybnMg
dGhlIGJhc2Ugc3RyaW5nIG9mIHRoaXMgcmVxdWVzdAogICAqCiAgICogVGhlIGJhc2Ugc3Ry
aW5nIGRlZmluZWQgYXMgdGhlIG1ldGhvZCwgdGhlIHVybAogICAqIGFuZCB0aGUgcGFyYW1l
dGVycyAobm9ybWFsaXplZCksIGVhY2ggdXJsZW5jb2RlZAogICAqIGFuZCB0aGUgY29uY2F0
ZWQgd2l0aCAmLgogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBnZXRfc2lnbmF0dXJlX2Jhc2Vf
c3RyaW5nKCkgewogICAgJHBhcnRzID0gYXJyYXkoCiAgICAgICR0aGlzLT5nZXRfbm9ybWFs
aXplZF9odHRwX21ldGhvZCgpLAogICAgICAkdGhpcy0+Z2V0X25vcm1hbGl6ZWRfaHR0cF91
cmwoKSwKICAgICAgJHRoaXMtPmdldF9zaWduYWJsZV9wYXJhbWV0ZXJzKCkKICAgICk7Cgog
ICAgJHBhcnRzID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkcGFydHMpOwoKICAg
IHJldHVybiBpbXBsb2RlKCcmJywgJHBhcnRzKTsKICB9CgogIC8qKgogICAqIGp1c3QgdXBw
ZXJjYXNlcyB0aGUgaHR0cCBtZXRob2QKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZ2V0X25v
cm1hbGl6ZWRfaHR0cF9tZXRob2QoKSB7CiAgICByZXR1cm4gc3RydG91cHBlcigkdGhpcy0+
aHR0cF9tZXRob2QpOwogIH0KCiAgLyoqCiAgICogcGFyc2VzIHRoZSB1cmwgYW5kIHJlYnVp
bGRzIGl0IHRvIGJlCiAgICogc2NoZW1lOi8vaG9zdC9wYXRoCiAgICovCiAgcHVibGljIGZ1
bmN0aW9uIGdldF9ub3JtYWxpemVkX2h0dHBfdXJsKCkgewogICAgJHBhcnRzID0gcGFyc2Vf
dXJsKCR0aGlzLT5odHRwX3VybCk7CgogICAgJHBvcnQgPSBAJHBhcnRzWydwb3J0J107CiAg
ICAkc2NoZW1lID0gJHBhcnRzWydzY2hlbWUnXTsKICAgICRob3N0ID0gJHBhcnRzWydob3N0
J107CiAgICAkcGF0aCA9IEAkcGFydHNbJ3BhdGgnXTsKCiAgICAkcG9ydCBvciAkcG9ydCA9
ICgkc2NoZW1lID09ICdodHRwcycpID8gJzQ0MycgOiAnODAnOwoKICAgIGlmICgoJHNjaGVt
ZSA9PSAnaHR0cHMnICYmICRwb3J0ICE9ICc0NDMnKQogICAgICAgIHx8ICgkc2NoZW1lID09
ICdodHRwJyAmJiAkcG9ydCAhPSAnODAnKSkgewogICAgICAkaG9zdCA9ICIkaG9zdDokcG9y
dCI7CiAgICB9CiAgICByZXR1cm4gIiRzY2hlbWU6Ly8kaG9zdCRwYXRoIjsKICB9CgogIC8q
KgogICAqIGJ1aWxkcyBhIHVybCB1c2FibGUgZm9yIGEgR0VUIHJlcXVlc3QKICAgKi8KICBw
dWJsaWMgZnVuY3Rpb24gdG9fdXJsKCkgewogICAgJHBvc3RfZGF0YSA9ICR0aGlzLT50b19w
b3N0ZGF0YSgpOwogICAgJG91dCA9ICR0aGlzLT5nZXRfbm9ybWFsaXplZF9odHRwX3VybCgp
OwogICAgaWYgKCRwb3N0X2RhdGEpIHsKICAgICAgJG91dCAuPSAnPycuJHBvc3RfZGF0YTsK
ICAgIH0KICAgIHJldHVybiAkb3V0OwogIH0KCiAgLyoqCiAgICogYnVpbGRzIHRoZSBkYXRh
IG9uZSB3b3VsZCBzZW5kIGluIGEgUE9TVCByZXF1ZXN0CiAgICovCiAgcHVibGljIGZ1bmN0
aW9uIHRvX3Bvc3RkYXRhKCkgewogICAgcmV0dXJuIE9BdXRoVXRpbDo6YnVpbGRfaHR0cF9x
dWVyeSgkdGhpcy0+cGFyYW1ldGVycyk7CiAgfQoKICAvKioKICAgKiBidWlsZHMgdGhlIEF1
dGhvcml6YXRpb246IGhlYWRlcgogICAqLwogIHB1YmxpYyBmdW5jdGlvbiB0b19oZWFkZXIo
JHJlYWxtPW51bGwpIHsKICAgICRmaXJzdCA9IHRydWU7CiAgaWYoJHJlYWxtKSB7CiAgICAg
ICRvdXQgPSAnQXV0aG9yaXphdGlvbjogT0F1dGggcmVhbG09IicgLiBPQXV0aFV0aWw6OnVy
bGVuY29kZV9yZmMzOTg2KCRyZWFsbSkgLiAnIic7CiAgICAgICRmaXJzdCA9IGZhbHNlOwog
ICAgfSBlbHNlCiAgICAgICRvdXQgPSAnQXV0aG9yaXphdGlvbjogT0F1dGgnOwoKICAgICR0
b3RhbCA9IGFycmF5KCk7CiAgICBmb3JlYWNoICgkdGhpcy0+cGFyYW1ldGVycyBhcyAkayA9
PiAkdikgewogICAgICBpZiAoc3Vic3RyKCRrLCAwLCA1KSAhPSAib2F1dGgiKSBjb250aW51
ZTsKICAgICAgaWYgKGlzX2FycmF5KCR2KSkgewogICAgICAgIHRocm93IG5ldyBPQXV0aEV4
Y2VwdGlvbignQXJyYXlzIG5vdCBzdXBwb3J0ZWQgaW4gaGVhZGVycycpOwogICAgICB9CiAg
ICAgICRvdXQgLj0gKCRmaXJzdCkgPyAnICcgOiAnLCc7CiAgICAgICRvdXQgLj0gT0F1dGhV
dGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkaykgLgogICAgICAgICAgICAgICc9IicgLgogICAg
ICAgICAgICAgIE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJHYpIC4KICAgICAgICAg
ICAgICAnIic7CiAgICAgICRmaXJzdCA9IGZhbHNlOwogICAgfQogICAgcmV0dXJuICRvdXQ7
CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gX190b1N0cmluZygpIHsKICAgIHJldHVybiAkdGhp
cy0+dG9fdXJsKCk7CiAgfQoKCiAgcHVibGljIGZ1bmN0aW9uIHNpZ25fcmVxdWVzdCgkc2ln
bmF0dXJlX21ldGhvZCwgJGNvbnN1bWVyLCAkdG9rZW4pIHsKICAgICR0aGlzLT5zZXRfcGFy
YW1ldGVyKAogICAgICAib2F1dGhfc2lnbmF0dXJlX21ldGhvZCIsCiAgICAgICRzaWduYXR1
cmVfbWV0aG9kLT5nZXRfbmFtZSgpLAogICAgICBmYWxzZQogICAgKTsKICAgICRzaWduYXR1
cmUgPSAkdGhpcy0+YnVpbGRfc2lnbmF0dXJlKCRzaWduYXR1cmVfbWV0aG9kLCAkY29uc3Vt
ZXIsICR0b2tlbik7CiAgICAkdGhpcy0+c2V0X3BhcmFtZXRlcigib2F1dGhfc2lnbmF0dXJl
IiwgJHNpZ25hdHVyZSwgZmFsc2UpOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGJ1aWxkX3Np
Z25hdHVyZSgkc2lnbmF0dXJlX21ldGhvZCwgJGNvbnN1bWVyLCAkdG9rZW4pIHsKICAgICRz
aWduYXR1cmUgPSAkc2lnbmF0dXJlX21ldGhvZC0+YnVpbGRfc2lnbmF0dXJlKCR0aGlzLCAk
Y29uc3VtZXIsICR0b2tlbik7CiAgICByZXR1cm4gJHNpZ25hdHVyZTsKICB9CgogIC8qKgog
ICAqIHV0aWwgZnVuY3Rpb246IGN1cnJlbnQgdGltZXN0YW1wCiAgICovCiAgcHJpdmF0ZSBz
dGF0aWMgZnVuY3Rpb24gZ2VuZXJhdGVfdGltZXN0YW1wKCkgewogICAgcmV0dXJuIHRpbWUo
KTsKICB9CgogIC8qKgogICAqIHV0aWwgZnVuY3Rpb246IGN1cnJlbnQgbm9uY2UKICAgKi8K
ICBwcml2YXRlIHN0YXRpYyBmdW5jdGlvbiBnZW5lcmF0ZV9ub25jZSgpIHsKICAgICRtdCA9
IG1pY3JvdGltZSgpOwogICAgJHJhbmQgPSBtdF9yYW5kKCk7CgogICAgcmV0dXJuIG1kNSgk
bXQgLiAkcmFuZCk7IC8vIG1kNXMgbG9vayBuaWNlciB0aGFuIG51bWJlcnMKICB9Cn0KCmNs
YXNzIE9BdXRoU2VydmVyIHsKICBwcm90ZWN0ZWQgJHRpbWVzdGFtcF90aHJlc2hvbGQgPSAz
MDA7IC8vIGluIHNlY29uZHMsIGZpdmUgbWludXRlcwogIHByb3RlY3RlZCAkdmVyc2lvbiA9
ICcxLjAnOyAgICAgICAgICAgICAvLyBoaSBibGFpbmUKICBwcm90ZWN0ZWQgJHNpZ25hdHVy
ZV9tZXRob2RzID0gYXJyYXkoKTsKCiAgcHJvdGVjdGVkICRkYXRhX3N0b3JlOwoKICBmdW5j
dGlvbiBfX2NvbnN0cnVjdCgkZGF0YV9zdG9yZSkgewogICAgJHRoaXMtPmRhdGFfc3RvcmUg
PSAkZGF0YV9zdG9yZTsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBhZGRfc2lnbmF0dXJlX21l
dGhvZCgkc2lnbmF0dXJlX21ldGhvZCkgewogICAgJHRoaXMtPnNpZ25hdHVyZV9tZXRob2Rz
WyRzaWduYXR1cmVfbWV0aG9kLT5nZXRfbmFtZSgpXSA9CiAgICAgICRzaWduYXR1cmVfbWV0
aG9kOwogIH0KCiAgLy8gaGlnaCBsZXZlbCBmdW5jdGlvbnMKCiAgLyoqCiAgICogcHJvY2Vz
cyBhIHJlcXVlc3RfdG9rZW4gcmVxdWVzdAogICAqIHJldHVybnMgdGhlIHJlcXVlc3QgdG9r
ZW4gb24gc3VjY2VzcwogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBmZXRjaF9yZXF1ZXN0X3Rv
a2VuKCYkcmVxdWVzdCkgewogICAgJHRoaXMtPmdldF92ZXJzaW9uKCRyZXF1ZXN0KTsKCiAg
ICAkY29uc3VtZXIgPSAkdGhpcy0+Z2V0X2NvbnN1bWVyKCRyZXF1ZXN0KTsKCiAgICAvLyBu
byB0b2tlbiByZXF1aXJlZCBmb3IgdGhlIGluaXRpYWwgdG9rZW4gcmVxdWVzdAogICAgJHRv
a2VuID0gTlVMTDsKCiAgICAkdGhpcy0+Y2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29u
c3VtZXIsICR0b2tlbik7CgogICAgLy8gUmV2IEEgY2hhbmdlCiAgICAkY2FsbGJhY2sgPSAk
cmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfY2FsbGJhY2snKTsKICAgICRuZXdfdG9r
ZW4gPSAkdGhpcy0+ZGF0YV9zdG9yZS0+bmV3X3JlcXVlc3RfdG9rZW4oJGNvbnN1bWVyLCAk
Y2FsbGJhY2spOwoKICAgIHJldHVybiAkbmV3X3Rva2VuOwogIH0KCiAgLyoqCiAgICogcHJv
Y2VzcyBhbiBhY2Nlc3NfdG9rZW4gcmVxdWVzdAogICAqIHJldHVybnMgdGhlIGFjY2VzcyB0
b2tlbiBvbiBzdWNjZXNzCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGZldGNoX2FjY2Vzc190
b2tlbigmJHJlcXVlc3QpIHsKICAgICR0aGlzLT5nZXRfdmVyc2lvbigkcmVxdWVzdCk7Cgog
ICAgJGNvbnN1bWVyID0gJHRoaXMtPmdldF9jb25zdW1lcigkcmVxdWVzdCk7CgogICAgLy8g
cmVxdWlyZXMgYXV0aG9yaXplZCByZXF1ZXN0IHRva2VuCiAgICAkdG9rZW4gPSAkdGhpcy0+
Z2V0X3Rva2VuKCRyZXF1ZXN0LCAkY29uc3VtZXIsICJyZXF1ZXN0Iik7CgogICAgJHRoaXMt
PmNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwoKICAgIC8v
IFJldiBBIGNoYW5nZQogICAgJHZlcmlmaWVyID0gJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIo
J29hdXRoX3ZlcmlmaWVyJyk7CiAgICAkbmV3X3Rva2VuID0gJHRoaXMtPmRhdGFfc3RvcmUt
Pm5ld19hY2Nlc3NfdG9rZW4oJHRva2VuLCAkY29uc3VtZXIsICR2ZXJpZmllcik7CgogICAg
cmV0dXJuICRuZXdfdG9rZW47CiAgfQoKICAvKioKICAgKiB2ZXJpZnkgYW4gYXBpIGNhbGws
IGNoZWNrcyBhbGwgdGhlIHBhcmFtZXRlcnMKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gdmVy
aWZ5X3JlcXVlc3QoJiRyZXF1ZXN0KSB7CiAgICAkdGhpcy0+Z2V0X3ZlcnNpb24oJHJlcXVl
c3QpOwogICAgJGNvbnN1bWVyID0gJHRoaXMtPmdldF9jb25zdW1lcigkcmVxdWVzdCk7CiAg
ICAkdG9rZW4gPSAkdGhpcy0+Z2V0X3Rva2VuKCRyZXF1ZXN0LCAkY29uc3VtZXIsICJhY2Nl
c3MiKTsKICAgICR0aGlzLT5jaGVja19zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwg
JHRva2VuKTsKICAgIHJldHVybiBhcnJheSgkY29uc3VtZXIsICR0b2tlbik7CiAgfQoKICAv
LyBJbnRlcm5hbHMgZnJvbSBoZXJlCiAgLyoqCiAgICogdmVyc2lvbiAxCiAgICovCiAgcHJp
dmF0ZSBmdW5jdGlvbiBnZXRfdmVyc2lvbigmJHJlcXVlc3QpIHsKICAgICR2ZXJzaW9uID0g
JHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoIm9hdXRoX3ZlcnNpb24iKTsKICAgIGlmICghJHZl
cnNpb24pIHsKICAgICAgLy8gU2VydmljZSBQcm92aWRlcnMgTVVTVCBhc3N1bWUgdGhlIHBy
b3RvY29sIHZlcnNpb24gdG8gYmUgMS4wIGlmIHRoaXMgcGFyYW1ldGVyIGlzIG5vdCBwcmVz
ZW50LgogICAgICAvLyBDaGFwdGVyIDcuMCAoIkFjY2Vzc2luZyBQcm90ZWN0ZWQgUmVzc291
cmNlcyIpCiAgICAgICR2ZXJzaW9uID0gJzEuMCc7CiAgICB9CiAgICBpZiAoJHZlcnNpb24g
IT09ICR0aGlzLT52ZXJzaW9uKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigi
T0F1dGggdmVyc2lvbiAnJHZlcnNpb24nIG5vdCBzdXBwb3J0ZWQiKTsKICAgIH0KICAgIHJl
dHVybiAkdmVyc2lvbjsKICB9CgogIC8qKgogICAqIGZpZ3VyZSBvdXQgdGhlIHNpZ25hdHVy
ZSB3aXRoIHNvbWUgZGVmYXVsdHMKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGdldF9zaWdu
YXR1cmVfbWV0aG9kKCYkcmVxdWVzdCkgewogICAgJHNpZ25hdHVyZV9tZXRob2QgPQogICAg
ICAgIEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcigib2F1dGhfc2lnbmF0dXJlX21ldGhvZCIp
OwoKICAgIGlmICghJHNpZ25hdHVyZV9tZXRob2QpIHsKICAgICAgLy8gQWNjb3JkaW5nIHRv
IGNoYXB0ZXIgNyAoIkFjY2Vzc2luZyBQcm90ZWN0ZWQgUmVzc291cmNlcyIpIHRoZSBzaWdu
YXR1cmUtbWV0aG9kCiAgICAgIC8vIHBhcmFtZXRlciBpcyByZXF1aXJlZCwgYW5kIHdlIGNh
bid0IGp1c3QgZmFsbGJhY2sgdG8gUExBSU5URVhUCiAgICAgIHRocm93IG5ldyBPQXV0aEV4
Y2VwdGlvbignTm8gc2lnbmF0dXJlIG1ldGhvZCBwYXJhbWV0ZXIuIFRoaXMgcGFyYW1ldGVy
IGlzIHJlcXVpcmVkJyk7CiAgICB9CgogICAgaWYgKCFpbl9hcnJheSgkc2lnbmF0dXJlX21l
dGhvZCwKICAgICAgICAgICAgICAgICAgYXJyYXlfa2V5cygkdGhpcy0+c2lnbmF0dXJlX21l
dGhvZHMpKSkgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAgICAgIlNp
Z25hdHVyZSBtZXRob2QgJyRzaWduYXR1cmVfbWV0aG9kJyBub3Qgc3VwcG9ydGVkICIgLgog
ICAgICAgICJ0cnkgb25lIG9mIHRoZSBmb2xsb3dpbmc6ICIgLgogICAgICAgIGltcGxvZGUo
IiwgIiwgYXJyYXlfa2V5cygkdGhpcy0+c2lnbmF0dXJlX21ldGhvZHMpKQogICAgICApOwog
ICAgfQogICAgcmV0dXJuICR0aGlzLT5zaWduYXR1cmVfbWV0aG9kc1skc2lnbmF0dXJlX21l
dGhvZF07CiAgfQoKICAvKioKICAgKiB0cnkgdG8gZmluZCB0aGUgY29uc3VtZXIgZm9yIHRo
ZSBwcm92aWRlZCByZXF1ZXN0J3MgY29uc3VtZXIga2V5CiAgICovCiAgcHJpdmF0ZSBmdW5j
dGlvbiBnZXRfY29uc3VtZXIoJiRyZXF1ZXN0KSB7CiAgICAkY29uc3VtZXJfa2V5ID0gQCRy
ZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCJvYXV0aF9jb25zdW1lcl9rZXkiKTsKICAgIGlmICgh
JGNvbnN1bWVyX2tleSkgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIkludmFs
aWQgY29uc3VtZXIga2V5Iik7CiAgICB9CgogICAgJGNvbnN1bWVyID0gJHRoaXMtPmRhdGFf
c3RvcmUtPmxvb2t1cF9jb25zdW1lcigkY29uc3VtZXJfa2V5KTsKICAgIGlmICghJGNvbnN1
bWVyKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiSW52YWxpZCBjb25zdW1l
ciIpOwogICAgfQoKICAgIHJldHVybiAkY29uc3VtZXI7CiAgfQoKICAvKioKICAgKiB0cnkg
dG8gZmluZCB0aGUgdG9rZW4gZm9yIHRoZSBwcm92aWRlZCByZXF1ZXN0J3MgdG9rZW4ga2V5
CiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBnZXRfdG9rZW4oJiRyZXF1ZXN0LCAkY29uc3Vt
ZXIsICR0b2tlbl90eXBlPSJhY2Nlc3MiKSB7CiAgICAkdG9rZW5fZmllbGQgPSBAJHJlcXVl
c3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX3Rva2VuJyk7CiAgICAkdG9rZW4gPSAkdGhpcy0+
ZGF0YV9zdG9yZS0+bG9va3VwX3Rva2VuKAogICAgICAkY29uc3VtZXIsICR0b2tlbl90eXBl
LCAkdG9rZW5fZmllbGQKICAgICk7CiAgICBpZiAoISR0b2tlbikgewogICAgICB0aHJvdyBu
ZXcgT0F1dGhFeGNlcHRpb24oIkludmFsaWQgJHRva2VuX3R5cGUgdG9rZW46ICR0b2tlbl9m
aWVsZCIpOwogICAgfQogICAgcmV0dXJuICR0b2tlbjsKICB9CgogIC8qKgogICAqIGFsbC1p
bi1vbmUgZnVuY3Rpb24gdG8gY2hlY2sgdGhlIHNpZ25hdHVyZSBvbiBhIHJlcXVlc3QKICAg
KiBzaG91bGQgZ3Vlc3MgdGhlIHNpZ25hdHVyZSBtZXRob2QgYXBwcm9wcmlhdGVseQogICAq
LwogIHByaXZhdGUgZnVuY3Rpb24gY2hlY2tfc2lnbmF0dXJlKCYkcmVxdWVzdCwgJGNvbnN1
bWVyLCAkdG9rZW4pIHsKICAgIC8vIHRoaXMgc2hvdWxkIHByb2JhYmx5IGJlIGluIGEgZGlm
ZmVyZW50IG1ldGhvZAogICAgJHRpbWVzdGFtcCA9IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRl
cignb2F1dGhfdGltZXN0YW1wJyk7CiAgICAkbm9uY2UgPSBAJHJlcXVlc3QtPmdldF9wYXJh
bWV0ZXIoJ29hdXRoX25vbmNlJyk7CgogICAgJHRoaXMtPmNoZWNrX3RpbWVzdGFtcCgkdGlt
ZXN0YW1wKTsKICAgICR0aGlzLT5jaGVja19ub25jZSgkY29uc3VtZXIsICR0b2tlbiwgJG5v
bmNlLCAkdGltZXN0YW1wKTsKCiAgICAkc2lnbmF0dXJlX21ldGhvZCA9ICR0aGlzLT5nZXRf
c2lnbmF0dXJlX21ldGhvZCgkcmVxdWVzdCk7CgogICAgJHNpZ25hdHVyZSA9ICRyZXF1ZXN0
LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF9zaWduYXR1cmUnKTsKICAgICR2YWxpZF9zaWcgPSAk
c2lnbmF0dXJlX21ldGhvZC0+Y2hlY2tfc2lnbmF0dXJlKAogICAgICAkcmVxdWVzdCwKICAg
ICAgJGNvbnN1bWVyLAogICAgICAkdG9rZW4sCiAgICAgICRzaWduYXR1cmUKICAgICk7Cgog
ICAgaWYgKCEkdmFsaWRfc2lnKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigi
SW52YWxpZCBzaWduYXR1cmUiKTsKICAgIH0KICB9CgogIC8qKgogICAqIGNoZWNrIHRoYXQg
dGhlIHRpbWVzdGFtcCBpcyBuZXcgZW5vdWdoCiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBj
aGVja190aW1lc3RhbXAoJHRpbWVzdGFtcCkgewogICAgaWYoICEgJHRpbWVzdGFtcCApCiAg
ICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigKICAgICAgICAnTWlzc2luZyB0aW1lc3Rh
bXAgcGFyYW1ldGVyLiBUaGUgcGFyYW1ldGVyIGlzIHJlcXVpcmVkJwogICAgICApOwoKICAg
IC8vIHZlcmlmeSB0aGF0IHRpbWVzdGFtcCBpcyByZWNlbnRpc2gKICAgICRub3cgPSB0aW1l
KCk7CiAgICBpZiAoYWJzKCRub3cgLSAkdGltZXN0YW1wKSA+ICR0aGlzLT50aW1lc3RhbXBf
dGhyZXNob2xkKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigKICAgICAgICAi
RXhwaXJlZCB0aW1lc3RhbXAsIHlvdXJzICR0aW1lc3RhbXAsIG91cnMgJG5vdyIKICAgICAg
KTsKICAgIH0KICB9CgogIC8qKgogICAqIGNoZWNrIHRoYXQgdGhlIG5vbmNlIGlzIG5vdCBy
ZXBlYXRlZAogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gY2hlY2tfbm9uY2UoJGNvbnN1bWVy
LCAkdG9rZW4sICRub25jZSwgJHRpbWVzdGFtcCkgewogICAgaWYoICEgJG5vbmNlICkKICAg
ICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKAogICAgICAgICdNaXNzaW5nIG5vbmNlIHBh
cmFtZXRlci4gVGhlIHBhcmFtZXRlciBpcyByZXF1aXJlZCcKICAgICAgKTsKCiAgICAvLyB2
ZXJpZnkgdGhhdCB0aGUgbm9uY2UgaXMgdW5pcXVlaXNoCiAgICAkZm91bmQgPSAkdGhpcy0+
ZGF0YV9zdG9yZS0+bG9va3VwX25vbmNlKAogICAgICAkY29uc3VtZXIsCiAgICAgICR0b2tl
biwKICAgICAgJG5vbmNlLAogICAgICAkdGltZXN0YW1wCiAgICApOwogICAgaWYgKCRmb3Vu
ZCkgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIk5vbmNlIGFscmVhZHkgdXNl
ZDogJG5vbmNlIik7CiAgICB9CiAgfQoKfQoKY2xhc3MgT0F1dGhEYXRhU3RvcmUgewogIGZ1
bmN0aW9uIGxvb2t1cF9jb25zdW1lcigkY29uc3VtZXJfa2V5KSB7CiAgICAvLyBpbXBsZW1l
bnQgbWUKICB9CgogIGZ1bmN0aW9uIGxvb2t1cF90b2tlbigkY29uc3VtZXIsICR0b2tlbl90
eXBlLCAkdG9rZW4pIHsKICAgIC8vIGltcGxlbWVudCBtZQogIH0KCiAgZnVuY3Rpb24gbG9v
a3VwX25vbmNlKCRjb25zdW1lciwgJHRva2VuLCAkbm9uY2UsICR0aW1lc3RhbXApIHsKICAg
IC8vIGltcGxlbWVudCBtZQogIH0KCiAgZnVuY3Rpb24gbmV3X3JlcXVlc3RfdG9rZW4oJGNv
bnN1bWVyLCAkY2FsbGJhY2sgPSBudWxsKSB7CiAgICAvLyByZXR1cm4gYSBuZXcgdG9rZW4g
YXR0YWNoZWQgdG8gdGhpcyBjb25zdW1lcgogIH0KCiAgZnVuY3Rpb24gbmV3X2FjY2Vzc190
b2tlbigkdG9rZW4sICRjb25zdW1lciwgJHZlcmlmaWVyID0gbnVsbCkgewogICAgLy8gcmV0
dXJuIGEgbmV3IGFjY2VzcyB0b2tlbiBhdHRhY2hlZCB0byB0aGlzIGNvbnN1bWVyCiAgICAv
LyBmb3IgdGhlIHVzZXIgYXNzb2NpYXRlZCB3aXRoIHRoaXMgdG9rZW4gaWYgdGhlIHJlcXVl
c3QgdG9rZW4KICAgIC8vIGlzIGF1dGhvcml6ZWQKICAgIC8vIHNob3VsZCBhbHNvIGludmFs
aWRhdGUgdGhlIHJlcXVlc3QgdG9rZW4KICB9Cgp9CgpjbGFzcyBPQXV0aFV0aWwgewogIHB1
YmxpYyBzdGF0aWMgZnVuY3Rpb24gdXJsZW5jb2RlX3JmYzM5ODYoJGlucHV0KSB7CiAgaWYg
KGlzX2FycmF5KCRpbnB1dCkpIHsKICAgIHJldHVybiBhcnJheV9tYXAoYXJyYXkoJ09BdXRo
VXRpbCcsICd1cmxlbmNvZGVfcmZjMzk4NicpLCAkaW5wdXQpOwogIH0gZWxzZSBpZiAoaXNf
c2NhbGFyKCRpbnB1dCkpIHsKICAgIHJldHVybiBzdHJfcmVwbGFjZSgKICAgICAgJysnLAog
ICAgICAnICcsCiAgICAgIHN0cl9yZXBsYWNlKCclN0UnLCAnficsIHJhd3VybGVuY29kZSgk
aW5wdXQpKQogICAgKTsKICB9IGVsc2UgewogICAgcmV0dXJuICcnOwogIH0KfQoKCiAgLy8g
VGhpcyBkZWNvZGUgZnVuY3Rpb24gaXNuJ3QgdGFraW5nIGludG8gY29uc2lkZXJhdGlvbiB0
aGUgYWJvdmUKICAvLyBtb2RpZmljYXRpb25zIHRvIHRoZSBlbmNvZGluZyBwcm9jZXNzLiBI
b3dldmVyLCB0aGlzIG1ldGhvZCBkb2Vzbid0CiAgLy8gc2VlbSB0byBiZSB1c2VkIGFueXdo
ZXJlIHNvIGxlYXZpbmcgaXQgYXMgaXMuCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiB1cmxk
ZWNvZGVfcmZjMzk4Nigkc3RyaW5nKSB7CiAgICByZXR1cm4gdXJsZGVjb2RlKCRzdHJpbmcp
OwogIH0KCiAgLy8gVXRpbGl0eSBmdW5jdGlvbiBmb3IgdHVybmluZyB0aGUgQXV0aG9yaXph
dGlvbjogaGVhZGVyIGludG8KICAvLyBwYXJhbWV0ZXJzLCBoYXMgdG8gZG8gc29tZSB1bmVz
Y2FwaW5nCiAgLy8gQ2FuIGZpbHRlciBvdXQgYW55IG5vbi1vYXV0aCBwYXJhbWV0ZXJzIGlm
IG5lZWRlZCAoZGVmYXVsdCBiZWhhdmlvdXIpCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBz
cGxpdF9oZWFkZXIoJGhlYWRlciwgJG9ubHlfYWxsb3dfb2F1dGhfcGFyYW1ldGVycyA9IHRy
dWUpIHsKICAgICRwYXR0ZXJuID0gJy8oKFstX2Etel0qKT0oIihbXiJdKikifChbXixdKikp
LD8pLyc7CiAgICAkb2Zmc2V0ID0gMDsKICAgICRwYXJhbXMgPSBhcnJheSgpOwogICAgd2hp
bGUgKHByZWdfbWF0Y2goJHBhdHRlcm4sICRoZWFkZXIsICRtYXRjaGVzLCBQUkVHX09GRlNF
VF9DQVBUVVJFLCAkb2Zmc2V0KSA+IDApIHsKICAgICAgJG1hdGNoID0gJG1hdGNoZXNbMF07
CiAgICAgICRoZWFkZXJfbmFtZSA9ICRtYXRjaGVzWzJdWzBdOwogICAgICAkaGVhZGVyX2Nv
bnRlbnQgPSAoaXNzZXQoJG1hdGNoZXNbNV0pKSA/ICRtYXRjaGVzWzVdWzBdIDogJG1hdGNo
ZXNbNF1bMF07CiAgICAgIGlmIChwcmVnX21hdGNoKCcvXm9hdXRoXy8nLCAkaGVhZGVyX25h
bWUpIHx8ICEkb25seV9hbGxvd19vYXV0aF9wYXJhbWV0ZXJzKSB7CiAgICAgICAgJHBhcmFt
c1skaGVhZGVyX25hbWVdID0gT0F1dGhVdGlsOjp1cmxkZWNvZGVfcmZjMzk4NigkaGVhZGVy
X2NvbnRlbnQpOwogICAgICB9CiAgICAgICRvZmZzZXQgPSAkbWF0Y2hbMV0gKyBzdHJsZW4o
JG1hdGNoWzBdKTsKICAgIH0KCiAgICBpZiAoaXNzZXQoJHBhcmFtc1sncmVhbG0nXSkpIHsK
ICAgICAgdW5zZXQoJHBhcmFtc1sncmVhbG0nXSk7CiAgICB9CgogICAgcmV0dXJuICRwYXJh
bXM7CiAgfQoKICAvLyBoZWxwZXIgdG8gdHJ5IHRvIHNvcnQgb3V0IGhlYWRlcnMgZm9yIHBl
b3BsZSB3aG8gYXJlbid0IHJ1bm5pbmcgYXBhY2hlCiAgcHVibGljIHN0YXRpYyBmdW5jdGlv
biBnZXRfaGVhZGVycygpIHsKICAgIGlmIChmdW5jdGlvbl9leGlzdHMoJ2FwYWNoZV9yZXF1
ZXN0X2hlYWRlcnMnKSkgewogICAgICAvLyB3ZSBuZWVkIHRoaXMgdG8gZ2V0IHRoZSBhY3R1
YWwgQXV0aG9yaXphdGlvbjogaGVhZGVyCiAgICAgIC8vIGJlY2F1c2UgYXBhY2hlIHRlbmRz
IHRvIHRlbGwgdXMgaXQgZG9lc24ndCBleGlzdAogICAgICAkaGVhZGVycyA9IGFwYWNoZV9y
ZXF1ZXN0X2hlYWRlcnMoKTsKCiAgICAgIC8vIHNhbml0aXplIHRoZSBvdXRwdXQgb2YgYXBh
Y2hlX3JlcXVlc3RfaGVhZGVycyBiZWNhdXNlCiAgICAgIC8vIHdlIGFsd2F5cyB3YW50IHRo
ZSBrZXlzIHRvIGJlIENhc2VkLUxpa2UtVGhpcyBhbmQgYXJoKCkKICAgICAgLy8gcmV0dXJu
cyB0aGUgaGVhZGVycyBpbiB0aGUgc2FtZSBjYXNlIGFzIHRoZXkgYXJlIGluIHRoZQogICAg
ICAvLyByZXF1ZXN0CiAgICAgICRvdXQgPSBhcnJheSgpOwogICAgICBmb3JlYWNoKCAkaGVh
ZGVycyBBUyAka2V5ID0+ICR2YWx1ZSApIHsKICAgICAgICAka2V5ID0gc3RyX3JlcGxhY2Uo
CiAgICAgICAgICAgICIgIiwKICAgICAgICAgICAgIi0iLAogICAgICAgICAgICB1Y3dvcmRz
KHN0cnRvbG93ZXIoc3RyX3JlcGxhY2UoIi0iLCAiICIsICRrZXkpKSkKICAgICAgICAgICk7
CiAgICAgICAgJG91dFska2V5XSA9ICR2YWx1ZTsKICAgICAgfQogICAgfSBlbHNlIHsKICAg
ICAgLy8gb3RoZXJ3aXNlIHdlIGRvbid0IGhhdmUgYXBhY2hlIGFuZCBhcmUganVzdCBnb2lu
ZyB0byBoYXZlIHRvIGhvcGUKICAgICAgLy8gdGhhdCAkX1NFUlZFUiBhY3R1YWxseSBjb250
YWlucyB3aGF0IHdlIG5lZWQKICAgICAgJG91dCA9IGFycmF5KCk7CiAgICAgIGlmKCBpc3Nl
dCgkX1NFUlZFUlsnQ09OVEVOVF9UWVBFJ10pICkKICAgICAgICAkb3V0WydDb250ZW50LVR5
cGUnXSA9ICRfU0VSVkVSWydDT05URU5UX1RZUEUnXTsKICAgICAgaWYoIGlzc2V0KCRfRU5W
WydDT05URU5UX1RZUEUnXSkgKQogICAgICAgICRvdXRbJ0NvbnRlbnQtVHlwZSddID0gJF9F
TlZbJ0NPTlRFTlRfVFlQRSddOwoKICAgICAgZm9yZWFjaCAoJF9TRVJWRVIgYXMgJGtleSA9
PiAkdmFsdWUpIHsKICAgICAgICBpZiAoc3Vic3RyKCRrZXksIDAsIDUpID09ICJIVFRQXyIp
IHsKICAgICAgICAgIC8vIHRoaXMgaXMgY2hhb3MsIGJhc2ljYWxseSBpdCBpcyBqdXN0IHRo
ZXJlIHRvIGNhcGl0YWxpemUgdGhlIGZpcnN0CiAgICAgICAgICAvLyBsZXR0ZXIgb2YgZXZl
cnkgd29yZCB0aGF0IGlzIG5vdCBhbiBpbml0aWFsIEhUVFAgYW5kIHN0cmlwIEhUVFAKICAg
ICAgICAgIC8vIGNvZGUgZnJvbSBwcnplbWVrCiAgICAgICAgICAka2V5ID0gc3RyX3JlcGxh
Y2UoCiAgICAgICAgICAgICIgIiwKICAgICAgICAgICAgIi0iLAogICAgICAgICAgICB1Y3dv
cmRzKHN0cnRvbG93ZXIoc3RyX3JlcGxhY2UoIl8iLCAiICIsIHN1YnN0cigka2V5LCA1KSkp
KQogICAgICAgICAgKTsKICAgICAgICAgICRvdXRbJGtleV0gPSAkdmFsdWU7CiAgICAgICAg
fQogICAgICB9CiAgICB9CiAgICByZXR1cm4gJG91dDsKICB9CgogIC8vIFRoaXMgZnVuY3Rp
b24gdGFrZXMgYSBpbnB1dCBsaWtlIGE9YiZhPWMmZD1lIGFuZCByZXR1cm5zIHRoZSBwYXJz
ZWQKICAvLyBwYXJhbWV0ZXJzIGxpa2UgdGhpcwogIC8vIGFycmF5KCdhJyA9PiBhcnJheSgn
YicsJ2MnKSwgJ2QnID0+ICdlJykKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHBhcnNlX3Bh
cmFtZXRlcnMoICRpbnB1dCApIHsKICAgIGlmICghaXNzZXQoJGlucHV0KSB8fCAhJGlucHV0
KSByZXR1cm4gYXJyYXkoKTsKCiAgICAkcGFpcnMgPSBleHBsb2RlKCcmJywgJGlucHV0KTsK
CiAgICAkcGFyc2VkX3BhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgZm9yZWFjaCAoJHBhaXJz
IGFzICRwYWlyKSB7CiAgICAgICRzcGxpdCA9IGV4cGxvZGUoJz0nLCAkcGFpciwgMik7CiAg
ICAgICRwYXJhbWV0ZXIgPSBPQXV0aFV0aWw6OnVybGRlY29kZV9yZmMzOTg2KCRzcGxpdFsw
XSk7CiAgICAgICR2YWx1ZSA9IGlzc2V0KCRzcGxpdFsxXSkgPyBPQXV0aFV0aWw6OnVybGRl
Y29kZV9yZmMzOTg2KCRzcGxpdFsxXSkgOiAnJzsKCiAgICAgIGlmIChpc3NldCgkcGFyc2Vk
X3BhcmFtZXRlcnNbJHBhcmFtZXRlcl0pKSB7CiAgICAgICAgLy8gV2UgaGF2ZSBhbHJlYWR5
IHJlY2lldmVkIHBhcmFtZXRlcihzKSB3aXRoIHRoaXMgbmFtZSwgc28gYWRkIHRvIHRoZSBs
aXN0CiAgICAgICAgLy8gb2YgcGFyYW1ldGVycyB3aXRoIHRoaXMgbmFtZQoKICAgICAgICBp
ZiAoaXNfc2NhbGFyKCRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSkpIHsKICAgICAg
ICAgIC8vIFRoaXMgaXMgdGhlIGZpcnN0IGR1cGxpY2F0ZSwgc28gdHJhbnNmb3JtIHNjYWxh
ciAoc3RyaW5nKSBpbnRvIGFuIGFycmF5CiAgICAgICAgICAvLyBzbyB3ZSBjYW4gYWRkIHRo
ZSBkdXBsaWNhdGVzCiAgICAgICAgICAkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl0g
PSBhcnJheSgkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl0pOwogICAgICAgIH0KCiAg
ICAgICAgJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdW10gPSAkdmFsdWU7CiAgICAg
IH0gZWxzZSB7CiAgICAgICAgJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdID0gJHZh
bHVlOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gJHBhcnNlZF9wYXJhbWV0ZXJzOwogIH0K
CiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBidWlsZF9odHRwX3F1ZXJ5KCRwYXJhbXMpIHsK
ICAgIGlmICghJHBhcmFtcykgcmV0dXJuICcnOwoKICAgIC8vIFVybGVuY29kZSBib3RoIGtl
eXMgYW5kIHZhbHVlcwogICAgJGtleXMgPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2
KGFycmF5X2tleXMoJHBhcmFtcykpOwogICAgJHZhbHVlcyA9IE9BdXRoVXRpbDo6dXJsZW5j
b2RlX3JmYzM5ODYoYXJyYXlfdmFsdWVzKCRwYXJhbXMpKTsKICAgICRwYXJhbXMgPSBhcnJh
eV9jb21iaW5lKCRrZXlzLCAkdmFsdWVzKTsKCiAgICAvLyBQYXJhbWV0ZXJzIGFyZSBzb3J0
ZWQgYnkgbmFtZSwgdXNpbmcgbGV4aWNvZ3JhcGhpY2FsIGJ5dGUgdmFsdWUgb3JkZXJpbmcu
CiAgICAvLyBSZWY6IFNwZWM6IDkuMS4xICgxKQogICAgdWtzb3J0KCRwYXJhbXMsICdzdHJj
bXAnKTsKCiAgICAkcGFpcnMgPSBhcnJheSgpOwogICAgZm9yZWFjaCAoJHBhcmFtcyBhcyAk
cGFyYW1ldGVyID0+ICR2YWx1ZSkgewogICAgICBpZiAoaXNfYXJyYXkoJHZhbHVlKSkgewog
ICAgICAgIC8vIElmIHR3byBvciBtb3JlIHBhcmFtZXRlcnMgc2hhcmUgdGhlIHNhbWUgbmFt
ZSwgdGhleSBhcmUgc29ydGVkIGJ5IHRoZWlyIHZhbHVlCiAgICAgICAgLy8gUmVmOiBTcGVj
OiA5LjEuMSAoMSkKICAgICAgICBuYXRzb3J0KCR2YWx1ZSk7CiAgICAgICAgZm9yZWFjaCAo
JHZhbHVlIGFzICRkdXBsaWNhdGVfdmFsdWUpIHsKICAgICAgICAgICRwYWlyc1tdID0gJHBh
cmFtZXRlciAuICc9JyAuICRkdXBsaWNhdGVfdmFsdWU7CiAgICAgICAgfQogICAgICB9IGVs
c2UgewogICAgICAgICRwYWlyc1tdID0gJHBhcmFtZXRlciAuICc9JyAuICR2YWx1ZTsKICAg
ICAgfQogICAgfQogICAgLy8gRm9yIGVhY2ggcGFyYW1ldGVyLCB0aGUgbmFtZSBpcyBzZXBh
cmF0ZWQgZnJvbSB0aGUgY29ycmVzcG9uZGluZyB2YWx1ZSBieSBhbiAnPScgY2hhcmFjdGVy
IChBU0NJSSBjb2RlIDYxKQogICAgLy8gRWFjaCBuYW1lLXZhbHVlIHBhaXIgaXMgc2VwYXJh
dGVkIGJ5IGFuICcmJyBjaGFyYWN0ZXIgKEFTQ0lJIGNvZGUgMzgpCiAgICByZXR1cm4gaW1w
bG9kZSgnJicsICRwYWlycyk7CiAgfQp9IjtzOjM6Im1kNSI7czozMjoiN2M2N2IyYzBkYjU3
MWVmODdhNTM2ZGE5ZjZkNWIzMmUiO30=
