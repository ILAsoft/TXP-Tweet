# arc_twitter v3.2
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjM6
IjMuMiI7czo2OiJhdXRob3IiO3M6MTE6IkFuZHkgQ2FydGVyIjtzOjEwOiJhdXRob3JfdXJp
IjtzOjMxOiJodHRwOi8vcmVkaG90Y2hpbGxpcHJvamVjdC5jb20vIjtzOjExOiJkZXNjcmlw
dGlvbiI7czo2MDoiPGEgaHJlZj0iaHR0cDovL3d3dy50d2l0dGVyLmNvbSI+VHdpdHRlcjwv
YT4gZm9yIFRleHRwYXR0ZXJuIjtzOjU6Im9yZGVyIjtzOjE6IjUiO3M6NDoidHlwZSI7czox
OiIxIjtzOjU6ImZsYWdzIjtzOjE6IjMiO3M6NDoiaGVscCI7czoxNzkwODoiCTxoMSBjbGFz
cz0idGl0bGUiPjxzcGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0IChhcmNfdHdp
dHRlciBmb3IgVGV4dHBhdHRlcm4pPC9oMT4KCgk8b2w+CgkJPGxpPjxhIGhyZWY9IiNhcmNf
dHdpdHRlcl9hdXRob3IiPkF1dGhvcjwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3
aXR0ZXJfaW5zdGFsbGF0aW9uIj5JbnN0YWxsYXRpb24gLyBVbmluc3RhbGxhdGlvbjwvYT48
L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfdGFnIj5UaGUgYXJjX3R3aXR0ZXIg
dGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl9zZWFyY2hfdGFnIj5U
aGUgYXJjX3R3aXR0ZXJfc2VhcmNoIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJj
X3R3aXR0ZXJfdHdlZXRfYnV0dG9uX3RhZyI+VGhlIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRv
biB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX2ZvbGxvd19idXR0
b25fdGFnIj5UaGUgYXJjX3R3aXR0ZXJfZm9sbG93X2J1dHRvbiB0YWc8L2E+PC9saT4KCQk8
bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3R3ZWV0X3VybCI+VGhlIGFyY190d2l0dGVyX3R3
ZWV0X3VybCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3Rpbnl1
cmwiPlRoZSBhcmNfdHdpdHRlcl90aW55dXJsIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVm
PSIjYXJjX3R3aXR0ZXJfY2FjaGluZyI+Q2FjaGluZzwvYT48L2xpPgoJCTxsaT48YSBocmVm
PSIjYXJjX3R3aXR0ZXJfcHJlZnMiPlByZWZlcmVuY2VzPC9hPjwvbGk+CgkJPGxpPjxhIGhy
ZWY9IiNhcmNfdHdpdHRlcl9hcnRpY2xlIj5Ud2VldGluZyBhcnRpY2xlczwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfYWRtaW4iPlRoZSBUd2l0dGVyIHRhYjwvYT48
L2xpPgoJPC9vbD4KCgk8cD48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCBw
cm92aWRlcyBhY2Nlc3MgdG8geW91ciBUd2l0dGVyIGFjY291bnQgdGhyb3VnaCBib3RoIHRo
ZSBhZG1pbiBpbnRlcmZhY2UgYW5kIHRoZSBwdWJsaWMgc2lkZSBvZiB5b3VyIHNpdGUuIFVw
ZGF0ZSBUd2l0dGVyIHdoZW4geW91IHBvc3QgYSBuZXcgYXJ0aWNsZSAod2l0aCBhcnRpY2xl
LWJ5LWFydGljbGUgb3B0IG91dCBvcHRpb24pLCB1cGRhdGUgYW5kIHZpZXcgeW91ciBUd2l0
dGVyIGZlZWQgdGhyb3VnaCB0aGUgYWRtaW4gVHdpdHRlciB0YWIsIGFuZCBkaXNwbGF5IFR3
aXR0ZXIgZmVlZHMgb24geW91ciBzaXRlLjwvcD4KCgk8cD5SZXF1aXJlbWVudHM6LTwvcD4K
Cgk8dWw+CgkJPGxpPlRleHRwYXR0ZXJuIDQuMis8L2xpPgoJCTxsaT48c3BhbiBjbGFzcz0i
Y2FwcyI+UEhQPC9zcGFuPiA1IGFuZCBjVVJMPC9saT4KCTwvdWw+CgoJPGgyIGNsYXNzPSJz
ZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2gyPgoKCTxwPjxhIGhy
ZWY9Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbSI+QW5keSBDYXJ0ZXI8L2E+LiBG
b3Igb3RoZXIgVGV4dHBhdHRlcm4gcGx1Z2lucyBieSBtZSB2aXNpdCBteSA8YSBocmVmPSJo
dHRwOi8vcmVkaG90Y2hpbGxpcHJvamVjdC5jb20vdHhwIj5QbHVnaW5zIHBhZ2U8L2E+Ljwv
cD4KCgk8cD5UaGFua3MgdG8gPGEgaHJlZj0iaHR0cDovL21hbmZyZS5uZXQvIj5NaWNoYWVs
IE1hbmZyZTwvYT4gZm9yIGluc3BpcmF0aW9uIGZvciB0aGUgYXJ0aWNsZSB0d2VldCBwYXJ0
IG9mIHRoaXMgcGx1Z2luIGJhc2VkIG9uIGhpcyA8c3BhbiBjbGFzcz0idGFnIj5tZW1fdHdp
dHRlcjwvc3Bhbj4gcGx1Z2luLiAgQWRkaXRpb25hbCB0aGFua3MgdG8gdGhlIGdyZWF0IFRl
eHRwYXR0ZXJuIGNvbW11bml0eSBmb3IgaGVscGluZyB0byB0ZXN0IHRoaXMgcGx1Z2luIGFu
ZCBmb3Igc3VnZ2VzdGluZyBuZXcgZmVhdHVyZXMuIFRoZSBPQXV0aCBwYXJ0IG9mIHRoZSBw
bHVnaW4gaXMgdGhhbmtzIHRvIDxhIGhyZWY9Imh0dHA6Ly90d2l0dGVyLmNvbS9hYnJhaGFt
Ij5BYnJhaGFtIFdpbGxpYW1zPC9hPi48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0i
YXJjX3R3aXR0ZXJfaW5zdGFsbGF0aW9uIj5JbnN0YWxsYXRpb24gLyBVbmluc3RhbGxhdGlv
bjwvaDI+CgoJPHA+VG8gaW5zdGFsbCBnbyB0byB0aGUgJiM4MjE2O3BsdWdpbnMmIzgyMTc7
IHRhYiB1bmRlciAmIzgyMTY7YWRtaW4mIzgyMTc7IGFuZCBwYXN0ZSB0aGUgcGx1Z2luIGNv
ZGUgaW50byB0aGUgJiM4MjE2O0luc3RhbGwgcGx1Z2luJiM4MjE3OyBib3gsICYjODIxNjt1
cGxvYWQmIzgyMTc7IGFuZCB0aGVuICYjODIxNjtpbnN0YWxsJiM4MjE3Oy4gVGhlIHBsdWdp
biB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgYWN0aXZhdGVkLjwvcD4KCgk8cD5CZWZvcmUgeW91
IHN0YXJ0IHVzaW5nIDxzcGFuIGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiB5b3Ug
d2lsbCBuZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IHRoZSBjYWNoZSBkaXJlY3RvcnkgaXMgd3Jp
dGFibGUuIFNlZSB0aGUgJiM4MjE2O0NhY2hpbmcmIzgyMTc7IHN1YnNlY3Rpb24gYmVsb3cg
Zm9yIGZ1cnRoZXIgaW5mb3JtYXRpb24uPC9wPgoKCTxwPjxzcGFuIGNsYXNzPSJ0YWciPmFy
Y190d2l0dGVyPC9zcGFuPiBzaG91bGQgbm93IGJlIHJlYWR5IGZvciB1c2Ugb24gdGhlIHB1
YmxpYy1zaWRlIG9mIHlvdXIgc2l0ZS48L3A+CgoJPHA+VG8gdW5sb2NrIHRoZSBhZG1pbiBm
ZWF0dXJlcyBvZiB0aGlzIHBsdWdpbiB5b3Ugd2lsbCBuZWVkIHRvIGFzc29jaWF0ZSB5b3Vy
IHNpdGUgd2l0aCBhIFR3aXR0ZXIgYWNjb3VudCBieSBjb25uZWN0aW5nIHRvIFR3aXR0ZXIg
ZnJvbSB0aGUgcGx1Z2luJiM4MjE3O3Mgb3B0aW9ucyBzY3JlZW4uIENsaWNrIG9uIHRoZSBs
aW5rIHRvIGNvbm5lY3QgdG8gVHdpdHRlciwgeW91IHdpbGwgYmUgYXNrZWQgdG8gbG9naW4g
dG8gVHdpdHRlciwgY2xpY2tpbmcgdGhpcyBsaW5rIHdpbGwgdGVtcG9yYXJpbHkgdGFrZSB5
b3UgdG8gdGhlIFR3aXR0ZXIgc2l0ZSB3aGVyZSB5b3Ugd2lsbCBiZSBhc2tlZCB0byBsb2dp
biBhbmQgYXBwcm92ZSBhY2Nlc3MgZm9yIDxzcGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+
IFR3ZWV0IHRvIHJlYWQgYW5kIHdyaXRlIHRvIHlvdXIgVHdpdHRlciBhY2NvdW50LiBJZiBh
bGwgaXMgc3VjY2Vzc2Z1bCB5b3Ugd2lsbCBiZSByZXR1cm5lZCB0byB0aGUgb3B0aW9ucyBz
Y3JlZW4gYW5kIHlvdXIgdXNlciBuYW1lIHdpbGwgYXBwZWFyLjwvcD4KCgk8cD5BdCBhbnkg
dGltZSB5b3UgY2FuIGRpc2Fzc29jaWF0ZSB5b3VyIFR3aXR0ZXIgYWNjb3VudCB3aXRoIDxz
cGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0IHZpYSB5b3VyIFR3aXR0ZXIgYWNj
b3VudCBwcmVmZXJlbmNlcyBvbiB0aGUgPGEgaHJlZj0iaHR0cDovL3d3dy50d2l0dGVyLmNv
bSI+VHdpdHRlciB3ZWJzaXRlPC9hPi48L3A+CgoJPHA+VG8gdW5pbnN0YWxsIDxzcGFuIGNs
YXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiBzaW1wbHkgZGVsZXRlIHRoZSBwbHVnaW4g
ZnJvbSB0aGUgJiM4MjE2O1BsdWdpbnMmIzgyMTc7IHRhYi4gIFRoaXMgd2lsbCByZW1vdmUg
dGhlIHBsdWdpbiBjb2RlLCBkZWxldGUgcmVsYXRlZCBwcmVmZXJlbmNlcyBhbmQgZHJvcCB0
aGUgPHNwYW4gY2xhc3M9InRhZyI+YXJjX3R3aXR0ZXI8L3NwYW4+IHRhYmxlIGZyb20geW91
ciBUZXh0cGF0dGVybiBkYXRhYmFzZS48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0i
YXJjX3R3aXR0ZXJfdGFnIj5UaGUgYXJjX3R3aXR0ZXIgdGFnPC9oMj4KCgk8aDM+U3ludGF4
PC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyIHVzZXI9JnF1b3Q7ZHJtb25rZXluaW5q
YSZxdW90OyAvJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJ
CTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVm
YXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVz
ZXI8L3RkPgoJCQk8dGQ+VHdpdHRlciB1c2VyIG5hbWU8L3RkPgoJCQk8dGQ+IDxlbT5hcmNf
dHdpdHRlciB1c2VybmFtZTwvZW0+PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXlu
aW5qYSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5yZXR3ZWV0czwvdGQ+CgkJ
CTx0ZD4xIHRvIGluY2x1ZGUgcmV0d2VldHMsIDAgdG8gZXhjbHVkZSB0aGVtIGZyb20gdGhl
IGZlZWQ8L3RkPgoJCQk8dGQ+MDwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5yZXBsaWVz
PC90ZD4KCQkJPHRkPjEgdG8gaW5jbHVkZSByZXBsaWVzLCAwIHRvIGV4Y2x1ZGUgdGhlbSBm
cm9tIHRoZSBmZWVkPC90ZD4KCQkJPHRkPjE8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+
bGltaXQ8L3RkPgoJCQk8dGQ+TWF4aW11bSBudW1iZXIgb2YgdHdlZXRzIHRvIGRpc3BsYXkg
KG1heC4gMjAwKTwvdGQ+CgkJCTx0ZD4xMDwvdGQ+CgkJCTx0ZD5saW1pdD0mcXVvdDsyNSZx
dW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5mZXRjaDwvdGQ+CgkJCTx0ZD5NYXhp
bXVtIG51bWJlciBvZiB0d2VldHMgdG8gcmV0cmlldmUgZnJvbSBUd2l0dGVyIChtYXguIDIw
MCk8c3VwIGNsYXNzPSJmb290bm90ZSI+PGEgaHJlZj0iI2ZuMTQ5NjQwMTM3MDRmMzdkMTM4
MTczZDkiPjE8L2E+PC9zdXA+PC90ZD4KCQkJPHRkPjA8L3RkPgoJCQk8dGQ+ZmV0Y2g9JnF1
b3Q7NTAmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+ZGF0ZWZvcm1hdDwvdGQ+
CgkJCTx0ZD5Gb3JtYXQgdGhhdCB1cGRhdGUgZGF0ZXMgd2lsbCBhcHBlYXIgYXM8L3RkPgoJ
CQk8dGQ+IDxlbT5BcmNoaXZlIGRhdGUgZm9ybWF0PC9lbT48L3RkPgoJCQk8dGQ+ZGF0ZWZv
cm1hdD0mcXVvdDslYiAlT2UsICVJOiVNICVwJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4K
CQkJPHRkPmxhYmVsPC90ZD4KCQkJPHRkPkxhYmVsIGZvciB0aGUgdG9wIG9mIHRoZSBsaXN0
PC90ZD4KCQkJPHRkPiA8ZW0+bm8gbGFiZWw8L2VtPjwvdGQ+CgkJCTx0ZD5sYWJlbD0mcXVv
dDtNeSBUd2l0dGVyIHRpbWVsaW5lJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRk
PmxhYmVsdGFnPC90ZD4KCQkJPHRkPkluZGVwZW5kZW50IHdyYXB0YWcgZm9yIGxhYmVsPC90
ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0ZD5sYWJlbHRhZz0mcXVvdDto
MyZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5icmVhazwvdGQ+CgkJCTx0ZD48
c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkhUTUw8L3NwYW4+PC9zcGFu
PiB0YWcgKHdpdGhvdXQgYnJhY2tldHMpLCBvciBzdHJpbmcsIHVzZWQgdG8gc2VwYXJhdGUg
dGhlIHVwZGF0ZXM8L3RkPgoJCQk8dGQ+bGk8L3RkPgoJCQk8dGQ+YnJlYWs9JnF1b3Q7YnIm
cXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+d3JhcHRhZzwvdGQ+CgkJCTx0ZD48
c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkhUTUw8L3NwYW4+PC9zcGFu
PiB0YWcgdG8gYmUgdXNlZCBhcyB0aGUgd3JhcHRhZywgd2l0aG91dCBicmFja2V0czwvdGQ+
CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+d3JhcHRhZz0mcXVvdDt1bCZx
dW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3Bh
biBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNs
YXNzIGF0dHJpYnV0ZSBmb3Igd3JhcHRhZzwvdGQ+CgkJCTx0ZD5hcmNfdHdpdHRlcjwvdGQ+
CgkJCTx0ZD5jbGFzcz0mcXVvdDt0d2l0dGVyJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4K
CQkJPHRkPmNsYXNzX3Bvc3RlZDwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNw
YW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBs
aWVkIHRvIHNwYW4gdGFnIGFyb3VuZCBwb3N0ZWQgZGF0ZTwvdGQ+CgkJCTx0ZD5hcmNfdHdp
dHRlci1wb3N0ZWQ8L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxwIGlkPSJmbjE0OTY0MDEz
NzA0ZjM3ZDEzODE3M2Q5IiBjbGFzcz0iZm9vdG5vdGUiPjxzdXA+MTwvc3VwPiBUd2l0dGVy
JiM4MjE3O3MgPHNwYW4gY2xhc3M9ImNhcHMiPkFQSTwvc3Bhbj4gY291bnRzIHRoZSBudW1i
ZXIgb2YgdHdlZXRzIHRvIHJldHVybiBiZWZvcmUgYXBwbHlpbmcgc29tZSBvZiB0aGUgZmls
dGVycywgc28gdGhlIHJlc3BvbnNlIGNhbiBiZSBmZXdlciB0d2VldHMgdGhhbiBleHBlY3Rl
ZC4gVG8gaGVscCBhdm9pZCB0aGlzIHlvdSBjYW4gc2V0IGEgPGVtPmZldGNoPC9lbT4gbGlt
aXQgdGhhdCBpcyBoaWdoZXIgdGhhbiB0aGUgZGlzcGxheSA8ZW0+bGltaXQ8L2VtPiB0aGF0
IHlvdSB3YW50IHRvIG91dHB1dC4gSWYgPGVtPmZldGNoPC9lbT4gaXMgbGVzcyB0aGFuIDxl
bT5saW1pdDwvZW0+IHRoZSBsYXR0ZXIgd2lsbCBiZSB1c2VkIGluc3RlYWQuPC9wPgoKCTxo
Mz5FeGFtcGxlIHVzYWdlPC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyIHVzZXI9JnF1
b3Q7ZHJtb25rZXluaW5qYSZxdW90OyBsaW1pdD0mcXVvdDs1JnF1b3Q7IHdyYXB0YWc9JnF1
b3Q7dWwmcXVvdDsgYnJlYWs9JnF1b3Q7bGkmcXVvdDsgZGF0ZWZvcm1hdD0mcXVvdDslYiAl
T2UsICVJOiVNICVwJnF1b3Q7IC8mZ3Q7PC9wPgoKCTxwPlByb2R1Y2VzIGEgYnVsbGV0IHBv
aW50IGxpc3Qgb2YgdGhlIGxhc3QgNSBUd2l0dGVyIHVwZGF0ZXMgZnJvbSBkcm1vbmtleW5p
bmphJiM4MjE3O3MgVHdpdHRlciBmZWVkIHdpdGggYSBkZWZpbmVkIGRhdGUgZm9ybWF0IHRv
IG92ZXJyaWRlIHRoZSBkZWZhdWx0IGFyY2hpdmUgZGF0ZSBmb3JtYXQuPC9wPgoKCTxoMiBj
bGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX3NlYXJjaF90YWciPlRoZSBhcmNfdHdp
dHRlcl9zZWFyY2ggdGFnPC9oMj4KCgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFy
Y190d2l0dGVyX3NlYXJjaCBoYXNodGFncz0mcXVvdDt0eHAmcXVvdDsgLyZndDs8L3A+CgoJ
PGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4K
CQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhh
bXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5zZWFyY2g8L3RkPgoJCQk8dGQ+Q29t
bWEgc2VwYXJhdGVkIGxpc3Qgb2Ygc2VhcmNoIHdvcmRzPC90ZD4KCQkJPHRkPiA8ZW0+dW5z
ZXQ8L2VtPjwvdGQ+CgkJCTx0ZD5zZWFyY2g9JnF1b3Q7dHhwLHRleHRwYXR0ZXJuJnF1b3Q7
PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmhhc2h0YWdzPC90ZD4KCQkJPHRkPkNvbW1h
IHNlcGFyYXRlZCBsaXN0IG9mIGhhc2h0YWdzIHRvIHNlYXJjaCBmb3IgKG5vdCBpbmNsdWRp
bmcgdGhlIGhhc2gpPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0ZD5o
YXNodGFncz0mcXVvdDt0eHAsdGV4dHBhdHRlcm4mcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRy
PgoJCQk8dGQ+cmVwbHk8L3RkPgoJCQk8dGQ+VXNlcm5hbWUgb2YgdHdlZXRzIGluIHJlcGx5
IHRvPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0ZD5yZXBseT0mcXVv
dDt0d2l0dGVyJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPm1lbnRpb248L3Rk
PgoJCQk8dGQ+VXNlcm5hbWUgb2YgdXNlciBtZW50aW9uZWQgaW4gdHdlZXRzICg8aT5pLmUu
PC9pPiB0d2VldHMgY29udGFpbmluZyBAdXNlcm5hbWUpPC90ZD4KCQkJPHRkPiA8ZW0+dW5z
ZXQ8L2VtPjwvdGQ+CgkJCTx0ZD5tZW50aW9uPSZxdW90O3R3aXR0ZXImcXVvdDs8L3RkPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGltaXQ8L3RkPgoJCQk8dGQ+TWF4aW11bSBudW1iZXIg
b2YgdHdlZXRzIHRvIGRpc3BsYXkgKG1heC4gMjAwKTwvdGQ+CgkJCTx0ZD4xMDwvdGQ+CgkJ
CTx0ZD5saW1pdD0mcXVvdDsyNSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5k
YXRlZm9ybWF0PC90ZD4KCQkJPHRkPkZvcm1hdCB0aGF0IHVwZGF0ZSBkYXRlcyB3aWxsIGFw
cGVhciBhczwvdGQ+CgkJCTx0ZD4gPGVtPkFyY2hpdmUgZGF0ZSBmb3JtYXQ8L2VtPjwvdGQ+
CgkJCTx0ZD5kYXRlZm9ybWF0PSZxdW90OyViICVPZSwgJUk6JU0gJXAmcXVvdDs8L3RkPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFiZWw8L3RkPgoJCQk8dGQ+TGFiZWwgZm9yIHRoZSB0
b3Agb2YgdGhlIGxpc3Q8L3RkPgoJCQk8dGQ+IDxlbT5ubyBsYWJlbDwvZW0+PC90ZD4KCQk8
L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsdGFnPC90ZD4KCQkJPHRkPkluZGVwZW5kZW50IHdy
YXB0YWcgZm9yIGxhYmVsPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90
cj4KCQk8dHI+CgkJCTx0ZD5icmVhazwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+
PHNwYW4gY2xhc3M9ImNhcHMiPkhUTUw8L3NwYW4+PC9zcGFuPiB0YWcgKHdpdGhvdXQgYnJh
Y2tldHMpLCBvciBzdHJpbmcsIHVzZWQgdG8gc2VwYXJhdGUgdGhlIHVwZGF0ZXM8L3RkPgoJ
CQk8dGQ+bGk8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+d3JhcHRhZzwvdGQ+CgkJCTx0
ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkhUTUw8L3NwYW4+PC9z
cGFuPiB0YWcgdG8gYmUgdXNlZCBhcyB0aGUgd3JhcHRhZywgd2l0aG91dCBicmFja2V0czwv
dGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+
Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBz
Ij5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgZm9yIHdyYXB0YWc8L3RkPgoJ
CQk8dGQ+YXJjX3R3aXR0ZXJfc2VhcmNoPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNs
YXNzX3VzZXI8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJj
YXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byBzcGFu
IHRhZyBhcm91bmQgdXNlciBuYW1lPC90ZD4KCQkJPHRkPmFyY190d2l0dGVyLXVzZXI8L3Rk
PgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3NfcG9zdGVkPC90ZD4KCQkJPHRkPjxzcGFu
IGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xh
c3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gc3BhbiB0YWcgYXJvdW5kIHBvc3RlZCBkYXRlPC90
ZD4KCQkJPHRkPmFyY190d2l0dGVyLXBvc3RlZDwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJ
PGgzPkV4YW1wbGUgdXNhZ2U8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfc2VhcmNo
IHNlYXJjaD0mcXVvdDtwbHVnaW4mcXVvdDsgaGFzaHRhZ3M9JnF1b3Q7dHhwLHRleHRwYXR0
ZXJuJnF1b3Q7IGxpbWl0PSZxdW90OzI1JnF1b3Q7IC8mZ3Q7PC9wPgoKCTxwPlByb2R1Y2Vz
IGEgbGlzdCBvZiB0d2VldHMgY29udGFpbmluZyB0aGUgd29yZCAmIzgyMTY7cGx1Z2luJiM4
MjE3OyBhbmQgdGhlIGhhc2h0YWdzICYjODIxNjsjdHhwJiM4MjE3OyBhbmQgJiM4MjE2OyN0
ZXh0cGF0dGVybiYjODIxNzsuIFRoZSB0YWcgd2lsbCByZXR1cm4gYSBtYXhpbXVtIG9mIDI1
IHR3ZWV0cy48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfcmV0
d2VldF90YWciPlRoZSBhcmNfdHdpdHRlcl90d2VldF9idXR0b24gdGFnPC9oMj4KCgk8cD5P
dXRwdXRzIHRoZSBUd2l0dGVyIHR3ZWV0IGJ1dHRvbiAoZm9ybWVybHkgJmx0O3R4cDphcmNf
dHdpdHRlcl9yZXR3ZWV0IC8mZ3Q7KS48L3A+CgoJPGgzPlN5bnRheDwvaDM+CgoJPHA+Jmx0
O3R4cDphcmNfdHdpdHRlcl90d2VldF9idXR0b24gLyZndDs8L3A+CgoJPGgzPlVzYWdlPC9o
Mz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJPHRoPkRlc2Ny
aXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJ
PC90cj4KCQk8dHI+CgkJCTx0ZD51c2VyPC90ZD4KCQkJPHRkPlR3aXR0ZXIgdXNlciBuYW1l
IHRvIHF1b3RlPC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0ZXIgdXNlcm5hbWU8L2VtPjwv
dGQ+CgkJCTx0ZD51c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDs8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+dXJsPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3Bh
biBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPjwvc3Bhbj4gdG8gdHdlZXQ8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+dGV4dDwvdGQ+CgkJCTx0ZD5Ud2VldCB0ZXh0PC90ZD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPmZvbGxvdzE8L3RkPgoJCQk8dGQ+U3VnZ2VzdGVkIFR3aXR0ZXIg
YWNjb3VudCB0byBmb2xsb3csIGZvciBleGFtcGxlIHlvdXIgb3duPC90ZD4KCQkJPHRkPkEg
VHdpdHRlciB1c2VyIHRvIHJlY29tbWVuZDwvdGQ+CgkJCTx0ZD5mb2xsb3cxPSZxdW90O1Rl
eHRwYXR0ZXJuJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmZvbGxvdzI8L3Rk
PgoJCQk8dGQ+QXMgZm9sbG93MTwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFuZzwvdGQ+CgkJCTx0ZD5MYW5ndWFnZTwvdGQ+CgkJ
CTx0ZD5lbjwvdGQ+CgkJCTx0ZD5sYW5nPSZxdW90O2VzJnF1b3Q7PC90ZD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmNvdW50PC90ZD4KCQkJPHRkPkNvdW50IGJveCBwb3NpdGlvbiwgb3B0
aW9uczogbm9uZSwgaG9yaXpvbnRhbCBvciB2ZXJ0aWNhbDwvdGQ+CgkJCTx0ZD5ob3Jpem9u
dGFsPC90ZD4KCQkJPHRkPmNvdW50PSZxdW90O25vbmUmcXVvdDs8L3RkPgoJCTwvdHI+CgkJ
PHRyPgoJCQk8dGQ+aW5jbHVkZV9qczwvdGQ+CgkJCTx0ZD5XaGV0aGVyIG9yIG5vdCB0byBp
bmNsdWRlIHRoZSB3aWRnZXQgSmF2YVNjcmlwdDwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQkJPHRk
PmluY2x1ZGVfanM9JnF1b3Q7MCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5v
cHRpbWlzZV9qczwvdGQ+CgkJCTx0ZD5PcHRpbWlzZSB0aGUgSmF2YVNjcmlwdCBieSB1c2lu
ZyBhIGxvY2FsIHNjcmlwdCByYXRoZXIgdGhhbiB0aGF0IGhvc3RlZCBvbiB0aGUgVHdpdHRl
ciBzaXRlPC90ZD4KCQkJPHRkPjA8L3RkPgoJCQk8dGQ+b3B0aW1pc2VfanM9JnF1b3Q7MSZx
dW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3Bh
biBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNs
YXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHRoZSB0d2VldCBidXR0b248L3RkPgoJCQk8dGQ+
dHdpdHRlci1zaGFyZS1idXR0b248L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxoMiBjbGFz
cz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX2ZvbGxvd19idXR0b25fdGFnIj5UaGUgYXJj
X3R3aXR0ZXJfZm9sbG93X2J1dHRvbiB0YWc8L2gyPgoKCTxwPk91dHB1dHMgdGhlIFR3aXR0
ZXIgZm9sbG93IGJ1dHRvbiAoYW4gYWx0ZXJuYXRpdmUgdmVyc2lvbiBpcyBpbmNsdWRlZCBp
biBhcmNfdHdpdHRlcl9pbnRlbnRzKS48L3A+CgoJPGgzPlN5bnRheDwvaDM+CgoJPHA+Jmx0
O3R4cDphcmNfdHdpdHRlcl9mb2xsb3dfYnV0dG9uIC8mZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwv
aDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNj
cmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+dXNlcjwvdGQ+CgkJCTx0ZD5Ud2l0dGVyIHVzZXIgbmFt
ZSB0byBmb2xsb3c8L3RkPgoJCQk8dGQ+IDxlbT5hcmNfdHdpdHRlciB1c2VybmFtZTwvZW0+
PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZxdW90OzwvdGQ+CgkJPC90
cj4KCQk8dHI+CgkJCTx0ZD5sYW5nPC90ZD4KCQkJPHRkPkxhbmd1YWdlPC90ZD4KCQkJPHRk
PmVuPC90ZD4KCQkJPHRkPmxhbmc9JnF1b3Q7ZXMmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRy
PgoJCQk8dGQ+Y291bnQ8L3RkPgoJCQk8dGQ+V2hldGhlciBvciBub3QgdGhlIGZvbGxvd2Vy
IGNvdW50IGlzIHNob3duPC90ZD4KCQkJPHRkPjE8L3RkPgoJCQk8dGQ+Y291bnQ9JnF1b3Q7
MCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5pbmNsdWRlX2pzPC90ZD4KCQkJ
PHRkPldoZXRoZXIgb3Igbm90IHRvIGluY2x1ZGUgdGhlIHdpZGdldCBKYXZhU2NyaXB0PC90
ZD4KCQkJPHRkPjE8L3RkPgoJCQk8dGQ+aW5jbHVkZV9qcz0mcXVvdDswJnF1b3Q7PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPm9wdGltaXNlX2pzPC90ZD4KCQkJPHRkPk9wdGltaXNl
IHRoZSBKYXZhU2NyaXB0IGJ5IHVzaW5nIGEgbG9jYWwgc2NyaXB0IHJhdGhlciB0aGFuIHRo
YXQgaG9zdGVkIG9uIHRoZSBUd2l0dGVyIHNpdGU8L3RkPgoJCQk8dGQ+MDwvdGQ+CgkJCTx0
ZD5vcHRpbWlzZV9qcz0mcXVvdDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRk
PmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2Fw
cyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gdGhlIGZv
bGxvdyBidXR0b248L3RkPgoJCQk8dGQ+dHdpdHRlci1mb2xsb3ctYnV0dG9uPC90ZD4KCQk8
L3RyPgoJPC90YWJsZT4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl90
d2VldF91cmwiPmFyY190d2l0dGVyX3R3ZWV0X3VybDwvaDI+CgoJPHA+UmV0dXJucyB0aGUg
PHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4gb2YgdGhlIFR3aXR0ZXIgc3RhdHVzIGZv
ciBhbiBhcnRpY2xlLjwvcD4KCgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190
d2l0dGVyX3R3ZWV0X3VybCAvJmd0OzwvcD4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyX3R3
ZWV0X3VybCZndDtMaW5rIHRleHQmbHQ7L3R4cDphcmNfdHdpdHRlcl90d2VldF91cmwmZ3Q7
PC9wPgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0
ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJ
PHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aWQ8L3RkPgoJCQk8dGQ+
VGV4dHBhdHRlcm4gYXJ0aWNsZSBJRDwvdGQ+CgkJCTx0ZD4gPGVtPmN1cnJlbnQgYXJ0aWNs
ZTwvZW0+PC90ZD4KCQkJPHRkPmlkPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRy
PgoJCQk8dGQ+dGl0bGU8L3RkPgoJCQk8dGQ+VGl0bGUgYXR0cmlidXRlIG9mIHRoZSBsaW5r
PC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNh
cHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHRoZSBs
aW5rPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+
CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfdGlueXVybCI+YXJjX3R3
aXR0ZXJfdGlueXVybDwvaDI+CgoJPHA+UmV0dXJucyB0aGUgc2hvcnRlbmVkIDxzcGFuIGNs
YXNzPSJjYXBzIj5VUkw8L3NwYW4+IG9mIHRoZSBhcnRpY2xlIHVzZWQgZm9yIHRoZSBUd2l0
dGVyIHVwZGF0ZS48L3A+CgoJPGgzPlN5bnRheDwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdp
dHRlcl90aW55dXJsIC8mZ3Q7PC9wPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfdGlueXVy
bCZndDtMaW5rIHRleHQmbHQ7L3R4cDphcmNfdHdpdHRlcl90aW55dXJsJmd0OzwvcD4KCgk8
aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJ
CQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFt
cGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmlkPC90ZD4KCQkJPHRkPlRleHRwYXR0
ZXJuIGFydGljbGUgSUQ8L3RkPgoJCQk8dGQ+IDxlbT5jdXJyZW50IGFydGljbGU8L2VtPjwv
dGQ+CgkJCTx0ZD5pZD0mcXVvdDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRk
PnRpdGxlPC90ZD4KCQkJPHRkPlRpdGxlIGF0dHJpYnV0ZSBvZiB0aGUgbGluazwvdGQ+CgkJ
CTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8
L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8
L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byB0aGUgbGluazwvdGQ+
CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxoMiBj
bGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX2NhY2hpbmciPkNhY2hpbmc8L2gyPgoK
CTxwPkluIG9yZGVyIHRvIHByZXZlbnQgZXhjZXNzaXZlIHJlcGVhdGl0aXZlIGNhbGxzIHRv
IHRoZSBUd2l0dGVyIHdlYnNpdGUgaXQgaXMgcmVjb21tZW5kZWQgdG8gY2FjaGUgcmVzdWx0
cy4gVHdpdHRlciBsaW1pdHMgdGhlIG51bWJlciBvZiBjYWxscyB0aHJvdWdoIHRoZSA8c3Bh
biBjbGFzcz0iY2FwcyI+QVBJPC9zcGFuPiwgYW5kIGNvbnRpbnVvdXMgY2FsbHMgd2lsbCBy
ZXN1bHQgaW4gVHdpdHRlciBjbG9zaW5nIHRvIGZ1cnRoZXIgcmVxdWVzdHMuIEJ5IGRlZmF1
bHQsIGFyY190d2l0dGVyIGNhY2hlcyBmb3IgMzAgbWludXRlIGludGVydmFscy48L3A+CgoJ
PHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlv
bjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+Y2FjaGluZzwvdGQ+CgkJCTx0ZD4mIzgyMTY7MSYjODIxNzsgdG8g
Y2FjaGUgZmVlZCwgJiM4MjE2OzAmIzgyMTc7IHRvIHR1cm4gY2FjaGluZyBvZmYgKG5vdCBy
ZWNvbW1lbmRlZCk8L3RkPgoJCQk8dGQ+MTwvdGQ+CgkJCTx0ZD5jYWNoaW5nPSZxdW90OzEm
cXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2FjaGVfZGlyPC90ZD4KCQkJPHRk
PkFic29sdXRlIHBhdGggdG8gdGhlIGNhY2hlIGRpcmVjdG9yeSAobXVzdCBiZSB3cml0YWJs
ZSk8L3RkPgoJCQk8dGQ+IDxlbT5hcmNfdHdpdHRlciBwcmVmZXJlbmNlczwvZW0+PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNhY2hlX3RpbWU8L3RkPgoJCQk8dGQ+VGltZSBpbiBt
aW51dGVzIHRoYXQgdGhlIGNhY2hlIGZpbGVzIGFyZSBzdG9yZWQgYmVmb3JlIGJlaW5nIHJl
ZnJlc2hlZDwvdGQ+CgkJCTx0ZD41PC90ZD4KCQkJPHRkPmNhY2hlX3RpbWU9JnF1b3Q7MzAm
cXVvdDs8L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxwPlRoZSBhZG1pbiBzaWRlIG9mIHRo
aXMgcGx1Z2luIGVuZm9yY2VzIGNhY2hpbmcsIGFwYXJ0IGZyb20gd2hlbiBpdCBpcyBwb3N0
aW5nIHRvIFR3aXR0ZXIgKDxpPmUuZy48L2k+IHdoZW4gcG9zdGluZyBvciBkZWxldGluZyBh
biB1cGRhdGUpLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9w
cmVmcyI+UHJlZmVyZW5jZXM8L2gyPgoKCTxwPllvdSBjYW4gYWNjZXNzIHRoZSBwbHVnaW5z
IGNvcmUgcHJlZmVyZW5jZXMgZnJvbSBlaXRoZXIgdGhlIFByZWZlcmVuY2VzIG9yIFBsdWdp
bnMgdGFicyBpbiBhZG1pbi4gU2V0dXAgeW91ciBUd2l0dGVyIGFjY291bnQgKHlvdSB3aWxs
IGJlIGFza2VkIHRvIGNvbm5lY3QgdmlhIFR3aXR0ZXIgYW5kIHRoaXMgbmVlZHMgZG9pbmcg
YmVmb3JlIHlvdSBjYW4gdXNlIHRoZSBwbHVnaW4pIGFuZCBjaGFuZ2UgdGhlIGNhY2hlIGRp
cmVjdG9yeSB1c2luZyBhcmNfdHdpdHRlciYjODIxNztzIHByZWZlcmVuY2VzLiBXaXRob3V0
IHByb3ZpZGluZyB5b3VyIGFjY291bnQgbG9naW4gZGV0YWlscyB0aGUgYWRtaW4gYXJlYSBm
ZWF0dXJlcyBvZiB0aGlzIHBsdWdpbiB3aWxsIGJlIGluYWN0aXZlLjwvcD4KCgk8cD5Zb3Ug
Y2FuIHNlbGVjdCB0aGUgPHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4gc2hvcnRlbmVy
IG1ldGhvZCB5b3Ugd2FudCB0byB1c2UgdG8gbGluayBiYWNrIHRvIHlvdXIgYXJ0aWNsZSBv
biBUd2l0dGVyLiBQbGVhc2Ugbm90ZSB0aGF0IGlmIHlvdSBzZWxlY3Qgc21kX3Nob3J0X3Vy
bCB5b3Ugd2lsbCBuZWVkIHRvIGhhdmUgaW5zdGFsbGVkIGFuZCBhY3RpdmF0ZWQgdGhlIDxh
IGhyZWY9Imh0dHA6Ly90ZXh0cGF0dGVybi5vcmcvcGx1Z2lucy8xMDk5L3NtZF9zaG9ydF91
cmwiPjxzcGFuIGNsYXNzPSJ0YWciPnNtZF9zaG9ydF91cmw8L3NwYW4+IHBsdWdpbjwvYT4g
ZGV2ZWxvcGVkIGJ5IFN0ZWYgRGF3c29uLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlk
PSJhcmNfdHdpdHRlcl9hcnRpY2xlIj5Ud2VldGluZyBhcnRpY2xlczwvaDI+CgoJPHA+Qnkg
ZGVmYXVsdCBhcmNfdHdpdHRlciB3aWxsIHBvc3QgYW4gdXBkYXRlIHRvIFR3aXR0ZXIgaW5j
bHVkaW5nIGEgc2hvcnRlbmVkIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+IHRvIHlv
dXIgYXJ0aWNsZS4gT25seSBsaXZlIGFuZCBhY3RpdmUgYXJ0aWNsZXMgd2lsbCBiZSBzZW50
IHRvIFR3aXR0ZXIsIDxpPmkuZS48L2k+IGFydGljbGVzIHBvc3RlZCBpbiB0aGUgZnV0dXJl
IG9yIGFzIHN0aWNreSBhcnRpY2xlcyB3aWxsIG5vdCBiZSBzZW50LiBJZiB5b3VyIGFydGlj
bGUgaXMgc3VjY2Vzc2Z1bGx5IHN1Ym1pdHRlZCB0byBUd2l0dGVyIHRoZSB1cGRhdGUgd2ls
bCBhcHBlYXIgaW4gcGxhY2Ugb2YgdGhlIFR3aXR0ZXIgb3B0aW9uIG9uIHRoZSByaWdodC1o
YW5kLXNpZGUgb2YgdGhlIGFydGljbGUgZWRpdCBzY3JlZW4uPC9wPgoKCTxwPlR3ZWV0cyBh
cmUgc2VudCBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDogPGVtPlR3ZWV0IHByZWZpeDwvZW0+
IDxlbT5BcnRpY2xlIHRpdGxlPC9lbT4gPGVtPlNob3J0ZW5lZCA8c3BhbiBjbGFzcz0iY2Fw
cyI+VVJMPC9zcGFuPjwvZW0+IDxlbT5Ud2VldCBzdWZmaXg8L2VtPi4gWW91IGNhbiBjaGFu
Z2UgdGhlIHByZWZpeCBhbmQgc3VmZml4IG9uIGFuIGFydGljbGUtYnktYXJ0aWNsZSBiYXNp
cyBieSBjaGFuZ2luZyB0aGUgdHdlZXQgb3B0aW9ucyB1bmRlciAmIzgyMTY7VXBkYXRlIFR3
aXR0ZXImIzgyMTc7IG9uIHRoZSBhcnRpY2xlIGVkaXRvciBzY3JlZW4uIFRoZSBkZWZhdWx0
IDxlbT5Ud2VldCBwcmVmaXg8L2VtPiBjYW4gYmUgc2V0IHVuZGVyIHRoZSA8c3BhbiBjbGFz
cz0idGFnIj5hcmNfdHdpdHRlcjwvc3Bhbj4gcHJlZmVyZW5jZXMgc2NyZWVuICh0aGUgZGVm
YXVsdCBvbiBpbnN0YWxsYXRpb24gaXMgJiM4MjIwO0p1c3QgcG9zdGVkOiYjODIyMTspLjwv
cD4KCgk8cD5QbGVhc2Ugbm90ZSB0aGF0IG9uY2UgYW4gYXJ0aWNsZSBoYXMgYmVlbiB0d2Vl
dGVkIHRoZSB0d2VldCBjYW5ub3QgYmUgZWRpdGVkLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rp
b24iIGlkPSJhcmNfdHdpdHRlcl9hZG1pbiI+VGhlIFR3aXR0ZXIgdGFiPC9oMj4KCgk8cD5V
bmRlciB0aGUgRXh0ZW5zaW9ucyB0YWIgKHRoaXMgY2FuIGJlIGNoYW5nZWQgZnJvbSB0aGUg
cGx1Z2luJiM4MjE3O3MgcHJlZmVyZW5jZSBwYWdlKSBhIG5ldyBUd2l0dGVyIHRhYiBzaG91
bGQgYXBwZWFyIG9uY2UgeW91IGhhdmUgY29ubmVjdGVkIHlvdXIgc2l0ZSB0byB5b3VyIFR3
aXR0ZXIgYWNjb3VudC4gRnJvbSBoZXJlIHlvdSB3aWxsIGJlIGFibGUgdG8gc3VibWl0IG5l
dyBUd2l0dGVyIHVwZGF0ZXMsIHZpZXcgYmFzaWMgYWNjb3VudCBzdGF0aXN0aWNzLCBhbmQg
Y2hlY2sgb3V0IHlvdXIgcmVjZW50IHVwZGF0ZXMgKGluY2x1ZGluZyB0aGUgb3B0aW9uIHRv
IGRlbGV0ZSB5b3VyIHR3ZWV0cykuPC9wPiI7czo0OiJjb2RlIjtzOjc2NTkwOiJnbG9iYWwg
JHByZWZzLCR0eHBjZmcsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCRhcmNfdHdpdHRlcl9j
b25zdW1lclNlY3JldDsKCiRhcmNfdHdpdHRlciA9IGFycmF5KCk7CgokYXJjX3R3aXR0ZXJf
Y29uc3VtZXJLZXkgPSAnbktjWHNsd3paaEJkMGtmS01ldG5QQSc7CiRhcmNfdHdpdHRlcl9j
b25zdW1lclNlY3JldCA9ICdDNm5TUENMM2VlSEdUQmhLQ2d3ZDlvY2xjdUQwc3JCOFdWa2ZY
UVlDNTQnOwoKYWRkX3ByaXZzKCdwbHVnaW5fcHJlZnMuYXJjX3R3aXR0ZXInLCcxLDInKTsK
cmVnaXN0ZXJfY2FsbGJhY2soJ2FyY190d2l0dGVyX2luc3RhbGwnLCdwbHVnaW5fbGlmZWN5
Y2xlLmFyY190d2l0dGVyJywgJ2luc3RhbGxlZCcpOwpyZWdpc3Rlcl9jYWxsYmFjaygnYXJj
X3R3aXR0ZXJfdW5pbnN0YWxsJywncGx1Z2luX2xpZmVjeWNsZS5hcmNfdHdpdHRlcicsICdk
ZWxldGVkJyk7CnJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfdHdpdHRlcl9wcmVmcycsJ3BsdWdp
bl9wcmVmcy5hcmNfdHdpdHRlcicpOwoKLyoKICogU2V0dXAgaW5pdGlhbCBwcmVmZXJlbmNl
cyBpZiBub3QgaW4gdGhlIHR4cF9wcmVmcyB0YWJsZS4KICovCmlmICghaXNzZXQoJHByZWZz
WydhcmNfdHdpdHRlcl91c2VyJ10pKQogICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3VzZXIn
LCAnJywgJ2FyY190d2l0dGVyJywgMSwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3NldCgkcHJl
ZnNbJ2FyY190d2l0dGVyX3ByZWZpeCddKSkKICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfcHJl
Zml4JywnSnVzdCBwb3N0ZWQ6JywgJ2FyY190d2l0dGVyJywgMiwgJ3RleHRfaW5wdXQnKTsK
aWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX3N1ZmZpeCddKSkKICBzZXRfcHJlZign
YXJjX3R3aXR0ZXJfc3VmZml4JywnJywgJ2FyY190d2l0dGVyJywgMiwgJ3RleHRfaW5wdXQn
KTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX2NhY2hlX2RpciddKSkKICBzZXRf
cHJlZignYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJywkdHhwY2ZnWyd0eHBhdGgnXS4kcHJlZnNb
J3RlbXBkaXInXSwgJ2FyY190d2l0dGVyJywgMSwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3Nl
dCgkcHJlZnNbJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnXSkpCiAgc2V0X3ByZWYoJ2Fy
Y190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnLCAxLCAnYXJjX3R3aXR0ZXInLCAyLCAneWVzbm9S
YWRpbycpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddKSkK
ICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCcsICd0aW55dXJsJywgJ2FyY190
d2l0dGVyJywgMiwKICAgICdhcmNfdHdpdHRlcl91cmxfbWV0aG9kX3NlbGVjdCcpOwppZiAo
IWlzc2V0KCRwcmVmc1snYXJjX3Nob3J0X3VybCddKSkKICBzZXRfcHJlZignYXJjX3Nob3J0
X3VybCcsIDAsICdhcmNfdHdpdHRlcicsIDIsICd5ZXNub1JhZGlvJyk7CmlmICghaXNzZXQo
JHByZWZzWydhcmNfc2hvcnRfc2l0ZV91cmwnXSkpCiAgc2V0X3ByZWYoJ2FyY19zaG9ydF9z
aXRlX3VybCcsICRwcmVmc1snc2l0ZXVybCddLCAnYXJjX3R3aXR0ZXInLCAyLCAndGV4dF9p
bnB1dCcpOwovLyBNYWtlIHN1cmUgdGhhdCB0aGUgVHdpdHRlciB0YWIgaGFzIGJlZW4gZGVm
aW5lZAppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfdGFiJ10pKSB7CiAgc2V0X3By
ZWYoJ2FyY190d2l0dGVyX3RhYicsICdleHRlbnNpb25zJywgJ2FyY190d2l0dGVyJywgMiwK
ICAgICdhcmNfdHdpdHRlcl90YWJfc2VsZWN0Jyk7CiAgICAkcHJlZnNbJ2FyY190d2l0dGVy
X3RhYiddID0gJ2V4dGVuc2lvbnMnOwp9CgovLyBDaGVjayBpZiBhcmNfc2hvcnRfdXJsIGlz
IGVuYWJsZWQKaWYgKChpc3NldCgkcHJlZnNbJ2FyY19zaG9ydF91cmwnXSkmJiRwcmVmc1sn
YXJjX3Nob3J0X3VybCddKQp8fCAoaXNzZXQoJHByZWZzWydhcmNfc2hvcnRfdXJsX21ldGhv
ZCddKSYmJHByZWZzWydhcmNfdHdpdHRlcl91cmxfbWV0aG9kJ109PSdhcmNfdHdpdHRlcicp
KSB7CiAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19zaG9ydF91cmxfcmVkaXJlY3QnLCAndHhw
X2RpZScsIDQwNCk7Cn0KCmlmIChAdHhwaW50ZXJmYWNlID09ICdhZG1pbicpIHsKICAgIHJl
Z2lzdGVyX2NhbGxiYWNrKCdfYXJjX3R3aXR0ZXJfYXV0b19lbmFibGUnLCAncGx1Z2luX2xp
ZmVjeWNsZS5hcmNfdHdpdHRlcicsICdpbnN0YWxsZWQnKTsKICAgIGlmICghZW1wdHkoJHBy
ZWZzWydhcmNfdHdpdHRlcl91c2VyJ10pCiAgICAgICAgJiYgIWVtcHR5KCRwcmVmc1snYXJj
X3R3aXR0ZXJfYWNjZXNzVG9rZW4nXSkKICAgICAgICAmJiAhZW1wdHkoJHByZWZzWydhcmNf
dHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKSApIHsKCiAgICAgICAgaWYgKCRwcmVmc1sn
YXJjX3R3aXR0ZXJfdGFiJ10pIHsKICAgICAgICAgICAgYWRkX3ByaXZzKCdhcmNfYWRtaW5f
dHdpdHRlcicsICcxLDIsMyw0Jyk7CiAgICAgICAgICAgIHJlZ2lzdGVyX3RhYigkcHJlZnNb
J2FyY190d2l0dGVyX3RhYiddLCAnYXJjX2FkbWluX3R3aXR0ZXInLCAnVHdpdHRlcicpOwog
ICAgICAgICAgICByZWdpc3Rlcl9jYWxsYmFjaygnYXJjX2FkbWluX3R3aXR0ZXInLCAnYXJj
X2FkbWluX3R3aXR0ZXInKTsKICAgICAgICB9CgogICAgICAgIHJlZ2lzdGVyX2NhbGxiYWNr
KCdhcmNfYXJ0aWNsZV90d2VldCcsICdwaW5nJyk7CiAgICAgICAgcmVnaXN0ZXJfY2FsbGJh
Y2soJ2FyY19hcnRpY2xlX3R3ZWV0JywgJ2FydGljbGUnLCAnZWRpdCcsIDEpOwogICAgICAg
IHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYXBwZW5kX3R3aXR0ZXInLCAnYXJ0aWNsZV91aScs
ICdzdGF0dXMnKTsKICAgIH0KfQoKLyoKICAgIFB1YmxpYy1zaWRlIGZ1bmN0aW9ucwogICAg
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PQoqLwoKZnVuY3Rpb24gYXJjX3R3aXR0ZXIoJGF0dHMpCnsKICBnbG9iYWwg
JHByZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVy
U2VjcmV0OwoKICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgJ3VzZXInICAgICAgPT4gJHBy
ZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sCiAgICAncGFzc3dvcmQnICA9PiAnJywKICAgICd0
aW1lbGluZScgID0+ICd1c2VyJywKICAgICdsaW1pdCcgICAgID0+ICcxMCcsCiAgICAnZmV0
Y2gnICAgICA9PiAwLAogICAgJ3JldHdlZXRzJyAgPT4gZmFsc2UsCiAgICAncmVwbGllcycg
ICA9PiB0cnVlLAogICAgJ2RhdGVmb3JtYXQnPT4gJHByZWZzWydhcmNoaXZlX2RhdGVmb3Jt
YXQnXSwKICAgICdjYWNoaW5nJyAgID0+ICcxJywKICAgICdjYWNoZV9kaXInID0+ICRwcmVm
c1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10sCiAgICAnY2FjaGVfdGltZSc9PiAnNScsCiAg
ICAnbGFiZWwnICAgICA9PiAnJywKICAgICdsYWJlbHRhZycgID0+ICcnLAogICAgJ2JyZWFr
JyAgICAgPT4gJ2xpJywKICAgICd3cmFwdGFnJyAgID0+ICcnLAogICAgJ2NsYXNzJyAgICAg
PT4gX19GVU5DVElPTl9fLAogICAgJ2NsYXNzX3Bvc3RlZCcgPT4gX19GVU5DVElPTl9fLict
cG9zdGVkJwogICAgKSwkYXR0cykpOwoKICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJj
X3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3Vt
ZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXQogICAgICAgICAg
ICAsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSk7CgogIGlmICgk
Y2FjaGluZykgeyAgLy8gdHVybiBvbiBjYWNoaW5nLCByZWNvbW1lbmRlZCAoZGVmYXVsdCkK
ICAgICR0d2l0LT5zZXRDYWNoaW5nKHRydWUpOwogICAgJHR3aXQtPmNhY2hlRGlyKCRjYWNo
ZV9kaXIpOwogICAgJHR3aXQtPmNhY2hlVGltZSgkY2FjaGVfdGltZSk7CiAgfSBlbHNlIHsg
IC8vIHR1cm4gb2ZmIGNhY2hpbmcsIG5vdCByZWNvbW1lbmRlZCBvdGhlciB0aGFuIGZvciB0
ZXN0aW5nCiAgICAkdHdpdC0+c2V0Q2FjaGluZyhmYWxzZSk7CiAgfQoKICBzd2l0Y2ggKCR0
aW1lbGluZSkgewogICAgY2FzZSAnaG9tZSc6IGNhc2UgJ2ZyaWVuZHMnOgogICAgICAkdGlt
ZWxpbmUgPSAnc3RhdHVzZXMvZnJpZW5kc190aW1lbGluZSc7IGJyZWFrOwogICAgY2FzZSAn
bWVudGlvbnMnOgogICAgICAkdGltZWxpbmUgPSAnc3RhdHVzZXMvbWVudGlvbnMnOyBicmVh
azsKICAgIGNhc2UgJ3VzZXInOiBkZWZhdWx0OiAkdGltZWxpbmUgPSAnc3RhdHVzZXMvdXNl
cl90aW1lbGluZSc7CiAgfQoKICAvLyBDaGVjayB0aGF0IHRoZSBmZXRjaCAoVHdpdHRlcidz
IGNvdW50IGF0dHJpYnV0ZSkgaXMgc2V0IGNvcnJlY3RseQogICRmZXRjaCA9ICghJGZldGNo
IHx8ICRmZXRjaDwkbGltaXQpID8gJGxpbWl0IDogJGZldGNoOwoKICAkb3V0ID0gYXJyYXko
KTsKICAkeG1sID0gJHR3aXQtPmdldCgkdGltZWxpbmUsIGFycmF5KAogICAgICAnc2NyZWVu
X25hbWUnPT4kdXNlciwKICAgICAgJ2NvdW50Jz0+JGZldGNoLAogICAgICAnaW5jbHVkZV9y
dHMnPT4kcmV0d2VldHMsCiAgICAgICdleGNsdWRlX3JlcGxpZXMnPT4hJHJlcGxpZXMKICAg
ICkpOwogIGlmICgkeG1sKSB7CiAgICAkdHdlZXRzID0gQCR4bWwtPnhwYXRoKCcvc3RhdHVz
ZXMvc3RhdHVzJyk7CiAgICBpZiAoJHR3ZWV0cykgewogICAgICAvLyBBcHBseSB0aGUgZGlz
cGxheSBsaW1pdCB0byB0aGUgcmV0dXJuZWQgdHdlZXRzCiAgICAgICR0d2VldHMgPSBhcnJh
eV9zbGljZSgkdHdlZXRzLCAwLCAkbGltaXQpOwogICAgICBmb3JlYWNoICgkdHdlZXRzIGFz
ICR0d2VldCkgewogICAgICAgICR0aW1lID0gc3RydG90aW1lKGh0bWxlbnRpdGllcygkdHdl
ZXQtPmNyZWF0ZWRfYXQpKTsKICAgICAgICAkZGF0ZSA9IHNhZmVfc3RyZnRpbWUoJGRhdGVm
b3JtYXQsJHRpbWUpOwogICAgICAgICRvdXRbXSA9IGFyY19Ud2l0dGVyOjptYWtlTGlua3Mo
aHRtbGVudGl0aWVzKCR0d2VldC0+dGV4dCwgRU5UX1FVT1RFUywnVVRGLTgnKSkKICAgICAg
ICAgIC4nICcudGFnKGh0bWxlbnRpdGllcygkZGF0ZSksJ3NwYW4nLCcgY2xhc3M9IicuJGNs
YXNzX3Bvc3RlZC4nIicpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIGRvTGFiZWwoJGxh
YmVsLCAkbGFiZWx0YWcpLmRvV3JhcCgkb3V0LCAkd3JhcHRhZywgJGJyZWFrLCAkY2xhc3Mp
OwogIH0KCn0KCmZ1bmN0aW9uIGFyY190d2l0dGVyX3NlYXJjaCgkYXR0cykKewogICAgZ2xv
YmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRlcl9jb25z
dW1lclNlY3JldDsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAgICd1c2VyJyAg
ICAgID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLAogICAgICAgICdzZWFyY2gnICAg
ID0+ICcnLAogICAgICAgICdoYXNodGFncycgID0+ICcnLAogICAgICAgICd1c2VyJyAgICAg
ID0+ICcnLAogICAgICAgICdyZXBseScgICAgID0+ICcnLAogICAgICAgICdtZW50aW9uJyAg
ID0+ICcnLAogICAgICAgICdsaW1pdCcgICAgID0+ICcxMCcsCiAgICAgICAgJ2xhbmcnICAg
ICAgPT4gJycsCiAgICAgICAgJ2RhdGVmb3JtYXQnPT4gJHByZWZzWydhcmNoaXZlX2RhdGVm
b3JtYXQnXSwKICAgICAgICAnY2FjaGluZycgICA9PiAnMScsCiAgICAgICAgJ2NhY2hlX2Rp
cicgPT4gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXSwKICAgICAgICAnY2FjaGVf
dGltZSc9PiAnNScsCiAgICAgICAgJ2xhYmVsJyAgICAgPT4gJycsCiAgICAgICAgJ2xhYmVs
dGFnJyAgPT4gJycsCiAgICAgICAgJ2JyZWFrJyAgICAgPT4gJ2xpJywKICAgICAgICAnd3Jh
cHRhZycgICA9PiAnJywKICAgICAgICAnY2xhc3MnICAgICA9PiBfX0ZVTkNUSU9OX18sCiAg
ICAgICAgJ2NsYXNzX3Bvc3RlZCcgPT4gX19GVU5DVElPTl9fLictcG9zdGVkJywKICAgICAg
ICAnY2xhc3NfdXNlcicgICA9PiBfX0ZVTkNUSU9OX18uJy11c2VyJwogICAgKSwkYXR0cykp
OwoKICAgICAgICAkdHdpdCA9IG5ldyBhcmNfVHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3Vt
ZXJLZXkKICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQpOwoKICAg
ICAgICBpZiAoJGNhY2hpbmcpIHsgIC8vIHR1cm4gb24gY2FjaGluZywgcmVjb21tZW5kZWQg
KGRlZmF1bHQpCiAgICAgICAgICAgICR0d2l0LT5zZXRDYWNoaW5nKHRydWUpOwogICAgICAg
ICAgICAkdHdpdC0+Y2FjaGVEaXIoJGNhY2hlX2Rpcik7CiAgICAgICAgICAgICR0d2l0LT5j
YWNoZVRpbWUoJGNhY2hlX3RpbWUpOwogICAgICAgIH0gZWxzZSB7ICAvLyB0dXJuIG9mZiBj
YWNoaW5nLCBub3QgcmVjb21tZW5kZWQgb3RoZXIgdGhhbiBmb3IgdGVzdGluZwogICAgICAg
ICAgICAkdHdpdC0+c2V0Q2FjaGluZyhmYWxzZSk7CiAgICAgICAgfQoKICAgICAgICAvLyBj
b25zdHJ1Y3Qgc2VhcmNoIHF1ZXJ5CiAgICAgICAgaWYgKCFlbXB0eSgkc2VhcmNoKSkgewog
ICAgICAgICAgICAkdGVybXMgPSBleHBsb2RlKCcsJywkc2VhcmNoKTsgJHRlcm1zID0gYXJy
YXlfbWFwKCd0cmltJywkdGVybXMpOwogICAgICAgICAgICAkc2VhcmNoID0gaW1wbG9kZSgn
ICcsJHRlcm1zKTsKICAgICAgICB9CiAgICAgICAgaWYgKCRoYXNodGFncykgewogICAgICAg
ICAgICAkaGFzaGVzID0gZXhwbG9kZSgnLCcsJGhhc2h0YWdzKTsgJGhhc2hlcyA9IGFycmF5
X21hcCgndHJpbScsJGhhc2hlcyk7CiAgICAgICAgICAgICRzZWFyY2guPSAoKCRzZWFyY2gp
PycgJzonJykuJyMnLmltcGxvZGUoJyAjJywkaGFzaGVzKTsKICAgICAgICB9CiAgICAgICAg
aWYgKCRyZXBseSkgewogICAgICAgICAgICAkc2VhcmNoLj0gKCgkc2VhcmNoKT8nICc6Jycp
Lid0bzonLnRyaW0oJHJlcGx5KTsKICAgICAgICB9CiAgICAgICAgaWYgKCR1c2VyKSB7CiAg
ICAgICAgICAgICRzZWFyY2guPSAoKCRzZWFyY2gpPycgJzonJykuJ2Zyb206Jy50cmltKCR1
c2VyKTsKICAgICAgICB9CiAgICAgICAgaWYgKCRtZW50aW9uKSB7CiAgICAgICAgICAgICRz
ZWFyY2guPSAoKCRzZWFyY2gpPycgJzonJykuJ0AnLnRyaW0oJG1lbnRpb24pOwogICAgICAg
IH0KCiAgICAgICAgaWYgKGVtcHR5KCRzZWFyY2gpKSB7CiAgICAgICAgICAgIHJldHVybiAn
JzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkc2VhcmNoID0gdXJsZW5jb2RlKCRz
ZWFyY2gpOwogICAgICAgIH0KCiAgICAgICAgJG91dCA9IGFycmF5KCk7CiAgICAgICAgJHR3
ZWV0cyA9ICR0d2l0LT5nZXQoJ2h0dHA6Ly9zZWFyY2gudHdpdHRlci5jb20vc2VhcmNoLmF0
b20/cT0nLiRzZWFyY2gKICAgICAgICAgICAgLCBhcnJheSgncnBwJz0+JGxpbWl0LCdsYW5n
Jz0+JGxhbmcpKTsKCiAgICAgICAgaWYgKCR0d2VldHMpIHsgZm9yZWFjaCAoJHR3ZWV0cy0+
ZW50cnkgYXMgJHR3ZWV0KSB7CiAgICAgICAgICAgIHByZWdfbWF0Y2goIi8oLiopIFwoKC4q
KVwpLyIsJHR3ZWV0LT5hdXRob3ItPm5hbWUsJG1hdGNoZXMpOwogICAgICAgICAgICBsaXN0
KCRhdXRob3IsJHVuYW1lLCRuYW1lKSA9ICRtYXRjaGVzOwogICAgICAgICAgICAkdGltZSA9
IHN0cnRvdGltZShodG1sZW50aXRpZXMoJHR3ZWV0LT5wdWJsaXNoZWQpKTsKICAgICAgICAg
ICAgJGRhdGUgPSBzYWZlX3N0cmZ0aW1lKCRkYXRlZm9ybWF0LCR0aW1lKTsKICAgICAgICAg
ICAgJHRleHQgPSAkdHdlZXQtPnRpdGxlOwogICAgICAgICAgICAkb3V0W10gPSB0YWcoaHJl
ZihodG1sZW50aXRpZXMoJHVuYW1lKSwkdHdlZXQtPmF1dGhvci0+dXJpLAogICAgICAgICAg
ICAgICAgJyB0aXRsZT0iJy5odG1sZW50aXRpZXMoJG5hbWUpLiciJykuJzogJywnc3BhbicK
ICAgICAgICAgICAgICAgICAgICAsJyBjbGFzcz0iJy4kY2xhc3NfdXNlci4nIicpCiAgICAg
ICAgICAgICAgICAuYXJjX1R3aXR0ZXI6Om1ha2VMaW5rcyhodG1sZW50aXRpZXMoJHRleHQs
IEVOVF9RVU9URVMsJ1VURi04JykpCiAgICAgICAgICAgICAgICAuJyAnLnRhZyhodG1sZW50
aXRpZXMoJGRhdGUpLCdzcGFuJwogICAgICAgICAgICAgICAgICAgICwnIGNsYXNzPSInLiRj
bGFzc19wb3N0ZWQuJyInKTsKICAgICAgICB9IHJldHVybiBkb0xhYmVsKCRsYWJlbCwgJGxh
YmVsdGFnKQogICAgICAgICAgICAuZG9XcmFwKCRvdXQsICR3cmFwdGFnLCAkYnJlYWssICRj
bGFzcyk7IH0KCn0KCmZ1bmN0aW9uIGFyY190d2l0dGVyX3R3ZWV0KCRhdHRzKSB7CiAgICBn
bG9iYWwgJHRoaXNhcnRpY2xlOwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICdp
ZCcgICAgICAgID0+ICR0aGlzYXJ0aWNsZVsndGhpc2lkJ10sCiAgICAgICdpbmNsdWRlX3Vy
bCcgICA9PiB0cnVlCiAgICApLCRhdHRzKSk7CgogICAgaWYgKCRpZCkgewogICAgICAvLyBG
ZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBmcm9tCiAgICAgICR0d2Vl
dCA9ICgkaW5jbHVkZV91cmwpID8gc2FmZV9yb3coInR3ZWV0IiwgJ2FyY190d2l0dGVyJywg
ImFydGljbGVfaWQ9eyRpZH0iKQogICAgICAgIDogc2FmZV9yb3coIlJFUExBQ0UodHdlZXQs
Q09OQ0FUKCcgJyx0aW55dXJsKSwnJykgQVMgdHdlZXQiCiAgICAgICAgICAsICdhcmNfdHdp
dHRlcicsICJhcnRpY2xlX2lkPXskaWR9Iik7CiAgICB9CgogICAgaWYgKCR0d2VldFsndHdl
ZXQnXSkgewogICAgICByZXR1cm4gYXJjX1R3aXR0ZXI6Om1ha2VMaW5rcygKICAgICAgICBo
dG1sZW50aXRpZXMoJHR3ZWV0Wyd0d2VldCddLCBFTlRfUVVPVEVTLCdVVEYtOCcpKTsKICAg
IH0KfQoKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdHdlZXRfdXJsKCRhdHRzLCAkdGhpbmc9bnVs
bCkgewogICAgZ2xvYmFsICR0aGlzYXJ0aWNsZSwkcHJlZnM7CgogICAgZXh0cmFjdChsQXR0
cyhhcnJheSgKICAgICAgJ2lkJyAgICAgID0+ICR0aGlzYXJ0aWNsZVsndGhpc2lkJ10sCiAg
ICAgICd0aXRsZScgICA9PiAnJywKICAgICAgJ2NsYXNzJyAgID0+ICcnCiAgICApLCRhdHRz
KSk7CgogICAgaWYgKCRpZCkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0
byBidWlsZCB0d2VldCBmcm9tCiAgICAgICR0d2VldCA9IHNhZmVfcm93KCJ0d2VldF9pZCIK
ICAgICAgICAsICdhcmNfdHdpdHRlcicsICJhcnRpY2xlX2lkPXskaWR9Iik7CiAgICB9Cgog
ICAgaWYgKCR0d2VldFsndHdlZXRfaWQnXSkgewogICAgICAkdXJsID0gImh0dHA6Ly90d2l0
dGVyLmNvbS8iLiRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLiIvc3RhdHVzLyIuJHR3ZWV0
Wyd0d2VldF9pZCddOwogICAgICBpZiAoJHRoaW5nPT09bnVsbCkgewogICAgICAgIHJldHVy
biAkdXJsOwogICAgICB9CiAgICAgIHJldHVybiBocmVmKHBhcnNlKCR0aGluZyksICR1cmws
CiAgICAgICAgKCR0aXRsZSA/ICcgdGl0bGU9IicuJHRpdGxlLiciJyA6ICcnKQogICAgICAg
IC4oJGNsYXNzID8gJyBjbGFzcz0iJy4kY2xhc3MuJyInIDogJycpKTsKICAgIH0KfQoKZnVu
Y3Rpb24gYXJjX3R3aXR0ZXJfdGlueXVybCgkYXR0cywgJHRoaW5nPW51bGwpIHsKICAgIGds
b2JhbCAkdGhpc2FydGljbGU7CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgJ2lk
JyAgICAgID0+ICR0aGlzYXJ0aWNsZVsndGhpc2lkJ10sCiAgICAgICd0aXRsZScgICA9PiAn
JywKICAgICAgJ2NsYXNzJyAgID0+ICcnCiAgICApLCRhdHRzKSk7CgogICAgaWYgKCRpZCkg
ewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBmcm9t
CiAgICAgICR0d2VldCA9IHNhZmVfcm93KCJ0aW55dXJsIgogICAgICAgICwgJ2FyY190d2l0
dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKTsKICAgIH0KCiAgICBpZiAoJHR3ZWV0Wyd0aW55
dXJsJ10pIHsKICAgICAgaWYgKCR0aGluZz09PW51bGwpIHsKICAgICAgICByZXR1cm4gJHR3
ZWV0Wyd0aW55dXJsJ107CiAgICAgIH0KCiAgICAgIHJldHVybiBocmVmKHBhcnNlKCR0aGlu
ZyksICR0d2VldFsndGlueXVybCddLAogICAgICAgICgkdGl0bGUgPyAnIHRpdGxlPSInLiR0
aXRsZS4nIicgOiAnJykKICAgICAgICAuKCRjbGFzcyA/ICcgY2xhc3M9IicuJGNsYXNzLici
JyA6ICcnKSk7CiAgICB9Cn0KCi8qCiAqIFB1YmxpYyB0YWcgZm9yIG91dHB1dHRpbmcgd2lk
Z2V0IEpTCiAqLwpmdW5jdGlvbiBhcmNfdHdpdHRlcl93aWRnZXRfanMoJGF0dHMpCnsKICBl
eHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAgICdvcHRpbWlzZScgPT4gZmFsc2UKICAgICks
JGF0dHMpKTsKCiAgcmV0dXJuIF9hcmNfdHdpdHRlcl93aWRnZXRfanMoJG9wdGltaXNlKTsK
fQoKZnVuY3Rpb24gX2FyY190d2l0dGVyX3dpZGdldF9qcygkb3B0aW1pc2U9dHJ1ZSkKewog
IGdsb2JhbCAkYXJjX3R3aXR0ZXI7CgogIC8vIENoZWNrIGlmIHdpZGdldCBKUyBoYXMgYWxy
ZWFkeSBiZWVuIG91dHB1dAogIGlmICgkYXJjX3R3aXR0ZXJbJ3dpZGdldF9qcyddKSByZXR1
cm47CgogIGlmICgkb3B0aW1pc2U9PWZhbHNlKSB7CiAgICByZXR1cm4gJzxzY3JpcHQgc3Jj
PSJodHRwOi8vcGxhdGZvcm0udHdpdHRlci5jb20vd2lkZ2V0cy5qcyIgdHlwZT0idGV4dC9q
YXZhc2NyaXB0Ij48L3NjcmlwdD4nOwogIH0KCiAgJGpzID0gPDw8SlMKPHNjcmlwdCB0eXBl
PSJ0ZXh0L2phdmFzY3JpcHQiPgooZnVuY3Rpb24oKSB7CiAgaWYgKHdpbmRvdy5fX3R3aXR0
ZXJJbnRlbnRIYW5kbGVyKSByZXR1cm47CiAgdmFyIGludGVudFJlZ2V4ID0gL3R3aXR0ZXJc
LmNvbShcOlxkezIsNH0pP1wvaW50ZW50XC8oXHcrKS8sCiAgICAgIHdpbmRvd09wdGlvbnMg
PSAnc2Nyb2xsYmFycz15ZXMscmVzaXphYmxlPXllcyx0b29sYmFyPW5vLGxvY2F0aW9uPXll
cycsCiAgICAgIHdpZHRoID0gNTUwLAogICAgICBoZWlnaHQgPSA0MjAsCiAgICAgIHdpbkhl
aWdodCA9IHNjcmVlbi5oZWlnaHQsCiAgICAgIHdpbldpZHRoID0gc2NyZWVuLndpZHRoOwoK
ICBmdW5jdGlvbiBoYW5kbGVJbnRlbnQoZSkgewogICAgZSA9IGUgfHwgd2luZG93LmV2ZW50
OwogICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudCwKICAgICAgICBt
LCBsZWZ0LCB0b3A7CgogICAgd2hpbGUgKHRhcmdldCAmJiB0YXJnZXQubm9kZU5hbWUudG9M
b3dlckNhc2UoKSAhPT0gJ2EnKSB7CiAgICAgIHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2Rl
OwogICAgfQoKICAgIGlmICh0YXJnZXQgJiYgdGFyZ2V0Lm5vZGVOYW1lLnRvTG93ZXJDYXNl
KCkgPT09ICdhJyAmJiB0YXJnZXQuaHJlZikgewogICAgICBtID0gdGFyZ2V0LmhyZWYubWF0
Y2goaW50ZW50UmVnZXgpOwogICAgICBpZiAobSkgewogICAgICAgIGxlZnQgPSBNYXRoLnJv
dW5kKCh3aW5XaWR0aCAvIDIpIC0gKHdpZHRoIC8gMikpOwogICAgICAgIHRvcCA9IDA7Cgog
ICAgICAgIGlmICh3aW5IZWlnaHQgPiBoZWlnaHQpIHsKICAgICAgICAgIHRvcCA9IE1hdGgu
cm91bmQoKHdpbkhlaWdodCAvIDIpIC0gKGhlaWdodCAvIDIpKTsKICAgICAgICB9CgogICAg
ICAgIHdpbmRvdy5vcGVuKHRhcmdldC5ocmVmLCAnaW50ZW50Jywgd2luZG93T3B0aW9ucyAr
ICcsd2lkdGg9JyArIHdpZHRoICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICcsaGVpZ2h0PScgKyBoZWlnaHQgKyAnLGxlZnQ9JyArIGxlZnQgKyAnLHRv
cD0nICsgdG9wKTsKICAgICAgICBlLnJldHVyblZhbHVlID0gZmFsc2U7CiAgICAgICAgZS5w
cmV2ZW50RGVmYXVsdCAmJiBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0KICAgIH0KICB9
CgogIGlmIChkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKSB7CiAgICBkb2N1bWVudC5hZGRF
dmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUludGVudCwgZmFsc2UpOwogIH0gZWxzZSBp
ZiAoZG9jdW1lbnQuYXR0YWNoRXZlbnQpIHsKICAgIGRvY3VtZW50LmF0dGFjaEV2ZW50KCdv
bmNsaWNrJywgaGFuZGxlSW50ZW50KTsKICB9CiAgd2luZG93Ll9fdHdpdHRlckludGVudEhh
bmRsZXIgPSB0cnVlOwp9KCkpOwo8L3NjcmlwdD4KSlM7CiAgJGFyY190d2l0dGVyWyd3aWRn
ZXRfanMnXSA9IHRydWU7CiAgcmV0dXJuICRqczsKfQoKLy8gRGVwcmVjYXRlZCBhcmNfdHdp
dHRlcl9yZXR3ZWV0IHRhZywgdXNlIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbiBpbnN0ZWFk
CmZ1bmN0aW9uIGFyY190d2l0dGVyX3JldHdlZXQoJGF0dHMsICR0aGluZz1udWxsKQp7CiAg
cmV0dXJuIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbigkYXR0cywgJHRoaW5nPW51bGwpOwp9
CmZ1bmN0aW9uIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbigkYXR0cywgJHRoaW5nPW51bGwp
CnsKICAgIGdsb2JhbCAkcHJlZnMsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3
aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CiAgICBnbG9iYWwgJHRoaXNhcnRpY2xlOwoKICAgIGV4
dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICAgJ3VzZXInICAgICAgICA9PiAkcHJlZnNbJ2Fy
Y190d2l0dGVyX3VzZXInXSwgLy8gdmlhIHVzZXIgYWNjb3VudAogICAgICAgICd1cmwnICAg
ICAgICAgPT4gJycsCiAgICAgICAgJ3RleHQnICAgICAgICA9PiAnJywKICAgICAgICAnZm9s
bG93MScgICAgID0+ICcnLAogICAgICAgICdmb2xsb3cyJyAgICAgPT4gJycsCiAgICAgICAg
J2xhbmcnICAgICAgICA9PiAnJywKICAgICAgICAnY291bnQnICAgICAgID0+ICdob3Jpem9u
dGFsJywKICAgICAgICAnaW5jbHVkZV9qcycgID0+IHRydWUsCiAgICAgICAgJ29wdGltaXNl
X2pzJyA9PiBmYWxzZSwKICAgICAgICAnd3JhcHRhZycgICAgID0+ICcnLAogICAgICAgICdj
bGFzcycgICAgICAgPT4gJ3R3aXR0ZXItc2hhcmUtYnV0dG9uJwogICAgKSwkYXR0cykpOwoK
ICAgICRxID0gJyc7IC8vIHF1ZXJ5IHN0cmluZwoKICAgIGlmICgkaWQ9JHRoaXNhcnRpY2xl
Wyd0aGlzaWQnXSkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBidWls
ZCB0d2VldCBmcm9tCiAgICAgICRyb3cgPSBzYWZlX3JvdygiUkVQTEFDRSh0d2VldCxDT05D
QVQoJyAnLHRpbnl1cmwpLCcnKSBBUyB0d2VldCx0aW55dXJsIgogICAgICAgICwgJ2FyY190
d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKTsKCiAgICAgIGlmICgkdXJsPT0nJykgewog
ICAgICAgICR1cmwgPSAoJHVybCkgPyAkdXJsIDogcGVybWxpbmt1cmwoJHRoaXNhcnRpY2xl
KTsKICAgICAgICAkcSA9ICd1cmw9Jy51cmxlbmNvZGUoJHVybCk7CiAgICAgIH0KICAgICAg
aWYgKCR0ZXh0PT0nJykgewogICAgICAgICR0ZXh0ID0gKCRyb3dbJ3R3ZWV0J10pID8gJHJv
d1sndHdlZXQnXSA6ICR0aGlzYXJ0aWNsZVsndGl0bGUnXTsKICAgICAgfQogICAgICAkcSAu
PSAoJHEgPyAnJmFtcDsnIDogJycpLid0ZXh0PScudXJsZW5jb2RlKCR0ZXh0KTsKICAgIH0K
ICAgIGlmICgkdXNlcikgewogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLid2aWE9
Jy51cmxlbmNvZGUoJHVzZXIpOwogICAgfQogICAgaWYgKCRmb2xsb3cxJiYkZm9sbG93Mikg
ewogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidyZWxhdGVkPScudXJsZW5jb2Rl
KCRmb2xsb3cxLic6Jy4kZm9sbG93Mik7CiAgICB9IGVsc2VpZiAoJGZvbGxvdzF8fCRmb2xs
b3cyKSB7CiAgICAgICRxIC49ICgkcSA/ICcmYW1wOycgOiAnJykuJ3JlbGF0ZWQ9Jy51cmxl
bmNvZGUoJGZvbGxvdzEuJGZvbGxvdzIpOwogICAgfQoKICAgIHN3aXRjaCAoJGxhbmcpIHsK
ICAgICAgY2FzZSAnZnInOiBicmVhazsgY2FzZSAnZGUnOiBicmVhazsgY2FzZSAnZXMnOiBi
cmVhazsgY2FzZSAnanAnOiBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICAkbGFuZyA9
ICdlbic7CiAgICB9CiAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidsYW5nPScudXJs
ZW5jb2RlKCRsYW5nKTsKCiAgICBzd2l0Y2ggKCRjb3VudCkgewogICAgICBjYXNlICdub25l
JzogYnJlYWs7IGNhc2UgJ3ZlcnRpY2FsJzogYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAg
ICAgJGNvdW50ID0gJ2hvcml6b250YWwnOwogICAgfQogICAgJHEgLj0gKCRxID8gJyZhbXA7
JyA6ICcnKS4nY291bnQ9Jy51cmxlbmNvZGUoJGNvdW50KTsKCiAgICAkdGhpbmcgPSAoJHRo
aW5nPT09bnVsbCkgPyAnVHdlZXQnIDogcGFyc2UoJHRoaW5nKTsKCiAgICAkaHRtbCA9IGhy
ZWYoJHRoaW5nLCdodHRwOi8vdHdpdHRlci5jb20vc2hhcmU/Jy4kcQogICAgICAsICcgY2xh
c3M9IicuJGNsYXNzLiciJyk7CgogICAgJGpzID0gKCRpbmNsdWRlX2pzKSA/IF9hcmNfdHdp
dHRlcl93aWRnZXRfanMoJG9wdGltaXNlX2pzP3RydWU6ZmFsc2UpIDogJyc7CgogICAgcmV0
dXJuICRqcy4kaHRtbDsKfQoKLyoKICogVHdpdHRlciBGb2xsb3cgYnV0dG9uCiAqLwpmdW5j
dGlvbiBhcmNfdHdpdHRlcl9mb2xsb3dfYnV0dG9uKCRhdHRzLCAkdGhpbmc9bnVsbCkKewog
ICAgZ2xvYmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRl
cl9jb25zdW1lclNlY3JldDsKICAgIGdsb2JhbCAkdGhpc2FydGljbGU7CgogICAgZXh0cmFj
dChsQXR0cyhhcnJheSgKICAgICAgICAndXNlcicgICAgICAgID0+ICRwcmVmc1snYXJjX3R3
aXR0ZXJfdXNlciddLCAvLyB2aWEgdXNlciBhY2NvdW50CiAgICAgICAgJ2xhbmcnICAgICAg
ICA9PiAnJywKICAgICAgICAnY291bnQnICAgICAgID0+IHRydWUsCiAgICAgICAgJ2luY2x1
ZGVfanMnICA9PiB0cnVlLAogICAgICAgICdvcHRpbWlzZV9qcycgPT4gZmFsc2UsCiAgICAg
ICAgJ2NsYXNzJyAgICAgICA9PiAndHdpdHRlci1mb2xsb3ctYnV0dG9uJwogICAgKSwkYXR0
cykpOwoKICAgICRhdHRzID0gJyc7IC8vIGRhdGEgYXR0cmlidXRlcwoKICAgIHN3aXRjaCAo
JGxhbmcpIHsKICAgICAgY2FzZSAnZnInOiBicmVhazsgY2FzZSAnZGUnOiBicmVhazsgY2Fz
ZSAnZXMnOiBicmVhazsgY2FzZSAnanAnOiBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAg
ICAkbGFuZyA9ICdlbic7CiAgICB9CiAgICAkYXR0cyAuPSAnIGRhdGEtbGFuZz0iJy51cmxl
bmNvZGUoJGxhbmcpLiciJzsKCiAgICAkYXR0cyAuPSAnIGRhdGEtc2hvdy1jb3VudD0iJy4o
JGNvdW50Pyd0cnVlJzonZmFsc2UnKS4nIic7CgogICAgJHRoaW5nID0gKCR0aGluZz09PW51
bGwpID8gJ0ZvbGxvdyBAJy4kdXNlciA6IHBhcnNlKCR0aGluZyk7CgogICAgJGh0bWwgPSBo
cmVmKCR0aGluZywnaHR0cDovL3R3aXR0ZXIuY29tLycudXJsZW5jb2RlKCR1c2VyKQogICAg
ICAsICcgY2xhc3M9IicuJGNsYXNzLiciJy4kYXR0cyk7CgogICAgJGpzID0gKCRpbmNsdWRl
X2pzKSA/IF9hcmNfdHdpdHRlcl93aWRnZXRfanMoJG9wdGltaXNlX2pzP3RydWU6ZmFsc2Up
IDogJyc7CgogICAgcmV0dXJuICRqcy4kaHRtbDsKfQoKLyoKICAgIEFkbWluLXNpZGUgZnVu
Y3Rpb25zCiAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09CiovCgovLyBJbnN0YWxsYXRpb24gZnVuY3Rpb24gLSBi
dWlsZHMgTXlTUUwgdGFibGUKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfaW5zdGFsbCgpCnsKCiAg
ICAvLyBGb3IgZmlyc3QgaW5zdGFsbCwgY3JlYXRlIHRhYmxlIGZvciB0d2VldHMKICAgICRz
cWwgPSAiQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgIi5QRlguImFyY190d2l0dGVyICI7
CiAgICAkc3FsLj0gIihhcmNfdHdpdHRlcmlkIElOVEVHRVIgQVVUT19JTkNSRU1FTlQgUFJJ
TUFSWSBLRVksCiAgICAgICAgYXJ0aWNsZV9pZCBJTlRFR0VSKDExKSwKICAgICAgICB0d2Vl
dF9pZCBCSUdJTlQoMjApLAogICAgICAgIHR3ZWV0IFZBUkNIQVIoMTQwKSwKICAgICAgICB0
aW55dXJsIFZBUkNIQVIoMzApKTsiOwoKICAgIGlmICghc2FmZV9xdWVyeSgkc3FsKSkgewog
ICAgICAgIHJldHVybiAnRXJyb3IgLSB1bmFibGUgdG8gY3JlYXRlIGFyY190d2l0dGVyIHRh
YmxlJzsKICAgIH0KCn0KCi8vIFVuaW5zdGFsbCBmdW5jdGlvbiAtIGRlbGV0ZXMgTXlTUUwg
dGFibGUgYW5kIHJlbGF0ZWQgcHJlZmVyZW5jZXMKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdW5p
bnN0YWxsKCkKewoKICAgICRzcWwgPSAiRFJPUCBUQUJMRSBJRiBFWElTVFMgIi5QRlguImFy
Y190d2l0dGVyOyI7CiAgICBpZiAoIXNhZmVfcXVlcnkoJHNxbCkpIHsKICAgICAgICByZXR1
cm4gJ0Vycm9yIC0gdW5hYmxlIHRvIGRlbGV0ZSBhcmNfdHdpdHRlciB0YWJsZSc7CiAgICB9
CgogICAgJHNxbCA9ICJERUxFVEUgRlJPTSAgIi5QRlguInR4cF9wcmVmcyBXSEVSRSBldmVu
dD0nYXJjX3R3aXR0ZXInOyI7CiAgICBpZiAoIXNhZmVfcXVlcnkoJHNxbCkpIHsKICAgICAg
ICByZXR1cm4gJ0Vycm9yIC0gdW5hYmxlIHRvIGRlbGV0ZSBhcmNfdHdpdHRlciBwcmVmZXJl
bmNlcyc7CiAgICB9Cgp9CmZ1bmN0aW9uIGFyY190d2l0dGVyX3VybF9tZXRob2Rfc2VsZWN0
KCRuYW1lLCAkdmFsKQp7CiAgICAkbWV0aG9kcyA9IGFycmF5KCd0aW55dXJsJyA9PiAnVGlu
eXVybCcsCiAgICAgICdpc2dkJyA9PiAnSXMuZ2QnLAogICAgICAnYXJjX3R3aXR0ZXInID0+
ICdUWFAgVHdlZXQnLAogICAgICAnc21kJyA9PiAnc21kX3Nob3J0X3VybCcpOwogICAgcmV0
dXJuIHNlbGVjdElucHV0KCRuYW1lLCAkbWV0aG9kcywgJHZhbCk7Cn0KZnVuY3Rpb24gYXJj
X3R3aXR0ZXJfdGFiX3NlbGVjdCgkbmFtZSwgJHZhbCkKewogICAgJHRhYnMgPSBhcnJheSgn
Y29udGVudCcgPT4gJ0NvbnRlbnQnLAogICAgICAgICdleHRlbnNpb25zJyA9PiAnRXh0ZW5z
aW9ucycsCiAgICAgICAgJycgPT4gJ0hpZGRlbicpOwogICAgcmV0dXJuIHNlbGVjdElucHV0
KCRuYW1lLCAkdGFicywgJHZhbCk7Cn0KLy8gUHJvdmlkZSBpbnRlcmZhY2UgZm9yIHNldHRp
bmcgcHJlZmVyZW5jZXMKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfcHJlZnMoJGV2ZW50LCRzdGVw
KQp7CgogICAgZ2xvYmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksJGFyY190
d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgICR1c2VyICAgICAgICAgID0gJHByZWZzWydh
cmNfdHdpdHRlcl91c2VyJ107CiAgICAkcHJlZml4ICAgICAgICA9ICRwcmVmc1snYXJjX3R3
aXR0ZXJfcHJlZml4J107CiAgICAkc3VmZml4ICAgICAgICA9ICRwcmVmc1snYXJjX3R3aXR0
ZXJfc3VmZml4J107CiAgICAkdHdlZXRfZGVmYXVsdCA9ICRwcmVmc1snYXJjX3R3aXR0ZXJf
dHdlZXRfZGVmYXVsdCddOwogICAgJHVybF9tZXRob2QgICAgPSAkcHJlZnNbJ2FyY190d2l0
dGVyX3VybF9tZXRob2QnXTsKICAgICRzaG9ydF91cmwgICAgID0gJHByZWZzWydhcmNfc2hv
cnRfdXJsJ107CiAgICAkc2hvcnRfc2l0ZV91cmw9ICRwcmVmc1snYXJjX3Nob3J0X3NpdGVf
dXJsJ107CiAgICAkY2FjaGVfZGlyICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVf
ZGlyJ107CiAgICAkdGFiICAgICAgICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfdGFiJ107
CgogICAgc3dpdGNoICgkc3RlcCkgewogICAgICAgIGNhc2UgJ3ByZWZzX3NhdmUnOiBwYWdl
dG9wKCdUWFAgVHdlZXQnLCAnUHJlZmVyZW5jZXMgc2F2ZWQnKTsgYnJlYWs7CiAgICAgICAg
Y2FzZSAncmVnaXN0ZXInOiBwYWdldG9wKCdUWFAgVHdlZXQnLCdDb25uZWN0IHRvIFR3aXR0
ZXInKTsgYnJlYWs7CiAgICAgICAgY2FzZSAndmFsaWRhdGUnOgogICAgICAgIGRlZmF1bHQ6
IHBhZ2V0b3AoJ1RYUCBUd2VldCcpOwogICAgfQoKICAgICRodG1sID0gJyc7CgogICAgaWYg
KCRzdGVwPT0ncmVnaXN0ZXInKSB7IC8vIE9BdXRoIHJlZ2lzdHJhdGlvbiBwcm9jZXNzCiAg
ICAgICAgJHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5
CiAgICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0KTsKCiAgICAgICAg
Ly8gQnVpbGQgYSBjYWxsYmFjayBVUkwgZm9yIFR3aXR0ZXIgdG8gcmV0dXJuIHRvIHRoZSBu
ZXh0IHN0YWdlCiAgICAgICAgJGNhbGxiYWNrVVJMID0gJHR3aXQtPmNhbGxiYWNrVVJMKCRl
dmVudCwndmFsaWRhdGUnKTsKCiAgICAgICAgJHJlcXVlc3QgPSAkdHdpdC0+Z2V0UmVxdWVz
dFRva2VuKCRjYWxsYmFja1VSTCk7CiAgICAgICAgJHJlcXVlc3RfdG9rZW4gPSAkcmVxdWVz
dFsib2F1dGhfdG9rZW4iXTsKICAgICAgICAkcmVxdWVzdF90b2tlbl9zZWNyZXQgPSAkcmVx
dWVzdFsib2F1dGhfdG9rZW5fc2VjcmV0Il07CgogICAgICAgIHNldF9wcmVmKCdhcmNfdHdp
dHRlcl9yZXF1ZXN0VG9rZW4nLCRyZXF1ZXN0X3Rva2VuCiAgICAgICAgICAgICwgJ2FyY190
d2l0dGVyJywyKTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfcmVxdWVzdFRva2Vu
U2VjcmV0JywkcmVxdWVzdF90b2tlbl9zZWNyZXQKICAgICAgICAgICAgLCAnYXJjX3R3aXR0
ZXInLDIpOwoKICAgICAgICAkaHRtbC49IHN0YXJ0VGFibGUoJ2VkaXQnKS4KICAgICAgICAg
ICAgICAgIHRyKHRkKAogICAgICAgICAgICAgICAgICAgICgnPHA+Jy5ocmVmKCdTaWduLWlu
IHRvIFR3aXR0ZXInCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsJHR3aXQtPmdldEF1
dGhvcml6ZVVSTCgkcmVxdWVzdCkpCiAgICAgICAgICAgICAgICAgICAgICAgIC4nIGFuZCBm
b2xsb3cgdGhlIGluc3RydWN0aW9ucyB0byBhbGxvdyBUWFAgVHdlZXQgdG8gdXNlIHlvdXIg
YWNjb3VudC4gSWYgeW91IGFyZSBhbHJlYWR5IHNpZ25lZCBpbiB0byBUd2l0dGVyIHRoZW4g
dGhhdCBhY2NvdW50IHdpbGwgYmUgYXNzb2NpYXRlZCB3aXRoIFRYUCBUd2VldCBzbyB5b3Ug
bWF5IG5lZWQgdG8gc2lnbiBvdXQgZmlyc3QgaWYgeW91IHdhbnQgdG8gdXNlIGEgZGlmZmVy
ZW50IGFjY291bnQuPC9wPicpCiAgICAgICAgICAgICAgICApKS5lbmRUYWJsZSgpOwogICAg
fSBlbHNlaWYgKCRzdGVwPT0ndmFsaWRhdGUnKSB7CiAgICAgICAgJHR3aXQgPSBuZXcgYXJj
X3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgICAgICwgJGFyY190
d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX3JlcXVlc3RUb2tl
biddCiAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9yZXF1ZXN0VG9rZW5TZWNy
ZXQnXSk7CiAgICAgICAgLy8gQXNrIFR3aXR0ZXIgZm9yIGFuIGFjY2VzcyB0b2tlbiAoYW5k
IGFuIGFjY2VzcyB0b2tlbiBzZWNyZXQpCiAgICAgICAgJHJlcXVlc3QgPSAkdHdpdC0+Z2V0
QWNjZXNzVG9rZW4oIGdwcygnb2F1dGhfdmVyaWZpZXInKSApOwogICAgICAgICRhY2Nlc3Nf
dG9rZW4gPSAkcmVxdWVzdFsnb2F1dGhfdG9rZW4nXTsKICAgICAgICAkYWNjZXNzX3Rva2Vu
X3NlY3JldCA9ICRyZXF1ZXN0WydvYXV0aF90b2tlbl9zZWNyZXQnXTsKICAgICAgICAkdXNl
ciA9ICRyZXF1ZXN0WydzY3JlZW5fbmFtZSddOwogICAgICAgIC8vIFN0b3JlIHRoZSBhY2Nl
c3MgdG9rZW4gYW5kIHNlY3JldAogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9hY2Nl
c3NUb2tlbicsJGFjY2Vzc190b2tlbiwgJ2FyY190d2l0dGVyJywyKTsKICAgICAgICBzZXRf
cHJlZignYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnLCRhY2Nlc3NfdG9rZW5fc2Vj
cmV0CiAgICAgICAgICAgICwgJ2FyY190d2l0dGVyJywyKTsKICAgICAgICBzZXRfcHJlZign
YXJjX3R3aXR0ZXJfdXNlcicsJHVzZXIpOwogICAgICAgICRwcmVmc1snYXJjX3R3aXR0ZXJf
YWNjZXNzVG9rZW4nXSA9ICRhY2Nlc3NfdG9rZW47CiAgICAgICAgJHByZWZzWydhcmNfdHdp
dHRlcl9hY2Nlc3NUb2tlblNlY3JldCddID0gJGFjY2Vzc190b2tlbl9zZWNyZXQ7CiAgICAg
ICAgdW5zZXQoJHR3aXQpOwogICAgfQoKICAgIGlmICgkc3RlcD09InByZWZzX3NhdmUiKSB7
CiAgICAgICAgJHByZWZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9wcmVmaXgnKSk7CiAg
ICAgICAgJHN1ZmZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9zdWZmaXgnKSk7CiAgICAg
ICAgJHR3ZWV0X2RlZmF1bHQgPSBncHMoJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnKTsK
ICAgICAgICAkdXJsX21ldGhvZCA9IGdwcygnYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCcpOwog
ICAgICAgICRzaG9ydF91cmwgPSBncHMoJ2FyY19zaG9ydF91cmwnKTsKICAgICAgICAkc2hv
cnRfc2l0ZV91cmwgPSBncHMoJ2FyY19zaG9ydF9zaXRlX3VybCcpOwogICAgICAgICRjYWNo
ZV9kaXIgPSBncHMoJ2FyY190d2l0dGVyX2NhY2hlX2RpcicpOwogICAgICAgICR0YWIgPSBn
cHMoJ2FyY190d2l0dGVyX3RhYicpOwogICAgICAgIGlmIChzdHJsZW4oJHByZWZpeCk8PTIw
KSB7CiAgICAgICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9wcmVmaXgnLCRwcmVmaXgp
OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICRwcmVmaXggPSAkcHJlZnNbJ2FyY190
d2l0dGVyX3ByZWZpeCddOwogICAgICAgIH0KICAgICAgICBpZiAoc3RybGVuKCRzdWZmaXgp
PD0yMCkgewogICAgICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfc3VmZml4Jywkc3Vm
Zml4KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkc3VmZml4ID0gJHByZWZzWydh
cmNfdHdpdHRlcl9zdWZmaXgnXTsKICAgICAgICB9CiAgICAgICAgJHR3ZWV0X2RlZmF1bHQg
PSAoJHR3ZWV0X2RlZmF1bHQpID8gMSA6IDA7CiAgICAgICAgJHNob3J0X3VybCA9ICgkc2hv
cnRfdXJsKSA/IDEgOiAwOwogICAgICAgIGlmICghJHNob3J0X3NpdGVfdXJsKSAkc2hvcnRf
c2l0ZV91cmwgPSAkcHJlZnNbJ3NpdGV1cmwnXTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3
aXR0ZXJfdHdlZXRfZGVmYXVsdCcsJHR3ZWV0X2RlZmF1bHQpOwogICAgICAgIHNldF9wcmVm
KCdhcmNfc2hvcnRfdXJsJywkc2hvcnRfdXJsKTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3
aXR0ZXJfdXJsX21ldGhvZCcsJHVybF9tZXRob2QpOwogICAgICAgIHNldF9wcmVmKCdhcmNf
c2hvcnRfc2l0ZV91cmwnLCRzaG9ydF9zaXRlX3VybCk7CiAgICAgICAgc2V0X3ByZWYoJ2Fy
Y190d2l0dGVyX2NhY2hlX2RpcicsJGNhY2hlX2Rpcik7CiAgICAgICAgc2V0X3ByZWYoJ2Fy
Y190d2l0dGVyX3RhYicsJHRhYik7CiAgICB9CgogICAgaWYgKCAkc3RlcCE9J3JlZ2lzdGVy
JyApIHsKICAgICAgICBpZiAoIGlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9r
ZW4nXSkKICAgICAgICAmJiBpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2Vu
U2VjcmV0J10pICkgewogICAgICAgICAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJj
X3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgICAgICwgJGFyY190d2l0dGVyX2Nv
bnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10KICAgICAg
ICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKTsK
ICAgICAgICAgICAgJHJlZ2lzdGVyVVJMID0gJHR3aXQtPmNhbGxiYWNrVVJMKCRldmVudCwn
cmVnaXN0ZXInKTsKICAgICAgICAgICAgJGh0bWwuPSBzdGFydFRhYmxlKCdsaXN0JykuZm9y
bSgKICAgICAgICAgICAgICAgIHRyKAogICAgICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdU
d2l0dGVyIGFjY291bnQgZGV0YWlscycsIDIpLDIpCiAgICAgICAgICAgICAgICApCiAgICAg
ICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJh
cmNfdHdpdHRlcl91c2VyIj5Ud2l0dGVyIHVzZXJuYW1lPC9sYWJlbD4nLAogICAgICAgICAg
ICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxp
Z246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoCiAgICAgICAgICAgICAg
ICAgICAgICAgICgkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSkgPwogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgJHVzZXIuJyAoJy5ocmVmKCdSZS1jb25uZWN0JywkcmVnaXN0ZXJV
UkwpLicpJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnPGVtPnVua25vd248L2Vt
PicKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5ocmVmKCdDb25uZWN0IHRvIFR3aXR0
ZXInLCRyZWdpc3RlclVSTCkpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAu
dHIoCiAgICAgICAgICAgICAgICAgICAgdGRjcyhoZWQoJ1R3ZWV0IHNldHRpbmdzJywgMiks
MikKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAg
ICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX3ByZWZpeCI+VHdlZXQgcHJl
Zml4PC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFs
aWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAg
ICAgICAudGQoZklucHV0KCd0ZXh0JywnYXJjX3R3aXR0ZXJfcHJlZml4JywkcHJlZml4LCcn
LCcnLCcnLCcnLCcnLCdhcmNfdHdpdHRlcl9wcmVmaXgnKSkKICAgICAgICAgICAgICAgICku
dHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl9z
dWZmaXgiPlR3ZWV0IHN1ZmZpeDwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAg
JyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7Iicp
CiAgICAgICAgICAgICAgICAgICAgLnRkKGZJbnB1dCgndGV4dCcsJ2FyY190d2l0dGVyX3N1
ZmZpeCcsJHN1ZmZpeCwnJywnJywnJywnJywnJywnYXJjX3R3aXR0ZXJfc3VmZml4JykpCiAg
ICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZv
cj0iYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCI+VHdlZXQgYXJ0aWNsZXMgYnkgZGVmYXVs
dDwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGln
bjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAg
ICAgLnRkKHllc25vUmFkaW8oJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnLCAkdHdlZXRf
ZGVmYXVsdCwgJycsICdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0JykpCiAgICAgICAgICAg
ICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3
aXR0ZXJfdXJsX21ldGhvZCI+VVJMIHNob3J0bmVyPC9sYWJlbD4nLAogICAgICAgICAgICAg
ICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246
IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoYXJjX3R3aXR0ZXJfdXJsX21l
dGhvZF9zZWxlY3QoJ2FyY190d2l0dGVyX3VybF9tZXRob2QnLCR1cmxfbWV0aG9kKSkKICAg
ICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAgICAgICAgICAgdGRjcyhoZWQoJ1RYUCBU
d2VldCBzaG9ydCBVUkwnLCAyKSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAg
ICAgLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3Nob3J0
X3VybCI+RW5hYmxlIFRYUCBUd2VldCBzaG9ydCBVUkwgcmVkaXJlY3Q8L2xhYmVsPicsCiAg
ICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0
aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50ZCh5ZXNub1Jh
ZGlvKCdhcmNfc2hvcnRfdXJsJywgJHNob3J0X3VybCwgJycsICdhcmNfc2hvcnRfdXJsJykp
LAogICAgICAgICAgICAgICAgICAgICcgaWQ9ImFyY19zaG9ydF91cmwtb25fb2ZmIicKICAg
ICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9y
PSJhcmNfc2hvcnRfc2l0ZV91cmwiPlRYUCBUd2VldCBzaG9ydCBzaXRlIFVSTDwvbGFiZWw+
JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7
IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKGZJ
bnB1dCgndGV4dCcsJ2FyY19zaG9ydF9zaXRlX3VybCcsJHNob3J0X3NpdGVfdXJsLCcnLCcn
LCcnLCcnLCcnLCdhcmNfc2hvcnRfc2l0ZV91cmwnKSksCiAgICAgICAgICAgICAgICAgICAg
JyBpZD0iYXJjX3Nob3J0X3NpdGVfdXJsLW9wdGlvbiInCiAgICAgICAgICAgICAgICApLnRy
KAogICAgICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdUd2l0dGVyIHRhYicsIDIpLDIpCiAg
ICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZv
cj0iYXJjX3R3aXR0ZXJfdGFiIj5Mb2NhdGlvbiBvZiBUd2l0dGVyIHRhYjwvbGFiZWw+JywK
ICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZl
cnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKGFyY190
d2l0dGVyX3RhYl9zZWxlY3QoJ2FyY190d2l0dGVyX3RhYicsJHRhYikpCiAgICAgICAgICAg
ICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdDYWNoZScsIDIpLDIp
CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAg
ICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl9jYWNoZV9kaXIiPkNhY2hlIGRp
cmVjdG9yeTwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4
dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAg
ICAgICAgICAgLnRkKGZJbnB1dCgndGV4dCcsJ2FyY190d2l0dGVyX2NhY2hlX2RpcicsJGNh
Y2hlX2RpciwnJywnJywnJywnJywnJywnYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJykpCiAgICAg
ICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAgICAgICAg
dGRhKAogICAgICAgICAgICAgICAgICAgICAgICBmSW5wdXQoJ3N1Ym1pdCcsICdTdWJtaXQn
LCBnVHh0KCdzYXZlX2J1dHRvbicpLCAncHVibGlzaCcpCiAgICAgICAgICAgICAgICAgICAg
ICAgIC5uLnNJbnB1dCgncHJlZnNfc2F2ZScpCiAgICAgICAgICAgICAgICAgICAgICAgIC5u
LmVJbnB1dCgncGx1Z2luX3ByZWZzLmFyY190d2l0dGVyJykKICAgICAgICAgICAgICAgICAg
ICAsICcgY29sc3Bhbj0iMiIgY2xhc3M9Im5vbGluZSInKSkpCiAgICAgICAgICAgICAgICAu
ZW5kVGFibGUoKTsKICAgICAgICB9IGVsc2VpZiAoICRzdGVwIT0ncmVnaXN0ZXInICkgewog
ICAgICAgICAgICAkcmVnaXN0ZXJVUkwgPSBhcmNfdHdpdHRlcjo6Y2FsbGJhY2tVUkwoJGV2
ZW50LCdyZWdpc3RlcicpOwogICAgICAgICAgICAkaHRtbC49IHN0YXJ0VGFibGUoJ2xpc3Qn
KS5mb3JtKAogICAgICAgICAgICAgICAgdHIoCiAgICAgICAgICAgICAgICAgICAgdGRjcyho
ZWQoJ1R3aXR0ZXIgYWNjb3VudCBkZXRhaWxzJywgMiksMikKICAgICAgICAgICAgICAgICkK
ICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBm
b3I9ImFyY190d2l0dGVyX3VzZXIiPlR3aXR0ZXIgdXNlcm5hbWU8L2xhYmVsPicsCiAgICAg
ICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNh
bC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50ZCgKICAgICAgICAg
ICAgICAgICAgICAgICAgKCc8ZW0+dW5rbm93bjwvZW0+ICgnCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAuaHJlZignQ29ubmVjdCB0byBUd2l0dGVyJywkcmVnaXN0ZXJVUkwpLicp
JykKICAgICAgICAgICAgICAgICkpKQogICAgICAgICAgICAgICAgLmVuZFRhYmxlKCk7CiAg
ICAgICAgfQogICAgfQoKICAgIC8vIFNldCBqUXVlcnkgZm9yIHN3aXRjaGluZyBvbi9vZmYg
cmVsZXZhbnQgYXJjX3Nob3J0X3VybCBmaWVsZHMKICAgICRqcyA9IDw8PEpTCjxzY3JpcHQg
bGFuZ3VhZ2U9ImphdmFzY3JpcHQiIHR5cGU9InRleHQvamF2YXNjcmlwdCI+CiQoZG9jdW1l
bnQpLnJlYWR5KGZ1bmN0aW9uKCl7CiAgdmFyIG9ub2ZmID0gJCgnI2FyY19zaG9ydF91cmwt
b25fb2ZmJyk7CiAgdmFyIGFyY19zaG9ydF91cmxfb2ZmID0gJCgnI2FyY19zaG9ydF91cmwt
YXJjX3Nob3J0X3VybC0wJyk7CiAgdmFyIHVybCA9ICQoJyNhcmNfc2hvcnRfc2l0ZV91cmwt
b3B0aW9uJyk7CiAgdmFyIHVybF9tZXRob2QgPSAkKCdzZWxlY3RbbmFtZT0iYXJjX3R3aXR0
ZXJfdXJsX21ldGhvZCJdJyk7CgogIGlmIChhcmNfc2hvcnRfdXJsX29mZi5hdHRyKCdjaGVj
a2VkJyk9PXRydWUKICAmJiAkKCdvcHRpb246c2VsZWN0ZWQnLCB1cmxfbWV0aG9kKS52YWwo
KSE9J2FyY190d2l0dGVyJykgewogICAgdXJsLmhpZGUoKTsKICB9CiAgJCgnaW5wdXQnLCBv
bm9mZikuY2hhbmdlKGZ1bmN0aW9uKCl7CiAgICBpZiAoJCgnb3B0aW9uOnNlbGVjdGVkJywg
dXJsX21ldGhvZCkudmFsKCkhPSdhcmNfdHdpdHRlcicpIHsKICAgICAgYXJjX3Nob3J0X3Vy
bF9vZmYuYXR0cignY2hlY2tlZCcpPT10cnVlID8gdXJsLmhpZGUoKSA6IHVybC5zaG93KCk7
CiAgICB9CiAgfSk7CgogIGlmICgkKCdvcHRpb246c2VsZWN0ZWQnLCB1cmxfbWV0aG9kKS52
YWwoKT09J2FyY190d2l0dGVyJykgewogICAgb25vZmYuaGlkZSgpOyB1cmwuc2hvdygpOwog
IH0KICB1cmxfbWV0aG9kLmNoYW5nZShmdW5jdGlvbigpewogICAgaWYgKCQoJ29wdGlvbjpz
ZWxlY3RlZCcsIHVybF9tZXRob2QpLnZhbCgpPT0nYXJjX3R3aXR0ZXInKSB7CiAgICAgIG9u
b2ZmLnRvZ2dsZSgpOyB1cmwuc2hvdygpOwogICAgfSBlbHNlIHsKICAgICAgb25vZmYudG9n
Z2xlKCk7CiAgICAgIGFyY19zaG9ydF91cmxfb2ZmLmF0dHIoJ2NoZWNrZWQnKT09dHJ1ZSA/
IHVybC5oaWRlKCkgOiB1cmwuc2hvdygpOwogICAgfQogIH0pCn0pOwo8L3NjcmlwdD4KSlM7
CgogICAgZWNobyAkanMuJGh0bWw7Cn0KCi8vIEFkZCBUd2l0dGVyIHRhYiB0byBUZXh0cGF0
dGVybgpmdW5jdGlvbiBhcmNfYWRtaW5fdHdpdHRlcigkZXZlbnQsJHN0ZXApCnsKICAgIGds
b2JhbCAkcHJlZnMsICRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2Nv
bnN1bWVyU2VjcmV0OwoKICAgICR0d2l0ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRl
cl9jb25zdW1lcktleQogICAgICAgICAgICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3Jl
dCwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddCiAgICAgICAgICAgICwgJHBy
ZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKTsKCiAgICAkdHdpdC0+Y2Fj
aGVEaXIoJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXSk7CgogICAgJHhtbCA9ICR0
d2l0LT5nZXQoJ3VzZXJzL3Nob3cnCiAgICAgICAgLCBhcnJheSgnc2NyZWVuX25hbWUnPT4k
cHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSkpOwogICAgJHR3aXR0ZXJVc2VyID0gQCR4bWwt
PnhwYXRoKCcvdXNlcicpOwogICAgJHR3aXR0ZXJVc2VyID0gJHR3aXR0ZXJVc2VyWzBdOwog
ICAgJHR3aXR0ZXJVc2VyVVJMID0gJ2h0dHA6Ly93d3cudHdpdHRlci5jb20vJy4kdHdpdHRl
clVzZXItPnNjcmVlbl9uYW1lOwoKICAgIGlmICgkc3RlcD09InR3ZWV0IikgeyAvLyBwb3N0
IGFuIHVwZGF0ZSB0byBUd2l0dGVyCgogICAgICAgIC8vIGZldGNoIGFuZCBjbGVhbiBtZXNz
YWdlCiAgICAgICAgJG1lc3NhZ2UgPSBzdHJpcF90YWdzKGdwcygnbWVzc2FnZScpKTsKICAg
ICAgICAkY291bnQgPSBzdHJsZW4oJG1lc3NhZ2UpOwoKICAgICAgICBpZiAoJGNvdW50PD0x
NDAgJiYgJGNvdW50PjApIHsgLy8gcG9zdCB1cGRhdGUKICAgICAgICAgICAgJHJlc3VsdCA9
ICR0d2l0LT5wb3N0KCdzdGF0dXNlcy91cGRhdGUnLCBhcnJheSgnc3RhdHVzJyA9PiAkbWVz
c2FnZSkpOwogICAgICAgIH0gZWxzZSB7IC8vIG1lc3NhZ2UgdG9vIGxvbmcsIEphdmFTY3Jp
cHQgaW50ZXJmYWNlIHNob3VsZCBwcmV2ZW50IHRoaXMKICAgICAgICAgICAgJHJlc3VsdCA9
IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgcGFnZXRvcCgnVHdpdHRlcicsCiAgICAgICAg
ICAgICgoJHJlc3VsdCE9ZmFsc2UpPydUd2l0dGVyIHVwZGF0ZWQnOidFcnJvciB1cGRhdGlu
ZyBUd2l0dGVyJykpOwoKICAgIH0gZWxzZWlmICgkc3RlcD09ImRlbGV0ZSIpIHsgLy8gZGVs
ZXRlIGFuIHVwZGF0ZSBmcm9tIFR3aXR0ZXIKCiAgICAgICAgJGlkID0gc3RyaXBfdGFncyhn
cHMoJ2lkJykpOwogICAgICAgIGlmICgkaWQpIHsKICAgICAgICAgICAgJHR3aXQtPmRlbGV0
ZSgnc3RhdHVzZXMvZGVzdHJveScuJGlkKTsKICAgICAgICAgICAgc2FmZV9kZWxldGUoJ2Fy
Y190d2l0dGVyJywidHdlZXRfaWQgPSAkaWQiKTsKICAgICAgICB9CgogICAgICAgIHBhZ2V0
b3AoJ1R3aXR0ZXInLCdUd2l0dGVyIHVwZGF0ZWQnKTsKCiAgICB9IGVsc2UgewoKICAgICAg
ICBwYWdldG9wKCdUd2l0dGVyJyk7CgogICAgfQoKICAgIC8vIFByZXBhcmUgSmF2YVNjcmlw
dCB0byBjcmVhdGUgVHdpdHRlciB1cGRhdGUgaW50ZXJmYWNlCgogICAgJGpzID0gJzxzY3Jp
cHQgbGFuZ3VhZ2U9ImphdmFzY3JpcHQiIHR5cGU9InRleHQvamF2YXNjcmlwdCI+JzsKICAg
ICRqcy49ICIkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpewogICAgICAgICAgICB2YXIg
Y291bnRlclN0eWxlID0gJ2ZvbnQtd2VpZ2h0OmJvbGQ7ZmxvYXQ6cmlnaHQ7Zm9udC1zaXpl
OjJlbTtsaW5lLWhlaWdodDoxLjJlbTsnOwogICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcp
LmF0dHIoJ3N0eWxlJywgY291bnRlclN0eWxlKydjb2xvcjojY2NjOycpOwogICAgICAgICAg
ICAkKCcjbWVzc2FnZScpLmtleXVwKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdmFy
IGNvdW50ID0gMTQwLSQoJyNtZXNzYWdlJykudmFsKCkubGVuZ3RoOwogICAgICAgICAgICAg
ICAgJCgnI3R3ZWV0Y291bnQnKS5odG1sKGNvdW50KycnKTsgLy8gaGFjayB0byBmb3JjZSBv
dXRwdXQgb2YgMAogICAgICAgICAgICAgICAgaWYgKGNvdW50PDApIHsKICAgICAgICAgICAg
ICAgICAgICAkKCdpbnB1dC5wdWJsaXNoJykuYXR0cignZGlzYWJsZWQnLCAnZGlzYWJsZWQn
KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJCgnaW5w
dXQucHVibGlzaCcpLmF0dHIoJ2Rpc2FibGVkJywgJycpOwogICAgICAgICAgICAgICAgfQog
ICAgICAgICAgICAgICAgaWYgKGNvdW50PDApIHsKICAgICAgICAgICAgICAgICAgICAkKCcj
dHdlZXRjb3VudCcpLmF0dHIoJ3N0eWxlJywgY291bnRlclN0eWxlKydjb2xvcjojZjAwOycp
OwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb3VudDwxMCkgewogICAgICAgICAgICAg
ICAgICAgICQoJyN0d2VldGNvdW50JykuYXR0cignc3R5bGUnLCBjb3VudGVyU3R5bGUrJ2Nv
bG9yOiMwMDA7Jyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAg
ICAgICQoJyN0d2VldGNvdW50JykuYXR0cignc3R5bGUnLCBjb3VudGVyU3R5bGUrJ2NvbG9y
OiNjY2M7Jyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgfSk7
IjsKICAgICRqcy49ICI8L3NjcmlwdD4iOwoKICAgICRvdXQgPSAnJzsKICAgICR4bWwgPSAk
dHdpdC0+Z2V0KCdzdGF0dXNlcy91c2VyX3RpbWVsaW5lJwogICAgICAgICwgYXJyYXkoJ3Nj
cmVlbl9uYW1lJz0+JHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sJ2NvdW50Jz0+MjUpKTsK
ICAgICR0d2VldHMgPSBAJHhtbC0+eHBhdGgoJy9zdGF0dXNlcy9zdGF0dXMnKTsKICAgIGlm
ICgkdHdlZXRzKSBmb3JlYWNoICgkdHdlZXRzIGFzICR0d2VldCkgewogICAgICAgICR0aW1l
ID0gc3RydG90aW1lKGh0bWxlbnRpdGllcygkdHdlZXQtPmNyZWF0ZWRfYXQpKTsKICAgICAg
ICAkZGF0ZSA9IHNhZmVfc3RyZnRpbWUoJHByZWZzWydhcmNoaXZlX2RhdGVmb3JtYXQnXSwk
dGltZSk7CiAgICAgICAgJG91dC49IHRyKHRkKCRkYXRlLCdzcGFuJykKICAgICAgICAgICAg
LnRkKGFyY19Ud2l0dGVyOjptYWtlTGlua3MoaHRtbGVudGl0aWVzKCR0d2VldC0+dGV4dAog
ICAgICAgICAgICAgICAgLCBFTlRfUVVPVEVTLCdVVEYtOCcpKSkKICAgICAgICAgICAgLnRk
KGRMaW5rKCdhcmNfYWRtaW5fdHdpdHRlcicsJ2RlbGV0ZScsJ2lkJywkdHdlZXQtPmlkLCcn
KSkKICAgICAgICAgICAgKTsKICAgIH0KCiAgICAkaHRtbCA9IHN0YXJ0VGFibGUoJ2VkaXQn
KQogICAgICAgICAgICAudHIodGQoCiAgICAgICAgICAgIGdyYWYoJzxpbWcgc3JjPSInLiR0
d2l0dGVyVXNlci0+cHJvZmlsZV9pbWFnZV91cmwuJyIgYWx0PSJUd2l0dGVyIGF2YXRhciIg
Lz4nCiAgICAgICAgICAgICwnIHN0eWxlPSJmbG9hdDpsZWZ0O3BhZGRpbmc6MnB4OyInKQog
ICAgICAgICAgICAuZ3JhZihocmVmKCR0d2l0dGVyVXNlci0+bmFtZSwkdHdpdHRlclVzZXJV
UkwpLCcgc3R5bGU9ImZvbnQtc2l6ZToxLjJlbTtmb250LXdlaWdodDpib2xkOyInKQogICAg
ICAgICAgICAuZ3JhZihocmVmKCR0d2l0dGVyVXNlci0+ZnJpZW5kc19jb3VudC4nIGZvbGxv
d2luZycsJHR3aXR0ZXJVc2VyVVJMLicvZm9sbG93aW5nJykKICAgICAgICAgICAgLicsICcu
aHJlZigkdHdpdHRlclVzZXItPmZvbGxvd2Vyc19jb3VudC4nIGZvbGxvd2VycycsJHR3aXR0
ZXJVc2VyVVJMLicvZm9sbG93ZXJzJykKICAgICAgICAgICAgLicsICcuaHJlZigkdHdpdHRl
clVzZXItPnN0YXR1c2VzX2NvdW50LicgdXBkYXRlcycsJHR3aXR0ZXJVc2VyVVJMKSkpKQog
ICAgICAgICAgICAudHIodGQoZm9ybSgKICAgICAgICAgICAgZ3JhZigiVXBkYXRlIFR3aXR0
ZXIuLi48c3BhbiBpZD0ndHdlZXRjb3VudCcgc3R5bGU9J2ZvbnQtd2VpZ2h0OmJvbGQ7Zmxv
YXQ6cmlnaHQ7Jz4xNDA8L3NwYW4+IikKICAgICAgICAgICAgLnRleHRfYXJlYSgnbWVzc2Fn
ZScsJzUwJywnNTUwJywnJywnbWVzc2FnZScpCiAgICAgICAgICAgIC5lSW5wdXQoJ2FyY19h
ZG1pbl90d2l0dGVyJykKICAgICAgICAgICAgLnNJbnB1dCgndHdlZXQnKS5icgogICAgICAg
ICAgICAuZklucHV0KCdzdWJtaXQnLCd1cGRhdGUnLGdUeHQoJ1VwZGF0ZScpLCdwdWJsaXNo
JykKICAgICAgICApKSkKICAgICAgICAuZW5kVGFibGUoKTsKCiAgICAvLyBBdHRhY2ggcmVj
ZW50IFR3aXR0ZXIgdXBkYXRlcwoKICAgICRodG1sLj0gc3RhcnRUYWJsZSgnbGlzdCcsJycs
JycsJycsJzkwJScpCiAgICAgICAgLiRvdXQKICAgICAgICAuZW5kVGFibGUoKTsKCiAgICAv
LyBPdXRwdXQgSmF2YVNjcmlwdCBhbmQgSFRNTAoKICAgIGVjaG8gJGpzLiRodG1sOwp9Cgov
LyBBZGQgVHdpdHRlciBvcHRpb25zIHRvIGFydGljbGUgYXJ0aWNsZSBzY3JlZW4KZnVuY3Rp
b24gYXJjX2FwcGVuZF90d2l0dGVyKCRldmVudCwgJHN0ZXAsICRkYXRhLCAkcnMxKQp7CiAg
ICBnbG9iYWwgJHByZWZzLCAkYXJjX3R3aXR0ZXI7CiAgICAkcHJlZml4ID0gdHJpbShncHMo
J2FyY190d2l0dGVyX3ByZWZpeCcpKTsKICAgICRwcmVmaXggPSAoJHByZWZpeCkgPyAkcHJl
Zml4IDogJHByZWZzWydhcmNfdHdpdHRlcl9wcmVmaXgnXTsKICAgICRzdWZmaXggPSB0cmlt
KGdwcygnYXJjX3R3aXR0ZXJfc3VmZml4JykpOwogICAgJHN1ZmZpeCA9ICgkc3VmZml4KSA/
ICRzdWZmaXggOiAkcHJlZnNbJ2FyY190d2l0dGVyX3N1ZmZpeCddOwoKICAgIGlmICgkcnMx
WydJRCddKSB7CiAgICAgICAgJHNxbCA9ICJTRUxFQ1QgdHdlZXRfaWQsdHdlZXQgRlJPTSAi
LlBGWC4iYXJjX3R3aXR0ZXIgV0hFUkUgYXJ0aWNsZV9pZD0iLiRyczFbJ0lEJ10uIjsiOwog
ICAgICAgICRyczIgPSBzYWZlX3F1ZXJ5KCRzcWwpOyAkcnMyID0gbmV4dFJvdygkcnMyKTsK
ICAgIH0gZWxzZSB7IC8vIG5ldyBhcnRpY2xlCiAgICAgICAgJHJzMiA9ICcnOwogICAgfQoK
ICAgIGlmICgkcnMxWydJRCddICYmICRyczJbJ3R3ZWV0X2lkJ10pIHsKICAgICAgICAkY29u
dGVudCA9IGFyY19Ud2l0dGVyOjptYWtlTGlua3MoJHJzMlsndHdlZXQnXSk7CiAgICAgICAg
cmV0dXJuICRkYXRhLmZpZWxkc2V0KCRjb250ZW50LCAnVHdpdHRlciB1cGRhdGUnLCAnYXJj
X3R3aXR0ZXInKTsKICAgIH0gZWxzZSB7CiAgICAgICAgJHZhciA9IGdwcygnYXJjX3R3ZWV0
X3RoaXMnKTsKICAgICAgICAkdmFyID0gKCRyczFbJ0lEJ10mJiEkdmFyKSA/IDAgOiAkcHJl
ZnNbJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnXTsKICAgICAgICAkY29udGVudCAgPSB0
YWcoeWVzbm9SYWRpbygnYXJjX3R3ZWV0X3RoaXMnLCAkdmFyLCAnJywgJ2FyY190d2VldF90
aGlzJyksJ3AnKTsKICAgICAgICAkY29udGVudCAuPSB0YWcoaHJlZignT3B0aW9ucycsJyNh
cmNfdHdpdHRlcl9vcHRpb25zJyksJ3AnLCcgY2xhc3M9InBsYWluIGxldmVyIiBzdHlsZT0i
bWFyZ2luLXRvcDo1cHg7IicpOwogICAgICAgICRjb250ZW50IC49IHRhZyh0YWcodGFnKCdU
d2VldCBwcmVmaXgnLCdsYWJlbCcsICcgZm9yPSJhcmNfdHdpdHRlcl9wcmVmaXgiJykKICAg
ICAgICAgICAgLmZJbnB1dCgndGV4dCcsJ2FyY190d2l0dGVyX3ByZWZpeCcsJHByZWZpeCwn
ZWRpdCcsJycsJycsJzIyJywnJywnYXJjX3R3aXR0ZXJfcHJlZml4JyksJ3AnKQogICAgICAg
ICAgICAudGFnKHRhZygnVHdlZXQgc3VmZml4IChlZyAjaGFzaHRhZ3MpJywnbGFiZWwnLCAn
IGZvcj0iYXJjX3R3aXR0ZXJfc3VmZml4IicpCiAgICAgICAgICAgIC5mSW5wdXQoJ3RleHQn
LCdhcmNfdHdpdHRlcl9zdWZmaXgnLCRzdWZmaXgsJ2VkaXQnLCcnLCcnLCcyMicsJycsJ2Fy
Y190d2l0dGVyX3N1ZmZpeCcpLCdwJykKICAgICAgICAgICAgLCdkaXYnLCcgaWQ9ImFyY190
d2l0dGVyX29wdGlvbnMiIGNsYXNzPSJ0b2dnbGUiIHN0eWxlPSJkaXNwbGF5Om5vbmUiJyk7
CiAgICAgICAgaWYgKGlzc2V0KCRhcmNfdHdpdHRlclsnZXJyb3InXSkpIHsKICAgICAgICAg
ICAgJGNvbnRlbnQgLj0gJzxwPicuJGFyY190d2l0dGVyWydlcnJvciddLic8L3A+JzsKICAg
ICAgICB9CiAgICAgICAgcmV0dXJuICRkYXRhLmZpZWxkc2V0KCRjb250ZW50LCAnVXBkYXRl
IFR3aXR0ZXInLCAnYXJjX3R3aXR0ZXInKTsKICAgIH0KCn0KCi8vIFVwZGF0ZSBUd2l0dGVy
IHdpdGggcG9zdGVkIGFydGljbGUKZnVuY3Rpb24gYXJjX2FydGljbGVfdHdlZXQoJGV2ZW50
LCRzdGVwKQp7CiAgICBnbG9iYWwgJHByZWZzLCAkYXJjX3R3aXR0ZXIsICRhcmNfdHdpdHRl
cl9jb25zdW1lcktleQogICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoK
ICAgICRhcnRpY2xlX2lkID0gZW1wdHkoJEdMT0JBTFNbJ0lEJ10pID8gZ3BzKCdJRCcpIDog
JEdMT0JBTFNbJ0lEJ107CiAgICBpZiAoIWVtcHR5KCRhcnRpY2xlX2lkKSkgewoKICAgICAg
ICBpbmNsdWRlX29uY2UgdHhwYXRoLicvcHVibGlzaC90YWdoYW5kbGVycy5waHAnOwoKICAg
ICAgICAkYXJ0aWNsZSA9IHNhZmVfcm93KCJJRCwgVGl0bGUsIFNlY3Rpb24sIFBvc3RlZCIs
ICd0ZXh0cGF0dGVybicsCiAgICAgICAgICAgICJJRD17JGFydGljbGVfaWR9IEFORCBTdGF0
dXM9NCBBTkQgbm93KCk+PVBvc3RlZCIpOwoKICAgICAgICBpZiAoJGFydGljbGUgJiYgZ3Bz
KCdhcmNfdHdlZXRfdGhpcycpKSB7IC8vIHR3ZWV0IGFydGljbGUKCiAgICAgICAgICAgIC8v
IE5lZWQgdG8gbWFudWFsbHkgdXBkYXRlIHRoZSAnVVJMIG9ubHkgdGl0bGUnIGJlZm9yZSBi
dWlsZGluZyB0aGUKICAgICAgICAgICAgLy8gVVJMCiAgICAgICAgICAgICRhcnRpY2xlWyd1
cmxfdGl0bGUnXSA9IGdwcygndXJsX3RpdGxlJyk7CiAgICAgICAgICAgIC8vIE1ha2Ugc2hv
cnQgVVJMCiAgICAgICAgICAgICR1cmwgPSBwZXJtbGlua3VybCgkYXJ0aWNsZSk7CiAgICAg
ICAgICAgICRzaG9ydF91cmwgPSBhcmNfc2hvcnRlbl91cmwoJHVybCwkcHJlZnNbJ2FyY190
d2l0dGVyX3VybF9tZXRob2QnXSwKICAgICAgICAgICAgICAgIGFycmF5KCdpZCc9PiRhcnRp
Y2xlX2lkKSk7CgogICAgICAgICAgICBpZiAoISRzaG9ydF91cmwpIHsgLy8gRmFpbGVkIHRv
IG9idGFpbiBhIHNob3J0ZW5lZCBVUkwsIGRvIG5vdCB0d2VldCEKICAgICAgICAgICAgICAg
ICRhcmNfdHdpdHRlclsnZXJyb3InXSA9ICdVbmFibGUgdG8gb2J0YWluIGEgc2hvcnQgVVJM
IGZvciB0aGlzIGFydGljbGUuJzsKCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAg
ICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIENvbnN0cnVjdCBUd2l0dGVyIHVwZGF0ZQog
ICAgICAgICAgICAkcHJlZml4ICA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9wcmVmaXgnKSk7
CiAgICAgICAgICAgICRwcmVfbGVuID0gc3RybGVuKCRwcmVmaXgpOwogICAgICAgICAgICAk
cHJlZml4ICA9ICgkcHJlZml4ICYmICRwcmVfbGVuPD0yMCkgPyAkcHJlZml4LicgJyA6ICcn
OwogICAgICAgICAgICAkc3VmZml4ICA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9zdWZmaXgn
KSk7CiAgICAgICAgICAgICRzdWZfbGVuID0gc3RybGVuKCRzdWZmaXgpOwogICAgICAgICAg
ICAkc3VmZml4ICA9ICgkc3VmZml4ICYmICRzdWZfbGVuPD00MCkgPyAnICcuJHN1ZmZpeCA6
ICcnOwogICAgICAgICAgICAkdXJsX2xlbiA9IHN0cmxlbigkc2hvcnRfdXJsKSsxOyAvLyBj
b3VudCBVUkwgbGVuZ3RoICsgMSBmb3IgcHJlZml4ZWQgc3BhY2UKICAgICAgICAgICAgaWYg
KCRwcmVmaXgpICRwcmVfbGVuICs9IDE7CiAgICAgICAgICAgIGlmICgkc3VmZml4KSAkc3Vm
X2xlbiArPSAxOwogICAgICAgICAgICBpZiAoKHN0cmxlbigkYXJ0aWNsZVsnVGl0bGUnXSkr
JHVybF9sZW4rJHByZV9sZW4rJHN1Zl9sZW4pPjE0MCkgewogICAgICAgICAgICAgICAgJGFy
dGljbGVbJ1RpdGxlJ10gPSBzdWJzdHIoJGFydGljbGVbJ1RpdGxlJ10sMCwxMzUtJHVybF9s
ZW4tJHByZV9sZW4tJHN1Zl9sZW4pLicuLi4nOwogICAgICAgICAgICB9CiAgICAgICAgICAg
ICR0d2VldCA9ICRwcmVmaXguJGFydGljbGVbJ1RpdGxlJ10uIiAiLiRzaG9ydF91cmwuJHN1
ZmZpeDsKCiAgICAgICAgICAgIC8vIFVwZGF0ZSBUd2l0dGVyCiAgICAgICAgICAgICR0d2l0
ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAg
ICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0
ZXJfYWNjZXNzVG9rZW4nXQogICAgICAgICAgICAgICAgLCAkcHJlZnNbJ2FyY190d2l0dGVy
X2FjY2Vzc1Rva2VuU2VjcmV0J10pOwogICAgICAgICAgICAkcmVzdWx0ID0gJHR3aXQtPnBv
c3QoJ3N0YXR1c2VzL3VwZGF0ZScsIGFycmF5KCdzdGF0dXMnID0+ICR0d2VldCkpOwoKICAg
ICAgICAgICAgJHR3ZWV0X2lkID0gKGlzX29iamVjdCgkcmVzdWx0KSkgPyAkcmVzdWx0WzBd
LT5pZCA6IDA7CgogICAgICAgICAgICBpZiAoJHR3ZWV0X2lkKSB7CgogICAgICAgICAgICAg
ICAgJHR3ZWV0ID0gYWRkc2xhc2hlcygkdHdlZXQpOwoKICAgICAgICAgICAgICAgIC8vIHVw
ZGF0ZSBhcmNfdHdpdHRlciB0YWJsZSB3aXRoIHR3ZWV0CiAgICAgICAgICAgICAgICAkc3Fs
ID0gIklOU0VSVCBJTlRPICIuUEZYLiJhcmNfdHdpdHRlciAoYXJ0aWNsZV9pZCx0d2VldF9p
ZCx0d2VldCx0aW55dXJsKSAiOwogICAgICAgICAgICAgICAgJHNxbC49ICJWQUxVRVMoJGFy
dGljbGVfaWQsJHR3ZWV0X2lkLFwiJHR3ZWV0XCIsJyRzaG9ydF91cmwnKTsiOwogICAgICAg
ICAgICAgICAgc2FmZV9xdWVyeSgkc3FsKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1
ZTsKCiAgICAgICAgICAgIH0gZWxzZSB7CgogICAgICAgICAgICAgICAgJGFyY190d2l0dGVy
WydlcnJvciddID0gJ1R3aXR0ZXIgcmVzcG9uc2U6ICcKICAgICAgICAgICAgICAgICAgICAu
JHR3aXQtPmh0dHBfY29kZTsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAg
ICAgICAgIH0KCiAgICAgICAgfQoKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7Cgp9CgovKgog
KiBTaG9ydGVuIFVSTHMgdXNpbmcgdmFyaW91cyBtZXRob2RzCiAqLwoKZnVuY3Rpb24gYXJj
X3Nob3J0ZW5fdXJsKCR1cmwsICRtZXRob2Q9JycsICRhdHRzPWFycmF5KCkpCnsKICBnbG9i
YWwgJHByZWZzOwoKICAkY2ggPSBjdXJsX2luaXQoKTsKICBjdXJsX3NldG9wdCgkY2gsIENV
UkxPUFRfSEVBREVSLCAwKTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUkVUVVJOVFJB
TlNGRVIsIHRydWUpOwogIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9USU1FT1VULCAxMCk7
CgogIHN3aXRjaCAoJG1ldGhvZCkgewogICAgY2FzZSAnc21kJzogLy8gY3JlYXRlIGEgc2hv
cnRlbmVkIFVSTCB1c2luZyBTTUQgU2hvcnQgVVJMCiAgICAgIHJldHVybiAoJGF0dHNbJ2lk
J10pID8gaHUuJGF0dHNbJ2lkJ10gOiBmYWxzZTsgYnJlYWs7CiAgICBjYXNlICdhcmNfdHdp
dHRlcic6IC8vIG5hdGl2ZSBVUkwgc2hvcnRlbmluZwoKICAgICAgcmV0dXJuICgkYXR0c1sn
aWQnXSkgPyBQUk9UT0NPTC4kcHJlZnNbJ2FyY19zaG9ydF9zaXRlX3VybCddLicvJy4kYXR0
c1snaWQnXSA6IGZhbHNlOwogICAgICBicmVhazsKCiAgICBjYXNlICdpc2dkJzoKCiAgICAg
ICR1ID0gJ2h0dHA6Ly9pcy5nZC9hcGkucGhwP2xvbmd1cmw9Jy51cmxlbmNvZGUoJHVybCk7
CiAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VUkwsICR1KTsKCiAgICAgICR0aW55
dXJsID0gY3VybF9leGVjKCRjaCk7CiAgICAgIGlmICgkdGlueXVybCE9J0Vycm9yJyAmJiAk
dGlueXVybCE9JycpIHsKICAgICAgICByZXR1cm4gJHRpbnl1cmw7CiAgICAgIH0gZWxzZSB7
CiAgICAgICAgdHJpZ2dlcl9lcnJvcignYXJjX3R3aXR0ZXIgZmFpbGVkIHRvIGdldCBhIGlz
LmdkIFVSTCBmb3IgJwogICAgICAgICAgICAuJHVybCxFX1VTRVJfV0FSTklORyk7CiAgICAg
IH0KICAgICAgYnJlYWs7CgogICAgY2FzZSAndGlueXVybCc6IGRlZmF1bHQ6IC8vIGNyZWF0
ZSBhIHNob3J0ZW5lZCBVUkwgdXNpbmcgVGlueVVSTAoKICAgICAgJHUgPSAnaHR0cDovL3Rp
bnl1cmwuY29tL2FwaS1jcmVhdGUucGhwP3VybD0nLnVybGVuY29kZSgkdXJsKTsKICAgICAg
Y3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwgJHUpOwogICAgICAkdGlueXVybCA9IGN1
cmxfZXhlYygkY2gpOwogICAgICBpZiAoJHRpbnl1cmwhPSdFcnJvcicgJiYgJHRpbnl1cmwh
PScnKSB7CiAgICAgICAgcmV0dXJuICR0aW55dXJsOwogICAgICB9IGVsc2UgewogICAgICAg
IHRyaWdnZXJfZXJyb3IoJ2FyY190d2l0dGVyIGZhaWxlZCB0byBnZXQgYSBUaW55VVJMIGZv
ciAnLiR1cmwsRV9VU0VSX1dBUk5JTkcpOwogICAgICB9CgogIH0KCiAgcmV0dXJuIGZhbHNl
OyAvLyBmYWlsCgp9CgovKgogKiBTaG9ydGVuZWQgVVJMIHJlZGlyZWN0IGJhc2VkIG9uIHNt
ZF9zaG9ydF91cmwKICovCmZ1bmN0aW9uIGFyY19zaG9ydF91cmxfcmVkaXJlY3QoJGV2ZW50
LCAkc3RlcCkgewogIGdsb2JhbCAkcHJlZnM7CgogICRoYXZlX2lkID0gMDsKCiAgLy8gQ2hl
Y2sgaWYgdGhlcmUgaXMgYW4gYXZhaWxhYmxlIHNob3J0IHNpdGUgdXJsIGFuZCBpZiBpdCBp
cyBiZWluZyB1c2VkIGluCiAgLy8gdGhpcyBpbnN0YW5jZQogICRzaG9ydF9zaXRlX3VybCA9
ICRwcmVmc1snYXJjX3Nob3J0X3NpdGVfdXJsJ107CiAgaWYgKCRzaG9ydF9zaXRlX3VybCkg
ewogICAgJHNob3J0X3NpdGVfdXJsID0gUFJPVE9DT0wuJHNob3J0X3NpdGVfdXJsLicvJzsK
ICAgICR1cmxfcGFydHMgPSBwYXJzZV91cmwoJHNob3J0X3NpdGVfdXJsKTsKICAgICRyZSA9
ICcjXicuJHVybF9wYXJ0c1sncGF0aCddLicoWzAtOV0uKikjJzsKICAgICRoYXZlX2lkID0g
cHJlZ19tYXRjaCgkcmUsICRfU0VSVkVSWydSRVFVRVNUX1VSSSddLCAkbSk7CiAgfQoKICAv
LyBGYWxsIGJhY2sgdG8gc3RhbmRhcmQgc2l0ZSB1cmwgKHNtZF9zaG9ydF91cmwgYmVoYXZp
b3VyKQogIGlmICgkaGF2ZV9pZCkgewogICAgJHVybF9wYXJ0cyA9IHBhcnNlX3VybChodSk7
CiAgICAkcmUgPSAnI14nLiR1cmxfcGFydHNbJ3BhdGgnXS4nKFswLTldLiopIyc7CiAgICAk
aGF2ZV9pZCA9IHByZWdfbWF0Y2goJHJlLCAkX1NFUlZFUlsnUkVRVUVTVF9VUkknXSwgJG0p
OwogIH0KCiAgLy8gRG8gdGhlIHJlZGlyZWN0IGlmIHdlJ3ZlIGdvdCBhbiBhcnRpY2xlIGlk
CiAgaWYgKCRoYXZlX2lkKSB7CgkgICRpZCA9ICRtWzFdOwoJICAkcGVybWxpbmsgPSBwZXJt
bGlua3VybF9pZCgkaWQpOwoKCSAgaWYgKCRwZXJtbGluaykgewoJCSAgb2JfZW5kX2NsZWFu
KCk7CgoJCSAgLy8gU3R1cGlkLCBvdmVyIHRoZSB0b3AgaGVhZGVyIHNldHRpbmcgZm9yIElF
CgkJICBoZWFkZXIoIlN0YXR1czogMzAxIik7CgkJICBoZWFkZXIoIkhUVFAvMS4wIDMwMSBN
b3ZlZCBQZXJtYW5lbnRseSIpOwoJCSAgaGVhZGVyKCJMb2NhdGlvbjogIi4kcGVybWxpbmss
IFRSVUUsIDMwMSk7CgoJCSAgLy8gSW4gY2FzZSB0aGUgaGVhZGVyKCkgbWV0aG9kIGZhaWxz
LCBmYWxsIGJhY2sgb24gYSBjbGFzc2ljIHJlZGlyZWN0CgkJICBlY2hvICc8aHRtbD48aGVh
ZD48TUVUQSBIVFRQLUVRVUlWPSJSZWZyZXNoIiBDT05URU5UPSIwO1VSTD0nCgkJICAgIC4k
cGVybWxpbmsuJyI+PC9oZWFkPjxib2R5PjwvYm9keT48L2h0bWw+JzsKCQkgIGRpZSgpOwoJ
ICB9CiAgfQoKfQoKLy8gQXV0byBlbmFibGUgcGx1Z2luIG9uIGluc3RhbGwgKG9yaWdpbmFs
IGlkZWEgYnkgTWljaGFlbCBNYW5mcmUpCmZ1bmN0aW9uIF9hcmNfdHdpdHRlcl9hdXRvX2Vu
YWJsZSgkZXZlbnQsICRzdGVwLCAkcHJlZml4PSdhcmNfdHdpdHRlcicpCnsKICAkcGx1Z2lu
ID0gc3Vic3RyKCRldmVudCwgc3RybGVuKCdwbHVnaW5fbGlmZWN5Y2xlLicpKTsKICBpZiAo
c3RybmNtcCgkcGx1Z2luLCAkcHJlZml4LCBzdHJsZW4oJHByZWZpeCkpID09IDApCiAgewog
ICAgc2FmZV91cGRhdGUoJ3R4cF9wbHVnaW4nLCAic3RhdHVzID0gMSIsICJuYW1lID0gJyIg
LiBkb1NsYXNoKCRwbHVnaW4pIC4gIiciKTsKICB9Cn0KCi8qCiAqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqCiovCgpjbGFzcyBhcmNfdHdpdHRlciBleHRlbmRzIFR3aXR0ZXJPQXV0aCB7
CiAgICAvLyBDYWNoaW5nIHZhcmlhYmxlcwogICAgcHJpdmF0ZSAkX2NhY2hlID0gdHJ1ZTsK
ICAgIHByaXZhdGUgJF9jYWNoZV9kaXIgPSAnLi90bXAnOwogICAgcHJpdmF0ZSAkX2NhY2hl
X3RpbWUgPSAxODAwOyAvLyAzMCBtaW51dGUgY2FjaGUKCiAgICBmdW5jdGlvbiBfX2NvbnN0
cnVjdCgkY29uc3VtZXJfa2V5LCAkY29uc3VtZXJfc2VjcmV0LCAkb2F1dGhfdG9rZW4gPSBO
VUxMCiAgICAgICAgLCAkb2F1dGhfdG9rZW5fc2VjcmV0ID0gTlVMTCkKICAgIHsKICAgICAg
ICBwYXJlbnQ6Ol9fY29uc3RydWN0KCRjb25zdW1lcl9rZXksICRjb25zdW1lcl9zZWNyZXQs
ICRvYXV0aF90b2tlbgogICAgICAgICAgICAsICRvYXV0aF90b2tlbl9zZWNyZXQpOwogICAg
ICAgICR0aGlzLT5mb3JtYXQgPSAneG1sJzsKICAgICAgICAkdGhpcy0+dGltZW91dCA9IDE1
OwogICAgICAgICR0aGlzLT5jb25uZWN0dGltZW91dCA9IDE1OwogICAgfQoKICAgIHB1Ymxp
YyBmdW5jdGlvbiBjYWxsYmFja1VSTCgkZXZlbnQsJHN0ZXApCiAgICB7CiAgICAgICAgcmV0
dXJuIHByZWdfcmVwbGFjZSgnL1w/LiovJywgJycsUFJPVE9DT0wuJF9TRVJWRVJbJ1NFUlZF
Ul9OQU1FJ10uJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ10pCiAgICAgICAgICAuJz9ldmVudD0n
LiRldmVudC4nJmFtcDtzdGVwPScuJHN0ZXA7CiAgICB9CgogICAgLy8gY3JlYXRlIFR3aXR0
ZXIgYW5kIGV4dGVybmFsIGxpbmtzIGluIHRleHQKICAgIHB1YmxpYyBzdGF0aWMgZnVuY3Rp
b24gbWFrZUxpbmtzKCR0ZXh0KQogICAgewogICAgICAgICR1cmwgPSAnL1xiKGh0dHB8aHR0
cHN8ZnRwKTpcL1wvKFtBLVowLTldW0EtWjAtOV8tXSooPzpcLltBLVowLTldW0EtWjAtOV8t
XSopKyk6PyhcZCspP1wvPyhbXC9cdytcLl0rKVxiL2knOwogICAgICAgICR0ZXh0ID0gcHJl
Z19yZXBsYWNlKCR1cmwsICI8YSBocmVmPSckMCc+JDA8L2E+IiwgJHRleHQpOwogICAgICAg
ICR1cmwgPSAnL1xiKF58XHMpd3d3LihbYS16X0EtWjAtOV0rKSgoXC5bYS16XSspKylcYi9p
JzsKICAgICAgICAkdGV4dCA9IHByZWdfcmVwbGFjZSgkdXJsLCAiPGEgaHJlZj0naHR0cDov
L3d3dy4kMiQzJz53d3cuJDIkMzwvYT4iLCAkdGV4dCk7CiAgICAgICAgJHRleHQgPSBwcmVn
X3JlcGxhY2UoIi8oXnxccylAKFthLXpfQS1aMC05XSspLyIsCiAgICAgICAgICAgICIkMUA8
YSBocmVmPSdodHRwOi8vdHdpdHRlci5jb20vJDInPiQyPC9hPiIsJHRleHQpOwogICAgICAg
ICR0ZXh0ID0gcHJlZ19yZXBsYWNlKCIvKF58XHMpKFwjKFthLXpfQS1aMC05Ol8tXSspKS8i
LAogICAgICAgICAgICAiJDE8YSBocmVmPSdodHRwOi8vdHdpdHRlci5jb20vc2VhcmNoP3E9
JTIzJDMnPiQyPC9hPiIsJHRleHQpOwogICAgICAgIHJldHVybiAkdGV4dDsKICB9CgogICAg
cHVibGljIGZ1bmN0aW9uIGdldCgkdXJsLCAkcGFyYW1zID0gYXJyYXkoKSkKICAgIHsKICAg
ICAgICAkYXBpX3VybCA9IG1kNSgkdXJsLnVybGVuY29kZShzZXJpYWxpemUoJHBhcmFtcykp
KTsKICAgICAgICAkZGF0YSA9ICcnOwoKICAgICAgICBpZiAoJHRoaXMtPl9jYWNoZSkgeyAv
LyBjaGVjayBmb3IgY2FjaGVkIHhtbAoKICAgICAgICAgICAgJGRhdGEgPSAkdGhpcy0+X3Jl
dHJpZXZlQ2FjaGUoJGFwaV91cmwpOwoKICAgICAgICB9CiAgICAgICAgaWYgKGVtcHR5KCRk
YXRhKSkgewogICAgICAgICAgICAkZGF0YSA9IHBhcmVudDo6Z2V0KCR1cmwsICRwYXJhbXMp
OwogICAgICAgICAgICBpZiAoJHRoaXMtPmh0dHBfY29kZT09PTIwMCAmJiAkeG1sPXNpbXBs
ZXhtbF9sb2FkX3N0cmluZygkZGF0YSkpIHsgLy8gc2F2ZSBjYWNoZQogICAgICAgICAgICAg
ICAgJGZpbGUgPSAkdGhpcy0+X2NhY2hlX2Rpci4nLycuJGFwaV91cmw7CiAgICAgICAgICAg
ICAgICBmaWxlX3B1dF9jb250ZW50cygkZmlsZSwkZGF0YSxMT0NLX0VYKTsKICAgICAgICAg
ICAgICAgIHJldHVybiAkeG1sOwogICAgICAgICAgICB9IGVsc2UgeyAvLyBmYWlsZWQgdG8g
cmV0cmlldmUgZGF0YSBmcm9tIFR3aXR0ZXIKCiAgICAgICAgICAgICAgICBpZiAoJHRoaXMt
Pl9jYWNoZSkgeyAvLyBhdHRlbXB0IHRvIGZvcmNlIGNhY2hlZCB4bWwgcmV0dXJuCgogICAg
ICAgICAgICAgICAgICAgICRkYXRhID0gJHRoaXMtPl9yZXRyaWV2ZUNhY2hlKCRhcGlfdXJs
LHRydWUpOwogICAgICAgICAgICAgICAgICAgIGlmICgkZGF0YSkgcmV0dXJuIEBzaW1wbGV4
bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwoKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAg
ICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsgLy8g
cmV0dXJuIGNhY2hlZCB4bWwKICAgICAgICAgICAgcmV0dXJuIEBzaW1wbGV4bWxfbG9hZF9z
dHJpbmcoJGRhdGEpOwogICAgICAgIH0KICAgIH0gLy9lbmQgZ2V0KCkKCiAgICBmdW5jdGlv
biBwb3N0KCR1cmwsICRwYXJhbXMgPSBhcnJheSgpKQogICAgewogICAgICAgICRkYXRhID0g
cGFyZW50Ojpwb3N0KCR1cmwsJHBhcmFtcyk7CiAgICAgICAgcmV0dXJuIHNpbXBsZXhtbF9s
b2FkX3N0cmluZygkZGF0YSk7CiAgICB9CgogICAgZnVuY3Rpb24gZGVsZXRlKCR1cmwsICRw
YXJhbXMgPSBhcnJheSgpKQogICAgewogICAgICAgICRkYXRhID0gcGFyZW50OjpkZWxldGUo
JHVybCwkcGFyYW1zKTsKICAgICAgICByZXR1cm4gc2ltcGxleG1sX2xvYWRfc3RyaW5nKCRk
YXRhKTsKICAgIH0KCiAgICAvLyBDYWNoZSBtZXRob2RzCgogICAgcHVibGljIGZ1bmN0aW9u
IHNldENhY2hpbmcoJGNhY2hlPXRydWUpCiAgICB7CiAgICAgICAgJHRoaXMtPl9jYWNoZSA9
ICgkY2FjaGUpID8gdHJ1ZSA6IGZhbHNlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoK
ICAgIHB1YmxpYyBmdW5jdGlvbiBjYWNoZURpcigkbG9jKQogICAgewogICAgICAgICR0aGlz
LT5fY2FjaGVfZGlyID0gJGxvYzsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBw
dWJsaWMgZnVuY3Rpb24gY2FjaGVUaW1lKCRtaW5zKQogICAgewogICAgICAgICR0aGlzLT5f
Y2FjaGVfdGltZSA9ICRtaW5zKjYwOyAvLyBjb252ZXJ0IG1pbnV0ZXMgaW50byBzZWNvbmRz
CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJpdmF0ZSBmdW5jdGlvbiBfcmV0
cmlldmVDYWNoZSgkdXJsLCRvdmVyaWRlX3RpbWVvdXQ9ZmFsc2UpCiAgICB7CiAgICAgICAg
JGZpbGUgPSAkdGhpcy0+X2NhY2hlX2Rpci4nLycuJHVybDsKICAgICAgICBpZiAoZmlsZV9l
eGlzdHMoJGZpbGUpKSB7CgogICAgICAgICAgICAkZGlmZiA9IHRpbWUoKSAtIGZpbGVtdGlt
ZSgkZmlsZSk7CiAgICAgICAgICAgIGlmICgkb3ZlcmlkZV90aW1lb3V0IHx8ICRkaWZmIDwg
JHRoaXMtPl9jYWNoZV90aW1lKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmlsZV9nZXRf
Y29udGVudHMoJGZpbGUpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAg
cmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgIH0gZWxzZSB7CiAgICAgICAg
ICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICB9Cn0KCi8qCiAqIEFicmFoYW0gV2ls
bGlhbXMgKGFicmFoYW1AYWJyYWguYW0pIGh0dHA6Ly9hYnJhaC5hbQogKgogKiBUaGUgZmly
c3QgUEhQIExpYnJhcnkgdG8gc3VwcG9ydCBPQXV0aCBmb3IgVHdpdHRlcidzIFJFU1QgQVBJ
LgogKi8KCi8qKgogKiBUd2l0dGVyIE9BdXRoIGNsYXNzCiAqLwpjbGFzcyBUd2l0dGVyT0F1
dGggewogIC8qIENvbnRhaW5zIHRoZSBsYXN0IEhUVFAgc3RhdHVzIGNvZGUgcmV0dXJuZWQu
ICovCiAgcHVibGljICRodHRwX2NvZGU7CiAgLyogQ29udGFpbnMgdGhlIGxhc3QgQVBJIGNh
bGwuICovCiAgcHVibGljICR1cmw7CiAgLyogU2V0IHVwIHRoZSBBUEkgcm9vdCBVUkwuICov
CiAgcHVibGljICRob3N0ID0gImh0dHBzOi8vYXBpLnR3aXR0ZXIuY29tLzEvIjsKICAvKiBT
ZXQgdGltZW91dCBkZWZhdWx0LiAqLwogIHB1YmxpYyAkdGltZW91dCA9IDMwOwogIC8qIFNl
dCBjb25uZWN0IHRpbWVvdXQuICovCiAgcHVibGljICRjb25uZWN0dGltZW91dCA9IDMwOwog
IC8qIFZlcmlmeSBTU0wgQ2VydC4gKi8KICBwdWJsaWMgJHNzbF92ZXJpZnlwZWVyID0gRkFM
U0U7CiAgLyogUmVzcG9ucyBmb3JtYXQuICovCiAgcHVibGljICRmb3JtYXQgPSAnanNvbic7
CiAgLyogRGVjb2RlIHJldHVybmVkIGpzb24gZGF0YS4gKi8KICBwdWJsaWMgJGRlY29kZV9q
c29uID0gVFJVRTsKICAvKiBDb250YWlucyB0aGUgbGFzdCBIVFRQIGhlYWRlcnMgcmV0dXJu
ZWQuICovCiAgcHVibGljICRodHRwX2luZm87CiAgLyogU2V0IHRoZSB1c2VyYWduZXQuICov
CiAgcHVibGljICR1c2VyYWdlbnQgPSAnVHdpdHRlck9BdXRoIHYwLjIuMC1iZXRhMic7CiAg
LyogSW1tZWRpYXRlbHkgcmV0cnkgdGhlIEFQSSBjYWxsIGlmIHRoZSByZXNwb25zZSB3YXMg
bm90IHN1Y2Nlc3NmdWwuICovCiAgLy9wdWJsaWMgJHJldHJ5ID0gVFJVRTsKCgoKCiAgLyoq
CiAgICogU2V0IEFQSSBVUkxTCiAgICovCiAgZnVuY3Rpb24gYWNjZXNzVG9rZW5VUkwoKSAg
eyByZXR1cm4gJ2h0dHBzOi8vYXBpLnR3aXR0ZXIuY29tL29hdXRoL2FjY2Vzc190b2tlbic7
IH0KICBmdW5jdGlvbiBhdXRoZW50aWNhdGVVUkwoKSB7IHJldHVybiAnaHR0cHM6Ly90d2l0
dGVyLmNvbS9vYXV0aC9hdXRoZW50aWNhdGUnOyB9CiAgZnVuY3Rpb24gYXV0aG9yaXplVVJM
KCkgICAgeyByZXR1cm4gJ2h0dHBzOi8vdHdpdHRlci5jb20vb2F1dGgvYXV0aG9yaXplJzsg
fQogIGZ1bmN0aW9uIHJlcXVlc3RUb2tlblVSTCgpIHsgcmV0dXJuICdodHRwczovL2FwaS50
d2l0dGVyLmNvbS9vYXV0aC9yZXF1ZXN0X3Rva2VuJzsgfQoKICAvKioKICAgKiBEZWJ1ZyBo
ZWxwZXJzCiAgICovCiAgZnVuY3Rpb24gbGFzdFN0YXR1c0NvZGUoKSB7IHJldHVybiAkdGhp
cy0+aHR0cF9zdGF0dXM7IH0KICBmdW5jdGlvbiBsYXN0QVBJQ2FsbCgpIHsgcmV0dXJuICR0
aGlzLT5sYXN0X2FwaV9jYWxsOyB9CgogIC8qKgogICAqIGNvbnN0cnVjdCBUd2l0dGVyT0F1
dGggb2JqZWN0CiAgICovCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGNvbnN1bWVyX2tleSwg
JGNvbnN1bWVyX3NlY3JldCwgJG9hdXRoX3Rva2VuID0gTlVMTCwgJG9hdXRoX3Rva2VuX3Nl
Y3JldCA9IE5VTEwpIHsKICAgICR0aGlzLT5zaGExX21ldGhvZCA9IG5ldyBPQXV0aFNpZ25h
dHVyZU1ldGhvZF9ITUFDX1NIQTEoKTsKICAgICR0aGlzLT5jb25zdW1lciA9IG5ldyBPQXV0
aENvbnN1bWVyKCRjb25zdW1lcl9rZXksICRjb25zdW1lcl9zZWNyZXQpOwogICAgaWYgKCFl
bXB0eSgkb2F1dGhfdG9rZW4pICYmICFlbXB0eSgkb2F1dGhfdG9rZW5fc2VjcmV0KSkgewog
ICAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigkb2F1dGhfdG9rZW4sICRv
YXV0aF90b2tlbl9zZWNyZXQpOwogICAgfSBlbHNlIHsKICAgICAgJHRoaXMtPnRva2VuID0g
TlVMTDsKICAgIH0KICB9CgoKICAvKioKICAgKiBHZXQgYSByZXF1ZXN0X3Rva2VuIGZyb20g
VHdpdHRlcgogICAqCiAgICogQHJldHVybnMgYSBrZXkvdmFsdWUgYXJyYXkgY29udGFpbmlu
ZyBvYXV0aF90b2tlbiBhbmQgb2F1dGhfdG9rZW5fc2VjcmV0CiAgICovCiAgZnVuY3Rpb24g
Z2V0UmVxdWVzdFRva2VuKCRvYXV0aF9jYWxsYmFjayA9IE5VTEwpIHsKICAgICRwYXJhbWV0
ZXJzID0gYXJyYXkoKTsKICAgIGlmICghZW1wdHkoJG9hdXRoX2NhbGxiYWNrKSkgewogICAg
ICAkcGFyYW1ldGVyc1snb2F1dGhfY2FsbGJhY2snXSA9ICRvYXV0aF9jYWxsYmFjazsKICAg
IH0KICAgICRyZXF1ZXN0ID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdGhpcy0+cmVxdWVzdFRv
a2VuVVJMKCksICdHRVQnLCAkcGFyYW1ldGVycyk7CiAgICAkdG9rZW4gPSBPQXV0aFV0aWw6
OnBhcnNlX3BhcmFtZXRlcnMoJHJlcXVlc3QpOwogICAgJHRoaXMtPnRva2VuID0gbmV3IE9B
dXRoQ29uc3VtZXIoJHRva2VuWydvYXV0aF90b2tlbiddLCAkdG9rZW5bJ29hdXRoX3Rva2Vu
X3NlY3JldCddKTsKICAgIHJldHVybiAkdG9rZW47CiAgfQoKICAvKioKICAgKiBHZXQgdGhl
IGF1dGhvcml6ZSBVUkwKICAgKgogICAqIEByZXR1cm5zIGEgc3RyaW5nCiAgICovCiAgZnVu
Y3Rpb24gZ2V0QXV0aG9yaXplVVJMKCR0b2tlbiwgJHNpZ25faW5fd2l0aF90d2l0dGVyID0g
VFJVRSkgewogICAgaWYgKGlzX2FycmF5KCR0b2tlbikpIHsKICAgICAgJHRva2VuID0gJHRv
a2VuWydvYXV0aF90b2tlbiddOwogICAgfQogICAgaWYgKGVtcHR5KCRzaWduX2luX3dpdGhf
dHdpdHRlcikpIHsKICAgICAgcmV0dXJuICR0aGlzLT5hdXRob3JpemVVUkwoKSAuICI/b2F1
dGhfdG9rZW49eyR0b2tlbn0iOwogICAgfSBlbHNlIHsKICAgICAgIHJldHVybiAkdGhpcy0+
YXV0aGVudGljYXRlVVJMKCkgLiAiP29hdXRoX3Rva2VuPXskdG9rZW59IjsKICAgIH0KICB9
CgogIC8qKgogICAqIEV4Y2hhbmdlIHJlcXVlc3QgdG9rZW4gYW5kIHNlY3JldCBmb3IgYW4g
YWNjZXNzIHRva2VuIGFuZAogICAqIHNlY3JldCwgdG8gc2lnbiBBUEkgY2FsbHMuCiAgICoK
ICAgKiBAcmV0dXJucyBhcnJheSgib2F1dGhfdG9rZW4iID0+ICJ0aGUtYWNjZXNzLXRva2Vu
IiwKICAgKiAgICAgICAgICAgICAgICAib2F1dGhfdG9rZW5fc2VjcmV0IiA9PiAidGhlLWFj
Y2Vzcy1zZWNyZXQiLAogICAqICAgICAgICAgICAgICAgICJ1c2VyX2lkIiA9PiAiOTQzNjk5
MiIsCiAgICogICAgICAgICAgICAgICAgInNjcmVlbl9uYW1lIiA9PiAiYWJyYWhhbSIpCiAg
ICovCiAgZnVuY3Rpb24gZ2V0QWNjZXNzVG9rZW4oJG9hdXRoX3ZlcmlmaWVyID0gRkFMU0Up
IHsKICAgICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgIGlmICghZW1wdHkoJG9hdXRoX3Zl
cmlmaWVyKSkgewogICAgICAkcGFyYW1ldGVyc1snb2F1dGhfdmVyaWZpZXInXSA9ICRvYXV0
aF92ZXJpZmllcjsKICAgIH0KICAgICRyZXF1ZXN0ID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgk
dGhpcy0+YWNjZXNzVG9rZW5VUkwoKSwgJ0dFVCcsICRwYXJhbWV0ZXJzKTsKICAgICR0b2tl
biA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygkcmVxdWVzdCk7CiAgICAkdGhpcy0+
dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigkdG9rZW5bJ29hdXRoX3Rva2VuJ10sICR0b2tl
blsnb2F1dGhfdG9rZW5fc2VjcmV0J10pOwogICAgcmV0dXJuICR0b2tlbjsKICB9CgogIC8q
KgogICAqIE9uZSB0aW1lIGV4Y2hhbmdlIG9mIHVzZXJuYW1lIGFuZCBwYXNzd29yZCBmb3Ig
YWNjZXNzIHRva2VuIGFuZCBzZWNyZXQuCiAgICoKICAgKiBAcmV0dXJucyBhcnJheSgib2F1
dGhfdG9rZW4iID0+ICJ0aGUtYWNjZXNzLXRva2VuIiwKICAgKiAgICAgICAgICAgICAgICAi
b2F1dGhfdG9rZW5fc2VjcmV0IiA9PiAidGhlLWFjY2Vzcy1zZWNyZXQiLAogICAqICAgICAg
ICAgICAgICAgICJ1c2VyX2lkIiA9PiAiOTQzNjk5MiIsCiAgICogICAgICAgICAgICAgICAg
InNjcmVlbl9uYW1lIiA9PiAiYWJyYWhhbSIsCiAgICogICAgICAgICAgICAgICAgInhfYXV0
aF9leHBpcmVzIiA9PiAiMCIpCiAgICovCiAgZnVuY3Rpb24gZ2V0WEF1dGhUb2tlbigkdXNl
cm5hbWUsICRwYXNzd29yZCkgewogICAgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgJHBh
cmFtZXRlcnNbJ3hfYXV0aF91c2VybmFtZSddID0gJHVzZXJuYW1lOwogICAgJHBhcmFtZXRl
cnNbJ3hfYXV0aF9wYXNzd29yZCddID0gJHBhc3N3b3JkOwogICAgJHBhcmFtZXRlcnNbJ3hf
YXV0aF9tb2RlJ10gPSAnY2xpZW50X2F1dGgnOwogICAgJHJlcXVlc3QgPSAkdGhpcy0+b0F1
dGhSZXF1ZXN0KCR0aGlzLT5hY2Nlc3NUb2tlblVSTCgpLCAnUE9TVCcsICRwYXJhbWV0ZXJz
KTsKICAgICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygkcmVxdWVzdCk7
CiAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigkdG9rZW5bJ29hdXRoX3Rv
a2VuJ10sICR0b2tlblsnb2F1dGhfdG9rZW5fc2VjcmV0J10pOwogICAgcmV0dXJuICR0b2tl
bjsKICB9CgogIC8qKgogICAqIEdFVCB3cmFwcGVyIGZvciBvQXV0aFJlcXVlc3QuCiAgICov
CiAgZnVuY3Rpb24gZ2V0KCR1cmwsICRwYXJhbWV0ZXJzID0gYXJyYXkoKSkgewogICAgJHJl
c3BvbnNlID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdXJsLCAnR0VUJywgJHBhcmFtZXRlcnMp
OwogICAgaWYgKCR0aGlzLT5mb3JtYXQgPT09ICdqc29uJyAmJiAkdGhpcy0+ZGVjb2RlX2pz
b24pIHsKICAgICAgcmV0dXJuIGpzb25fZGVjb2RlKCRyZXNwb25zZSk7CiAgICB9CiAgICBy
ZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoqCiAgICogUE9TVCB3cmFwcGVyIGZvciBvQXV0
aFJlcXVlc3QuCiAgICovCiAgZnVuY3Rpb24gcG9zdCgkdXJsLCAkcGFyYW1ldGVycyA9IGFy
cmF5KCkpIHsKICAgICRyZXNwb25zZSA9ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHVybCwgJ1BP
U1QnLCAkcGFyYW1ldGVycyk7CiAgICBpZiAoJHRoaXMtPmZvcm1hdCA9PT0gJ2pzb24nICYm
ICR0aGlzLT5kZWNvZGVfanNvbikgewogICAgICByZXR1cm4ganNvbl9kZWNvZGUoJHJlc3Bv
bnNlKTsKICAgIH0KICAgIHJldHVybiAkcmVzcG9uc2U7CiAgfQoKICAvKioKICAgKiBERUxF
VEUgd3JhcHBlciBmb3Igb0F1dGhSZXFldXN0LgogICAqLwogIGZ1bmN0aW9uIGRlbGV0ZSgk
dXJsLCAkcGFyYW1ldGVycyA9IGFycmF5KCkpIHsKICAgICRyZXNwb25zZSA9ICR0aGlzLT5v
QXV0aFJlcXVlc3QoJHVybCwgJ0RFTEVURScsICRwYXJhbWV0ZXJzKTsKICAgIGlmICgkdGhp
cy0+Zm9ybWF0ID09PSAnanNvbicgJiYgJHRoaXMtPmRlY29kZV9qc29uKSB7CiAgICAgIHJl
dHVybiBqc29uX2RlY29kZSgkcmVzcG9uc2UpOwogICAgfQogICAgcmV0dXJuICRyZXNwb25z
ZTsKICB9CgogIC8qKgogICAqIEZvcm1hdCBhbmQgc2lnbiBhbiBPQXV0aCAvIEFQSSByZXF1
ZXN0CiAgICovCiAgZnVuY3Rpb24gb0F1dGhSZXF1ZXN0KCR1cmwsICRtZXRob2QsICRwYXJh
bWV0ZXJzKSB7CiAgICBpZiAoc3RycnBvcygkdXJsLCAnaHR0cHM6Ly8nKSAhPT0gMCAmJiBz
dHJycG9zKCR1cmwsICdodHRwOi8vJykgIT09IDApIHsKICAgICAgJHVybCA9ICJ7JHRoaXMt
Pmhvc3R9eyR1cmx9LnskdGhpcy0+Zm9ybWF0fSI7CiAgICB9CiAgICAkcmVxdWVzdCA9IE9B
dXRoUmVxdWVzdDo6ZnJvbV9jb25zdW1lcl9hbmRfdG9rZW4oJHRoaXMtPmNvbnN1bWVyLCAk
dGhpcy0+dG9rZW4sICRtZXRob2QsICR1cmwsICRwYXJhbWV0ZXJzKTsKICAgICRyZXF1ZXN0
LT5zaWduX3JlcXVlc3QoJHRoaXMtPnNoYTFfbWV0aG9kLCAkdGhpcy0+Y29uc3VtZXIsICR0
aGlzLT50b2tlbik7CiAgICBzd2l0Y2ggKCRtZXRob2QpIHsKICAgIGNhc2UgJ0dFVCc6CiAg
ICAgIHJldHVybiAkdGhpcy0+aHR0cCgkcmVxdWVzdC0+dG9fdXJsKCksICdHRVQnKTsKICAg
IGRlZmF1bHQ6CiAgICAgIHJldHVybiAkdGhpcy0+aHR0cCgkcmVxdWVzdC0+Z2V0X25vcm1h
bGl6ZWRfaHR0cF91cmwoKSwgJG1ldGhvZCwgJHJlcXVlc3QtPnRvX3Bvc3RkYXRhKCkpOwog
ICAgfQogIH0KCiAgLyoqCiAgICogTWFrZSBhbiBIVFRQIHJlcXVlc3QKICAgKgogICAqIEBy
ZXR1cm4gQVBJIHJlc3VsdHMKICAgKi8KICBmdW5jdGlvbiBodHRwKCR1cmwsICRtZXRob2Qs
ICRwb3N0ZmllbGRzID0gTlVMTCkgewogICAgJHRoaXMtPmh0dHBfaW5mbyA9IGFycmF5KCk7
CiAgICAkY2kgPSBjdXJsX2luaXQoKTsKICAgIC8qIEN1cmwgc2V0dGluZ3MgKi8KICAgIGN1
cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9VU0VSQUdFTlQsICR0aGlzLT51c2VyYWdlbnQpOwog
ICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0NPTk5FQ1RUSU1FT1VULCAkdGhpcy0+Y29u
bmVjdHRpbWVvdXQpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1RJTUVPVVQsICR0
aGlzLT50aW1lb3V0KTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9SRVRVUk5UUkFO
U0ZFUiwgVFJVRSk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfSFRUUEhFQURFUiwg
YXJyYXkoJ0V4cGVjdDonKSk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfU1NMX1ZF
UklGWVBFRVIsICR0aGlzLT5zc2xfdmVyaWZ5cGVlcik7CiAgICBjdXJsX3NldG9wdCgkY2ks
IENVUkxPUFRfSEVBREVSRlVOQ1RJT04sIGFycmF5KCR0aGlzLCAnZ2V0SGVhZGVyJykpOwog
ICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0hFQURFUiwgRkFMU0UpOwoKICAgIHN3aXRj
aCAoJG1ldGhvZCkgewogICAgICBjYXNlICdQT1NUJzoKICAgICAgICBjdXJsX3NldG9wdCgk
Y2ksIENVUkxPUFRfUE9TVCwgVFJVRSk7CiAgICAgICAgaWYgKCFlbXB0eSgkcG9zdGZpZWxk
cykpIHsKICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9QT1NURklFTERTLCAk
cG9zdGZpZWxkcyk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdERUxF
VEUnOgogICAgICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9DVVNUT01SRVFVRVNULCAn
REVMRVRFJyk7CiAgICAgICAgaWYgKCFlbXB0eSgkcG9zdGZpZWxkcykpIHsKICAgICAgICAg
ICR1cmwgPSAieyR1cmx9P3skcG9zdGZpZWxkc30iOwogICAgICAgIH0KICAgIH0KCiAgICBj
dXJsX3NldG9wdCgkY2ksIENVUkxPUFRfVVJMLCAkdXJsKTsKICAgICRyZXNwb25zZSA9IGN1
cmxfZXhlYygkY2kpOwogICAgJHRoaXMtPmh0dHBfY29kZSA9IGN1cmxfZ2V0aW5mbygkY2ks
IENVUkxJTkZPX0hUVFBfQ09ERSk7CiAgICAkdGhpcy0+aHR0cF9pbmZvID0gYXJyYXlfbWVy
Z2UoJHRoaXMtPmh0dHBfaW5mbywgY3VybF9nZXRpbmZvKCRjaSkpOwogICAgJHRoaXMtPnVy
bCA9ICR1cmw7CiAgICBjdXJsX2Nsb3NlICgkY2kpOwogICAgcmV0dXJuICRyZXNwb25zZTsK
ICB9CgogIC8qKgogICAqIEdldCB0aGUgaGVhZGVyIGluZm8gdG8gc3RvcmUuCiAgICovCiAg
ZnVuY3Rpb24gZ2V0SGVhZGVyKCRjaCwgJGhlYWRlcikgewogICAgJGkgPSBzdHJwb3MoJGhl
YWRlciwgJzonKTsKICAgIGlmICghZW1wdHkoJGkpKSB7CiAgICAgICRrZXkgPSBzdHJfcmVw
bGFjZSgnLScsICdfJywgc3RydG9sb3dlcihzdWJzdHIoJGhlYWRlciwgMCwgJGkpKSk7CiAg
ICAgICR2YWx1ZSA9IHRyaW0oc3Vic3RyKCRoZWFkZXIsICRpICsgMikpOwogICAgICAkdGhp
cy0+aHR0cF9oZWFkZXJbJGtleV0gPSAkdmFsdWU7CiAgICB9CiAgICByZXR1cm4gc3RybGVu
KCRoZWFkZXIpOwogIH0KfQoKY2xhc3MgT0F1dGhFeGNlcHRpb24gZXh0ZW5kcyBFeGNlcHRp
b24gewogIC8vIHBhc3MKfQoKY2xhc3MgT0F1dGhDb25zdW1lciB7CiAgcHVibGljICRrZXk7
CiAgcHVibGljICRzZWNyZXQ7CgogIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRrZXksICRzZWNy
ZXQsICRjYWxsYmFja191cmw9TlVMTCkgewogICAgJHRoaXMtPmtleSA9ICRrZXk7CiAgICAk
dGhpcy0+c2VjcmV0ID0gJHNlY3JldDsKICAgICR0aGlzLT5jYWxsYmFja191cmwgPSAkY2Fs
bGJhY2tfdXJsOwogIH0KCiAgZnVuY3Rpb24gX190b1N0cmluZygpIHsKICAgIHJldHVybiAi
T0F1dGhDb25zdW1lcltrZXk9JHRoaXMtPmtleSxzZWNyZXQ9JHRoaXMtPnNlY3JldF0iOwog
IH0KfQoKY2xhc3MgT0F1dGhUb2tlbiB7CiAgLy8gYWNjZXNzIHRva2VucyBhbmQgcmVxdWVz
dCB0b2tlbnMKICBwdWJsaWMgJGtleTsKICBwdWJsaWMgJHNlY3JldDsKCiAgLyoqCiAgICog
a2V5ID0gdGhlIHRva2VuCiAgICogc2VjcmV0ID0gdGhlIHRva2VuIHNlY3JldAogICAqLwog
IGZ1bmN0aW9uIF9fY29uc3RydWN0KCRrZXksICRzZWNyZXQpIHsKICAgICR0aGlzLT5rZXkg
PSAka2V5OwogICAgJHRoaXMtPnNlY3JldCA9ICRzZWNyZXQ7CiAgfQoKICAvKioKICAgKiBn
ZW5lcmF0ZXMgdGhlIGJhc2ljIHN0cmluZyBzZXJpYWxpemF0aW9uIG9mIGEgdG9rZW4gdGhh
dCBhIHNlcnZlcgogICAqIHdvdWxkIHJlc3BvbmQgdG8gcmVxdWVzdF90b2tlbiBhbmQgYWNj
ZXNzX3Rva2VuIGNhbGxzIHdpdGgKICAgKi8KICBmdW5jdGlvbiB0b19zdHJpbmcoKSB7CiAg
ICByZXR1cm4gIm9hdXRoX3Rva2VuPSIgLgogICAgICAgICAgIE9BdXRoVXRpbDo6dXJsZW5j
b2RlX3JmYzM5ODYoJHRoaXMtPmtleSkgLgogICAgICAgICAgICImb2F1dGhfdG9rZW5fc2Vj
cmV0PSIgLgogICAgICAgICAgIE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJHRoaXMt
PnNlY3JldCk7CiAgfQoKICBmdW5jdGlvbiBfX3RvU3RyaW5nKCkgewogICAgcmV0dXJuICR0
aGlzLT50b19zdHJpbmcoKTsKICB9Cn0KCi8qKgogKiBBIGNsYXNzIGZvciBpbXBsZW1lbnRp
bmcgYSBTaWduYXR1cmUgTWV0aG9kCiAqIFNlZSBzZWN0aW9uIDkgKCJTaWduaW5nIFJlcXVl
c3RzIikgaW4gdGhlIHNwZWMKICovCmFic3RyYWN0IGNsYXNzIE9BdXRoU2lnbmF0dXJlTWV0
aG9kIHsKICAvKioKICAgKiBOZWVkcyB0byByZXR1cm4gdGhlIG5hbWUgb2YgdGhlIFNpZ25h
dHVyZSBNZXRob2QgKGllIEhNQUMtU0hBMSkKICAgKiBAcmV0dXJuIHN0cmluZwogICAqLwog
IGFic3RyYWN0IHB1YmxpYyBmdW5jdGlvbiBnZXRfbmFtZSgpOwoKICAvKioKICAgKiBCdWls
ZCB1cCB0aGUgc2lnbmF0dXJlCiAgICogTk9URTogVGhlIG91dHB1dCBvZiB0aGlzIGZ1bmN0
aW9uIE1VU1QgTk9UIGJlIHVybGVuY29kZWQuCiAgICogdGhlIGVuY29kaW5nIGlzIGhhbmRs
ZWQgaW4gT0F1dGhSZXF1ZXN0IHdoZW4gdGhlIGZpbmFsCiAgICogcmVxdWVzdCBpcyBzZXJp
YWxpemVkCiAgICogQHBhcmFtIE9BdXRoUmVxdWVzdCAkcmVxdWVzdAogICAqIEBwYXJhbSBP
QXV0aENvbnN1bWVyICRjb25zdW1lcgogICAqIEBwYXJhbSBPQXV0aFRva2VuICR0b2tlbgog
ICAqIEByZXR1cm4gc3RyaW5nCiAgICovCiAgYWJzdHJhY3QgcHVibGljIGZ1bmN0aW9uIGJ1
aWxkX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwoKICAvKioKICAg
KiBWZXJpZmllcyB0aGF0IGEgZ2l2ZW4gc2lnbmF0dXJlIGlzIGNvcnJlY3QKICAgKiBAcGFy
YW0gT0F1dGhSZXF1ZXN0ICRyZXF1ZXN0CiAgICogQHBhcmFtIE9BdXRoQ29uc3VtZXIgJGNv
bnN1bWVyCiAgICogQHBhcmFtIE9BdXRoVG9rZW4gJHRva2VuCiAgICogQHBhcmFtIHN0cmlu
ZyAkc2lnbmF0dXJlCiAgICogQHJldHVybiBib29sCiAgICovCiAgcHVibGljIGZ1bmN0aW9u
IGNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4sICRzaWduYXR1
cmUpIHsKICAgICRidWlsdCA9ICR0aGlzLT5idWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRj
b25zdW1lciwgJHRva2VuKTsKICAgIHJldHVybiAkYnVpbHQgPT0gJHNpZ25hdHVyZTsKICB9
Cn0KCi8qKgogKiBUaGUgSE1BQy1TSEExIHNpZ25hdHVyZSBtZXRob2QgdXNlcyB0aGUgSE1B
Qy1TSEExIHNpZ25hdHVyZSBhbGdvcml0aG0gYXMgZGVmaW5lZCBpbiBbUkZDMjEwNF0KICog
d2hlcmUgdGhlIFNpZ25hdHVyZSBCYXNlIFN0cmluZyBpcyB0aGUgdGV4dCBhbmQgdGhlIGtl
eSBpcyB0aGUgY29uY2F0ZW5hdGVkIHZhbHVlcyAoZWFjaCBmaXJzdAogKiBlbmNvZGVkIHBl
ciBQYXJhbWV0ZXIgRW5jb2RpbmcpIG9mIHRoZSBDb25zdW1lciBTZWNyZXQgYW5kIFRva2Vu
IFNlY3JldCwgc2VwYXJhdGVkIGJ5IGFuICcmJwogKiBjaGFyYWN0ZXIgKEFTQ0lJIGNvZGUg
MzgpIGV2ZW4gaWYgZW1wdHkuCiAqICAgLSBDaGFwdGVyIDkuMiAoIkhNQUMtU0hBMSIpCiAq
LwpjbGFzcyBPQXV0aFNpZ25hdHVyZU1ldGhvZF9ITUFDX1NIQTEgZXh0ZW5kcyBPQXV0aFNp
Z25hdHVyZU1ldGhvZCB7CiAgZnVuY3Rpb24gZ2V0X25hbWUoKSB7CiAgICByZXR1cm4gIkhN
QUMtU0hBMSI7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2lnbmF0dXJlKCRyZXF1
ZXN0LCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJGJhc2Vfc3RyaW5nID0gJHJlcXVlc3Qt
PmdldF9zaWduYXR1cmVfYmFzZV9zdHJpbmcoKTsKICAgICRyZXF1ZXN0LT5iYXNlX3N0cmlu
ZyA9ICRiYXNlX3N0cmluZzsKCiAgICAka2V5X3BhcnRzID0gYXJyYXkoCiAgICAgICRjb25z
dW1lci0+c2VjcmV0LAogICAgICAoJHRva2VuKSA/ICR0b2tlbi0+c2VjcmV0IDogIiIKICAg
ICk7CgogICAgJGtleV9wYXJ0cyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJGtl
eV9wYXJ0cyk7CiAgICAka2V5ID0gaW1wbG9kZSgnJicsICRrZXlfcGFydHMpOwoKICAgIHJl
dHVybiBiYXNlNjRfZW5jb2RlKGhhc2hfaG1hYygnc2hhMScsICRiYXNlX3N0cmluZywgJGtl
eSwgdHJ1ZSkpOwogIH0KfQoKLyoqCiAqIFRoZSBQTEFJTlRFWFQgbWV0aG9kIGRvZXMgbm90
IHByb3ZpZGUgYW55IHNlY3VyaXR5IHByb3RlY3Rpb24gYW5kIFNIT1VMRCBvbmx5IGJlIHVz
ZWQKICogb3ZlciBhIHNlY3VyZSBjaGFubmVsIHN1Y2ggYXMgSFRUUFMuIEl0IGRvZXMgbm90
IHVzZSB0aGUgU2lnbmF0dXJlIEJhc2UgU3RyaW5nLgogKiAgIC0gQ2hhcHRlciA5LjQgKCJQ
TEFJTlRFWFQiKQogKi8KY2xhc3MgT0F1dGhTaWduYXR1cmVNZXRob2RfUExBSU5URVhUIGV4
dGVuZHMgT0F1dGhTaWduYXR1cmVNZXRob2QgewogIHB1YmxpYyBmdW5jdGlvbiBnZXRfbmFt
ZSgpIHsKICAgIHJldHVybiAiUExBSU5URVhUIjsKICB9CgogIC8qKgogICAqIG9hdXRoX3Np
Z25hdHVyZSBpcyBzZXQgdG8gdGhlIGNvbmNhdGVuYXRlZCBlbmNvZGVkIHZhbHVlcyBvZiB0
aGUgQ29uc3VtZXIgU2VjcmV0IGFuZAogICAqIFRva2VuIFNlY3JldCwgc2VwYXJhdGVkIGJ5
IGEgJyYnIGNoYXJhY3RlciAoQVNDSUkgY29kZSAzOCksIGV2ZW4gaWYgZWl0aGVyIHNlY3Jl
dCBpcwogICAqIGVtcHR5LiBUaGUgcmVzdWx0IE1VU1QgYmUgZW5jb2RlZCBhZ2Fpbi4KICAg
KiAgIC0gQ2hhcHRlciA5LjQuMSAoIkdlbmVyYXRpbmcgU2lnbmF0dXJlcyIpCiAgICoKICAg
KiBQbGVhc2Ugbm90ZSB0aGF0IHRoZSBzZWNvbmQgZW5jb2RpbmcgTVVTVCBOT1QgaGFwcGVu
IGluIHRoZSBTaWduYXR1cmVNZXRob2QsIGFzCiAgICogT0F1dGhSZXF1ZXN0IGhhbmRsZXMg
dGhpcyEKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2lnbmF0dXJlKCRyZXF1ZXN0
LCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJGtleV9wYXJ0cyA9IGFycmF5KAogICAgICAk
Y29uc3VtZXItPnNlY3JldCwKICAgICAgKCR0b2tlbikgPyAkdG9rZW4tPnNlY3JldCA6ICIi
CiAgICApOwoKICAgICRrZXlfcGFydHMgPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2
KCRrZXlfcGFydHMpOwogICAgJGtleSA9IGltcGxvZGUoJyYnLCAka2V5X3BhcnRzKTsKICAg
ICRyZXF1ZXN0LT5iYXNlX3N0cmluZyA9ICRrZXk7CgogICAgcmV0dXJuICRrZXk7CiAgfQp9
CgovKioKICogVGhlIFJTQS1TSEExIHNpZ25hdHVyZSBtZXRob2QgdXNlcyB0aGUgUlNBU1NB
LVBLQ1MxLXYxXzUgc2lnbmF0dXJlIGFsZ29yaXRobSBhcyBkZWZpbmVkIGluCiAqIFtSRkMz
NDQ3XSBzZWN0aW9uIDguMiAobW9yZSBzaW1wbHkga25vd24gYXMgUEtDUyMxKSwgdXNpbmcg
U0hBLTEgYXMgdGhlIGhhc2ggZnVuY3Rpb24gZm9yCiAqIEVNU0EtUEtDUzEtdjFfNS4gSXQg
aXMgYXNzdW1lZCB0aGF0IHRoZSBDb25zdW1lciBoYXMgcHJvdmlkZWQgaXRzIFJTQSBwdWJs
aWMga2V5IGluIGEKICogdmVyaWZpZWQgd2F5IHRvIHRoZSBTZXJ2aWNlIFByb3ZpZGVyLCBp
biBhIG1hbm5lciB3aGljaCBpcyBiZXlvbmQgdGhlIHNjb3BlIG9mIHRoaXMKICogc3BlY2lm
aWNhdGlvbi4KICogICAtIENoYXB0ZXIgOS4zICgiUlNBLVNIQTEiKQogKi8KYWJzdHJhY3Qg
Y2xhc3MgT0F1dGhTaWduYXR1cmVNZXRob2RfUlNBX1NIQTEgZXh0ZW5kcyBPQXV0aFNpZ25h
dHVyZU1ldGhvZCB7CiAgcHVibGljIGZ1bmN0aW9uIGdldF9uYW1lKCkgewogICAgcmV0dXJu
ICJSU0EtU0hBMSI7CiAgfQoKICAvLyBVcCB0byB0aGUgU1AgdG8gaW1wbGVtZW50IHRoaXMg
bG9va3VwIG9mIGtleXMuIFBvc3NpYmxlIGlkZWFzIGFyZToKICAvLyAoMSkgZG8gYSBsb29r
dXAgaW4gYSB0YWJsZSBvZiB0cnVzdGVkIGNlcnRzIGtleWVkIG9mZiBvZiBjb25zdW1lcgog
IC8vICgyKSBmZXRjaCB2aWEgaHR0cCB1c2luZyBhIHVybCBwcm92aWRlZCBieSB0aGUgcmVx
dWVzdGVyCiAgLy8gKDMpIHNvbWUgc29ydCBvZiBzcGVjaWZpYyBkaXNjb3ZlcnkgY29kZSBi
YXNlZCBvbiByZXF1ZXN0CiAgLy8KICAvLyBFaXRoZXIgd2F5IHNob3VsZCByZXR1cm4gYSBz
dHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIGNlcnRpZmljYXRlCiAgcHJvdGVjdGVkIGFi
c3RyYWN0IGZ1bmN0aW9uIGZldGNoX3B1YmxpY19jZXJ0KCYkcmVxdWVzdCk7CgogIC8vIFVw
IHRvIHRoZSBTUCB0byBpbXBsZW1lbnQgdGhpcyBsb29rdXAgb2Yga2V5cy4gUG9zc2libGUg
aWRlYXMgYXJlOgogIC8vICgxKSBkbyBhIGxvb2t1cCBpbiBhIHRhYmxlIG9mIHRydXN0ZWQg
Y2VydHMga2V5ZWQgb2ZmIG9mIGNvbnN1bWVyCiAgLy8KICAvLyBFaXRoZXIgd2F5IHNob3Vs
ZCByZXR1cm4gYSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIGNlcnRpZmljYXRlCiAg
cHJvdGVjdGVkIGFic3RyYWN0IGZ1bmN0aW9uIGZldGNoX3ByaXZhdGVfY2VydCgmJHJlcXVl
c3QpOwoKICBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29u
c3VtZXIsICR0b2tlbikgewogICAgJGJhc2Vfc3RyaW5nID0gJHJlcXVlc3QtPmdldF9zaWdu
YXR1cmVfYmFzZV9zdHJpbmcoKTsKICAgICRyZXF1ZXN0LT5iYXNlX3N0cmluZyA9ICRiYXNl
X3N0cmluZzsKCiAgICAvLyBGZXRjaCB0aGUgcHJpdmF0ZSBrZXkgY2VydCBiYXNlZCBvbiB0
aGUgcmVxdWVzdAogICAgJGNlcnQgPSAkdGhpcy0+ZmV0Y2hfcHJpdmF0ZV9jZXJ0KCRyZXF1
ZXN0KTsKCiAgICAvLyBQdWxsIHRoZSBwcml2YXRlIGtleSBJRCBmcm9tIHRoZSBjZXJ0aWZp
Y2F0ZQogICAgJHByaXZhdGVrZXlpZCA9IG9wZW5zc2xfZ2V0X3ByaXZhdGVrZXkoJGNlcnQp
OwoKICAgIC8vIFNpZ24gdXNpbmcgdGhlIGtleQogICAgJG9rID0gb3BlbnNzbF9zaWduKCRi
YXNlX3N0cmluZywgJHNpZ25hdHVyZSwgJHByaXZhdGVrZXlpZCk7CgogICAgLy8gUmVsZWFz
ZSB0aGUga2V5IHJlc291cmNlCiAgICBvcGVuc3NsX2ZyZWVfa2V5KCRwcml2YXRla2V5aWQp
OwoKICAgIHJldHVybiBiYXNlNjRfZW5jb2RlKCRzaWduYXR1cmUpOwogIH0KCiAgcHVibGlj
IGZ1bmN0aW9uIGNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4s
ICRzaWduYXR1cmUpIHsKICAgICRkZWNvZGVkX3NpZyA9IGJhc2U2NF9kZWNvZGUoJHNpZ25h
dHVyZSk7CgogICAgJGJhc2Vfc3RyaW5nID0gJHJlcXVlc3QtPmdldF9zaWduYXR1cmVfYmFz
ZV9zdHJpbmcoKTsKCiAgICAvLyBGZXRjaCB0aGUgcHVibGljIGtleSBjZXJ0IGJhc2VkIG9u
IHRoZSByZXF1ZXN0CiAgICAkY2VydCA9ICR0aGlzLT5mZXRjaF9wdWJsaWNfY2VydCgkcmVx
dWVzdCk7CgogICAgLy8gUHVsbCB0aGUgcHVibGljIGtleSBJRCBmcm9tIHRoZSBjZXJ0aWZp
Y2F0ZQogICAgJHB1YmxpY2tleWlkID0gb3BlbnNzbF9nZXRfcHVibGlja2V5KCRjZXJ0KTsK
CiAgICAvLyBDaGVjayB0aGUgY29tcHV0ZWQgc2lnbmF0dXJlIGFnYWluc3QgdGhlIG9uZSBw
YXNzZWQgaW4gdGhlIHF1ZXJ5CiAgICAkb2sgPSBvcGVuc3NsX3ZlcmlmeSgkYmFzZV9zdHJp
bmcsICRkZWNvZGVkX3NpZywgJHB1YmxpY2tleWlkKTsKCiAgICAvLyBSZWxlYXNlIHRoZSBr
ZXkgcmVzb3VyY2UKICAgIG9wZW5zc2xfZnJlZV9rZXkoJHB1YmxpY2tleWlkKTsKCiAgICBy
ZXR1cm4gJG9rID09IDE7CiAgfQp9CgpjbGFzcyBPQXV0aFJlcXVlc3QgewogIHByaXZhdGUg
JHBhcmFtZXRlcnM7CiAgcHJpdmF0ZSAkaHR0cF9tZXRob2Q7CiAgcHJpdmF0ZSAkaHR0cF91
cmw7CiAgLy8gZm9yIGRlYnVnIHB1cnBvc2VzCiAgcHVibGljICRiYXNlX3N0cmluZzsKICBw
dWJsaWMgc3RhdGljICR2ZXJzaW9uID0gJzEuMCc7CiAgcHVibGljIHN0YXRpYyAkUE9TVF9J
TlBVVCA9ICdwaHA6Ly9pbnB1dCc7CgogIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRodHRwX21l
dGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVycz1OVUxMKSB7CiAgICBAJHBhcmFtZXRlcnMg
b3IgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgJHBhcmFtZXRlcnMgPSBhcnJheV9tZXJn
ZSggT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKHBhcnNlX3VybCgkaHR0cF91cmwsIFBI
UF9VUkxfUVVFUlkpKSwgJHBhcmFtZXRlcnMpOwogICAgJHRoaXMtPnBhcmFtZXRlcnMgPSAk
cGFyYW1ldGVyczsKICAgICR0aGlzLT5odHRwX21ldGhvZCA9ICRodHRwX21ldGhvZDsKICAg
ICR0aGlzLT5odHRwX3VybCA9ICRodHRwX3VybDsKICB9CgoKICAvKioKICAgKiBhdHRlbXB0
IHRvIGJ1aWxkIHVwIGEgcmVxdWVzdCBmcm9tIHdoYXQgd2FzIHBhc3NlZCB0byB0aGUgc2Vy
dmVyCiAgICovCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBmcm9tX3JlcXVlc3QoJGh0dHBf
bWV0aG9kPU5VTEwsICRodHRwX3VybD1OVUxMLCAkcGFyYW1ldGVycz1OVUxMKSB7CiAgICAk
c2NoZW1lID0gKCFpc3NldCgkX1NFUlZFUlsnSFRUUFMnXSkgfHwgJF9TRVJWRVJbJ0hUVFBT
J10gIT0gIm9uIikKICAgICAgICAgICAgICA/ICdodHRwJwogICAgICAgICAgICAgIDogJ2h0
dHBzJzsKICAgIEAkaHR0cF91cmwgb3IgJGh0dHBfdXJsID0gJHNjaGVtZSAuCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICc6Ly8nIC4gJF9TRVJWRVJbJ0hUVFBfSE9TVCddIC4K
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzonIC4KICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgJF9TRVJWRVJbJ1NFUlZFUl9QT1JUJ10gLgogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAkX1NFUlZFUlsnUkVRVUVTVF9VUkknXTsKICAgIEAkaHR0cF9tZXRo
b2Qgb3IgJGh0dHBfbWV0aG9kID0gJF9TRVJWRVJbJ1JFUVVFU1RfTUVUSE9EJ107CgogICAg
Ly8gV2Ugd2VyZW4ndCBoYW5kZWQgYW55IHBhcmFtZXRlcnMsIHNvIGxldCdzIGZpbmQgdGhl
IG9uZXMgcmVsZXZhbnQgdG8KICAgIC8vIHRoaXMgcmVxdWVzdC4KICAgIC8vIElmIHlvdSBy
dW4gWE1MLVJQQyBvciBzaW1pbGFyIHlvdSBzaG91bGQgdXNlIHRoaXMgdG8gcHJvdmlkZSB5
b3VyIG93bgogICAgLy8gcGFyc2VkIHBhcmFtZXRlci1saXN0CiAgICBpZiAoISRwYXJhbWV0
ZXJzKSB7CiAgICAgIC8vIEZpbmQgcmVxdWVzdCBoZWFkZXJzCiAgICAgICRyZXF1ZXN0X2hl
YWRlcnMgPSBPQXV0aFV0aWw6OmdldF9oZWFkZXJzKCk7CgogICAgICAvLyBQYXJzZSB0aGUg
cXVlcnktc3RyaW5nIHRvIGZpbmQgR0VUIHBhcmFtZXRlcnMKICAgICAgJHBhcmFtZXRlcnMg
PSBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMoJF9TRVJWRVJbJ1FVRVJZX1NUUklORydd
KTsKCiAgICAgIC8vIEl0J3MgYSBQT1NUIHJlcXVlc3Qgb2YgdGhlIHByb3BlciBjb250ZW50
LXR5cGUsIHNvIHBhcnNlIFBPU1QKICAgICAgLy8gcGFyYW1ldGVycyBhbmQgYWRkIHRob3Nl
IG92ZXJyaWRpbmcgYW55IGR1cGxpY2F0ZXMgZnJvbSBHRVQKICAgICAgaWYgKCRodHRwX21l
dGhvZCA9PSAiUE9TVCIKICAgICAgICAgICYmIEBzdHJzdHIoJHJlcXVlc3RfaGVhZGVyc1si
Q29udGVudC1UeXBlIl0sCiAgICAgICAgICAgICAgICAgICAgICJhcHBsaWNhdGlvbi94LXd3
dy1mb3JtLXVybGVuY29kZWQiKQogICAgICAgICAgKSB7CiAgICAgICAgJHBvc3RfZGF0YSA9
IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygKICAgICAgICAgIGZpbGVfZ2V0X2NvbnRl
bnRzKHNlbGY6OiRQT1NUX0lOUFVUKQogICAgICAgICk7CiAgICAgICAgJHBhcmFtZXRlcnMg
PSBhcnJheV9tZXJnZSgkcGFyYW1ldGVycywgJHBvc3RfZGF0YSk7CiAgICAgIH0KCiAgICAg
IC8vIFdlIGhhdmUgYSBBdXRob3JpemF0aW9uLWhlYWRlciB3aXRoIE9BdXRoIGRhdGEuIFBh
cnNlIHRoZSBoZWFkZXIKICAgICAgLy8gYW5kIGFkZCB0aG9zZSBvdmVycmlkaW5nIGFueSBk
dXBsaWNhdGVzIGZyb20gR0VUIG9yIFBPU1QKICAgICAgaWYgKEBzdWJzdHIoJHJlcXVlc3Rf
aGVhZGVyc1snQXV0aG9yaXphdGlvbiddLCAwLCA2KSA9PSAiT0F1dGggIikgewogICAgICAg
ICRoZWFkZXJfcGFyYW1ldGVycyA9IE9BdXRoVXRpbDo6c3BsaXRfaGVhZGVyKAogICAgICAg
ICAgJHJlcXVlc3RfaGVhZGVyc1snQXV0aG9yaXphdGlvbiddCiAgICAgICAgKTsKICAgICAg
ICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCRwYXJhbWV0ZXJzLCAkaGVhZGVyX3BhcmFt
ZXRlcnMpOwogICAgICB9CgogICAgfQoKICAgIHJldHVybiBuZXcgT0F1dGhSZXF1ZXN0KCRo
dHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVycyk7CiAgfQoKICAvKioKICAgKiBw
cmV0dHkgbXVjaCBhIGhlbHBlciBmdW5jdGlvbiB0byBzZXQgdXAgdGhlIHJlcXVlc3QKICAg
Ki8KICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGZyb21fY29uc3VtZXJfYW5kX3Rva2VuKCRj
b25zdW1lciwgJHRva2VuLCAkaHR0cF9tZXRob2QsICRodHRwX3VybCwgJHBhcmFtZXRlcnM9
TlVMTCkgewogICAgQCRwYXJhbWV0ZXJzIG9yICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAg
ICRkZWZhdWx0cyA9IGFycmF5KCJvYXV0aF92ZXJzaW9uIiA9PiBPQXV0aFJlcXVlc3Q6OiR2
ZXJzaW9uLAogICAgICAgICAgICAgICAgICAgICAgIm9hdXRoX25vbmNlIiA9PiBPQXV0aFJl
cXVlc3Q6OmdlbmVyYXRlX25vbmNlKCksCiAgICAgICAgICAgICAgICAgICAgICAib2F1dGhf
dGltZXN0YW1wIiA9PiBPQXV0aFJlcXVlc3Q6OmdlbmVyYXRlX3RpbWVzdGFtcCgpLAogICAg
ICAgICAgICAgICAgICAgICAgIm9hdXRoX2NvbnN1bWVyX2tleSIgPT4gJGNvbnN1bWVyLT5r
ZXkpOwogICAgaWYgKCR0b2tlbikKICAgICAgJGRlZmF1bHRzWydvYXV0aF90b2tlbiddID0g
JHRva2VuLT5rZXk7CgogICAgJHBhcmFtZXRlcnMgPSBhcnJheV9tZXJnZSgkZGVmYXVsdHMs
ICRwYXJhbWV0ZXJzKTsKCiAgICByZXR1cm4gbmV3IE9BdXRoUmVxdWVzdCgkaHR0cF9tZXRo
b2QsICRodHRwX3VybCwgJHBhcmFtZXRlcnMpOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIHNl
dF9wYXJhbWV0ZXIoJG5hbWUsICR2YWx1ZSwgJGFsbG93X2R1cGxpY2F0ZXMgPSB0cnVlKSB7
CiAgICBpZiAoJGFsbG93X2R1cGxpY2F0ZXMgJiYgaXNzZXQoJHRoaXMtPnBhcmFtZXRlcnNb
JG5hbWVdKSkgewogICAgICAvLyBXZSBoYXZlIGFscmVhZHkgYWRkZWQgcGFyYW1ldGVyKHMp
IHdpdGggdGhpcyBuYW1lLCBzbyBhZGQgdG8gdGhlIGxpc3QKICAgICAgaWYgKGlzX3NjYWxh
cigkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pKSB7CiAgICAgICAgLy8gVGhpcyBpcyB0aGUg
Zmlyc3QgZHVwbGljYXRlLCBzbyB0cmFuc2Zvcm0gc2NhbGFyIChzdHJpbmcpCiAgICAgICAg
Ly8gaW50byBhbiBhcnJheSBzbyB3ZSBjYW4gYWRkIHRoZSBkdXBsaWNhdGVzCiAgICAgICAg
JHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdID0gYXJyYXkoJHRoaXMtPnBhcmFtZXRlcnNbJG5h
bWVdKTsKICAgICAgfQoKICAgICAgJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdW10gPSAkdmFs
dWU7CiAgICB9IGVsc2UgewogICAgICAkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0gPSAkdmFs
dWU7CiAgICB9CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gZ2V0X3BhcmFtZXRlcigkbmFtZSkg
ewogICAgcmV0dXJuIGlzc2V0KCR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSkgPyAkdGhpcy0+
cGFyYW1ldGVyc1skbmFtZV0gOiBudWxsOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGdldF9w
YXJhbWV0ZXJzKCkgewogICAgcmV0dXJuICR0aGlzLT5wYXJhbWV0ZXJzOwogIH0KCiAgcHVi
bGljIGZ1bmN0aW9uIHVuc2V0X3BhcmFtZXRlcigkbmFtZSkgewogICAgdW5zZXQoJHRoaXMt
PnBhcmFtZXRlcnNbJG5hbWVdKTsKICB9CgogIC8qKgogICAqIFRoZSByZXF1ZXN0IHBhcmFt
ZXRlcnMsIHNvcnRlZCBhbmQgY29uY2F0ZW5hdGVkIGludG8gYSBub3JtYWxpemVkIHN0cmlu
Zy4KICAgKiBAcmV0dXJuIHN0cmluZwogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBnZXRfc2ln
bmFibGVfcGFyYW1ldGVycygpIHsKICAgIC8vIEdyYWIgYWxsIHBhcmFtZXRlcnMKICAgICRw
YXJhbXMgPSAkdGhpcy0+cGFyYW1ldGVyczsKCiAgICAvLyBSZW1vdmUgb2F1dGhfc2lnbmF0
dXJlIGlmIHByZXNlbnQKICAgIC8vIFJlZjogU3BlYzogOS4xLjEgKCJUaGUgb2F1dGhfc2ln
bmF0dXJlIHBhcmFtZXRlciBNVVNUIGJlIGV4Y2x1ZGVkLiIpCiAgICBpZiAoaXNzZXQoJHBh
cmFtc1snb2F1dGhfc2lnbmF0dXJlJ10pKSB7CiAgICAgIHVuc2V0KCRwYXJhbXNbJ29hdXRo
X3NpZ25hdHVyZSddKTsKICAgIH0KCiAgICByZXR1cm4gT0F1dGhVdGlsOjpidWlsZF9odHRw
X3F1ZXJ5KCRwYXJhbXMpOwogIH0KCiAgLyoqCiAgICogUmV0dXJucyB0aGUgYmFzZSBzdHJp
bmcgb2YgdGhpcyByZXF1ZXN0CiAgICoKICAgKiBUaGUgYmFzZSBzdHJpbmcgZGVmaW5lZCBh
cyB0aGUgbWV0aG9kLCB0aGUgdXJsCiAgICogYW5kIHRoZSBwYXJhbWV0ZXJzIChub3JtYWxp
emVkKSwgZWFjaCB1cmxlbmNvZGVkCiAgICogYW5kIHRoZSBjb25jYXRlZCB3aXRoICYuCiAg
ICovCiAgcHVibGljIGZ1bmN0aW9uIGdldF9zaWduYXR1cmVfYmFzZV9zdHJpbmcoKSB7CiAg
ICAkcGFydHMgPSBhcnJheSgKICAgICAgJHRoaXMtPmdldF9ub3JtYWxpemVkX2h0dHBfbWV0
aG9kKCksCiAgICAgICR0aGlzLT5nZXRfbm9ybWFsaXplZF9odHRwX3VybCgpLAogICAgICAk
dGhpcy0+Z2V0X3NpZ25hYmxlX3BhcmFtZXRlcnMoKQogICAgKTsKCiAgICAkcGFydHMgPSBP
QXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCRwYXJ0cyk7CgogICAgcmV0dXJuIGltcGxv
ZGUoJyYnLCAkcGFydHMpOwogIH0KCiAgLyoqCiAgICoganVzdCB1cHBlcmNhc2VzIHRoZSBo
dHRwIG1ldGhvZAogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBnZXRfbm9ybWFsaXplZF9odHRw
X21ldGhvZCgpIHsKICAgIHJldHVybiBzdHJ0b3VwcGVyKCR0aGlzLT5odHRwX21ldGhvZCk7
CiAgfQoKICAvKioKICAgKiBwYXJzZXMgdGhlIHVybCBhbmQgcmVidWlsZHMgaXQgdG8gYmUK
ICAgKiBzY2hlbWU6Ly9ob3N0L3BhdGgKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZ2V0X25v
cm1hbGl6ZWRfaHR0cF91cmwoKSB7CiAgICAkcGFydHMgPSBwYXJzZV91cmwoJHRoaXMtPmh0
dHBfdXJsKTsKCiAgICAkcG9ydCA9IEAkcGFydHNbJ3BvcnQnXTsKICAgICRzY2hlbWUgPSAk
cGFydHNbJ3NjaGVtZSddOwogICAgJGhvc3QgPSAkcGFydHNbJ2hvc3QnXTsKICAgICRwYXRo
ID0gQCRwYXJ0c1sncGF0aCddOwoKICAgICRwb3J0IG9yICRwb3J0ID0gKCRzY2hlbWUgPT0g
J2h0dHBzJykgPyAnNDQzJyA6ICc4MCc7CgogICAgaWYgKCgkc2NoZW1lID09ICdodHRwcycg
JiYgJHBvcnQgIT0gJzQ0MycpCiAgICAgICAgfHwgKCRzY2hlbWUgPT0gJ2h0dHAnICYmICRw
b3J0ICE9ICc4MCcpKSB7CiAgICAgICRob3N0ID0gIiRob3N0OiRwb3J0IjsKICAgIH0KICAg
IHJldHVybiAiJHNjaGVtZTovLyRob3N0JHBhdGgiOwogIH0KCiAgLyoqCiAgICogYnVpbGRz
IGEgdXJsIHVzYWJsZSBmb3IgYSBHRVQgcmVxdWVzdAogICAqLwogIHB1YmxpYyBmdW5jdGlv
biB0b191cmwoKSB7CiAgICAkcG9zdF9kYXRhID0gJHRoaXMtPnRvX3Bvc3RkYXRhKCk7CiAg
ICAkb3V0ID0gJHRoaXMtPmdldF9ub3JtYWxpemVkX2h0dHBfdXJsKCk7CiAgICBpZiAoJHBv
c3RfZGF0YSkgewogICAgICAkb3V0IC49ICc/Jy4kcG9zdF9kYXRhOwogICAgfQogICAgcmV0
dXJuICRvdXQ7CiAgfQoKICAvKioKICAgKiBidWlsZHMgdGhlIGRhdGEgb25lIHdvdWxkIHNl
bmQgaW4gYSBQT1NUIHJlcXVlc3QKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gdG9fcG9zdGRh
dGEoKSB7CiAgICByZXR1cm4gT0F1dGhVdGlsOjpidWlsZF9odHRwX3F1ZXJ5KCR0aGlzLT5w
YXJhbWV0ZXJzKTsKICB9CgogIC8qKgogICAqIGJ1aWxkcyB0aGUgQXV0aG9yaXphdGlvbjog
aGVhZGVyCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIHRvX2hlYWRlcigkcmVhbG09bnVsbCkg
ewogICAgJGZpcnN0ID0gdHJ1ZTsKICBpZigkcmVhbG0pIHsKICAgICAgJG91dCA9ICdBdXRo
b3JpemF0aW9uOiBPQXV0aCByZWFsbT0iJyAuIE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5
ODYoJHJlYWxtKSAuICciJzsKICAgICAgJGZpcnN0ID0gZmFsc2U7CiAgICB9IGVsc2UKICAg
ICAgJG91dCA9ICdBdXRob3JpemF0aW9uOiBPQXV0aCc7CgogICAgJHRvdGFsID0gYXJyYXko
KTsKICAgIGZvcmVhY2ggKCR0aGlzLT5wYXJhbWV0ZXJzIGFzICRrID0+ICR2KSB7CiAgICAg
IGlmIChzdWJzdHIoJGssIDAsIDUpICE9ICJvYXV0aCIpIGNvbnRpbnVlOwogICAgICBpZiAo
aXNfYXJyYXkoJHYpKSB7CiAgICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCdBcnJh
eXMgbm90IHN1cHBvcnRlZCBpbiBoZWFkZXJzJyk7CiAgICAgIH0KICAgICAgJG91dCAuPSAo
JGZpcnN0KSA/ICcgJyA6ICcsJzsKICAgICAgJG91dCAuPSBPQXV0aFV0aWw6OnVybGVuY29k
ZV9yZmMzOTg2KCRrKSAuCiAgICAgICAgICAgICAgJz0iJyAuCiAgICAgICAgICAgICAgT0F1
dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkdikgLgogICAgICAgICAgICAgICciJzsKICAg
ICAgJGZpcnN0ID0gZmFsc2U7CiAgICB9CiAgICByZXR1cm4gJG91dDsKICB9CgogIHB1Ymxp
YyBmdW5jdGlvbiBfX3RvU3RyaW5nKCkgewogICAgcmV0dXJuICR0aGlzLT50b191cmwoKTsK
ICB9CgoKICBwdWJsaWMgZnVuY3Rpb24gc2lnbl9yZXF1ZXN0KCRzaWduYXR1cmVfbWV0aG9k
LCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJHRoaXMtPnNldF9wYXJhbWV0ZXIoCiAgICAg
ICJvYXV0aF9zaWduYXR1cmVfbWV0aG9kIiwKICAgICAgJHNpZ25hdHVyZV9tZXRob2QtPmdl
dF9uYW1lKCksCiAgICAgIGZhbHNlCiAgICApOwogICAgJHNpZ25hdHVyZSA9ICR0aGlzLT5i
dWlsZF9zaWduYXR1cmUoJHNpZ25hdHVyZV9tZXRob2QsICRjb25zdW1lciwgJHRva2VuKTsK
ICAgICR0aGlzLT5zZXRfcGFyYW1ldGVyKCJvYXV0aF9zaWduYXR1cmUiLCAkc2lnbmF0dXJl
LCBmYWxzZSk7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2lnbmF0dXJlKCRzaWdu
YXR1cmVfbWV0aG9kLCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJHNpZ25hdHVyZSA9ICRz
aWduYXR1cmVfbWV0aG9kLT5idWlsZF9zaWduYXR1cmUoJHRoaXMsICRjb25zdW1lciwgJHRv
a2VuKTsKICAgIHJldHVybiAkc2lnbmF0dXJlOwogIH0KCiAgLyoqCiAgICogdXRpbCBmdW5j
dGlvbjogY3VycmVudCB0aW1lc3RhbXAKICAgKi8KICBwcml2YXRlIHN0YXRpYyBmdW5jdGlv
biBnZW5lcmF0ZV90aW1lc3RhbXAoKSB7CiAgICByZXR1cm4gdGltZSgpOwogIH0KCiAgLyoq
CiAgICogdXRpbCBmdW5jdGlvbjogY3VycmVudCBub25jZQogICAqLwogIHByaXZhdGUgc3Rh
dGljIGZ1bmN0aW9uIGdlbmVyYXRlX25vbmNlKCkgewogICAgJG10ID0gbWljcm90aW1lKCk7
CiAgICAkcmFuZCA9IG10X3JhbmQoKTsKCiAgICByZXR1cm4gbWQ1KCRtdCAuICRyYW5kKTsg
Ly8gbWQ1cyBsb29rIG5pY2VyIHRoYW4gbnVtYmVycwogIH0KfQoKY2xhc3MgT0F1dGhTZXJ2
ZXIgewogIHByb3RlY3RlZCAkdGltZXN0YW1wX3RocmVzaG9sZCA9IDMwMDsgLy8gaW4gc2Vj
b25kcywgZml2ZSBtaW51dGVzCiAgcHJvdGVjdGVkICR2ZXJzaW9uID0gJzEuMCc7ICAgICAg
ICAgICAgIC8vIGhpIGJsYWluZQogIHByb3RlY3RlZCAkc2lnbmF0dXJlX21ldGhvZHMgPSBh
cnJheSgpOwoKICBwcm90ZWN0ZWQgJGRhdGFfc3RvcmU7CgogIGZ1bmN0aW9uIF9fY29uc3Ry
dWN0KCRkYXRhX3N0b3JlKSB7CiAgICAkdGhpcy0+ZGF0YV9zdG9yZSA9ICRkYXRhX3N0b3Jl
OwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGFkZF9zaWduYXR1cmVfbWV0aG9kKCRzaWduYXR1
cmVfbWV0aG9kKSB7CiAgICAkdGhpcy0+c2lnbmF0dXJlX21ldGhvZHNbJHNpZ25hdHVyZV9t
ZXRob2QtPmdldF9uYW1lKCldID0KICAgICAgJHNpZ25hdHVyZV9tZXRob2Q7CiAgfQoKICAv
LyBoaWdoIGxldmVsIGZ1bmN0aW9ucwoKICAvKioKICAgKiBwcm9jZXNzIGEgcmVxdWVzdF90
b2tlbiByZXF1ZXN0CiAgICogcmV0dXJucyB0aGUgcmVxdWVzdCB0b2tlbiBvbiBzdWNjZXNz
CiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGZldGNoX3JlcXVlc3RfdG9rZW4oJiRyZXF1ZXN0
KSB7CiAgICAkdGhpcy0+Z2V0X3ZlcnNpb24oJHJlcXVlc3QpOwoKICAgICRjb25zdW1lciA9
ICR0aGlzLT5nZXRfY29uc3VtZXIoJHJlcXVlc3QpOwoKICAgIC8vIG5vIHRva2VuIHJlcXVp
cmVkIGZvciB0aGUgaW5pdGlhbCB0b2tlbiByZXF1ZXN0CiAgICAkdG9rZW4gPSBOVUxMOwoK
ICAgICR0aGlzLT5jaGVja19zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2Vu
KTsKCiAgICAvLyBSZXYgQSBjaGFuZ2UKICAgICRjYWxsYmFjayA9ICRyZXF1ZXN0LT5nZXRf
cGFyYW1ldGVyKCdvYXV0aF9jYWxsYmFjaycpOwogICAgJG5ld190b2tlbiA9ICR0aGlzLT5k
YXRhX3N0b3JlLT5uZXdfcmVxdWVzdF90b2tlbigkY29uc3VtZXIsICRjYWxsYmFjayk7Cgog
ICAgcmV0dXJuICRuZXdfdG9rZW47CiAgfQoKICAvKioKICAgKiBwcm9jZXNzIGFuIGFjY2Vz
c190b2tlbiByZXF1ZXN0CiAgICogcmV0dXJucyB0aGUgYWNjZXNzIHRva2VuIG9uIHN1Y2Nl
c3MKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZmV0Y2hfYWNjZXNzX3Rva2VuKCYkcmVxdWVz
dCkgewogICAgJHRoaXMtPmdldF92ZXJzaW9uKCRyZXF1ZXN0KTsKCiAgICAkY29uc3VtZXIg
PSAkdGhpcy0+Z2V0X2NvbnN1bWVyKCRyZXF1ZXN0KTsKCiAgICAvLyByZXF1aXJlcyBhdXRo
b3JpemVkIHJlcXVlc3QgdG9rZW4KICAgICR0b2tlbiA9ICR0aGlzLT5nZXRfdG9rZW4oJHJl
cXVlc3QsICRjb25zdW1lciwgInJlcXVlc3QiKTsKCiAgICAkdGhpcy0+Y2hlY2tfc2lnbmF0
dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7CgogICAgLy8gUmV2IEEgY2hhbmdl
CiAgICAkdmVyaWZpZXIgPSAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfdmVyaWZp
ZXInKTsKICAgICRuZXdfdG9rZW4gPSAkdGhpcy0+ZGF0YV9zdG9yZS0+bmV3X2FjY2Vzc190
b2tlbigkdG9rZW4sICRjb25zdW1lciwgJHZlcmlmaWVyKTsKCiAgICByZXR1cm4gJG5ld190
b2tlbjsKICB9CgogIC8qKgogICAqIHZlcmlmeSBhbiBhcGkgY2FsbCwgY2hlY2tzIGFsbCB0
aGUgcGFyYW1ldGVycwogICAqLwogIHB1YmxpYyBmdW5jdGlvbiB2ZXJpZnlfcmVxdWVzdCgm
JHJlcXVlc3QpIHsKICAgICR0aGlzLT5nZXRfdmVyc2lvbigkcmVxdWVzdCk7CiAgICAkY29u
c3VtZXIgPSAkdGhpcy0+Z2V0X2NvbnN1bWVyKCRyZXF1ZXN0KTsKICAgICR0b2tlbiA9ICR0
aGlzLT5nZXRfdG9rZW4oJHJlcXVlc3QsICRjb25zdW1lciwgImFjY2VzcyIpOwogICAgJHRo
aXMtPmNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAg
cmV0dXJuIGFycmF5KCRjb25zdW1lciwgJHRva2VuKTsKICB9CgogIC8vIEludGVybmFscyBm
cm9tIGhlcmUKICAvKioKICAgKiB2ZXJzaW9uIDEKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9u
IGdldF92ZXJzaW9uKCYkcmVxdWVzdCkgewogICAgJHZlcnNpb24gPSAkcmVxdWVzdC0+Z2V0
X3BhcmFtZXRlcigib2F1dGhfdmVyc2lvbiIpOwogICAgaWYgKCEkdmVyc2lvbikgewogICAg
ICAvLyBTZXJ2aWNlIFByb3ZpZGVycyBNVVNUIGFzc3VtZSB0aGUgcHJvdG9jb2wgdmVyc2lv
biB0byBiZSAxLjAgaWYgdGhpcyBwYXJhbWV0ZXIgaXMgbm90IHByZXNlbnQuCiAgICAgIC8v
IENoYXB0ZXIgNy4wICgiQWNjZXNzaW5nIFByb3RlY3RlZCBSZXNzb3VyY2VzIikKICAgICAg
JHZlcnNpb24gPSAnMS4wJzsKICAgIH0KICAgIGlmICgkdmVyc2lvbiAhPT0gJHRoaXMtPnZl
cnNpb24pIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJPQXV0aCB2ZXJzaW9u
ICckdmVyc2lvbicgbm90IHN1cHBvcnRlZCIpOwogICAgfQogICAgcmV0dXJuICR2ZXJzaW9u
OwogIH0KCiAgLyoqCiAgICogZmlndXJlIG91dCB0aGUgc2lnbmF0dXJlIHdpdGggc29tZSBk
ZWZhdWx0cwogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X3NpZ25hdHVyZV9tZXRob2Qo
JiRyZXF1ZXN0KSB7CiAgICAkc2lnbmF0dXJlX21ldGhvZCA9CiAgICAgICAgQCRyZXF1ZXN0
LT5nZXRfcGFyYW1ldGVyKCJvYXV0aF9zaWduYXR1cmVfbWV0aG9kIik7CgogICAgaWYgKCEk
c2lnbmF0dXJlX21ldGhvZCkgewogICAgICAvLyBBY2NvcmRpbmcgdG8gY2hhcHRlciA3ICgi
QWNjZXNzaW5nIFByb3RlY3RlZCBSZXNzb3VyY2VzIikgdGhlIHNpZ25hdHVyZS1tZXRob2QK
ICAgICAgLy8gcGFyYW1ldGVyIGlzIHJlcXVpcmVkLCBhbmQgd2UgY2FuJ3QganVzdCBmYWxs
YmFjayB0byBQTEFJTlRFWFQKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCdObyBz
aWduYXR1cmUgbWV0aG9kIHBhcmFtZXRlci4gVGhpcyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQn
KTsKICAgIH0KCiAgICBpZiAoIWluX2FycmF5KCRzaWduYXR1cmVfbWV0aG9kLAogICAgICAg
ICAgICAgICAgICBhcnJheV9rZXlzKCR0aGlzLT5zaWduYXR1cmVfbWV0aG9kcykpKSB7CiAg
ICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigKICAgICAgICAiU2lnbmF0dXJlIG1ldGhv
ZCAnJHNpZ25hdHVyZV9tZXRob2QnIG5vdCBzdXBwb3J0ZWQgIiAuCiAgICAgICAgInRyeSBv
bmUgb2YgdGhlIGZvbGxvd2luZzogIiAuCiAgICAgICAgaW1wbG9kZSgiLCAiLCBhcnJheV9r
ZXlzKCR0aGlzLT5zaWduYXR1cmVfbWV0aG9kcykpCiAgICAgICk7CiAgICB9CiAgICByZXR1
cm4gJHRoaXMtPnNpZ25hdHVyZV9tZXRob2RzWyRzaWduYXR1cmVfbWV0aG9kXTsKICB9Cgog
IC8qKgogICAqIHRyeSB0byBmaW5kIHRoZSBjb25zdW1lciBmb3IgdGhlIHByb3ZpZGVkIHJl
cXVlc3QncyBjb25zdW1lciBrZXkKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGdldF9jb25z
dW1lcigmJHJlcXVlc3QpIHsKICAgICRjb25zdW1lcl9rZXkgPSBAJHJlcXVlc3QtPmdldF9w
YXJhbWV0ZXIoIm9hdXRoX2NvbnN1bWVyX2tleSIpOwogICAgaWYgKCEkY29uc3VtZXJfa2V5
KSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiSW52YWxpZCBjb25zdW1lciBr
ZXkiKTsKICAgIH0KCiAgICAkY29uc3VtZXIgPSAkdGhpcy0+ZGF0YV9zdG9yZS0+bG9va3Vw
X2NvbnN1bWVyKCRjb25zdW1lcl9rZXkpOwogICAgaWYgKCEkY29uc3VtZXIpIHsKICAgICAg
dGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJbnZhbGlkIGNvbnN1bWVyIik7CiAgICB9Cgog
ICAgcmV0dXJuICRjb25zdW1lcjsKICB9CgogIC8qKgogICAqIHRyeSB0byBmaW5kIHRoZSB0
b2tlbiBmb3IgdGhlIHByb3ZpZGVkIHJlcXVlc3QncyB0b2tlbiBrZXkKICAgKi8KICBwcml2
YXRlIGZ1bmN0aW9uIGdldF90b2tlbigmJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuX3R5
cGU9ImFjY2VzcyIpIHsKICAgICR0b2tlbl9maWVsZCA9IEAkcmVxdWVzdC0+Z2V0X3BhcmFt
ZXRlcignb2F1dGhfdG9rZW4nKTsKICAgICR0b2tlbiA9ICR0aGlzLT5kYXRhX3N0b3JlLT5s
b29rdXBfdG9rZW4oCiAgICAgICRjb25zdW1lciwgJHRva2VuX3R5cGUsICR0b2tlbl9maWVs
ZAogICAgKTsKICAgIGlmICghJHRva2VuKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2Vw
dGlvbigiSW52YWxpZCAkdG9rZW5fdHlwZSB0b2tlbjogJHRva2VuX2ZpZWxkIik7CiAgICB9
CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAgLyoqCiAgICogYWxsLWluLW9uZSBmdW5jdGlv
biB0byBjaGVjayB0aGUgc2lnbmF0dXJlIG9uIGEgcmVxdWVzdAogICAqIHNob3VsZCBndWVz
cyB0aGUgc2lnbmF0dXJlIG1ldGhvZCBhcHByb3ByaWF0ZWx5CiAgICovCiAgcHJpdmF0ZSBm
dW5jdGlvbiBjaGVja19zaWduYXR1cmUoJiRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbikg
ewogICAgLy8gdGhpcyBzaG91bGQgcHJvYmFibHkgYmUgaW4gYSBkaWZmZXJlbnQgbWV0aG9k
CiAgICAkdGltZXN0YW1wID0gQCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF90aW1l
c3RhbXAnKTsKICAgICRub25jZSA9IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhf
bm9uY2UnKTsKCiAgICAkdGhpcy0+Y2hlY2tfdGltZXN0YW1wKCR0aW1lc3RhbXApOwogICAg
JHRoaXMtPmNoZWNrX25vbmNlKCRjb25zdW1lciwgJHRva2VuLCAkbm9uY2UsICR0aW1lc3Rh
bXApOwoKICAgICRzaWduYXR1cmVfbWV0aG9kID0gJHRoaXMtPmdldF9zaWduYXR1cmVfbWV0
aG9kKCRyZXF1ZXN0KTsKCiAgICAkc2lnbmF0dXJlID0gJHJlcXVlc3QtPmdldF9wYXJhbWV0
ZXIoJ29hdXRoX3NpZ25hdHVyZScpOwogICAgJHZhbGlkX3NpZyA9ICRzaWduYXR1cmVfbWV0
aG9kLT5jaGVja19zaWduYXR1cmUoCiAgICAgICRyZXF1ZXN0LAogICAgICAkY29uc3VtZXIs
CiAgICAgICR0b2tlbiwKICAgICAgJHNpZ25hdHVyZQogICAgKTsKCiAgICBpZiAoISR2YWxp
ZF9zaWcpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJbnZhbGlkIHNpZ25h
dHVyZSIpOwogICAgfQogIH0KCiAgLyoqCiAgICogY2hlY2sgdGhhdCB0aGUgdGltZXN0YW1w
IGlzIG5ldyBlbm91Z2gKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGNoZWNrX3RpbWVzdGFt
cCgkdGltZXN0YW1wKSB7CiAgICBpZiggISAkdGltZXN0YW1wICkKICAgICAgdGhyb3cgbmV3
IE9BdXRoRXhjZXB0aW9uKAogICAgICAgICdNaXNzaW5nIHRpbWVzdGFtcCBwYXJhbWV0ZXIu
IFRoZSBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQnCiAgICAgICk7CgogICAgLy8gdmVyaWZ5IHRo
YXQgdGltZXN0YW1wIGlzIHJlY2VudGlzaAogICAgJG5vdyA9IHRpbWUoKTsKICAgIGlmIChh
YnMoJG5vdyAtICR0aW1lc3RhbXApID4gJHRoaXMtPnRpbWVzdGFtcF90aHJlc2hvbGQpIHsK
ICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKAogICAgICAgICJFeHBpcmVkIHRpbWVz
dGFtcCwgeW91cnMgJHRpbWVzdGFtcCwgb3VycyAkbm93IgogICAgICApOwogICAgfQogIH0K
CiAgLyoqCiAgICogY2hlY2sgdGhhdCB0aGUgbm9uY2UgaXMgbm90IHJlcGVhdGVkCiAgICov
CiAgcHJpdmF0ZSBmdW5jdGlvbiBjaGVja19ub25jZSgkY29uc3VtZXIsICR0b2tlbiwgJG5v
bmNlLCAkdGltZXN0YW1wKSB7CiAgICBpZiggISAkbm9uY2UgKQogICAgICB0aHJvdyBuZXcg
T0F1dGhFeGNlcHRpb24oCiAgICAgICAgJ01pc3Npbmcgbm9uY2UgcGFyYW1ldGVyLiBUaGUg
cGFyYW1ldGVyIGlzIHJlcXVpcmVkJwogICAgICApOwoKICAgIC8vIHZlcmlmeSB0aGF0IHRo
ZSBub25jZSBpcyB1bmlxdWVpc2gKICAgICRmb3VuZCA9ICR0aGlzLT5kYXRhX3N0b3JlLT5s
b29rdXBfbm9uY2UoCiAgICAgICRjb25zdW1lciwKICAgICAgJHRva2VuLAogICAgICAkbm9u
Y2UsCiAgICAgICR0aW1lc3RhbXAKICAgICk7CiAgICBpZiAoJGZvdW5kKSB7CiAgICAgIHRo
cm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiTm9uY2UgYWxyZWFkeSB1c2VkOiAkbm9uY2UiKTsK
ICAgIH0KICB9Cgp9CgpjbGFzcyBPQXV0aERhdGFTdG9yZSB7CiAgZnVuY3Rpb24gbG9va3Vw
X2NvbnN1bWVyKCRjb25zdW1lcl9rZXkpIHsKICAgIC8vIGltcGxlbWVudCBtZQogIH0KCiAg
ZnVuY3Rpb24gbG9va3VwX3Rva2VuKCRjb25zdW1lciwgJHRva2VuX3R5cGUsICR0b2tlbikg
ewogICAgLy8gaW1wbGVtZW50IG1lCiAgfQoKICBmdW5jdGlvbiBsb29rdXBfbm9uY2UoJGNv
bnN1bWVyLCAkdG9rZW4sICRub25jZSwgJHRpbWVzdGFtcCkgewogICAgLy8gaW1wbGVtZW50
IG1lCiAgfQoKICBmdW5jdGlvbiBuZXdfcmVxdWVzdF90b2tlbigkY29uc3VtZXIsICRjYWxs
YmFjayA9IG51bGwpIHsKICAgIC8vIHJldHVybiBhIG5ldyB0b2tlbiBhdHRhY2hlZCB0byB0
aGlzIGNvbnN1bWVyCiAgfQoKICBmdW5jdGlvbiBuZXdfYWNjZXNzX3Rva2VuKCR0b2tlbiwg
JGNvbnN1bWVyLCAkdmVyaWZpZXIgPSBudWxsKSB7CiAgICAvLyByZXR1cm4gYSBuZXcgYWNj
ZXNzIHRva2VuIGF0dGFjaGVkIHRvIHRoaXMgY29uc3VtZXIKICAgIC8vIGZvciB0aGUgdXNl
ciBhc3NvY2lhdGVkIHdpdGggdGhpcyB0b2tlbiBpZiB0aGUgcmVxdWVzdCB0b2tlbgogICAg
Ly8gaXMgYXV0aG9yaXplZAogICAgLy8gc2hvdWxkIGFsc28gaW52YWxpZGF0ZSB0aGUgcmVx
dWVzdCB0b2tlbgogIH0KCn0KCmNsYXNzIE9BdXRoVXRpbCB7CiAgcHVibGljIHN0YXRpYyBm
dW5jdGlvbiB1cmxlbmNvZGVfcmZjMzk4NigkaW5wdXQpIHsKICBpZiAoaXNfYXJyYXkoJGlu
cHV0KSkgewogICAgcmV0dXJuIGFycmF5X21hcChhcnJheSgnT0F1dGhVdGlsJywgJ3VybGVu
Y29kZV9yZmMzOTg2JyksICRpbnB1dCk7CiAgfSBlbHNlIGlmIChpc19zY2FsYXIoJGlucHV0
KSkgewogICAgcmV0dXJuIHN0cl9yZXBsYWNlKAogICAgICAnKycsCiAgICAgICcgJywKICAg
ICAgc3RyX3JlcGxhY2UoJyU3RScsICd+JywgcmF3dXJsZW5jb2RlKCRpbnB1dCkpCiAgICAp
OwogIH0gZWxzZSB7CiAgICByZXR1cm4gJyc7CiAgfQp9CgoKICAvLyBUaGlzIGRlY29kZSBm
dW5jdGlvbiBpc24ndCB0YWtpbmcgaW50byBjb25zaWRlcmF0aW9uIHRoZSBhYm92ZQogIC8v
IG1vZGlmaWNhdGlvbnMgdG8gdGhlIGVuY29kaW5nIHByb2Nlc3MuIEhvd2V2ZXIsIHRoaXMg
bWV0aG9kIGRvZXNuJ3QKICAvLyBzZWVtIHRvIGJlIHVzZWQgYW55d2hlcmUgc28gbGVhdmlu
ZyBpdCBhcyBpcy4KICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHVybGRlY29kZV9yZmMzOTg2
KCRzdHJpbmcpIHsKICAgIHJldHVybiB1cmxkZWNvZGUoJHN0cmluZyk7CiAgfQoKICAvLyBV
dGlsaXR5IGZ1bmN0aW9uIGZvciB0dXJuaW5nIHRoZSBBdXRob3JpemF0aW9uOiBoZWFkZXIg
aW50bwogIC8vIHBhcmFtZXRlcnMsIGhhcyB0byBkbyBzb21lIHVuZXNjYXBpbmcKICAvLyBD
YW4gZmlsdGVyIG91dCBhbnkgbm9uLW9hdXRoIHBhcmFtZXRlcnMgaWYgbmVlZGVkIChkZWZh
dWx0IGJlaGF2aW91cikKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHNwbGl0X2hlYWRlcigk
aGVhZGVyLCAkb25seV9hbGxvd19vYXV0aF9wYXJhbWV0ZXJzID0gdHJ1ZSkgewogICAgJHBh
dHRlcm4gPSAnLygoWy1fYS16XSopPSgiKFteIl0qKSJ8KFteLF0qKSksPykvJzsKICAgICRv
ZmZzZXQgPSAwOwogICAgJHBhcmFtcyA9IGFycmF5KCk7CiAgICB3aGlsZSAocHJlZ19tYXRj
aCgkcGF0dGVybiwgJGhlYWRlciwgJG1hdGNoZXMsIFBSRUdfT0ZGU0VUX0NBUFRVUkUsICRv
ZmZzZXQpID4gMCkgewogICAgICAkbWF0Y2ggPSAkbWF0Y2hlc1swXTsKICAgICAgJGhlYWRl
cl9uYW1lID0gJG1hdGNoZXNbMl1bMF07CiAgICAgICRoZWFkZXJfY29udGVudCA9IChpc3Nl
dCgkbWF0Y2hlc1s1XSkpID8gJG1hdGNoZXNbNV1bMF0gOiAkbWF0Y2hlc1s0XVswXTsKICAg
ICAgaWYgKHByZWdfbWF0Y2goJy9eb2F1dGhfLycsICRoZWFkZXJfbmFtZSkgfHwgISRvbmx5
X2FsbG93X29hdXRoX3BhcmFtZXRlcnMpIHsKICAgICAgICAkcGFyYW1zWyRoZWFkZXJfbmFt
ZV0gPSBPQXV0aFV0aWw6OnVybGRlY29kZV9yZmMzOTg2KCRoZWFkZXJfY29udGVudCk7CiAg
ICAgIH0KICAgICAgJG9mZnNldCA9ICRtYXRjaFsxXSArIHN0cmxlbigkbWF0Y2hbMF0pOwog
ICAgfQoKICAgIGlmIChpc3NldCgkcGFyYW1zWydyZWFsbSddKSkgewogICAgICB1bnNldCgk
cGFyYW1zWydyZWFsbSddKTsKICAgIH0KCiAgICByZXR1cm4gJHBhcmFtczsKICB9CgogIC8v
IGhlbHBlciB0byB0cnkgdG8gc29ydCBvdXQgaGVhZGVycyBmb3IgcGVvcGxlIHdobyBhcmVu
J3QgcnVubmluZyBhcGFjaGUKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGdldF9oZWFkZXJz
KCkgewogICAgaWYgKGZ1bmN0aW9uX2V4aXN0cygnYXBhY2hlX3JlcXVlc3RfaGVhZGVycycp
KSB7CiAgICAgIC8vIHdlIG5lZWQgdGhpcyB0byBnZXQgdGhlIGFjdHVhbCBBdXRob3JpemF0
aW9uOiBoZWFkZXIKICAgICAgLy8gYmVjYXVzZSBhcGFjaGUgdGVuZHMgdG8gdGVsbCB1cyBp
dCBkb2Vzbid0IGV4aXN0CiAgICAgICRoZWFkZXJzID0gYXBhY2hlX3JlcXVlc3RfaGVhZGVy
cygpOwoKICAgICAgLy8gc2FuaXRpemUgdGhlIG91dHB1dCBvZiBhcGFjaGVfcmVxdWVzdF9o
ZWFkZXJzIGJlY2F1c2UKICAgICAgLy8gd2UgYWx3YXlzIHdhbnQgdGhlIGtleXMgdG8gYmUg
Q2FzZWQtTGlrZS1UaGlzIGFuZCBhcmgoKQogICAgICAvLyByZXR1cm5zIHRoZSBoZWFkZXJz
IGluIHRoZSBzYW1lIGNhc2UgYXMgdGhleSBhcmUgaW4gdGhlCiAgICAgIC8vIHJlcXVlc3QK
ICAgICAgJG91dCA9IGFycmF5KCk7CiAgICAgIGZvcmVhY2goICRoZWFkZXJzIEFTICRrZXkg
PT4gJHZhbHVlICkgewogICAgICAgICRrZXkgPSBzdHJfcmVwbGFjZSgKICAgICAgICAgICAg
IiAiLAogICAgICAgICAgICAiLSIsCiAgICAgICAgICAgIHVjd29yZHMoc3RydG9sb3dlcihz
dHJfcmVwbGFjZSgiLSIsICIgIiwgJGtleSkpKQogICAgICAgICAgKTsKICAgICAgICAkb3V0
WyRrZXldID0gJHZhbHVlOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICAvLyBvdGhlcndp
c2Ugd2UgZG9uJ3QgaGF2ZSBhcGFjaGUgYW5kIGFyZSBqdXN0IGdvaW5nIHRvIGhhdmUgdG8g
aG9wZQogICAgICAvLyB0aGF0ICRfU0VSVkVSIGFjdHVhbGx5IGNvbnRhaW5zIHdoYXQgd2Ug
bmVlZAogICAgICAkb3V0ID0gYXJyYXkoKTsKICAgICAgaWYoIGlzc2V0KCRfU0VSVkVSWydD
T05URU5UX1RZUEUnXSkgKQogICAgICAgICRvdXRbJ0NvbnRlbnQtVHlwZSddID0gJF9TRVJW
RVJbJ0NPTlRFTlRfVFlQRSddOwogICAgICBpZiggaXNzZXQoJF9FTlZbJ0NPTlRFTlRfVFlQ
RSddKSApCiAgICAgICAgJG91dFsnQ29udGVudC1UeXBlJ10gPSAkX0VOVlsnQ09OVEVOVF9U
WVBFJ107CgogICAgICBmb3JlYWNoICgkX1NFUlZFUiBhcyAka2V5ID0+ICR2YWx1ZSkgewog
ICAgICAgIGlmIChzdWJzdHIoJGtleSwgMCwgNSkgPT0gIkhUVFBfIikgewogICAgICAgICAg
Ly8gdGhpcyBpcyBjaGFvcywgYmFzaWNhbGx5IGl0IGlzIGp1c3QgdGhlcmUgdG8gY2FwaXRh
bGl6ZSB0aGUgZmlyc3QKICAgICAgICAgIC8vIGxldHRlciBvZiBldmVyeSB3b3JkIHRoYXQg
aXMgbm90IGFuIGluaXRpYWwgSFRUUCBhbmQgc3RyaXAgSFRUUAogICAgICAgICAgLy8gY29k
ZSBmcm9tIHByemVtZWsKICAgICAgICAgICRrZXkgPSBzdHJfcmVwbGFjZSgKICAgICAgICAg
ICAgIiAiLAogICAgICAgICAgICAiLSIsCiAgICAgICAgICAgIHVjd29yZHMoc3RydG9sb3dl
cihzdHJfcmVwbGFjZSgiXyIsICIgIiwgc3Vic3RyKCRrZXksIDUpKSkpCiAgICAgICAgICAp
OwogICAgICAgICAgJG91dFska2V5XSA9ICR2YWx1ZTsKICAgICAgICB9CiAgICAgIH0KICAg
IH0KICAgIHJldHVybiAkb3V0OwogIH0KCiAgLy8gVGhpcyBmdW5jdGlvbiB0YWtlcyBhIGlu
cHV0IGxpa2UgYT1iJmE9YyZkPWUgYW5kIHJldHVybnMgdGhlIHBhcnNlZAogIC8vIHBhcmFt
ZXRlcnMgbGlrZSB0aGlzCiAgLy8gYXJyYXkoJ2EnID0+IGFycmF5KCdiJywnYycpLCAnZCcg
PT4gJ2UnKQogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gcGFyc2VfcGFyYW1ldGVycyggJGlu
cHV0ICkgewogICAgaWYgKCFpc3NldCgkaW5wdXQpIHx8ICEkaW5wdXQpIHJldHVybiBhcnJh
eSgpOwoKICAgICRwYWlycyA9IGV4cGxvZGUoJyYnLCAkaW5wdXQpOwoKICAgICRwYXJzZWRf
cGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICBmb3JlYWNoICgkcGFpcnMgYXMgJHBhaXIpIHsK
ICAgICAgJHNwbGl0ID0gZXhwbG9kZSgnPScsICRwYWlyLCAyKTsKICAgICAgJHBhcmFtZXRl
ciA9IE9BdXRoVXRpbDo6dXJsZGVjb2RlX3JmYzM5ODYoJHNwbGl0WzBdKTsKICAgICAgJHZh
bHVlID0gaXNzZXQoJHNwbGl0WzFdKSA/IE9BdXRoVXRpbDo6dXJsZGVjb2RlX3JmYzM5ODYo
JHNwbGl0WzFdKSA6ICcnOwoKICAgICAgaWYgKGlzc2V0KCRwYXJzZWRfcGFyYW1ldGVyc1sk
cGFyYW1ldGVyXSkpIHsKICAgICAgICAvLyBXZSBoYXZlIGFscmVhZHkgcmVjaWV2ZWQgcGFy
YW1ldGVyKHMpIHdpdGggdGhpcyBuYW1lLCBzbyBhZGQgdG8gdGhlIGxpc3QKICAgICAgICAv
LyBvZiBwYXJhbWV0ZXJzIHdpdGggdGhpcyBuYW1lCgogICAgICAgIGlmIChpc19zY2FsYXIo
JHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdKSkgewogICAgICAgICAgLy8gVGhpcyBp
cyB0aGUgZmlyc3QgZHVwbGljYXRlLCBzbyB0cmFuc2Zvcm0gc2NhbGFyIChzdHJpbmcpIGlu
dG8gYW4gYXJyYXkKICAgICAgICAgIC8vIHNvIHdlIGNhbiBhZGQgdGhlIGR1cGxpY2F0ZXMK
ICAgICAgICAgICRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSA9IGFycmF5KCRwYXJz
ZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSk7CiAgICAgICAgfQoKICAgICAgICAkcGFyc2Vk
X3BhcmFtZXRlcnNbJHBhcmFtZXRlcl1bXSA9ICR2YWx1ZTsKICAgICAgfSBlbHNlIHsKICAg
ICAgICAkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl0gPSAkdmFsdWU7CiAgICAgIH0K
ICAgIH0KICAgIHJldHVybiAkcGFyc2VkX3BhcmFtZXRlcnM7CiAgfQoKICBwdWJsaWMgc3Rh
dGljIGZ1bmN0aW9uIGJ1aWxkX2h0dHBfcXVlcnkoJHBhcmFtcykgewogICAgaWYgKCEkcGFy
YW1zKSByZXR1cm4gJyc7CgogICAgLy8gVXJsZW5jb2RlIGJvdGgga2V5cyBhbmQgdmFsdWVz
CiAgICAka2V5cyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoYXJyYXlfa2V5cygk
cGFyYW1zKSk7CiAgICAkdmFsdWVzID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4Nihh
cnJheV92YWx1ZXMoJHBhcmFtcykpOwogICAgJHBhcmFtcyA9IGFycmF5X2NvbWJpbmUoJGtl
eXMsICR2YWx1ZXMpOwoKICAgIC8vIFBhcmFtZXRlcnMgYXJlIHNvcnRlZCBieSBuYW1lLCB1
c2luZyBsZXhpY29ncmFwaGljYWwgYnl0ZSB2YWx1ZSBvcmRlcmluZy4KICAgIC8vIFJlZjog
U3BlYzogOS4xLjEgKDEpCiAgICB1a3NvcnQoJHBhcmFtcywgJ3N0cmNtcCcpOwoKICAgICRw
YWlycyA9IGFycmF5KCk7CiAgICBmb3JlYWNoICgkcGFyYW1zIGFzICRwYXJhbWV0ZXIgPT4g
JHZhbHVlKSB7CiAgICAgIGlmIChpc19hcnJheSgkdmFsdWUpKSB7CiAgICAgICAgLy8gSWYg
dHdvIG9yIG1vcmUgcGFyYW1ldGVycyBzaGFyZSB0aGUgc2FtZSBuYW1lLCB0aGV5IGFyZSBz
b3J0ZWQgYnkgdGhlaXIgdmFsdWUKICAgICAgICAvLyBSZWY6IFNwZWM6IDkuMS4xICgxKQog
ICAgICAgIG5hdHNvcnQoJHZhbHVlKTsKICAgICAgICBmb3JlYWNoICgkdmFsdWUgYXMgJGR1
cGxpY2F0ZV92YWx1ZSkgewogICAgICAgICAgJHBhaXJzW10gPSAkcGFyYW1ldGVyIC4gJz0n
IC4gJGR1cGxpY2F0ZV92YWx1ZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAg
JHBhaXJzW10gPSAkcGFyYW1ldGVyIC4gJz0nIC4gJHZhbHVlOwogICAgICB9CiAgICB9CiAg
ICAvLyBGb3IgZWFjaCBwYXJhbWV0ZXIsIHRoZSBuYW1lIGlzIHNlcGFyYXRlZCBmcm9tIHRo
ZSBjb3JyZXNwb25kaW5nIHZhbHVlIGJ5IGFuICc9JyBjaGFyYWN0ZXIgKEFTQ0lJIGNvZGUg
NjEpCiAgICAvLyBFYWNoIG5hbWUtdmFsdWUgcGFpciBpcyBzZXBhcmF0ZWQgYnkgYW4gJyYn
IGNoYXJhY3RlciAoQVNDSUkgY29kZSAzOCkKICAgIHJldHVybiBpbXBsb2RlKCcmJywgJHBh
aXJzKTsKICB9Cn0iO3M6MzoibWQ1IjtzOjMyOiI4NzBiZmNmNGU4Mjc0MDI4YjRlMTEwN2Qz
MDAxYzhmMyI7fQ==
