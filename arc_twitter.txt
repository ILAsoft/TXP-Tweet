# arc_twitter v3.0.1
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjU6
IjMuMC4xIjtzOjY6ImF1dGhvciI7czoxMToiQW5keSBDYXJ0ZXIiO3M6MTA6ImF1dGhvcl91
cmkiO3M6MzE6Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbS8iO3M6MTE6ImRlc2Ny
aXB0aW9uIjtzOjYwOiI8YSBocmVmPSJodHRwOi8vd3d3LnR3aXR0ZXIuY29tIj5Ud2l0dGVy
PC9hPiBmb3IgVGV4dHBhdHRlcm4iO3M6NToib3JkZXIiO3M6MToiNSI7czo0OiJ0eXBlIjtz
OjE6IjEiO3M6NToiZmxhZ3MiO3M6MToiMyI7czo0OiJoZWxwIjtzOjE2OTkxOiIJPGgxIGNs
YXNzPSJ0aXRsZSI+PHNwYW4gY2xhc3M9ImNhcHMiPlRYUDwvc3Bhbj4gVHdlZXQgKGFyY190
d2l0dGVyIGZvciBUZXh0cGF0dGVybik8L2gxPgoKCTxvbD4KCQk8bGk+PGEgaHJlZj0iI2Fy
Y190d2l0dGVyX2F1dGhvciI+QXV0aG9yPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNf
dHdpdHRlcl9pbnN0YWxsYXRpb24iPkluc3RhbGxhdGlvbiAvIFVuaW5zdGFsbGF0aW9uPC9h
PjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl90YWciPlRoZSBhcmNfdHdpdHRl
ciB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3NlYXJjaF90YWci
PlRoZSBhcmNfdHdpdHRlcl9zZWFyY2ggdGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNh
cmNfdHdpdHRlcl90d2VldF9idXR0b25fdGFnIj5UaGUgYXJjX3R3aXR0ZXJfdHdlZXRfYnV0
dG9uIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfZm9sbG93X2J1
dHRvbl90YWciPlRoZSBhcmNfdHdpdHRlcl9mb2xsb3dfYnV0dG9uIHRhZzwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfdHdlZXRfdXJsIj5UaGUgYXJjX3R3aXR0ZXJf
dHdlZXRfdXJsIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfdGlu
eXVybCI+VGhlIGFyY190d2l0dGVyX3Rpbnl1cmwgdGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhy
ZWY9IiNhcmNfdHdpdHRlcl9jYWNoaW5nIj5DYWNoaW5nPC9hPjwvbGk+CgkJPGxpPjxhIGhy
ZWY9IiNhcmNfdHdpdHRlcl9wcmVmcyI+UHJlZmVyZW5jZXM8L2E+PC9saT4KCQk8bGk+PGEg
aHJlZj0iI2FyY190d2l0dGVyX2FydGljbGUiPlR3ZWV0aW5nIGFydGljbGVzPC9hPjwvbGk+
CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl9hZG1pbiI+VGhlIFR3aXR0ZXIgdGFiPC9h
PjwvbGk+Cgk8L29sPgoKCTxwPjxzcGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0
IHByb3ZpZGVzIGFjY2VzcyB0byB5b3VyIFR3aXR0ZXIgYWNjb3VudCB0aHJvdWdoIGJvdGgg
dGhlIGFkbWluIGludGVyZmFjZSBhbmQgdGhlIHB1YmxpYyBzaWRlIG9mIHlvdXIgc2l0ZS4g
VXBkYXRlIFR3aXR0ZXIgd2hlbiB5b3UgcG9zdCBhIG5ldyBhcnRpY2xlICh3aXRoIGFydGlj
bGUtYnktYXJ0aWNsZSBvcHQgb3V0IG9wdGlvbiksIHVwZGF0ZSBhbmQgdmlldyB5b3VyIFR3
aXR0ZXIgZmVlZCB0aHJvdWdoIHRoZSBhZG1pbiBUd2l0dGVyIHRhYiwgYW5kIGRpc3BsYXkg
VHdpdHRlciBmZWVkcyBvbiB5b3VyIHNpdGUuPC9wPgoKCTxwPlJlcXVpcmVtZW50czotPC9w
PgoKCTx1bD4KCQk8bGk+VGV4dHBhdHRlcm4gNC4yKzwvbGk+CgkJPGxpPjxzcGFuIGNsYXNz
PSJjYXBzIj5QSFA8L3NwYW4+IDUgYW5kIGNVUkw8L2xpPgoJPC91bD4KCgk8aDIgY2xhc3M9
InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9hdXRob3IiPkF1dGhvcjwvaDI+CgoJPHA+PGEg
aHJlZj0iaHR0cDovL3JlZGhvdGNoaWxsaXByb2plY3QuY29tIj5BbmR5IENhcnRlcjwvYT4u
IEZvciBvdGhlciBUZXh0cGF0dGVybiBwbHVnaW5zIGJ5IG1lIHZpc2l0IG15IDxhIGhyZWY9
Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbS90eHAiPlBsdWdpbnMgcGFnZTwvYT4u
PC9wPgoKCTxwPlRoYW5rcyB0byA8YSBocmVmPSJodHRwOi8vbWFuZnJlLm5ldC8iPk1pY2hh
ZWwgTWFuZnJlPC9hPiBmb3IgaW5zcGlyYXRpb24gZm9yIHRoZSBhcnRpY2xlIHR3ZWV0IHBh
cnQgb2YgdGhpcyBwbHVnaW4gYmFzZWQgb24gaGlzIDxzcGFuIGNsYXNzPSJ0YWciPm1lbV90
d2l0dGVyPC9zcGFuPiBwbHVnaW4uICBBZGRpdGlvbmFsIHRoYW5rcyB0byB0aGUgZ3JlYXQg
VGV4dHBhdHRlcm4gY29tbXVuaXR5IGZvciBoZWxwaW5nIHRvIHRlc3QgdGhpcyBwbHVnaW4g
YW5kIGZvciBzdWdnZXN0aW5nIG5ldyBmZWF0dXJlcy4gVGhlIE9BdXRoIHBhcnQgb2YgdGhl
IHBsdWdpbiBpcyB0aGFua3MgdG8gPGEgaHJlZj0iaHR0cDovL3R3aXR0ZXIuY29tL2FicmFo
YW0iPkFicmFoYW0gV2lsbGlhbXM8L2E+LjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlk
PSJhcmNfdHdpdHRlcl9pbnN0YWxsYXRpb24iPkluc3RhbGxhdGlvbiAvIFVuaW5zdGFsbGF0
aW9uPC9oMj4KCgk8cD5UbyBpbnN0YWxsIGdvIHRvIHRoZSAmIzgyMTY7cGx1Z2lucyYjODIx
NzsgdGFiIHVuZGVyICYjODIxNjthZG1pbiYjODIxNzsgYW5kIHBhc3RlIHRoZSBwbHVnaW4g
Y29kZSBpbnRvIHRoZSAmIzgyMTY7SW5zdGFsbCBwbHVnaW4mIzgyMTc7IGJveCwgJiM4MjE2
O3VwbG9hZCYjODIxNzsgYW5kIHRoZW4gJiM4MjE2O2luc3RhbGwmIzgyMTc7LiBGaW5hbGx5
IGFjdGl2YXRlIHRoZSBwbHVnaW4uPC9wPgoKCTxwPkJlZm9yZSB5b3Ugc3RhcnQgdXNpbmcg
PHNwYW4gY2xhc3M9InRhZyI+YXJjX3R3aXR0ZXI8L3NwYW4+IHlvdSB3aWxsIG5lZWQgdG8g
bWFrZSBzdXJlIHRoYXQgdGhlIGNhY2hlIGRpcmVjdG9yeSBpcyB3cml0YWJsZS4gU2VlIHRo
ZSAmIzgyMTY7Q2FjaGluZyYjODIxNzsgc3Vic2VjdGlvbiBiZWxvdyBmb3IgZnVydGhlciBp
bmZvcm1hdGlvbi48L3A+CgoJPHA+PHNwYW4gY2xhc3M9InRhZyI+YXJjX3R3aXR0ZXI8L3Nw
YW4+IHNob3VsZCBub3cgYmUgcmVhZHkgZm9yIHVzZSBvbiB0aGUgcHVibGljLXNpZGUgb2Yg
eW91ciBzaXRlLjwvcD4KCgk8cD5UbyB1bmxvY2sgdGhlIGFkbWluIGZlYXR1cmVzIG9mIHRo
aXMgcGx1Z2luIHlvdSB3aWxsIG5lZWQgdG8gYXNzb2NpYXRlIHlvdXIgc2l0ZSB3aXRoIGEg
VHdpdHRlciBhY2NvdW50IGJ5IGNvbm5lY3RpbmcgdG8gVHdpdHRlciBmcm9tIHRoZSBwbHVn
aW4mIzgyMTc7cyBvcHRpb25zIHNjcmVlbi4gQ2xpY2sgb24gdGhlIGxpbmsgdG8gY29ubmVj
dCB0byBUd2l0dGVyLCB5b3Ugd2lsbCBiZSBhc2tlZCB0byBsb2dpbiB0byBUd2l0dGVyLCBj
bGlja2luZyB0aGlzIGxpbmsgd2lsbCB0ZW1wb3JhcmlseSB0YWtlIHlvdSB0byB0aGUgVHdp
dHRlciBzaXRlIHdoZXJlIHlvdSB3aWxsIGJlIGFza2VkIHRvIGxvZ2luIGFuZCBhcHByb3Zl
IGFjY2VzcyBmb3IgPHNwYW4gY2xhc3M9ImNhcHMiPlRYUDwvc3Bhbj4gVHdlZXQgdG8gcmVh
ZCBhbmQgd3JpdGUgdG8geW91ciBUd2l0dGVyIGFjY291bnQuIElmIGFsbCBpcyBzdWNjZXNz
ZnVsIHlvdSB3aWxsIGJlIHJldHVybmVkIHRvIHRoZSBvcHRpb25zIHNjcmVlbiBhbmQgeW91
ciB1c2VyIG5hbWUgd2lsbCBhcHBlYXIuPC9wPgoKCTxwPkF0IGFueSB0aW1lIHlvdSBjYW4g
ZGlzYXNzb2NpYXRlIHlvdXIgVHdpdHRlciBhY2NvdW50IHdpdGggPHNwYW4gY2xhc3M9ImNh
cHMiPlRYUDwvc3Bhbj4gVHdlZXQgdmlhIHlvdXIgVHdpdHRlciBhY2NvdW50IHByZWZlcmVu
Y2VzIG9uIHRoZSA8YSBocmVmPSJodHRwOi8vd3d3LnR3aXR0ZXIuY29tIj5Ud2l0dGVyIHdl
YnNpdGU8L2E+LjwvcD4KCgk8cD5UbyB1bmluc3RhbGwgPHNwYW4gY2xhc3M9InRhZyI+YXJj
X3R3aXR0ZXI8L3NwYW4+IHNpbXBseSBkZWxldGUgdGhlIHBsdWdpbiBmcm9tIHRoZSAmIzgy
MTY7UGx1Z2lucyYjODIxNzsgdGFiLiAgVGhpcyB3aWxsIHJlbW92ZSB0aGUgcGx1Z2luIGNv
ZGUsIGRlbGV0ZSByZWxhdGVkIHByZWZlcmVuY2VzIGFuZCBkcm9wIHRoZSA8c3BhbiBjbGFz
cz0idGFnIj5hcmNfdHdpdHRlcjwvc3Bhbj4gdGFibGUgZnJvbSB5b3VyIFRleHRwYXR0ZXJu
IGRhdGFiYXNlLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl90
YWciPlRoZSBhcmNfdHdpdHRlciB0YWc8L2gyPgoKCTxoMz5TeW50YXg8L2gzPgoKCTxwPiZs
dDt0eHA6YXJjX3R3aXR0ZXIgdXNlcj0mcXVvdDtkcm1vbmtleW5pbmphJnF1b3Q7IC8mZ3Q7
PC9wPgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0
ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJ
PHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+dXNlcjwvdGQ+CgkJCTx0
ZD5Ud2l0dGVyIHVzZXIgbmFtZTwvdGQ+CgkJCTx0ZD4gPGVtPmFyY190d2l0dGVyIHVzZXJu
YW1lPC9lbT48L3RkPgoJCQk8dGQ+dXNlcj0mcXVvdDtkcm1vbmtleW5pbmphJnF1b3Q7PC90
ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxpbWl0PC90ZD4KCQkJPHRkPk1heGltdW0gbnVt
YmVyIG9mIHR3ZWV0cyB0byBkaXNwbGF5IChtYXguIDIwMCk8L3RkPgoJCQk8dGQ+MTA8L3Rk
PgoJCQk8dGQ+bGltaXQ9JnF1b3Q7MjUmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8
dGQ+ZGF0ZWZvcm1hdDwvdGQ+CgkJCTx0ZD5Gb3JtYXQgdGhhdCB1cGRhdGUgZGF0ZXMgd2ls
bCBhcHBlYXIgYXM8L3RkPgoJCQk8dGQ+IDxlbT5BcmNoaXZlIGRhdGUgZm9ybWF0PC9lbT48
L3RkPgoJCQk8dGQ+ZGF0ZWZvcm1hdD0mcXVvdDslYiAlT2UsICVJOiVNICVwJnF1b3Q7PC90
ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsPC90ZD4KCQkJPHRkPkxhYmVsIGZvciB0
aGUgdG9wIG9mIHRoZSBsaXN0PC90ZD4KCQkJPHRkPiA8ZW0+bm8gbGFiZWw8L2VtPjwvdGQ+
CgkJCTx0ZD5sYWJlbD0mcXVvdDtNeSBUd2l0dGVyIHRpbWVsaW5lJnF1b3Q7PC90ZD4KCQk8
L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsdGFnPC90ZD4KCQkJPHRkPkluZGVwZW5kZW50IHdy
YXB0YWcgZm9yIGxhYmVsPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0
ZD5sYWJlbHRhZz0mcXVvdDtoMyZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5i
cmVhazwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMi
PkhUTUw8L3NwYW4+PC9zcGFuPiB0YWcgKHdpdGhvdXQgYnJhY2tldHMpLCBvciBzdHJpbmcs
IHVzZWQgdG8gc2VwYXJhdGUgdGhlIHVwZGF0ZXM8L3RkPgoJCQk8dGQ+bGk8L3RkPgoJCQk8
dGQ+YnJlYWs9JnF1b3Q7YnImcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+d3Jh
cHRhZzwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMi
PkhUTUw8L3NwYW4+PC9zcGFuPiB0YWcgdG8gYmUgdXNlZCBhcyB0aGUgd3JhcHRhZywgd2l0
aG91dCBicmFja2V0czwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+
d3JhcHRhZz0mcXVvdDt1bCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFz
czwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNT
Uzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBmb3Igd3JhcHRhZzwvdGQ+CgkJCTx0
ZD5hcmNfdHdpdHRlcjwvdGQ+CgkJCTx0ZD5jbGFzcz0mcXVvdDt0d2l0dGVyJnF1b3Q7PC90
ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzX3Bvc3RlZDwvdGQ+CgkJCTx0ZD48c3Bh
biBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNs
YXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHNwYW4gdGFnIGFyb3VuZCBwb3N0ZWQgZGF0ZTwv
dGQ+CgkJCTx0ZD5hcmNfdHdpdHRlci1wb3N0ZWQ8L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoK
CTxoMz5FeGFtcGxlIHVzYWdlPC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyIHVzZXI9
JnF1b3Q7ZHJtb25rZXluaW5qYSZxdW90OyBsaW1pdD0mcXVvdDs1JnF1b3Q7IHdyYXB0YWc9
JnF1b3Q7dWwmcXVvdDsgYnJlYWs9JnF1b3Q7bGkmcXVvdDsgZGF0ZWZvcm1hdD0mcXVvdDsl
YiAlT2UsICVJOiVNICVwJnF1b3Q7IC8mZ3Q7PC9wPgoKCTxwPlByb2R1Y2VzIGEgYnVsbGV0
IHBvaW50IGxpc3Qgb2YgdGhlIGxhc3QgNSBUd2l0dGVyIHVwZGF0ZXMgZnJvbSBkcm1vbmtl
eW5pbmphJiM4MjE3O3MgVHdpdHRlciBmZWVkIHdpdGggYSBkZWZpbmVkIGRhdGUgZm9ybWF0
IHRvIG92ZXJyaWRlIHRoZSBkZWZhdWx0IGFyY2hpdmUgZGF0ZSBmb3JtYXQuPC9wPgoKCTxo
MiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX3NlYXJjaF90YWciPlRoZSBhcmNf
dHdpdHRlcl9zZWFyY2ggdGFnPC9oMj4KCgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhw
OmFyY190d2l0dGVyX3NlYXJjaCBoYXNodGFncz0mcXVvdDt0eHAmcXVvdDsgLyZndDs8L3A+
CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90
aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+
RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5zZWFyY2g8L3RkPgoJCQk8dGQ+
Q29tbWEgc2VwYXJhdGVkIGxpc3Qgb2Ygc2VhcmNoIHdvcmRzPC90ZD4KCQkJPHRkPiA8ZW0+
dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0ZD5zZWFyY2g9JnF1b3Q7dHhwLHRleHRwYXR0ZXJuJnF1
b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmhhc2h0YWdzPC90ZD4KCQkJPHRkPkNv
bW1hIHNlcGFyYXRlZCBsaXN0IG9mIGhhc2h0YWdzIHRvIHNlYXJjaCBmb3IgKG5vdCBpbmNs
dWRpbmcgdGhlIGhhc2gpPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0
ZD5oYXNodGFncz0mcXVvdDt0eHAsdGV4dHBhdHRlcm4mcXVvdDs8L3RkPgoJCTwvdHI+CgkJ
PHRyPgoJCQk8dGQ+cmVwbHk8L3RkPgoJCQk8dGQ+VXNlcm5hbWUgb2YgdHdlZXRzIGluIHJl
cGx5IHRvPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0ZD5yZXBseT0m
cXVvdDt0d2l0dGVyJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPm1lbnRpb248
L3RkPgoJCQk8dGQ+VXNlcm5hbWUgb2YgdXNlciBtZW50aW9uZWQgaW4gdHdlZXRzICg8aT5p
LmUuPC9pPiB0d2VldHMgY29udGFpbmluZyBAdXNlcm5hbWUpPC90ZD4KCQkJPHRkPiA8ZW0+
dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0ZD5tZW50aW9uPSZxdW90O3R3aXR0ZXImcXVvdDs8L3Rk
PgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGltaXQ8L3RkPgoJCQk8dGQ+TWF4aW11bSBudW1i
ZXIgb2YgdHdlZXRzIHRvIGRpc3BsYXkgKG1heC4gMjAwKTwvdGQ+CgkJCTx0ZD4xMDwvdGQ+
CgkJCTx0ZD5saW1pdD0mcXVvdDsyNSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5kYXRlZm9ybWF0PC90ZD4KCQkJPHRkPkZvcm1hdCB0aGF0IHVwZGF0ZSBkYXRlcyB3aWxs
IGFwcGVhciBhczwvdGQ+CgkJCTx0ZD4gPGVtPkFyY2hpdmUgZGF0ZSBmb3JtYXQ8L2VtPjwv
dGQ+CgkJCTx0ZD5kYXRlZm9ybWF0PSZxdW90OyViICVPZSwgJUk6JU0gJXAmcXVvdDs8L3Rk
PgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFiZWw8L3RkPgoJCQk8dGQ+TGFiZWwgZm9yIHRo
ZSB0b3Agb2YgdGhlIGxpc3Q8L3RkPgoJCQk8dGQ+IDxlbT5ubyBsYWJlbDwvZW0+PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsdGFnPC90ZD4KCQkJPHRkPkluZGVwZW5kZW50
IHdyYXB0YWcgZm9yIGxhYmVsPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJ
PC90cj4KCQk8dHI+CgkJCTx0ZD5icmVhazwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2Fw
cyI+PHNwYW4gY2xhc3M9ImNhcHMiPkhUTUw8L3NwYW4+PC9zcGFuPiB0YWcgKHdpdGhvdXQg
YnJhY2tldHMpLCBvciBzdHJpbmcsIHVzZWQgdG8gc2VwYXJhdGUgdGhlIHVwZGF0ZXM8L3Rk
PgoJCQk8dGQ+bGk8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+d3JhcHRhZzwvdGQ+CgkJ
CTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkhUTUw8L3NwYW4+
PC9zcGFuPiB0YWcgdG8gYmUgdXNlZCBhcyB0aGUgd3JhcHRhZywgd2l0aG91dCBicmFja2V0
czwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8
dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJj
YXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgZm9yIHdyYXB0YWc8L3Rk
PgoJCQk8dGQ+YXJjX3R3aXR0ZXJfc2VhcmNoPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRk
PmNsYXNzX3VzZXI8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNz
PSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byBz
cGFuIHRhZyBhcm91bmQgdXNlciBuYW1lPC90ZD4KCQkJPHRkPmFyY190d2l0dGVyLXVzZXI8
L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3NfcG9zdGVkPC90ZD4KCQkJPHRkPjxz
cGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4g
Y2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gc3BhbiB0YWcgYXJvdW5kIHBvc3RlZCBkYXRl
PC90ZD4KCQkJPHRkPmFyY190d2l0dGVyLXBvc3RlZDwvdGQ+CgkJPC90cj4KCTwvdGFibGU+
CgoJPGgzPkV4YW1wbGUgdXNhZ2U8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfc2Vh
cmNoIHNlYXJjaD0mcXVvdDtwbHVnaW4mcXVvdDsgaGFzaHRhZ3M9JnF1b3Q7dHhwLHRleHRw
YXR0ZXJuJnF1b3Q7IGxpbWl0PSZxdW90OzI1JnF1b3Q7IC8mZ3Q7PC9wPgoKCTxwPlByb2R1
Y2VzIGEgbGlzdCBvZiB0d2VldHMgY29udGFpbmluZyB0aGUgd29yZCAmIzgyMTY7cGx1Z2lu
JiM4MjE3OyBhbmQgdGhlIGhhc2h0YWdzICYjODIxNjsjdHhwJiM4MjE3OyBhbmQgJiM4MjE2
OyN0ZXh0cGF0dGVybiYjODIxNzsuIFRoZSB0YWcgd2lsbCByZXR1cm4gYSBtYXhpbXVtIG9m
IDI1IHR3ZWV0cy48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJf
cmV0d2VldF90YWciPlRoZSBhcmNfdHdpdHRlcl90d2VldF9idXR0b24gdGFnPC9oMj4KCgk8
cD5PdXRwdXRzIHRoZSBUd2l0dGVyIHR3ZWV0IGJ1dHRvbiAoZm9ybWVybHkgJmx0O3R4cDph
cmNfdHdpdHRlcl9yZXR3ZWV0IC8mZ3Q7KS48L3A+CgoJPGgzPlN5bnRheDwvaDM+CgoJPHA+
Jmx0O3R4cDphcmNfdHdpdHRlcl90d2VldF9idXR0b24gLyZndDs8L3A+CgoJPGgzPlVzYWdl
PC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJPHRoPkRl
c2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBsZTwvdGg+
CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD51c2VyPC90ZD4KCQkJPHRkPlR3aXR0ZXIgdXNlciBu
YW1lIHRvIHF1b3RlPC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0ZXIgdXNlcm5hbWU8L2Vt
PjwvdGQ+CgkJCTx0ZD51c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDs8L3RkPgoJCTwv
dHI+CgkJPHRyPgoJCQk8dGQ+dXJsPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48
c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPjwvc3Bhbj4gdG8gdHdlZXQ8L3RkPgoJCTwv
dHI+CgkJPHRyPgoJCQk8dGQ+dGV4dDwvdGQ+CgkJCTx0ZD5Ud2VldCB0ZXh0PC90ZD4KCQk8
L3RyPgoJCTx0cj4KCQkJPHRkPmZvbGxvdzE8L3RkPgoJCQk8dGQ+U3VnZ2VzdGVkIFR3aXR0
ZXIgYWNjb3VudCB0byBmb2xsb3csIGZvciBleGFtcGxlIHlvdXIgb3duPC90ZD4KCQkJPHRk
PkEgVHdpdHRlciB1c2VyIHRvIHJlY29tbWVuZDwvdGQ+CgkJCTx0ZD5mb2xsb3cxPSZxdW90
O1RleHRwYXR0ZXJuJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmZvbGxvdzI8
L3RkPgoJCQk8dGQ+QXMgZm9sbG93MTwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3Rk
PgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFuZzwvdGQ+CgkJCTx0ZD5MYW5ndWFnZTwvdGQ+
CgkJCTx0ZD5lbjwvdGQ+CgkJCTx0ZD5sYW5nPSZxdW90O2VzJnF1b3Q7PC90ZD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPmNvdW50PC90ZD4KCQkJPHRkPkNvdW50IGJveCBwb3NpdGlvbiwg
b3B0aW9uczogbm9uZSwgaG9yaXpvbnRhbCBvciB2ZXJ0aWNhbDwvdGQ+CgkJCTx0ZD5ob3Jp
em9udGFsPC90ZD4KCQkJPHRkPmNvdW50PSZxdW90O25vbmUmcXVvdDs8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+aW5jbHVkZV9qczwvdGQ+CgkJCTx0ZD5XaGV0aGVyIG9yIG5vdCB0
byBpbmNsdWRlIHRoZSB3aWRnZXQgSmF2YVNjcmlwdDwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQkJ
PHRkPmluY2x1ZGVfanM9JnF1b3Q7MCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5vcHRpbWlzZV9qczwvdGQ+CgkJCTx0ZD5PcHRpbWlzZSB0aGUgSmF2YVNjcmlwdCBieSB1
c2luZyBhIGxvY2FsIHNjcmlwdCByYXRoZXIgdGhhbiB0aGF0IGhvc3RlZCBvbiB0aGUgVHdp
dHRlciBzaXRlPC90ZD4KCQkJPHRkPjA8L3RkPgoJCQk8dGQ+b3B0aW1pc2VfanM9JnF1b3Q7
MSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0ZD48
c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+
IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHRoZSB0d2VldCBidXR0b248L3RkPgoJCQk8
dGQ+dHdpdHRlci1zaGFyZS1idXR0b248L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxoMiBj
bGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX2ZvbGxvd19idXR0b25fdGFnIj5UaGUg
YXJjX3R3aXR0ZXJfZm9sbG93X2J1dHRvbiB0YWc8L2gyPgoKCTxwPk91dHB1dHMgdGhlIFR3
aXR0ZXIgZm9sbG93IGJ1dHRvbiAoYW4gYWx0ZXJuYXRpdmUgdmVyc2lvbiBpcyBpbmNsdWRl
ZCBpbiBhcmNfdHdpdHRlcl9pbnRlbnRzKS48L3A+CgoJPGgzPlN5bnRheDwvaDM+CgoJPHA+
Jmx0O3R4cDphcmNfdHdpdHRlcl9mb2xsb3dfYnV0dG9uIC8mZ3Q7PC9wPgoKCTxoMz5Vc2Fn
ZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5E
ZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3Ro
PgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+dXNlcjwvdGQ+CgkJCTx0ZD5Ud2l0dGVyIHVzZXIg
bmFtZSB0byBmb2xsb3c8L3RkPgoJCQk8dGQ+IDxlbT5hcmNfdHdpdHRlciB1c2VybmFtZTwv
ZW0+PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZxdW90OzwvdGQ+CgkJ
PC90cj4KCQk8dHI+CgkJCTx0ZD5sYW5nPC90ZD4KCQkJPHRkPkxhbmd1YWdlPC90ZD4KCQkJ
PHRkPmVuPC90ZD4KCQkJPHRkPmxhbmc9JnF1b3Q7ZXMmcXVvdDs8L3RkPgoJCTwvdHI+CgkJ
PHRyPgoJCQk8dGQ+Y291bnQ8L3RkPgoJCQk8dGQ+V2hldGhlciBvciBub3QgdGhlIGZvbGxv
d2VyIGNvdW50IGlzIHNob3duPC90ZD4KCQkJPHRkPjE8L3RkPgoJCQk8dGQ+Y291bnQ9JnF1
b3Q7MCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5pbmNsdWRlX2pzPC90ZD4K
CQkJPHRkPldoZXRoZXIgb3Igbm90IHRvIGluY2x1ZGUgdGhlIHdpZGdldCBKYXZhU2NyaXB0
PC90ZD4KCQkJPHRkPjE8L3RkPgoJCQk8dGQ+aW5jbHVkZV9qcz0mcXVvdDswJnF1b3Q7PC90
ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPm9wdGltaXNlX2pzPC90ZD4KCQkJPHRkPk9wdGlt
aXNlIHRoZSBKYXZhU2NyaXB0IGJ5IHVzaW5nIGEgbG9jYWwgc2NyaXB0IHJhdGhlciB0aGFu
IHRoYXQgaG9zdGVkIG9uIHRoZSBUd2l0dGVyIHNpdGU8L3RkPgoJCQk8dGQ+MDwvdGQ+CgkJ
CTx0ZD5vcHRpbWlzZV9qcz0mcXVvdDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJ
PHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0i
Y2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gdGhl
IGZvbGxvdyBidXR0b248L3RkPgoJCQk8dGQ+dHdpdHRlci1mb2xsb3ctYnV0dG9uPC90ZD4K
CQk8L3RyPgoJPC90YWJsZT4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRl
cl90d2VldF91cmwiPmFyY190d2l0dGVyX3R3ZWV0X3VybDwvaDI+CgoJPHA+UmV0dXJucyB0
aGUgPHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4gb2YgdGhlIFR3aXR0ZXIgc3RhdHVz
IGZvciBhbiBhcnRpY2xlLjwvcD4KCgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFy
Y190d2l0dGVyX3R3ZWV0X3VybCAvJmd0OzwvcD4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVy
X3R3ZWV0X3VybCZndDtMaW5rIHRleHQmbHQ7L3R4cDphcmNfdHdpdHRlcl90d2VldF91cmwm
Z3Q7PC9wPgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJp
YnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4K
CQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aWQ8L3RkPgoJCQk8
dGQ+VGV4dHBhdHRlcm4gYXJ0aWNsZSBJRDwvdGQ+CgkJCTx0ZD4gPGVtPmN1cnJlbnQgYXJ0
aWNsZTwvZW0+PC90ZD4KCQkJPHRkPmlkPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJ
PHRyPgoJCQk8dGQ+dGl0bGU8L3RkPgoJCQk8dGQ+VGl0bGUgYXR0cmlidXRlIG9mIHRoZSBs
aW5rPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJ
CTx0ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9
ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHRo
ZSBsaW5rPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCTwvdGFi
bGU+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfdGlueXVybCI+YXJj
X3R3aXR0ZXJfdGlueXVybDwvaDI+CgoJPHA+UmV0dXJucyB0aGUgc2hvcnRlbmVkIDxzcGFu
IGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+IG9mIHRoZSBhcnRpY2xlIHVzZWQgZm9yIHRoZSBU
d2l0dGVyIHVwZGF0ZS48L3A+CgoJPGgzPlN5bnRheDwvaDM+CgoJPHA+Jmx0O3R4cDphcmNf
dHdpdHRlcl90aW55dXJsIC8mZ3Q7PC9wPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfdGlu
eXVybCZndDtMaW5rIHRleHQmbHQ7L3R4cDphcmNfdHdpdHRlcl90aW55dXJsJmd0OzwvcD4K
Cgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3Ro
PgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5F
eGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmlkPC90ZD4KCQkJPHRkPlRleHRw
YXR0ZXJuIGFydGljbGUgSUQ8L3RkPgoJCQk8dGQ+IDxlbT5jdXJyZW50IGFydGljbGU8L2Vt
PjwvdGQ+CgkJCTx0ZD5pZD0mcXVvdDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJ
PHRkPnRpdGxlPC90ZD4KCQkJPHRkPlRpdGxlIGF0dHJpYnV0ZSBvZiB0aGUgbGluazwvdGQ+
CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xh
c3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5D
U1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byB0aGUgbGluazwv
dGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxo
MiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX2NhY2hpbmciPkNhY2hpbmc8L2gy
PgoKCTxwPkluIG9yZGVyIHRvIHByZXZlbnQgZXhjZXNzaXZlIHJlcGVhdGl0aXZlIGNhbGxz
IHRvIHRoZSBUd2l0dGVyIHdlYnNpdGUgaXQgaXMgcmVjb21tZW5kZWQgdG8gY2FjaGUgcmVz
dWx0cy4gVHdpdHRlciBsaW1pdHMgdGhlIG51bWJlciBvZiBjYWxscyB0aHJvdWdoIHRoZSA8
c3BhbiBjbGFzcz0iY2FwcyI+QVBJPC9zcGFuPiwgYW5kIGNvbnRpbnVvdXMgY2FsbHMgd2ls
bCByZXN1bHQgaW4gVHdpdHRlciBjbG9zaW5nIHRvIGZ1cnRoZXIgcmVxdWVzdHMuIEJ5IGRl
ZmF1bHQsIGFyY190d2l0dGVyIGNhY2hlcyBmb3IgMzAgbWludXRlIGludGVydmFscy48L3A+
CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlw
dGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwv
dHI+CgkJPHRyPgoJCQk8dGQ+Y2FjaGluZzwvdGQ+CgkJCTx0ZD4mIzgyMTY7MSYjODIxNzsg
dG8gY2FjaGUgZmVlZCwgJiM4MjE2OzAmIzgyMTc7IHRvIHR1cm4gY2FjaGluZyBvZmYgKG5v
dCByZWNvbW1lbmRlZCk8L3RkPgoJCQk8dGQ+MTwvdGQ+CgkJCTx0ZD5jYWNoaW5nPSZxdW90
OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2FjaGVfZGlyPC90ZD4KCQkJ
PHRkPkFic29sdXRlIHBhdGggdG8gdGhlIGNhY2hlIGRpcmVjdG9yeSAobXVzdCBiZSB3cml0
YWJsZSk8L3RkPgoJCQk8dGQ+IDxlbT5hcmNfdHdpdHRlciBwcmVmZXJlbmNlczwvZW0+PC90
ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNhY2hlX3RpbWU8L3RkPgoJCQk8dGQ+VGltZSBp
biBtaW51dGVzIHRoYXQgdGhlIGNhY2hlIGZpbGVzIGFyZSBzdG9yZWQgYmVmb3JlIGJlaW5n
IHJlZnJlc2hlZDwvdGQ+CgkJCTx0ZD41PC90ZD4KCQkJPHRkPmNhY2hlX3RpbWU9JnF1b3Q7
MzAmcXVvdDs8L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxwPlRoZSBhZG1pbiBzaWRlIG9m
IHRoaXMgcGx1Z2luIGVuZm9yY2VzIGNhY2hpbmcsIGFwYXJ0IGZyb20gd2hlbiBpdCBpcyBw
b3N0aW5nIHRvIFR3aXR0ZXIgKDxpPmUuZy48L2k+IHdoZW4gcG9zdGluZyBvciBkZWxldGlu
ZyBhbiB1cGRhdGUpLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRl
cl9wcmVmcyI+UHJlZmVyZW5jZXM8L2gyPgoKCTxwPllvdSBjYW4gYWNjZXNzIHRoZSBwbHVn
aW5zIGNvcmUgcHJlZmVyZW5jZXMgZnJvbSBlaXRoZXIgdGhlIFByZWZlcmVuY2VzIG9yIFBs
dWdpbnMgdGFicyBpbiBhZG1pbi4gU2V0dXAgeW91ciBUd2l0dGVyIGFjY291bnQgKHlvdSB3
aWxsIGJlIGFza2VkIHRvIGNvbm5lY3QgdmlhIFR3aXR0ZXIgYW5kIHRoaXMgbmVlZHMgZG9p
bmcgYmVmb3JlIHlvdSBjYW4gdXNlIHRoZSBwbHVnaW4pIGFuZCBjaGFuZ2UgdGhlIGNhY2hl
IGRpcmVjdG9yeSB1c2luZyBhcmNfdHdpdHRlciYjODIxNztzIHByZWZlcmVuY2VzLiBXaXRo
b3V0IHByb3ZpZGluZyB5b3VyIGFjY291bnQgbG9naW4gZGV0YWlscyB0aGUgYWRtaW4gYXJl
YSBmZWF0dXJlcyBvZiB0aGlzIHBsdWdpbiB3aWxsIGJlIGluYWN0aXZlLjwvcD4KCgk8cD5Z
b3UgY2FuIHNlbGVjdCB0aGUgPHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4gc2hvcnRl
bmVyIG1ldGhvZCB5b3Ugd2FudCB0byB1c2UgdG8gbGluayBiYWNrIHRvIHlvdXIgYXJ0aWNs
ZSBvbiBUd2l0dGVyLiBQbGVhc2Ugbm90ZSB0aGF0IGlmIHlvdSBzZWxlY3Qgc21kX3Nob3J0
X3VybCB5b3Ugd2lsbCBuZWVkIHRvIGhhdmUgaW5zdGFsbGVkIGFuZCBhY3RpdmF0ZWQgdGhl
IDxhIGhyZWY9Imh0dHA6Ly90ZXh0cGF0dGVybi5vcmcvcGx1Z2lucy8xMDk5L3NtZF9zaG9y
dF91cmwiPjxzcGFuIGNsYXNzPSJ0YWciPnNtZF9zaG9ydF91cmw8L3NwYW4+IHBsdWdpbjwv
YT4gZGV2ZWxvcGVkIGJ5IFN0ZWYgRGF3c29uLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24i
IGlkPSJhcmNfdHdpdHRlcl9hcnRpY2xlIj5Ud2VldGluZyBhcnRpY2xlczwvaDI+CgoJPHA+
QnkgZGVmYXVsdCBhcmNfdHdpdHRlciB3aWxsIHBvc3QgYW4gdXBkYXRlIHRvIFR3aXR0ZXIg
aW5jbHVkaW5nIGEgc2hvcnRlbmVkIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+IHRv
IHlvdXIgYXJ0aWNsZS4gT25seSBsaXZlIGFuZCBhY3RpdmUgYXJ0aWNsZXMgd2lsbCBiZSBz
ZW50IHRvIFR3aXR0ZXIsIDxpPmkuZS48L2k+IGFydGljbGVzIHBvc3RlZCBpbiB0aGUgZnV0
dXJlIG9yIGFzIHN0aWNreSBhcnRpY2xlcyB3aWxsIG5vdCBiZSBzZW50LiBJZiB5b3VyIGFy
dGljbGUgaXMgc3VjY2Vzc2Z1bGx5IHN1Ym1pdHRlZCB0byBUd2l0dGVyIHRoZSB1cGRhdGUg
d2lsbCBhcHBlYXIgaW4gcGxhY2Ugb2YgdGhlIFR3aXR0ZXIgb3B0aW9uIG9uIHRoZSByaWdo
dC1oYW5kLXNpZGUgb2YgdGhlIGFydGljbGUgZWRpdCBzY3JlZW4uPC9wPgoKCTxwPlR3ZWV0
cyBhcmUgc2VudCBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDogPGVtPlR3ZWV0IHByZWZpeDwv
ZW0+IDxlbT5BcnRpY2xlIHRpdGxlPC9lbT4gPGVtPlNob3J0ZW5lZCA8c3BhbiBjbGFzcz0i
Y2FwcyI+VVJMPC9zcGFuPjwvZW0+IDxlbT5Ud2VldCBzdWZmaXg8L2VtPi4gWW91IGNhbiBj
aGFuZ2UgdGhlIHByZWZpeCBhbmQgc3VmZml4IG9uIGFuIGFydGljbGUtYnktYXJ0aWNsZSBi
YXNpcyBieSBjaGFuZ2luZyB0aGUgdHdlZXQgb3B0aW9ucyB1bmRlciAmIzgyMTY7VXBkYXRl
IFR3aXR0ZXImIzgyMTc7IG9uIHRoZSBhcnRpY2xlIGVkaXRvciBzY3JlZW4uIFRoZSBkZWZh
dWx0IDxlbT5Ud2VldCBwcmVmaXg8L2VtPiBjYW4gYmUgc2V0IHVuZGVyIHRoZSA8c3BhbiBj
bGFzcz0idGFnIj5hcmNfdHdpdHRlcjwvc3Bhbj4gcHJlZmVyZW5jZXMgc2NyZWVuICh0aGUg
ZGVmYXVsdCBvbiBpbnN0YWxsYXRpb24gaXMgJiM4MjIwO0p1c3QgcG9zdGVkOiYjODIyMTsp
LjwvcD4KCgk8cD5QbGVhc2Ugbm90ZSB0aGF0IG9uY2UgYW4gYXJ0aWNsZSBoYXMgYmVlbiB0
d2VldGVkIHRoZSB0d2VldCBjYW5ub3QgYmUgZWRpdGVkLjwvcD4KCgk8aDIgY2xhc3M9InNl
Y3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9hZG1pbiI+VGhlIFR3aXR0ZXIgdGFiPC9oMj4KCgk8
cD5VbmRlciB0aGUgRXh0ZW5zaW9ucyB0YWIgKHRoaXMgY2FuIGJlIGNoYW5nZWQgZnJvbSB0
aGUgcGx1Z2luJiM4MjE3O3MgcHJlZmVyZW5jZSBwYWdlKSBhIG5ldyBUd2l0dGVyIHRhYiBz
aG91bGQgYXBwZWFyIG9uY2UgeW91IGhhdmUgY29ubmVjdGVkIHlvdXIgc2l0ZSB0byB5b3Vy
IFR3aXR0ZXIgYWNjb3VudC4gRnJvbSBoZXJlIHlvdSB3aWxsIGJlIGFibGUgdG8gc3VibWl0
IG5ldyBUd2l0dGVyIHVwZGF0ZXMsIHZpZXcgYmFzaWMgYWNjb3VudCBzdGF0aXN0aWNzLCBh
bmQgY2hlY2sgb3V0IHlvdXIgcmVjZW50IHVwZGF0ZXMgKGluY2x1ZGluZyB0aGUgb3B0aW9u
IHRvIGRlbGV0ZSB5b3VyIHR3ZWV0cykuPC9wPiI7czo0OiJjb2RlIjtzOjc1Nzg2OiJnbG9i
YWwgJHByZWZzLCR0eHBjZmcsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCRhcmNfdHdpdHRl
cl9jb25zdW1lclNlY3JldDsKCiRhcmNfdHdpdHRlciA9IGFycmF5KCk7CgokYXJjX3R3aXR0
ZXJfY29uc3VtZXJLZXkgPSAnbktjWHNsd3paaEJkMGtmS01ldG5QQSc7CiRhcmNfdHdpdHRl
cl9jb25zdW1lclNlY3JldCA9ICdDNm5TUENMM2VlSEdUQmhLQ2d3ZDlvY2xjdUQwc3JCOFdW
a2ZYUVlDNTQnOwoKYWRkX3ByaXZzKCdwbHVnaW5fcHJlZnMuYXJjX3R3aXR0ZXInLCcxLDIn
KTsKcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY190d2l0dGVyX2luc3RhbGwnLCdwbHVnaW5fbGlm
ZWN5Y2xlLmFyY190d2l0dGVyJywgJ2luc3RhbGxlZCcpOwpyZWdpc3Rlcl9jYWxsYmFjaygn
YXJjX3R3aXR0ZXJfdW5pbnN0YWxsJywncGx1Z2luX2xpZmVjeWNsZS5hcmNfdHdpdHRlcics
ICdkZWxldGVkJyk7CnJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfdHdpdHRlcl9wcmVmcycsJ3Bs
dWdpbl9wcmVmcy5hcmNfdHdpdHRlcicpOwoKLyoKICogU2V0dXAgaW5pdGlhbCBwcmVmZXJl
bmNlcyBpZiBub3QgaW4gdGhlIHR4cF9wcmVmcyB0YWJsZS4KICovCmlmICghaXNzZXQoJHBy
ZWZzWydhcmNfdHdpdHRlcl91c2VyJ10pKQogICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3Vz
ZXInLCAnJywgJ2FyY190d2l0dGVyJywgMSwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3NldCgk
cHJlZnNbJ2FyY190d2l0dGVyX3ByZWZpeCddKSkKICBzZXRfcHJlZignYXJjX3R3aXR0ZXJf
cHJlZml4JywnSnVzdCBwb3N0ZWQ6JywgJ2FyY190d2l0dGVyJywgMiwgJ3RleHRfaW5wdXQn
KTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX3N1ZmZpeCddKSkKICBzZXRfcHJl
ZignYXJjX3R3aXR0ZXJfc3VmZml4JywnJywgJ2FyY190d2l0dGVyJywgMiwgJ3RleHRfaW5w
dXQnKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX2NhY2hlX2RpciddKSkKICBz
ZXRfcHJlZignYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJywkdHhwY2ZnWyd0eHBhdGgnXS4kcHJl
ZnNbJ3RlbXBkaXInXSwgJ2FyY190d2l0dGVyJywgMSwgJ3RleHRfaW5wdXQnKTsKaWYgKCFp
c3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnXSkpCiAgc2V0X3ByZWYo
J2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnLCAxLCAnYXJjX3R3aXR0ZXInLCAyLCAneWVz
bm9SYWRpbycpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCdd
KSkKICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCcsICd0aW55dXJsJywgJ2Fy
Y190d2l0dGVyJywgMiwKICAgICdhcmNfdHdpdHRlcl91cmxfbWV0aG9kX3NlbGVjdCcpOwpp
ZiAoIWlzc2V0KCRwcmVmc1snYXJjX3Nob3J0X3VybCddKSkKICBzZXRfcHJlZignYXJjX3No
b3J0X3VybCcsIDAsICdhcmNfdHdpdHRlcicsIDIsICd5ZXNub1JhZGlvJyk7CmlmICghaXNz
ZXQoJHByZWZzWydhcmNfc2hvcnRfc2l0ZV91cmwnXSkpCiAgc2V0X3ByZWYoJ2FyY19zaG9y
dF9zaXRlX3VybCcsICRwcmVmc1snc2l0ZXVybCddLCAnYXJjX3R3aXR0ZXInLCAyLCAndGV4
dF9pbnB1dCcpOwovLyBNYWtlIHN1cmUgdGhhdCB0aGUgVHdpdHRlciB0YWIgaGFzIGJlZW4g
ZGVmaW5lZAppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfdGFiJ10pKSB7CiAgc2V0
X3ByZWYoJ2FyY190d2l0dGVyX3RhYicsICdleHRlbnNpb25zJywgJ2FyY190d2l0dGVyJywg
MiwKICAgICdhcmNfdHdpdHRlcl90YWJfc2VsZWN0Jyk7CiAgICAkcHJlZnNbJ2FyY190d2l0
dGVyX3RhYiddID0gJ2V4dGVuc2lvbnMnOwp9CgovLyBDaGVjayBpZiBhcmNfc2hvcnRfdXJs
IGlzIGVuYWJsZWQKaWYgKChpc3NldCgkcHJlZnNbJ2FyY19zaG9ydF91cmwnXSkmJiRwcmVm
c1snYXJjX3Nob3J0X3VybCddKQp8fCAoaXNzZXQoJHByZWZzWydhcmNfc2hvcnRfdXJsX21l
dGhvZCddKSYmJHByZWZzWydhcmNfdHdpdHRlcl91cmxfbWV0aG9kJ109PSdhcmNfdHdpdHRl
cicpKSB7CiAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19zaG9ydF91cmxfcmVkaXJlY3QnLCAn
dHhwX2RpZScsIDQwNCk7Cn0KCmlmIChAdHhwaW50ZXJmYWNlID09ICdhZG1pbicpIHsKICAg
IGlmICghZW1wdHkoJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10pCiAgICAgICAgJiYgIWVt
cHR5KCRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXSkKICAgICAgICAmJiAhZW1w
dHkoJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKSApIHsKCiAgICAg
ICAgaWYgKCRwcmVmc1snYXJjX3R3aXR0ZXJfdGFiJ10pIHsKICAgICAgICAgICAgYWRkX3By
aXZzKCdhcmNfYWRtaW5fdHdpdHRlcicsICcxLDIsMyw0Jyk7CiAgICAgICAgICAgIHJlZ2lz
dGVyX3RhYigkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddLCAnYXJjX2FkbWluX3R3aXR0ZXIn
LCAnVHdpdHRlcicpOwogICAgICAgICAgICByZWdpc3Rlcl9jYWxsYmFjaygnYXJjX2FkbWlu
X3R3aXR0ZXInLCAnYXJjX2FkbWluX3R3aXR0ZXInKTsKICAgICAgICB9CgogICAgICAgIHJl
Z2lzdGVyX2NhbGxiYWNrKCdhcmNfYXJ0aWNsZV90d2VldCcsICdwaW5nJyk7CiAgICAgICAg
cmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hcnRpY2xlX3R3ZWV0JywgJ2FydGljbGUnLCAnZWRp
dCcsIDEpOwogICAgICAgIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYXBwZW5kX3R3aXR0ZXIn
LCAnYXJ0aWNsZV91aScsICdzdGF0dXMnKTsKICAgIH0KfQoKLyoKICAgIFB1YmxpYy1zaWRl
IGZ1bmN0aW9ucwogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PQoqLwoKZnVuY3Rpb24gYXJjX3R3aXR0ZXIoJGF0
dHMpCnsKICBnbG9iYWwgJHByZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190
d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgJ3Vz
ZXInICAgICAgPT4gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sCiAgICAncGFzc3dvcmQn
ICA9PiAnJywKICAgICd0aW1lbGluZScgID0+ICd1c2VyJywKICAgICdsaW1pdCcgICAgID0+
ICcxMCcsCiAgICAncmV0d2VldHMnICA9PiBmYWxzZSwKICAgICdkYXRlZm9ybWF0Jz0+ICRw
cmVmc1snYXJjaGl2ZV9kYXRlZm9ybWF0J10sCiAgICAnY2FjaGluZycgICA9PiAnMScsCiAg
ICAnY2FjaGVfZGlyJyA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX2NhY2hlX2RpciddLAogICAg
J2NhY2hlX3RpbWUnPT4gJzUnLAogICAgJ2xhYmVsJyAgICAgPT4gJycsCiAgICAnbGFiZWx0
YWcnICA9PiAnJywKICAgICdicmVhaycgICAgID0+ICdsaScsCiAgICAnd3JhcHRhZycgICA9
PiAnJywKICAgICdjbGFzcycgICAgID0+IF9fRlVOQ1RJT05fXywKICAgICdjbGFzc19wb3N0
ZWQnID0+IF9fRlVOQ1RJT05fXy4nLXBvc3RlZCcKICAgICksJGF0dHMpKTsKCiAgJHR3aXQg
PSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgICAg
ICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX2Fj
Y2Vzc1Rva2VuJ10KICAgICAgICAgICAgLCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rv
a2VuU2VjcmV0J10pOwoKICBpZiAoJGNhY2hpbmcpIHsgIC8vIHR1cm4gb24gY2FjaGluZywg
cmVjb21tZW5kZWQgKGRlZmF1bHQpCiAgICAkdHdpdC0+c2V0Q2FjaGluZyh0cnVlKTsKICAg
ICR0d2l0LT5jYWNoZURpcigkY2FjaGVfZGlyKTsKICAgICR0d2l0LT5jYWNoZVRpbWUoJGNh
Y2hlX3RpbWUpOwogIH0gZWxzZSB7ICAvLyB0dXJuIG9mZiBjYWNoaW5nLCBub3QgcmVjb21t
ZW5kZWQgb3RoZXIgdGhhbiBmb3IgdGVzdGluZwogICAgJHR3aXQtPnNldENhY2hpbmcoZmFs
c2UpOwogIH0KCiAgc3dpdGNoICgkdGltZWxpbmUpIHsKICAgIGNhc2UgJ2hvbWUnOiBjYXNl
ICdmcmllbmRzJzoKICAgICAgJHRpbWVsaW5lID0gJ3N0YXR1c2VzL2ZyaWVuZHNfdGltZWxp
bmUnOyBicmVhazsKICAgIGNhc2UgJ21lbnRpb25zJzoKICAgICAgJHRpbWVsaW5lID0gJ3N0
YXR1c2VzL21lbnRpb25zJzsgYnJlYWs7CiAgICBjYXNlICd1c2VyJzogZGVmYXVsdDogJHRp
bWVsaW5lID0gJ3N0YXR1c2VzL3VzZXJfdGltZWxpbmUnOwogIH0KCiAgJG91dCA9IGFycmF5
KCk7CiAgJHhtbCA9ICR0d2l0LT5nZXQoJHRpbWVsaW5lCiAgICAsIGFycmF5KCdzY3JlZW5f
bmFtZSc9PiR1c2VyLCdjb3VudCc9PiRsaW1pdCwnaW5jbHVkZV9ydHMnPT4kcmV0d2VldHMp
KTsKICBpZiAoJHhtbCkgewogICAgJHR3ZWV0cyA9IEAkeG1sLT54cGF0aCgnL3N0YXR1c2Vz
L3N0YXR1cycpOwogICAgaWYgKCR0d2VldHMpIGZvcmVhY2ggKCR0d2VldHMgYXMgJHR3ZWV0
KSB7CiAgICAgICR0aW1lID0gc3RydG90aW1lKGh0bWxlbnRpdGllcygkdHdlZXQtPmNyZWF0
ZWRfYXQpKTsKICAgICAgJGRhdGUgPSBzYWZlX3N0cmZ0aW1lKCRkYXRlZm9ybWF0LCR0aW1l
KTsKICAgICAgJG91dFtdID0gYXJjX1R3aXR0ZXI6Om1ha2VMaW5rcyhodG1sZW50aXRpZXMo
JHR3ZWV0LT50ZXh0LCBFTlRfUVVPVEVTLCdVVEYtOCcpKQogICAgICAgIC4nICcudGFnKGh0
bWxlbnRpdGllcygkZGF0ZSksJ3NwYW4nLCcgY2xhc3M9IicuJGNsYXNzX3Bvc3RlZC4nIicp
OwogICAgfQoKICAgIHJldHVybiBkb0xhYmVsKCRsYWJlbCwgJGxhYmVsdGFnKS5kb1dyYXAo
JG91dCwgJHdyYXB0YWcsICRicmVhaywgJGNsYXNzKTsKICB9Cgp9CgpmdW5jdGlvbiBhcmNf
dHdpdHRlcl9zZWFyY2goJGF0dHMpCnsKICAgIGdsb2JhbCAkcHJlZnMsJGFyY190d2l0dGVy
X2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgogICAgZXh0cmFj
dChsQXR0cyhhcnJheSgKICAgICAgICAndXNlcicgICAgICA9PiAkcHJlZnNbJ2FyY190d2l0
dGVyX3VzZXInXSwKICAgICAgICAnc2VhcmNoJyAgICA9PiAnJywKICAgICAgICAnaGFzaHRh
Z3MnICA9PiAnJywKICAgICAgICAndXNlcicgICAgICA9PiAnJywKICAgICAgICAncmVwbHkn
ICAgICA9PiAnJywKICAgICAgICAnbWVudGlvbicgICA9PiAnJywKICAgICAgICAnbGltaXQn
ICAgICA9PiAnMTAnLAogICAgICAgICdsYW5nJyAgICAgID0+ICcnLAogICAgICAgICdkYXRl
Zm9ybWF0Jz0+ICRwcmVmc1snYXJjaGl2ZV9kYXRlZm9ybWF0J10sCiAgICAgICAgJ2NhY2hp
bmcnICAgPT4gJzEnLAogICAgICAgICdjYWNoZV9kaXInID0+ICRwcmVmc1snYXJjX3R3aXR0
ZXJfY2FjaGVfZGlyJ10sCiAgICAgICAgJ2NhY2hlX3RpbWUnPT4gJzUnLAogICAgICAgICds
YWJlbCcgICAgID0+ICcnLAogICAgICAgICdsYWJlbHRhZycgID0+ICcnLAogICAgICAgICdi
cmVhaycgICAgID0+ICdsaScsCiAgICAgICAgJ3dyYXB0YWcnICAgPT4gJycsCiAgICAgICAg
J2NsYXNzJyAgICAgPT4gX19GVU5DVElPTl9fLAogICAgICAgICdjbGFzc19wb3N0ZWQnID0+
IF9fRlVOQ1RJT05fXy4nLXBvc3RlZCcsCiAgICAgICAgJ2NsYXNzX3VzZXInICAgPT4gX19G
VU5DVElPTl9fLictdXNlcicKICAgICksJGF0dHMpKTsKCiAgICAgICAgJHR3aXQgPSBuZXcg
YXJjX1R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgICAgICwgJGFy
Y190d2l0dGVyX2NvbnN1bWVyU2VjcmV0KTsKCiAgICAgICAgaWYgKCRjYWNoaW5nKSB7ICAv
LyB0dXJuIG9uIGNhY2hpbmcsIHJlY29tbWVuZGVkIChkZWZhdWx0KQogICAgICAgICAgICAk
dHdpdC0+c2V0Q2FjaGluZyh0cnVlKTsKICAgICAgICAgICAgJHR3aXQtPmNhY2hlRGlyKCRj
YWNoZV9kaXIpOwogICAgICAgICAgICAkdHdpdC0+Y2FjaGVUaW1lKCRjYWNoZV90aW1lKTsK
ICAgICAgICB9IGVsc2UgeyAgLy8gdHVybiBvZmYgY2FjaGluZywgbm90IHJlY29tbWVuZGVk
IG90aGVyIHRoYW4gZm9yIHRlc3RpbmcKICAgICAgICAgICAgJHR3aXQtPnNldENhY2hpbmco
ZmFsc2UpOwogICAgICAgIH0KCiAgICAgICAgLy8gY29uc3RydWN0IHNlYXJjaCBxdWVyeQog
ICAgICAgIGlmICghZW1wdHkoJHNlYXJjaCkpIHsKICAgICAgICAgICAgJHRlcm1zID0gZXhw
bG9kZSgnLCcsJHNlYXJjaCk7ICR0ZXJtcyA9IGFycmF5X21hcCgndHJpbScsJHRlcm1zKTsK
ICAgICAgICAgICAgJHNlYXJjaCA9IGltcGxvZGUoJyAnLCR0ZXJtcyk7CiAgICAgICAgfQog
ICAgICAgIGlmICgkaGFzaHRhZ3MpIHsKICAgICAgICAgICAgJGhhc2hlcyA9IGV4cGxvZGUo
JywnLCRoYXNodGFncyk7ICRoYXNoZXMgPSBhcnJheV9tYXAoJ3RyaW0nLCRoYXNoZXMpOwog
ICAgICAgICAgICAkc2VhcmNoLj0gKCgkc2VhcmNoKT8nICc6JycpLicjJy5pbXBsb2RlKCcg
IycsJGhhc2hlcyk7CiAgICAgICAgfQogICAgICAgIGlmICgkcmVwbHkpIHsKICAgICAgICAg
ICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/JyAnOicnKS4ndG86Jy50cmltKCRyZXBseSk7CiAg
ICAgICAgfQogICAgICAgIGlmICgkdXNlcikgewogICAgICAgICAgICAkc2VhcmNoLj0gKCgk
c2VhcmNoKT8nICc6JycpLidmcm9tOicudHJpbSgkdXNlcik7CiAgICAgICAgfQogICAgICAg
IGlmICgkbWVudGlvbikgewogICAgICAgICAgICAkc2VhcmNoLj0gKCgkc2VhcmNoKT8nICc6
JycpLidAJy50cmltKCRtZW50aW9uKTsKICAgICAgICB9CgogICAgICAgIGlmIChlbXB0eSgk
c2VhcmNoKSkgewogICAgICAgICAgICByZXR1cm4gJyc7CiAgICAgICAgfSBlbHNlIHsKICAg
ICAgICAgICAgJHNlYXJjaCA9IHVybGVuY29kZSgkc2VhcmNoKTsKICAgICAgICB9CgogICAg
ICAgICRvdXQgPSBhcnJheSgpOwogICAgICAgICR0d2VldHMgPSAkdHdpdC0+Z2V0KCdodHRw
Oi8vc2VhcmNoLnR3aXR0ZXIuY29tL3NlYXJjaC5hdG9tP3E9Jy4kc2VhcmNoCiAgICAgICAg
ICAgICwgYXJyYXkoJ3JwcCc9PiRsaW1pdCwnbGFuZyc9PiRsYW5nKSk7CgogICAgICAgIGlm
ICgkdHdlZXRzKSB7IGZvcmVhY2ggKCR0d2VldHMtPmVudHJ5IGFzICR0d2VldCkgewogICAg
ICAgICAgICBwcmVnX21hdGNoKCIvKC4qKSBcKCguKilcKS8iLCR0d2VldC0+YXV0aG9yLT5u
YW1lLCRtYXRjaGVzKTsKICAgICAgICAgICAgbGlzdCgkYXV0aG9yLCR1bmFtZSwkbmFtZSkg
PSAkbWF0Y2hlczsKICAgICAgICAgICAgJHRpbWUgPSBzdHJ0b3RpbWUoaHRtbGVudGl0aWVz
KCR0d2VldC0+cHVibGlzaGVkKSk7CiAgICAgICAgICAgICRkYXRlID0gc2FmZV9zdHJmdGlt
ZSgkZGF0ZWZvcm1hdCwkdGltZSk7CiAgICAgICAgICAgICR0ZXh0ID0gJHR3ZWV0LT50aXRs
ZTsKICAgICAgICAgICAgJG91dFtdID0gdGFnKGhyZWYoaHRtbGVudGl0aWVzKCR1bmFtZSks
JHR3ZWV0LT5hdXRob3ItPnVyaSwKICAgICAgICAgICAgICAgICcgdGl0bGU9IicuaHRtbGVu
dGl0aWVzKCRuYW1lKS4nIicpLic6ICcsJ3NwYW4nCiAgICAgICAgICAgICAgICAgICAgLCcg
Y2xhc3M9IicuJGNsYXNzX3VzZXIuJyInKQogICAgICAgICAgICAgICAgLmFyY19Ud2l0dGVy
OjptYWtlTGlua3MoaHRtbGVudGl0aWVzKCR0ZXh0LCBFTlRfUVVPVEVTLCdVVEYtOCcpKQog
ICAgICAgICAgICAgICAgLicgJy50YWcoaHRtbGVudGl0aWVzKCRkYXRlKSwnc3BhbicKICAg
ICAgICAgICAgICAgICAgICAsJyBjbGFzcz0iJy4kY2xhc3NfcG9zdGVkLiciJyk7CiAgICAg
ICAgfSByZXR1cm4gZG9MYWJlbCgkbGFiZWwsICRsYWJlbHRhZykKICAgICAgICAgICAgLmRv
V3JhcCgkb3V0LCAkd3JhcHRhZywgJGJyZWFrLCAkY2xhc3MpOyB9Cgp9CgpmdW5jdGlvbiBh
cmNfdHdpdHRlcl90d2VldCgkYXR0cykgewogICAgZ2xvYmFsICR0aGlzYXJ0aWNsZTsKCiAg
ICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAnaWQnICAgICAgICA9PiAkdGhpc2FydGlj
bGVbJ3RoaXNpZCddLAogICAgICAnaW5jbHVkZV91cmwnICAgPT4gdHJ1ZQogICAgKSwkYXR0
cykpOwoKICAgIGlmICgkaWQpIHsKICAgICAgLy8gRmV0Y2ggYXJjX3R3aXR0ZXIgc3R1ZmYg
dG8gYnVpbGQgdHdlZXQgZnJvbQogICAgICAkdHdlZXQgPSAoJGluY2x1ZGVfdXJsKSA/IHNh
ZmVfcm93KCJ0d2VldCIsICdhcmNfdHdpdHRlcicsICJhcnRpY2xlX2lkPXskaWR9IikKICAg
ICAgICA6IHNhZmVfcm93KCJSRVBMQUNFKHR3ZWV0LENPTkNBVCgnICcsdGlueXVybCksJycp
IEFTIHR3ZWV0IgogICAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlk
fSIpOwogICAgfQoKICAgIGlmICgkdHdlZXRbJ3R3ZWV0J10pIHsKICAgICAgcmV0dXJuIGFy
Y19Ud2l0dGVyOjptYWtlTGlua3MoCiAgICAgICAgaHRtbGVudGl0aWVzKCR0d2VldFsndHdl
ZXQnXSwgRU5UX1FVT1RFUywnVVRGLTgnKSk7CiAgICB9Cn0KCmZ1bmN0aW9uIGFyY190d2l0
dGVyX3R3ZWV0X3VybCgkYXR0cywgJHRoaW5nPW51bGwpIHsKICAgIGdsb2JhbCAkdGhpc2Fy
dGljbGUsJHByZWZzOwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICdpZCcgICAg
ICA9PiAkdGhpc2FydGljbGVbJ3RoaXNpZCddLAogICAgICAndGl0bGUnICAgPT4gJycsCiAg
ICAgICdjbGFzcycgICA9PiAnJwogICAgKSwkYXR0cykpOwoKICAgIGlmICgkaWQpIHsKICAg
ICAgLy8gRmV0Y2ggYXJjX3R3aXR0ZXIgc3R1ZmYgdG8gYnVpbGQgdHdlZXQgZnJvbQogICAg
ICAkdHdlZXQgPSBzYWZlX3JvdygidHdlZXRfaWQiCiAgICAgICAgLCAnYXJjX3R3aXR0ZXIn
LCAiYXJ0aWNsZV9pZD17JGlkfSIpOwogICAgfQoKICAgIGlmICgkdHdlZXRbJ3R3ZWV0X2lk
J10pIHsKICAgICAgJHVybCA9ICJodHRwOi8vdHdpdHRlci5jb20vIi4kcHJlZnNbJ2FyY190
d2l0dGVyX3VzZXInXS4iL3N0YXR1cy8iLiR0d2VldFsndHdlZXRfaWQnXTsKICAgICAgaWYg
KCR0aGluZz09PW51bGwpIHsKICAgICAgICByZXR1cm4gJHVybDsKICAgICAgfQogICAgICBy
ZXR1cm4gaHJlZihwYXJzZSgkdGhpbmcpLCAkdXJsLAogICAgICAgICgkdGl0bGUgPyAnIHRp
dGxlPSInLiR0aXRsZS4nIicgOiAnJykKICAgICAgICAuKCRjbGFzcyA/ICcgY2xhc3M9Iicu
JGNsYXNzLiciJyA6ICcnKSk7CiAgICB9Cn0KCmZ1bmN0aW9uIGFyY190d2l0dGVyX3Rpbnl1
cmwoJGF0dHMsICR0aGluZz1udWxsKSB7CiAgICBnbG9iYWwgJHRoaXNhcnRpY2xlOwoKICAg
IGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICdpZCcgICAgICA9PiAkdGhpc2FydGljbGVb
J3RoaXNpZCddLAogICAgICAndGl0bGUnICAgPT4gJycsCiAgICAgICdjbGFzcycgICA9PiAn
JwogICAgKSwkYXR0cykpOwoKICAgIGlmICgkaWQpIHsKICAgICAgLy8gRmV0Y2ggYXJjX3R3
aXR0ZXIgc3R1ZmYgdG8gYnVpbGQgdHdlZXQgZnJvbQogICAgICAkdHdlZXQgPSBzYWZlX3Jv
dygidGlueXVybCIKICAgICAgICAsICdhcmNfdHdpdHRlcicsICJhcnRpY2xlX2lkPXskaWR9
Iik7CiAgICB9CgogICAgaWYgKCR0d2VldFsndGlueXVybCddKSB7CiAgICAgIGlmICgkdGhp
bmc9PT1udWxsKSB7CiAgICAgICAgcmV0dXJuICR0d2VldFsndGlueXVybCddOwogICAgICB9
CgogICAgICByZXR1cm4gaHJlZihwYXJzZSgkdGhpbmcpLCAkdHdlZXRbJ3Rpbnl1cmwnXSwK
ICAgICAgICAoJHRpdGxlID8gJyB0aXRsZT0iJy4kdGl0bGUuJyInIDogJycpCiAgICAgICAg
LigkY2xhc3MgPyAnIGNsYXNzPSInLiRjbGFzcy4nIicgOiAnJykpOwogICAgfQp9CgovKgog
KiBQdWJsaWMgdGFnIGZvciBvdXRwdXR0aW5nIHdpZGdldCBKUwogKi8KZnVuY3Rpb24gYXJj
X3R3aXR0ZXJfd2lkZ2V0X2pzKCRhdHRzKQp7CiAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAg
ICAgICAnb3B0aW1pc2UnID0+IGZhbHNlCiAgICApLCRhdHRzKSk7CgogIHJldHVybiBfYXJj
X3R3aXR0ZXJfd2lkZ2V0X2pzKCRvcHRpbWlzZSk7Cn0KCmZ1bmN0aW9uIF9hcmNfdHdpdHRl
cl93aWRnZXRfanMoJG9wdGltaXNlPXRydWUpCnsKICBnbG9iYWwgJGFyY190d2l0dGVyOwoK
ICAvLyBDaGVjayBpZiB3aWRnZXQgSlMgaGFzIGFscmVhZHkgYmVlbiBvdXRwdXQKICBpZiAo
JGFyY190d2l0dGVyWyd3aWRnZXRfanMnXSkgcmV0dXJuOwoKICBpZiAoJG9wdGltaXNlPT1m
YWxzZSkgewogICAgcmV0dXJuICc8c2NyaXB0IHNyYz0iaHR0cDovL3BsYXRmb3JtLnR3aXR0
ZXIuY29tL3dpZGdldHMuanMiIHR5cGU9InRleHQvamF2YXNjcmlwdCI+PC9zY3JpcHQ+JzsK
ICB9CgogICRqcyA9IDw8PEpTCjxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KKGZ1
bmN0aW9uKCkgewogIGlmICh3aW5kb3cuX190d2l0dGVySW50ZW50SGFuZGxlcikgcmV0dXJu
OwogIHZhciBpbnRlbnRSZWdleCA9IC90d2l0dGVyXC5jb20oXDpcZHsyLDR9KT9cL2ludGVu
dFwvKFx3KykvLAogICAgICB3aW5kb3dPcHRpb25zID0gJ3Njcm9sbGJhcnM9eWVzLHJlc2l6
YWJsZT15ZXMsdG9vbGJhcj1ubyxsb2NhdGlvbj15ZXMnLAogICAgICB3aWR0aCA9IDU1MCwK
ICAgICAgaGVpZ2h0ID0gNDIwLAogICAgICB3aW5IZWlnaHQgPSBzY3JlZW4uaGVpZ2h0LAog
ICAgICB3aW5XaWR0aCA9IHNjcmVlbi53aWR0aDsKCiAgZnVuY3Rpb24gaGFuZGxlSW50ZW50
KGUpIHsKICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsKICAgIHZhciB0YXJnZXQgPSBlLnRh
cmdldCB8fCBlLnNyY0VsZW1lbnQsCiAgICAgICAgbSwgbGVmdCwgdG9wOwoKICAgIHdoaWxl
ICh0YXJnZXQgJiYgdGFyZ2V0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgIT09ICdhJykgewog
ICAgICB0YXJnZXQgPSB0YXJnZXQucGFyZW50Tm9kZTsKICAgIH0KCiAgICBpZiAodGFyZ2V0
ICYmIHRhcmdldC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnYScgJiYgdGFyZ2V0Lmhy
ZWYpIHsKICAgICAgbSA9IHRhcmdldC5ocmVmLm1hdGNoKGludGVudFJlZ2V4KTsKICAgICAg
aWYgKG0pIHsKICAgICAgICBsZWZ0ID0gTWF0aC5yb3VuZCgod2luV2lkdGggLyAyKSAtICh3
aWR0aCAvIDIpKTsKICAgICAgICB0b3AgPSAwOwoKICAgICAgICBpZiAod2luSGVpZ2h0ID4g
aGVpZ2h0KSB7CiAgICAgICAgICB0b3AgPSBNYXRoLnJvdW5kKCh3aW5IZWlnaHQgLyAyKSAt
IChoZWlnaHQgLyAyKSk7CiAgICAgICAgfQoKICAgICAgICB3aW5kb3cub3Blbih0YXJnZXQu
aHJlZiwgJ2ludGVudCcsIHdpbmRvd09wdGlvbnMgKyAnLHdpZHRoPScgKyB3aWR0aCArCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLGhlaWdodD0nICsg
aGVpZ2h0ICsgJyxsZWZ0PScgKyBsZWZ0ICsgJyx0b3A9JyArIHRvcCk7CiAgICAgICAgZS5y
ZXR1cm5WYWx1ZSA9IGZhbHNlOwogICAgICAgIGUucHJldmVudERlZmF1bHQgJiYgZS5wcmV2
ZW50RGVmYXVsdCgpOwogICAgICB9CiAgICB9CiAgfQoKICBpZiAoZG9jdW1lbnQuYWRkRXZl
bnRMaXN0ZW5lcikgewogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBo
YW5kbGVJbnRlbnQsIGZhbHNlKTsKICB9IGVsc2UgaWYgKGRvY3VtZW50LmF0dGFjaEV2ZW50
KSB7CiAgICBkb2N1bWVudC5hdHRhY2hFdmVudCgnb25jbGljaycsIGhhbmRsZUludGVudCk7
CiAgfQogIHdpbmRvdy5fX3R3aXR0ZXJJbnRlbnRIYW5kbGVyID0gdHJ1ZTsKfSgpKTsKPC9z
Y3JpcHQ+CkpTOwogICRhcmNfdHdpdHRlclsnd2lkZ2V0X2pzJ10gPSB0cnVlOwogIHJldHVy
biAkanM7Cn0KCi8vIERlcHJlY2F0ZWQgYXJjX3R3aXR0ZXJfcmV0d2VldCB0YWcsIHVzZSBh
cmNfdHdpdHRlcl90d2VldF9idXR0b24gaW5zdGVhZApmdW5jdGlvbiBhcmNfdHdpdHRlcl9y
ZXR3ZWV0KCRhdHRzLCAkdGhpbmc9bnVsbCkKewogIHJldHVybiBhcmNfdHdpdHRlcl90d2Vl
dF9idXR0b24oJGF0dHMsICR0aGluZz1udWxsKTsKfQpmdW5jdGlvbiBhcmNfdHdpdHRlcl90
d2VldF9idXR0b24oJGF0dHMsICR0aGluZz1udWxsKQp7CiAgICBnbG9iYWwgJHByZWZzLCRh
cmNfdHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0Owog
ICAgZ2xvYmFsICR0aGlzYXJ0aWNsZTsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAg
ICAgICd1c2VyJyAgICAgICAgPT4gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sIC8vIHZp
YSB1c2VyIGFjY291bnQKICAgICAgICAndXJsJyAgICAgICAgID0+ICcnLAogICAgICAgICd0
ZXh0JyAgICAgICAgPT4gJycsCiAgICAgICAgJ2ZvbGxvdzEnICAgICA9PiAnJywKICAgICAg
ICAnZm9sbG93MicgICAgID0+ICcnLAogICAgICAgICdsYW5nJyAgICAgICAgPT4gJycsCiAg
ICAgICAgJ2NvdW50JyAgICAgICA9PiAnaG9yaXpvbnRhbCcsCiAgICAgICAgJ2luY2x1ZGVf
anMnICA9PiB0cnVlLAogICAgICAgICdvcHRpbWlzZV9qcycgPT4gZmFsc2UsCiAgICAgICAg
J3dyYXB0YWcnICAgICA9PiAnJywKICAgICAgICAnY2xhc3MnICAgICAgID0+ICd0d2l0dGVy
LXNoYXJlLWJ1dHRvbicKICAgICksJGF0dHMpKTsKCiAgICAkcSA9ICcnOyAvLyBxdWVyeSBz
dHJpbmcKCiAgICBpZiAoJGlkPSR0aGlzYXJ0aWNsZVsndGhpc2lkJ10pIHsKICAgICAgLy8g
RmV0Y2ggYXJjX3R3aXR0ZXIgc3R1ZmYgdG8gYnVpbGQgdHdlZXQgZnJvbQogICAgICAkcm93
ID0gc2FmZV9yb3coIlJFUExBQ0UodHdlZXQsQ09OQ0FUKCcgJyx0aW55dXJsKSwnJykgQVMg
dHdlZXQsdGlueXVybCIKICAgICAgICAsICdhcmNfdHdpdHRlcicsICJhcnRpY2xlX2lkPXsk
aWR9Iik7CgogICAgICBpZiAoJHVybD09JycpIHsKICAgICAgICAkdXJsID0gKCR1cmwpID8g
JHVybCA6IHBlcm1saW5rdXJsKCR0aGlzYXJ0aWNsZSk7CiAgICAgICAgJHEgPSAndXJsPScu
dXJsZW5jb2RlKCR1cmwpOwogICAgICB9CiAgICAgIGlmICgkdGV4dD09JycpIHsKICAgICAg
ICAkdGV4dCA9ICgkcm93Wyd0d2VldCddKSA/ICRyb3dbJ3R3ZWV0J10gOiAkdGhpc2FydGlj
bGVbJ3RpdGxlJ107CiAgICAgIH0KICAgICAgJHEgLj0gKCRxID8gJyZhbXA7JyA6ICcnKS4n
dGV4dD0nLnVybGVuY29kZSgkdGV4dCk7CiAgICB9CiAgICBpZiAoJHVzZXIpIHsKICAgICAg
JHEgLj0gKCRxID8gJyZhbXA7JyA6ICcnKS4ndmlhPScudXJsZW5jb2RlKCR1c2VyKTsKICAg
IH0KICAgIGlmICgkZm9sbG93MSYmJGZvbGxvdzIpIHsKICAgICAgJHEgLj0gKCRxID8gJyZh
bXA7JyA6ICcnKS4ncmVsYXRlZD0nLnVybGVuY29kZSgkZm9sbG93MS4nOicuJGZvbGxvdzIp
OwogICAgfSBlbHNlaWYgKCRmb2xsb3cxfHwkZm9sbG93MikgewogICAgICAkcSAuPSAoJHEg
PyAnJmFtcDsnIDogJycpLidyZWxhdGVkPScudXJsZW5jb2RlKCRmb2xsb3cxLiRmb2xsb3cy
KTsKICAgIH0KCiAgICBzd2l0Y2ggKCRsYW5nKSB7CiAgICAgIGNhc2UgJ2ZyJzogYnJlYWs7
IGNhc2UgJ2RlJzogYnJlYWs7IGNhc2UgJ2VzJzogYnJlYWs7IGNhc2UgJ2pwJzogYnJlYWs7
CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgJGxhbmcgPSAnZW4nOwogICAgfQogICAgJHEgLj0g
KCRxID8gJyZhbXA7JyA6ICcnKS4nbGFuZz0nLnVybGVuY29kZSgkbGFuZyk7CgogICAgc3dp
dGNoICgkY291bnQpIHsKICAgICAgY2FzZSAnbm9uZSc6IGJyZWFrOyBjYXNlICd2ZXJ0aWNh
bCc6IGJyZWFrOwogICAgICBkZWZhdWx0OgogICAgICAgICRjb3VudCA9ICdob3Jpem9udGFs
JzsKICAgIH0KICAgICRxIC49ICgkcSA/ICcmYW1wOycgOiAnJykuJ2NvdW50PScudXJsZW5j
b2RlKCRjb3VudCk7CgogICAgJHRoaW5nID0gKCR0aGluZz09PW51bGwpID8gJ1R3ZWV0JyA6
IHBhcnNlKCR0aGluZyk7CgogICAgJGh0bWwgPSBocmVmKCR0aGluZywnaHR0cDovL3R3aXR0
ZXIuY29tL3NoYXJlPycuJHEKICAgICAgLCAnIGNsYXNzPSInLiRjbGFzcy4nIicpOwoKICAg
ICRqcyA9ICgkaW5jbHVkZV9qcykgPyBfYXJjX3R3aXR0ZXJfd2lkZ2V0X2pzKCRvcHRpbWlz
ZV9qcz90cnVlOmZhbHNlKSA6ICcnOwoKICAgIHJldHVybiAkanMuJGh0bWw7Cn0KCi8qCiAq
IFR3aXR0ZXIgRm9sbG93IGJ1dHRvbgogKi8KZnVuY3Rpb24gYXJjX3R3aXR0ZXJfZm9sbG93
X2J1dHRvbigkYXR0cywgJHRoaW5nPW51bGwpCnsKICAgIGdsb2JhbCAkcHJlZnMsJGFyY190
d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CiAgICBn
bG9iYWwgJHRoaXNhcnRpY2xlOwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICAg
J3VzZXInICAgICAgICA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSwgLy8gdmlhIHVz
ZXIgYWNjb3VudAogICAgICAgICdsYW5nJyAgICAgICAgPT4gJycsCiAgICAgICAgJ2NvdW50
JyAgICAgICA9PiB0cnVlLAogICAgICAgICdpbmNsdWRlX2pzJyAgPT4gdHJ1ZSwKICAgICAg
ICAnb3B0aW1pc2VfanMnID0+IGZhbHNlLAogICAgICAgICdjbGFzcycgICAgICAgPT4gJ3R3
aXR0ZXItZm9sbG93LWJ1dHRvbicKICAgICksJGF0dHMpKTsKCiAgICAkYXR0cyA9ICcnOyAv
LyBkYXRhIGF0dHJpYnV0ZXMKCiAgICBzd2l0Y2ggKCRsYW5nKSB7CiAgICAgIGNhc2UgJ2Zy
JzogYnJlYWs7IGNhc2UgJ2RlJzogYnJlYWs7IGNhc2UgJ2VzJzogYnJlYWs7IGNhc2UgJ2pw
JzogYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgJGxhbmcgPSAnZW4nOwogICAgfQog
ICAgJGF0dHMgLj0gJyBkYXRhLWxhbmc9IicudXJsZW5jb2RlKCRsYW5nKS4nIic7CgogICAg
JGF0dHMgLj0gJyBkYXRhLXNob3ctY291bnQ9IicuKCRjb3VudD8ndHJ1ZSc6J2ZhbHNlJyku
JyInOwoKICAgICR0aGluZyA9ICgkdGhpbmc9PT1udWxsKSA/ICdGb2xsb3cgQCcuJHVzZXIg
OiBwYXJzZSgkdGhpbmcpOwoKICAgICRodG1sID0gaHJlZigkdGhpbmcsJ2h0dHA6Ly90d2l0
dGVyLmNvbS8nLnVybGVuY29kZSgkdXNlcikKICAgICAgLCAnIGNsYXNzPSInLiRjbGFzcy4n
IicuJGF0dHMpOwoKICAgICRqcyA9ICgkaW5jbHVkZV9qcykgPyBfYXJjX3R3aXR0ZXJfd2lk
Z2V0X2pzKCRvcHRpbWlzZV9qcz90cnVlOmZhbHNlKSA6ICcnOwoKICAgIHJldHVybiAkanMu
JGh0bWw7Cn0KCi8qCiAgICBBZG1pbi1zaWRlIGZ1bmN0aW9ucwogICAgPT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoq
LwoKLy8gSW5zdGFsbGF0aW9uIGZ1bmN0aW9uIC0gYnVpbGRzIE15U1FMIHRhYmxlCmZ1bmN0
aW9uIGFyY190d2l0dGVyX2luc3RhbGwoKQp7CgogICAgLy8gRm9yIGZpcnN0IGluc3RhbGws
IGNyZWF0ZSB0YWJsZSBmb3IgdHdlZXRzCiAgICAkc3FsID0gIkNSRUFURSBUQUJMRSBJRiBO
T1QgRVhJU1RTICIuUEZYLiJhcmNfdHdpdHRlciAiOwogICAgJHNxbC49ICIoYXJjX3R3aXR0
ZXJpZCBJTlRFR0VSIEFVVE9fSU5DUkVNRU5UIFBSSU1BUlkgS0VZLAogICAgICAgIGFydGlj
bGVfaWQgSU5URUdFUigxMSksCiAgICAgICAgdHdlZXRfaWQgQklHSU5UKDIwKSwKICAgICAg
ICB0d2VldCBWQVJDSEFSKDE0MCksCiAgICAgICAgdGlueXVybCBWQVJDSEFSKDMwKSk7IjsK
CiAgICBpZiAoIXNhZmVfcXVlcnkoJHNxbCkpIHsKICAgICAgICByZXR1cm4gJ0Vycm9yIC0g
dW5hYmxlIHRvIGNyZWF0ZSBhcmNfdHdpdHRlciB0YWJsZSc7CiAgICB9Cgp9CgovLyBVbmlu
c3RhbGwgZnVuY3Rpb24gLSBkZWxldGVzIE15U1FMIHRhYmxlIGFuZCByZWxhdGVkIHByZWZl
cmVuY2VzCmZ1bmN0aW9uIGFyY190d2l0dGVyX3VuaW5zdGFsbCgpCnsKCiAgICAkc3FsID0g
IkRST1AgVEFCTEUgSUYgRVhJU1RTICIuUEZYLiJhcmNfdHdpdHRlcjsiOwogICAgaWYgKCFz
YWZlX3F1ZXJ5KCRzcWwpKSB7CiAgICAgICAgcmV0dXJuICdFcnJvciAtIHVuYWJsZSB0byBk
ZWxldGUgYXJjX3R3aXR0ZXIgdGFibGUnOwogICAgfQoKICAgICRzcWwgPSAiREVMRVRFIEZS
T00gICIuUEZYLiJ0eHBfcHJlZnMgV0hFUkUgZXZlbnQ9J2FyY190d2l0dGVyJzsiOwogICAg
aWYgKCFzYWZlX3F1ZXJ5KCRzcWwpKSB7CiAgICAgICAgcmV0dXJuICdFcnJvciAtIHVuYWJs
ZSB0byBkZWxldGUgYXJjX3R3aXR0ZXIgcHJlZmVyZW5jZXMnOwogICAgfQoKfQpmdW5jdGlv
biBhcmNfdHdpdHRlcl91cmxfbWV0aG9kX3NlbGVjdCgkbmFtZSwgJHZhbCkKewogICAgJG1l
dGhvZHMgPSBhcnJheSgndGlueXVybCcgPT4gJ1Rpbnl1cmwnLAogICAgICAnaXNnZCcgPT4g
J0lzLmdkJywKICAgICAgJ2FyY190d2l0dGVyJyA9PiAnVFhQIFR3ZWV0JywKICAgICAgJ3Nt
ZCcgPT4gJ3NtZF9zaG9ydF91cmwnKTsKICAgIHJldHVybiBzZWxlY3RJbnB1dCgkbmFtZSwg
JG1ldGhvZHMsICR2YWwpOwp9CmZ1bmN0aW9uIGFyY190d2l0dGVyX3RhYl9zZWxlY3QoJG5h
bWUsICR2YWwpCnsKICAgICR0YWJzID0gYXJyYXkoJ2NvbnRlbnQnID0+ICdDb250ZW50JywK
ICAgICAgICAnZXh0ZW5zaW9ucycgPT4gJ0V4dGVuc2lvbnMnLAogICAgICAgICcnID0+ICdI
aWRkZW4nKTsKICAgIHJldHVybiBzZWxlY3RJbnB1dCgkbmFtZSwgJHRhYnMsICR2YWwpOwp9
Ci8vIFByb3ZpZGUgaW50ZXJmYWNlIGZvciBzZXR0aW5nIHByZWZlcmVuY2VzCmZ1bmN0aW9u
IGFyY190d2l0dGVyX3ByZWZzKCRldmVudCwkc3RlcCkKewoKICAgIGdsb2JhbCAkcHJlZnMs
JGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsK
CiAgICAkdXNlciAgICAgICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddOwogICAg
JHByZWZpeCAgICAgICAgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3ByZWZpeCddOwogICAgJHN1
ZmZpeCAgICAgICAgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3N1ZmZpeCddOwogICAgJHR3ZWV0
X2RlZmF1bHQgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnXTsKICAgICR1
cmxfbWV0aG9kICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl91cmxfbWV0aG9kJ107CiAgICAk
c2hvcnRfdXJsICAgICA9ICRwcmVmc1snYXJjX3Nob3J0X3VybCddOwogICAgJHNob3J0X3Np
dGVfdXJsPSAkcHJlZnNbJ2FyY19zaG9ydF9zaXRlX3VybCddOwogICAgJGNhY2hlX2RpciAg
ICAgPSAkcHJlZnNbJ2FyY190d2l0dGVyX2NhY2hlX2RpciddOwogICAgJHRhYiAgICAgICAg
ICAgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddOwoKICAgIHN3aXRjaCAoJHN0ZXApIHsK
ICAgICAgICBjYXNlICdwcmVmc19zYXZlJzogcGFnZXRvcCgnVFhQIFR3ZWV0JywgJ1ByZWZl
cmVuY2VzIHNhdmVkJyk7IGJyZWFrOwogICAgICAgIGNhc2UgJ3JlZ2lzdGVyJzogcGFnZXRv
cCgnVFhQIFR3ZWV0JywnQ29ubmVjdCB0byBUd2l0dGVyJyk7IGJyZWFrOwogICAgICAgIGNh
c2UgJ3ZhbGlkYXRlJzoKICAgICAgICBkZWZhdWx0OiBwYWdldG9wKCdUWFAgVHdlZXQnKTsK
ICAgIH0KCiAgICAkaHRtbCA9ICcnOwoKICAgIGlmICgkc3RlcD09J3JlZ2lzdGVyJykgeyAv
LyBPQXV0aCByZWdpc3RyYXRpb24gcHJvY2VzcwogICAgICAgICR0d2l0ID0gbmV3IGFyY190
d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAsICRhcmNfdHdp
dHRlcl9jb25zdW1lclNlY3JldCk7CgogICAgICAgIC8vIEJ1aWxkIGEgY2FsbGJhY2sgVVJM
IGZvciBUd2l0dGVyIHRvIHJldHVybiB0byB0aGUgbmV4dCBzdGFnZQogICAgICAgICRjYWxs
YmFja1VSTCA9ICR0d2l0LT5jYWxsYmFja1VSTCgkZXZlbnQsJ3ZhbGlkYXRlJyk7CgogICAg
ICAgICRyZXF1ZXN0ID0gJHR3aXQtPmdldFJlcXVlc3RUb2tlbigkY2FsbGJhY2tVUkwpOwog
ICAgICAgICRyZXF1ZXN0X3Rva2VuID0gJHJlcXVlc3RbIm9hdXRoX3Rva2VuIl07CiAgICAg
ICAgJHJlcXVlc3RfdG9rZW5fc2VjcmV0ID0gJHJlcXVlc3RbIm9hdXRoX3Rva2VuX3NlY3Jl
dCJdOwoKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfcmVxdWVzdFRva2VuJywkcmVx
dWVzdF90b2tlbgogICAgICAgICAgICAsICdhcmNfdHdpdHRlcicsMik7CiAgICAgICAgc2V0
X3ByZWYoJ2FyY190d2l0dGVyX3JlcXVlc3RUb2tlblNlY3JldCcsJHJlcXVlc3RfdG9rZW5f
c2VjcmV0CiAgICAgICAgICAgICwgJ2FyY190d2l0dGVyJywyKTsKCiAgICAgICAgJGh0bWwu
PSBzdGFydFRhYmxlKCdlZGl0JykuCiAgICAgICAgICAgICAgICB0cih0ZCgKICAgICAgICAg
ICAgICAgICAgICAoJzxwPicuaHJlZignU2lnbi1pbiB0byBUd2l0dGVyJwogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgLCR0d2l0LT5nZXRBdXRob3JpemVVUkwoJHJlcXVlc3QpKQog
ICAgICAgICAgICAgICAgICAgICAgICAuJyBhbmQgZm9sbG93IHRoZSBpbnN0cnVjdGlvbnMg
dG8gYWxsb3cgVFhQIFR3ZWV0IHRvIHVzZSB5b3VyIGFjY291bnQuIElmIHlvdSBhcmUgYWxy
ZWFkeSBzaWduZWQgaW4gdG8gVHdpdHRlciB0aGVuIHRoYXQgYWNjb3VudCB3aWxsIGJlIGFz
c29jaWF0ZWQgd2l0aCBUWFAgVHdlZXQgc28geW91IG1heSBuZWVkIHRvIHNpZ24gb3V0IGZp
cnN0IGlmIHlvdSB3YW50IHRvIHVzZSBhIGRpZmZlcmVudCBhY2NvdW50LjwvcD4nKQogICAg
ICAgICAgICAgICAgKSkuZW5kVGFibGUoKTsKICAgIH0gZWxzZWlmICgkc3RlcD09J3ZhbGlk
YXRlJykgewogICAgICAgICR0d2l0ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9j
b25zdW1lcktleQogICAgICAgICAgICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCwg
JHByZWZzWydhcmNfdHdpdHRlcl9yZXF1ZXN0VG9rZW4nXQogICAgICAgICAgICAsICRwcmVm
c1snYXJjX3R3aXR0ZXJfcmVxdWVzdFRva2VuU2VjcmV0J10pOwogICAgICAgIC8vIEFzayBU
d2l0dGVyIGZvciBhbiBhY2Nlc3MgdG9rZW4gKGFuZCBhbiBhY2Nlc3MgdG9rZW4gc2VjcmV0
KQogICAgICAgICRyZXF1ZXN0ID0gJHR3aXQtPmdldEFjY2Vzc1Rva2VuKCBncHMoJ29hdXRo
X3ZlcmlmaWVyJykgKTsKICAgICAgICAkYWNjZXNzX3Rva2VuID0gJHJlcXVlc3RbJ29hdXRo
X3Rva2VuJ107CiAgICAgICAgJGFjY2Vzc190b2tlbl9zZWNyZXQgPSAkcmVxdWVzdFsnb2F1
dGhfdG9rZW5fc2VjcmV0J107CiAgICAgICAgJHVzZXIgPSAkcmVxdWVzdFsnc2NyZWVuX25h
bWUnXTsKICAgICAgICAvLyBTdG9yZSB0aGUgYWNjZXNzIHRva2VuIGFuZCBzZWNyZXQKICAg
ICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nLCRhY2Nlc3NfdG9rZW4s
ICdhcmNfdHdpdHRlcicsMik7CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX2FjY2Vz
c1Rva2VuU2VjcmV0JywkYWNjZXNzX3Rva2VuX3NlY3JldAogICAgICAgICAgICAsICdhcmNf
dHdpdHRlcicsMik7CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3VzZXInLCR1c2Vy
KTsKICAgICAgICAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10gPSAkYWNjZXNz
X3Rva2VuOwogICAgICAgICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQn
XSA9ICRhY2Nlc3NfdG9rZW5fc2VjcmV0OwogICAgICAgIHVuc2V0KCR0d2l0KTsKICAgIH0K
CiAgICBpZiAoJHN0ZXA9PSJwcmVmc19zYXZlIikgewogICAgICAgICRwcmVmaXggPSB0cmlt
KGdwcygnYXJjX3R3aXR0ZXJfcHJlZml4JykpOwogICAgICAgICRzdWZmaXggPSB0cmltKGdw
cygnYXJjX3R3aXR0ZXJfc3VmZml4JykpOwogICAgICAgICR0d2VldF9kZWZhdWx0ID0gZ3Bz
KCdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0Jyk7CiAgICAgICAgJHVybF9tZXRob2QgPSBn
cHMoJ2FyY190d2l0dGVyX3VybF9tZXRob2QnKTsKICAgICAgICAkc2hvcnRfdXJsID0gZ3Bz
KCdhcmNfc2hvcnRfdXJsJyk7CiAgICAgICAgJHNob3J0X3NpdGVfdXJsID0gZ3BzKCdhcmNf
c2hvcnRfc2l0ZV91cmwnKTsKICAgICAgICAkY2FjaGVfZGlyID0gZ3BzKCdhcmNfdHdpdHRl
cl9jYWNoZV9kaXInKTsKICAgICAgICAkdGFiID0gZ3BzKCdhcmNfdHdpdHRlcl90YWInKTsK
ICAgICAgICBpZiAoc3RybGVuKCRwcmVmaXgpPD0yMCkgewogICAgICAgICAgICBzZXRfcHJl
ZignYXJjX3R3aXR0ZXJfcHJlZml4JywkcHJlZml4KTsKICAgICAgICB9IGVsc2UgewogICAg
ICAgICAgICAkcHJlZml4ID0gJHByZWZzWydhcmNfdHdpdHRlcl9wcmVmaXgnXTsKICAgICAg
ICB9CiAgICAgICAgaWYgKHN0cmxlbigkc3VmZml4KTw9MjApIHsKICAgICAgICAgICAgc2V0
X3ByZWYoJ2FyY190d2l0dGVyX3N1ZmZpeCcsJHN1ZmZpeCk7CiAgICAgICAgfSBlbHNlIHsK
ICAgICAgICAgICAgJHN1ZmZpeCA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfc3VmZml4J107CiAg
ICAgICAgfQogICAgICAgICR0d2VldF9kZWZhdWx0ID0gKCR0d2VldF9kZWZhdWx0KSA/IDEg
OiAwOwogICAgICAgICRzaG9ydF91cmwgPSAoJHNob3J0X3VybCkgPyAxIDogMDsKICAgICAg
ICBpZiAoISRzaG9ydF9zaXRlX3VybCkgJHNob3J0X3NpdGVfdXJsID0gJHByZWZzWydzaXRl
dXJsJ107CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnLCR0
d2VldF9kZWZhdWx0KTsKICAgICAgICBzZXRfcHJlZignYXJjX3Nob3J0X3VybCcsJHNob3J0
X3VybCk7CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3VybF9tZXRob2QnLCR1cmxf
bWV0aG9kKTsKICAgICAgICBzZXRfcHJlZignYXJjX3Nob3J0X3NpdGVfdXJsJywkc2hvcnRf
c2l0ZV91cmwpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9jYWNoZV9kaXInLCRj
YWNoZV9kaXIpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl90YWInLCR0YWIpOwog
ICAgfQoKICAgIGlmICggJHN0ZXAhPSdyZWdpc3RlcicgKSB7CiAgICAgICAgaWYgKCBpc3Nl
dCgkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10pCiAgICAgICAgJiYgaXNzZXQo
JHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKSApIHsKICAgICAgICAg
ICAgJHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAg
ICAgICAgICAgICAgICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCwgJHByZWZzWydh
cmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddCiAgICAgICAgICAgICAgICAsICRwcmVmc1snYXJj
X3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSk7CiAgICAgICAgICAgICRyZWdpc3RlclVS
TCA9ICR0d2l0LT5jYWxsYmFja1VSTCgkZXZlbnQsJ3JlZ2lzdGVyJyk7CiAgICAgICAgICAg
ICRodG1sLj0gc3RhcnRUYWJsZSgnbGlzdCcpLmZvcm0oCiAgICAgICAgICAgICAgICB0cigK
ICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVHdpdHRlciBhY2NvdW50IGRldGFpbHMn
LCAyKSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAogICAgICAg
ICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfdXNlciI+VHdpdHRl
ciB1c2VybmFtZTwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0i
dGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAg
ICAgICAgICAgICAgLnRkKAogICAgICAgICAgICAgICAgICAgICAgICAoJHByZWZzWydhcmNf
dHdpdHRlcl91c2VyJ10pID8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICR1c2VyLicg
KCcuaHJlZignUmUtY29ubmVjdCcsJHJlZ2lzdGVyVVJMKS4nKScKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIDogJzxlbT51bmtub3duPC9lbT4nCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAuaHJlZignQ29ubmVjdCB0byBUd2l0dGVyJywkcmVnaXN0ZXJVUkwpKQogICAg
ICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAogICAgICAgICAgICAgICAgICAg
IHRkY3MoaGVkKCdUd2VldCBzZXR0aW5ncycsIDIpLDIpCiAgICAgICAgICAgICAgICApCiAg
ICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9y
PSJhcmNfdHdpdHRlcl9wcmVmaXgiPlR3ZWV0IHByZWZpeDwvbGFiZWw+JywKICAgICAgICAg
ICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFs
aWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKGZJbnB1dCgndGV4dCcs
J2FyY190d2l0dGVyX3ByZWZpeCcsJHByZWZpeCwnJywnJywnJywnJywnJywnYXJjX3R3aXR0
ZXJfcHJlZml4JykpCiAgICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAgICAgICAg
IHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfc3VmZml4Ij5Ud2VldCBzdWZmaXg8L2xh
YmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJp
Z2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50
ZChmSW5wdXQoJ3RleHQnLCdhcmNfdHdpdHRlcl9zdWZmaXgnLCRzdWZmaXgsJycsJycsJycs
JycsJycsJ2FyY190d2l0dGVyX3N1ZmZpeCcpKQogICAgICAgICAgICAgICAgKS50cigKICAg
ICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX3R3ZWV0X2Rl
ZmF1bHQiPlR3ZWV0IGFydGljbGVzIGJ5IGRlZmF1bHQ8L2xhYmVsPicsCiAgICAgICAgICAg
ICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGln
bjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50ZCh5ZXNub1JhZGlvKCdhcmNf
dHdpdHRlcl90d2VldF9kZWZhdWx0JywgJHR3ZWV0X2RlZmF1bHQsICcnLCAnYXJjX3R3aXR0
ZXJfdHdlZXRfZGVmYXVsdCcpKQogICAgICAgICAgICAgICAgKS50cigKICAgICAgICAgICAg
ICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX3VybF9tZXRob2QiPlVSTCBz
aG9ydG5lcjwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4
dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAg
ICAgICAgICAgLnRkKGFyY190d2l0dGVyX3VybF9tZXRob2Rfc2VsZWN0KCdhcmNfdHdpdHRl
cl91cmxfbWV0aG9kJywkdXJsX21ldGhvZCkpCiAgICAgICAgICAgICAgICApLnRyKAogICAg
ICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdUWFAgVHdlZXQgc2hvcnQgVVJMJywgMiksMikK
ICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAg
ICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY19zaG9ydF91cmwiPkVuYWJsZSBUWFAgVHdlZXQg
c2hvcnQgVVJMIHJlZGlyZWN0PC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAn
IHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykK
ICAgICAgICAgICAgICAgICAgICAudGQoeWVzbm9SYWRpbygnYXJjX3Nob3J0X3VybCcsICRz
aG9ydF91cmwsICcnLCAnYXJjX3Nob3J0X3VybCcpKSwKICAgICAgICAgICAgICAgICAgICAn
IGlkPSJhcmNfc2hvcnRfdXJsLW9uX29mZiInCiAgICAgICAgICAgICAgICApLnRyKAogICAg
ICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3Nob3J0X3NpdGVfdXJsIj5U
WFAgVHdlZXQgc2hvcnQgc2l0ZSBVUkw8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAg
ICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxl
OyInKQogICAgICAgICAgICAgICAgICAgIC50ZChmSW5wdXQoJ3RleHQnLCdhcmNfc2hvcnRf
c2l0ZV91cmwnLCRzaG9ydF9zaXRlX3VybCwnJywnJywnJywnJywnJywnYXJjX3Nob3J0X3Np
dGVfdXJsJykpLAogICAgICAgICAgICAgICAgICAgICcgaWQ9ImFyY19zaG9ydF9zaXRlX3Vy
bC1vcHRpb24iJwogICAgICAgICAgICAgICAgKS50cigKICAgICAgICAgICAgICAgICAgICB0
ZGNzKGhlZCgnVHdpdHRlciB0YWInLCAyKSwyKQogICAgICAgICAgICAgICAgKS50cigKICAg
ICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX3RhYiI+TG9j
YXRpb24gb2YgVHdpdHRlciB0YWI8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAg
ICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyIn
KQogICAgICAgICAgICAgICAgICAgIC50ZChhcmNfdHdpdHRlcl90YWJfc2VsZWN0KCdhcmNf
dHdpdHRlcl90YWInLCR0YWIpKQogICAgICAgICAgICAgICAgKS50cigKICAgICAgICAgICAg
ICAgICAgICB0ZGNzKGhlZCgnQ2FjaGUnLCAyKSwyKQogICAgICAgICAgICAgICAgKQogICAg
ICAgICAgICAgICAgLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0i
YXJjX3R3aXR0ZXJfY2FjaGVfZGlyIj5DYWNoZSBkaXJlY3Rvcnk8L2xhYmVsPicsCiAgICAg
ICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNh
bC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50ZChmSW5wdXQoJ3Rl
eHQnLCdhcmNfdHdpdHRlcl9jYWNoZV9kaXInLCRjYWNoZV9kaXIsJycsJycsJycsJycsJycs
J2FyY190d2l0dGVyX2NhY2hlX2RpcicpKQogICAgICAgICAgICAgICAgKQogICAgICAgICAg
ICAgICAgLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgKICAgICAgICAgICAgICAgICAg
ICAgICAgZklucHV0KCdzdWJtaXQnLCAnU3VibWl0JywgZ1R4dCgnc2F2ZV9idXR0b24nKSwg
J3B1Ymxpc2gnKQogICAgICAgICAgICAgICAgICAgICAgICAubi5zSW5wdXQoJ3ByZWZzX3Nh
dmUnKQogICAgICAgICAgICAgICAgICAgICAgICAubi5lSW5wdXQoJ3BsdWdpbl9wcmVmcy5h
cmNfdHdpdHRlcicpCiAgICAgICAgICAgICAgICAgICAgLCAnIGNvbHNwYW49IjIiIGNsYXNz
PSJub2xpbmUiJykpKQogICAgICAgICAgICAgICAgLmVuZFRhYmxlKCk7CiAgICAgICAgfSBl
bHNlaWYgKCAkc3RlcCE9J3JlZ2lzdGVyJyApIHsKICAgICAgICAgICAgJHJlZ2lzdGVyVVJM
ID0gYXJjX3R3aXR0ZXI6OmNhbGxiYWNrVVJMKCRldmVudCwncmVnaXN0ZXInKTsKICAgICAg
ICAgICAgJGh0bWwuPSBzdGFydFRhYmxlKCdsaXN0JykuZm9ybSgKICAgICAgICAgICAgICAg
IHRyKAogICAgICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdUd2l0dGVyIGFjY291bnQgZGV0
YWlscycsIDIpLDIpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAg
ICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl91c2VyIj5U
d2l0dGVyIHVzZXJuYW1lPC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0
eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAg
ICAgICAgICAgICAgICAgICAudGQoCiAgICAgICAgICAgICAgICAgICAgICAgICgnPGVtPnVu
a25vd248L2VtPiAoJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmhyZWYoJ0Nvbm5l
Y3QgdG8gVHdpdHRlcicsJHJlZ2lzdGVyVVJMKS4nKScpCiAgICAgICAgICAgICAgICApKSkK
ICAgICAgICAgICAgICAgIC5lbmRUYWJsZSgpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBT
ZXQgalF1ZXJ5IGZvciBzd2l0Y2hpbmcgb24vb2ZmIHJlbGV2YW50IGFyY19zaG9ydF91cmwg
ZmllbGRzCiAgICAkanMgPSA8PDxKUwo8c2NyaXB0IGxhbmd1YWdlPSJqYXZhc2NyaXB0IiB0
eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPgokKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpewog
IHZhciBvbm9mZiA9ICQoJyNhcmNfc2hvcnRfdXJsLW9uX29mZicpOwogIHZhciBhcmNfc2hv
cnRfdXJsX29mZiA9ICQoJyNhcmNfc2hvcnRfdXJsLWFyY19zaG9ydF91cmwtMCcpOwogIHZh
ciB1cmwgPSAkKCcjYXJjX3Nob3J0X3NpdGVfdXJsLW9wdGlvbicpOwogIHZhciB1cmxfbWV0
aG9kID0gJCgnc2VsZWN0W25hbWU9ImFyY190d2l0dGVyX3VybF9tZXRob2QiXScpOwoKICBp
ZiAoYXJjX3Nob3J0X3VybF9vZmYuYXR0cignY2hlY2tlZCcpPT10cnVlCiAgJiYgJCgnb3B0
aW9uOnNlbGVjdGVkJywgdXJsX21ldGhvZCkudmFsKCkhPSdhcmNfdHdpdHRlcicpIHsKICAg
IHVybC5oaWRlKCk7CiAgfQogICQoJ2lucHV0Jywgb25vZmYpLmNoYW5nZShmdW5jdGlvbigp
ewogICAgaWYgKCQoJ29wdGlvbjpzZWxlY3RlZCcsIHVybF9tZXRob2QpLnZhbCgpIT0nYXJj
X3R3aXR0ZXInKSB7CiAgICAgIGFyY19zaG9ydF91cmxfb2ZmLmF0dHIoJ2NoZWNrZWQnKT09
dHJ1ZSA/IHVybC5oaWRlKCkgOiB1cmwuc2hvdygpOwogICAgfQogIH0pOwoKICBpZiAoJCgn
b3B0aW9uOnNlbGVjdGVkJywgdXJsX21ldGhvZCkudmFsKCk9PSdhcmNfdHdpdHRlcicpIHsK
ICAgIG9ub2ZmLmhpZGUoKTsgdXJsLnNob3coKTsKICB9CiAgdXJsX21ldGhvZC5jaGFuZ2Uo
ZnVuY3Rpb24oKXsKICAgIGlmICgkKCdvcHRpb246c2VsZWN0ZWQnLCB1cmxfbWV0aG9kKS52
YWwoKT09J2FyY190d2l0dGVyJykgewogICAgICBvbm9mZi50b2dnbGUoKTsgdXJsLnNob3co
KTsKICAgIH0gZWxzZSB7CiAgICAgIG9ub2ZmLnRvZ2dsZSgpOwogICAgICBhcmNfc2hvcnRf
dXJsX29mZi5hdHRyKCdjaGVja2VkJyk9PXRydWUgPyB1cmwuaGlkZSgpIDogdXJsLnNob3co
KTsKICAgIH0KICB9KQp9KTsKPC9zY3JpcHQ+CkpTOwoKICAgIGVjaG8gJGpzLiRodG1sOwp9
CgovLyBBZGQgVHdpdHRlciB0YWIgdG8gVGV4dHBhdHRlcm4KZnVuY3Rpb24gYXJjX2FkbWlu
X3R3aXR0ZXIoJGV2ZW50LCRzdGVwKQp7CiAgICBnbG9iYWwgJHByZWZzLCAkYXJjX3R3aXR0
ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiAgICAkdHdp
dCA9IG5ldyBhcmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAg
ICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJf
YWNjZXNzVG9rZW4nXQogICAgICAgICAgICAsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNz
VG9rZW5TZWNyZXQnXSk7CgogICAgJHR3aXQtPmNhY2hlRGlyKCRwcmVmc1snYXJjX3R3aXR0
ZXJfY2FjaGVfZGlyJ10pOwoKICAgICR4bWwgPSAkdHdpdC0+Z2V0KCd1c2Vycy9zaG93Jwog
ICAgICAgICwgYXJyYXkoJ3NjcmVlbl9uYW1lJz0+JHByZWZzWydhcmNfdHdpdHRlcl91c2Vy
J10pKTsKICAgICR0d2l0dGVyVXNlciA9IEAkeG1sLT54cGF0aCgnL3VzZXInKTsKICAgICR0
d2l0dGVyVXNlciA9ICR0d2l0dGVyVXNlclswXTsKICAgICR0d2l0dGVyVXNlclVSTCA9ICdo
dHRwOi8vd3d3LnR3aXR0ZXIuY29tLycuJHR3aXR0ZXJVc2VyLT5zY3JlZW5fbmFtZTsKCiAg
ICBpZiAoJHN0ZXA9PSJ0d2VldCIpIHsgLy8gcG9zdCBhbiB1cGRhdGUgdG8gVHdpdHRlcgoK
ICAgICAgICAvLyBmZXRjaCBhbmQgY2xlYW4gbWVzc2FnZQogICAgICAgICRtZXNzYWdlID0g
c3RyaXBfdGFncyhncHMoJ21lc3NhZ2UnKSk7CiAgICAgICAgJGNvdW50ID0gc3RybGVuKCRt
ZXNzYWdlKTsKCiAgICAgICAgaWYgKCRjb3VudDw9MTQwICYmICRjb3VudD4wKSB7IC8vIHBv
c3QgdXBkYXRlCiAgICAgICAgICAgICRyZXN1bHQgPSAkdHdpdC0+cG9zdCgnc3RhdHVzZXMv
dXBkYXRlJywgYXJyYXkoJ3N0YXR1cycgPT4gJG1lc3NhZ2UpKTsKICAgICAgICB9IGVsc2Ug
eyAvLyBtZXNzYWdlIHRvbyBsb25nLCBKYXZhU2NyaXB0IGludGVyZmFjZSBzaG91bGQgcHJl
dmVudCB0aGlzCiAgICAgICAgICAgICRyZXN1bHQgPSBmYWxzZTsKICAgICAgICB9CgogICAg
ICAgIHBhZ2V0b3AoJ1R3aXR0ZXInLAogICAgICAgICAgICAoKCRyZXN1bHQhPWZhbHNlKT8n
VHdpdHRlciB1cGRhdGVkJzonRXJyb3IgdXBkYXRpbmcgVHdpdHRlcicpKTsKCiAgICB9IGVs
c2VpZiAoJHN0ZXA9PSJkZWxldGUiKSB7IC8vIGRlbGV0ZSBhbiB1cGRhdGUgZnJvbSBUd2l0
dGVyCgogICAgICAgICRpZCA9IHN0cmlwX3RhZ3MoZ3BzKCdpZCcpKTsKICAgICAgICBpZiAo
JGlkKSB7CiAgICAgICAgICAgICR0d2l0LT5kZWxldGUoJ3N0YXR1c2VzL2Rlc3Ryb3knLiRp
ZCk7CiAgICAgICAgICAgIHNhZmVfZGVsZXRlKCdhcmNfdHdpdHRlcicsInR3ZWV0X2lkID0g
JGlkIik7CiAgICAgICAgfQoKICAgICAgICBwYWdldG9wKCdUd2l0dGVyJywnVHdpdHRlciB1
cGRhdGVkJyk7CgogICAgfSBlbHNlIHsKCiAgICAgICAgcGFnZXRvcCgnVHdpdHRlcicpOwoK
ICAgIH0KCiAgICAvLyBQcmVwYXJlIEphdmFTY3JpcHQgdG8gY3JlYXRlIFR3aXR0ZXIgdXBk
YXRlIGludGVyZmFjZQoKICAgICRqcyA9ICc8c2NyaXB0IGxhbmd1YWdlPSJqYXZhc2NyaXB0
IiB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPic7CiAgICAkanMuPSAiJChkb2N1bWVudCkucmVh
ZHkoZnVuY3Rpb24oKXsKICAgICAgICAgICAgdmFyIGNvdW50ZXJTdHlsZSA9ICdmb250LXdl
aWdodDpib2xkO2Zsb2F0OnJpZ2h0O2ZvbnQtc2l6ZToyZW07bGluZS1oZWlnaHQ6MS4yZW07
JzsKICAgICAgICAgICAgJCgnI3R3ZWV0Y291bnQnKS5hdHRyKCdzdHlsZScsIGNvdW50ZXJT
dHlsZSsnY29sb3I6I2NjYzsnKTsKICAgICAgICAgICAgJCgnI21lc3NhZ2UnKS5rZXl1cChm
dW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHZhciBjb3VudCA9IDE0MC0kKCcjbWVzc2Fn
ZScpLnZhbCgpLmxlbmd0aDsKICAgICAgICAgICAgICAgICQoJyN0d2VldGNvdW50JykuaHRt
bChjb3VudCsnJyk7IC8vIGhhY2sgdG8gZm9yY2Ugb3V0cHV0IG9mIDAKICAgICAgICAgICAg
ICAgIGlmIChjb3VudDwwKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnaW5wdXQucHVibGlz
aCcpLmF0dHIoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7CiAgICAgICAgICAgICAgICB9IGVs
c2UgewogICAgICAgICAgICAgICAgICAgICQoJ2lucHV0LnB1Ymxpc2gnKS5hdHRyKCdkaXNh
YmxlZCcsICcnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChjb3Vu
dDwwKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnI3R3ZWV0Y291bnQnKS5hdHRyKCdzdHls
ZScsIGNvdW50ZXJTdHlsZSsnY29sb3I6I2YwMDsnKTsKICAgICAgICAgICAgICAgIH0gZWxz
ZSBpZiAoY291bnQ8MTApIHsKICAgICAgICAgICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcp
LmF0dHIoJ3N0eWxlJywgY291bnRlclN0eWxlKydjb2xvcjojMDAwOycpOwogICAgICAgICAg
ICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0
dHIoJ3N0eWxlJywgY291bnRlclN0eWxlKydjb2xvcjojY2NjOycpOwogICAgICAgICAgICAg
ICAgfQogICAgICAgICAgICB9KQogICAgICAgIH0pOyI7CiAgICAkanMuPSAiPC9zY3JpcHQ+
IjsKCiAgICAkb3V0ID0gJyc7CiAgICAkeG1sID0gJHR3aXQtPmdldCgnc3RhdHVzZXMvdXNl
cl90aW1lbGluZScKICAgICAgICAsIGFycmF5KCdzY3JlZW5fbmFtZSc9PiRwcmVmc1snYXJj
X3R3aXR0ZXJfdXNlciddLCdjb3VudCc9PjI1KSk7CiAgICAkdHdlZXRzID0gQCR4bWwtPnhw
YXRoKCcvc3RhdHVzZXMvc3RhdHVzJyk7CiAgICBpZiAoJHR3ZWV0cykgZm9yZWFjaCAoJHR3
ZWV0cyBhcyAkdHdlZXQpIHsKICAgICAgICAkdGltZSA9IHN0cnRvdGltZShodG1sZW50aXRp
ZXMoJHR3ZWV0LT5jcmVhdGVkX2F0KSk7CiAgICAgICAgJGRhdGUgPSBzYWZlX3N0cmZ0aW1l
KCRwcmVmc1snYXJjaGl2ZV9kYXRlZm9ybWF0J10sJHRpbWUpOwogICAgICAgICRvdXQuPSB0
cih0ZCgkZGF0ZSwnc3BhbicpCiAgICAgICAgICAgIC50ZChhcmNfVHdpdHRlcjo6bWFrZUxp
bmtzKGh0bWxlbnRpdGllcygkdHdlZXQtPnRleHQKICAgICAgICAgICAgICAgICwgRU5UX1FV
T1RFUywnVVRGLTgnKSkpCiAgICAgICAgICAgIC50ZChkTGluaygnYXJjX2FkbWluX3R3aXR0
ZXInLCdkZWxldGUnLCdpZCcsJHR3ZWV0LT5pZCwnJykpCiAgICAgICAgICAgICk7CiAgICB9
CgogICAgJGh0bWwgPSBzdGFydFRhYmxlKCdlZGl0JykKICAgICAgICAgICAgLnRyKHRkKAog
ICAgICAgICAgICBncmFmKCc8aW1nIHNyYz0iJy4kdHdpdHRlclVzZXItPnByb2ZpbGVfaW1h
Z2VfdXJsLiciIGFsdD0iVHdpdHRlciBhdmF0YXIiIC8+JwogICAgICAgICAgICAsJyBzdHls
ZT0iZmxvYXQ6bGVmdDtwYWRkaW5nOjJweDsiJykKICAgICAgICAgICAgLmdyYWYoaHJlZigk
dHdpdHRlclVzZXItPm5hbWUsJHR3aXR0ZXJVc2VyVVJMKSwnIHN0eWxlPSJmb250LXNpemU6
MS4yZW07Zm9udC13ZWlnaHQ6Ym9sZDsiJykKICAgICAgICAgICAgLmdyYWYoaHJlZigkdHdp
dHRlclVzZXItPmZyaWVuZHNfY291bnQuJyBmb2xsb3dpbmcnLCR0d2l0dGVyVXNlclVSTC4n
L2ZvbGxvd2luZycpCiAgICAgICAgICAgIC4nLCAnLmhyZWYoJHR3aXR0ZXJVc2VyLT5mb2xs
b3dlcnNfY291bnQuJyBmb2xsb3dlcnMnLCR0d2l0dGVyVXNlclVSTC4nL2ZvbGxvd2Vycycp
CiAgICAgICAgICAgIC4nLCAnLmhyZWYoJHR3aXR0ZXJVc2VyLT5zdGF0dXNlc19jb3VudC4n
IHVwZGF0ZXMnLCR0d2l0dGVyVXNlclVSTCkpKSkKICAgICAgICAgICAgLnRyKHRkKGZvcm0o
CiAgICAgICAgICAgIGdyYWYoIlVwZGF0ZSBUd2l0dGVyLi4uPHNwYW4gaWQ9J3R3ZWV0Y291
bnQnIHN0eWxlPSdmb250LXdlaWdodDpib2xkO2Zsb2F0OnJpZ2h0Oyc+MTQwPC9zcGFuPiIp
CiAgICAgICAgICAgIC50ZXh0X2FyZWEoJ21lc3NhZ2UnLCc1MCcsJzU1MCcsJycsJ21lc3Nh
Z2UnKQogICAgICAgICAgICAuZUlucHV0KCdhcmNfYWRtaW5fdHdpdHRlcicpCiAgICAgICAg
ICAgIC5zSW5wdXQoJ3R3ZWV0JykuYnIKICAgICAgICAgICAgLmZJbnB1dCgnc3VibWl0Jywn
dXBkYXRlJyxnVHh0KCdVcGRhdGUnKSwncHVibGlzaCcpCiAgICAgICAgKSkpCiAgICAgICAg
LmVuZFRhYmxlKCk7CgogICAgLy8gQXR0YWNoIHJlY2VudCBUd2l0dGVyIHVwZGF0ZXMKCiAg
ICAkaHRtbC49IHN0YXJ0VGFibGUoJ2xpc3QnLCcnLCcnLCcnLCc5MCUnKQogICAgICAgIC4k
b3V0CiAgICAgICAgLmVuZFRhYmxlKCk7CgogICAgLy8gT3V0cHV0IEphdmFTY3JpcHQgYW5k
IEhUTUwKCiAgICBlY2hvICRqcy4kaHRtbDsKfQoKLy8gQWRkIFR3aXR0ZXIgb3B0aW9ucyB0
byBhcnRpY2xlIGFydGljbGUgc2NyZWVuCmZ1bmN0aW9uIGFyY19hcHBlbmRfdHdpdHRlcigk
ZXZlbnQsICRzdGVwLCAkZGF0YSwgJHJzMSkKewogICAgZ2xvYmFsICRwcmVmcywgJGFyY190
d2l0dGVyOwogICAgJHByZWZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9wcmVmaXgnKSk7
CiAgICAkcHJlZml4ID0gKCRwcmVmaXgpID8gJHByZWZpeCA6ICRwcmVmc1snYXJjX3R3aXR0
ZXJfcHJlZml4J107CiAgICAkc3VmZml4ID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3N1ZmZp
eCcpKTsKICAgICRzdWZmaXggPSAoJHN1ZmZpeCkgPyAkc3VmZml4IDogJHByZWZzWydhcmNf
dHdpdHRlcl9zdWZmaXgnXTsKCiAgICBpZiAoJHJzMVsnSUQnXSkgewogICAgICAgICRzcWwg
PSAiU0VMRUNUIHR3ZWV0X2lkLHR3ZWV0IEZST00gIi5QRlguImFyY190d2l0dGVyIFdIRVJF
IGFydGljbGVfaWQ9Ii4kcnMxWydJRCddLiI7IjsKICAgICAgICAkcnMyID0gc2FmZV9xdWVy
eSgkc3FsKTsgJHJzMiA9IG5leHRSb3coJHJzMik7CiAgICB9IGVsc2UgeyAvLyBuZXcgYXJ0
aWNsZQogICAgICAgICRyczIgPSAnJzsKICAgIH0KCiAgICBpZiAoJHJzMVsnSUQnXSAmJiAk
cnMyWyd0d2VldF9pZCddKSB7CiAgICAgICAgJGNvbnRlbnQgPSBhcmNfVHdpdHRlcjo6bWFr
ZUxpbmtzKCRyczJbJ3R3ZWV0J10pOwogICAgICAgIHJldHVybiAkZGF0YS5maWVsZHNldCgk
Y29udGVudCwgJ1R3aXR0ZXIgdXBkYXRlJywgJ2FyY190d2l0dGVyJyk7CiAgICB9IGVsc2Ug
ewogICAgICAgICR2YXIgPSBncHMoJ2FyY190d2VldF90aGlzJyk7CiAgICAgICAgJHZhciA9
ICgkcnMxWydJRCddJiYhJHZhcikgPyAwIDogJHByZWZzWydhcmNfdHdpdHRlcl90d2VldF9k
ZWZhdWx0J107CiAgICAgICAgJGNvbnRlbnQgID0gdGFnKHllc25vUmFkaW8oJ2FyY190d2Vl
dF90aGlzJywgJHZhciwgJycsICdhcmNfdHdlZXRfdGhpcycpLCdwJyk7CiAgICAgICAgJGNv
bnRlbnQgLj0gdGFnKGhyZWYoJ09wdGlvbnMnLCcjYXJjX3R3aXR0ZXJfb3B0aW9ucycpLCdw
JywnIGNsYXNzPSJwbGFpbiBsZXZlciIgc3R5bGU9Im1hcmdpbi10b3A6NXB4OyInKTsKICAg
ICAgICAkY29udGVudCAuPSB0YWcodGFnKHRhZygnVHdlZXQgcHJlZml4JywnbGFiZWwnLCAn
IGZvcj0iYXJjX3R3aXR0ZXJfcHJlZml4IicpCiAgICAgICAgICAgIC5mSW5wdXQoJ3RleHQn
LCdhcmNfdHdpdHRlcl9wcmVmaXgnLCRwcmVmaXgsJ2VkaXQnLCcnLCcnLCcyMicsJycsJ2Fy
Y190d2l0dGVyX3ByZWZpeCcpLCdwJykKICAgICAgICAgICAgLnRhZyh0YWcoJ1R3ZWV0IHN1
ZmZpeCAoZWcgI2hhc2h0YWdzKScsJ2xhYmVsJywgJyBmb3I9ImFyY190d2l0dGVyX3N1ZmZp
eCInKQogICAgICAgICAgICAuZklucHV0KCd0ZXh0JywnYXJjX3R3aXR0ZXJfc3VmZml4Jywk
c3VmZml4LCdlZGl0JywnJywnJywnMjInLCcnLCdhcmNfdHdpdHRlcl9zdWZmaXgnKSwncCcp
CiAgICAgICAgICAgICwnZGl2JywnIGlkPSJhcmNfdHdpdHRlcl9vcHRpb25zIiBjbGFzcz0i
dG9nZ2xlIiBzdHlsZT0iZGlzcGxheTpub25lIicpOwogICAgICAgIGlmIChpc3NldCgkYXJj
X3R3aXR0ZXJbJ2Vycm9yJ10pKSB7CiAgICAgICAgICAgICRjb250ZW50IC49ICc8cD4nLiRh
cmNfdHdpdHRlclsnZXJyb3InXS4nPC9wPic7CiAgICAgICAgfQogICAgICAgIHJldHVybiAk
ZGF0YS5maWVsZHNldCgkY29udGVudCwgJ1VwZGF0ZSBUd2l0dGVyJywgJ2FyY190d2l0dGVy
Jyk7CiAgICB9Cgp9CgovLyBVcGRhdGUgVHdpdHRlciB3aXRoIHBvc3RlZCBhcnRpY2xlCmZ1
bmN0aW9uIGFyY19hcnRpY2xlX3R3ZWV0KCRldmVudCwkc3RlcCkKewogICAgZ2xvYmFsICRw
cmVmcywgJGFyY190d2l0dGVyLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAs
ICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiAgICAkYXJ0aWNsZV9pZCA9IGVtcHR5
KCRHTE9CQUxTWydJRCddKSA/IGdwcygnSUQnKSA6ICRHTE9CQUxTWydJRCddOwogICAgaWYg
KCFlbXB0eSgkYXJ0aWNsZV9pZCkpIHsKCiAgICAgICAgaW5jbHVkZV9vbmNlIHR4cGF0aC4n
L3B1Ymxpc2gvdGFnaGFuZGxlcnMucGhwJzsKCiAgICAgICAgJGFydGljbGUgPSBzYWZlX3Jv
dygiSUQsIFRpdGxlLCBTZWN0aW9uLCBQb3N0ZWQiLCAndGV4dHBhdHRlcm4nLAogICAgICAg
ICAgICAiSUQ9eyRhcnRpY2xlX2lkfSBBTkQgU3RhdHVzPTQgQU5EIG5vdygpPj1Qb3N0ZWQi
KTsKCiAgICAgICAgaWYgKCRhcnRpY2xlICYmIGdwcygnYXJjX3R3ZWV0X3RoaXMnKSkgeyAv
LyB0d2VldCBhcnRpY2xlCgogICAgICAgICAgICAvLyBOZWVkIHRvIG1hbnVhbGx5IHVwZGF0
ZSB0aGUgJ1VSTCBvbmx5IHRpdGxlJyBiZWZvcmUgYnVpbGRpbmcgdGhlCiAgICAgICAgICAg
IC8vIFVSTAogICAgICAgICAgICAkYXJ0aWNsZVsndXJsX3RpdGxlJ10gPSBncHMoJ3VybF90
aXRsZScpOwogICAgICAgICAgICAvLyBNYWtlIHNob3J0IFVSTAogICAgICAgICAgICAkdXJs
ID0gcGVybWxpbmt1cmwoJGFydGljbGUpOwogICAgICAgICAgICAkc2hvcnRfdXJsID0gYXJj
X3Nob3J0ZW5fdXJsKCR1cmwsJHByZWZzWydhcmNfdHdpdHRlcl91cmxfbWV0aG9kJ10sCiAg
ICAgICAgICAgICAgICBhcnJheSgnaWQnPT4kYXJ0aWNsZV9pZCkpOwoKICAgICAgICAgICAg
aWYgKCEkc2hvcnRfdXJsKSB7IC8vIEZhaWxlZCB0byBvYnRhaW4gYSBzaG9ydGVuZWQgVVJM
LCBkbyBub3QgdHdlZXQhCiAgICAgICAgICAgICAgICAkYXJjX3R3aXR0ZXJbJ2Vycm9yJ10g
PSAnVW5hYmxlIHRvIG9idGFpbiBhIHNob3J0IFVSTCBmb3IgdGhpcyBhcnRpY2xlLic7Cgog
ICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAg
ICAvLyBDb25zdHJ1Y3QgVHdpdHRlciB1cGRhdGUKICAgICAgICAgICAgJHByZWZpeCAgPSB0
cmltKGdwcygnYXJjX3R3aXR0ZXJfcHJlZml4JykpOwogICAgICAgICAgICAkcHJlX2xlbiA9
IHN0cmxlbigkcHJlZml4KTsKICAgICAgICAgICAgJHByZWZpeCAgPSAoJHByZWZpeCAmJiAk
cHJlX2xlbjw9MjApID8gJHByZWZpeC4nICcgOiAnJzsKICAgICAgICAgICAgJHN1ZmZpeCAg
PSB0cmltKGdwcygnYXJjX3R3aXR0ZXJfc3VmZml4JykpOwogICAgICAgICAgICAkc3VmX2xl
biA9IHN0cmxlbigkc3VmZml4KTsKICAgICAgICAgICAgJHN1ZmZpeCAgPSAoJHN1ZmZpeCAm
JiAkc3VmX2xlbjw9NDApID8gJyAnLiRzdWZmaXggOiAnJzsKICAgICAgICAgICAgJHVybF9s
ZW4gPSBzdHJsZW4oJHNob3J0X3VybCkrMTsgLy8gY291bnQgVVJMIGxlbmd0aCArIDEgZm9y
IHByZWZpeGVkIHNwYWNlCiAgICAgICAgICAgIGlmICgkcHJlZml4KSAkcHJlX2xlbiArPSAx
OwogICAgICAgICAgICBpZiAoJHN1ZmZpeCkgJHN1Zl9sZW4gKz0gMTsKICAgICAgICAgICAg
aWYgKChzdHJsZW4oJGFydGljbGVbJ1RpdGxlJ10pKyR1cmxfbGVuKyRwcmVfbGVuKyRzdWZf
bGVuKT4xNDApIHsKICAgICAgICAgICAgICAgICRhcnRpY2xlWydUaXRsZSddID0gc3Vic3Ry
KCRhcnRpY2xlWydUaXRsZSddLDAsMTM1LSR1cmxfbGVuLSRwcmVfbGVuLSRzdWZfbGVuKS4n
Li4uJzsKICAgICAgICAgICAgfQogICAgICAgICAgICAkdHdlZXQgPSAkcHJlZml4LiRhcnRp
Y2xlWydUaXRsZSddLiIgIi4kc2hvcnRfdXJsLiRzdWZmaXg7CgogICAgICAgICAgICAvLyBV
cGRhdGUgVHdpdHRlcgogICAgICAgICAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJj
X3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgICAgICwgJGFyY190d2l0dGVyX2Nv
bnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10KICAgICAg
ICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKTsK
ICAgICAgICAgICAgJHJlc3VsdCA9ICR0d2l0LT5wb3N0KCdzdGF0dXNlcy91cGRhdGUnLCBh
cnJheSgnc3RhdHVzJyA9PiAkdHdlZXQpKTsKCiAgICAgICAgICAgICR0d2VldF9pZCA9IChp
c19vYmplY3QoJHJlc3VsdCkpID8gJHJlc3VsdFswXS0+aWQgOiAwOwoKICAgICAgICAgICAg
aWYgKCR0d2VldF9pZCkgewoKICAgICAgICAgICAgICAgICR0d2VldCA9IGFkZHNsYXNoZXMo
JHR3ZWV0KTsKCiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgYXJjX3R3aXR0ZXIgdGFibGUg
d2l0aCB0d2VldAogICAgICAgICAgICAgICAgJHNxbCA9ICJJTlNFUlQgSU5UTyAiLlBGWC4i
YXJjX3R3aXR0ZXIgKGFydGljbGVfaWQsdHdlZXRfaWQsdHdlZXQsdGlueXVybCkgIjsKICAg
ICAgICAgICAgICAgICRzcWwuPSAiVkFMVUVTKCRhcnRpY2xlX2lkLCR0d2VldF9pZCxcIiR0
d2VldFwiLCckc2hvcnRfdXJsJyk7IjsKICAgICAgICAgICAgICAgIHNhZmVfcXVlcnkoJHNx
bCk7CgogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICAgICAgICB9IGVsc2Ug
ewoKICAgICAgICAgICAgICAgICRhcmNfdHdpdHRlclsnZXJyb3InXSA9ICdUd2l0dGVyIHJl
c3BvbnNlOiAnCiAgICAgICAgICAgICAgICAgICAgLiR0d2l0LT5odHRwX2NvZGU7CiAgICAg
ICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICB9CgogICAgICAgIH0KCiAg
ICB9CgogICAgcmV0dXJuIGZhbHNlOwoKfQoKLyoKICogU2hvcnRlbiBVUkxzIHVzaW5nIHZh
cmlvdXMgbWV0aG9kcwogKi8KCmZ1bmN0aW9uIGFyY19zaG9ydGVuX3VybCgkdXJsLCAkbWV0
aG9kPScnLCAkYXR0cz1hcnJheSgpKQp7CiAgZ2xvYmFsICRwcmVmczsKCiAgJGNoID0gY3Vy
bF9pbml0KCk7CiAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX0hFQURFUiwgMCk7CiAgY3Vy
bF9zZXRvcHQoJGNoLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCB0cnVlKTsKICBjdXJsX3Nl
dG9wdCgkY2gsIENVUkxPUFRfVElNRU9VVCwgMTApOwoKICBzd2l0Y2ggKCRtZXRob2QpIHsK
ICAgIGNhc2UgJ3NtZCc6IC8vIGNyZWF0ZSBhIHNob3J0ZW5lZCBVUkwgdXNpbmcgU01EIFNo
b3J0IFVSTAogICAgICByZXR1cm4gKCRhdHRzWydpZCddKSA/IGh1LiRhdHRzWydpZCddIDog
ZmFsc2U7IGJyZWFrOwogICAgY2FzZSAnYXJjX3R3aXR0ZXInOiAvLyBuYXRpdmUgVVJMIHNo
b3J0ZW5pbmcKCiAgICAgIHJldHVybiAoJGF0dHNbJ2lkJ10pID8gUFJPVE9DT0wuJHByZWZz
WydhcmNfc2hvcnRfc2l0ZV91cmwnXS4nLycuJGF0dHNbJ2lkJ10gOiBmYWxzZTsKICAgICAg
YnJlYWs7CgogICAgY2FzZSAnaXNnZCc6CgogICAgICAkdSA9ICdodHRwOi8vaXMuZ2QvYXBp
LnBocD9sb25ndXJsPScudXJsZW5jb2RlKCR1cmwpOwogICAgICBjdXJsX3NldG9wdCgkY2gs
IENVUkxPUFRfVVJMLCAkdSk7CgogICAgICAkdGlueXVybCA9IGN1cmxfZXhlYygkY2gpOwog
ICAgICBpZiAoJHRpbnl1cmwhPSdFcnJvcicgJiYgJHRpbnl1cmwhPScnKSB7CiAgICAgICAg
cmV0dXJuICR0aW55dXJsOwogICAgICB9IGVsc2UgewogICAgICAgIHRyaWdnZXJfZXJyb3Io
J2FyY190d2l0dGVyIGZhaWxlZCB0byBnZXQgYSBpcy5nZCBVUkwgZm9yICcKICAgICAgICAg
ICAgLiR1cmwsRV9VU0VSX1dBUk5JTkcpOwogICAgICB9CiAgICAgIGJyZWFrOwoKICAgIGNh
c2UgJ3Rpbnl1cmwnOiBkZWZhdWx0OiAvLyBjcmVhdGUgYSBzaG9ydGVuZWQgVVJMIHVzaW5n
IFRpbnlVUkwKCiAgICAgICR1ID0gJ2h0dHA6Ly90aW55dXJsLmNvbS9hcGktY3JlYXRlLnBo
cD91cmw9Jy51cmxlbmNvZGUoJHVybCk7CiAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9Q
VF9VUkwsICR1KTsKICAgICAgJHRpbnl1cmwgPSBjdXJsX2V4ZWMoJGNoKTsKICAgICAgaWYg
KCR0aW55dXJsIT0nRXJyb3InICYmICR0aW55dXJsIT0nJykgewogICAgICAgIHJldHVybiAk
dGlueXVybDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0cmlnZ2VyX2Vycm9yKCdhcmNfdHdp
dHRlciBmYWlsZWQgdG8gZ2V0IGEgVGlueVVSTCBmb3IgJy4kdXJsLEVfVVNFUl9XQVJOSU5H
KTsKICAgICAgfQoKICB9CgogIHJldHVybiBmYWxzZTsgLy8gZmFpbAoKfQoKLyoKICogU2hv
cnRlbmVkIFVSTCByZWRpcmVjdCBiYXNlZCBvbiBzbWRfc2hvcnRfdXJsCiAqLwpmdW5jdGlv
biBhcmNfc2hvcnRfdXJsX3JlZGlyZWN0KCRldmVudCwgJHN0ZXApIHsKICBnbG9iYWwgJHBy
ZWZzOwoKICAkaGF2ZV9pZCA9IDA7CgogIC8vIENoZWNrIGlmIHRoZXJlIGlzIGFuIGF2YWls
YWJsZSBzaG9ydCBzaXRlIHVybCBhbmQgaWYgaXQgaXMgYmVpbmcgdXNlZCBpbgogIC8vIHRo
aXMgaW5zdGFuY2UKICAkc2hvcnRfc2l0ZV91cmwgPSAkcHJlZnNbJ2FyY19zaG9ydF9zaXRl
X3VybCddOwogIGlmICgkc2hvcnRfc2l0ZV91cmwpIHsKICAgICRzaG9ydF9zaXRlX3VybCA9
IFBST1RPQ09MLiRzaG9ydF9zaXRlX3VybC4nLyc7CiAgICAkdXJsX3BhcnRzID0gcGFyc2Vf
dXJsKCRzaG9ydF9zaXRlX3VybCk7CiAgICAkcmUgPSAnI14nLiR1cmxfcGFydHNbJ3BhdGgn
XS4nKFswLTldLiopIyc7CiAgICAkaGF2ZV9pZCA9IHByZWdfbWF0Y2goJHJlLCAkX1NFUlZF
UlsnUkVRVUVTVF9VUkknXSwgJG0pOwogIH0KCiAgLy8gRmFsbCBiYWNrIHRvIHN0YW5kYXJk
IHNpdGUgdXJsIChzbWRfc2hvcnRfdXJsIGJlaGF2aW91cikKICBpZiAoJGhhdmVfaWQpIHsK
ICAgICR1cmxfcGFydHMgPSBwYXJzZV91cmwoaHUpOwogICAgJHJlID0gJyNeJy4kdXJsX3Bh
cnRzWydwYXRoJ10uJyhbMC05XS4qKSMnOwogICAgJGhhdmVfaWQgPSBwcmVnX21hdGNoKCRy
ZSwgJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ10sICRtKTsKICB9CgogIC8vIERvIHRoZSByZWRp
cmVjdCBpZiB3ZSd2ZSBnb3QgYW4gYXJ0aWNsZSBpZAogIGlmICgkaGF2ZV9pZCkgewoJICAk
aWQgPSAkbVsxXTsKCSAgJHBlcm1saW5rID0gcGVybWxpbmt1cmxfaWQoJGlkKTsKCgkgIGlm
ICgkcGVybWxpbmspIHsKCQkgIG9iX2VuZF9jbGVhbigpOwoKCQkgIC8vIFN0dXBpZCwgb3Zl
ciB0aGUgdG9wIGhlYWRlciBzZXR0aW5nIGZvciBJRQoJCSAgaGVhZGVyKCJTdGF0dXM6IDMw
MSIpOwoJCSAgaGVhZGVyKCJIVFRQLzEuMCAzMDEgTW92ZWQgUGVybWFuZW50bHkiKTsKCQkg
IGhlYWRlcigiTG9jYXRpb246ICIuJHBlcm1saW5rLCBUUlVFLCAzMDEpOwoKCQkgIC8vIElu
IGNhc2UgdGhlIGhlYWRlcigpIG1ldGhvZCBmYWlscywgZmFsbCBiYWNrIG9uIGEgY2xhc3Np
YyByZWRpcmVjdAoJCSAgZWNobyAnPGh0bWw+PGhlYWQ+PE1FVEEgSFRUUC1FUVVJVj0iUmVm
cmVzaCIgQ09OVEVOVD0iMDtVUkw9JwoJCSAgICAuJHBlcm1saW5rLiciPjwvaGVhZD48Ym9k
eT48L2JvZHk+PC9odG1sPic7CgkJICBkaWUoKTsKCSAgfQogIH0KCn0KCi8qCiAqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqCiovCgpjbGFzcyBhcmNfdHdpdHRlciBleHRlbmRzIFR3aXR0
ZXJPQXV0aCB7CiAgICAvLyBDYWNoaW5nIHZhcmlhYmxlcwogICAgcHJpdmF0ZSAkX2NhY2hl
ID0gdHJ1ZTsKICAgIHByaXZhdGUgJF9jYWNoZV9kaXIgPSAnLi90bXAnOwogICAgcHJpdmF0
ZSAkX2NhY2hlX3RpbWUgPSAxODAwOyAvLyAzMCBtaW51dGUgY2FjaGUKCiAgICBmdW5jdGlv
biBfX2NvbnN0cnVjdCgkY29uc3VtZXJfa2V5LCAkY29uc3VtZXJfc2VjcmV0LCAkb2F1dGhf
dG9rZW4gPSBOVUxMCiAgICAgICAgLCAkb2F1dGhfdG9rZW5fc2VjcmV0ID0gTlVMTCkKICAg
IHsKICAgICAgICBwYXJlbnQ6Ol9fY29uc3RydWN0KCRjb25zdW1lcl9rZXksICRjb25zdW1l
cl9zZWNyZXQsICRvYXV0aF90b2tlbgogICAgICAgICAgICAsICRvYXV0aF90b2tlbl9zZWNy
ZXQpOwogICAgICAgICR0aGlzLT5mb3JtYXQgPSAneG1sJzsKICAgICAgICAkdGhpcy0+dGlt
ZW91dCA9IDE1OwogICAgICAgICR0aGlzLT5jb25uZWN0dGltZW91dCA9IDE1OwogICAgfQoK
ICAgIHB1YmxpYyBmdW5jdGlvbiBjYWxsYmFja1VSTCgkZXZlbnQsJHN0ZXApCiAgICB7CiAg
ICAgICAgcmV0dXJuIHByZWdfcmVwbGFjZSgnL1w/LiovJywgJycsUFJPVE9DT0wuJF9TRVJW
RVJbJ1NFUlZFUl9OQU1FJ10uJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ10pCiAgICAgICAgICAu
Jz9ldmVudD0nLiRldmVudC4nJmFtcDtzdGVwPScuJHN0ZXA7CiAgICB9CgogICAgLy8gY3Jl
YXRlIFR3aXR0ZXIgYW5kIGV4dGVybmFsIGxpbmtzIGluIHRleHQKICAgIHB1YmxpYyBzdGF0
aWMgZnVuY3Rpb24gbWFrZUxpbmtzKCR0ZXh0KQogICAgewogICAgICAgICR1cmwgPSAnL1xi
KGh0dHB8aHR0cHN8ZnRwKTpcL1wvKFtBLVowLTldW0EtWjAtOV8tXSooPzpcLltBLVowLTld
W0EtWjAtOV8tXSopKyk6PyhcZCspP1wvPyhbXC9cdytcLl0rKVxiL2knOwogICAgICAgICR0
ZXh0ID0gcHJlZ19yZXBsYWNlKCR1cmwsICI8YSBocmVmPSckMCc+JDA8L2E+IiwgJHRleHQp
OwogICAgICAgICR1cmwgPSAnL1xiKF58XHMpd3d3LihbYS16X0EtWjAtOV0rKSgoXC5bYS16
XSspKylcYi9pJzsKICAgICAgICAkdGV4dCA9IHByZWdfcmVwbGFjZSgkdXJsLCAiPGEgaHJl
Zj0naHR0cDovL3d3dy4kMiQzJz53d3cuJDIkMzwvYT4iLCAkdGV4dCk7CiAgICAgICAgJHRl
eHQgPSBwcmVnX3JlcGxhY2UoIi8oXnxccylAKFthLXpfQS1aMC05XSspLyIsCiAgICAgICAg
ICAgICIkMUA8YSBocmVmPSdodHRwOi8vdHdpdHRlci5jb20vJDInPiQyPC9hPiIsJHRleHQp
OwogICAgICAgICR0ZXh0ID0gcHJlZ19yZXBsYWNlKCIvKF58XHMpKFwjKFthLXpfQS1aMC05
Ol8tXSspKS8iLAogICAgICAgICAgICAiJDE8YSBocmVmPSdodHRwOi8vdHdpdHRlci5jb20v
c2VhcmNoP3E9JTIzJDMnPiQyPC9hPiIsJHRleHQpOwogICAgICAgIHJldHVybiAkdGV4dDsK
ICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGdldCgkdXJsLCAkcGFyYW1zID0gYXJyYXkoKSkK
ICAgIHsKICAgICAgICAkYXBpX3VybCA9IG1kNSgkdXJsLnVybGVuY29kZShzZXJpYWxpemUo
JHBhcmFtcykpKTsKICAgICAgICAkZGF0YSA9ICcnOwoKICAgICAgICBpZiAoJHRoaXMtPl9j
YWNoZSkgeyAvLyBjaGVjayBmb3IgY2FjaGVkIHhtbAoKICAgICAgICAgICAgJGRhdGEgPSAk
dGhpcy0+X3JldHJpZXZlQ2FjaGUoJGFwaV91cmwpOwoKICAgICAgICB9CiAgICAgICAgaWYg
KGVtcHR5KCRkYXRhKSkgewogICAgICAgICAgICAkZGF0YSA9IHBhcmVudDo6Z2V0KCR1cmws
ICRwYXJhbXMpOwogICAgICAgICAgICBpZiAoJHRoaXMtPmh0dHBfY29kZT09PTIwMCAmJiAk
eG1sPXNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSkpIHsgLy8gc2F2ZSBjYWNoZQogICAg
ICAgICAgICAgICAgJGZpbGUgPSAkdGhpcy0+X2NhY2hlX2Rpci4nLycuJGFwaV91cmw7CiAg
ICAgICAgICAgICAgICBmaWxlX3B1dF9jb250ZW50cygkZmlsZSwkZGF0YSxMT0NLX0VYKTsK
ICAgICAgICAgICAgICAgIHJldHVybiAkeG1sOwogICAgICAgICAgICB9IGVsc2UgeyAvLyBm
YWlsZWQgdG8gcmV0cmlldmUgZGF0YSBmcm9tIFR3aXR0ZXIKCiAgICAgICAgICAgICAgICBp
ZiAoJHRoaXMtPl9jYWNoZSkgeyAvLyBhdHRlbXB0IHRvIGZvcmNlIGNhY2hlZCB4bWwgcmV0
dXJuCgogICAgICAgICAgICAgICAgICAgICRkYXRhID0gJHRoaXMtPl9yZXRyaWV2ZUNhY2hl
KCRhcGlfdXJsLHRydWUpOwogICAgICAgICAgICAgICAgICAgIGlmICgkZGF0YSkgcmV0dXJu
IEBzaW1wbGV4bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwoKICAgICAgICAgICAgICAgIH0KCiAg
ICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICB9CiAgICAgICAgfSBl
bHNlIHsgLy8gcmV0dXJuIGNhY2hlZCB4bWwKICAgICAgICAgICAgcmV0dXJuIEBzaW1wbGV4
bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwogICAgICAgIH0KICAgIH0gLy9lbmQgZ2V0KCkKCiAg
ICBmdW5jdGlvbiBwb3N0KCR1cmwsICRwYXJhbXMgPSBhcnJheSgpKQogICAgewogICAgICAg
ICRkYXRhID0gcGFyZW50Ojpwb3N0KCR1cmwsJHBhcmFtcyk7CiAgICAgICAgcmV0dXJuIHNp
bXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSk7CiAgICB9CgogICAgZnVuY3Rpb24gZGVsZXRl
KCR1cmwsICRwYXJhbXMgPSBhcnJheSgpKQogICAgewogICAgICAgICRkYXRhID0gcGFyZW50
OjpkZWxldGUoJHVybCwkcGFyYW1zKTsKICAgICAgICByZXR1cm4gc2ltcGxleG1sX2xvYWRf
c3RyaW5nKCRkYXRhKTsKICAgIH0KCiAgICAvLyBDYWNoZSBtZXRob2RzCgogICAgcHVibGlj
IGZ1bmN0aW9uIHNldENhY2hpbmcoJGNhY2hlPXRydWUpCiAgICB7CiAgICAgICAgJHRoaXMt
Pl9jYWNoZSA9ICgkY2FjaGUpID8gdHJ1ZSA6IGZhbHNlOwogICAgICAgIHJldHVybiB0cnVl
OwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjYWNoZURpcigkbG9jKQogICAgewogICAg
ICAgICR0aGlzLT5fY2FjaGVfZGlyID0gJGxvYzsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAg
IH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gY2FjaGVUaW1lKCRtaW5zKQogICAgewogICAgICAg
ICR0aGlzLT5fY2FjaGVfdGltZSA9ICRtaW5zKjYwOyAvLyBjb252ZXJ0IG1pbnV0ZXMgaW50
byBzZWNvbmRzCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJpdmF0ZSBmdW5j
dGlvbiBfcmV0cmlldmVDYWNoZSgkdXJsLCRvdmVyaWRlX3RpbWVvdXQ9ZmFsc2UpCiAgICB7
CiAgICAgICAgJGZpbGUgPSAkdGhpcy0+X2NhY2hlX2Rpci4nLycuJHVybDsKICAgICAgICBp
ZiAoZmlsZV9leGlzdHMoJGZpbGUpKSB7CgogICAgICAgICAgICAkZGlmZiA9IHRpbWUoKSAt
IGZpbGVtdGltZSgkZmlsZSk7CiAgICAgICAgICAgIGlmICgkb3ZlcmlkZV90aW1lb3V0IHx8
ICRkaWZmIDwgJHRoaXMtPl9jYWNoZV90aW1lKSB7CiAgICAgICAgICAgICAgICByZXR1cm4g
ZmlsZV9nZXRfY29udGVudHMoJGZpbGUpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAg
ICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgIH0gZWxzZSB7
CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICB9Cn0KCi8qCiAqIEFi
cmFoYW0gV2lsbGlhbXMgKGFicmFoYW1AYWJyYWguYW0pIGh0dHA6Ly9hYnJhaC5hbQogKgog
KiBUaGUgZmlyc3QgUEhQIExpYnJhcnkgdG8gc3VwcG9ydCBPQXV0aCBmb3IgVHdpdHRlcidz
IFJFU1QgQVBJLgogKi8KCi8qKgogKiBUd2l0dGVyIE9BdXRoIGNsYXNzCiAqLwpjbGFzcyBU
d2l0dGVyT0F1dGggewogIC8qIENvbnRhaW5zIHRoZSBsYXN0IEhUVFAgc3RhdHVzIGNvZGUg
cmV0dXJuZWQuICovCiAgcHVibGljICRodHRwX2NvZGU7CiAgLyogQ29udGFpbnMgdGhlIGxh
c3QgQVBJIGNhbGwuICovCiAgcHVibGljICR1cmw7CiAgLyogU2V0IHVwIHRoZSBBUEkgcm9v
dCBVUkwuICovCiAgcHVibGljICRob3N0ID0gImh0dHBzOi8vYXBpLnR3aXR0ZXIuY29tLzEv
IjsKICAvKiBTZXQgdGltZW91dCBkZWZhdWx0LiAqLwogIHB1YmxpYyAkdGltZW91dCA9IDMw
OwogIC8qIFNldCBjb25uZWN0IHRpbWVvdXQuICovCiAgcHVibGljICRjb25uZWN0dGltZW91
dCA9IDMwOwogIC8qIFZlcmlmeSBTU0wgQ2VydC4gKi8KICBwdWJsaWMgJHNzbF92ZXJpZnlw
ZWVyID0gRkFMU0U7CiAgLyogUmVzcG9ucyBmb3JtYXQuICovCiAgcHVibGljICRmb3JtYXQg
PSAnanNvbic7CiAgLyogRGVjb2RlIHJldHVybmVkIGpzb24gZGF0YS4gKi8KICBwdWJsaWMg
JGRlY29kZV9qc29uID0gVFJVRTsKICAvKiBDb250YWlucyB0aGUgbGFzdCBIVFRQIGhlYWRl
cnMgcmV0dXJuZWQuICovCiAgcHVibGljICRodHRwX2luZm87CiAgLyogU2V0IHRoZSB1c2Vy
YWduZXQuICovCiAgcHVibGljICR1c2VyYWdlbnQgPSAnVHdpdHRlck9BdXRoIHYwLjIuMC1i
ZXRhMic7CiAgLyogSW1tZWRpYXRlbHkgcmV0cnkgdGhlIEFQSSBjYWxsIGlmIHRoZSByZXNw
b25zZSB3YXMgbm90IHN1Y2Nlc3NmdWwuICovCiAgLy9wdWJsaWMgJHJldHJ5ID0gVFJVRTsK
CgoKCiAgLyoqCiAgICogU2V0IEFQSSBVUkxTCiAgICovCiAgZnVuY3Rpb24gYWNjZXNzVG9r
ZW5VUkwoKSAgeyByZXR1cm4gJ2h0dHBzOi8vYXBpLnR3aXR0ZXIuY29tL29hdXRoL2FjY2Vz
c190b2tlbic7IH0KICBmdW5jdGlvbiBhdXRoZW50aWNhdGVVUkwoKSB7IHJldHVybiAnaHR0
cHM6Ly90d2l0dGVyLmNvbS9vYXV0aC9hdXRoZW50aWNhdGUnOyB9CiAgZnVuY3Rpb24gYXV0
aG9yaXplVVJMKCkgICAgeyByZXR1cm4gJ2h0dHBzOi8vdHdpdHRlci5jb20vb2F1dGgvYXV0
aG9yaXplJzsgfQogIGZ1bmN0aW9uIHJlcXVlc3RUb2tlblVSTCgpIHsgcmV0dXJuICdodHRw
czovL2FwaS50d2l0dGVyLmNvbS9vYXV0aC9yZXF1ZXN0X3Rva2VuJzsgfQoKICAvKioKICAg
KiBEZWJ1ZyBoZWxwZXJzCiAgICovCiAgZnVuY3Rpb24gbGFzdFN0YXR1c0NvZGUoKSB7IHJl
dHVybiAkdGhpcy0+aHR0cF9zdGF0dXM7IH0KICBmdW5jdGlvbiBsYXN0QVBJQ2FsbCgpIHsg
cmV0dXJuICR0aGlzLT5sYXN0X2FwaV9jYWxsOyB9CgogIC8qKgogICAqIGNvbnN0cnVjdCBU
d2l0dGVyT0F1dGggb2JqZWN0CiAgICovCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGNvbnN1
bWVyX2tleSwgJGNvbnN1bWVyX3NlY3JldCwgJG9hdXRoX3Rva2VuID0gTlVMTCwgJG9hdXRo
X3Rva2VuX3NlY3JldCA9IE5VTEwpIHsKICAgICR0aGlzLT5zaGExX21ldGhvZCA9IG5ldyBP
QXV0aFNpZ25hdHVyZU1ldGhvZF9ITUFDX1NIQTEoKTsKICAgICR0aGlzLT5jb25zdW1lciA9
IG5ldyBPQXV0aENvbnN1bWVyKCRjb25zdW1lcl9rZXksICRjb25zdW1lcl9zZWNyZXQpOwog
ICAgaWYgKCFlbXB0eSgkb2F1dGhfdG9rZW4pICYmICFlbXB0eSgkb2F1dGhfdG9rZW5fc2Vj
cmV0KSkgewogICAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigkb2F1dGhf
dG9rZW4sICRvYXV0aF90b2tlbl9zZWNyZXQpOwogICAgfSBlbHNlIHsKICAgICAgJHRoaXMt
PnRva2VuID0gTlVMTDsKICAgIH0KICB9CgoKICAvKioKICAgKiBHZXQgYSByZXF1ZXN0X3Rv
a2VuIGZyb20gVHdpdHRlcgogICAqCiAgICogQHJldHVybnMgYSBrZXkvdmFsdWUgYXJyYXkg
Y29udGFpbmluZyBvYXV0aF90b2tlbiBhbmQgb2F1dGhfdG9rZW5fc2VjcmV0CiAgICovCiAg
ZnVuY3Rpb24gZ2V0UmVxdWVzdFRva2VuKCRvYXV0aF9jYWxsYmFjayA9IE5VTEwpIHsKICAg
ICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgIGlmICghZW1wdHkoJG9hdXRoX2NhbGxiYWNr
KSkgewogICAgICAkcGFyYW1ldGVyc1snb2F1dGhfY2FsbGJhY2snXSA9ICRvYXV0aF9jYWxs
YmFjazsKICAgIH0KICAgICRyZXF1ZXN0ID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdGhpcy0+
cmVxdWVzdFRva2VuVVJMKCksICdHRVQnLCAkcGFyYW1ldGVycyk7CiAgICAkdG9rZW4gPSBP
QXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMoJHJlcXVlc3QpOwogICAgJHRoaXMtPnRva2Vu
ID0gbmV3IE9BdXRoQ29uc3VtZXIoJHRva2VuWydvYXV0aF90b2tlbiddLCAkdG9rZW5bJ29h
dXRoX3Rva2VuX3NlY3JldCddKTsKICAgIHJldHVybiAkdG9rZW47CiAgfQoKICAvKioKICAg
KiBHZXQgdGhlIGF1dGhvcml6ZSBVUkwKICAgKgogICAqIEByZXR1cm5zIGEgc3RyaW5nCiAg
ICovCiAgZnVuY3Rpb24gZ2V0QXV0aG9yaXplVVJMKCR0b2tlbiwgJHNpZ25faW5fd2l0aF90
d2l0dGVyID0gVFJVRSkgewogICAgaWYgKGlzX2FycmF5KCR0b2tlbikpIHsKICAgICAgJHRv
a2VuID0gJHRva2VuWydvYXV0aF90b2tlbiddOwogICAgfQogICAgaWYgKGVtcHR5KCRzaWdu
X2luX3dpdGhfdHdpdHRlcikpIHsKICAgICAgcmV0dXJuICR0aGlzLT5hdXRob3JpemVVUkwo
KSAuICI/b2F1dGhfdG9rZW49eyR0b2tlbn0iOwogICAgfSBlbHNlIHsKICAgICAgIHJldHVy
biAkdGhpcy0+YXV0aGVudGljYXRlVVJMKCkgLiAiP29hdXRoX3Rva2VuPXskdG9rZW59IjsK
ICAgIH0KICB9CgogIC8qKgogICAqIEV4Y2hhbmdlIHJlcXVlc3QgdG9rZW4gYW5kIHNlY3Jl
dCBmb3IgYW4gYWNjZXNzIHRva2VuIGFuZAogICAqIHNlY3JldCwgdG8gc2lnbiBBUEkgY2Fs
bHMuCiAgICoKICAgKiBAcmV0dXJucyBhcnJheSgib2F1dGhfdG9rZW4iID0+ICJ0aGUtYWNj
ZXNzLXRva2VuIiwKICAgKiAgICAgICAgICAgICAgICAib2F1dGhfdG9rZW5fc2VjcmV0IiA9
PiAidGhlLWFjY2Vzcy1zZWNyZXQiLAogICAqICAgICAgICAgICAgICAgICJ1c2VyX2lkIiA9
PiAiOTQzNjk5MiIsCiAgICogICAgICAgICAgICAgICAgInNjcmVlbl9uYW1lIiA9PiAiYWJy
YWhhbSIpCiAgICovCiAgZnVuY3Rpb24gZ2V0QWNjZXNzVG9rZW4oJG9hdXRoX3ZlcmlmaWVy
ID0gRkFMU0UpIHsKICAgICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgIGlmICghZW1wdHko
JG9hdXRoX3ZlcmlmaWVyKSkgewogICAgICAkcGFyYW1ldGVyc1snb2F1dGhfdmVyaWZpZXIn
XSA9ICRvYXV0aF92ZXJpZmllcjsKICAgIH0KICAgICRyZXF1ZXN0ID0gJHRoaXMtPm9BdXRo
UmVxdWVzdCgkdGhpcy0+YWNjZXNzVG9rZW5VUkwoKSwgJ0dFVCcsICRwYXJhbWV0ZXJzKTsK
ICAgICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygkcmVxdWVzdCk7CiAg
ICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigkdG9rZW5bJ29hdXRoX3Rva2Vu
J10sICR0b2tlblsnb2F1dGhfdG9rZW5fc2VjcmV0J10pOwogICAgcmV0dXJuICR0b2tlbjsK
ICB9CgogIC8qKgogICAqIE9uZSB0aW1lIGV4Y2hhbmdlIG9mIHVzZXJuYW1lIGFuZCBwYXNz
d29yZCBmb3IgYWNjZXNzIHRva2VuIGFuZCBzZWNyZXQuCiAgICoKICAgKiBAcmV0dXJucyBh
cnJheSgib2F1dGhfdG9rZW4iID0+ICJ0aGUtYWNjZXNzLXRva2VuIiwKICAgKiAgICAgICAg
ICAgICAgICAib2F1dGhfdG9rZW5fc2VjcmV0IiA9PiAidGhlLWFjY2Vzcy1zZWNyZXQiLAog
ICAqICAgICAgICAgICAgICAgICJ1c2VyX2lkIiA9PiAiOTQzNjk5MiIsCiAgICogICAgICAg
ICAgICAgICAgInNjcmVlbl9uYW1lIiA9PiAiYWJyYWhhbSIsCiAgICogICAgICAgICAgICAg
ICAgInhfYXV0aF9leHBpcmVzIiA9PiAiMCIpCiAgICovCiAgZnVuY3Rpb24gZ2V0WEF1dGhU
b2tlbigkdXNlcm5hbWUsICRwYXNzd29yZCkgewogICAgJHBhcmFtZXRlcnMgPSBhcnJheSgp
OwogICAgJHBhcmFtZXRlcnNbJ3hfYXV0aF91c2VybmFtZSddID0gJHVzZXJuYW1lOwogICAg
JHBhcmFtZXRlcnNbJ3hfYXV0aF9wYXNzd29yZCddID0gJHBhc3N3b3JkOwogICAgJHBhcmFt
ZXRlcnNbJ3hfYXV0aF9tb2RlJ10gPSAnY2xpZW50X2F1dGgnOwogICAgJHJlcXVlc3QgPSAk
dGhpcy0+b0F1dGhSZXF1ZXN0KCR0aGlzLT5hY2Nlc3NUb2tlblVSTCgpLCAnUE9TVCcsICRw
YXJhbWV0ZXJzKTsKICAgICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygk
cmVxdWVzdCk7CiAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigkdG9rZW5b
J29hdXRoX3Rva2VuJ10sICR0b2tlblsnb2F1dGhfdG9rZW5fc2VjcmV0J10pOwogICAgcmV0
dXJuICR0b2tlbjsKICB9CgogIC8qKgogICAqIEdFVCB3cmFwcGVyIGZvciBvQXV0aFJlcXVl
c3QuCiAgICovCiAgZnVuY3Rpb24gZ2V0KCR1cmwsICRwYXJhbWV0ZXJzID0gYXJyYXkoKSkg
ewogICAgJHJlc3BvbnNlID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdXJsLCAnR0VUJywgJHBh
cmFtZXRlcnMpOwogICAgaWYgKCR0aGlzLT5mb3JtYXQgPT09ICdqc29uJyAmJiAkdGhpcy0+
ZGVjb2RlX2pzb24pIHsKICAgICAgcmV0dXJuIGpzb25fZGVjb2RlKCRyZXNwb25zZSk7CiAg
ICB9CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoqCiAgICogUE9TVCB3cmFwcGVy
IGZvciBvQXV0aFJlcXVlc3QuCiAgICovCiAgZnVuY3Rpb24gcG9zdCgkdXJsLCAkcGFyYW1l
dGVycyA9IGFycmF5KCkpIHsKICAgICRyZXNwb25zZSA9ICR0aGlzLT5vQXV0aFJlcXVlc3Qo
JHVybCwgJ1BPU1QnLCAkcGFyYW1ldGVycyk7CiAgICBpZiAoJHRoaXMtPmZvcm1hdCA9PT0g
J2pzb24nICYmICR0aGlzLT5kZWNvZGVfanNvbikgewogICAgICByZXR1cm4ganNvbl9kZWNv
ZGUoJHJlc3BvbnNlKTsKICAgIH0KICAgIHJldHVybiAkcmVzcG9uc2U7CiAgfQoKICAvKioK
ICAgKiBERUxFVEUgd3JhcHBlciBmb3Igb0F1dGhSZXFldXN0LgogICAqLwogIGZ1bmN0aW9u
IGRlbGV0ZSgkdXJsLCAkcGFyYW1ldGVycyA9IGFycmF5KCkpIHsKICAgICRyZXNwb25zZSA9
ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHVybCwgJ0RFTEVURScsICRwYXJhbWV0ZXJzKTsKICAg
IGlmICgkdGhpcy0+Zm9ybWF0ID09PSAnanNvbicgJiYgJHRoaXMtPmRlY29kZV9qc29uKSB7
CiAgICAgIHJldHVybiBqc29uX2RlY29kZSgkcmVzcG9uc2UpOwogICAgfQogICAgcmV0dXJu
ICRyZXNwb25zZTsKICB9CgogIC8qKgogICAqIEZvcm1hdCBhbmQgc2lnbiBhbiBPQXV0aCAv
IEFQSSByZXF1ZXN0CiAgICovCiAgZnVuY3Rpb24gb0F1dGhSZXF1ZXN0KCR1cmwsICRtZXRo
b2QsICRwYXJhbWV0ZXJzKSB7CiAgICBpZiAoc3RycnBvcygkdXJsLCAnaHR0cHM6Ly8nKSAh
PT0gMCAmJiBzdHJycG9zKCR1cmwsICdodHRwOi8vJykgIT09IDApIHsKICAgICAgJHVybCA9
ICJ7JHRoaXMtPmhvc3R9eyR1cmx9LnskdGhpcy0+Zm9ybWF0fSI7CiAgICB9CiAgICAkcmVx
dWVzdCA9IE9BdXRoUmVxdWVzdDo6ZnJvbV9jb25zdW1lcl9hbmRfdG9rZW4oJHRoaXMtPmNv
bnN1bWVyLCAkdGhpcy0+dG9rZW4sICRtZXRob2QsICR1cmwsICRwYXJhbWV0ZXJzKTsKICAg
ICRyZXF1ZXN0LT5zaWduX3JlcXVlc3QoJHRoaXMtPnNoYTFfbWV0aG9kLCAkdGhpcy0+Y29u
c3VtZXIsICR0aGlzLT50b2tlbik7CiAgICBzd2l0Y2ggKCRtZXRob2QpIHsKICAgIGNhc2Ug
J0dFVCc6CiAgICAgIHJldHVybiAkdGhpcy0+aHR0cCgkcmVxdWVzdC0+dG9fdXJsKCksICdH
RVQnKTsKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiAkdGhpcy0+aHR0cCgkcmVxdWVzdC0+
Z2V0X25vcm1hbGl6ZWRfaHR0cF91cmwoKSwgJG1ldGhvZCwgJHJlcXVlc3QtPnRvX3Bvc3Rk
YXRhKCkpOwogICAgfQogIH0KCiAgLyoqCiAgICogTWFrZSBhbiBIVFRQIHJlcXVlc3QKICAg
KgogICAqIEByZXR1cm4gQVBJIHJlc3VsdHMKICAgKi8KICBmdW5jdGlvbiBodHRwKCR1cmws
ICRtZXRob2QsICRwb3N0ZmllbGRzID0gTlVMTCkgewogICAgJHRoaXMtPmh0dHBfaW5mbyA9
IGFycmF5KCk7CiAgICAkY2kgPSBjdXJsX2luaXQoKTsKICAgIC8qIEN1cmwgc2V0dGluZ3Mg
Ki8KICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9VU0VSQUdFTlQsICR0aGlzLT51c2Vy
YWdlbnQpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0NPTk5FQ1RUSU1FT1VULCAk
dGhpcy0+Y29ubmVjdHRpbWVvdXQpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1RJ
TUVPVVQsICR0aGlzLT50aW1lb3V0KTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9S
RVRVUk5UUkFOU0ZFUiwgVFJVRSk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfSFRU
UEhFQURFUiwgYXJyYXkoJ0V4cGVjdDonKSk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxP
UFRfU1NMX1ZFUklGWVBFRVIsICR0aGlzLT5zc2xfdmVyaWZ5cGVlcik7CiAgICBjdXJsX3Nl
dG9wdCgkY2ksIENVUkxPUFRfSEVBREVSRlVOQ1RJT04sIGFycmF5KCR0aGlzLCAnZ2V0SGVh
ZGVyJykpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0hFQURFUiwgRkFMU0UpOwoK
ICAgIHN3aXRjaCAoJG1ldGhvZCkgewogICAgICBjYXNlICdQT1NUJzoKICAgICAgICBjdXJs
X3NldG9wdCgkY2ksIENVUkxPUFRfUE9TVCwgVFJVRSk7CiAgICAgICAgaWYgKCFlbXB0eSgk
cG9zdGZpZWxkcykpIHsKICAgICAgICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9QT1NU
RklFTERTLCAkcG9zdGZpZWxkcyk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBj
YXNlICdERUxFVEUnOgogICAgICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9DVVNUT01S
RVFVRVNULCAnREVMRVRFJyk7CiAgICAgICAgaWYgKCFlbXB0eSgkcG9zdGZpZWxkcykpIHsK
ICAgICAgICAgICR1cmwgPSAieyR1cmx9P3skcG9zdGZpZWxkc30iOwogICAgICAgIH0KICAg
IH0KCiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfVVJMLCAkdXJsKTsKICAgICRyZXNw
b25zZSA9IGN1cmxfZXhlYygkY2kpOwogICAgJHRoaXMtPmh0dHBfY29kZSA9IGN1cmxfZ2V0
aW5mbygkY2ksIENVUkxJTkZPX0hUVFBfQ09ERSk7CiAgICAkdGhpcy0+aHR0cF9pbmZvID0g
YXJyYXlfbWVyZ2UoJHRoaXMtPmh0dHBfaW5mbywgY3VybF9nZXRpbmZvKCRjaSkpOwogICAg
JHRoaXMtPnVybCA9ICR1cmw7CiAgICBjdXJsX2Nsb3NlICgkY2kpOwogICAgcmV0dXJuICRy
ZXNwb25zZTsKICB9CgogIC8qKgogICAqIEdldCB0aGUgaGVhZGVyIGluZm8gdG8gc3RvcmUu
CiAgICovCiAgZnVuY3Rpb24gZ2V0SGVhZGVyKCRjaCwgJGhlYWRlcikgewogICAgJGkgPSBz
dHJwb3MoJGhlYWRlciwgJzonKTsKICAgIGlmICghZW1wdHkoJGkpKSB7CiAgICAgICRrZXkg
PSBzdHJfcmVwbGFjZSgnLScsICdfJywgc3RydG9sb3dlcihzdWJzdHIoJGhlYWRlciwgMCwg
JGkpKSk7CiAgICAgICR2YWx1ZSA9IHRyaW0oc3Vic3RyKCRoZWFkZXIsICRpICsgMikpOwog
ICAgICAkdGhpcy0+aHR0cF9oZWFkZXJbJGtleV0gPSAkdmFsdWU7CiAgICB9CiAgICByZXR1
cm4gc3RybGVuKCRoZWFkZXIpOwogIH0KfQoKY2xhc3MgT0F1dGhFeGNlcHRpb24gZXh0ZW5k
cyBFeGNlcHRpb24gewogIC8vIHBhc3MKfQoKY2xhc3MgT0F1dGhDb25zdW1lciB7CiAgcHVi
bGljICRrZXk7CiAgcHVibGljICRzZWNyZXQ7CgogIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRr
ZXksICRzZWNyZXQsICRjYWxsYmFja191cmw9TlVMTCkgewogICAgJHRoaXMtPmtleSA9ICRr
ZXk7CiAgICAkdGhpcy0+c2VjcmV0ID0gJHNlY3JldDsKICAgICR0aGlzLT5jYWxsYmFja191
cmwgPSAkY2FsbGJhY2tfdXJsOwogIH0KCiAgZnVuY3Rpb24gX190b1N0cmluZygpIHsKICAg
IHJldHVybiAiT0F1dGhDb25zdW1lcltrZXk9JHRoaXMtPmtleSxzZWNyZXQ9JHRoaXMtPnNl
Y3JldF0iOwogIH0KfQoKY2xhc3MgT0F1dGhUb2tlbiB7CiAgLy8gYWNjZXNzIHRva2VucyBh
bmQgcmVxdWVzdCB0b2tlbnMKICBwdWJsaWMgJGtleTsKICBwdWJsaWMgJHNlY3JldDsKCiAg
LyoqCiAgICoga2V5ID0gdGhlIHRva2VuCiAgICogc2VjcmV0ID0gdGhlIHRva2VuIHNlY3Jl
dAogICAqLwogIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRrZXksICRzZWNyZXQpIHsKICAgICR0
aGlzLT5rZXkgPSAka2V5OwogICAgJHRoaXMtPnNlY3JldCA9ICRzZWNyZXQ7CiAgfQoKICAv
KioKICAgKiBnZW5lcmF0ZXMgdGhlIGJhc2ljIHN0cmluZyBzZXJpYWxpemF0aW9uIG9mIGEg
dG9rZW4gdGhhdCBhIHNlcnZlcgogICAqIHdvdWxkIHJlc3BvbmQgdG8gcmVxdWVzdF90b2tl
biBhbmQgYWNjZXNzX3Rva2VuIGNhbGxzIHdpdGgKICAgKi8KICBmdW5jdGlvbiB0b19zdHJp
bmcoKSB7CiAgICByZXR1cm4gIm9hdXRoX3Rva2VuPSIgLgogICAgICAgICAgIE9BdXRoVXRp
bDo6dXJsZW5jb2RlX3JmYzM5ODYoJHRoaXMtPmtleSkgLgogICAgICAgICAgICImb2F1dGhf
dG9rZW5fc2VjcmV0PSIgLgogICAgICAgICAgIE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5
ODYoJHRoaXMtPnNlY3JldCk7CiAgfQoKICBmdW5jdGlvbiBfX3RvU3RyaW5nKCkgewogICAg
cmV0dXJuICR0aGlzLT50b19zdHJpbmcoKTsKICB9Cn0KCi8qKgogKiBBIGNsYXNzIGZvciBp
bXBsZW1lbnRpbmcgYSBTaWduYXR1cmUgTWV0aG9kCiAqIFNlZSBzZWN0aW9uIDkgKCJTaWdu
aW5nIFJlcXVlc3RzIikgaW4gdGhlIHNwZWMKICovCmFic3RyYWN0IGNsYXNzIE9BdXRoU2ln
bmF0dXJlTWV0aG9kIHsKICAvKioKICAgKiBOZWVkcyB0byByZXR1cm4gdGhlIG5hbWUgb2Yg
dGhlIFNpZ25hdHVyZSBNZXRob2QgKGllIEhNQUMtU0hBMSkKICAgKiBAcmV0dXJuIHN0cmlu
ZwogICAqLwogIGFic3RyYWN0IHB1YmxpYyBmdW5jdGlvbiBnZXRfbmFtZSgpOwoKICAvKioK
ICAgKiBCdWlsZCB1cCB0aGUgc2lnbmF0dXJlCiAgICogTk9URTogVGhlIG91dHB1dCBvZiB0
aGlzIGZ1bmN0aW9uIE1VU1QgTk9UIGJlIHVybGVuY29kZWQuCiAgICogdGhlIGVuY29kaW5n
IGlzIGhhbmRsZWQgaW4gT0F1dGhSZXF1ZXN0IHdoZW4gdGhlIGZpbmFsCiAgICogcmVxdWVz
dCBpcyBzZXJpYWxpemVkCiAgICogQHBhcmFtIE9BdXRoUmVxdWVzdCAkcmVxdWVzdAogICAq
IEBwYXJhbSBPQXV0aENvbnN1bWVyICRjb25zdW1lcgogICAqIEBwYXJhbSBPQXV0aFRva2Vu
ICR0b2tlbgogICAqIEByZXR1cm4gc3RyaW5nCiAgICovCiAgYWJzdHJhY3QgcHVibGljIGZ1
bmN0aW9uIGJ1aWxkX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwoK
ICAvKioKICAgKiBWZXJpZmllcyB0aGF0IGEgZ2l2ZW4gc2lnbmF0dXJlIGlzIGNvcnJlY3QK
ICAgKiBAcGFyYW0gT0F1dGhSZXF1ZXN0ICRyZXF1ZXN0CiAgICogQHBhcmFtIE9BdXRoQ29u
c3VtZXIgJGNvbnN1bWVyCiAgICogQHBhcmFtIE9BdXRoVG9rZW4gJHRva2VuCiAgICogQHBh
cmFtIHN0cmluZyAkc2lnbmF0dXJlCiAgICogQHJldHVybiBib29sCiAgICovCiAgcHVibGlj
IGZ1bmN0aW9uIGNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4s
ICRzaWduYXR1cmUpIHsKICAgICRidWlsdCA9ICR0aGlzLT5idWlsZF9zaWduYXR1cmUoJHJl
cXVlc3QsICRjb25zdW1lciwgJHRva2VuKTsKICAgIHJldHVybiAkYnVpbHQgPT0gJHNpZ25h
dHVyZTsKICB9Cn0KCi8qKgogKiBUaGUgSE1BQy1TSEExIHNpZ25hdHVyZSBtZXRob2QgdXNl
cyB0aGUgSE1BQy1TSEExIHNpZ25hdHVyZSBhbGdvcml0aG0gYXMgZGVmaW5lZCBpbiBbUkZD
MjEwNF0KICogd2hlcmUgdGhlIFNpZ25hdHVyZSBCYXNlIFN0cmluZyBpcyB0aGUgdGV4dCBh
bmQgdGhlIGtleSBpcyB0aGUgY29uY2F0ZW5hdGVkIHZhbHVlcyAoZWFjaCBmaXJzdAogKiBl
bmNvZGVkIHBlciBQYXJhbWV0ZXIgRW5jb2RpbmcpIG9mIHRoZSBDb25zdW1lciBTZWNyZXQg
YW5kIFRva2VuIFNlY3JldCwgc2VwYXJhdGVkIGJ5IGFuICcmJwogKiBjaGFyYWN0ZXIgKEFT
Q0lJIGNvZGUgMzgpIGV2ZW4gaWYgZW1wdHkuCiAqICAgLSBDaGFwdGVyIDkuMiAoIkhNQUMt
U0hBMSIpCiAqLwpjbGFzcyBPQXV0aFNpZ25hdHVyZU1ldGhvZF9ITUFDX1NIQTEgZXh0ZW5k
cyBPQXV0aFNpZ25hdHVyZU1ldGhvZCB7CiAgZnVuY3Rpb24gZ2V0X25hbWUoKSB7CiAgICBy
ZXR1cm4gIkhNQUMtU0hBMSI7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2lnbmF0
dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJGJhc2Vfc3RyaW5nID0g
JHJlcXVlc3QtPmdldF9zaWduYXR1cmVfYmFzZV9zdHJpbmcoKTsKICAgICRyZXF1ZXN0LT5i
YXNlX3N0cmluZyA9ICRiYXNlX3N0cmluZzsKCiAgICAka2V5X3BhcnRzID0gYXJyYXkoCiAg
ICAgICRjb25zdW1lci0+c2VjcmV0LAogICAgICAoJHRva2VuKSA/ICR0b2tlbi0+c2VjcmV0
IDogIiIKICAgICk7CgogICAgJGtleV9wYXJ0cyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3Jm
YzM5ODYoJGtleV9wYXJ0cyk7CiAgICAka2V5ID0gaW1wbG9kZSgnJicsICRrZXlfcGFydHMp
OwoKICAgIHJldHVybiBiYXNlNjRfZW5jb2RlKGhhc2hfaG1hYygnc2hhMScsICRiYXNlX3N0
cmluZywgJGtleSwgdHJ1ZSkpOwogIH0KfQoKLyoqCiAqIFRoZSBQTEFJTlRFWFQgbWV0aG9k
IGRvZXMgbm90IHByb3ZpZGUgYW55IHNlY3VyaXR5IHByb3RlY3Rpb24gYW5kIFNIT1VMRCBv
bmx5IGJlIHVzZWQKICogb3ZlciBhIHNlY3VyZSBjaGFubmVsIHN1Y2ggYXMgSFRUUFMuIEl0
IGRvZXMgbm90IHVzZSB0aGUgU2lnbmF0dXJlIEJhc2UgU3RyaW5nLgogKiAgIC0gQ2hhcHRl
ciA5LjQgKCJQTEFJTlRFWFQiKQogKi8KY2xhc3MgT0F1dGhTaWduYXR1cmVNZXRob2RfUExB
SU5URVhUIGV4dGVuZHMgT0F1dGhTaWduYXR1cmVNZXRob2QgewogIHB1YmxpYyBmdW5jdGlv
biBnZXRfbmFtZSgpIHsKICAgIHJldHVybiAiUExBSU5URVhUIjsKICB9CgogIC8qKgogICAq
IG9hdXRoX3NpZ25hdHVyZSBpcyBzZXQgdG8gdGhlIGNvbmNhdGVuYXRlZCBlbmNvZGVkIHZh
bHVlcyBvZiB0aGUgQ29uc3VtZXIgU2VjcmV0IGFuZAogICAqIFRva2VuIFNlY3JldCwgc2Vw
YXJhdGVkIGJ5IGEgJyYnIGNoYXJhY3RlciAoQVNDSUkgY29kZSAzOCksIGV2ZW4gaWYgZWl0
aGVyIHNlY3JldCBpcwogICAqIGVtcHR5LiBUaGUgcmVzdWx0IE1VU1QgYmUgZW5jb2RlZCBh
Z2Fpbi4KICAgKiAgIC0gQ2hhcHRlciA5LjQuMSAoIkdlbmVyYXRpbmcgU2lnbmF0dXJlcyIp
CiAgICoKICAgKiBQbGVhc2Ugbm90ZSB0aGF0IHRoZSBzZWNvbmQgZW5jb2RpbmcgTVVTVCBO
T1QgaGFwcGVuIGluIHRoZSBTaWduYXR1cmVNZXRob2QsIGFzCiAgICogT0F1dGhSZXF1ZXN0
IGhhbmRsZXMgdGhpcyEKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2lnbmF0dXJl
KCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJGtleV9wYXJ0cyA9IGFycmF5
KAogICAgICAkY29uc3VtZXItPnNlY3JldCwKICAgICAgKCR0b2tlbikgPyAkdG9rZW4tPnNl
Y3JldCA6ICIiCiAgICApOwoKICAgICRrZXlfcGFydHMgPSBPQXV0aFV0aWw6OnVybGVuY29k
ZV9yZmMzOTg2KCRrZXlfcGFydHMpOwogICAgJGtleSA9IGltcGxvZGUoJyYnLCAka2V5X3Bh
cnRzKTsKICAgICRyZXF1ZXN0LT5iYXNlX3N0cmluZyA9ICRrZXk7CgogICAgcmV0dXJuICRr
ZXk7CiAgfQp9CgovKioKICogVGhlIFJTQS1TSEExIHNpZ25hdHVyZSBtZXRob2QgdXNlcyB0
aGUgUlNBU1NBLVBLQ1MxLXYxXzUgc2lnbmF0dXJlIGFsZ29yaXRobSBhcyBkZWZpbmVkIGlu
CiAqIFtSRkMzNDQ3XSBzZWN0aW9uIDguMiAobW9yZSBzaW1wbHkga25vd24gYXMgUEtDUyMx
KSwgdXNpbmcgU0hBLTEgYXMgdGhlIGhhc2ggZnVuY3Rpb24gZm9yCiAqIEVNU0EtUEtDUzEt
djFfNS4gSXQgaXMgYXNzdW1lZCB0aGF0IHRoZSBDb25zdW1lciBoYXMgcHJvdmlkZWQgaXRz
IFJTQSBwdWJsaWMga2V5IGluIGEKICogdmVyaWZpZWQgd2F5IHRvIHRoZSBTZXJ2aWNlIFBy
b3ZpZGVyLCBpbiBhIG1hbm5lciB3aGljaCBpcyBiZXlvbmQgdGhlIHNjb3BlIG9mIHRoaXMK
ICogc3BlY2lmaWNhdGlvbi4KICogICAtIENoYXB0ZXIgOS4zICgiUlNBLVNIQTEiKQogKi8K
YWJzdHJhY3QgY2xhc3MgT0F1dGhTaWduYXR1cmVNZXRob2RfUlNBX1NIQTEgZXh0ZW5kcyBP
QXV0aFNpZ25hdHVyZU1ldGhvZCB7CiAgcHVibGljIGZ1bmN0aW9uIGdldF9uYW1lKCkgewog
ICAgcmV0dXJuICJSU0EtU0hBMSI7CiAgfQoKICAvLyBVcCB0byB0aGUgU1AgdG8gaW1wbGVt
ZW50IHRoaXMgbG9va3VwIG9mIGtleXMuIFBvc3NpYmxlIGlkZWFzIGFyZToKICAvLyAoMSkg
ZG8gYSBsb29rdXAgaW4gYSB0YWJsZSBvZiB0cnVzdGVkIGNlcnRzIGtleWVkIG9mZiBvZiBj
b25zdW1lcgogIC8vICgyKSBmZXRjaCB2aWEgaHR0cCB1c2luZyBhIHVybCBwcm92aWRlZCBi
eSB0aGUgcmVxdWVzdGVyCiAgLy8gKDMpIHNvbWUgc29ydCBvZiBzcGVjaWZpYyBkaXNjb3Zl
cnkgY29kZSBiYXNlZCBvbiByZXF1ZXN0CiAgLy8KICAvLyBFaXRoZXIgd2F5IHNob3VsZCBy
ZXR1cm4gYSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIGNlcnRpZmljYXRlCiAgcHJv
dGVjdGVkIGFic3RyYWN0IGZ1bmN0aW9uIGZldGNoX3B1YmxpY19jZXJ0KCYkcmVxdWVzdCk7
CgogIC8vIFVwIHRvIHRoZSBTUCB0byBpbXBsZW1lbnQgdGhpcyBsb29rdXAgb2Yga2V5cy4g
UG9zc2libGUgaWRlYXMgYXJlOgogIC8vICgxKSBkbyBhIGxvb2t1cCBpbiBhIHRhYmxlIG9m
IHRydXN0ZWQgY2VydHMga2V5ZWQgb2ZmIG9mIGNvbnN1bWVyCiAgLy8KICAvLyBFaXRoZXIg
d2F5IHNob3VsZCByZXR1cm4gYSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIGNlcnRp
ZmljYXRlCiAgcHJvdGVjdGVkIGFic3RyYWN0IGZ1bmN0aW9uIGZldGNoX3ByaXZhdGVfY2Vy
dCgmJHJlcXVlc3QpOwoKICBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2lnbmF0dXJlKCRyZXF1
ZXN0LCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJGJhc2Vfc3RyaW5nID0gJHJlcXVlc3Qt
PmdldF9zaWduYXR1cmVfYmFzZV9zdHJpbmcoKTsKICAgICRyZXF1ZXN0LT5iYXNlX3N0cmlu
ZyA9ICRiYXNlX3N0cmluZzsKCiAgICAvLyBGZXRjaCB0aGUgcHJpdmF0ZSBrZXkgY2VydCBi
YXNlZCBvbiB0aGUgcmVxdWVzdAogICAgJGNlcnQgPSAkdGhpcy0+ZmV0Y2hfcHJpdmF0ZV9j
ZXJ0KCRyZXF1ZXN0KTsKCiAgICAvLyBQdWxsIHRoZSBwcml2YXRlIGtleSBJRCBmcm9tIHRo
ZSBjZXJ0aWZpY2F0ZQogICAgJHByaXZhdGVrZXlpZCA9IG9wZW5zc2xfZ2V0X3ByaXZhdGVr
ZXkoJGNlcnQpOwoKICAgIC8vIFNpZ24gdXNpbmcgdGhlIGtleQogICAgJG9rID0gb3BlbnNz
bF9zaWduKCRiYXNlX3N0cmluZywgJHNpZ25hdHVyZSwgJHByaXZhdGVrZXlpZCk7CgogICAg
Ly8gUmVsZWFzZSB0aGUga2V5IHJlc291cmNlCiAgICBvcGVuc3NsX2ZyZWVfa2V5KCRwcml2
YXRla2V5aWQpOwoKICAgIHJldHVybiBiYXNlNjRfZW5jb2RlKCRzaWduYXR1cmUpOwogIH0K
CiAgcHVibGljIGZ1bmN0aW9uIGNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVy
LCAkdG9rZW4sICRzaWduYXR1cmUpIHsKICAgICRkZWNvZGVkX3NpZyA9IGJhc2U2NF9kZWNv
ZGUoJHNpZ25hdHVyZSk7CgogICAgJGJhc2Vfc3RyaW5nID0gJHJlcXVlc3QtPmdldF9zaWdu
YXR1cmVfYmFzZV9zdHJpbmcoKTsKCiAgICAvLyBGZXRjaCB0aGUgcHVibGljIGtleSBjZXJ0
IGJhc2VkIG9uIHRoZSByZXF1ZXN0CiAgICAkY2VydCA9ICR0aGlzLT5mZXRjaF9wdWJsaWNf
Y2VydCgkcmVxdWVzdCk7CgogICAgLy8gUHVsbCB0aGUgcHVibGljIGtleSBJRCBmcm9tIHRo
ZSBjZXJ0aWZpY2F0ZQogICAgJHB1YmxpY2tleWlkID0gb3BlbnNzbF9nZXRfcHVibGlja2V5
KCRjZXJ0KTsKCiAgICAvLyBDaGVjayB0aGUgY29tcHV0ZWQgc2lnbmF0dXJlIGFnYWluc3Qg
dGhlIG9uZSBwYXNzZWQgaW4gdGhlIHF1ZXJ5CiAgICAkb2sgPSBvcGVuc3NsX3ZlcmlmeSgk
YmFzZV9zdHJpbmcsICRkZWNvZGVkX3NpZywgJHB1YmxpY2tleWlkKTsKCiAgICAvLyBSZWxl
YXNlIHRoZSBrZXkgcmVzb3VyY2UKICAgIG9wZW5zc2xfZnJlZV9rZXkoJHB1YmxpY2tleWlk
KTsKCiAgICByZXR1cm4gJG9rID09IDE7CiAgfQp9CgpjbGFzcyBPQXV0aFJlcXVlc3Qgewog
IHByaXZhdGUgJHBhcmFtZXRlcnM7CiAgcHJpdmF0ZSAkaHR0cF9tZXRob2Q7CiAgcHJpdmF0
ZSAkaHR0cF91cmw7CiAgLy8gZm9yIGRlYnVnIHB1cnBvc2VzCiAgcHVibGljICRiYXNlX3N0
cmluZzsKICBwdWJsaWMgc3RhdGljICR2ZXJzaW9uID0gJzEuMCc7CiAgcHVibGljIHN0YXRp
YyAkUE9TVF9JTlBVVCA9ICdwaHA6Ly9pbnB1dCc7CgogIGZ1bmN0aW9uIF9fY29uc3RydWN0
KCRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVycz1OVUxMKSB7CiAgICBAJHBh
cmFtZXRlcnMgb3IgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgJHBhcmFtZXRlcnMgPSBh
cnJheV9tZXJnZSggT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKHBhcnNlX3VybCgkaHR0
cF91cmwsIFBIUF9VUkxfUVVFUlkpKSwgJHBhcmFtZXRlcnMpOwogICAgJHRoaXMtPnBhcmFt
ZXRlcnMgPSAkcGFyYW1ldGVyczsKICAgICR0aGlzLT5odHRwX21ldGhvZCA9ICRodHRwX21l
dGhvZDsKICAgICR0aGlzLT5odHRwX3VybCA9ICRodHRwX3VybDsKICB9CgoKICAvKioKICAg
KiBhdHRlbXB0IHRvIGJ1aWxkIHVwIGEgcmVxdWVzdCBmcm9tIHdoYXQgd2FzIHBhc3NlZCB0
byB0aGUgc2VydmVyCiAgICovCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBmcm9tX3JlcXVl
c3QoJGh0dHBfbWV0aG9kPU5VTEwsICRodHRwX3VybD1OVUxMLCAkcGFyYW1ldGVycz1OVUxM
KSB7CiAgICAkc2NoZW1lID0gKCFpc3NldCgkX1NFUlZFUlsnSFRUUFMnXSkgfHwgJF9TRVJW
RVJbJ0hUVFBTJ10gIT0gIm9uIikKICAgICAgICAgICAgICA/ICdodHRwJwogICAgICAgICAg
ICAgIDogJ2h0dHBzJzsKICAgIEAkaHR0cF91cmwgb3IgJGh0dHBfdXJsID0gJHNjaGVtZSAu
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc6Ly8nIC4gJF9TRVJWRVJbJ0hUVFBf
SE9TVCddIC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzonIC4KICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgJF9TRVJWRVJbJ1NFUlZFUl9QT1JUJ10gLgogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAkX1NFUlZFUlsnUkVRVUVTVF9VUkknXTsKICAgIEAk
aHR0cF9tZXRob2Qgb3IgJGh0dHBfbWV0aG9kID0gJF9TRVJWRVJbJ1JFUVVFU1RfTUVUSE9E
J107CgogICAgLy8gV2Ugd2VyZW4ndCBoYW5kZWQgYW55IHBhcmFtZXRlcnMsIHNvIGxldCdz
IGZpbmQgdGhlIG9uZXMgcmVsZXZhbnQgdG8KICAgIC8vIHRoaXMgcmVxdWVzdC4KICAgIC8v
IElmIHlvdSBydW4gWE1MLVJQQyBvciBzaW1pbGFyIHlvdSBzaG91bGQgdXNlIHRoaXMgdG8g
cHJvdmlkZSB5b3VyIG93bgogICAgLy8gcGFyc2VkIHBhcmFtZXRlci1saXN0CiAgICBpZiAo
ISRwYXJhbWV0ZXJzKSB7CiAgICAgIC8vIEZpbmQgcmVxdWVzdCBoZWFkZXJzCiAgICAgICRy
ZXF1ZXN0X2hlYWRlcnMgPSBPQXV0aFV0aWw6OmdldF9oZWFkZXJzKCk7CgogICAgICAvLyBQ
YXJzZSB0aGUgcXVlcnktc3RyaW5nIHRvIGZpbmQgR0VUIHBhcmFtZXRlcnMKICAgICAgJHBh
cmFtZXRlcnMgPSBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMoJF9TRVJWRVJbJ1FVRVJZ
X1NUUklORyddKTsKCiAgICAgIC8vIEl0J3MgYSBQT1NUIHJlcXVlc3Qgb2YgdGhlIHByb3Bl
ciBjb250ZW50LXR5cGUsIHNvIHBhcnNlIFBPU1QKICAgICAgLy8gcGFyYW1ldGVycyBhbmQg
YWRkIHRob3NlIG92ZXJyaWRpbmcgYW55IGR1cGxpY2F0ZXMgZnJvbSBHRVQKICAgICAgaWYg
KCRodHRwX21ldGhvZCA9PSAiUE9TVCIKICAgICAgICAgICYmIEBzdHJzdHIoJHJlcXVlc3Rf
aGVhZGVyc1siQ29udGVudC1UeXBlIl0sCiAgICAgICAgICAgICAgICAgICAgICJhcHBsaWNh
dGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKQogICAgICAgICAgKSB7CiAgICAgICAgJHBv
c3RfZGF0YSA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygKICAgICAgICAgIGZpbGVf
Z2V0X2NvbnRlbnRzKHNlbGY6OiRQT1NUX0lOUFVUKQogICAgICAgICk7CiAgICAgICAgJHBh
cmFtZXRlcnMgPSBhcnJheV9tZXJnZSgkcGFyYW1ldGVycywgJHBvc3RfZGF0YSk7CiAgICAg
IH0KCiAgICAgIC8vIFdlIGhhdmUgYSBBdXRob3JpemF0aW9uLWhlYWRlciB3aXRoIE9BdXRo
IGRhdGEuIFBhcnNlIHRoZSBoZWFkZXIKICAgICAgLy8gYW5kIGFkZCB0aG9zZSBvdmVycmlk
aW5nIGFueSBkdXBsaWNhdGVzIGZyb20gR0VUIG9yIFBPU1QKICAgICAgaWYgKEBzdWJzdHIo
JHJlcXVlc3RfaGVhZGVyc1snQXV0aG9yaXphdGlvbiddLCAwLCA2KSA9PSAiT0F1dGggIikg
ewogICAgICAgICRoZWFkZXJfcGFyYW1ldGVycyA9IE9BdXRoVXRpbDo6c3BsaXRfaGVhZGVy
KAogICAgICAgICAgJHJlcXVlc3RfaGVhZGVyc1snQXV0aG9yaXphdGlvbiddCiAgICAgICAg
KTsKICAgICAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCRwYXJhbWV0ZXJzLCAkaGVh
ZGVyX3BhcmFtZXRlcnMpOwogICAgICB9CgogICAgfQoKICAgIHJldHVybiBuZXcgT0F1dGhS
ZXF1ZXN0KCRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVycyk7CiAgfQoKICAv
KioKICAgKiBwcmV0dHkgbXVjaCBhIGhlbHBlciBmdW5jdGlvbiB0byBzZXQgdXAgdGhlIHJl
cXVlc3QKICAgKi8KICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGZyb21fY29uc3VtZXJfYW5k
X3Rva2VuKCRjb25zdW1lciwgJHRva2VuLCAkaHR0cF9tZXRob2QsICRodHRwX3VybCwgJHBh
cmFtZXRlcnM9TlVMTCkgewogICAgQCRwYXJhbWV0ZXJzIG9yICRwYXJhbWV0ZXJzID0gYXJy
YXkoKTsKICAgICRkZWZhdWx0cyA9IGFycmF5KCJvYXV0aF92ZXJzaW9uIiA9PiBPQXV0aFJl
cXVlc3Q6OiR2ZXJzaW9uLAogICAgICAgICAgICAgICAgICAgICAgIm9hdXRoX25vbmNlIiA9
PiBPQXV0aFJlcXVlc3Q6OmdlbmVyYXRlX25vbmNlKCksCiAgICAgICAgICAgICAgICAgICAg
ICAib2F1dGhfdGltZXN0YW1wIiA9PiBPQXV0aFJlcXVlc3Q6OmdlbmVyYXRlX3RpbWVzdGFt
cCgpLAogICAgICAgICAgICAgICAgICAgICAgIm9hdXRoX2NvbnN1bWVyX2tleSIgPT4gJGNv
bnN1bWVyLT5rZXkpOwogICAgaWYgKCR0b2tlbikKICAgICAgJGRlZmF1bHRzWydvYXV0aF90
b2tlbiddID0gJHRva2VuLT5rZXk7CgogICAgJHBhcmFtZXRlcnMgPSBhcnJheV9tZXJnZSgk
ZGVmYXVsdHMsICRwYXJhbWV0ZXJzKTsKCiAgICByZXR1cm4gbmV3IE9BdXRoUmVxdWVzdCgk
aHR0cF9tZXRob2QsICRodHRwX3VybCwgJHBhcmFtZXRlcnMpOwogIH0KCiAgcHVibGljIGZ1
bmN0aW9uIHNldF9wYXJhbWV0ZXIoJG5hbWUsICR2YWx1ZSwgJGFsbG93X2R1cGxpY2F0ZXMg
PSB0cnVlKSB7CiAgICBpZiAoJGFsbG93X2R1cGxpY2F0ZXMgJiYgaXNzZXQoJHRoaXMtPnBh
cmFtZXRlcnNbJG5hbWVdKSkgewogICAgICAvLyBXZSBoYXZlIGFscmVhZHkgYWRkZWQgcGFy
YW1ldGVyKHMpIHdpdGggdGhpcyBuYW1lLCBzbyBhZGQgdG8gdGhlIGxpc3QKICAgICAgaWYg
KGlzX3NjYWxhcigkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pKSB7CiAgICAgICAgLy8gVGhp
cyBpcyB0aGUgZmlyc3QgZHVwbGljYXRlLCBzbyB0cmFuc2Zvcm0gc2NhbGFyIChzdHJpbmcp
CiAgICAgICAgLy8gaW50byBhbiBhcnJheSBzbyB3ZSBjYW4gYWRkIHRoZSBkdXBsaWNhdGVz
CiAgICAgICAgJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdID0gYXJyYXkoJHRoaXMtPnBhcmFt
ZXRlcnNbJG5hbWVdKTsKICAgICAgfQoKICAgICAgJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVd
W10gPSAkdmFsdWU7CiAgICB9IGVsc2UgewogICAgICAkdGhpcy0+cGFyYW1ldGVyc1skbmFt
ZV0gPSAkdmFsdWU7CiAgICB9CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gZ2V0X3BhcmFtZXRl
cigkbmFtZSkgewogICAgcmV0dXJuIGlzc2V0KCR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSkg
PyAkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0gOiBudWxsOwogIH0KCiAgcHVibGljIGZ1bmN0
aW9uIGdldF9wYXJhbWV0ZXJzKCkgewogICAgcmV0dXJuICR0aGlzLT5wYXJhbWV0ZXJzOwog
IH0KCiAgcHVibGljIGZ1bmN0aW9uIHVuc2V0X3BhcmFtZXRlcigkbmFtZSkgewogICAgdW5z
ZXQoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdKTsKICB9CgogIC8qKgogICAqIFRoZSByZXF1
ZXN0IHBhcmFtZXRlcnMsIHNvcnRlZCBhbmQgY29uY2F0ZW5hdGVkIGludG8gYSBub3JtYWxp
emVkIHN0cmluZy4KICAgKiBAcmV0dXJuIHN0cmluZwogICAqLwogIHB1YmxpYyBmdW5jdGlv
biBnZXRfc2lnbmFibGVfcGFyYW1ldGVycygpIHsKICAgIC8vIEdyYWIgYWxsIHBhcmFtZXRl
cnMKICAgICRwYXJhbXMgPSAkdGhpcy0+cGFyYW1ldGVyczsKCiAgICAvLyBSZW1vdmUgb2F1
dGhfc2lnbmF0dXJlIGlmIHByZXNlbnQKICAgIC8vIFJlZjogU3BlYzogOS4xLjEgKCJUaGUg
b2F1dGhfc2lnbmF0dXJlIHBhcmFtZXRlciBNVVNUIGJlIGV4Y2x1ZGVkLiIpCiAgICBpZiAo
aXNzZXQoJHBhcmFtc1snb2F1dGhfc2lnbmF0dXJlJ10pKSB7CiAgICAgIHVuc2V0KCRwYXJh
bXNbJ29hdXRoX3NpZ25hdHVyZSddKTsKICAgIH0KCiAgICByZXR1cm4gT0F1dGhVdGlsOjpi
dWlsZF9odHRwX3F1ZXJ5KCRwYXJhbXMpOwogIH0KCiAgLyoqCiAgICogUmV0dXJucyB0aGUg
YmFzZSBzdHJpbmcgb2YgdGhpcyByZXF1ZXN0CiAgICoKICAgKiBUaGUgYmFzZSBzdHJpbmcg
ZGVmaW5lZCBhcyB0aGUgbWV0aG9kLCB0aGUgdXJsCiAgICogYW5kIHRoZSBwYXJhbWV0ZXJz
IChub3JtYWxpemVkKSwgZWFjaCB1cmxlbmNvZGVkCiAgICogYW5kIHRoZSBjb25jYXRlZCB3
aXRoICYuCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGdldF9zaWduYXR1cmVfYmFzZV9zdHJp
bmcoKSB7CiAgICAkcGFydHMgPSBhcnJheSgKICAgICAgJHRoaXMtPmdldF9ub3JtYWxpemVk
X2h0dHBfbWV0aG9kKCksCiAgICAgICR0aGlzLT5nZXRfbm9ybWFsaXplZF9odHRwX3VybCgp
LAogICAgICAkdGhpcy0+Z2V0X3NpZ25hYmxlX3BhcmFtZXRlcnMoKQogICAgKTsKCiAgICAk
cGFydHMgPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCRwYXJ0cyk7CgogICAgcmV0
dXJuIGltcGxvZGUoJyYnLCAkcGFydHMpOwogIH0KCiAgLyoqCiAgICoganVzdCB1cHBlcmNh
c2VzIHRoZSBodHRwIG1ldGhvZAogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBnZXRfbm9ybWFs
aXplZF9odHRwX21ldGhvZCgpIHsKICAgIHJldHVybiBzdHJ0b3VwcGVyKCR0aGlzLT5odHRw
X21ldGhvZCk7CiAgfQoKICAvKioKICAgKiBwYXJzZXMgdGhlIHVybCBhbmQgcmVidWlsZHMg
aXQgdG8gYmUKICAgKiBzY2hlbWU6Ly9ob3N0L3BhdGgKICAgKi8KICBwdWJsaWMgZnVuY3Rp
b24gZ2V0X25vcm1hbGl6ZWRfaHR0cF91cmwoKSB7CiAgICAkcGFydHMgPSBwYXJzZV91cmwo
JHRoaXMtPmh0dHBfdXJsKTsKCiAgICAkcG9ydCA9IEAkcGFydHNbJ3BvcnQnXTsKICAgICRz
Y2hlbWUgPSAkcGFydHNbJ3NjaGVtZSddOwogICAgJGhvc3QgPSAkcGFydHNbJ2hvc3QnXTsK
ICAgICRwYXRoID0gQCRwYXJ0c1sncGF0aCddOwoKICAgICRwb3J0IG9yICRwb3J0ID0gKCRz
Y2hlbWUgPT0gJ2h0dHBzJykgPyAnNDQzJyA6ICc4MCc7CgogICAgaWYgKCgkc2NoZW1lID09
ICdodHRwcycgJiYgJHBvcnQgIT0gJzQ0MycpCiAgICAgICAgfHwgKCRzY2hlbWUgPT0gJ2h0
dHAnICYmICRwb3J0ICE9ICc4MCcpKSB7CiAgICAgICRob3N0ID0gIiRob3N0OiRwb3J0IjsK
ICAgIH0KICAgIHJldHVybiAiJHNjaGVtZTovLyRob3N0JHBhdGgiOwogIH0KCiAgLyoqCiAg
ICogYnVpbGRzIGEgdXJsIHVzYWJsZSBmb3IgYSBHRVQgcmVxdWVzdAogICAqLwogIHB1Ymxp
YyBmdW5jdGlvbiB0b191cmwoKSB7CiAgICAkcG9zdF9kYXRhID0gJHRoaXMtPnRvX3Bvc3Rk
YXRhKCk7CiAgICAkb3V0ID0gJHRoaXMtPmdldF9ub3JtYWxpemVkX2h0dHBfdXJsKCk7CiAg
ICBpZiAoJHBvc3RfZGF0YSkgewogICAgICAkb3V0IC49ICc/Jy4kcG9zdF9kYXRhOwogICAg
fQogICAgcmV0dXJuICRvdXQ7CiAgfQoKICAvKioKICAgKiBidWlsZHMgdGhlIGRhdGEgb25l
IHdvdWxkIHNlbmQgaW4gYSBQT1NUIHJlcXVlc3QKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24g
dG9fcG9zdGRhdGEoKSB7CiAgICByZXR1cm4gT0F1dGhVdGlsOjpidWlsZF9odHRwX3F1ZXJ5
KCR0aGlzLT5wYXJhbWV0ZXJzKTsKICB9CgogIC8qKgogICAqIGJ1aWxkcyB0aGUgQXV0aG9y
aXphdGlvbjogaGVhZGVyCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIHRvX2hlYWRlcigkcmVh
bG09bnVsbCkgewogICAgJGZpcnN0ID0gdHJ1ZTsKICBpZigkcmVhbG0pIHsKICAgICAgJG91
dCA9ICdBdXRob3JpemF0aW9uOiBPQXV0aCByZWFsbT0iJyAuIE9BdXRoVXRpbDo6dXJsZW5j
b2RlX3JmYzM5ODYoJHJlYWxtKSAuICciJzsKICAgICAgJGZpcnN0ID0gZmFsc2U7CiAgICB9
IGVsc2UKICAgICAgJG91dCA9ICdBdXRob3JpemF0aW9uOiBPQXV0aCc7CgogICAgJHRvdGFs
ID0gYXJyYXkoKTsKICAgIGZvcmVhY2ggKCR0aGlzLT5wYXJhbWV0ZXJzIGFzICRrID0+ICR2
KSB7CiAgICAgIGlmIChzdWJzdHIoJGssIDAsIDUpICE9ICJvYXV0aCIpIGNvbnRpbnVlOwog
ICAgICBpZiAoaXNfYXJyYXkoJHYpKSB7CiAgICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0
aW9uKCdBcnJheXMgbm90IHN1cHBvcnRlZCBpbiBoZWFkZXJzJyk7CiAgICAgIH0KICAgICAg
JG91dCAuPSAoJGZpcnN0KSA/ICcgJyA6ICcsJzsKICAgICAgJG91dCAuPSBPQXV0aFV0aWw6
OnVybGVuY29kZV9yZmMzOTg2KCRrKSAuCiAgICAgICAgICAgICAgJz0iJyAuCiAgICAgICAg
ICAgICAgT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkdikgLgogICAgICAgICAgICAg
ICciJzsKICAgICAgJGZpcnN0ID0gZmFsc2U7CiAgICB9CiAgICByZXR1cm4gJG91dDsKICB9
CgogIHB1YmxpYyBmdW5jdGlvbiBfX3RvU3RyaW5nKCkgewogICAgcmV0dXJuICR0aGlzLT50
b191cmwoKTsKICB9CgoKICBwdWJsaWMgZnVuY3Rpb24gc2lnbl9yZXF1ZXN0KCRzaWduYXR1
cmVfbWV0aG9kLCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJHRoaXMtPnNldF9wYXJhbWV0
ZXIoCiAgICAgICJvYXV0aF9zaWduYXR1cmVfbWV0aG9kIiwKICAgICAgJHNpZ25hdHVyZV9t
ZXRob2QtPmdldF9uYW1lKCksCiAgICAgIGZhbHNlCiAgICApOwogICAgJHNpZ25hdHVyZSA9
ICR0aGlzLT5idWlsZF9zaWduYXR1cmUoJHNpZ25hdHVyZV9tZXRob2QsICRjb25zdW1lciwg
JHRva2VuKTsKICAgICR0aGlzLT5zZXRfcGFyYW1ldGVyKCJvYXV0aF9zaWduYXR1cmUiLCAk
c2lnbmF0dXJlLCBmYWxzZSk7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2lnbmF0
dXJlKCRzaWduYXR1cmVfbWV0aG9kLCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJHNpZ25h
dHVyZSA9ICRzaWduYXR1cmVfbWV0aG9kLT5idWlsZF9zaWduYXR1cmUoJHRoaXMsICRjb25z
dW1lciwgJHRva2VuKTsKICAgIHJldHVybiAkc2lnbmF0dXJlOwogIH0KCiAgLyoqCiAgICog
dXRpbCBmdW5jdGlvbjogY3VycmVudCB0aW1lc3RhbXAKICAgKi8KICBwcml2YXRlIHN0YXRp
YyBmdW5jdGlvbiBnZW5lcmF0ZV90aW1lc3RhbXAoKSB7CiAgICByZXR1cm4gdGltZSgpOwog
IH0KCiAgLyoqCiAgICogdXRpbCBmdW5jdGlvbjogY3VycmVudCBub25jZQogICAqLwogIHBy
aXZhdGUgc3RhdGljIGZ1bmN0aW9uIGdlbmVyYXRlX25vbmNlKCkgewogICAgJG10ID0gbWlj
cm90aW1lKCk7CiAgICAkcmFuZCA9IG10X3JhbmQoKTsKCiAgICByZXR1cm4gbWQ1KCRtdCAu
ICRyYW5kKTsgLy8gbWQ1cyBsb29rIG5pY2VyIHRoYW4gbnVtYmVycwogIH0KfQoKY2xhc3Mg
T0F1dGhTZXJ2ZXIgewogIHByb3RlY3RlZCAkdGltZXN0YW1wX3RocmVzaG9sZCA9IDMwMDsg
Ly8gaW4gc2Vjb25kcywgZml2ZSBtaW51dGVzCiAgcHJvdGVjdGVkICR2ZXJzaW9uID0gJzEu
MCc7ICAgICAgICAgICAgIC8vIGhpIGJsYWluZQogIHByb3RlY3RlZCAkc2lnbmF0dXJlX21l
dGhvZHMgPSBhcnJheSgpOwoKICBwcm90ZWN0ZWQgJGRhdGFfc3RvcmU7CgogIGZ1bmN0aW9u
IF9fY29uc3RydWN0KCRkYXRhX3N0b3JlKSB7CiAgICAkdGhpcy0+ZGF0YV9zdG9yZSA9ICRk
YXRhX3N0b3JlOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGFkZF9zaWduYXR1cmVfbWV0aG9k
KCRzaWduYXR1cmVfbWV0aG9kKSB7CiAgICAkdGhpcy0+c2lnbmF0dXJlX21ldGhvZHNbJHNp
Z25hdHVyZV9tZXRob2QtPmdldF9uYW1lKCldID0KICAgICAgJHNpZ25hdHVyZV9tZXRob2Q7
CiAgfQoKICAvLyBoaWdoIGxldmVsIGZ1bmN0aW9ucwoKICAvKioKICAgKiBwcm9jZXNzIGEg
cmVxdWVzdF90b2tlbiByZXF1ZXN0CiAgICogcmV0dXJucyB0aGUgcmVxdWVzdCB0b2tlbiBv
biBzdWNjZXNzCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGZldGNoX3JlcXVlc3RfdG9rZW4o
JiRyZXF1ZXN0KSB7CiAgICAkdGhpcy0+Z2V0X3ZlcnNpb24oJHJlcXVlc3QpOwoKICAgICRj
b25zdW1lciA9ICR0aGlzLT5nZXRfY29uc3VtZXIoJHJlcXVlc3QpOwoKICAgIC8vIG5vIHRv
a2VuIHJlcXVpcmVkIGZvciB0aGUgaW5pdGlhbCB0b2tlbiByZXF1ZXN0CiAgICAkdG9rZW4g
PSBOVUxMOwoKICAgICR0aGlzLT5jaGVja19zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1l
ciwgJHRva2VuKTsKCiAgICAvLyBSZXYgQSBjaGFuZ2UKICAgICRjYWxsYmFjayA9ICRyZXF1
ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF9jYWxsYmFjaycpOwogICAgJG5ld190b2tlbiA9
ICR0aGlzLT5kYXRhX3N0b3JlLT5uZXdfcmVxdWVzdF90b2tlbigkY29uc3VtZXIsICRjYWxs
YmFjayk7CgogICAgcmV0dXJuICRuZXdfdG9rZW47CiAgfQoKICAvKioKICAgKiBwcm9jZXNz
IGFuIGFjY2Vzc190b2tlbiByZXF1ZXN0CiAgICogcmV0dXJucyB0aGUgYWNjZXNzIHRva2Vu
IG9uIHN1Y2Nlc3MKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZmV0Y2hfYWNjZXNzX3Rva2Vu
KCYkcmVxdWVzdCkgewogICAgJHRoaXMtPmdldF92ZXJzaW9uKCRyZXF1ZXN0KTsKCiAgICAk
Y29uc3VtZXIgPSAkdGhpcy0+Z2V0X2NvbnN1bWVyKCRyZXF1ZXN0KTsKCiAgICAvLyByZXF1
aXJlcyBhdXRob3JpemVkIHJlcXVlc3QgdG9rZW4KICAgICR0b2tlbiA9ICR0aGlzLT5nZXRf
dG9rZW4oJHJlcXVlc3QsICRjb25zdW1lciwgInJlcXVlc3QiKTsKCiAgICAkdGhpcy0+Y2hl
Y2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7CgogICAgLy8gUmV2
IEEgY2hhbmdlCiAgICAkdmVyaWZpZXIgPSAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1
dGhfdmVyaWZpZXInKTsKICAgICRuZXdfdG9rZW4gPSAkdGhpcy0+ZGF0YV9zdG9yZS0+bmV3
X2FjY2Vzc190b2tlbigkdG9rZW4sICRjb25zdW1lciwgJHZlcmlmaWVyKTsKCiAgICByZXR1
cm4gJG5ld190b2tlbjsKICB9CgogIC8qKgogICAqIHZlcmlmeSBhbiBhcGkgY2FsbCwgY2hl
Y2tzIGFsbCB0aGUgcGFyYW1ldGVycwogICAqLwogIHB1YmxpYyBmdW5jdGlvbiB2ZXJpZnlf
cmVxdWVzdCgmJHJlcXVlc3QpIHsKICAgICR0aGlzLT5nZXRfdmVyc2lvbigkcmVxdWVzdCk7
CiAgICAkY29uc3VtZXIgPSAkdGhpcy0+Z2V0X2NvbnN1bWVyKCRyZXF1ZXN0KTsKICAgICR0
b2tlbiA9ICR0aGlzLT5nZXRfdG9rZW4oJHJlcXVlc3QsICRjb25zdW1lciwgImFjY2VzcyIp
OwogICAgJHRoaXMtPmNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9r
ZW4pOwogICAgcmV0dXJuIGFycmF5KCRjb25zdW1lciwgJHRva2VuKTsKICB9CgogIC8vIElu
dGVybmFscyBmcm9tIGhlcmUKICAvKioKICAgKiB2ZXJzaW9uIDEKICAgKi8KICBwcml2YXRl
IGZ1bmN0aW9uIGdldF92ZXJzaW9uKCYkcmVxdWVzdCkgewogICAgJHZlcnNpb24gPSAkcmVx
dWVzdC0+Z2V0X3BhcmFtZXRlcigib2F1dGhfdmVyc2lvbiIpOwogICAgaWYgKCEkdmVyc2lv
bikgewogICAgICAvLyBTZXJ2aWNlIFByb3ZpZGVycyBNVVNUIGFzc3VtZSB0aGUgcHJvdG9j
b2wgdmVyc2lvbiB0byBiZSAxLjAgaWYgdGhpcyBwYXJhbWV0ZXIgaXMgbm90IHByZXNlbnQu
CiAgICAgIC8vIENoYXB0ZXIgNy4wICgiQWNjZXNzaW5nIFByb3RlY3RlZCBSZXNzb3VyY2Vz
IikKICAgICAgJHZlcnNpb24gPSAnMS4wJzsKICAgIH0KICAgIGlmICgkdmVyc2lvbiAhPT0g
JHRoaXMtPnZlcnNpb24pIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJPQXV0
aCB2ZXJzaW9uICckdmVyc2lvbicgbm90IHN1cHBvcnRlZCIpOwogICAgfQogICAgcmV0dXJu
ICR2ZXJzaW9uOwogIH0KCiAgLyoqCiAgICogZmlndXJlIG91dCB0aGUgc2lnbmF0dXJlIHdp
dGggc29tZSBkZWZhdWx0cwogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X3NpZ25hdHVy
ZV9tZXRob2QoJiRyZXF1ZXN0KSB7CiAgICAkc2lnbmF0dXJlX21ldGhvZCA9CiAgICAgICAg
QCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCJvYXV0aF9zaWduYXR1cmVfbWV0aG9kIik7Cgog
ICAgaWYgKCEkc2lnbmF0dXJlX21ldGhvZCkgewogICAgICAvLyBBY2NvcmRpbmcgdG8gY2hh
cHRlciA3ICgiQWNjZXNzaW5nIFByb3RlY3RlZCBSZXNzb3VyY2VzIikgdGhlIHNpZ25hdHVy
ZS1tZXRob2QKICAgICAgLy8gcGFyYW1ldGVyIGlzIHJlcXVpcmVkLCBhbmQgd2UgY2FuJ3Qg
anVzdCBmYWxsYmFjayB0byBQTEFJTlRFWFQKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0
aW9uKCdObyBzaWduYXR1cmUgbWV0aG9kIHBhcmFtZXRlci4gVGhpcyBwYXJhbWV0ZXIgaXMg
cmVxdWlyZWQnKTsKICAgIH0KCiAgICBpZiAoIWluX2FycmF5KCRzaWduYXR1cmVfbWV0aG9k
LAogICAgICAgICAgICAgICAgICBhcnJheV9rZXlzKCR0aGlzLT5zaWduYXR1cmVfbWV0aG9k
cykpKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigKICAgICAgICAiU2lnbmF0
dXJlIG1ldGhvZCAnJHNpZ25hdHVyZV9tZXRob2QnIG5vdCBzdXBwb3J0ZWQgIiAuCiAgICAg
ICAgInRyeSBvbmUgb2YgdGhlIGZvbGxvd2luZzogIiAuCiAgICAgICAgaW1wbG9kZSgiLCAi
LCBhcnJheV9rZXlzKCR0aGlzLT5zaWduYXR1cmVfbWV0aG9kcykpCiAgICAgICk7CiAgICB9
CiAgICByZXR1cm4gJHRoaXMtPnNpZ25hdHVyZV9tZXRob2RzWyRzaWduYXR1cmVfbWV0aG9k
XTsKICB9CgogIC8qKgogICAqIHRyeSB0byBmaW5kIHRoZSBjb25zdW1lciBmb3IgdGhlIHBy
b3ZpZGVkIHJlcXVlc3QncyBjb25zdW1lciBrZXkKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9u
IGdldF9jb25zdW1lcigmJHJlcXVlc3QpIHsKICAgICRjb25zdW1lcl9rZXkgPSBAJHJlcXVl
c3QtPmdldF9wYXJhbWV0ZXIoIm9hdXRoX2NvbnN1bWVyX2tleSIpOwogICAgaWYgKCEkY29u
c3VtZXJfa2V5KSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiSW52YWxpZCBj
b25zdW1lciBrZXkiKTsKICAgIH0KCiAgICAkY29uc3VtZXIgPSAkdGhpcy0+ZGF0YV9zdG9y
ZS0+bG9va3VwX2NvbnN1bWVyKCRjb25zdW1lcl9rZXkpOwogICAgaWYgKCEkY29uc3VtZXIp
IHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJbnZhbGlkIGNvbnN1bWVyIik7
CiAgICB9CgogICAgcmV0dXJuICRjb25zdW1lcjsKICB9CgogIC8qKgogICAqIHRyeSB0byBm
aW5kIHRoZSB0b2tlbiBmb3IgdGhlIHByb3ZpZGVkIHJlcXVlc3QncyB0b2tlbiBrZXkKICAg
Ki8KICBwcml2YXRlIGZ1bmN0aW9uIGdldF90b2tlbigmJHJlcXVlc3QsICRjb25zdW1lciwg
JHRva2VuX3R5cGU9ImFjY2VzcyIpIHsKICAgICR0b2tlbl9maWVsZCA9IEAkcmVxdWVzdC0+
Z2V0X3BhcmFtZXRlcignb2F1dGhfdG9rZW4nKTsKICAgICR0b2tlbiA9ICR0aGlzLT5kYXRh
X3N0b3JlLT5sb29rdXBfdG9rZW4oCiAgICAgICRjb25zdW1lciwgJHRva2VuX3R5cGUsICR0
b2tlbl9maWVsZAogICAgKTsKICAgIGlmICghJHRva2VuKSB7CiAgICAgIHRocm93IG5ldyBP
QXV0aEV4Y2VwdGlvbigiSW52YWxpZCAkdG9rZW5fdHlwZSB0b2tlbjogJHRva2VuX2ZpZWxk
Iik7CiAgICB9CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAgLyoqCiAgICogYWxsLWluLW9u
ZSBmdW5jdGlvbiB0byBjaGVjayB0aGUgc2lnbmF0dXJlIG9uIGEgcmVxdWVzdAogICAqIHNo
b3VsZCBndWVzcyB0aGUgc2lnbmF0dXJlIG1ldGhvZCBhcHByb3ByaWF0ZWx5CiAgICovCiAg
cHJpdmF0ZSBmdW5jdGlvbiBjaGVja19zaWduYXR1cmUoJiRyZXF1ZXN0LCAkY29uc3VtZXIs
ICR0b2tlbikgewogICAgLy8gdGhpcyBzaG91bGQgcHJvYmFibHkgYmUgaW4gYSBkaWZmZXJl
bnQgbWV0aG9kCiAgICAkdGltZXN0YW1wID0gQCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdv
YXV0aF90aW1lc3RhbXAnKTsKICAgICRub25jZSA9IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRl
cignb2F1dGhfbm9uY2UnKTsKCiAgICAkdGhpcy0+Y2hlY2tfdGltZXN0YW1wKCR0aW1lc3Rh
bXApOwogICAgJHRoaXMtPmNoZWNrX25vbmNlKCRjb25zdW1lciwgJHRva2VuLCAkbm9uY2Us
ICR0aW1lc3RhbXApOwoKICAgICRzaWduYXR1cmVfbWV0aG9kID0gJHRoaXMtPmdldF9zaWdu
YXR1cmVfbWV0aG9kKCRyZXF1ZXN0KTsKCiAgICAkc2lnbmF0dXJlID0gJHJlcXVlc3QtPmdl
dF9wYXJhbWV0ZXIoJ29hdXRoX3NpZ25hdHVyZScpOwogICAgJHZhbGlkX3NpZyA9ICRzaWdu
YXR1cmVfbWV0aG9kLT5jaGVja19zaWduYXR1cmUoCiAgICAgICRyZXF1ZXN0LAogICAgICAk
Y29uc3VtZXIsCiAgICAgICR0b2tlbiwKICAgICAgJHNpZ25hdHVyZQogICAgKTsKCiAgICBp
ZiAoISR2YWxpZF9zaWcpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJbnZh
bGlkIHNpZ25hdHVyZSIpOwogICAgfQogIH0KCiAgLyoqCiAgICogY2hlY2sgdGhhdCB0aGUg
dGltZXN0YW1wIGlzIG5ldyBlbm91Z2gKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGNoZWNr
X3RpbWVzdGFtcCgkdGltZXN0YW1wKSB7CiAgICBpZiggISAkdGltZXN0YW1wICkKICAgICAg
dGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKAogICAgICAgICdNaXNzaW5nIHRpbWVzdGFtcCBw
YXJhbWV0ZXIuIFRoZSBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQnCiAgICAgICk7CgogICAgLy8g
dmVyaWZ5IHRoYXQgdGltZXN0YW1wIGlzIHJlY2VudGlzaAogICAgJG5vdyA9IHRpbWUoKTsK
ICAgIGlmIChhYnMoJG5vdyAtICR0aW1lc3RhbXApID4gJHRoaXMtPnRpbWVzdGFtcF90aHJl
c2hvbGQpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKAogICAgICAgICJFeHBp
cmVkIHRpbWVzdGFtcCwgeW91cnMgJHRpbWVzdGFtcCwgb3VycyAkbm93IgogICAgICApOwog
ICAgfQogIH0KCiAgLyoqCiAgICogY2hlY2sgdGhhdCB0aGUgbm9uY2UgaXMgbm90IHJlcGVh
dGVkCiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBjaGVja19ub25jZSgkY29uc3VtZXIsICR0
b2tlbiwgJG5vbmNlLCAkdGltZXN0YW1wKSB7CiAgICBpZiggISAkbm9uY2UgKQogICAgICB0
aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAgICAgJ01pc3Npbmcgbm9uY2UgcGFyYW1l
dGVyLiBUaGUgcGFyYW1ldGVyIGlzIHJlcXVpcmVkJwogICAgICApOwoKICAgIC8vIHZlcmlm
eSB0aGF0IHRoZSBub25jZSBpcyB1bmlxdWVpc2gKICAgICRmb3VuZCA9ICR0aGlzLT5kYXRh
X3N0b3JlLT5sb29rdXBfbm9uY2UoCiAgICAgICRjb25zdW1lciwKICAgICAgJHRva2VuLAog
ICAgICAkbm9uY2UsCiAgICAgICR0aW1lc3RhbXAKICAgICk7CiAgICBpZiAoJGZvdW5kKSB7
CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiTm9uY2UgYWxyZWFkeSB1c2VkOiAk
bm9uY2UiKTsKICAgIH0KICB9Cgp9CgpjbGFzcyBPQXV0aERhdGFTdG9yZSB7CiAgZnVuY3Rp
b24gbG9va3VwX2NvbnN1bWVyKCRjb25zdW1lcl9rZXkpIHsKICAgIC8vIGltcGxlbWVudCBt
ZQogIH0KCiAgZnVuY3Rpb24gbG9va3VwX3Rva2VuKCRjb25zdW1lciwgJHRva2VuX3R5cGUs
ICR0b2tlbikgewogICAgLy8gaW1wbGVtZW50IG1lCiAgfQoKICBmdW5jdGlvbiBsb29rdXBf
bm9uY2UoJGNvbnN1bWVyLCAkdG9rZW4sICRub25jZSwgJHRpbWVzdGFtcCkgewogICAgLy8g
aW1wbGVtZW50IG1lCiAgfQoKICBmdW5jdGlvbiBuZXdfcmVxdWVzdF90b2tlbigkY29uc3Vt
ZXIsICRjYWxsYmFjayA9IG51bGwpIHsKICAgIC8vIHJldHVybiBhIG5ldyB0b2tlbiBhdHRh
Y2hlZCB0byB0aGlzIGNvbnN1bWVyCiAgfQoKICBmdW5jdGlvbiBuZXdfYWNjZXNzX3Rva2Vu
KCR0b2tlbiwgJGNvbnN1bWVyLCAkdmVyaWZpZXIgPSBudWxsKSB7CiAgICAvLyByZXR1cm4g
YSBuZXcgYWNjZXNzIHRva2VuIGF0dGFjaGVkIHRvIHRoaXMgY29uc3VtZXIKICAgIC8vIGZv
ciB0aGUgdXNlciBhc3NvY2lhdGVkIHdpdGggdGhpcyB0b2tlbiBpZiB0aGUgcmVxdWVzdCB0
b2tlbgogICAgLy8gaXMgYXV0aG9yaXplZAogICAgLy8gc2hvdWxkIGFsc28gaW52YWxpZGF0
ZSB0aGUgcmVxdWVzdCB0b2tlbgogIH0KCn0KCmNsYXNzIE9BdXRoVXRpbCB7CiAgcHVibGlj
IHN0YXRpYyBmdW5jdGlvbiB1cmxlbmNvZGVfcmZjMzk4NigkaW5wdXQpIHsKICBpZiAoaXNf
YXJyYXkoJGlucHV0KSkgewogICAgcmV0dXJuIGFycmF5X21hcChhcnJheSgnT0F1dGhVdGls
JywgJ3VybGVuY29kZV9yZmMzOTg2JyksICRpbnB1dCk7CiAgfSBlbHNlIGlmIChpc19zY2Fs
YXIoJGlucHV0KSkgewogICAgcmV0dXJuIHN0cl9yZXBsYWNlKAogICAgICAnKycsCiAgICAg
ICcgJywKICAgICAgc3RyX3JlcGxhY2UoJyU3RScsICd+JywgcmF3dXJsZW5jb2RlKCRpbnB1
dCkpCiAgICApOwogIH0gZWxzZSB7CiAgICByZXR1cm4gJyc7CiAgfQp9CgoKICAvLyBUaGlz
IGRlY29kZSBmdW5jdGlvbiBpc24ndCB0YWtpbmcgaW50byBjb25zaWRlcmF0aW9uIHRoZSBh
Ym92ZQogIC8vIG1vZGlmaWNhdGlvbnMgdG8gdGhlIGVuY29kaW5nIHByb2Nlc3MuIEhvd2V2
ZXIsIHRoaXMgbWV0aG9kIGRvZXNuJ3QKICAvLyBzZWVtIHRvIGJlIHVzZWQgYW55d2hlcmUg
c28gbGVhdmluZyBpdCBhcyBpcy4KICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHVybGRlY29k
ZV9yZmMzOTg2KCRzdHJpbmcpIHsKICAgIHJldHVybiB1cmxkZWNvZGUoJHN0cmluZyk7CiAg
fQoKICAvLyBVdGlsaXR5IGZ1bmN0aW9uIGZvciB0dXJuaW5nIHRoZSBBdXRob3JpemF0aW9u
OiBoZWFkZXIgaW50bwogIC8vIHBhcmFtZXRlcnMsIGhhcyB0byBkbyBzb21lIHVuZXNjYXBp
bmcKICAvLyBDYW4gZmlsdGVyIG91dCBhbnkgbm9uLW9hdXRoIHBhcmFtZXRlcnMgaWYgbmVl
ZGVkIChkZWZhdWx0IGJlaGF2aW91cikKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHNwbGl0
X2hlYWRlcigkaGVhZGVyLCAkb25seV9hbGxvd19vYXV0aF9wYXJhbWV0ZXJzID0gdHJ1ZSkg
ewogICAgJHBhdHRlcm4gPSAnLygoWy1fYS16XSopPSgiKFteIl0qKSJ8KFteLF0qKSksPykv
JzsKICAgICRvZmZzZXQgPSAwOwogICAgJHBhcmFtcyA9IGFycmF5KCk7CiAgICB3aGlsZSAo
cHJlZ19tYXRjaCgkcGF0dGVybiwgJGhlYWRlciwgJG1hdGNoZXMsIFBSRUdfT0ZGU0VUX0NB
UFRVUkUsICRvZmZzZXQpID4gMCkgewogICAgICAkbWF0Y2ggPSAkbWF0Y2hlc1swXTsKICAg
ICAgJGhlYWRlcl9uYW1lID0gJG1hdGNoZXNbMl1bMF07CiAgICAgICRoZWFkZXJfY29udGVu
dCA9IChpc3NldCgkbWF0Y2hlc1s1XSkpID8gJG1hdGNoZXNbNV1bMF0gOiAkbWF0Y2hlc1s0
XVswXTsKICAgICAgaWYgKHByZWdfbWF0Y2goJy9eb2F1dGhfLycsICRoZWFkZXJfbmFtZSkg
fHwgISRvbmx5X2FsbG93X29hdXRoX3BhcmFtZXRlcnMpIHsKICAgICAgICAkcGFyYW1zWyRo
ZWFkZXJfbmFtZV0gPSBPQXV0aFV0aWw6OnVybGRlY29kZV9yZmMzOTg2KCRoZWFkZXJfY29u
dGVudCk7CiAgICAgIH0KICAgICAgJG9mZnNldCA9ICRtYXRjaFsxXSArIHN0cmxlbigkbWF0
Y2hbMF0pOwogICAgfQoKICAgIGlmIChpc3NldCgkcGFyYW1zWydyZWFsbSddKSkgewogICAg
ICB1bnNldCgkcGFyYW1zWydyZWFsbSddKTsKICAgIH0KCiAgICByZXR1cm4gJHBhcmFtczsK
ICB9CgogIC8vIGhlbHBlciB0byB0cnkgdG8gc29ydCBvdXQgaGVhZGVycyBmb3IgcGVvcGxl
IHdobyBhcmVuJ3QgcnVubmluZyBhcGFjaGUKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGdl
dF9oZWFkZXJzKCkgewogICAgaWYgKGZ1bmN0aW9uX2V4aXN0cygnYXBhY2hlX3JlcXVlc3Rf
aGVhZGVycycpKSB7CiAgICAgIC8vIHdlIG5lZWQgdGhpcyB0byBnZXQgdGhlIGFjdHVhbCBB
dXRob3JpemF0aW9uOiBoZWFkZXIKICAgICAgLy8gYmVjYXVzZSBhcGFjaGUgdGVuZHMgdG8g
dGVsbCB1cyBpdCBkb2Vzbid0IGV4aXN0CiAgICAgICRoZWFkZXJzID0gYXBhY2hlX3JlcXVl
c3RfaGVhZGVycygpOwoKICAgICAgLy8gc2FuaXRpemUgdGhlIG91dHB1dCBvZiBhcGFjaGVf
cmVxdWVzdF9oZWFkZXJzIGJlY2F1c2UKICAgICAgLy8gd2UgYWx3YXlzIHdhbnQgdGhlIGtl
eXMgdG8gYmUgQ2FzZWQtTGlrZS1UaGlzIGFuZCBhcmgoKQogICAgICAvLyByZXR1cm5zIHRo
ZSBoZWFkZXJzIGluIHRoZSBzYW1lIGNhc2UgYXMgdGhleSBhcmUgaW4gdGhlCiAgICAgIC8v
IHJlcXVlc3QKICAgICAgJG91dCA9IGFycmF5KCk7CiAgICAgIGZvcmVhY2goICRoZWFkZXJz
IEFTICRrZXkgPT4gJHZhbHVlICkgewogICAgICAgICRrZXkgPSBzdHJfcmVwbGFjZSgKICAg
ICAgICAgICAgIiAiLAogICAgICAgICAgICAiLSIsCiAgICAgICAgICAgIHVjd29yZHMoc3Ry
dG9sb3dlcihzdHJfcmVwbGFjZSgiLSIsICIgIiwgJGtleSkpKQogICAgICAgICAgKTsKICAg
ICAgICAkb3V0WyRrZXldID0gJHZhbHVlOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICAv
LyBvdGhlcndpc2Ugd2UgZG9uJ3QgaGF2ZSBhcGFjaGUgYW5kIGFyZSBqdXN0IGdvaW5nIHRv
IGhhdmUgdG8gaG9wZQogICAgICAvLyB0aGF0ICRfU0VSVkVSIGFjdHVhbGx5IGNvbnRhaW5z
IHdoYXQgd2UgbmVlZAogICAgICAkb3V0ID0gYXJyYXkoKTsKICAgICAgaWYoIGlzc2V0KCRf
U0VSVkVSWydDT05URU5UX1RZUEUnXSkgKQogICAgICAgICRvdXRbJ0NvbnRlbnQtVHlwZSdd
ID0gJF9TRVJWRVJbJ0NPTlRFTlRfVFlQRSddOwogICAgICBpZiggaXNzZXQoJF9FTlZbJ0NP
TlRFTlRfVFlQRSddKSApCiAgICAgICAgJG91dFsnQ29udGVudC1UeXBlJ10gPSAkX0VOVlsn
Q09OVEVOVF9UWVBFJ107CgogICAgICBmb3JlYWNoICgkX1NFUlZFUiBhcyAka2V5ID0+ICR2
YWx1ZSkgewogICAgICAgIGlmIChzdWJzdHIoJGtleSwgMCwgNSkgPT0gIkhUVFBfIikgewog
ICAgICAgICAgLy8gdGhpcyBpcyBjaGFvcywgYmFzaWNhbGx5IGl0IGlzIGp1c3QgdGhlcmUg
dG8gY2FwaXRhbGl6ZSB0aGUgZmlyc3QKICAgICAgICAgIC8vIGxldHRlciBvZiBldmVyeSB3
b3JkIHRoYXQgaXMgbm90IGFuIGluaXRpYWwgSFRUUCBhbmQgc3RyaXAgSFRUUAogICAgICAg
ICAgLy8gY29kZSBmcm9tIHByemVtZWsKICAgICAgICAgICRrZXkgPSBzdHJfcmVwbGFjZSgK
ICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAiLSIsCiAgICAgICAgICAgIHVjd29yZHMo
c3RydG9sb3dlcihzdHJfcmVwbGFjZSgiXyIsICIgIiwgc3Vic3RyKCRrZXksIDUpKSkpCiAg
ICAgICAgICApOwogICAgICAgICAgJG91dFska2V5XSA9ICR2YWx1ZTsKICAgICAgICB9CiAg
ICAgIH0KICAgIH0KICAgIHJldHVybiAkb3V0OwogIH0KCiAgLy8gVGhpcyBmdW5jdGlvbiB0
YWtlcyBhIGlucHV0IGxpa2UgYT1iJmE9YyZkPWUgYW5kIHJldHVybnMgdGhlIHBhcnNlZAog
IC8vIHBhcmFtZXRlcnMgbGlrZSB0aGlzCiAgLy8gYXJyYXkoJ2EnID0+IGFycmF5KCdiJywn
YycpLCAnZCcgPT4gJ2UnKQogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gcGFyc2VfcGFyYW1l
dGVycyggJGlucHV0ICkgewogICAgaWYgKCFpc3NldCgkaW5wdXQpIHx8ICEkaW5wdXQpIHJl
dHVybiBhcnJheSgpOwoKICAgICRwYWlycyA9IGV4cGxvZGUoJyYnLCAkaW5wdXQpOwoKICAg
ICRwYXJzZWRfcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICBmb3JlYWNoICgkcGFpcnMgYXMg
JHBhaXIpIHsKICAgICAgJHNwbGl0ID0gZXhwbG9kZSgnPScsICRwYWlyLCAyKTsKICAgICAg
JHBhcmFtZXRlciA9IE9BdXRoVXRpbDo6dXJsZGVjb2RlX3JmYzM5ODYoJHNwbGl0WzBdKTsK
ICAgICAgJHZhbHVlID0gaXNzZXQoJHNwbGl0WzFdKSA/IE9BdXRoVXRpbDo6dXJsZGVjb2Rl
X3JmYzM5ODYoJHNwbGl0WzFdKSA6ICcnOwoKICAgICAgaWYgKGlzc2V0KCRwYXJzZWRfcGFy
YW1ldGVyc1skcGFyYW1ldGVyXSkpIHsKICAgICAgICAvLyBXZSBoYXZlIGFscmVhZHkgcmVj
aWV2ZWQgcGFyYW1ldGVyKHMpIHdpdGggdGhpcyBuYW1lLCBzbyBhZGQgdG8gdGhlIGxpc3QK
ICAgICAgICAvLyBvZiBwYXJhbWV0ZXJzIHdpdGggdGhpcyBuYW1lCgogICAgICAgIGlmIChp
c19zY2FsYXIoJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdKSkgewogICAgICAgICAg
Ly8gVGhpcyBpcyB0aGUgZmlyc3QgZHVwbGljYXRlLCBzbyB0cmFuc2Zvcm0gc2NhbGFyIChz
dHJpbmcpIGludG8gYW4gYXJyYXkKICAgICAgICAgIC8vIHNvIHdlIGNhbiBhZGQgdGhlIGR1
cGxpY2F0ZXMKICAgICAgICAgICRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSA9IGFy
cmF5KCRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSk7CiAgICAgICAgfQoKICAgICAg
ICAkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl1bXSA9ICR2YWx1ZTsKICAgICAgfSBl
bHNlIHsKICAgICAgICAkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl0gPSAkdmFsdWU7
CiAgICAgIH0KICAgIH0KICAgIHJldHVybiAkcGFyc2VkX3BhcmFtZXRlcnM7CiAgfQoKICBw
dWJsaWMgc3RhdGljIGZ1bmN0aW9uIGJ1aWxkX2h0dHBfcXVlcnkoJHBhcmFtcykgewogICAg
aWYgKCEkcGFyYW1zKSByZXR1cm4gJyc7CgogICAgLy8gVXJsZW5jb2RlIGJvdGgga2V5cyBh
bmQgdmFsdWVzCiAgICAka2V5cyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoYXJy
YXlfa2V5cygkcGFyYW1zKSk7CiAgICAkdmFsdWVzID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVf
cmZjMzk4NihhcnJheV92YWx1ZXMoJHBhcmFtcykpOwogICAgJHBhcmFtcyA9IGFycmF5X2Nv
bWJpbmUoJGtleXMsICR2YWx1ZXMpOwoKICAgIC8vIFBhcmFtZXRlcnMgYXJlIHNvcnRlZCBi
eSBuYW1lLCB1c2luZyBsZXhpY29ncmFwaGljYWwgYnl0ZSB2YWx1ZSBvcmRlcmluZy4KICAg
IC8vIFJlZjogU3BlYzogOS4xLjEgKDEpCiAgICB1a3NvcnQoJHBhcmFtcywgJ3N0cmNtcCcp
OwoKICAgICRwYWlycyA9IGFycmF5KCk7CiAgICBmb3JlYWNoICgkcGFyYW1zIGFzICRwYXJh
bWV0ZXIgPT4gJHZhbHVlKSB7CiAgICAgIGlmIChpc19hcnJheSgkdmFsdWUpKSB7CiAgICAg
ICAgLy8gSWYgdHdvIG9yIG1vcmUgcGFyYW1ldGVycyBzaGFyZSB0aGUgc2FtZSBuYW1lLCB0
aGV5IGFyZSBzb3J0ZWQgYnkgdGhlaXIgdmFsdWUKICAgICAgICAvLyBSZWY6IFNwZWM6IDku
MS4xICgxKQogICAgICAgIG5hdHNvcnQoJHZhbHVlKTsKICAgICAgICBmb3JlYWNoICgkdmFs
dWUgYXMgJGR1cGxpY2F0ZV92YWx1ZSkgewogICAgICAgICAgJHBhaXJzW10gPSAkcGFyYW1l
dGVyIC4gJz0nIC4gJGR1cGxpY2F0ZV92YWx1ZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7
CiAgICAgICAgJHBhaXJzW10gPSAkcGFyYW1ldGVyIC4gJz0nIC4gJHZhbHVlOwogICAgICB9
CiAgICB9CiAgICAvLyBGb3IgZWFjaCBwYXJhbWV0ZXIsIHRoZSBuYW1lIGlzIHNlcGFyYXRl
ZCBmcm9tIHRoZSBjb3JyZXNwb25kaW5nIHZhbHVlIGJ5IGFuICc9JyBjaGFyYWN0ZXIgKEFT
Q0lJIGNvZGUgNjEpCiAgICAvLyBFYWNoIG5hbWUtdmFsdWUgcGFpciBpcyBzZXBhcmF0ZWQg
YnkgYW4gJyYnIGNoYXJhY3RlciAoQVNDSUkgY29kZSAzOCkKICAgIHJldHVybiBpbXBsb2Rl
KCcmJywgJHBhaXJzKTsKICB9Cn0iO3M6MzoibWQ1IjtzOjMyOiJjYzIxN2NmZDBhNGUxM2U4
M2IwNjNhYjhhNDc3MGU3MSI7fQ==
