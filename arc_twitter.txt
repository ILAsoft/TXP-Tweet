# arc_twitter v2.01
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjQ6
IjIuMDEiO3M6NjoiYXV0aG9yIjtzOjExOiJBbmR5IENhcnRlciI7czoxMDoiYXV0aG9yX3Vy
aSI7czozMToiaHR0cDovL3JlZGhvdGNoaWxsaXByb2plY3QuY29tLyI7czoxMToiZGVzY3Jp
cHRpb24iO3M6NjA6IjxhIGhyZWY9Imh0dHA6Ly93d3cudHdpdHRlci5jb20iPlR3aXR0ZXI8
L2E+IGZvciBUZXh0cGF0dGVybiI7czo1OiJvcmRlciI7czoxOiI1IjtzOjQ6InR5cGUiO3M6
MToiMSI7czo1OiJmbGFncyI7czoxOiIzIjtzOjQ6ImhlbHAiO3M6MTY1NjY6Igk8aDEgY2xh
c3M9InRpdGxlIj48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCAoYXJjX3R3
aXR0ZXIgZm9yIFRleHRwYXR0ZXJuKTwvaDE+CgoJPG9sPgoJCTxsaT48YSBocmVmPSIjYXJj
X3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190
d2l0dGVyX2luc3RhbGxhdGlvbiI+SW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxsYXRpb248L2E+
PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3RhZyI+VGhlIGFyY190d2l0dGVy
IHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfc2VhcmNoX3RhZyI+
VGhlIGFyY190d2l0dGVyX3NlYXJjaCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2Fy
Y190d2l0dGVyX3JldHdlZXRfdGFnIj5UaGUgYXJjX3R3aXR0ZXJfcmV0d2VldCB0YWc8L2E+
PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3R3ZWV0Ij5UaGUgYXJjX3R3aXR0
ZXJfdHdlZXQgdGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl90d2Vl
dF91cmwiPlRoZSBhcmNfdHdpdHRlcl90d2VldF91cmwgdGFnPC9hPjwvbGk+CgkJPGxpPjxh
IGhyZWY9IiNhcmNfdHdpdHRlcl90aW55dXJsIj5UaGUgYXJjX3R3aXR0ZXJfdGlueXVybCB0
YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX2NhY2hpbmciPkNhY2hp
bmc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3ByZWZzIj5QcmVmZXJl
bmNlczwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfYXJ0aWNsZSI+VHdl
ZXRpbmcgYXJ0aWNsZXM8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX2Fk
bWluIj5UaGUgVHdpdHRlciB0YWI8L2E+PC9saT4KCTwvb2w+CgoJPHA+PHNwYW4gY2xhc3M9
ImNhcHMiPlRYUDwvc3Bhbj4gVHdlZXQgcHJvdmlkZXMgYWNjZXNzIHRvIHlvdXIgVHdpdHRl
ciBhY2NvdW50IHRocm91Z2ggYm90aCB0aGUgYWRtaW4gaW50ZXJmYWNlIGFuZCB0aGUgcHVi
bGljIHNpZGUgb2YgeW91ciBzaXRlLiBVcGRhdGUgVHdpdHRlciB3aGVuIHlvdSBwb3N0IGEg
bmV3IGFydGljbGUgKHdpdGggYXJ0aWNsZS1ieS1hcnRpY2xlIG9wdCBvdXQgb3B0aW9uKSwg
dXBkYXRlIGFuZCB2aWV3IHlvdXIgVHdpdHRlciBmZWVkIHRocm91Z2ggdGhlIGFkbWluIFR3
aXR0ZXIgdGFiLCBhbmQgZGlzcGxheSBUd2l0dGVyIGZlZWRzIG9uIHlvdXIgc2l0ZS48L3A+
CgoJPHA+UmVxdWlyZW1lbnRzOi08L3A+CgoJPHVsPgoJCTxsaT5UZXh0cGF0dGVybiA0LjIr
PC9saT4KCQk8bGk+PHNwYW4gY2xhc3M9ImNhcHMiPlBIUDwvc3Bhbj4gNSBhbmQgY1VSTDwv
bGk+Cgk8L3VsPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX2F1dGhv
ciI+QXV0aG9yPC9oMj4KCgk8cD48YSBocmVmPSJodHRwOi8vcmVkaG90Y2hpbGxpcHJvamVj
dC5jb20iPkFuZHkgQ2FydGVyPC9hPi4gRm9yIG90aGVyIFRleHRwYXR0ZXJuIHBsdWdpbnMg
YnkgbWUgdmlzaXQgbXkgPGEgaHJlZj0iaHR0cDovL3JlZGhvdGNoaWxsaXByb2plY3QuY29t
L3R4cCI+UGx1Z2lucyBwYWdlPC9hPi48L3A+CgoJPHA+VGhhbmtzIHRvIDxhIGhyZWY9Imh0
dHA6Ly9tYW5mcmUubmV0LyI+TWljaGFlbCBNYW5mcmU8L2E+IGZvciBpbnNwaXJhdGlvbiBm
b3IgdGhlIGFydGljbGUgdHdlZXQgcGFydCBvZiB0aGlzIHBsdWdpbiBiYXNlZCBvbiBoaXMg
PHNwYW4gY2xhc3M9InRhZyI+bWVtX3R3aXR0ZXI8L3NwYW4+IHBsdWdpbi4gIEFkZGl0aW9u
YWwgdGhhbmtzIHRvIHRoZSBncmVhdCBUZXh0cGF0dGVybiBjb21tdW5pdHkgZm9yIGhlbHBp
bmcgdG8gdGVzdCB0aGlzIHBsdWdpbiBhbmQgZm9yIHN1Z2dlc3RpbmcgbmV3IGZlYXR1cmVz
LiBUaGUgT0F1dGggcGFydCBvZiB0aGUgcGx1Z2luIGlzIHRoYW5rcyB0byA8YSBocmVmPSJo
dHRwOi8vdHdpdHRlci5jb20vYWJyYWhhbSI+QWJyYWhhbSBXaWxsaWFtczwvYT4uPC9wPgoK
CTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX2luc3RhbGxhdGlvbiI+SW5z
dGFsbGF0aW9uIC8gVW5pbnN0YWxsYXRpb248L2gyPgoKCTxwPlRvIGluc3RhbGwgZ28gdG8g
dGhlICYjODIxNjtwbHVnaW5zJiM4MjE3OyB0YWIgdW5kZXIgJiM4MjE2O2FkbWluJiM4MjE3
OyBhbmQgcGFzdGUgdGhlIHBsdWdpbiBjb2RlIGludG8gdGhlICYjODIxNjtJbnN0YWxsIHBs
dWdpbiYjODIxNzsgYm94LCAmIzgyMTY7dXBsb2FkJiM4MjE3OyBhbmQgdGhlbiAmIzgyMTY7
aW5zdGFsbCYjODIxNzsuIEZpbmFsbHkgYWN0aXZhdGUgdGhlIHBsdWdpbi48L3A+CgoJPHA+
QmVmb3JlIHlvdSBzdGFydCB1c2luZyA8c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRlcjwv
c3Bhbj4geW91IHdpbGwgbmVlZCB0byBtYWtlIHN1cmUgdGhhdCB0aGUgY2FjaGUgZGlyZWN0
b3J5IGlzIHdyaXRhYmxlLiBTZWUgdGhlICYjODIxNjtDYWNoaW5nJiM4MjE3OyBzdWJzZWN0
aW9uIGJlbG93IGZvciBmdXJ0aGVyIGluZm9ybWF0aW9uLjwvcD4KCgk8cD48c3BhbiBjbGFz
cz0idGFnIj5hcmNfdHdpdHRlcjwvc3Bhbj4gc2hvdWxkIG5vdyBiZSByZWFkeSBmb3IgdXNl
IG9uIHRoZSBwdWJsaWMtc2lkZSBvZiB5b3VyIHNpdGUuPC9wPgoKCTxwPlRvIHVubG9jayB0
aGUgYWRtaW4gZmVhdHVyZXMgb2YgdGhpcyBwbHVnaW4geW91IHdpbGwgbmVlZCB0byBhc3Nv
Y2lhdGUgeW91ciBzaXRlIHdpdGggYSBUd2l0dGVyIGFjY291bnQgYnkgY29ubmVjdGluZyB0
byBUd2l0dGVyIGZyb20gdGhlIHBsdWdpbiYjODIxNztzIG9wdGlvbnMgc2NyZWVuLiBDbGlj
ayBvbiB0aGUgbGluayB0byBjb25uZWN0IHRvIFR3aXR0ZXIsIHlvdSB3aWxsIGJlIGFza2Vk
IHRvIGxvZ2luIHRvIFR3aXR0ZXIsIGNsaWNraW5nIHRoaXMgbGluayB3aWxsIHRlbXBvcmFy
aWx5IHRha2UgeW91IHRvIHRoZSBUd2l0dGVyIHNpdGUgd2hlcmUgeW91IHdpbGwgYmUgYXNr
ZWQgdG8gbG9naW4gYW5kIGFwcHJvdmUgYWNjZXNzIGZvciA8c3BhbiBjbGFzcz0iY2FwcyI+
VFhQPC9zcGFuPiBUd2VldCB0byByZWFkIGFuZCB3cml0ZSB0byB5b3VyIFR3aXR0ZXIgYWNj
b3VudC4gSWYgYWxsIGlzIHN1Y2Nlc3NmdWwgeW91IHdpbGwgYmUgcmV0dXJuZWQgdG8gdGhl
IG9wdGlvbnMgc2NyZWVuIGFuZCB5b3VyIHVzZXIgbmFtZSB3aWxsIGFwcGVhci48L3A+CgoJ
PHA+QXQgYW55IHRpbWUgeW91IGNhbiBkaXNhc3NvY2lhdGUgeW91ciBUd2l0dGVyIGFjY291
bnQgd2l0aCA8c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCB2aWEgeW91ciBU
d2l0dGVyIGFjY291bnQgcHJlZmVyZW5jZXMgb24gdGhlIDxhIGhyZWY9Imh0dHA6Ly93d3cu
dHdpdHRlci5jb20iPlR3aXR0ZXIgd2Vic2l0ZTwvYT4uPC9wPgoKCTxwPlRvIHVuaW5zdGFs
bCA8c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRlcjwvc3Bhbj4gc2ltcGx5IGRlbGV0ZSB0
aGUgcGx1Z2luIGZyb20gdGhlICYjODIxNjtQbHVnaW5zJiM4MjE3OyB0YWIuICBUaGlzIHdp
bGwgcmVtb3ZlIHRoZSBwbHVnaW4gY29kZSwgZGVsZXRlIHJlbGF0ZWQgcHJlZmVyZW5jZXMg
YW5kIGRyb3AgdGhlIDxzcGFuIGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiB0YWJs
ZSBmcm9tIHlvdXIgVGV4dHBhdHRlcm4gZGF0YWJhc2UuPC9wPgoKCTxoMiBjbGFzcz0ic2Vj
dGlvbiIgaWQ9ImFyY190d2l0dGVyX3RhZyI+VGhlIGFyY190d2l0dGVyIHRhZzwvaDI+CgoJ
PGgzPlN5bnRheDwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlciB1c2VyPSZxdW90O2Ry
bW9ua2V5bmluamEmcXVvdDsgLyZndDs8L3A+CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+
CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4K
CQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+
CgkJCTx0ZD51c2VyPC90ZD4KCQkJPHRkPlR3aXR0ZXIgdXNlciBuYW1lPC90ZD4KCQkJPHRk
PiA8ZW0+YXJjX3R3aXR0ZXIgdXNlcm5hbWU8L2VtPjwvdGQ+CgkJCTx0ZD51c2VyPSZxdW90
O2RybW9ua2V5bmluamEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGltaXQ8
L3RkPgoJCQk8dGQ+TWF4aW11bSBudW1iZXIgb2YgdHdlZXRzIHRvIGRpc3BsYXkgKG1heC4g
MjAwKTwvdGQ+CgkJCTx0ZD4xMDwvdGQ+CgkJCTx0ZD5saW1pdD0mcXVvdDsyNSZxdW90Ozwv
dGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5yZXR3ZWV0czwvdGQ+CgkJCTx0ZD5JbmNsdWRl
IHJldHdlZXRlZCB0d2VldHMgaW4gZmVlZDwvdGQ+CgkJCTx0ZD4wPC90ZD4KCQkJPHRkPnJl
dHdlZXRzPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+dGltZWxp
bmU8L3RkPgoJCQk8dGQ+V2hpY2ggZmVlZCB0byB1c2UgZm9yIHR3ZWV0cywgb3B0aW9ucyBp
bmNsdWRlOiBob21lLCBmcmllbmRzLCBtZW50aW9ucyBhbmQgdXNlcjwvdGQ+CgkJCTx0ZD51
c2VyPC90ZD4KCQkJPHRkPnRpbWVsaW5lPSZxdW90O2hvbWUmcXVvdDs8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+ZGF0ZWZvcm1hdDwvdGQ+CgkJCTx0ZD5Gb3JtYXQgdGhhdCB1cGRh
dGUgZGF0ZXMgd2lsbCBhcHBlYXIgYXM8L3RkPgoJCQk8dGQ+IDxlbT5BcmNoaXZlIGRhdGUg
Zm9ybWF0PC9lbT48L3RkPgoJCQk8dGQ+ZGF0ZWZvcm1hdD0mcXVvdDslYiAlT2UsICVJOiVN
ICVwJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsPC90ZD4KCQkJPHRk
PkxhYmVsIGZvciB0aGUgdG9wIG9mIHRoZSBsaXN0PC90ZD4KCQkJPHRkPiA8ZW0+bm8gbGFi
ZWw8L2VtPjwvdGQ+CgkJCTx0ZD5sYWJlbD0mcXVvdDtNeSBUd2l0dGVyIHRpbWVsaW5lJnF1
b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsdGFnPC90ZD4KCQkJPHRkPklu
ZGVwZW5kZW50IHdyYXB0YWcgZm9yIGxhYmVsPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2Vt
PjwvdGQ+CgkJCTx0ZD5sYWJlbHRhZz0mcXVvdDtoMyZxdW90OzwvdGQ+CgkJPC90cj4KCQk8
dHI+CgkJCTx0ZD5icmVhazwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4g
Y2xhc3M9ImNhcHMiPkhUTUw8L3NwYW4+PC9zcGFuPiB0YWcgKHdpdGhvdXQgYnJhY2tldHMp
LCBvciBzdHJpbmcsIHVzZWQgdG8gc2VwYXJhdGUgdGhlIHVwZGF0ZXM8L3RkPgoJCQk8dGQ+
bGk8L3RkPgoJCQk8dGQ+YnJlYWs9JnF1b3Q7YnImcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRy
PgoJCQk8dGQ+d3JhcHRhZzwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4g
Y2xhc3M9ImNhcHMiPkhUTUw8L3NwYW4+PC9zcGFuPiB0YWcgdG8gYmUgdXNlZCBhcyB0aGUg
d3JhcHRhZywgd2l0aG91dCBicmFja2V0czwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48
L3RkPgoJCQk8dGQ+d3JhcHRhZz0mcXVvdDt1bCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+
CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xh
c3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBmb3Igd3JhcHRh
ZzwvdGQ+CgkJCTx0ZD5hcmNfdHdpdHRlcjwvdGQ+CgkJCTx0ZD5jbGFzcz0mcXVvdDt0d2l0
dGVyJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzX3Bvc3RlZDwvdGQ+
CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bh
bj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHNwYW4gdGFnIGFyb3VuZCBw
b3N0ZWQgZGF0ZTwvdGQ+CgkJCTx0ZD5hcmNfdHdpdHRlci1wb3N0ZWQ8L3RkPgoJCTwvdHI+
Cgk8L3RhYmxlPgoKCTxoMz5FeGFtcGxlIHVzYWdlPC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190
d2l0dGVyIHVzZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZxdW90OyBsaW1pdD0mcXVvdDs1JnF1
b3Q7IHdyYXB0YWc9JnF1b3Q7dWwmcXVvdDsgYnJlYWs9JnF1b3Q7bGkmcXVvdDsgZGF0ZWZv
cm1hdD0mcXVvdDslYiAlT2UsICVJOiVNICVwJnF1b3Q7IC8mZ3Q7PC9wPgoKCTxwPlByb2R1
Y2VzIGEgYnVsbGV0IHBvaW50IGxpc3Qgb2YgdGhlIGxhc3QgNSBUd2l0dGVyIHVwZGF0ZXMg
ZnJvbSBkcm1vbmtleW5pbmphJiM4MjE3O3MgVHdpdHRlciBmZWVkIHdpdGggYSBkZWZpbmVk
IGRhdGUgZm9ybWF0IHRvIG92ZXJyaWRlIHRoZSBkZWZhdWx0IGFyY2hpdmUgZGF0ZSBmb3Jt
YXQuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX3NlYXJjaF90
YWciPlRoZSBhcmNfdHdpdHRlcl9zZWFyY2ggdGFnPC9oMj4KCgk8aDM+U3ludGF4PC9oMz4K
Cgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyX3NlYXJjaCBoYXNodGFncz0mcXVvdDt0eHAmcXVv
dDsgLyZndDs8L3A+CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+
QXR0cmlidXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8
L3RoPgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5zZWFyY2g8
L3RkPgoJCQk8dGQ+Q29tbWEgc2VwYXJhdGVkIGxpc3Qgb2Ygc2VhcmNoIHdvcmRzPC90ZD4K
CQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0ZD5zZWFyY2g9JnF1b3Q7dHhwLHRl
eHRwYXR0ZXJuJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmhhc2h0YWdzPC90
ZD4KCQkJPHRkPkNvbW1hIHNlcGFyYXRlZCBsaXN0IG9mIGhhc2h0YWdzIHRvIHNlYXJjaCBm
b3IgKG5vdCBpbmNsdWRpbmcgdGhlIGhhc2gpPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2Vt
PjwvdGQ+CgkJCTx0ZD5oYXNodGFncz0mcXVvdDt0eHAsdGV4dHBhdHRlcm4mcXVvdDs8L3Rk
PgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+cmVwbHk8L3RkPgoJCQk8dGQ+VXNlcm5hbWUgb2Yg
dHdlZXRzIGluIHJlcGx5IHRvPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJ
CTx0ZD5yZXBseT0mcXVvdDt0d2l0dGVyJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJ
PHRkPm1lbnRpb248L3RkPgoJCQk8dGQ+VXNlcm5hbWUgb2YgdXNlciBtZW50aW9uZWQgaW4g
dHdlZXRzICg8aT5pLmUuPC9pPiB0d2VldHMgY29udGFpbmluZyBAdXNlcm5hbWUpPC90ZD4K
CQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0ZD5tZW50aW9uPSZxdW90O3R3aXR0
ZXImcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGltaXQ8L3RkPgoJCQk8dGQ+
TWF4aW11bSBudW1iZXIgb2YgdHdlZXRzIHRvIGRpc3BsYXkgKG1heC4gMjAwKTwvdGQ+CgkJ
CTx0ZD4xMDwvdGQ+CgkJCTx0ZD5saW1pdD0mcXVvdDsyNSZxdW90OzwvdGQ+CgkJPC90cj4K
CQk8dHI+CgkJCTx0ZD5kYXRlZm9ybWF0PC90ZD4KCQkJPHRkPkZvcm1hdCB0aGF0IHVwZGF0
ZSBkYXRlcyB3aWxsIGFwcGVhciBhczwvdGQ+CgkJCTx0ZD4gPGVtPkFyY2hpdmUgZGF0ZSBm
b3JtYXQ8L2VtPjwvdGQ+CgkJCTx0ZD5kYXRlZm9ybWF0PSZxdW90OyViICVPZSwgJUk6JU0g
JXAmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFiZWw8L3RkPgoJCQk8dGQ+
TGFiZWwgZm9yIHRoZSB0b3Agb2YgdGhlIGxpc3Q8L3RkPgoJCQk8dGQ+IDxlbT5ubyBsYWJl
bDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsdGFnPC90ZD4KCQkJPHRk
PkluZGVwZW5kZW50IHdyYXB0YWcgZm9yIGxhYmVsPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8
L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5icmVhazwvdGQ+CgkJCTx0ZD48c3Bh
biBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkhUTUw8L3NwYW4+PC9zcGFuPiB0
YWcgKHdpdGhvdXQgYnJhY2tldHMpLCBvciBzdHJpbmcsIHVzZWQgdG8gc2VwYXJhdGUgdGhl
IHVwZGF0ZXM8L3RkPgoJCQk8dGQ+bGk8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+d3Jh
cHRhZzwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMi
PkhUTUw8L3NwYW4+PC9zcGFuPiB0YWcgdG8gYmUgdXNlZCBhcyB0aGUgd3JhcHRhZywgd2l0
aG91dCBicmFja2V0czwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxz
cGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgZm9y
IHdyYXB0YWc8L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXJfc2VhcmNoPC90ZD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmNsYXNzX3VzZXI8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMi
PjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUg
YXBwbGllZCB0byBzcGFuIHRhZyBhcm91bmQgdXNlciBuYW1lPC90ZD4KCQkJPHRkPmFyY190
d2l0dGVyLXVzZXI8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3NfcG9zdGVkPC90
ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9z
cGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gc3BhbiB0YWcgYXJvdW5k
IHBvc3RlZCBkYXRlPC90ZD4KCQkJPHRkPmFyY190d2l0dGVyLXBvc3RlZDwvdGQ+CgkJPC90
cj4KCTwvdGFibGU+CgoJPGgzPkV4YW1wbGUgdXNhZ2U8L2gzPgoKCTxwPiZsdDt0eHA6YXJj
X3R3aXR0ZXJfc2VhcmNoIHNlYXJjaD0mcXVvdDtwbHVnaW4mcXVvdDsgaGFzaHRhZ3M9JnF1
b3Q7dHhwLHRleHRwYXR0ZXJuJnF1b3Q7IGxpbWl0PSZxdW90OzI1JnF1b3Q7IC8mZ3Q7PC9w
PgoKCTxwPlByb2R1Y2VzIGEgbGlzdCBvZiB0d2VldHMgY29udGFpbmluZyB0aGUgd29yZCAm
IzgyMTY7cGx1Z2luJiM4MjE3OyBhbmQgdGhlIGhhc2h0YWdzICYjODIxNjsjdHhwJiM4MjE3
OyBhbmQgJiM4MjE2OyN0ZXh0cGF0dGVybiYjODIxNzsuIFRoZSB0YWcgd2lsbCByZXR1cm4g
YSBtYXhpbXVtIG9mIDI1IHR3ZWV0cy48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0i
YXJjX3R3aXR0ZXJfcmV0d2VldF90YWciPlRoZSBhcmNfdHdpdHRlcl9yZXR3ZWV0IHRhZzwv
aDI+CgoJPGgzPlN5bnRheDwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl9yZXR3ZWV0
IC8mZ3Q7PC9wPgoKCTxwPkFkZHMgYSBUd2l0dGVyIHJldHdlZXQgYnV0dG9uIHRvIHlvdXIg
YXJ0aWNsZSB1c2luZyB0aGUgb3JpZ2luYWwgdHdlZXQmIzgyMTc7cyB0ZXh0IGdlbmVyYXRl
ZCBieSA8c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldC48L3A+CgoJPGgzPlVz
YWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJPHRo
PkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBsZTwv
dGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD51c2VyPC90ZD4KCQkJPHRkPlR3aXR0ZXIgdXNl
ciBuYW1lIHRvIHF1b3RlPC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0ZXIgdXNlcm5hbWU8
L2VtPjwvdGQ+CgkJCTx0ZD51c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDs8L3RkPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+dXJsPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBz
Ij48c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPjwvc3Bhbj4gdG8gcmV0d2VldDwvdGQ+
CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD50ZXh0PC90ZD4KCQkJPHRkPlJldHdlZXQgdGV4dDwv
dGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5mb2xsb3cxPC90ZD4KCQkJPHRkPlN1Z2dlc3Rl
ZCBUd2l0dGVyIGFjY291bnQgdG8gZm9sbG93LCBmb3IgZXhhbXBsZSB5b3VyIG93bjwvdGQ+
CgkJCTx0ZD5BIFR3aXR0ZXIgdXNlciB0byByZWNvbW1lbmQ8L3RkPgoJCQk8dGQ+Zm9sbG93
MT0mcXVvdDtUZXh0cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5m
b2xsb3cyPC90ZD4KCQkJPHRkPkFzIGZvbGxvdzE8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwv
ZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhbmc8L3RkPgoJCQk8dGQ+TGFuZ3Vh
Z2U8L3RkPgoJCQk8dGQ+ZW48L3RkPgoJCQk8dGQ+bGFuZz0mcXVvdDtlcyZxdW90OzwvdGQ+
CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jb3VudDwvdGQ+CgkJCTx0ZD5Db3VudCBib3ggcG9z
aXRpb24sIG9wdGlvbnM6IG5vbmUsIGhvcml6b250YWwgb3IgdmVydGljYWw8L3RkPgoJCQk8
dGQ+aG9yaXpvbnRhbDwvdGQ+CgkJCTx0ZD5jb3VudD0mcXVvdDtub25lJnF1b3Q7PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPmluY2x1ZGVfanM8L3RkPgoJCQk8dGQ+V2hldGhlciBv
ciBub3QgdG8gaW5jbHVkZSB0aGUgSmF2YVNjcmlwdDwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQkJ
PHRkPmluY2x1ZGVfanM9JnF1b3Q7MCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD53cmFwdGFnPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0i
Y2FwcyI+SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyB0byBiZSB1c2VkIGFzIHRoZSB3cmFwdGFn
LCB3aXRob3V0IGJyYWNrZXRzPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJ
PC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2Fw
cyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0
ZSBhcHBsaWVkIHRvIHRoZSByZXR3ZWV0IGJ1dHRvbjwvdGQ+CgkJCTx0ZD50d2l0dGVyLXNo
YXJlLWJ1dHRvbjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPGgyIGNsYXNzPSJzZWN0aW9u
IiBpZD0iYXJjX3R3aXR0ZXJfdHdlZXQiPmFyY190d2l0dGVyX3R3ZWV0PC9oMj4KCgk8cD5P
dXRwdXRzIHRoZSB0d2VldCBhc3NvY2lhdGVkIHdpdGggdGhlIGN1cnJlbnQgYXJ0aWNsZS48
L3A+CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRl
PC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8
dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5pZDwvdGQ+CgkJCTx0ZD5U
ZXh0cGF0dGVybiBhcnRpY2xlIElEPC90ZD4KCQkJPHRkPiA8ZW0+Y3VycmVudCBhcnRpY2xl
PC9lbT48L3RkPgoJCQk8dGQ+aWQ9JnF1b3Q7MSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+
CgkJCTx0ZD5pbmNsdWRlX3VybDwvdGQ+CgkJCTx0ZD5XaGV0aGVyIG9yIG5vdCB0aGUgYXJ0
aWNsZSYjODIxNztzIHNob3J0IHVybCBzaG91bGQgYmUgaW5jbHVkZWQgaW4gdGhlIG91dHB1
dDwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQkJPHRkPiBpbmNsdWRlX3VybD0mcXVvdDswJnF1b3Q7
PC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNf
dHdpdHRlcl90d2VldF91cmwiPmFyY190d2l0dGVyX3R3ZWV0X3VybDwvaDI+CgoJPHA+UmV0
dXJucyB0aGUgPHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4gb2YgdGhlIFR3aXR0ZXIg
c3RhdHVzIGZvciBhbiBhcnRpY2xlLjwvcD4KCgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7
dHhwOmFyY190d2l0dGVyX3R3ZWV0X3VybCAvJmd0OzwvcD4KCgk8cD4mbHQ7dHhwOmFyY190
d2l0dGVyX3R3ZWV0X3VybCZndDtMaW5rIHRleHQmbHQ7L3R4cDphcmNfdHdpdHRlcl90d2Vl
dF91cmwmZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRo
PkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0
PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aWQ8L3Rk
PgoJCQk8dGQ+VGV4dHBhdHRlcm4gYXJ0aWNsZSBJRDwvdGQ+CgkJCTx0ZD4gPGVtPmN1cnJl
bnQgYXJ0aWNsZTwvZW0+PC90ZD4KCQkJPHRkPmlkPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwv
dHI+CgkJPHRyPgoJCQk8dGQ+dGl0bGU8L3RkPgoJCQk8dGQ+VGl0bGUgYXR0cmlidXRlIG9m
IHRoZSBsaW5rPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8
dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4g
Y2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVk
IHRvIHRoZSBsaW5rPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4K
CTwvdGFibGU+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfdGlueXVy
bCI+YXJjX3R3aXR0ZXJfdGlueXVybDwvaDI+CgoJPHA+UmV0dXJucyB0aGUgc2hvcnRlbmVk
IDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+IG9mIHRoZSBhcnRpY2xlIHVzZWQgZm9y
IHRoZSBUd2l0dGVyIHVwZGF0ZS48L3A+CgoJPGgzPlN5bnRheDwvaDM+CgoJPHA+Jmx0O3R4
cDphcmNfdHdpdHRlcl90aW55dXJsIC8mZ3Q7PC9wPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0
ZXJfdGlueXVybCZndDtMaW5rIHRleHQmbHQ7L3R4cDphcmNfdHdpdHRlcl90aW55dXJsJmd0
OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1
dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJ
CTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmlkPC90ZD4KCQkJPHRk
PlRleHRwYXR0ZXJuIGFydGljbGUgSUQ8L3RkPgoJCQk8dGQ+IDxlbT5jdXJyZW50IGFydGlj
bGU8L2VtPjwvdGQ+CgkJCTx0ZD5pZD0mcXVvdDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0
cj4KCQkJPHRkPnRpdGxlPC90ZD4KCQkJPHRkPlRpdGxlIGF0dHJpYnV0ZSBvZiB0aGUgbGlu
azwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8
dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJj
YXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byB0aGUg
bGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwvdHI+Cgk8L3RhYmxl
PgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX2NhY2hpbmciPkNhY2hp
bmc8L2gyPgoKCTxwPkluIG9yZGVyIHRvIHByZXZlbnQgZXhjZXNzaXZlIHJlcGVhdGl0aXZl
IGNhbGxzIHRvIHRoZSBUd2l0dGVyIHdlYnNpdGUgaXQgaXMgcmVjb21tZW5kZWQgdG8gY2Fj
aGUgcmVzdWx0cy4gVHdpdHRlciBsaW1pdHMgdGhlIG51bWJlciBvZiBjYWxscyB0aHJvdWdo
IHRoZSA8c3BhbiBjbGFzcz0iY2FwcyI+QVBJPC9zcGFuPiwgYW5kIGNvbnRpbnVvdXMgY2Fs
bHMgd2lsbCByZXN1bHQgaW4gVHdpdHRlciBjbG9zaW5nIHRvIGZ1cnRoZXIgcmVxdWVzdHMu
IEJ5IGRlZmF1bHQsIGFyY190d2l0dGVyIGNhY2hlcyBmb3IgMzAgbWludXRlIGludGVydmFs
cy48L3A+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5E
ZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3Ro
PgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2FjaGluZzwvdGQ+CgkJCTx0ZD4mIzgyMTY7MSYj
ODIxNzsgdG8gY2FjaGUgZmVlZCwgJiM4MjE2OzAmIzgyMTc7IHRvIHR1cm4gY2FjaGluZyBv
ZmYgKG5vdCByZWNvbW1lbmRlZCk8L3RkPgoJCQk8dGQ+MTwvdGQ+CgkJCTx0ZD5jYWNoaW5n
PSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2FjaGVfZGlyPC90
ZD4KCQkJPHRkPkFic29sdXRlIHBhdGggdG8gdGhlIGNhY2hlIGRpcmVjdG9yeSAobXVzdCBi
ZSB3cml0YWJsZSk8L3RkPgoJCQk8dGQ+IDxlbT5hcmNfdHdpdHRlciBwcmVmZXJlbmNlczwv
ZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNhY2hlX3RpbWU8L3RkPgoJCQk8dGQ+
VGltZSBpbiBtaW51dGVzIHRoYXQgdGhlIGNhY2hlIGZpbGVzIGFyZSBzdG9yZWQgYmVmb3Jl
IGJlaW5nIHJlZnJlc2hlZDwvdGQ+CgkJCTx0ZD41PC90ZD4KCQkJPHRkPmNhY2hlX3RpbWU9
JnF1b3Q7MzAmcXVvdDs8L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxwPlRoZSBhZG1pbiBz
aWRlIG9mIHRoaXMgcGx1Z2luIGVuZm9yY2VzIGNhY2hpbmcsIGFwYXJ0IGZyb20gd2hlbiBp
dCBpcyBwb3N0aW5nIHRvIFR3aXR0ZXIgKDxpPmUuZy48L2k+IHdoZW4gcG9zdGluZyBvciBk
ZWxldGluZyBhbiB1cGRhdGUpLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNf
dHdpdHRlcl9wcmVmcyI+UHJlZmVyZW5jZXM8L2gyPgoKCTxwPllvdSBjYW4gYWNjZXNzIHRo
ZSBwbHVnaW5zIGNvcmUgcHJlZmVyZW5jZXMgZnJvbSBlaXRoZXIgdGhlIFByZWZlcmVuY2Vz
IG9yIFBsdWdpbnMgdGFicyBpbiBhZG1pbi4gU2V0dXAgeW91ciBUd2l0dGVyIGFjY291bnQg
KHlvdSB3aWxsIGJlIGFza2VkIHRvIGNvbm5lY3QgdmlhIFR3aXR0ZXIgYW5kIHRoaXMgbmVl
ZHMgZG9pbmcgYmVmb3JlIHlvdSBjYW4gdXNlIHRoZSBwbHVnaW4pIGFuZCBjaGFuZ2UgdGhl
IGNhY2hlIGRpcmVjdG9yeSB1c2luZyBhcmNfdHdpdHRlciYjODIxNztzIHByZWZlcmVuY2Vz
LiBXaXRob3V0IHByb3ZpZGluZyB5b3VyIGFjY291bnQgbG9naW4gZGV0YWlscyB0aGUgYWRt
aW4gYXJlYSBmZWF0dXJlcyBvZiB0aGlzIHBsdWdpbiB3aWxsIGJlIGluYWN0aXZlLjwvcD4K
Cgk8cD5Zb3UgY2FuIHNlbGVjdCB0aGUgPHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4g
c2hvcnRlbmVyIG1ldGhvZCB5b3Ugd2FudCB0byB1c2UgdG8gbGluayBiYWNrIHRvIHlvdXIg
YXJ0aWNsZSBvbiBUd2l0dGVyLiBQbGVhc2Ugbm90ZSB0aGF0IGlmIHlvdSBzZWxlY3Qgc21k
X3Nob3J0X3VybCB5b3Ugd2lsbCBuZWVkIHRvIGhhdmUgaW5zdGFsbGVkIGFuZCBhY3RpdmF0
ZWQgdGhlIDxhIGhyZWY9Imh0dHA6Ly90ZXh0cGF0dGVybi5vcmcvcGx1Z2lucy8xMDk5L3Nt
ZF9zaG9ydF91cmwiPjxzcGFuIGNsYXNzPSJ0YWciPnNtZF9zaG9ydF91cmw8L3NwYW4+IHBs
dWdpbjwvYT4gZGV2ZWxvcGVkIGJ5IFN0ZWYgRGF3c29uLjwvcD4KCgk8aDIgY2xhc3M9InNl
Y3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9hcnRpY2xlIj5Ud2VldGluZyBhcnRpY2xlczwvaDI+
CgoJPHA+QnkgZGVmYXVsdCBhcmNfdHdpdHRlciB3aWxsIHBvc3QgYW4gdXBkYXRlIHRvIFR3
aXR0ZXIgaW5jbHVkaW5nIGEgc2hvcnRlbmVkIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3Nw
YW4+IHRvIHlvdXIgYXJ0aWNsZS4gT25seSBsaXZlIGFuZCBhY3RpdmUgYXJ0aWNsZXMgd2ls
bCBiZSBzZW50IHRvIFR3aXR0ZXIsIDxpPmkuZS48L2k+IGFydGljbGVzIHBvc3RlZCBpbiB0
aGUgZnV0dXJlIG9yIGFzIHN0aWNreSBhcnRpY2xlcyB3aWxsIG5vdCBiZSBzZW50LiBJZiB5
b3VyIGFydGljbGUgaXMgc3VjY2Vzc2Z1bGx5IHN1Ym1pdHRlZCB0byBUd2l0dGVyIHRoZSB1
cGRhdGUgd2lsbCBhcHBlYXIgaW4gcGxhY2Ugb2YgdGhlIFR3aXR0ZXIgb3B0aW9uIG9uIHRo
ZSByaWdodC1oYW5kLXNpZGUgb2YgdGhlIGFydGljbGUgZWRpdCBzY3JlZW4uPC9wPgoKCTxw
PlR3ZWV0cyBhcmUgc2VudCBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDogPGVtPlR3ZWV0IHBy
ZWZpeDwvZW0+IDxlbT5BcnRpY2xlIHRpdGxlPC9lbT4gPGVtPlNob3J0ZW5lZCA8c3BhbiBj
bGFzcz0iY2FwcyI+VVJMPC9zcGFuPjwvZW0+IDxlbT5Ud2VldCBzdWZmaXg8L2VtPi4gWW91
IGNhbiBjaGFuZ2UgdGhlIHByZWZpeCBhbmQgc3VmZml4IG9uIGFuIGFydGljbGUtYnktYXJ0
aWNsZSBiYXNpcyBieSBjaGFuZ2luZyB0aGUgdHdlZXQgb3B0aW9ucyB1bmRlciAmIzgyMTY7
VXBkYXRlIFR3aXR0ZXImIzgyMTc7IG9uIHRoZSBhcnRpY2xlIGVkaXRvciBzY3JlZW4uIFRo
ZSBkZWZhdWx0IDxlbT5Ud2VldCBwcmVmaXg8L2VtPiBjYW4gYmUgc2V0IHVuZGVyIHRoZSA8
c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRlcjwvc3Bhbj4gcHJlZmVyZW5jZXMgc2NyZWVu
ICh0aGUgZGVmYXVsdCBvbiBpbnN0YWxsYXRpb24gaXMgJiM4MjIwO0p1c3QgcG9zdGVkOiYj
ODIyMTspLjwvcD4KCgk8cD5QbGVhc2Ugbm90ZSB0aGF0IG9uY2UgYW4gYXJ0aWNsZSBoYXMg
YmVlbiB0d2VldGVkIHRoZSB0d2VldCBjYW5ub3QgYmUgZWRpdGVkLjwvcD4KCgk8aDIgY2xh
c3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9hZG1pbiI+VGhlIFR3aXR0ZXIgdGFiPC9o
Mj4KCgk8cD5VbmRlciB0aGUgRXh0ZW5zaW9ucyB0YWIgKHRoaXMgY2FuIGJlIGNoYW5nZWQg
ZnJvbSB0aGUgcGx1Z2luJiM4MjE3O3MgcHJlZmVyZW5jZSBwYWdlKSBhIG5ldyBUd2l0dGVy
IHRhYiBzaG91bGQgYXBwZWFyIG9uY2UgeW91IGhhdmUgY29ubmVjdGVkIHlvdXIgc2l0ZSB0
byB5b3VyIFR3aXR0ZXIgYWNjb3VudC4gRnJvbSBoZXJlIHlvdSB3aWxsIGJlIGFibGUgdG8g
c3VibWl0IG5ldyBUd2l0dGVyIHVwZGF0ZXMsIHZpZXcgYmFzaWMgYWNjb3VudCBzdGF0aXN0
aWNzLCBhbmQgY2hlY2sgb3V0IHlvdXIgcmVjZW50IHVwZGF0ZXMgKGluY2x1ZGluZyB0aGUg
b3B0aW9uIHRvIGRlbGV0ZSB5b3VyIHR3ZWV0cykuPC9wPiI7czo0OiJjb2RlIjtzOjY3MzEz
OiJnbG9iYWwgJHByZWZzLCR0eHBjZmcsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCRhcmNf
dHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiRhcmNfdHdpdHRlciA9IGFycmF5KCk7CgokYXJj
X3R3aXR0ZXJfY29uc3VtZXJLZXkgPSAnbktjWHNsd3paaEJkMGtmS01ldG5QQSc7CiRhcmNf
dHdpdHRlcl9jb25zdW1lclNlY3JldCA9ICdDNm5TUENMM2VlSEdUQmhLQ2d3ZDlvY2xjdUQw
c3JCOFdWa2ZYUVlDNTQnOwoKYWRkX3ByaXZzKCdwbHVnaW5fcHJlZnMuYXJjX3R3aXR0ZXIn
LCcxLDInKTsKcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY190d2l0dGVyX2luc3RhbGwnLCdwbHVn
aW5fbGlmZWN5Y2xlLmFyY190d2l0dGVyJywgJ2luc3RhbGxlZCcpOwpyZWdpc3Rlcl9jYWxs
YmFjaygnYXJjX3R3aXR0ZXJfdW5pbnN0YWxsJywncGx1Z2luX2xpZmVjeWNsZS5hcmNfdHdp
dHRlcicsICdkZWxldGVkJyk7CnJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfdHdpdHRlcl9wcmVm
cycsJ3BsdWdpbl9wcmVmcy5hcmNfdHdpdHRlcicpOwoKCmlmICghaXNzZXQoJHByZWZzWydh
cmNfdHdpdHRlcl91c2VyJ10pKQogICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3VzZXInLCAn
JywgJ2FyY190d2l0dGVyJywgMSwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3NldCgkcHJlZnNb
J2FyY190d2l0dGVyX3ByZWZpeCddKSkKICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfcHJlZml4
JywnSnVzdCBwb3N0ZWQ6JywgJ2FyY190d2l0dGVyJywgMiwgJ3RleHRfaW5wdXQnKTsKaWYg
KCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX2NhY2hlX2RpciddKSkKICBzZXRfcHJlZign
YXJjX3R3aXR0ZXJfY2FjaGVfZGlyJywkdHhwY2ZnWyd0eHBhdGgnXS4kcHJlZnNbJ3RlbXBk
aXInXSwgJ2FyY190d2l0dGVyJywgMSwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3NldCgkcHJl
ZnNbJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnXSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0
dGVyX3R3ZWV0X2RlZmF1bHQnLCAxLCAnYXJjX3R3aXR0ZXInLCAyLCAneWVzbm9SYWRpbycp
OwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddKSkKICBzZXRf
cHJlZignYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCcsICd0aW55dXJsJywgJ2FyY190d2l0dGVy
JywgMiwKICAgICdhcmNfdHdpdHRlcl91cmxfbWV0aG9kX3NlbGVjdCcpOwovLyBNYWtlIHN1
cmUgdGhhdCB0aGUgVHdpdHRlciB0YWIgaGFzIGJlZW4gZGVmaW5lZAppZiAoIWlzc2V0KCRw
cmVmc1snYXJjX3R3aXR0ZXJfdGFiJ10pKSB7CiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3Rh
YicsICdleHRlbnNpb25zJywgJ2FyY190d2l0dGVyJywgMiwKICAgICdhcmNfdHdpdHRlcl90
YWJfc2VsZWN0Jyk7CiAgICAkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddID0gJ2V4dGVuc2lv
bnMnOwp9CgppZiAoQHR4cGludGVyZmFjZSA9PSAnYWRtaW4nKSB7CiAgICBpZiAoIWVtcHR5
KCRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddKQogICAgICAgICYmICFlbXB0eSgkcHJlZnNb
J2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10pCiAgICAgICAgJiYgIWVtcHR5KCRwcmVmc1sn
YXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSkgKSB7CgogICAgICAgIGlmICgkcHJl
ZnNbJ2FyY190d2l0dGVyX3RhYiddKSB7CiAgICAgICAgICAgIGFkZF9wcml2cygnYXJjX2Fk
bWluX3R3aXR0ZXInLCAnMSwyLDMsNCcpOwogICAgICAgICAgICByZWdpc3Rlcl90YWIoJHBy
ZWZzWydhcmNfdHdpdHRlcl90YWInXSwgJ2FyY19hZG1pbl90d2l0dGVyJywgJ1R3aXR0ZXIn
KTsKICAgICAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hZG1pbl90d2l0dGVyJywg
J2FyY19hZG1pbl90d2l0dGVyJyk7CiAgICAgICAgfQoKICAgICAgICByZWdpc3Rlcl9jYWxs
YmFjaygnYXJjX2FydGljbGVfdHdlZXQnLCAncGluZycpOwogICAgICAgIHJlZ2lzdGVyX2Nh
bGxiYWNrKCdhcmNfYXJ0aWNsZV90d2VldCcsICdhcnRpY2xlJywgJ2VkaXQnLCAxKTsKICAg
ICAgICByZWdpc3Rlcl9jYWxsYmFjaygnYXJjX2FwcGVuZF90d2l0dGVyJywgJ2FydGljbGVf
dWknLCAnc3RhdHVzJyk7CiAgICB9Cn0KCi8qCiAgICBQdWJsaWMtc2lkZSBmdW5jdGlvbnMK
ICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT0KKi8KCmZ1bmN0aW9uIGFyY190d2l0dGVyKCRhdHRzKQp7CiAgZ2xv
YmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRlcl9jb25z
dW1lclNlY3JldDsKCiAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICd1c2VyJyAgICAgID0+
ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLAogICAgJ3Bhc3N3b3JkJyAgPT4gJycsCiAg
ICAndGltZWxpbmUnICA9PiAndXNlcicsCiAgICAnbGltaXQnICAgICA9PiAnMTAnLAogICAg
J3JldHdlZXRzJyAgPT4gZmFsc2UsCiAgICAnZGF0ZWZvcm1hdCc9PiAkcHJlZnNbJ2FyY2hp
dmVfZGF0ZWZvcm1hdCddLAogICAgJ2NhY2hpbmcnICAgPT4gJzEnLAogICAgJ2NhY2hlX2Rp
cicgPT4gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXSwKICAgICdjYWNoZV90aW1l
Jz0+ICc1JywKICAgICdsYWJlbCcgICAgID0+ICcnLAogICAgJ2xhYmVsdGFnJyAgPT4gJycs
CiAgICAnYnJlYWsnICAgICA9PiAnbGknLAogICAgJ3dyYXB0YWcnICAgPT4gJycsCiAgICAn
Y2xhc3MnICAgICA9PiBfX0ZVTkNUSU9OX18sCiAgICAnY2xhc3NfcG9zdGVkJyA9PiBfX0ZV
TkNUSU9OX18uJy1wb3N0ZWQnCiAgICApLCRhdHRzKSk7CgogICR0d2l0ID0gbmV3IGFyY19U
d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVy
U2VjcmV0KTsKCiAgaWYgKCRjYWNoaW5nKSB7ICAvLyB0dXJuIG9uIGNhY2hpbmcsIHJlY29t
bWVuZGVkIChkZWZhdWx0KQogICAgJHR3aXQtPnNldENhY2hpbmcodHJ1ZSk7CiAgICAkdHdp
dC0+Y2FjaGVEaXIoJGNhY2hlX2Rpcik7CiAgICAkdHdpdC0+Y2FjaGVUaW1lKCRjYWNoZV90
aW1lKTsKICB9IGVsc2UgeyAgLy8gdHVybiBvZmYgY2FjaGluZywgbm90IHJlY29tbWVuZGVk
IG90aGVyIHRoYW4gZm9yIHRlc3RpbmcKICAgICR0d2l0LT5zZXRDYWNoaW5nKGZhbHNlKTsK
ICB9CgogIHN3aXRjaCAoJHRpbWVsaW5lKSB7CiAgICBjYXNlICdob21lJzogY2FzZSAnZnJp
ZW5kcyc6CiAgICAgICR0aW1lbGluZSA9ICdzdGF0dXNlcy9mcmllbmRzX3RpbWVsaW5lJzsg
YnJlYWs7CiAgICBjYXNlICdtZW50aW9ucyc6CiAgICAgICR0aW1lbGluZSA9ICdzdGF0dXNl
cy9tZW50aW9ucyc7IGJyZWFrOwogICAgY2FzZSAndXNlcic6IGRlZmF1bHQ6ICR0aW1lbGlu
ZSA9ICdzdGF0dXNlcy91c2VyX3RpbWVsaW5lJzsKICB9CgogICRvdXQgPSBhcnJheSgpOwog
ICR4bWwgPSAkdHdpdC0+Z2V0KCR0aW1lbGluZQogICAgLCBhcnJheSgnc2NyZWVuX25hbWUn
PT4kdXNlciwnY291bnQnPT4kbGltaXQsJ2luY2x1ZGVfcnRzJz0+JHJldHdlZXRzKSk7CiAg
aWYgKCR4bWwpIHsKICAgICR0d2VldHMgPSBAJHhtbC0+eHBhdGgoJy9zdGF0dXNlcy9zdGF0
dXMnKTsKICAgIGlmICgkdHdlZXRzKSBmb3JlYWNoICgkdHdlZXRzIGFzICR0d2VldCkgewog
ICAgICAkdGltZSA9IHN0cnRvdGltZShodG1sZW50aXRpZXMoJHR3ZWV0LT5jcmVhdGVkX2F0
KSk7CiAgICAgICRkYXRlID0gc2FmZV9zdHJmdGltZSgkZGF0ZWZvcm1hdCwkdGltZSk7CiAg
ICAgICRvdXRbXSA9IGFyY19Ud2l0dGVyOjptYWtlTGlua3MoaHRtbGVudGl0aWVzKCR0d2Vl
dC0+dGV4dCwgRU5UX1FVT1RFUywnVVRGLTgnKSkKICAgICAgICAuJyAnLnRhZyhodG1sZW50
aXRpZXMoJGRhdGUpLCdzcGFuJywnIGNsYXNzPSInLiRjbGFzc19wb3N0ZWQuJyInKTsKICAg
IH0KCiAgICByZXR1cm4gZG9MYWJlbCgkbGFiZWwsICRsYWJlbHRhZykuZG9XcmFwKCRvdXQs
ICR3cmFwdGFnLCAkYnJlYWssICRjbGFzcyk7CiAgfQoKfQoKZnVuY3Rpb24gYXJjX3R3aXR0
ZXJfc2VhcmNoKCRhdHRzKQp7CiAgICBnbG9iYWwgJHByZWZzLCRhcmNfdHdpdHRlcl9jb25z
dW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgIGV4dHJhY3QobEF0
dHMoYXJyYXkoCiAgICAgICAgJ3VzZXInICAgICAgPT4gJHByZWZzWydhcmNfdHdpdHRlcl91
c2VyJ10sCiAgICAgICAgJ3NlYXJjaCcgICAgPT4gJycsCiAgICAgICAgJ2hhc2h0YWdzJyAg
PT4gJycsCiAgICAgICAgJ3VzZXInICAgICAgPT4gJycsCiAgICAgICAgJ3JlcGx5JyAgICAg
PT4gJycsCiAgICAgICAgJ21lbnRpb24nICAgPT4gJycsCiAgICAgICAgJ2xpbWl0JyAgICAg
PT4gJzEwJywKICAgICAgICAnbGFuZycgICAgICA9PiAnJywKICAgICAgICAnZGF0ZWZvcm1h
dCc9PiAkcHJlZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCddLAogICAgICAgICdjYWNoaW5nJyAg
ID0+ICcxJywKICAgICAgICAnY2FjaGVfZGlyJyA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX2Nh
Y2hlX2RpciddLAogICAgICAgICdjYWNoZV90aW1lJz0+ICc1JywKICAgICAgICAnbGFiZWwn
ICAgICA9PiAnJywKICAgICAgICAnbGFiZWx0YWcnICA9PiAnJywKICAgICAgICAnYnJlYWsn
ICAgICA9PiAnbGknLAogICAgICAgICd3cmFwdGFnJyAgID0+ICcnLAogICAgICAgICdjbGFz
cycgICAgID0+IF9fRlVOQ1RJT05fXywKICAgICAgICAnY2xhc3NfcG9zdGVkJyA9PiBfX0ZV
TkNUSU9OX18uJy1wb3N0ZWQnLAogICAgICAgICdjbGFzc191c2VyJyAgID0+IF9fRlVOQ1RJ
T05fXy4nLXVzZXInCiAgICApLCRhdHRzKSk7CgogICAgICAgICR0d2l0ID0gbmV3IGFyY19U
d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAsICRhcmNfdHdp
dHRlcl9jb25zdW1lclNlY3JldCk7CgogICAgICAgIGlmICgkY2FjaGluZykgeyAgLy8gdHVy
biBvbiBjYWNoaW5nLCByZWNvbW1lbmRlZCAoZGVmYXVsdCkKICAgICAgICAgICAgJHR3aXQt
PnNldENhY2hpbmcodHJ1ZSk7CiAgICAgICAgICAgICR0d2l0LT5jYWNoZURpcigkY2FjaGVf
ZGlyKTsKICAgICAgICAgICAgJHR3aXQtPmNhY2hlVGltZSgkY2FjaGVfdGltZSk7CiAgICAg
ICAgfSBlbHNlIHsgIC8vIHR1cm4gb2ZmIGNhY2hpbmcsIG5vdCByZWNvbW1lbmRlZCBvdGhl
ciB0aGFuIGZvciB0ZXN0aW5nCiAgICAgICAgICAgICR0d2l0LT5zZXRDYWNoaW5nKGZhbHNl
KTsKICAgICAgICB9CgogICAgICAgIC8vIGNvbnN0cnVjdCBzZWFyY2ggcXVlcnkKICAgICAg
ICBpZiAoIWVtcHR5KCRzZWFyY2gpKSB7CiAgICAgICAgICAgICR0ZXJtcyA9IGV4cGxvZGUo
JywnLCRzZWFyY2gpOyAkdGVybXMgPSBhcnJheV9tYXAoJ3RyaW0nLCR0ZXJtcyk7CiAgICAg
ICAgICAgICRzZWFyY2ggPSBpbXBsb2RlKCcgJywkdGVybXMpOwogICAgICAgIH0KICAgICAg
ICBpZiAoJGhhc2h0YWdzKSB7CiAgICAgICAgICAgICRoYXNoZXMgPSBleHBsb2RlKCcsJywk
aGFzaHRhZ3MpOyAkaGFzaGVzID0gYXJyYXlfbWFwKCd0cmltJywkaGFzaGVzKTsKICAgICAg
ICAgICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/JyAnOicnKS4nIycuaW1wbG9kZSgnICMnLCRo
YXNoZXMpOwogICAgICAgIH0KICAgICAgICBpZiAoJHJlcGx5KSB7CiAgICAgICAgICAgICRz
ZWFyY2guPSAoKCRzZWFyY2gpPycgJzonJykuJ3RvOicudHJpbSgkcmVwbHkpOwogICAgICAg
IH0KICAgICAgICBpZiAoJHVzZXIpIHsKICAgICAgICAgICAgJHNlYXJjaC49ICgoJHNlYXJj
aCk/JyAnOicnKS4nZnJvbTonLnRyaW0oJHVzZXIpOwogICAgICAgIH0KICAgICAgICBpZiAo
JG1lbnRpb24pIHsKICAgICAgICAgICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/JyAnOicnKS4n
QCcudHJpbSgkbWVudGlvbik7CiAgICAgICAgfQoKICAgICAgICBpZiAoZW1wdHkoJHNlYXJj
aCkpIHsKICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAg
ICAgICRzZWFyY2ggPSB1cmxlbmNvZGUoJHNlYXJjaCk7CiAgICAgICAgfQoKICAgICAgICAk
b3V0ID0gYXJyYXkoKTsKICAgICAgICAkdHdlZXRzID0gJHR3aXQtPmdldCgnaHR0cDovL3Nl
YXJjaC50d2l0dGVyLmNvbS9zZWFyY2guYXRvbT9xPScuJHNlYXJjaAogICAgICAgICAgICAs
IGFycmF5KCdycHAnPT4kbGltaXQsJ2xhbmcnPT4kbGFuZykpOwoKICAgICAgICBpZiAoJHR3
ZWV0cykgeyBmb3JlYWNoICgkdHdlZXRzLT5lbnRyeSBhcyAkdHdlZXQpIHsKICAgICAgICAg
ICAgcHJlZ19tYXRjaCgiLyguKikgXCgoLiopXCkvIiwkdHdlZXQtPmF1dGhvci0+bmFtZSwk
bWF0Y2hlcyk7CiAgICAgICAgICAgIGxpc3QoJGF1dGhvciwkdW5hbWUsJG5hbWUpID0gJG1h
dGNoZXM7CiAgICAgICAgICAgICR0aW1lID0gc3RydG90aW1lKGh0bWxlbnRpdGllcygkdHdl
ZXQtPnB1Ymxpc2hlZCkpOwogICAgICAgICAgICAkZGF0ZSA9IHNhZmVfc3RyZnRpbWUoJGRh
dGVmb3JtYXQsJHRpbWUpOwogICAgICAgICAgICAkdGV4dCA9ICR0d2VldC0+dGl0bGU7CiAg
ICAgICAgICAgICRvdXRbXSA9IHRhZyhocmVmKGh0bWxlbnRpdGllcygkdW5hbWUpLCR0d2Vl
dC0+YXV0aG9yLT51cmksCiAgICAgICAgICAgICAgICAnIHRpdGxlPSInLmh0bWxlbnRpdGll
cygkbmFtZSkuJyInKS4nOiAnLCdzcGFuJwogICAgICAgICAgICAgICAgICAgICwnIGNsYXNz
PSInLiRjbGFzc191c2VyLiciJykKICAgICAgICAgICAgICAgIC5hcmNfVHdpdHRlcjo6bWFr
ZUxpbmtzKGh0bWxlbnRpdGllcygkdGV4dCwgRU5UX1FVT1RFUywnVVRGLTgnKSkKICAgICAg
ICAgICAgICAgIC4nICcudGFnKGh0bWxlbnRpdGllcygkZGF0ZSksJ3NwYW4nCiAgICAgICAg
ICAgICAgICAgICAgLCcgY2xhc3M9IicuJGNsYXNzX3Bvc3RlZC4nIicpOwogICAgICAgIH0g
cmV0dXJuIGRvTGFiZWwoJGxhYmVsLCAkbGFiZWx0YWcpCiAgICAgICAgICAgIC5kb1dyYXAo
JG91dCwgJHdyYXB0YWcsICRicmVhaywgJGNsYXNzKTsgfQoKfQoKZnVuY3Rpb24gYXJjX3R3
aXR0ZXJfdHdlZXQoJGF0dHMpIHsKICAgIGdsb2JhbCAkdGhpc2FydGljbGU7CgogICAgZXh0
cmFjdChsQXR0cyhhcnJheSgKICAgICAgJ2lkJyAgICAgICAgPT4gJHRoaXNhcnRpY2xlWyd0
aGlzaWQnXSwKICAgICAgJ2luY2x1ZGVfdXJsJyAgID0+IHRydWUKICAgICksJGF0dHMpKTsK
CiAgICBpZiAoJGlkKSB7CiAgICAgIC8vIEZldGNoIGFyY190d2l0dGVyIHN0dWZmIHRvIGJ1
aWxkIHR3ZWV0IGZyb20KICAgICAgJHR3ZWV0ID0gKCRpbmNsdWRlX3VybCkgPyBzYWZlX3Jv
dygidHdlZXQiLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlkfSIpCiAgICAgICAg
OiBzYWZlX3JvdygiUkVQTEFDRSh0d2VldCxDT05DQVQoJyAnLHRpbnl1cmwpLCcnKSBBUyB0
d2VldCIKICAgICAgICAgICwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKTsK
ICAgIH0KCiAgICBpZiAoJHR3ZWV0Wyd0d2VldCddKSB7CiAgICAgIHJldHVybiBhcmNfVHdp
dHRlcjo6bWFrZUxpbmtzKAogICAgICAgIGh0bWxlbnRpdGllcygkdHdlZXRbJ3R3ZWV0J10s
IEVOVF9RVU9URVMsJ1VURi04JykpOwogICAgfQp9CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl90
d2VldF91cmwoJGF0dHMsICR0aGluZz1udWxsKSB7CiAgICBnbG9iYWwgJHRoaXNhcnRpY2xl
LCRwcmVmczsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAnaWQnICAgICAgPT4g
JHRoaXNhcnRpY2xlWyd0aGlzaWQnXSwKICAgICAgJ3RpdGxlJyAgID0+ICcnLAogICAgICAn
Y2xhc3MnICAgPT4gJycKICAgICksJGF0dHMpKTsKCiAgICBpZiAoJGlkKSB7CiAgICAgIC8v
IEZldGNoIGFyY190d2l0dGVyIHN0dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAgICAgJHR3
ZWV0ID0gc2FmZV9yb3coInR3ZWV0X2lkIgogICAgICAgICwgJ2FyY190d2l0dGVyJywgImFy
dGljbGVfaWQ9eyRpZH0iKTsKICAgIH0KCiAgICBpZiAoJHR3ZWV0Wyd0d2VldF9pZCddKSB7
CiAgICAgICR1cmwgPSAiaHR0cDovL3R3aXR0ZXIuY29tLyIuJHByZWZzWydhcmNfdHdpdHRl
cl91c2VyJ10uIi9zdGF0dXMvIi4kdHdlZXRbJ3R3ZWV0X2lkJ107CiAgICAgIGlmICgkdGhp
bmc9PT1udWxsKSB7CiAgICAgICAgcmV0dXJuICR1cmw7CiAgICAgIH0KICAgICAgcmV0dXJu
IGhyZWYocGFyc2UoJHRoaW5nKSwgJHVybCwKICAgICAgICAoJHRpdGxlID8gJyB0aXRsZT0i
Jy4kdGl0bGUuJyInIDogJycpCiAgICAgICAgLigkY2xhc3MgPyAnIGNsYXNzPSInLiRjbGFz
cy4nIicgOiAnJykpOwogICAgfQp9CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl90aW55dXJsKCRh
dHRzLCAkdGhpbmc9bnVsbCkgewogICAgZ2xvYmFsICR0aGlzYXJ0aWNsZTsKCiAgICBleHRy
YWN0KGxBdHRzKGFycmF5KAogICAgICAnaWQnICAgICAgPT4gJHRoaXNhcnRpY2xlWyd0aGlz
aWQnXSwKICAgICAgJ3RpdGxlJyAgID0+ICcnLAogICAgICAnY2xhc3MnICAgPT4gJycKICAg
ICksJGF0dHMpKTsKCiAgICBpZiAoJGlkKSB7CiAgICAgIC8vIEZldGNoIGFyY190d2l0dGVy
IHN0dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAgICAgJHR3ZWV0ID0gc2FmZV9yb3coInRp
bnl1cmwiCiAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlkfSIpOwog
ICAgfQoKICAgIGlmICgkdHdlZXRbJ3Rpbnl1cmwnXSkgewogICAgICBpZiAoJHRoaW5nPT09
bnVsbCkgewogICAgICAgIHJldHVybiAkdHdlZXRbJ3Rpbnl1cmwnXTsKICAgICAgfQoKICAg
ICAgcmV0dXJuIGhyZWYocGFyc2UoJHRoaW5nKSwgJHR3ZWV0Wyd0aW55dXJsJ10sCiAgICAg
ICAgKCR0aXRsZSA/ICcgdGl0bGU9IicuJHRpdGxlLiciJyA6ICcnKQogICAgICAgIC4oJGNs
YXNzID8gJyBjbGFzcz0iJy4kY2xhc3MuJyInIDogJycpKTsKICAgIH0KfQoKZnVuY3Rpb24g
YXJjX3R3aXR0ZXJfcmV0d2VldCgkYXR0cywgJHRoaW5nPW51bGwpCnsKICAgIGdsb2JhbCAk
cHJlZnMsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJT
ZWNyZXQ7CiAgICBnbG9iYWwgJHRoaXNhcnRpY2xlOwoKICAgIGV4dHJhY3QobEF0dHMoYXJy
YXkoCiAgICAgICAgJ3VzZXInICAgICAgPT4gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10s
IC8vIHZpYSB1c2VyIGFjY291bnQKICAgICAgICAndXJsJyAgICAgICA9PiAnJywKICAgICAg
ICAndGV4dCcgICAgICA9PiAnJywKICAgICAgICAnZm9sbG93MScgICA9PiAnJywKICAgICAg
ICAnZm9sbG93MicgICA9PiAnJywKICAgICAgICAnbGFuZycgICAgICA9PiAnJywKICAgICAg
ICAnY291bnQnICAgICA9PiAnaG9yaXpvbnRhbCcsCiAgICAgICAgJ2luY2x1ZGVfanMnPT4g
dHJ1ZSwKICAgICAgICAnd3JhcHRhZycgICA9PiAnJywKICAgICAgICAnY2xhc3MnICAgICA9
PiAndHdpdHRlci1zaGFyZS1idXR0b24nCiAgICApLCRhdHRzKSk7CgogICAgJHEgPSAnJzsg
Ly8gcXVlcnkgc3RyaW5nCgogICAgaWYgKCRpZD0kdGhpc2FydGljbGVbJ3RoaXNpZCddKSB7
CiAgICAgIC8vIEZldGNoIGFyY190d2l0dGVyIHN0dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20K
ICAgICAgJHJvdyA9IHNhZmVfcm93KCJSRVBMQUNFKHR3ZWV0LENPTkNBVCgnICcsdGlueXVy
bCksJycpIEFTIHR3ZWV0LHRpbnl1cmwiCiAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAiYXJ0
aWNsZV9pZD17JGlkfSIpOwoKICAgICAgaWYgKCR1cmw9PScnKSB7CiAgICAgICAgJHVybCA9
ICgkdXJsKSA/ICR1cmwgOiBwZXJtbGlua3VybCgkdGhpc2FydGljbGUpOwogICAgICAgICRx
ID0gJ3VybD0nLnVybGVuY29kZSgkdXJsKTsKICAgICAgfQogICAgICBpZiAoJHRleHQ9PScn
KSB7CiAgICAgICAgJHRleHQgPSAoJHJvd1sndHdlZXQnXSkgPyAkcm93Wyd0d2VldCddIDog
JHRoaXNhcnRpY2xlWyd0aXRsZSddOwogICAgICB9CiAgICAgICRxIC49ICgkcSA/ICcmYW1w
OycgOiAnJykuJ3RleHQ9Jy51cmxlbmNvZGUoJHRleHQpOwogICAgfQogICAgaWYgKCR1c2Vy
KSB7CiAgICAgICRxIC49ICgkcSA/ICcmYW1wOycgOiAnJykuJ3ZpYT0nLnVybGVuY29kZSgk
dXNlcik7CiAgICB9CiAgICBpZiAoJGZvbGxvdzEmJiRmb2xsb3cyKSB7CiAgICAgICRxIC49
ICgkcSA/ICcmYW1wOycgOiAnJykuJ3JlbGF0ZWQ9Jy51cmxlbmNvZGUoJGZvbGxvdzEuJzon
LiRmb2xsb3cyKTsKICAgIH0gZWxzZWlmICgkZm9sbG93MXx8JGZvbGxvdzIpIHsKICAgICAg
JHEgLj0gKCRxID8gJyZhbXA7JyA6ICcnKS4ncmVsYXRlZD0nLnVybGVuY29kZSgkZm9sbG93
MS4kZm9sbG93Mik7CiAgICB9CgogICAgc3dpdGNoICgkbGFuZykgewogICAgICBjYXNlICdm
cic6IGJyZWFrOyBjYXNlICdkZSc6IGJyZWFrOyBjYXNlICdlcyc6IGJyZWFrOyBjYXNlICdq
cCc6IGJyZWFrOwogICAgICBkZWZhdWx0OgogICAgICAgICRsYW5nID0gJ2VuJzsKICAgIH0K
ICAgICRxIC49ICgkcSA/ICcmYW1wOycgOiAnJykuJ2xhbmc9Jy51cmxlbmNvZGUoJGxhbmcp
OwoKICAgIHN3aXRjaCAoJGNvdW50KSB7CiAgICAgIGNhc2UgJ25vbmUnOiBicmVhazsgY2Fz
ZSAndmVydGljYWwnOiBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICAkY291bnQgPSAn
aG9yaXpvbnRhbCc7CiAgICB9CiAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidjb3Vu
dD0nLnVybGVuY29kZSgkY291bnQpOwoKICAgICR0aGluZyA9ICgkdGhpbmc9PT1udWxsKSA/
ICdUd2VldCcgOiBwYXJzZSgkdGhpbmcpOwoKICAgICRodG1sID0gaHJlZigkdGhpbmcsJ2h0
dHA6Ly90d2l0dGVyLmNvbS9zaGFyZT8nLiRxCiAgICAgICwgJyBjbGFzcz0iJy4kY2xhc3Mu
JyInKTsKCiAgICAkanMgPSAoJGluY2x1ZGVfanMpID8KICAgICAgJzxzY3JpcHQgc3JjPSJo
dHRwOi8vcGxhdGZvcm0udHdpdHRlci5jb20vd2lkZ2V0cy5qcyIgdHlwZT0idGV4dC9qYXZh
c2NyaXB0Ij48L3NjcmlwdD4nCiAgICAgIDogJyc7CgogICAgcmV0dXJuICRqcy4kaHRtbDsK
fQoKLyoKICAgIEFkbWluLXNpZGUgZnVuY3Rpb25zCiAgICA9PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiovCgovLyBJ
bnN0YWxsYXRpb24gZnVuY3Rpb24gLSBidWlsZHMgTXlTUUwgdGFibGUKZnVuY3Rpb24gYXJj
X3R3aXR0ZXJfaW5zdGFsbCgpCnsKCiAgICAvLyBGb3IgZmlyc3QgaW5zdGFsbCwgY3JlYXRl
IHRhYmxlIGZvciB0d2VldHMKICAgICRzcWwgPSAiQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElT
VFMgIi5QRlguImFyY190d2l0dGVyICI7CiAgICAkc3FsLj0gIihhcmNfdHdpdHRlcmlkIElO
VEVHRVIgQVVUT19JTkNSRU1FTlQgUFJJTUFSWSBLRVksCiAgICAgICAgYXJ0aWNsZV9pZCBJ
TlRFR0VSKDExKSwKICAgICAgICB0d2VldF9pZCBCSUdJTlQoMjApLAogICAgICAgIHR3ZWV0
IFZBUkNIQVIoMTQwKSwKICAgICAgICB0aW55dXJsIFZBUkNIQVIoMzApKTsiOwoKICAgIGlm
ICghc2FmZV9xdWVyeSgkc3FsKSkgewogICAgICAgIHJldHVybiAnRXJyb3IgLSB1bmFibGUg
dG8gY3JlYXRlIGFyY190d2l0dGVyIHRhYmxlJzsKICAgIH0KCn0KCi8vIFVuaW5zdGFsbCBm
dW5jdGlvbiAtIGRlbGV0ZXMgTXlTUUwgdGFibGUgYW5kIHJlbGF0ZWQgcHJlZmVyZW5jZXMK
ZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdW5pbnN0YWxsKCkKewoKICAgICRzcWwgPSAiRFJPUCBU
QUJMRSBJRiBFWElTVFMgIi5QRlguImFyY190d2l0dGVyOyI7CiAgICBpZiAoIXNhZmVfcXVl
cnkoJHNxbCkpIHsKICAgICAgICByZXR1cm4gJ0Vycm9yIC0gdW5hYmxlIHRvIGRlbGV0ZSBh
cmNfdHdpdHRlciB0YWJsZSc7CiAgICB9CgogICAgJHNxbCA9ICJERUxFVEUgRlJPTSAgIi5Q
RlguInR4cF9wcmVmcyBXSEVSRSBldmVudD0nYXJjX3R3aXR0ZXInOyI7CiAgICBpZiAoIXNh
ZmVfcXVlcnkoJHNxbCkpIHsKICAgICAgICByZXR1cm4gJ0Vycm9yIC0gdW5hYmxlIHRvIGRl
bGV0ZSBhcmNfdHdpdHRlciBwcmVmZXJlbmNlcyc7CiAgICB9Cgp9CmZ1bmN0aW9uIGFyY190
d2l0dGVyX3VybF9tZXRob2Rfc2VsZWN0KCRuYW1lLCAkdmFsKQp7CiAgICAkbWV0aG9kcyA9
IGFycmF5KCd0aW55dXJsJyA9PiAnVGlueXVybCcsICdpc2dkJyA9PiAnSXMuZ2QnLCAnc21k
JyA9PiAnc21kX3Nob3J0X3VybCcpOwogICAgcmV0dXJuIHNlbGVjdElucHV0KCRuYW1lLCAk
bWV0aG9kcywgJHZhbCk7Cn0KZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCgkbmFt
ZSwgJHZhbCkKewogICAgJHRhYnMgPSBhcnJheSgnY29udGVudCcgPT4gJ0NvbnRlbnQnLAog
ICAgICAgICdleHRlbnNpb25zJyA9PiAnRXh0ZW5zaW9ucycsCiAgICAgICAgJycgPT4gJ0hp
ZGRlbicpOwogICAgcmV0dXJuIHNlbGVjdElucHV0KCRuYW1lLCAkdGFicywgJHZhbCk7Cn0K
Ly8gUHJvdmlkZSBpbnRlcmZhY2UgZm9yIHNldHRpbmcgcHJlZmVyZW5jZXMKZnVuY3Rpb24g
YXJjX3R3aXR0ZXJfcHJlZnMoJGV2ZW50LCRzdGVwKQp7CgogICAgZ2xvYmFsICRwcmVmcywk
YXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoK
ICAgICR1c2VyICAgICAgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ107CiAgICAk
cHJlZml4ICAgICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfcHJlZml4J107CiAgICAkdHdl
ZXRfZGVmYXVsdCA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCddOwogICAg
JHVybF9tZXRob2QgICAgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3VybF9tZXRob2QnXTsKICAg
ICRjYWNoZV9kaXIgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXTsKICAg
ICR0YWIgICAgICAgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl90YWInXTsKCiAgICBzd2l0
Y2ggKCRzdGVwKSB7CiAgICAgICAgY2FzZSAncHJlZnNfc2F2ZSc6IHBhZ2V0b3AoJ1RYUCBU
d2VldCcsICdQcmVmZXJlbmNlcyBzYXZlZCcpOyBicmVhazsKICAgICAgICBjYXNlICdyZWdp
c3Rlcic6IHBhZ2V0b3AoJ1RYUCBUd2VldCcsJ0Nvbm5lY3QgdG8gVHdpdHRlcicpOyBicmVh
azsKICAgICAgICBjYXNlICd2YWxpZGF0ZSc6CiAgICAgICAgZGVmYXVsdDogcGFnZXRvcCgn
VFhQIFR3ZWV0Jyk7CiAgICB9CgogICAgJGh0bWwgPSAnJzsKCiAgICBpZiAoJHN0ZXA9PSdy
ZWdpc3RlcicpIHsgLy8gT0F1dGggcmVnaXN0cmF0aW9uIHByb2Nlc3MKICAgICAgICAkdHdp
dCA9IG5ldyBhcmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAg
ICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQpOwoKICAgICAgICAvLyBCdWlsZCBh
IGNhbGxiYWNrIFVSTCBmb3IgVHdpdHRlciB0byByZXR1cm4gdG8gdGhlIG5leHQgc3RhZ2UK
ICAgICAgICAkY2FsbGJhY2tVUkwgPSAkdHdpdC0+Y2FsbGJhY2tVUkwoJGV2ZW50LCd2YWxp
ZGF0ZScpOwoKICAgICAgICAkcmVxdWVzdCA9ICR0d2l0LT5nZXRSZXF1ZXN0VG9rZW4oJGNh
bGxiYWNrVVJMKTsKICAgICAgICAkcmVxdWVzdF90b2tlbiA9ICRyZXF1ZXN0WyJvYXV0aF90
b2tlbiJdOwogICAgICAgICRyZXF1ZXN0X3Rva2VuX3NlY3JldCA9ICRyZXF1ZXN0WyJvYXV0
aF90b2tlbl9zZWNyZXQiXTsKCiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3JlcXVl
c3RUb2tlbicsJHJlcXVlc3RfdG9rZW4KICAgICAgICAgICAgLCAnYXJjX3R3aXR0ZXInLDIp
OwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9yZXF1ZXN0VG9rZW5TZWNyZXQnLCRy
ZXF1ZXN0X3Rva2VuX3NlY3JldAogICAgICAgICAgICAsICdhcmNfdHdpdHRlcicsMik7Cgog
ICAgICAgICRodG1sLj0gc3RhcnRUYWJsZSgnZWRpdCcpLgogICAgICAgICAgICAgICAgdHIo
dGQoCiAgICAgICAgICAgICAgICAgICAgKCc8cD4nLmhyZWYoJ1NpZ24taW4gdG8gVHdpdHRl
cicKICAgICAgICAgICAgICAgICAgICAgICAgICAgICwkdHdpdC0+Z2V0QXV0aG9yaXplVVJM
KCRyZXF1ZXN0KSkKICAgICAgICAgICAgICAgICAgICAgICAgLicgYW5kIGZvbGxvdyB0aGUg
aW5zdHJ1Y3Rpb25zIHRvIGFsbG93IFRYUCBUd2VldCB0byB1c2UgeW91ciBhY2NvdW50LiBJ
ZiB5b3UgYXJlIGFscmVhZHkgc2lnbmVkIGluIHRvIFR3aXR0ZXIgdGhlbiB0aGF0IGFjY291
bnQgd2lsbCBiZSBhc3NvY2lhdGVkIHdpdGggVFhQIFR3ZWV0IHNvIHlvdSBtYXkgbmVlZCB0
byBzaWduIG91dCBmaXJzdCBpZiB5b3Ugd2FudCB0byB1c2UgYSBkaWZmZXJlbnQgYWNjb3Vu
dC48L3A+JykKICAgICAgICAgICAgICAgICkpLmVuZFRhYmxlKCk7CiAgICB9IGVsc2VpZiAo
JHN0ZXA9PSd2YWxpZGF0ZScpIHsKICAgICAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigk
YXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29u
c3VtZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfcmVxdWVzdFRva2VuJ10KICAgICAg
ICAgICAgLCAkcHJlZnNbJ2FyY190d2l0dGVyX3JlcXVlc3RUb2tlblNlY3JldCddKTsKICAg
ICAgICAvLyBBc2sgVHdpdHRlciBmb3IgYW4gYWNjZXNzIHRva2VuIChhbmQgYW4gYWNjZXNz
IHRva2VuIHNlY3JldCkKICAgICAgICAkcmVxdWVzdCA9ICR0d2l0LT5nZXRBY2Nlc3NUb2tl
biggZ3BzKCdvYXV0aF92ZXJpZmllcicpICk7CiAgICAgICAgJGFjY2Vzc190b2tlbiA9ICRy
ZXF1ZXN0WydvYXV0aF90b2tlbiddOwogICAgICAgICRhY2Nlc3NfdG9rZW5fc2VjcmV0ID0g
JHJlcXVlc3RbJ29hdXRoX3Rva2VuX3NlY3JldCddOwogICAgICAgICR1c2VyID0gJHJlcXVl
c3RbJ3NjcmVlbl9uYW1lJ107CiAgICAgICAgLy8gU3RvcmUgdGhlIGFjY2VzcyB0b2tlbiBh
bmQgc2VjcmV0CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJywk
YWNjZXNzX3Rva2VuLCAnYXJjX3R3aXR0ZXInLDIpOwogICAgICAgIHNldF9wcmVmKCdhcmNf
dHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCcsJGFjY2Vzc190b2tlbl9zZWNyZXQKICAgICAg
ICAgICAgLCAnYXJjX3R3aXR0ZXInLDIpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRl
cl91c2VyJywkdXNlcik7CiAgICAgICAgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tl
biddID0gJGFjY2Vzc190b2tlbjsKICAgICAgICAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vz
c1Rva2VuU2VjcmV0J10gPSAkYWNjZXNzX3Rva2VuX3NlY3JldDsKICAgICAgICB1bnNldCgk
dHdpdCk7CiAgICB9CgogICAgaWYgKCRzdGVwPT0icHJlZnNfc2F2ZSIpIHsKICAgICAgICAk
cHJlZml4ID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3ByZWZpeCcpKTsKICAgICAgICAkdHdl
ZXRfZGVmYXVsdCA9IGdwcygnYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcpOwogICAgICAg
ICR1cmxfbWV0aG9kID0gZ3BzKCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJyk7CiAgICAgICAg
JGNhY2hlX2RpciA9IGdwcygnYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJyk7CiAgICAgICAgJHRh
YiA9IGdwcygnYXJjX3R3aXR0ZXJfdGFiJyk7CiAgICAgICAgaWYgKHN0cmxlbigkcHJlZml4
KTw9MjApIHsKICAgICAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3ByZWZpeCcsJHBy
ZWZpeCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJHByZWZpeCA9ICRwcmVmc1sn
YXJjX3R3aXR0ZXJfcHJlZml4J107CiAgICAgICAgfQogICAgICAgICR0d2VldF9kZWZhdWx0
ID0gKCR0d2VldF9kZWZhdWx0KSA/IDEgOiAwOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdp
dHRlcl90d2VldF9kZWZhdWx0JywkdHdlZXRfZGVmYXVsdCk7CiAgICAgICAgc2V0X3ByZWYo
J2FyY190d2l0dGVyX3VybF9tZXRob2QnLCR1cmxfbWV0aG9kKTsKICAgICAgICBzZXRfcHJl
ZignYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJywkY2FjaGVfZGlyKTsKICAgICAgICBzZXRfcHJl
ZignYXJjX3R3aXR0ZXJfdGFiJywkdGFiKTsKICAgIH0KCiAgICBpZiAoICRzdGVwIT0ncmVn
aXN0ZXInICkgewogICAgICAgIGlmICggaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nl
c3NUb2tlbiddKQogICAgICAgICYmIGlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNz
VG9rZW5TZWNyZXQnXSkgKSB7CiAgICAgICAgICAgICR0d2l0ID0gbmV3IGFyY190d2l0dGVy
KCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAgICAgLCAkYXJjX3R3aXR0
ZXJfY29uc3VtZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXQog
ICAgICAgICAgICAgICAgLCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0
J10pOwogICAgICAgICAgICAkcmVnaXN0ZXJVUkwgPSAkdHdpdC0+Y2FsbGJhY2tVUkwoJGV2
ZW50LCdyZWdpc3RlcicpOwogICAgICAgICAgICAkaHRtbC49IHN0YXJ0VGFibGUoJ2xpc3Qn
KS5mb3JtKAogICAgICAgICAgICAgICAgdHIoCiAgICAgICAgICAgICAgICAgICAgdGRjcyho
ZWQoJ1R3aXR0ZXIgYWNjb3VudCBkZXRhaWxzJywgMiksMikKICAgICAgICAgICAgICAgICkK
ICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBm
b3I9ImFyY190d2l0dGVyX3VzZXIiPlR3aXR0ZXIgdXNlcm5hbWU8L2xhYmVsPicsCiAgICAg
ICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNh
bC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50ZCgKICAgICAgICAg
ICAgICAgICAgICAgICAgKCRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddKSA/CiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAkdXNlci4nICgnLmhyZWYoJ1JlLWNvbm5lY3QnLCRyZWdp
c3RlclVSTCkuJyknCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICc8ZW0+dW5rbm93
bjwvZW0+JwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmhyZWYoJ0Nvbm5lY3QgdG8g
VHdpdHRlcicsJHJlZ2lzdGVyVVJMKSkKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAg
ICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVHdlZXQgc2V0dGluZ3Mn
LCAyKSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAogICAgICAg
ICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfY2FjaGVfZGlyIj5U
d2VldCBwcmVmaXg8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9
InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAg
ICAgICAgICAgICAgIC50ZChmSW5wdXQoJ3RleHQnLCdhcmNfdHdpdHRlcl9wcmVmaXgnLCRw
cmVmaXgsJycsJycsJycsJycsJycsJ2FyY190d2l0dGVyX3ByZWZpeCcpKQogICAgICAgICAg
ICAgICAgKS50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190
d2l0dGVyX3R3ZWV0X2RlZmF1bHQiPlR3ZWV0IGFydGljbGVzIGJ5IGRlZmF1bHQ8L2xhYmVs
PicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0
OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50ZCh5
ZXNub1JhZGlvKCdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0JywgJHR3ZWV0X2RlZmF1bHQs
ICcnLCAnYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcpKQogICAgICAgICAgICAgICAgKS50
cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX3Vy
bF9tZXRob2QiPlVSTCBzaG9ydG5lcjwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAg
ICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7
IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKGFyY190d2l0dGVyX3VybF9tZXRob2Rfc2Vs
ZWN0KCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJywkdXJsX21ldGhvZCkpCiAgICAgICAgICAg
ICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdUd2l0dGVyIHRhYics
IDIpLDIpCiAgICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgn
PGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfdGFiIj5Mb2NhdGlvbiBvZiBUd2l0dGVyIHRhYjwv
bGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjog
cmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAg
LnRkKGFyY190d2l0dGVyX3RhYl9zZWxlY3QoJ2FyY190d2l0dGVyX3RhYicsJHRhYikpCiAg
ICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdDYWNo
ZScsIDIpLDIpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAg
ICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl9jYWNoZV9kaXIi
PkNhY2hlIGRpcmVjdG9yeTwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBz
dHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAg
ICAgICAgICAgICAgICAgICAgLnRkKGZJbnB1dCgndGV4dCcsJ2FyY190d2l0dGVyX2NhY2hl
X2RpcicsJGNhY2hlX2RpciwnJywnJywnJywnJywnJywnYXJjX3R3aXR0ZXJfY2FjaGVfZGly
JykpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAg
ICAgICAgICAgdGRhKAogICAgICAgICAgICAgICAgICAgICAgICBmSW5wdXQoJ3N1Ym1pdCcs
ICdTdWJtaXQnLCBnVHh0KCdzYXZlX2J1dHRvbicpLCAncHVibGlzaCcpCiAgICAgICAgICAg
ICAgICAgICAgICAgIC5uLnNJbnB1dCgncHJlZnNfc2F2ZScpCiAgICAgICAgICAgICAgICAg
ICAgICAgIC5uLmVJbnB1dCgncGx1Z2luX3ByZWZzLmFyY190d2l0dGVyJykKICAgICAgICAg
ICAgICAgICAgICAsICcgY29sc3Bhbj0iMiIgY2xhc3M9Im5vbGluZSInKSkpCiAgICAgICAg
ICAgICAgICAuZW5kVGFibGUoKTsKICAgICAgICB9IGVsc2VpZiAoICRzdGVwIT0ncmVnaXN0
ZXInICkgewogICAgICAgICAgICAkcmVnaXN0ZXJVUkwgPSBhcmNfdHdpdHRlcjo6Y2FsbGJh
Y2tVUkwoJGV2ZW50LCdyZWdpc3RlcicpOwogICAgICAgICAgICAkaHRtbC49IHN0YXJ0VGFi
bGUoJ2xpc3QnKS5mb3JtKAogICAgICAgICAgICAgICAgdHIoCiAgICAgICAgICAgICAgICAg
ICAgdGRjcyhoZWQoJ1R3aXR0ZXIgYWNjb3VudCBkZXRhaWxzJywgMiksMikKICAgICAgICAg
ICAgICAgICkKICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGEo
JzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX3VzZXIiPlR3aXR0ZXIgdXNlcm5hbWU8L2xhYmVs
PicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0
OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50ZCgK
ICAgICAgICAgICAgICAgICAgICAgICAgKCc8ZW0+dW5rbm93bjwvZW0+ICgnCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAuaHJlZignQ29ubmVjdCB0byBUd2l0dGVyJywkcmVnaXN0
ZXJVUkwpLicpJykKICAgICAgICAgICAgICAgICkpKQogICAgICAgICAgICAgICAgLmVuZFRh
YmxlKCk7CiAgICAgICAgfQogICAgfQoKICAgIGVjaG8gJGh0bWw7Cn0KCi8vIEFkZCBUd2l0
dGVyIHRhYiB0byBUZXh0cGF0dGVybgpmdW5jdGlvbiBhcmNfYWRtaW5fdHdpdHRlcigkZXZl
bnQsJHN0ZXApCnsKICAgIGdsb2JhbCAkcHJlZnMsICRhcmNfdHdpdHRlcl9jb25zdW1lcktl
eSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgICR0d2l0ID0gbmV3IGFyY190
d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAsICRhcmNfdHdp
dHRlcl9jb25zdW1lclNlY3JldCwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbidd
CiAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCdd
KTsKCiAgICAkdHdpdC0+Y2FjaGVEaXIoJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXIn
XSk7CgogICAgJHhtbCA9ICR0d2l0LT5nZXQoJ3VzZXJzL3Nob3cnCiAgICAgICAgLCBhcnJh
eSgnc2NyZWVuX25hbWUnPT4kcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSkpOwogICAgJHR3
aXR0ZXJVc2VyID0gQCR4bWwtPnhwYXRoKCcvdXNlcicpOwogICAgJHR3aXR0ZXJVc2VyID0g
JHR3aXR0ZXJVc2VyWzBdOwogICAgJHR3aXR0ZXJVc2VyVVJMID0gJ2h0dHA6Ly93d3cudHdp
dHRlci5jb20vJy4kdHdpdHRlclVzZXItPnNjcmVlbl9uYW1lOwoKICAgIGlmICgkc3RlcD09
InR3ZWV0IikgeyAvLyBwb3N0IGFuIHVwZGF0ZSB0byBUd2l0dGVyCgogICAgICAgIC8vIGZl
dGNoIGFuZCBjbGVhbiBtZXNzYWdlCiAgICAgICAgJG1lc3NhZ2UgPSBzdHJpcF90YWdzKGdw
cygnbWVzc2FnZScpKTsKICAgICAgICAkY291bnQgPSBzdHJsZW4oJG1lc3NhZ2UpOwoKICAg
ICAgICBpZiAoJGNvdW50PD0xNDAgJiYgJGNvdW50PjApIHsgLy8gcG9zdCB1cGRhdGUKICAg
ICAgICAgICAgJHJlc3VsdCA9ICR0d2l0LT5wb3N0KCdzdGF0dXNlcy91cGRhdGUnLCBhcnJh
eSgnc3RhdHVzJyA9PiAkbWVzc2FnZSkpOwogICAgICAgIH0gZWxzZSB7IC8vIG1lc3NhZ2Ug
dG9vIGxvbmcsIEphdmFTY3JpcHQgaW50ZXJmYWNlIHNob3VsZCBwcmV2ZW50IHRoaXMKICAg
ICAgICAgICAgJHJlc3VsdCA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgcGFnZXRvcCgn
VHdpdHRlcicsCiAgICAgICAgICAgICgoJHJlc3VsdCE9ZmFsc2UpPydUd2l0dGVyIHVwZGF0
ZWQnOidFcnJvciB1cGRhdGluZyBUd2l0dGVyJykpOwoKICAgIH0gZWxzZWlmICgkc3RlcD09
ImRlbGV0ZSIpIHsgLy8gZGVsZXRlIGFuIHVwZGF0ZSBmcm9tIFR3aXR0ZXIKCiAgICAgICAg
JGlkID0gc3RyaXBfdGFncyhncHMoJ2lkJykpOwogICAgICAgIGlmICgkaWQpIHsKICAgICAg
ICAgICAgJHR3aXQtPmRlbGV0ZSgnc3RhdHVzZXMvZGVzdHJveScuJGlkKTsKICAgICAgICAg
ICAgc2FmZV9kZWxldGUoJ2FyY190d2l0dGVyJywidHdlZXRfaWQgPSAkaWQiKTsKICAgICAg
ICB9CgogICAgICAgIHBhZ2V0b3AoJ1R3aXR0ZXInLCdUd2l0dGVyIHVwZGF0ZWQnKTsKCiAg
ICB9IGVsc2UgewoKICAgICAgICBwYWdldG9wKCdUd2l0dGVyJyk7CgogICAgfQoKICAgIC8v
IFByZXBhcmUgSmF2YVNjcmlwdCB0byBjcmVhdGUgVHdpdHRlciB1cGRhdGUgaW50ZXJmYWNl
CgogICAgJGpzID0gJzxzY3JpcHQgbGFuZ3VhZ2U9ImphdmFzY3JpcHQiIHR5cGU9InRleHQv
amF2YXNjcmlwdCI+JzsKICAgICRqcy49ICIkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigp
ewogICAgICAgICAgICB2YXIgY291bnRlclN0eWxlID0gJ2ZvbnQtd2VpZ2h0OmJvbGQ7Zmxv
YXQ6cmlnaHQ7Zm9udC1zaXplOjJlbTtsaW5lLWhlaWdodDoxLjJlbTsnOwogICAgICAgICAg
ICAkKCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0eWxlJywgY291bnRlclN0eWxlKydjb2xvcjoj
Y2NjOycpOwogICAgICAgICAgICAkKCcjbWVzc2FnZScpLmtleXVwKGZ1bmN0aW9uKCkgewog
ICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gMTQwLSQoJyNtZXNzYWdlJykudmFsKCkubGVu
Z3RoOwogICAgICAgICAgICAgICAgJCgnI3R3ZWV0Y291bnQnKS5odG1sKGNvdW50KycnKTsg
Ly8gaGFjayB0byBmb3JjZSBvdXRwdXQgb2YgMAogICAgICAgICAgICAgICAgaWYgKGNvdW50
PDApIHsKICAgICAgICAgICAgICAgICAgICAkKCdpbnB1dC5wdWJsaXNoJykuYXR0cignZGlz
YWJsZWQnLCAnZGlzYWJsZWQnKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAg
ICAgICAgICAgICAgJCgnaW5wdXQucHVibGlzaCcpLmF0dHIoJ2Rpc2FibGVkJywgJycpOwog
ICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGNvdW50PDApIHsKICAgICAg
ICAgICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0eWxlJywgY291bnRlclN0
eWxlKydjb2xvcjojZjAwOycpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb3VudDwx
MCkgewogICAgICAgICAgICAgICAgICAgICQoJyN0d2VldGNvdW50JykuYXR0cignc3R5bGUn
LCBjb3VudGVyU3R5bGUrJ2NvbG9yOiMwMDA7Jyk7CiAgICAgICAgICAgICAgICB9IGVsc2Ug
ewogICAgICAgICAgICAgICAgICAgICQoJyN0d2VldGNvdW50JykuYXR0cignc3R5bGUnLCBj
b3VudGVyU3R5bGUrJ2NvbG9yOiNjY2M7Jyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg
ICAgIH0pCiAgICAgICAgfSk7IjsKICAgICRqcy49ICI8L3NjcmlwdD4iOwoKICAgICRvdXQg
PSAnJzsKICAgICR4bWwgPSAkdHdpdC0+Z2V0KCdzdGF0dXNlcy91c2VyX3RpbWVsaW5lJwog
ICAgICAgICwgYXJyYXkoJ3NjcmVlbl9uYW1lJz0+JHByZWZzWydhcmNfdHdpdHRlcl91c2Vy
J10sJ2NvdW50Jz0+MjUpKTsKICAgICR0d2VldHMgPSBAJHhtbC0+eHBhdGgoJy9zdGF0dXNl
cy9zdGF0dXMnKTsKICAgIGlmICgkdHdlZXRzKSBmb3JlYWNoICgkdHdlZXRzIGFzICR0d2Vl
dCkgewogICAgICAgICR0aW1lID0gc3RydG90aW1lKGh0bWxlbnRpdGllcygkdHdlZXQtPmNy
ZWF0ZWRfYXQpKTsKICAgICAgICAkZGF0ZSA9IHNhZmVfc3RyZnRpbWUoJHByZWZzWydhcmNo
aXZlX2RhdGVmb3JtYXQnXSwkdGltZSk7CiAgICAgICAgJG91dC49IHRyKHRkKCRkYXRlLCdz
cGFuJykKICAgICAgICAgICAgLnRkKGFyY19Ud2l0dGVyOjptYWtlTGlua3MoaHRtbGVudGl0
aWVzKCR0d2VldC0+dGV4dAogICAgICAgICAgICAgICAgLCBFTlRfUVVPVEVTLCdVVEYtOCcp
KSkKICAgICAgICAgICAgLnRkKGRMaW5rKCdhcmNfYWRtaW5fdHdpdHRlcicsJ2RlbGV0ZScs
J2lkJywkdHdlZXQtPmlkLCcnKSkKICAgICAgICAgICAgKTsKICAgIH0KCiAgICAkaHRtbCA9
IHN0YXJ0VGFibGUoJ2VkaXQnKQogICAgICAgICAgICAudHIodGQoCiAgICAgICAgICAgIGdy
YWYoJzxpbWcgc3JjPSInLiR0d2l0dGVyVXNlci0+cHJvZmlsZV9pbWFnZV91cmwuJyIgYWx0
PSJUd2l0dGVyIGF2YXRhciIgLz4nCiAgICAgICAgICAgICwnIHN0eWxlPSJmbG9hdDpsZWZ0
O3BhZGRpbmc6MnB4OyInKQogICAgICAgICAgICAuZ3JhZihocmVmKCR0d2l0dGVyVXNlci0+
bmFtZSwkdHdpdHRlclVzZXJVUkwpLCcgc3R5bGU9ImZvbnQtc2l6ZToxLjJlbTtmb250LXdl
aWdodDpib2xkOyInKQogICAgICAgICAgICAuZ3JhZihocmVmKCR0d2l0dGVyVXNlci0+ZnJp
ZW5kc19jb3VudC4nIGZvbGxvd2luZycsJHR3aXR0ZXJVc2VyVVJMLicvZm9sbG93aW5nJykK
ICAgICAgICAgICAgLicsICcuaHJlZigkdHdpdHRlclVzZXItPmZvbGxvd2Vyc19jb3VudC4n
IGZvbGxvd2VycycsJHR3aXR0ZXJVc2VyVVJMLicvZm9sbG93ZXJzJykKICAgICAgICAgICAg
LicsICcuaHJlZigkdHdpdHRlclVzZXItPnN0YXR1c2VzX2NvdW50LicgdXBkYXRlcycsJHR3
aXR0ZXJVc2VyVVJMKSkpKQogICAgICAgICAgICAudHIodGQoZm9ybSgKICAgICAgICAgICAg
Z3JhZigiVXBkYXRlIFR3aXR0ZXIuLi48c3BhbiBpZD0ndHdlZXRjb3VudCcgc3R5bGU9J2Zv
bnQtd2VpZ2h0OmJvbGQ7ZmxvYXQ6cmlnaHQ7Jz4xNDA8L3NwYW4+IikKICAgICAgICAgICAg
LnRleHRfYXJlYSgnbWVzc2FnZScsJzUwJywnNTUwJywnJywnbWVzc2FnZScpCiAgICAgICAg
ICAgIC5lSW5wdXQoJ2FyY19hZG1pbl90d2l0dGVyJykKICAgICAgICAgICAgLnNJbnB1dCgn
dHdlZXQnKS5icgogICAgICAgICAgICAuZklucHV0KCdzdWJtaXQnLCd1cGRhdGUnLGdUeHQo
J1VwZGF0ZScpLCdwdWJsaXNoJykKICAgICAgICApKSkKICAgICAgICAuZW5kVGFibGUoKTsK
CiAgICAvLyBBdHRhY2ggcmVjZW50IFR3aXR0ZXIgdXBkYXRlcwoKICAgICRodG1sLj0gc3Rh
cnRUYWJsZSgnbGlzdCcsJycsJycsJycsJzkwJScpCiAgICAgICAgLiRvdXQKICAgICAgICAu
ZW5kVGFibGUoKTsKCiAgICAvLyBPdXRwdXQgSmF2YVNjcmlwdCBhbmQgSFRNTAoKICAgIGVj
aG8gJGpzLiRodG1sOwp9CgovLyBBZGQgVHdpdHRlciBvcHRpb25zIHRvIGFydGljbGUgYXJ0
aWNsZSBzY3JlZW4KZnVuY3Rpb24gYXJjX2FwcGVuZF90d2l0dGVyKCRldmVudCwgJHN0ZXAs
ICRkYXRhLCAkcnMxKQp7CiAgICBnbG9iYWwgJHByZWZzLCAkYXJjX3R3aXR0ZXI7CiAgICAk
cHJlZml4ID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3ByZWZpeCcpKTsKICAgICRwcmVmaXgg
PSAoJHByZWZpeCkgPyAkcHJlZml4IDogJHByZWZzWydhcmNfdHdpdHRlcl9wcmVmaXgnXTsK
ICAgICRzdWZmaXggPSB0cmltKGdwcygnYXJjX3R3aXR0ZXJfc3VmZml4JykpOwoKICAgIGlm
ICgkcnMxWydJRCddKSB7CiAgICAgICAgJHNxbCA9ICJTRUxFQ1QgdHdlZXRfaWQsdHdlZXQg
RlJPTSAiLlBGWC4iYXJjX3R3aXR0ZXIgV0hFUkUgYXJ0aWNsZV9pZD0iLiRyczFbJ0lEJ10u
IjsiOwogICAgICAgICRyczIgPSBzYWZlX3F1ZXJ5KCRzcWwpOyAkcnMyID0gbmV4dFJvdygk
cnMyKTsKICAgIH0gZWxzZSB7IC8vIG5ldyBhcnRpY2xlCiAgICAgICAgJHJzMiA9ICcnOwog
ICAgfQoKICAgIGlmICgkcnMxWydJRCddICYmICRyczJbJ3R3ZWV0X2lkJ10pIHsKICAgICAg
ICAkY29udGVudCA9IGFyY19Ud2l0dGVyOjptYWtlTGlua3MoJHJzMlsndHdlZXQnXSk7CiAg
ICAgICAgcmV0dXJuICRkYXRhLmZpZWxkc2V0KCRjb250ZW50LCAnVHdpdHRlciB1cGRhdGUn
LCAnYXJjX3R3aXR0ZXInKTsKICAgIH0gZWxzZSB7CiAgICAgICAgJHZhciA9ICgkcnMxWydJ
RCddKSA/IDAgOiAkcHJlZnNbJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnXTsKICAgICAg
ICAkY29udGVudCAgPSB0YWcoeWVzbm9SYWRpbygnYXJjX3R3ZWV0X3RoaXMnLCAkdmFyLCAn
JywgJ2FyY190d2VldF90aGlzJyksJ3AnKTsKICAgICAgICAkY29udGVudCAuPSB0YWcoaHJl
ZignT3B0aW9ucycsJyNhcmNfdHdpdHRlcl9vcHRpb25zJyksJ3AnLCcgY2xhc3M9InBsYWlu
IGxldmVyIiBzdHlsZT0ibWFyZ2luLXRvcDo1cHg7IicpOwogICAgICAgICRjb250ZW50IC49
IHRhZyh0YWcodGFnKCdUd2VldCBwcmVmaXgnLCdsYWJlbCcsICcgZm9yPSJhcmNfdHdpdHRl
cl9wcmVmaXgiJykKICAgICAgICAgICAgLmZJbnB1dCgndGV4dCcsJ2FyY190d2l0dGVyX3By
ZWZpeCcsJHByZWZpeCwnZWRpdCcsJycsJycsJzIyJywnJywnYXJjX3R3aXR0ZXJfcHJlZml4
JyksJ3AnKQogICAgICAgICAgICAudGFnKHRhZygnVHdlZXQgc3VmZml4IChlZyAjaGFzaHRh
Z3MpJywnbGFiZWwnLCAnIGZvcj0iYXJjX3R3aXR0ZXJfc3VmZml4IicpCiAgICAgICAgICAg
IC5mSW5wdXQoJ3RleHQnLCdhcmNfdHdpdHRlcl9zdWZmaXgnLCRzdWZmaXgsJ2VkaXQnLCcn
LCcnLCcyMicsJycsJ2FyY190d2l0dGVyX3N1ZmZpeCcpLCdwJykKICAgICAgICAgICAgLCdk
aXYnLCcgaWQ9ImFyY190d2l0dGVyX29wdGlvbnMiIGNsYXNzPSJ0b2dnbGUiIHN0eWxlPSJk
aXNwbGF5Om5vbmUiJyk7CiAgICAgICAgaWYgKGlzc2V0KCRhcmNfdHdpdHRlclsnZXJyb3In
XSkpIHsKICAgICAgICAgICAgJGNvbnRlbnQgLj0gJzxwPicuJGFyY190d2l0dGVyWydlcnJv
ciddLic8L3A+JzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICRkYXRhLmZpZWxkc2V0KCRj
b250ZW50LCAnVXBkYXRlIFR3aXR0ZXInLCAnYXJjX3R3aXR0ZXInKTsKICAgIH0KCn0KCi8v
IFVwZGF0ZSBUd2l0dGVyIHdpdGggcG9zdGVkIGFydGljbGUKZnVuY3Rpb24gYXJjX2FydGlj
bGVfdHdlZXQoJGV2ZW50LCRzdGVwKQp7CiAgICBnbG9iYWwgJHByZWZzLCAkYXJjX3R3aXR0
ZXIsICRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICwgJGFyY190d2l0dGVyX2Nv
bnN1bWVyU2VjcmV0OwoKICAgICRhcnRpY2xlX2lkID0gZW1wdHkoJEdMT0JBTFNbJ0lEJ10p
ID8gZ3BzKCdJRCcpIDogJEdMT0JBTFNbJ0lEJ107CiAgICBpZiAoIWVtcHR5KCRhcnRpY2xl
X2lkKSkgewoKICAgICAgICBpbmNsdWRlX29uY2UgdHhwYXRoLicvcHVibGlzaC90YWdoYW5k
bGVycy5waHAnOwoKICAgICAgICAkYXJ0aWNsZSA9IHNhZmVfcm93KCJJRCwgVGl0bGUsIFNl
Y3Rpb24sIFBvc3RlZCIsICd0ZXh0cGF0dGVybicsCiAgICAgICAgICAgICJJRD17JGFydGlj
bGVfaWR9IEFORCBTdGF0dXM9NCBBTkQgbm93KCk+PVBvc3RlZCIpOwoKICAgICAgICBpZiAo
JGFydGljbGUgJiYgZ3BzKCdhcmNfdHdlZXRfdGhpcycpKSB7IC8vIHR3ZWV0IGFydGljbGUK
CiAgICAgICAgICAgIC8vIE5lZWQgdG8gbWFudWFsbHkgdXBkYXRlIHRoZSAnVVJMIG9ubHkg
dGl0bGUnIGJlZm9yZSBidWlsZGluZyB0aGUKICAgICAgICAgICAgLy8gVVJMCiAgICAgICAg
ICAgICRhcnRpY2xlWyd1cmxfdGl0bGUnXSA9IGdwcygndXJsX3RpdGxlJyk7CiAgICAgICAg
ICAgIC8vIE1ha2Ugc2hvcnQgVVJMCiAgICAgICAgICAgICR1cmwgPSBwZXJtbGlua3VybCgk
YXJ0aWNsZSk7CiAgICAgICAgICAgICRzaG9ydF91cmwgPSBhcmNfc2hvcnRlbl91cmwoJHVy
bCwkcHJlZnNbJ2FyY190d2l0dGVyX3VybF9tZXRob2QnXSwKICAgICAgICAgICAgICAgIGFy
cmF5KCdpZCc9PiRhcnRpY2xlX2lkKSk7CgogICAgICAgICAgICBpZiAoISRzaG9ydF91cmwp
IHsgLy8gRmFpbGVkIHRvIG9idGFpbiBhIHNob3J0ZW5lZCBVUkwsIGRvIG5vdCB0d2VldCEK
ICAgICAgICAgICAgICAgICRhcmNfdHdpdHRlclsnZXJyb3InXSA9ICdVbmFibGUgdG8gb2J0
YWluIGEgc2hvcnQgVVJMIGZvciB0aGlzIGFydGljbGUuJzsKCiAgICAgICAgICAgICAgICBy
ZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIENvbnN0cnVjdCBU
d2l0dGVyIHVwZGF0ZQogICAgICAgICAgICAkcHJlZml4ICA9IHRyaW0oZ3BzKCdhcmNfdHdp
dHRlcl9wcmVmaXgnKSk7CiAgICAgICAgICAgICRwcmVfbGVuID0gc3RybGVuKCRwcmVmaXgp
OwogICAgICAgICAgICAkcHJlZml4ICA9ICgkcHJlZml4ICYmICRwcmVfbGVuPD0yMCkgPyAk
cHJlZml4LicgJyA6ICcnOwogICAgICAgICAgICAkc3VmZml4ICA9IHRyaW0oZ3BzKCdhcmNf
dHdpdHRlcl9zdWZmaXgnKSk7CiAgICAgICAgICAgICRzdWZfbGVuID0gc3RybGVuKCRzdWZm
aXgpOwogICAgICAgICAgICAkc3VmZml4ICA9ICgkc3VmZml4ICYmICRzdWZfbGVuPD00MCkg
PyAnICcuJHN1ZmZpeCA6ICcnOwogICAgICAgICAgICAkdXJsX2xlbiA9IHN0cmxlbigkc2hv
cnRfdXJsKSsxOyAvLyBjb3VudCBVUkwgbGVuZ3RoICsgMSBmb3IgcHJlZml4ZWQgc3BhY2UK
ICAgICAgICAgICAgaWYgKCRwcmVmaXgpICRwcmVfbGVuICs9IDE7CiAgICAgICAgICAgIGlm
ICgkc3VmZml4KSAkc3VmX2xlbiArPSAxOwogICAgICAgICAgICBpZiAoKHN0cmxlbigkYXJ0
aWNsZVsnVGl0bGUnXSkrJHVybF9sZW4rJHByZV9sZW4rJHN1Zl9sZW4pPjE0MCkgewogICAg
ICAgICAgICAgICAgJGFydGljbGVbJ1RpdGxlJ10gPSBzdWJzdHIoJGFydGljbGVbJ1RpdGxl
J10sMCwxMzUtJHVybF9sZW4tJHByZV9sZW4tJHN1Zl9sZW4pLicuLi4nOwogICAgICAgICAg
ICB9CiAgICAgICAgICAgICR0d2VldCA9ICRwcmVmaXguJGFydGljbGVbJ1RpdGxlJ10uIiAi
LiRzaG9ydF91cmwuJHN1ZmZpeDsKCiAgICAgICAgICAgIC8vIFVwZGF0ZSBUd2l0dGVyCiAg
ICAgICAgICAgICR0d2l0ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1l
cktleQogICAgICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQsICRw
cmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXQogICAgICAgICAgICAgICAgLCAkcHJl
ZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0J10pOwogICAgICAgICAgICAkcmVz
dWx0ID0gJHR3aXQtPnBvc3QoJ3N0YXR1c2VzL3VwZGF0ZScsIGFycmF5KCdzdGF0dXMnID0+
ICR0d2VldCkpOwoKICAgICAgICAgICAgJHR3ZWV0X2lkID0gKGlzX29iamVjdCgkcmVzdWx0
KSkgPyAkcmVzdWx0WzBdLT5pZCA6IDA7CgogICAgICAgICAgICBpZiAoJHR3ZWV0X2lkKSB7
CgogICAgICAgICAgICAgICAgJHR3ZWV0ID0gYWRkc2xhc2hlcygkdHdlZXQpOwoKICAgICAg
ICAgICAgICAgIC8vIHVwZGF0ZSBhcmNfdHdpdHRlciB0YWJsZSB3aXRoIHR3ZWV0CiAgICAg
ICAgICAgICAgICAkc3FsID0gIklOU0VSVCBJTlRPICIuUEZYLiJhcmNfdHdpdHRlciAoYXJ0
aWNsZV9pZCx0d2VldF9pZCx0d2VldCx0aW55dXJsKSAiOwogICAgICAgICAgICAgICAgJHNx
bC49ICJWQUxVRVMoJGFydGljbGVfaWQsJHR3ZWV0X2lkLFwiJHR3ZWV0XCIsJyRzaG9ydF91
cmwnKTsiOwogICAgICAgICAgICAgICAgc2FmZV9xdWVyeSgkc3FsKTsKCiAgICAgICAgICAg
ICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgICAgICAgIH0gZWxzZSB7CgogICAgICAgICAgICAg
ICAgJGFyY190d2l0dGVyWydlcnJvciddID0gJ1R3aXR0ZXIgcmVzcG9uc2U6ICcKICAgICAg
ICAgICAgICAgICAgICAuJHR3aXQtPmh0dHBfY29kZTsKICAgICAgICAgICAgICAgIHJldHVy
biBmYWxzZTsKCiAgICAgICAgICAgIH0KCiAgICAgICAgfQoKICAgIH0KCiAgICByZXR1cm4g
ZmFsc2U7Cgp9CgovKgogKiBTaG9ydGVuIFVSTHMgdXNpbmcgdmFyaW91cyBtZXRob2RzCiAq
LwoKZnVuY3Rpb24gYXJjX3Nob3J0ZW5fdXJsKCR1cmwsICRtZXRob2Q9JycsICRhdHRzPWFy
cmF5KCkpCnsKICAkY2ggPSBjdXJsX2luaXQoKTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxP
UFRfSEVBREVSLCAwKTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUkVUVVJOVFJBTlNG
RVIsIHRydWUpOwogIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9USU1FT1VULCAxMCk7Cgog
IHN3aXRjaCAoJG1ldGhvZCkgewogICAgY2FzZSAnc21kJzogLy8gY3JlYXRlIGEgc2hvcnRl
bmVkIFVSTCB1c2luZyBTTUQgU2hvcnQgVVJMCiAgICAgIHJldHVybiAoJGF0dHNbJ2lkJ10p
ID8gaHUuJGF0dHNbJ2lkJ10gOiBmYWxzZTsgYnJlYWs7CiAgICBjYXNlICdpc2dkJzoKCiAg
ICAgICR1ID0gJ2h0dHA6Ly9pcy5nZC9hcGkucGhwP2xvbmd1cmw9Jy51cmxlbmNvZGUoJHVy
bCk7CiAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VUkwsICR1KTsKCiAgICAgICR0
aW55dXJsID0gY3VybF9leGVjKCRjaCk7CiAgICAgIGlmICgkdGlueXVybCE9J0Vycm9yJyAm
JiAkdGlueXVybCE9JycpIHsKICAgICAgICByZXR1cm4gJHRpbnl1cmw7CiAgICAgIH0gZWxz
ZSB7CiAgICAgICAgdHJpZ2dlcl9lcnJvcignYXJjX3R3aXR0ZXIgZmFpbGVkIHRvIGdldCBh
IGlzLmdkIFVSTCBmb3IgJwogICAgICAgICAgICAuJHVybCxFX1VTRVJfV0FSTklORyk7CiAg
ICAgIH0KICAgICAgYnJlYWs7CgogICAgY2FzZSAndGlueXVybCc6IGRlZmF1bHQ6IC8vIGNy
ZWF0ZSBhIHNob3J0ZW5lZCBVUkwgdXNpbmcgVGlueVVSTAoKICAgICAgJHUgPSAnaHR0cDov
L3Rpbnl1cmwuY29tL2FwaS1jcmVhdGUucGhwP3VybD0nLnVybGVuY29kZSgkdXJsKTsKICAg
ICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwgJHUpOwogICAgICAkdGlueXVybCA9
IGN1cmxfZXhlYygkY2gpOwogICAgICBpZiAoJHRpbnl1cmwhPSdFcnJvcicgJiYgJHRpbnl1
cmwhPScnKSB7CiAgICAgICAgcmV0dXJuICR0aW55dXJsOwogICAgICB9IGVsc2UgewogICAg
ICAgIHRyaWdnZXJfZXJyb3IoJ2FyY190d2l0dGVyIGZhaWxlZCB0byBnZXQgYSBUaW55VVJM
IGZvciAnLiR1cmwsRV9VU0VSX1dBUk5JTkcpOwogICAgICB9CgogIH0KCiAgcmV0dXJuIGZh
bHNlOyAvLyBmYWlsCgp9CgovKgogKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgoqLwoKY2xh
c3MgYXJjX3R3aXR0ZXIgZXh0ZW5kcyBUd2l0dGVyT0F1dGggewogICAgLy8gQ2FjaGluZyB2
YXJpYWJsZXMKICAgIHByaXZhdGUgJF9jYWNoZSA9IHRydWU7CiAgICBwcml2YXRlICRfY2Fj
aGVfZGlyID0gJy4vdG1wJzsKICAgIHByaXZhdGUgJF9jYWNoZV90aW1lID0gMTgwMDsgLy8g
MzAgbWludXRlIGNhY2hlCgogICAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGNvbnN1bWVyX2tl
eSwgJGNvbnN1bWVyX3NlY3JldCwgJG9hdXRoX3Rva2VuID0gTlVMTAogICAgICAgICwgJG9h
dXRoX3Rva2VuX3NlY3JldCA9IE5VTEwpCiAgICB7CiAgICAgICAgcGFyZW50OjpfX2NvbnN0
cnVjdCgkY29uc3VtZXJfa2V5LCAkY29uc3VtZXJfc2VjcmV0LCAkb2F1dGhfdG9rZW4KICAg
ICAgICAgICAgLCAkb2F1dGhfdG9rZW5fc2VjcmV0KTsKICAgICAgICAkdGhpcy0+Zm9ybWF0
ID0gJ3htbCc7CiAgICAgICAgJHRoaXMtPnRpbWVvdXQgPSAxNTsKICAgICAgICAkdGhpcy0+
Y29ubmVjdHRpbWVvdXQgPSAxNTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gY2FsbGJh
Y2tVUkwoJGV2ZW50LCRzdGVwKQogICAgewogICAgICAgIHJldHVybiBodS4ndGV4dHBhdHRl
cm4vaW5kZXgucGhwP2V2ZW50PScuJGV2ZW50LicmYW1wO3N0ZXA9Jy4kc3RlcDsKICAgIH0K
CiAgICAvLyBjcmVhdGUgVHdpdHRlciBhbmQgZXh0ZXJuYWwgbGlua3MgaW4gdGV4dAogICAg
cHVibGljIHN0YXRpYyBmdW5jdGlvbiBtYWtlTGlua3MoJHRleHQpCiAgICB7CiAgICAgICAg
JHVybCA9ICcvXGIoaHR0cHxodHRwc3xmdHApOlwvXC8oW0EtWjAtOV1bQS1aMC05Xy1dKig/
OlwuW0EtWjAtOV1bQS1aMC05Xy1dKikrKTo/KFxkKyk/XC8/KFtcL1x3K1wuXSspXGIvaSc7
CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2UoJHVybCwgIjxhIGhyZWY9JyQwJz4kMDwv
YT4iLCAkdGV4dCk7CiAgICAgICAgJHVybCA9ICcvXGIoXnxccyl3d3cuKFthLXpfQS1aMC05
XSspKChcLlthLXpdKykrKVxiL2knOwogICAgICAgICR0ZXh0ID0gcHJlZ19yZXBsYWNlKCR1
cmwsICI8YSBocmVmPSdodHRwOi8vd3d3LiQyJDMnPnd3dy4kMiQzPC9hPiIsICR0ZXh0KTsK
ICAgICAgICAkdGV4dCA9IHByZWdfcmVwbGFjZSgiLyhefFxzKUAoW2Etel9BLVowLTldKykv
IiwKICAgICAgICAgICAgIiQxQDxhIGhyZWY9J2h0dHA6Ly90d2l0dGVyLmNvbS8kMic+JDI8
L2E+IiwkdGV4dCk7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2UoIi8oXnxccykoXCMo
W2Etel9BLVowLTk6Xy1dKykpLyIsCiAgICAgICAgICAgICIkMTxhIGhyZWY9J2h0dHA6Ly90
d2l0dGVyLmNvbS9zZWFyY2g/cT0lMjMkMyc+JDI8L2E+IiwkdGV4dCk7CiAgICAgICAgcmV0
dXJuICR0ZXh0OwogIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gZ2V0KCR1cmwsICRwYXJhbXMg
PSBhcnJheSgpKQogICAgewogICAgICAgICRhcGlfdXJsID0gbWQ1KCR1cmwudXJsZW5jb2Rl
KHNlcmlhbGl6ZSgkcGFyYW1zKSkpOwogICAgICAgICRkYXRhID0gJyc7CgogICAgICAgIGlm
ICgkdGhpcy0+X2NhY2hlKSB7IC8vIGNoZWNrIGZvciBjYWNoZWQgeG1sCgogICAgICAgICAg
ICAkZGF0YSA9ICR0aGlzLT5fcmV0cmlldmVDYWNoZSgkYXBpX3VybCk7CgogICAgICAgIH0K
ICAgICAgICBpZiAoZW1wdHkoJGRhdGEpKSB7CiAgICAgICAgICAgICRkYXRhID0gcGFyZW50
OjpnZXQoJHVybCwgJHBhcmFtcyk7CiAgICAgICAgICAgIGlmICgkdGhpcy0+aHR0cF9jb2Rl
PT09MjAwICYmICR4bWw9c2ltcGxleG1sX2xvYWRfc3RyaW5nKCRkYXRhKSkgeyAvLyBzYXZl
IGNhY2hlCiAgICAgICAgICAgICAgICAkZmlsZSA9ICR0aGlzLT5fY2FjaGVfZGlyLicvJy4k
YXBpX3VybDsKICAgICAgICAgICAgICAgIGZpbGVfcHV0X2NvbnRlbnRzKCRmaWxlLCRkYXRh
LExPQ0tfRVgpOwogICAgICAgICAgICAgICAgcmV0dXJuICR4bWw7CiAgICAgICAgICAgIH0g
ZWxzZSB7IC8vIGZhaWxlZCB0byByZXRyaWV2ZSBkYXRhIGZyb20gVHdpdHRlcgoKICAgICAg
ICAgICAgICAgIGlmICgkdGhpcy0+X2NhY2hlKSB7IC8vIGF0dGVtcHQgdG8gZm9yY2UgY2Fj
aGVkIHhtbCByZXR1cm4KCiAgICAgICAgICAgICAgICAgICAgJGRhdGEgPSAkdGhpcy0+X3Jl
dHJpZXZlQ2FjaGUoJGFwaV91cmwsdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKCRk
YXRhKSByZXR1cm4gQHNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSk7CgogICAgICAgICAg
ICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgICAgIH0K
ICAgICAgICB9IGVsc2UgeyAvLyByZXR1cm4gY2FjaGVkIHhtbAogICAgICAgICAgICByZXR1
cm4gQHNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSk7CiAgICAgICAgfQogICAgfSAvL2Vu
ZCBnZXQoKQoKICAgIGZ1bmN0aW9uIHBvc3QoJHVybCwgJHBhcmFtcyA9IGFycmF5KCkpCiAg
ICB7CiAgICAgICAgJGRhdGEgPSBwYXJlbnQ6OnBvc3QoJHVybCwkcGFyYW1zKTsKICAgICAg
ICByZXR1cm4gc2ltcGxleG1sX2xvYWRfc3RyaW5nKCRkYXRhKTsKICAgIH0KCiAgICBmdW5j
dGlvbiBkZWxldGUoJHVybCwgJHBhcmFtcyA9IGFycmF5KCkpCiAgICB7CiAgICAgICAgJGRh
dGEgPSBwYXJlbnQ6OmRlbGV0ZSgkdXJsLCRwYXJhbXMpOwogICAgICAgIHJldHVybiBzaW1w
bGV4bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwogICAgfQoKICAgIC8vIENhY2hlIG1ldGhvZHMK
CiAgICBwdWJsaWMgZnVuY3Rpb24gc2V0Q2FjaGluZygkY2FjaGU9dHJ1ZSkKICAgIHsKICAg
ICAgICAkdGhpcy0+X2NhY2hlID0gKCRjYWNoZSkgPyB0cnVlIDogZmFsc2U7CiAgICAgICAg
cmV0dXJuIHRydWU7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGNhY2hlRGlyKCRsb2Mp
CiAgICB7CiAgICAgICAgJHRoaXMtPl9jYWNoZV9kaXIgPSAkbG9jOwogICAgICAgIHJldHVy
biB0cnVlOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjYWNoZVRpbWUoJG1pbnMpCiAg
ICB7CiAgICAgICAgJHRoaXMtPl9jYWNoZV90aW1lID0gJG1pbnMqNjA7IC8vIGNvbnZlcnQg
bWludXRlcyBpbnRvIHNlY29uZHMKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBw
cml2YXRlIGZ1bmN0aW9uIF9yZXRyaWV2ZUNhY2hlKCR1cmwsJG92ZXJpZGVfdGltZW91dD1m
YWxzZSkKICAgIHsKICAgICAgICAkZmlsZSA9ICR0aGlzLT5fY2FjaGVfZGlyLicvJy4kdXJs
OwogICAgICAgIGlmIChmaWxlX2V4aXN0cygkZmlsZSkpIHsKCiAgICAgICAgICAgICRkaWZm
ID0gdGltZSgpIC0gZmlsZW10aW1lKCRmaWxlKTsKICAgICAgICAgICAgaWYgKCRvdmVyaWRl
X3RpbWVvdXQgfHwgJGRpZmYgPCAkdGhpcy0+X2NhY2hlX3RpbWUpIHsKICAgICAgICAgICAg
ICAgIHJldHVybiBmaWxlX2dldF9jb250ZW50cygkZmlsZSk7CiAgICAgICAgICAgIH0gZWxz
ZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAg
ICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0K
fQoKLyoKICogQWJyYWhhbSBXaWxsaWFtcyAoYWJyYWhhbUBhYnJhaC5hbSkgaHR0cDovL2Fi
cmFoLmFtCiAqCiAqIFRoZSBmaXJzdCBQSFAgTGlicmFyeSB0byBzdXBwb3J0IE9BdXRoIGZv
ciBUd2l0dGVyJ3MgUkVTVCBBUEkuCiAqLwoKLyoqCiAqIFR3aXR0ZXIgT0F1dGggY2xhc3MK
ICovCmNsYXNzIFR3aXR0ZXJPQXV0aCB7CiAgLyogQ29udGFpbnMgdGhlIGxhc3QgSFRUUCBz
dGF0dXMgY29kZSByZXR1cm5lZC4gKi8KICBwdWJsaWMgJGh0dHBfY29kZTsKICAvKiBDb250
YWlucyB0aGUgbGFzdCBBUEkgY2FsbC4gKi8KICBwdWJsaWMgJHVybDsKICAvKiBTZXQgdXAg
dGhlIEFQSSByb290IFVSTC4gKi8KICBwdWJsaWMgJGhvc3QgPSAiaHR0cHM6Ly9hcGkudHdp
dHRlci5jb20vMS8iOwogIC8qIFNldCB0aW1lb3V0IGRlZmF1bHQuICovCiAgcHVibGljICR0
aW1lb3V0ID0gMzA7CiAgLyogU2V0IGNvbm5lY3QgdGltZW91dC4gKi8KICBwdWJsaWMgJGNv
bm5lY3R0aW1lb3V0ID0gMzA7CiAgLyogVmVyaWZ5IFNTTCBDZXJ0LiAqLwogIHB1YmxpYyAk
c3NsX3ZlcmlmeXBlZXIgPSBGQUxTRTsKICAvKiBSZXNwb25zIGZvcm1hdC4gKi8KICBwdWJs
aWMgJGZvcm1hdCA9ICdqc29uJzsKICAvKiBEZWNvZGUgcmV0dXJuZWQganNvbiBkYXRhLiAq
LwogIHB1YmxpYyAkZGVjb2RlX2pzb24gPSBUUlVFOwogIC8qIENvbnRhaW5zIHRoZSBsYXN0
IEhUVFAgaGVhZGVycyByZXR1cm5lZC4gKi8KICBwdWJsaWMgJGh0dHBfaW5mbzsKICAvKiBT
ZXQgdGhlIHVzZXJhZ25ldC4gKi8KICBwdWJsaWMgJHVzZXJhZ2VudCA9ICdUd2l0dGVyT0F1
dGggdjAuMi4wLWJldGEyJzsKICAvKiBJbW1lZGlhdGVseSByZXRyeSB0aGUgQVBJIGNhbGwg
aWYgdGhlIHJlc3BvbnNlIHdhcyBub3Qgc3VjY2Vzc2Z1bC4gKi8KICAvL3B1YmxpYyAkcmV0
cnkgPSBUUlVFOwoKCgoKICAvKioKICAgKiBTZXQgQVBJIFVSTFMKICAgKi8KICBmdW5jdGlv
biBhY2Nlc3NUb2tlblVSTCgpICB7IHJldHVybiAnaHR0cHM6Ly9hcGkudHdpdHRlci5jb20v
b2F1dGgvYWNjZXNzX3Rva2VuJzsgfQogIGZ1bmN0aW9uIGF1dGhlbnRpY2F0ZVVSTCgpIHsg
cmV0dXJuICdodHRwczovL3R3aXR0ZXIuY29tL29hdXRoL2F1dGhlbnRpY2F0ZSc7IH0KICBm
dW5jdGlvbiBhdXRob3JpemVVUkwoKSAgICB7IHJldHVybiAnaHR0cHM6Ly90d2l0dGVyLmNv
bS9vYXV0aC9hdXRob3JpemUnOyB9CiAgZnVuY3Rpb24gcmVxdWVzdFRva2VuVVJMKCkgeyBy
ZXR1cm4gJ2h0dHBzOi8vYXBpLnR3aXR0ZXIuY29tL29hdXRoL3JlcXVlc3RfdG9rZW4nOyB9
CgogIC8qKgogICAqIERlYnVnIGhlbHBlcnMKICAgKi8KICBmdW5jdGlvbiBsYXN0U3RhdHVz
Q29kZSgpIHsgcmV0dXJuICR0aGlzLT5odHRwX3N0YXR1czsgfQogIGZ1bmN0aW9uIGxhc3RB
UElDYWxsKCkgeyByZXR1cm4gJHRoaXMtPmxhc3RfYXBpX2NhbGw7IH0KCiAgLyoqCiAgICog
Y29uc3RydWN0IFR3aXR0ZXJPQXV0aCBvYmplY3QKICAgKi8KICBmdW5jdGlvbiBfX2NvbnN0
cnVjdCgkY29uc3VtZXJfa2V5LCAkY29uc3VtZXJfc2VjcmV0LCAkb2F1dGhfdG9rZW4gPSBO
VUxMLCAkb2F1dGhfdG9rZW5fc2VjcmV0ID0gTlVMTCkgewogICAgJHRoaXMtPnNoYTFfbWV0
aG9kID0gbmV3IE9BdXRoU2lnbmF0dXJlTWV0aG9kX0hNQUNfU0hBMSgpOwogICAgJHRoaXMt
PmNvbnN1bWVyID0gbmV3IE9BdXRoQ29uc3VtZXIoJGNvbnN1bWVyX2tleSwgJGNvbnN1bWVy
X3NlY3JldCk7CiAgICBpZiAoIWVtcHR5KCRvYXV0aF90b2tlbikgJiYgIWVtcHR5KCRvYXV0
aF90b2tlbl9zZWNyZXQpKSB7CiAgICAgICR0aGlzLT50b2tlbiA9IG5ldyBPQXV0aENvbnN1
bWVyKCRvYXV0aF90b2tlbiwgJG9hdXRoX3Rva2VuX3NlY3JldCk7CiAgICB9IGVsc2Ugewog
ICAgICAkdGhpcy0+dG9rZW4gPSBOVUxMOwogICAgfQogIH0KCgogIC8qKgogICAqIEdldCBh
IHJlcXVlc3RfdG9rZW4gZnJvbSBUd2l0dGVyCiAgICoKICAgKiBAcmV0dXJucyBhIGtleS92
YWx1ZSBhcnJheSBjb250YWluaW5nIG9hdXRoX3Rva2VuIGFuZCBvYXV0aF90b2tlbl9zZWNy
ZXQKICAgKi8KICBmdW5jdGlvbiBnZXRSZXF1ZXN0VG9rZW4oJG9hdXRoX2NhbGxiYWNrID0g
TlVMTCkgewogICAgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgaWYgKCFlbXB0eSgkb2F1
dGhfY2FsbGJhY2spKSB7CiAgICAgICRwYXJhbWV0ZXJzWydvYXV0aF9jYWxsYmFjayddID0g
JG9hdXRoX2NhbGxiYWNrOwogICAgfQogICAgJHJlcXVlc3QgPSAkdGhpcy0+b0F1dGhSZXF1
ZXN0KCR0aGlzLT5yZXF1ZXN0VG9rZW5VUkwoKSwgJ0dFVCcsICRwYXJhbWV0ZXJzKTsKICAg
ICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygkcmVxdWVzdCk7CiAgICAk
dGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigkdG9rZW5bJ29hdXRoX3Rva2VuJ10s
ICR0b2tlblsnb2F1dGhfdG9rZW5fc2VjcmV0J10pOwogICAgcmV0dXJuICR0b2tlbjsKICB9
CgogIC8qKgogICAqIEdldCB0aGUgYXV0aG9yaXplIFVSTAogICAqCiAgICogQHJldHVybnMg
YSBzdHJpbmcKICAgKi8KICBmdW5jdGlvbiBnZXRBdXRob3JpemVVUkwoJHRva2VuLCAkc2ln
bl9pbl93aXRoX3R3aXR0ZXIgPSBUUlVFKSB7CiAgICBpZiAoaXNfYXJyYXkoJHRva2VuKSkg
ewogICAgICAkdG9rZW4gPSAkdG9rZW5bJ29hdXRoX3Rva2VuJ107CiAgICB9CiAgICBpZiAo
ZW1wdHkoJHNpZ25faW5fd2l0aF90d2l0dGVyKSkgewogICAgICByZXR1cm4gJHRoaXMtPmF1
dGhvcml6ZVVSTCgpIC4gIj9vYXV0aF90b2tlbj17JHRva2VufSI7CiAgICB9IGVsc2Ugewog
ICAgICAgcmV0dXJuICR0aGlzLT5hdXRoZW50aWNhdGVVUkwoKSAuICI/b2F1dGhfdG9rZW49
eyR0b2tlbn0iOwogICAgfQogIH0KCiAgLyoqCiAgICogRXhjaGFuZ2UgcmVxdWVzdCB0b2tl
biBhbmQgc2VjcmV0IGZvciBhbiBhY2Nlc3MgdG9rZW4gYW5kCiAgICogc2VjcmV0LCB0byBz
aWduIEFQSSBjYWxscy4KICAgKgogICAqIEByZXR1cm5zIGFycmF5KCJvYXV0aF90b2tlbiIg
PT4gInRoZS1hY2Nlc3MtdG9rZW4iLAogICAqICAgICAgICAgICAgICAgICJvYXV0aF90b2tl
bl9zZWNyZXQiID0+ICJ0aGUtYWNjZXNzLXNlY3JldCIsCiAgICogICAgICAgICAgICAgICAg
InVzZXJfaWQiID0+ICI5NDM2OTkyIiwKICAgKiAgICAgICAgICAgICAgICAic2NyZWVuX25h
bWUiID0+ICJhYnJhaGFtIikKICAgKi8KICBmdW5jdGlvbiBnZXRBY2Nlc3NUb2tlbigkb2F1
dGhfdmVyaWZpZXIgPSBGQUxTRSkgewogICAgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAg
aWYgKCFlbXB0eSgkb2F1dGhfdmVyaWZpZXIpKSB7CiAgICAgICRwYXJhbWV0ZXJzWydvYXV0
aF92ZXJpZmllciddID0gJG9hdXRoX3ZlcmlmaWVyOwogICAgfQogICAgJHJlcXVlc3QgPSAk
dGhpcy0+b0F1dGhSZXF1ZXN0KCR0aGlzLT5hY2Nlc3NUb2tlblVSTCgpLCAnR0VUJywgJHBh
cmFtZXRlcnMpOwogICAgJHRva2VuID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKCRy
ZXF1ZXN0KTsKICAgICR0aGlzLT50b2tlbiA9IG5ldyBPQXV0aENvbnN1bWVyKCR0b2tlblsn
b2F1dGhfdG9rZW4nXSwgJHRva2VuWydvYXV0aF90b2tlbl9zZWNyZXQnXSk7CiAgICByZXR1
cm4gJHRva2VuOwogIH0KCiAgLyoqCiAgICogT25lIHRpbWUgZXhjaGFuZ2Ugb2YgdXNlcm5h
bWUgYW5kIHBhc3N3b3JkIGZvciBhY2Nlc3MgdG9rZW4gYW5kIHNlY3JldC4KICAgKgogICAq
IEByZXR1cm5zIGFycmF5KCJvYXV0aF90b2tlbiIgPT4gInRoZS1hY2Nlc3MtdG9rZW4iLAog
ICAqICAgICAgICAgICAgICAgICJvYXV0aF90b2tlbl9zZWNyZXQiID0+ICJ0aGUtYWNjZXNz
LXNlY3JldCIsCiAgICogICAgICAgICAgICAgICAgInVzZXJfaWQiID0+ICI5NDM2OTkyIiwK
ICAgKiAgICAgICAgICAgICAgICAic2NyZWVuX25hbWUiID0+ICJhYnJhaGFtIiwKICAgKiAg
ICAgICAgICAgICAgICAieF9hdXRoX2V4cGlyZXMiID0+ICIwIikKICAgKi8KICBmdW5jdGlv
biBnZXRYQXV0aFRva2VuKCR1c2VybmFtZSwgJHBhc3N3b3JkKSB7CiAgICAkcGFyYW1ldGVy
cyA9IGFycmF5KCk7CiAgICAkcGFyYW1ldGVyc1sneF9hdXRoX3VzZXJuYW1lJ10gPSAkdXNl
cm5hbWU7CiAgICAkcGFyYW1ldGVyc1sneF9hdXRoX3Bhc3N3b3JkJ10gPSAkcGFzc3dvcmQ7
CiAgICAkcGFyYW1ldGVyc1sneF9hdXRoX21vZGUnXSA9ICdjbGllbnRfYXV0aCc7CiAgICAk
cmVxdWVzdCA9ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHRoaXMtPmFjY2Vzc1Rva2VuVVJMKCks
ICdQT1NUJywgJHBhcmFtZXRlcnMpOwogICAgJHRva2VuID0gT0F1dGhVdGlsOjpwYXJzZV9w
YXJhbWV0ZXJzKCRyZXF1ZXN0KTsKICAgICR0aGlzLT50b2tlbiA9IG5ldyBPQXV0aENvbnN1
bWVyKCR0b2tlblsnb2F1dGhfdG9rZW4nXSwgJHRva2VuWydvYXV0aF90b2tlbl9zZWNyZXQn
XSk7CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAgLyoqCiAgICogR0VUIHdyYXBwZXIgZm9y
IG9BdXRoUmVxdWVzdC4KICAgKi8KICBmdW5jdGlvbiBnZXQoJHVybCwgJHBhcmFtZXRlcnMg
PSBhcnJheSgpKSB7CiAgICAkcmVzcG9uc2UgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR1cmws
ICdHRVQnLCAkcGFyYW1ldGVycyk7CiAgICBpZiAoJHRoaXMtPmZvcm1hdCA9PT0gJ2pzb24n
ICYmICR0aGlzLT5kZWNvZGVfanNvbikgewogICAgICByZXR1cm4ganNvbl9kZWNvZGUoJHJl
c3BvbnNlKTsKICAgIH0KICAgIHJldHVybiAkcmVzcG9uc2U7CiAgfQoKICAvKioKICAgKiBQ
T1NUIHdyYXBwZXIgZm9yIG9BdXRoUmVxdWVzdC4KICAgKi8KICBmdW5jdGlvbiBwb3N0KCR1
cmwsICRwYXJhbWV0ZXJzID0gYXJyYXkoKSkgewogICAgJHJlc3BvbnNlID0gJHRoaXMtPm9B
dXRoUmVxdWVzdCgkdXJsLCAnUE9TVCcsICRwYXJhbWV0ZXJzKTsKICAgIGlmICgkdGhpcy0+
Zm9ybWF0ID09PSAnanNvbicgJiYgJHRoaXMtPmRlY29kZV9qc29uKSB7CiAgICAgIHJldHVy
biBqc29uX2RlY29kZSgkcmVzcG9uc2UpOwogICAgfQogICAgcmV0dXJuICRyZXNwb25zZTsK
ICB9CgogIC8qKgogICAqIERFTEVURSB3cmFwcGVyIGZvciBvQXV0aFJlcWV1c3QuCiAgICov
CiAgZnVuY3Rpb24gZGVsZXRlKCR1cmwsICRwYXJhbWV0ZXJzID0gYXJyYXkoKSkgewogICAg
JHJlc3BvbnNlID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdXJsLCAnREVMRVRFJywgJHBhcmFt
ZXRlcnMpOwogICAgaWYgKCR0aGlzLT5mb3JtYXQgPT09ICdqc29uJyAmJiAkdGhpcy0+ZGVj
b2RlX2pzb24pIHsKICAgICAgcmV0dXJuIGpzb25fZGVjb2RlKCRyZXNwb25zZSk7CiAgICB9
CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoqCiAgICogRm9ybWF0IGFuZCBzaWdu
IGFuIE9BdXRoIC8gQVBJIHJlcXVlc3QKICAgKi8KICBmdW5jdGlvbiBvQXV0aFJlcXVlc3Qo
JHVybCwgJG1ldGhvZCwgJHBhcmFtZXRlcnMpIHsKICAgIGlmIChzdHJycG9zKCR1cmwsICdo
dHRwczovLycpICE9PSAwICYmIHN0cnJwb3MoJHVybCwgJ2h0dHA6Ly8nKSAhPT0gMCkgewog
ICAgICAkdXJsID0gInskdGhpcy0+aG9zdH17JHVybH0ueyR0aGlzLT5mb3JtYXR9IjsKICAg
IH0KICAgICRyZXF1ZXN0ID0gT0F1dGhSZXF1ZXN0Ojpmcm9tX2NvbnN1bWVyX2FuZF90b2tl
bigkdGhpcy0+Y29uc3VtZXIsICR0aGlzLT50b2tlbiwgJG1ldGhvZCwgJHVybCwgJHBhcmFt
ZXRlcnMpOwogICAgJHJlcXVlc3QtPnNpZ25fcmVxdWVzdCgkdGhpcy0+c2hhMV9tZXRob2Qs
ICR0aGlzLT5jb25zdW1lciwgJHRoaXMtPnRva2VuKTsKICAgIHN3aXRjaCAoJG1ldGhvZCkg
ewogICAgY2FzZSAnR0VUJzoKICAgICAgcmV0dXJuICR0aGlzLT5odHRwKCRyZXF1ZXN0LT50
b191cmwoKSwgJ0dFVCcpOwogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuICR0aGlzLT5odHRw
KCRyZXF1ZXN0LT5nZXRfbm9ybWFsaXplZF9odHRwX3VybCgpLCAkbWV0aG9kLCAkcmVxdWVz
dC0+dG9fcG9zdGRhdGEoKSk7CiAgICB9CiAgfQoKICAvKioKICAgKiBNYWtlIGFuIEhUVFAg
cmVxdWVzdAogICAqCiAgICogQHJldHVybiBBUEkgcmVzdWx0cwogICAqLwogIGZ1bmN0aW9u
IGh0dHAoJHVybCwgJG1ldGhvZCwgJHBvc3RmaWVsZHMgPSBOVUxMKSB7CiAgICAkdGhpcy0+
aHR0cF9pbmZvID0gYXJyYXkoKTsKICAgICRjaSA9IGN1cmxfaW5pdCgpOwogICAgLyogQ3Vy
bCBzZXR0aW5ncyAqLwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1VTRVJBR0VOVCwg
JHRoaXMtPnVzZXJhZ2VudCk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfQ09OTkVD
VFRJTUVPVVQsICR0aGlzLT5jb25uZWN0dGltZW91dCk7CiAgICBjdXJsX3NldG9wdCgkY2ks
IENVUkxPUFRfVElNRU9VVCwgJHRoaXMtPnRpbWVvdXQpOwogICAgY3VybF9zZXRvcHQoJGNp
LCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCBUUlVFKTsKICAgIGN1cmxfc2V0b3B0KCRjaSwg
Q1VSTE9QVF9IVFRQSEVBREVSLCBhcnJheSgnRXhwZWN0OicpKTsKICAgIGN1cmxfc2V0b3B0
KCRjaSwgQ1VSTE9QVF9TU0xfVkVSSUZZUEVFUiwgJHRoaXMtPnNzbF92ZXJpZnlwZWVyKTsK
ICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9IRUFERVJGVU5DVElPTiwgYXJyYXkoJHRo
aXMsICdnZXRIZWFkZXInKSk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfSEVBREVS
LCBGQUxTRSk7CgogICAgc3dpdGNoICgkbWV0aG9kKSB7CiAgICAgIGNhc2UgJ1BPU1QnOgog
ICAgICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9QT1NULCBUUlVFKTsKICAgICAgICBp
ZiAoIWVtcHR5KCRwb3N0ZmllbGRzKSkgewogICAgICAgICAgY3VybF9zZXRvcHQoJGNpLCBD
VVJMT1BUX1BPU1RGSUVMRFMsICRwb3N0ZmllbGRzKTsKICAgICAgICB9CiAgICAgICAgYnJl
YWs7CiAgICAgIGNhc2UgJ0RFTEVURSc6CiAgICAgICAgY3VybF9zZXRvcHQoJGNpLCBDVVJM
T1BUX0NVU1RPTVJFUVVFU1QsICdERUxFVEUnKTsKICAgICAgICBpZiAoIWVtcHR5KCRwb3N0
ZmllbGRzKSkgewogICAgICAgICAgJHVybCA9ICJ7JHVybH0/eyRwb3N0ZmllbGRzfSI7CiAg
ICAgICAgfQogICAgfQoKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9VUkwsICR1cmwp
OwogICAgJHJlc3BvbnNlID0gY3VybF9leGVjKCRjaSk7CiAgICAkdGhpcy0+aHR0cF9jb2Rl
ID0gY3VybF9nZXRpbmZvKCRjaSwgQ1VSTElORk9fSFRUUF9DT0RFKTsKICAgICR0aGlzLT5o
dHRwX2luZm8gPSBhcnJheV9tZXJnZSgkdGhpcy0+aHR0cF9pbmZvLCBjdXJsX2dldGluZm8o
JGNpKSk7CiAgICAkdGhpcy0+dXJsID0gJHVybDsKICAgIGN1cmxfY2xvc2UgKCRjaSk7CiAg
ICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoqCiAgICogR2V0IHRoZSBoZWFkZXIgaW5m
byB0byBzdG9yZS4KICAgKi8KICBmdW5jdGlvbiBnZXRIZWFkZXIoJGNoLCAkaGVhZGVyKSB7
CiAgICAkaSA9IHN0cnBvcygkaGVhZGVyLCAnOicpOwogICAgaWYgKCFlbXB0eSgkaSkpIHsK
ICAgICAgJGtleSA9IHN0cl9yZXBsYWNlKCctJywgJ18nLCBzdHJ0b2xvd2VyKHN1YnN0cigk
aGVhZGVyLCAwLCAkaSkpKTsKICAgICAgJHZhbHVlID0gdHJpbShzdWJzdHIoJGhlYWRlciwg
JGkgKyAyKSk7CiAgICAgICR0aGlzLT5odHRwX2hlYWRlclska2V5XSA9ICR2YWx1ZTsKICAg
IH0KICAgIHJldHVybiBzdHJsZW4oJGhlYWRlcik7CiAgfQp9CgpjbGFzcyBPQXV0aEV4Y2Vw
dGlvbiBleHRlbmRzIEV4Y2VwdGlvbiB7CiAgLy8gcGFzcwp9CgpjbGFzcyBPQXV0aENvbnN1
bWVyIHsKICBwdWJsaWMgJGtleTsKICBwdWJsaWMgJHNlY3JldDsKCiAgZnVuY3Rpb24gX19j
b25zdHJ1Y3QoJGtleSwgJHNlY3JldCwgJGNhbGxiYWNrX3VybD1OVUxMKSB7CiAgICAkdGhp
cy0+a2V5ID0gJGtleTsKICAgICR0aGlzLT5zZWNyZXQgPSAkc2VjcmV0OwogICAgJHRoaXMt
PmNhbGxiYWNrX3VybCA9ICRjYWxsYmFja191cmw7CiAgfQoKICBmdW5jdGlvbiBfX3RvU3Ry
aW5nKCkgewogICAgcmV0dXJuICJPQXV0aENvbnN1bWVyW2tleT0kdGhpcy0+a2V5LHNlY3Jl
dD0kdGhpcy0+c2VjcmV0XSI7CiAgfQp9CgpjbGFzcyBPQXV0aFRva2VuIHsKICAvLyBhY2Nl
c3MgdG9rZW5zIGFuZCByZXF1ZXN0IHRva2VucwogIHB1YmxpYyAka2V5OwogIHB1YmxpYyAk
c2VjcmV0OwoKICAvKioKICAgKiBrZXkgPSB0aGUgdG9rZW4KICAgKiBzZWNyZXQgPSB0aGUg
dG9rZW4gc2VjcmV0CiAgICovCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGtleSwgJHNlY3Jl
dCkgewogICAgJHRoaXMtPmtleSA9ICRrZXk7CiAgICAkdGhpcy0+c2VjcmV0ID0gJHNlY3Jl
dDsKICB9CgogIC8qKgogICAqIGdlbmVyYXRlcyB0aGUgYmFzaWMgc3RyaW5nIHNlcmlhbGl6
YXRpb24gb2YgYSB0b2tlbiB0aGF0IGEgc2VydmVyCiAgICogd291bGQgcmVzcG9uZCB0byBy
ZXF1ZXN0X3Rva2VuIGFuZCBhY2Nlc3NfdG9rZW4gY2FsbHMgd2l0aAogICAqLwogIGZ1bmN0
aW9uIHRvX3N0cmluZygpIHsKICAgIHJldHVybiAib2F1dGhfdG9rZW49IiAuCiAgICAgICAg
ICAgT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkdGhpcy0+a2V5KSAuCiAgICAgICAg
ICAgIiZvYXV0aF90b2tlbl9zZWNyZXQ9IiAuCiAgICAgICAgICAgT0F1dGhVdGlsOjp1cmxl
bmNvZGVfcmZjMzk4NigkdGhpcy0+c2VjcmV0KTsKICB9CgogIGZ1bmN0aW9uIF9fdG9TdHJp
bmcoKSB7CiAgICByZXR1cm4gJHRoaXMtPnRvX3N0cmluZygpOwogIH0KfQoKLyoqCiAqIEEg
Y2xhc3MgZm9yIGltcGxlbWVudGluZyBhIFNpZ25hdHVyZSBNZXRob2QKICogU2VlIHNlY3Rp
b24gOSAoIlNpZ25pbmcgUmVxdWVzdHMiKSBpbiB0aGUgc3BlYwogKi8KYWJzdHJhY3QgY2xh
c3MgT0F1dGhTaWduYXR1cmVNZXRob2QgewogIC8qKgogICAqIE5lZWRzIHRvIHJldHVybiB0
aGUgbmFtZSBvZiB0aGUgU2lnbmF0dXJlIE1ldGhvZCAoaWUgSE1BQy1TSEExKQogICAqIEBy
ZXR1cm4gc3RyaW5nCiAgICovCiAgYWJzdHJhY3QgcHVibGljIGZ1bmN0aW9uIGdldF9uYW1l
KCk7CgogIC8qKgogICAqIEJ1aWxkIHVwIHRoZSBzaWduYXR1cmUKICAgKiBOT1RFOiBUaGUg
b3V0cHV0IG9mIHRoaXMgZnVuY3Rpb24gTVVTVCBOT1QgYmUgdXJsZW5jb2RlZC4KICAgKiB0
aGUgZW5jb2RpbmcgaXMgaGFuZGxlZCBpbiBPQXV0aFJlcXVlc3Qgd2hlbiB0aGUgZmluYWwK
ICAgKiByZXF1ZXN0IGlzIHNlcmlhbGl6ZWQKICAgKiBAcGFyYW0gT0F1dGhSZXF1ZXN0ICRy
ZXF1ZXN0CiAgICogQHBhcmFtIE9BdXRoQ29uc3VtZXIgJGNvbnN1bWVyCiAgICogQHBhcmFt
IE9BdXRoVG9rZW4gJHRva2VuCiAgICogQHJldHVybiBzdHJpbmcKICAgKi8KICBhYnN0cmFj
dCBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIs
ICR0b2tlbik7CgogIC8qKgogICAqIFZlcmlmaWVzIHRoYXQgYSBnaXZlbiBzaWduYXR1cmUg
aXMgY29ycmVjdAogICAqIEBwYXJhbSBPQXV0aFJlcXVlc3QgJHJlcXVlc3QKICAgKiBAcGFy
YW0gT0F1dGhDb25zdW1lciAkY29uc3VtZXIKICAgKiBAcGFyYW0gT0F1dGhUb2tlbiAkdG9r
ZW4KICAgKiBAcGFyYW0gc3RyaW5nICRzaWduYXR1cmUKICAgKiBAcmV0dXJuIGJvb2wKICAg
Ki8KICBwdWJsaWMgZnVuY3Rpb24gY2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3Vt
ZXIsICR0b2tlbiwgJHNpZ25hdHVyZSkgewogICAgJGJ1aWx0ID0gJHRoaXMtPmJ1aWxkX3Np
Z25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAgcmV0dXJuICRidWls
dCA9PSAkc2lnbmF0dXJlOwogIH0KfQoKLyoqCiAqIFRoZSBITUFDLVNIQTEgc2lnbmF0dXJl
IG1ldGhvZCB1c2VzIHRoZSBITUFDLVNIQTEgc2lnbmF0dXJlIGFsZ29yaXRobSBhcyBkZWZp
bmVkIGluIFtSRkMyMTA0XQogKiB3aGVyZSB0aGUgU2lnbmF0dXJlIEJhc2UgU3RyaW5nIGlz
IHRoZSB0ZXh0IGFuZCB0aGUga2V5IGlzIHRoZSBjb25jYXRlbmF0ZWQgdmFsdWVzIChlYWNo
IGZpcnN0CiAqIGVuY29kZWQgcGVyIFBhcmFtZXRlciBFbmNvZGluZykgb2YgdGhlIENvbnN1
bWVyIFNlY3JldCBhbmQgVG9rZW4gU2VjcmV0LCBzZXBhcmF0ZWQgYnkgYW4gJyYnCiAqIGNo
YXJhY3RlciAoQVNDSUkgY29kZSAzOCkgZXZlbiBpZiBlbXB0eS4KICogICAtIENoYXB0ZXIg
OS4yICgiSE1BQy1TSEExIikKICovCmNsYXNzIE9BdXRoU2lnbmF0dXJlTWV0aG9kX0hNQUNf
U0hBMSBleHRlbmRzIE9BdXRoU2lnbmF0dXJlTWV0aG9kIHsKICBmdW5jdGlvbiBnZXRfbmFt
ZSgpIHsKICAgIHJldHVybiAiSE1BQy1TSEExIjsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBi
dWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAkYmFz
ZV9zdHJpbmcgPSAkcmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpOwogICAg
JHJlcXVlc3QtPmJhc2Vfc3RyaW5nID0gJGJhc2Vfc3RyaW5nOwoKICAgICRrZXlfcGFydHMg
PSBhcnJheSgKICAgICAgJGNvbnN1bWVyLT5zZWNyZXQsCiAgICAgICgkdG9rZW4pID8gJHRv
a2VuLT5zZWNyZXQgOiAiIgogICAgKTsKCiAgICAka2V5X3BhcnRzID0gT0F1dGhVdGlsOjp1
cmxlbmNvZGVfcmZjMzk4Nigka2V5X3BhcnRzKTsKICAgICRrZXkgPSBpbXBsb2RlKCcmJywg
JGtleV9wYXJ0cyk7CgogICAgcmV0dXJuIGJhc2U2NF9lbmNvZGUoaGFzaF9obWFjKCdzaGEx
JywgJGJhc2Vfc3RyaW5nLCAka2V5LCB0cnVlKSk7CiAgfQp9CgovKioKICogVGhlIFBMQUlO
VEVYVCBtZXRob2QgZG9lcyBub3QgcHJvdmlkZSBhbnkgc2VjdXJpdHkgcHJvdGVjdGlvbiBh
bmQgU0hPVUxEIG9ubHkgYmUgdXNlZAogKiBvdmVyIGEgc2VjdXJlIGNoYW5uZWwgc3VjaCBh
cyBIVFRQUy4gSXQgZG9lcyBub3QgdXNlIHRoZSBTaWduYXR1cmUgQmFzZSBTdHJpbmcuCiAq
ICAgLSBDaGFwdGVyIDkuNCAoIlBMQUlOVEVYVCIpCiAqLwpjbGFzcyBPQXV0aFNpZ25hdHVy
ZU1ldGhvZF9QTEFJTlRFWFQgZXh0ZW5kcyBPQXV0aFNpZ25hdHVyZU1ldGhvZCB7CiAgcHVi
bGljIGZ1bmN0aW9uIGdldF9uYW1lKCkgewogICAgcmV0dXJuICJQTEFJTlRFWFQiOwogIH0K
CiAgLyoqCiAgICogb2F1dGhfc2lnbmF0dXJlIGlzIHNldCB0byB0aGUgY29uY2F0ZW5hdGVk
IGVuY29kZWQgdmFsdWVzIG9mIHRoZSBDb25zdW1lciBTZWNyZXQgYW5kCiAgICogVG9rZW4g
U2VjcmV0LCBzZXBhcmF0ZWQgYnkgYSAnJicgY2hhcmFjdGVyIChBU0NJSSBjb2RlIDM4KSwg
ZXZlbiBpZiBlaXRoZXIgc2VjcmV0IGlzCiAgICogZW1wdHkuIFRoZSByZXN1bHQgTVVTVCBi
ZSBlbmNvZGVkIGFnYWluLgogICAqICAgLSBDaGFwdGVyIDkuNC4xICgiR2VuZXJhdGluZyBT
aWduYXR1cmVzIikKICAgKgogICAqIFBsZWFzZSBub3RlIHRoYXQgdGhlIHNlY29uZCBlbmNv
ZGluZyBNVVNUIE5PVCBoYXBwZW4gaW4gdGhlIFNpZ25hdHVyZU1ldGhvZCwgYXMKICAgKiBP
QXV0aFJlcXVlc3QgaGFuZGxlcyB0aGlzIQogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBidWls
ZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAka2V5X3Bh
cnRzID0gYXJyYXkoCiAgICAgICRjb25zdW1lci0+c2VjcmV0LAogICAgICAoJHRva2VuKSA/
ICR0b2tlbi0+c2VjcmV0IDogIiIKICAgICk7CgogICAgJGtleV9wYXJ0cyA9IE9BdXRoVXRp
bDo6dXJsZW5jb2RlX3JmYzM5ODYoJGtleV9wYXJ0cyk7CiAgICAka2V5ID0gaW1wbG9kZSgn
JicsICRrZXlfcGFydHMpOwogICAgJHJlcXVlc3QtPmJhc2Vfc3RyaW5nID0gJGtleTsKCiAg
ICByZXR1cm4gJGtleTsKICB9Cn0KCi8qKgogKiBUaGUgUlNBLVNIQTEgc2lnbmF0dXJlIG1l
dGhvZCB1c2VzIHRoZSBSU0FTU0EtUEtDUzEtdjFfNSBzaWduYXR1cmUgYWxnb3JpdGhtIGFz
IGRlZmluZWQgaW4KICogW1JGQzM0NDddIHNlY3Rpb24gOC4yIChtb3JlIHNpbXBseSBrbm93
biBhcyBQS0NTIzEpLCB1c2luZyBTSEEtMSBhcyB0aGUgaGFzaCBmdW5jdGlvbiBmb3IKICog
RU1TQS1QS0NTMS12MV81LiBJdCBpcyBhc3N1bWVkIHRoYXQgdGhlIENvbnN1bWVyIGhhcyBw
cm92aWRlZCBpdHMgUlNBIHB1YmxpYyBrZXkgaW4gYQogKiB2ZXJpZmllZCB3YXkgdG8gdGhl
IFNlcnZpY2UgUHJvdmlkZXIsIGluIGEgbWFubmVyIHdoaWNoIGlzIGJleW9uZCB0aGUgc2Nv
cGUgb2YgdGhpcwogKiBzcGVjaWZpY2F0aW9uLgogKiAgIC0gQ2hhcHRlciA5LjMgKCJSU0Et
U0hBMSIpCiAqLwphYnN0cmFjdCBjbGFzcyBPQXV0aFNpZ25hdHVyZU1ldGhvZF9SU0FfU0hB
MSBleHRlbmRzIE9BdXRoU2lnbmF0dXJlTWV0aG9kIHsKICBwdWJsaWMgZnVuY3Rpb24gZ2V0
X25hbWUoKSB7CiAgICByZXR1cm4gIlJTQS1TSEExIjsKICB9CgogIC8vIFVwIHRvIHRoZSBT
UCB0byBpbXBsZW1lbnQgdGhpcyBsb29rdXAgb2Yga2V5cy4gUG9zc2libGUgaWRlYXMgYXJl
OgogIC8vICgxKSBkbyBhIGxvb2t1cCBpbiBhIHRhYmxlIG9mIHRydXN0ZWQgY2VydHMga2V5
ZWQgb2ZmIG9mIGNvbnN1bWVyCiAgLy8gKDIpIGZldGNoIHZpYSBodHRwIHVzaW5nIGEgdXJs
IHByb3ZpZGVkIGJ5IHRoZSByZXF1ZXN0ZXIKICAvLyAoMykgc29tZSBzb3J0IG9mIHNwZWNp
ZmljIGRpc2NvdmVyeSBjb2RlIGJhc2VkIG9uIHJlcXVlc3QKICAvLwogIC8vIEVpdGhlciB3
YXkgc2hvdWxkIHJldHVybiBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgY2VydGlm
aWNhdGUKICBwcm90ZWN0ZWQgYWJzdHJhY3QgZnVuY3Rpb24gZmV0Y2hfcHVibGljX2NlcnQo
JiRyZXF1ZXN0KTsKCiAgLy8gVXAgdG8gdGhlIFNQIHRvIGltcGxlbWVudCB0aGlzIGxvb2t1
cCBvZiBrZXlzLiBQb3NzaWJsZSBpZGVhcyBhcmU6CiAgLy8gKDEpIGRvIGEgbG9va3VwIGlu
IGEgdGFibGUgb2YgdHJ1c3RlZCBjZXJ0cyBrZXllZCBvZmYgb2YgY29uc3VtZXIKICAvLwog
IC8vIEVpdGhlciB3YXkgc2hvdWxkIHJldHVybiBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBv
ZiB0aGUgY2VydGlmaWNhdGUKICBwcm90ZWN0ZWQgYWJzdHJhY3QgZnVuY3Rpb24gZmV0Y2hf
cHJpdmF0ZV9jZXJ0KCYkcmVxdWVzdCk7CgogIHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWdu
YXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAkYmFzZV9zdHJpbmcg
PSAkcmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpOwogICAgJHJlcXVlc3Qt
PmJhc2Vfc3RyaW5nID0gJGJhc2Vfc3RyaW5nOwoKICAgIC8vIEZldGNoIHRoZSBwcml2YXRl
IGtleSBjZXJ0IGJhc2VkIG9uIHRoZSByZXF1ZXN0CiAgICAkY2VydCA9ICR0aGlzLT5mZXRj
aF9wcml2YXRlX2NlcnQoJHJlcXVlc3QpOwoKICAgIC8vIFB1bGwgdGhlIHByaXZhdGUga2V5
IElEIGZyb20gdGhlIGNlcnRpZmljYXRlCiAgICAkcHJpdmF0ZWtleWlkID0gb3BlbnNzbF9n
ZXRfcHJpdmF0ZWtleSgkY2VydCk7CgogICAgLy8gU2lnbiB1c2luZyB0aGUga2V5CiAgICAk
b2sgPSBvcGVuc3NsX3NpZ24oJGJhc2Vfc3RyaW5nLCAkc2lnbmF0dXJlLCAkcHJpdmF0ZWtl
eWlkKTsKCiAgICAvLyBSZWxlYXNlIHRoZSBrZXkgcmVzb3VyY2UKICAgIG9wZW5zc2xfZnJl
ZV9rZXkoJHByaXZhdGVrZXlpZCk7CgogICAgcmV0dXJuIGJhc2U2NF9lbmNvZGUoJHNpZ25h
dHVyZSk7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gY2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0
LCAkY29uc3VtZXIsICR0b2tlbiwgJHNpZ25hdHVyZSkgewogICAgJGRlY29kZWRfc2lnID0g
YmFzZTY0X2RlY29kZSgkc2lnbmF0dXJlKTsKCiAgICAkYmFzZV9zdHJpbmcgPSAkcmVxdWVz
dC0+Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpOwoKICAgIC8vIEZldGNoIHRoZSBwdWJs
aWMga2V5IGNlcnQgYmFzZWQgb24gdGhlIHJlcXVlc3QKICAgICRjZXJ0ID0gJHRoaXMtPmZl
dGNoX3B1YmxpY19jZXJ0KCRyZXF1ZXN0KTsKCiAgICAvLyBQdWxsIHRoZSBwdWJsaWMga2V5
IElEIGZyb20gdGhlIGNlcnRpZmljYXRlCiAgICAkcHVibGlja2V5aWQgPSBvcGVuc3NsX2dl
dF9wdWJsaWNrZXkoJGNlcnQpOwoKICAgIC8vIENoZWNrIHRoZSBjb21wdXRlZCBzaWduYXR1
cmUgYWdhaW5zdCB0aGUgb25lIHBhc3NlZCBpbiB0aGUgcXVlcnkKICAgICRvayA9IG9wZW5z
c2xfdmVyaWZ5KCRiYXNlX3N0cmluZywgJGRlY29kZWRfc2lnLCAkcHVibGlja2V5aWQpOwoK
ICAgIC8vIFJlbGVhc2UgdGhlIGtleSByZXNvdXJjZQogICAgb3BlbnNzbF9mcmVlX2tleSgk
cHVibGlja2V5aWQpOwoKICAgIHJldHVybiAkb2sgPT0gMTsKICB9Cn0KCmNsYXNzIE9BdXRo
UmVxdWVzdCB7CiAgcHJpdmF0ZSAkcGFyYW1ldGVyczsKICBwcml2YXRlICRodHRwX21ldGhv
ZDsKICBwcml2YXRlICRodHRwX3VybDsKICAvLyBmb3IgZGVidWcgcHVycG9zZXMKICBwdWJs
aWMgJGJhc2Vfc3RyaW5nOwogIHB1YmxpYyBzdGF0aWMgJHZlcnNpb24gPSAnMS4wJzsKICBw
dWJsaWMgc3RhdGljICRQT1NUX0lOUFVUID0gJ3BocDovL2lucHV0JzsKCiAgZnVuY3Rpb24g
X19jb25zdHJ1Y3QoJGh0dHBfbWV0aG9kLCAkaHR0cF91cmwsICRwYXJhbWV0ZXJzPU5VTEwp
IHsKICAgIEAkcGFyYW1ldGVycyBvciAkcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICAkcGFy
YW1ldGVycyA9IGFycmF5X21lcmdlKCBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMocGFy
c2VfdXJsKCRodHRwX3VybCwgUEhQX1VSTF9RVUVSWSkpLCAkcGFyYW1ldGVycyk7CiAgICAk
dGhpcy0+cGFyYW1ldGVycyA9ICRwYXJhbWV0ZXJzOwogICAgJHRoaXMtPmh0dHBfbWV0aG9k
ID0gJGh0dHBfbWV0aG9kOwogICAgJHRoaXMtPmh0dHBfdXJsID0gJGh0dHBfdXJsOwogIH0K
CgogIC8qKgogICAqIGF0dGVtcHQgdG8gYnVpbGQgdXAgYSByZXF1ZXN0IGZyb20gd2hhdCB3
YXMgcGFzc2VkIHRvIHRoZSBzZXJ2ZXIKICAgKi8KICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9u
IGZyb21fcmVxdWVzdCgkaHR0cF9tZXRob2Q9TlVMTCwgJGh0dHBfdXJsPU5VTEwsICRwYXJh
bWV0ZXJzPU5VTEwpIHsKICAgICRzY2hlbWUgPSAoIWlzc2V0KCRfU0VSVkVSWydIVFRQUydd
KSB8fCAkX1NFUlZFUlsnSFRUUFMnXSAhPSAib24iKQogICAgICAgICAgICAgID8gJ2h0dHAn
CiAgICAgICAgICAgICAgOiAnaHR0cHMnOwogICAgQCRodHRwX3VybCBvciAkaHR0cF91cmwg
PSAkc2NoZW1lIC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzovLycgLiAkX1NF
UlZFUlsnSFRUUF9IT1NUJ10gLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnOicg
LgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkX1NFUlZFUlsnU0VSVkVSX1BPUlQn
XSAuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRfU0VSVkVSWydSRVFVRVNUX1VS
SSddOwogICAgQCRodHRwX21ldGhvZCBvciAkaHR0cF9tZXRob2QgPSAkX1NFUlZFUlsnUkVR
VUVTVF9NRVRIT0QnXTsKCiAgICAvLyBXZSB3ZXJlbid0IGhhbmRlZCBhbnkgcGFyYW1ldGVy
cywgc28gbGV0J3MgZmluZCB0aGUgb25lcyByZWxldmFudCB0bwogICAgLy8gdGhpcyByZXF1
ZXN0LgogICAgLy8gSWYgeW91IHJ1biBYTUwtUlBDIG9yIHNpbWlsYXIgeW91IHNob3VsZCB1
c2UgdGhpcyB0byBwcm92aWRlIHlvdXIgb3duCiAgICAvLyBwYXJzZWQgcGFyYW1ldGVyLWxp
c3QKICAgIGlmICghJHBhcmFtZXRlcnMpIHsKICAgICAgLy8gRmluZCByZXF1ZXN0IGhlYWRl
cnMKICAgICAgJHJlcXVlc3RfaGVhZGVycyA9IE9BdXRoVXRpbDo6Z2V0X2hlYWRlcnMoKTsK
CiAgICAgIC8vIFBhcnNlIHRoZSBxdWVyeS1zdHJpbmcgdG8gZmluZCBHRVQgcGFyYW1ldGVy
cwogICAgICAkcGFyYW1ldGVycyA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygkX1NF
UlZFUlsnUVVFUllfU1RSSU5HJ10pOwoKICAgICAgLy8gSXQncyBhIFBPU1QgcmVxdWVzdCBv
ZiB0aGUgcHJvcGVyIGNvbnRlbnQtdHlwZSwgc28gcGFyc2UgUE9TVAogICAgICAvLyBwYXJh
bWV0ZXJzIGFuZCBhZGQgdGhvc2Ugb3ZlcnJpZGluZyBhbnkgZHVwbGljYXRlcyBmcm9tIEdF
VAogICAgICBpZiAoJGh0dHBfbWV0aG9kID09ICJQT1NUIgogICAgICAgICAgJiYgQHN0cnN0
cigkcmVxdWVzdF9oZWFkZXJzWyJDb250ZW50LVR5cGUiXSwKICAgICAgICAgICAgICAgICAg
ICAgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpCiAgICAgICAgICApIHsK
ICAgICAgICAkcG9zdF9kYXRhID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKAogICAg
ICAgICAgZmlsZV9nZXRfY29udGVudHMoc2VsZjo6JFBPU1RfSU5QVVQpCiAgICAgICAgKTsK
ICAgICAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCRwYXJhbWV0ZXJzLCAkcG9zdF9k
YXRhKTsKICAgICAgfQoKICAgICAgLy8gV2UgaGF2ZSBhIEF1dGhvcml6YXRpb24taGVhZGVy
IHdpdGggT0F1dGggZGF0YS4gUGFyc2UgdGhlIGhlYWRlcgogICAgICAvLyBhbmQgYWRkIHRo
b3NlIG92ZXJyaWRpbmcgYW55IGR1cGxpY2F0ZXMgZnJvbSBHRVQgb3IgUE9TVAogICAgICBp
ZiAoQHN1YnN0cigkcmVxdWVzdF9oZWFkZXJzWydBdXRob3JpemF0aW9uJ10sIDAsIDYpID09
ICJPQXV0aCAiKSB7CiAgICAgICAgJGhlYWRlcl9wYXJhbWV0ZXJzID0gT0F1dGhVdGlsOjpz
cGxpdF9oZWFkZXIoCiAgICAgICAgICAkcmVxdWVzdF9oZWFkZXJzWydBdXRob3JpemF0aW9u
J10KICAgICAgICApOwogICAgICAgICRwYXJhbWV0ZXJzID0gYXJyYXlfbWVyZ2UoJHBhcmFt
ZXRlcnMsICRoZWFkZXJfcGFyYW1ldGVycyk7CiAgICAgIH0KCiAgICB9CgogICAgcmV0dXJu
IG5ldyBPQXV0aFJlcXVlc3QoJGh0dHBfbWV0aG9kLCAkaHR0cF91cmwsICRwYXJhbWV0ZXJz
KTsKICB9CgogIC8qKgogICAqIHByZXR0eSBtdWNoIGEgaGVscGVyIGZ1bmN0aW9uIHRvIHNl
dCB1cCB0aGUgcmVxdWVzdAogICAqLwogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZnJvbV9j
b25zdW1lcl9hbmRfdG9rZW4oJGNvbnN1bWVyLCAkdG9rZW4sICRodHRwX21ldGhvZCwgJGh0
dHBfdXJsLCAkcGFyYW1ldGVycz1OVUxMKSB7CiAgICBAJHBhcmFtZXRlcnMgb3IgJHBhcmFt
ZXRlcnMgPSBhcnJheSgpOwogICAgJGRlZmF1bHRzID0gYXJyYXkoIm9hdXRoX3ZlcnNpb24i
ID0+IE9BdXRoUmVxdWVzdDo6JHZlcnNpb24sCiAgICAgICAgICAgICAgICAgICAgICAib2F1
dGhfbm9uY2UiID0+IE9BdXRoUmVxdWVzdDo6Z2VuZXJhdGVfbm9uY2UoKSwKICAgICAgICAg
ICAgICAgICAgICAgICJvYXV0aF90aW1lc3RhbXAiID0+IE9BdXRoUmVxdWVzdDo6Z2VuZXJh
dGVfdGltZXN0YW1wKCksCiAgICAgICAgICAgICAgICAgICAgICAib2F1dGhfY29uc3VtZXJf
a2V5IiA9PiAkY29uc3VtZXItPmtleSk7CiAgICBpZiAoJHRva2VuKQogICAgICAkZGVmYXVs
dHNbJ29hdXRoX3Rva2VuJ10gPSAkdG9rZW4tPmtleTsKCiAgICAkcGFyYW1ldGVycyA9IGFy
cmF5X21lcmdlKCRkZWZhdWx0cywgJHBhcmFtZXRlcnMpOwoKICAgIHJldHVybiBuZXcgT0F1
dGhSZXF1ZXN0KCRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVycyk7CiAgfQoK
ICBwdWJsaWMgZnVuY3Rpb24gc2V0X3BhcmFtZXRlcigkbmFtZSwgJHZhbHVlLCAkYWxsb3df
ZHVwbGljYXRlcyA9IHRydWUpIHsKICAgIGlmICgkYWxsb3dfZHVwbGljYXRlcyAmJiBpc3Nl
dCgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pKSB7CiAgICAgIC8vIFdlIGhhdmUgYWxyZWFk
eSBhZGRlZCBwYXJhbWV0ZXIocykgd2l0aCB0aGlzIG5hbWUsIHNvIGFkZCB0byB0aGUgbGlz
dAogICAgICBpZiAoaXNfc2NhbGFyKCR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSkpIHsKICAg
ICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCBkdXBsaWNhdGUsIHNvIHRyYW5zZm9ybSBzY2Fs
YXIgKHN0cmluZykKICAgICAgICAvLyBpbnRvIGFuIGFycmF5IHNvIHdlIGNhbiBhZGQgdGhl
IGR1cGxpY2F0ZXMKICAgICAgICAkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0gPSBhcnJheSgk
dGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pOwogICAgICB9CgogICAgICAkdGhpcy0+cGFyYW1l
dGVyc1skbmFtZV1bXSA9ICR2YWx1ZTsKICAgIH0gZWxzZSB7CiAgICAgICR0aGlzLT5wYXJh
bWV0ZXJzWyRuYW1lXSA9ICR2YWx1ZTsKICAgIH0KICB9CgogIHB1YmxpYyBmdW5jdGlvbiBn
ZXRfcGFyYW1ldGVyKCRuYW1lKSB7CiAgICByZXR1cm4gaXNzZXQoJHRoaXMtPnBhcmFtZXRl
cnNbJG5hbWVdKSA/ICR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSA6IG51bGw7CiAgfQoKICBw
dWJsaWMgZnVuY3Rpb24gZ2V0X3BhcmFtZXRlcnMoKSB7CiAgICByZXR1cm4gJHRoaXMtPnBh
cmFtZXRlcnM7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gdW5zZXRfcGFyYW1ldGVyKCRuYW1l
KSB7CiAgICB1bnNldCgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pOwogIH0KCiAgLyoqCiAg
ICogVGhlIHJlcXVlc3QgcGFyYW1ldGVycywgc29ydGVkIGFuZCBjb25jYXRlbmF0ZWQgaW50
byBhIG5vcm1hbGl6ZWQgc3RyaW5nLgogICAqIEByZXR1cm4gc3RyaW5nCiAgICovCiAgcHVi
bGljIGZ1bmN0aW9uIGdldF9zaWduYWJsZV9wYXJhbWV0ZXJzKCkgewogICAgLy8gR3JhYiBh
bGwgcGFyYW1ldGVycwogICAgJHBhcmFtcyA9ICR0aGlzLT5wYXJhbWV0ZXJzOwoKICAgIC8v
IFJlbW92ZSBvYXV0aF9zaWduYXR1cmUgaWYgcHJlc2VudAogICAgLy8gUmVmOiBTcGVjOiA5
LjEuMSAoIlRoZSBvYXV0aF9zaWduYXR1cmUgcGFyYW1ldGVyIE1VU1QgYmUgZXhjbHVkZWQu
IikKICAgIGlmIChpc3NldCgkcGFyYW1zWydvYXV0aF9zaWduYXR1cmUnXSkpIHsKICAgICAg
dW5zZXQoJHBhcmFtc1snb2F1dGhfc2lnbmF0dXJlJ10pOwogICAgfQoKICAgIHJldHVybiBP
QXV0aFV0aWw6OmJ1aWxkX2h0dHBfcXVlcnkoJHBhcmFtcyk7CiAgfQoKICAvKioKICAgKiBS
ZXR1cm5zIHRoZSBiYXNlIHN0cmluZyBvZiB0aGlzIHJlcXVlc3QKICAgKgogICAqIFRoZSBi
YXNlIHN0cmluZyBkZWZpbmVkIGFzIHRoZSBtZXRob2QsIHRoZSB1cmwKICAgKiBhbmQgdGhl
IHBhcmFtZXRlcnMgKG5vcm1hbGl6ZWQpLCBlYWNoIHVybGVuY29kZWQKICAgKiBhbmQgdGhl
IGNvbmNhdGVkIHdpdGggJi4KICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZ2V0X3NpZ25hdHVy
ZV9iYXNlX3N0cmluZygpIHsKICAgICRwYXJ0cyA9IGFycmF5KAogICAgICAkdGhpcy0+Z2V0
X25vcm1hbGl6ZWRfaHR0cF9tZXRob2QoKSwKICAgICAgJHRoaXMtPmdldF9ub3JtYWxpemVk
X2h0dHBfdXJsKCksCiAgICAgICR0aGlzLT5nZXRfc2lnbmFibGVfcGFyYW1ldGVycygpCiAg
ICApOwoKICAgICRwYXJ0cyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJHBhcnRz
KTsKCiAgICByZXR1cm4gaW1wbG9kZSgnJicsICRwYXJ0cyk7CiAgfQoKICAvKioKICAgKiBq
dXN0IHVwcGVyY2FzZXMgdGhlIGh0dHAgbWV0aG9kCiAgICovCiAgcHVibGljIGZ1bmN0aW9u
IGdldF9ub3JtYWxpemVkX2h0dHBfbWV0aG9kKCkgewogICAgcmV0dXJuIHN0cnRvdXBwZXIo
JHRoaXMtPmh0dHBfbWV0aG9kKTsKICB9CgogIC8qKgogICAqIHBhcnNlcyB0aGUgdXJsIGFu
ZCByZWJ1aWxkcyBpdCB0byBiZQogICAqIHNjaGVtZTovL2hvc3QvcGF0aAogICAqLwogIHB1
YmxpYyBmdW5jdGlvbiBnZXRfbm9ybWFsaXplZF9odHRwX3VybCgpIHsKICAgICRwYXJ0cyA9
IHBhcnNlX3VybCgkdGhpcy0+aHR0cF91cmwpOwoKICAgICRwb3J0ID0gQCRwYXJ0c1sncG9y
dCddOwogICAgJHNjaGVtZSA9ICRwYXJ0c1snc2NoZW1lJ107CiAgICAkaG9zdCA9ICRwYXJ0
c1snaG9zdCddOwogICAgJHBhdGggPSBAJHBhcnRzWydwYXRoJ107CgogICAgJHBvcnQgb3Ig
JHBvcnQgPSAoJHNjaGVtZSA9PSAnaHR0cHMnKSA/ICc0NDMnIDogJzgwJzsKCiAgICBpZiAo
KCRzY2hlbWUgPT0gJ2h0dHBzJyAmJiAkcG9ydCAhPSAnNDQzJykKICAgICAgICB8fCAoJHNj
aGVtZSA9PSAnaHR0cCcgJiYgJHBvcnQgIT0gJzgwJykpIHsKICAgICAgJGhvc3QgPSAiJGhv
c3Q6JHBvcnQiOwogICAgfQogICAgcmV0dXJuICIkc2NoZW1lOi8vJGhvc3QkcGF0aCI7CiAg
fQoKICAvKioKICAgKiBidWlsZHMgYSB1cmwgdXNhYmxlIGZvciBhIEdFVCByZXF1ZXN0CiAg
ICovCiAgcHVibGljIGZ1bmN0aW9uIHRvX3VybCgpIHsKICAgICRwb3N0X2RhdGEgPSAkdGhp
cy0+dG9fcG9zdGRhdGEoKTsKICAgICRvdXQgPSAkdGhpcy0+Z2V0X25vcm1hbGl6ZWRfaHR0
cF91cmwoKTsKICAgIGlmICgkcG9zdF9kYXRhKSB7CiAgICAgICRvdXQgLj0gJz8nLiRwb3N0
X2RhdGE7CiAgICB9CiAgICByZXR1cm4gJG91dDsKICB9CgogIC8qKgogICAqIGJ1aWxkcyB0
aGUgZGF0YSBvbmUgd291bGQgc2VuZCBpbiBhIFBPU1QgcmVxdWVzdAogICAqLwogIHB1Ymxp
YyBmdW5jdGlvbiB0b19wb3N0ZGF0YSgpIHsKICAgIHJldHVybiBPQXV0aFV0aWw6OmJ1aWxk
X2h0dHBfcXVlcnkoJHRoaXMtPnBhcmFtZXRlcnMpOwogIH0KCiAgLyoqCiAgICogYnVpbGRz
IHRoZSBBdXRob3JpemF0aW9uOiBoZWFkZXIKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gdG9f
aGVhZGVyKCRyZWFsbT1udWxsKSB7CiAgICAkZmlyc3QgPSB0cnVlOwogIGlmKCRyZWFsbSkg
ewogICAgICAkb3V0ID0gJ0F1dGhvcml6YXRpb246IE9BdXRoIHJlYWxtPSInIC4gT0F1dGhV
dGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkcmVhbG0pIC4gJyInOwogICAgICAkZmlyc3QgPSBm
YWxzZTsKICAgIH0gZWxzZQogICAgICAkb3V0ID0gJ0F1dGhvcml6YXRpb246IE9BdXRoJzsK
CiAgICAkdG90YWwgPSBhcnJheSgpOwogICAgZm9yZWFjaCAoJHRoaXMtPnBhcmFtZXRlcnMg
YXMgJGsgPT4gJHYpIHsKICAgICAgaWYgKHN1YnN0cigkaywgMCwgNSkgIT0gIm9hdXRoIikg
Y29udGludWU7CiAgICAgIGlmIChpc19hcnJheSgkdikpIHsKICAgICAgICB0aHJvdyBuZXcg
T0F1dGhFeGNlcHRpb24oJ0FycmF5cyBub3Qgc3VwcG9ydGVkIGluIGhlYWRlcnMnKTsKICAg
ICAgfQogICAgICAkb3V0IC49ICgkZmlyc3QpID8gJyAnIDogJywnOwogICAgICAkb3V0IC49
IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJGspIC4KICAgICAgICAgICAgICAnPSIn
IC4KICAgICAgICAgICAgICBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCR2KSAuCiAg
ICAgICAgICAgICAgJyInOwogICAgICAkZmlyc3QgPSBmYWxzZTsKICAgIH0KICAgIHJldHVy
biAkb3V0OwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIF9fdG9TdHJpbmcoKSB7CiAgICByZXR1
cm4gJHRoaXMtPnRvX3VybCgpOwogIH0KCgogIHB1YmxpYyBmdW5jdGlvbiBzaWduX3JlcXVl
c3QoJHNpZ25hdHVyZV9tZXRob2QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAkdGhpcy0+
c2V0X3BhcmFtZXRlcigKICAgICAgIm9hdXRoX3NpZ25hdHVyZV9tZXRob2QiLAogICAgICAk
c2lnbmF0dXJlX21ldGhvZC0+Z2V0X25hbWUoKSwKICAgICAgZmFsc2UKICAgICk7CiAgICAk
c2lnbmF0dXJlID0gJHRoaXMtPmJ1aWxkX3NpZ25hdHVyZSgkc2lnbmF0dXJlX21ldGhvZCwg
JGNvbnN1bWVyLCAkdG9rZW4pOwogICAgJHRoaXMtPnNldF9wYXJhbWV0ZXIoIm9hdXRoX3Np
Z25hdHVyZSIsICRzaWduYXR1cmUsIGZhbHNlKTsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBi
dWlsZF9zaWduYXR1cmUoJHNpZ25hdHVyZV9tZXRob2QsICRjb25zdW1lciwgJHRva2VuKSB7
CiAgICAkc2lnbmF0dXJlID0gJHNpZ25hdHVyZV9tZXRob2QtPmJ1aWxkX3NpZ25hdHVyZSgk
dGhpcywgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAgcmV0dXJuICRzaWduYXR1cmU7CiAgfQoK
ICAvKioKICAgKiB1dGlsIGZ1bmN0aW9uOiBjdXJyZW50IHRpbWVzdGFtcAogICAqLwogIHBy
aXZhdGUgc3RhdGljIGZ1bmN0aW9uIGdlbmVyYXRlX3RpbWVzdGFtcCgpIHsKICAgIHJldHVy
biB0aW1lKCk7CiAgfQoKICAvKioKICAgKiB1dGlsIGZ1bmN0aW9uOiBjdXJyZW50IG5vbmNl
CiAgICovCiAgcHJpdmF0ZSBzdGF0aWMgZnVuY3Rpb24gZ2VuZXJhdGVfbm9uY2UoKSB7CiAg
ICAkbXQgPSBtaWNyb3RpbWUoKTsKICAgICRyYW5kID0gbXRfcmFuZCgpOwoKICAgIHJldHVy
biBtZDUoJG10IC4gJHJhbmQpOyAvLyBtZDVzIGxvb2sgbmljZXIgdGhhbiBudW1iZXJzCiAg
fQp9CgpjbGFzcyBPQXV0aFNlcnZlciB7CiAgcHJvdGVjdGVkICR0aW1lc3RhbXBfdGhyZXNo
b2xkID0gMzAwOyAvLyBpbiBzZWNvbmRzLCBmaXZlIG1pbnV0ZXMKICBwcm90ZWN0ZWQgJHZl
cnNpb24gPSAnMS4wJzsgICAgICAgICAgICAgLy8gaGkgYmxhaW5lCiAgcHJvdGVjdGVkICRz
aWduYXR1cmVfbWV0aG9kcyA9IGFycmF5KCk7CgogIHByb3RlY3RlZCAkZGF0YV9zdG9yZTsK
CiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGRhdGFfc3RvcmUpIHsKICAgICR0aGlzLT5kYXRh
X3N0b3JlID0gJGRhdGFfc3RvcmU7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gYWRkX3NpZ25h
dHVyZV9tZXRob2QoJHNpZ25hdHVyZV9tZXRob2QpIHsKICAgICR0aGlzLT5zaWduYXR1cmVf
bWV0aG9kc1skc2lnbmF0dXJlX21ldGhvZC0+Z2V0X25hbWUoKV0gPQogICAgICAkc2lnbmF0
dXJlX21ldGhvZDsKICB9CgogIC8vIGhpZ2ggbGV2ZWwgZnVuY3Rpb25zCgogIC8qKgogICAq
IHByb2Nlc3MgYSByZXF1ZXN0X3Rva2VuIHJlcXVlc3QKICAgKiByZXR1cm5zIHRoZSByZXF1
ZXN0IHRva2VuIG9uIHN1Y2Nlc3MKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZmV0Y2hfcmVx
dWVzdF90b2tlbigmJHJlcXVlc3QpIHsKICAgICR0aGlzLT5nZXRfdmVyc2lvbigkcmVxdWVz
dCk7CgogICAgJGNvbnN1bWVyID0gJHRoaXMtPmdldF9jb25zdW1lcigkcmVxdWVzdCk7Cgog
ICAgLy8gbm8gdG9rZW4gcmVxdWlyZWQgZm9yIHRoZSBpbml0aWFsIHRva2VuIHJlcXVlc3QK
ICAgICR0b2tlbiA9IE5VTEw7CgogICAgJHRoaXMtPmNoZWNrX3NpZ25hdHVyZSgkcmVxdWVz
dCwgJGNvbnN1bWVyLCAkdG9rZW4pOwoKICAgIC8vIFJldiBBIGNoYW5nZQogICAgJGNhbGxi
YWNrID0gJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX2NhbGxiYWNrJyk7CiAgICAk
bmV3X3Rva2VuID0gJHRoaXMtPmRhdGFfc3RvcmUtPm5ld19yZXF1ZXN0X3Rva2VuKCRjb25z
dW1lciwgJGNhbGxiYWNrKTsKCiAgICByZXR1cm4gJG5ld190b2tlbjsKICB9CgogIC8qKgog
ICAqIHByb2Nlc3MgYW4gYWNjZXNzX3Rva2VuIHJlcXVlc3QKICAgKiByZXR1cm5zIHRoZSBh
Y2Nlc3MgdG9rZW4gb24gc3VjY2VzcwogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBmZXRjaF9h
Y2Nlc3NfdG9rZW4oJiRyZXF1ZXN0KSB7CiAgICAkdGhpcy0+Z2V0X3ZlcnNpb24oJHJlcXVl
c3QpOwoKICAgICRjb25zdW1lciA9ICR0aGlzLT5nZXRfY29uc3VtZXIoJHJlcXVlc3QpOwoK
ICAgIC8vIHJlcXVpcmVzIGF1dGhvcml6ZWQgcmVxdWVzdCB0b2tlbgogICAgJHRva2VuID0g
JHRoaXMtPmdldF90b2tlbigkcmVxdWVzdCwgJGNvbnN1bWVyLCAicmVxdWVzdCIpOwoKICAg
ICR0aGlzLT5jaGVja19zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKTsK
CiAgICAvLyBSZXYgQSBjaGFuZ2UKICAgICR2ZXJpZmllciA9ICRyZXF1ZXN0LT5nZXRfcGFy
YW1ldGVyKCdvYXV0aF92ZXJpZmllcicpOwogICAgJG5ld190b2tlbiA9ICR0aGlzLT5kYXRh
X3N0b3JlLT5uZXdfYWNjZXNzX3Rva2VuKCR0b2tlbiwgJGNvbnN1bWVyLCAkdmVyaWZpZXIp
OwoKICAgIHJldHVybiAkbmV3X3Rva2VuOwogIH0KCiAgLyoqCiAgICogdmVyaWZ5IGFuIGFw
aSBjYWxsLCBjaGVja3MgYWxsIHRoZSBwYXJhbWV0ZXJzCiAgICovCiAgcHVibGljIGZ1bmN0
aW9uIHZlcmlmeV9yZXF1ZXN0KCYkcmVxdWVzdCkgewogICAgJHRoaXMtPmdldF92ZXJzaW9u
KCRyZXF1ZXN0KTsKICAgICRjb25zdW1lciA9ICR0aGlzLT5nZXRfY29uc3VtZXIoJHJlcXVl
c3QpOwogICAgJHRva2VuID0gJHRoaXMtPmdldF90b2tlbigkcmVxdWVzdCwgJGNvbnN1bWVy
LCAiYWNjZXNzIik7CiAgICAkdGhpcy0+Y2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29u
c3VtZXIsICR0b2tlbik7CiAgICByZXR1cm4gYXJyYXkoJGNvbnN1bWVyLCAkdG9rZW4pOwog
IH0KCiAgLy8gSW50ZXJuYWxzIGZyb20gaGVyZQogIC8qKgogICAqIHZlcnNpb24gMQogICAq
LwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X3ZlcnNpb24oJiRyZXF1ZXN0KSB7CiAgICAkdmVy
c2lvbiA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCJvYXV0aF92ZXJzaW9uIik7CiAgICBp
ZiAoISR2ZXJzaW9uKSB7CiAgICAgIC8vIFNlcnZpY2UgUHJvdmlkZXJzIE1VU1QgYXNzdW1l
IHRoZSBwcm90b2NvbCB2ZXJzaW9uIHRvIGJlIDEuMCBpZiB0aGlzIHBhcmFtZXRlciBpcyBu
b3QgcHJlc2VudC4KICAgICAgLy8gQ2hhcHRlciA3LjAgKCJBY2Nlc3NpbmcgUHJvdGVjdGVk
IFJlc3NvdXJjZXMiKQogICAgICAkdmVyc2lvbiA9ICcxLjAnOwogICAgfQogICAgaWYgKCR2
ZXJzaW9uICE9PSAkdGhpcy0+dmVyc2lvbikgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNl
cHRpb24oIk9BdXRoIHZlcnNpb24gJyR2ZXJzaW9uJyBub3Qgc3VwcG9ydGVkIik7CiAgICB9
CiAgICByZXR1cm4gJHZlcnNpb247CiAgfQoKICAvKioKICAgKiBmaWd1cmUgb3V0IHRoZSBz
aWduYXR1cmUgd2l0aCBzb21lIGRlZmF1bHRzCiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBn
ZXRfc2lnbmF0dXJlX21ldGhvZCgmJHJlcXVlc3QpIHsKICAgICRzaWduYXR1cmVfbWV0aG9k
ID0KICAgICAgICBAJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoIm9hdXRoX3NpZ25hdHVyZV9t
ZXRob2QiKTsKCiAgICBpZiAoISRzaWduYXR1cmVfbWV0aG9kKSB7CiAgICAgIC8vIEFjY29y
ZGluZyB0byBjaGFwdGVyIDcgKCJBY2Nlc3NpbmcgUHJvdGVjdGVkIFJlc3NvdXJjZXMiKSB0
aGUgc2lnbmF0dXJlLW1ldGhvZAogICAgICAvLyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQsIGFu
ZCB3ZSBjYW4ndCBqdXN0IGZhbGxiYWNrIHRvIFBMQUlOVEVYVAogICAgICB0aHJvdyBuZXcg
T0F1dGhFeGNlcHRpb24oJ05vIHNpZ25hdHVyZSBtZXRob2QgcGFyYW1ldGVyLiBUaGlzIHBh
cmFtZXRlciBpcyByZXF1aXJlZCcpOwogICAgfQoKICAgIGlmICghaW5fYXJyYXkoJHNpZ25h
dHVyZV9tZXRob2QsCiAgICAgICAgICAgICAgICAgIGFycmF5X2tleXMoJHRoaXMtPnNpZ25h
dHVyZV9tZXRob2RzKSkpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKAogICAg
ICAgICJTaWduYXR1cmUgbWV0aG9kICckc2lnbmF0dXJlX21ldGhvZCcgbm90IHN1cHBvcnRl
ZCAiIC4KICAgICAgICAidHJ5IG9uZSBvZiB0aGUgZm9sbG93aW5nOiAiIC4KICAgICAgICBp
bXBsb2RlKCIsICIsIGFycmF5X2tleXMoJHRoaXMtPnNpZ25hdHVyZV9tZXRob2RzKSkKICAg
ICAgKTsKICAgIH0KICAgIHJldHVybiAkdGhpcy0+c2lnbmF0dXJlX21ldGhvZHNbJHNpZ25h
dHVyZV9tZXRob2RdOwogIH0KCiAgLyoqCiAgICogdHJ5IHRvIGZpbmQgdGhlIGNvbnN1bWVy
IGZvciB0aGUgcHJvdmlkZWQgcmVxdWVzdCdzIGNvbnN1bWVyIGtleQogICAqLwogIHByaXZh
dGUgZnVuY3Rpb24gZ2V0X2NvbnN1bWVyKCYkcmVxdWVzdCkgewogICAgJGNvbnN1bWVyX2tl
eSA9IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcigib2F1dGhfY29uc3VtZXJfa2V5Iik7CiAg
ICBpZiAoISRjb25zdW1lcl9rZXkpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9u
KCJJbnZhbGlkIGNvbnN1bWVyIGtleSIpOwogICAgfQoKICAgICRjb25zdW1lciA9ICR0aGlz
LT5kYXRhX3N0b3JlLT5sb29rdXBfY29uc3VtZXIoJGNvbnN1bWVyX2tleSk7CiAgICBpZiAo
ISRjb25zdW1lcikgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIkludmFsaWQg
Y29uc3VtZXIiKTsKICAgIH0KCiAgICByZXR1cm4gJGNvbnN1bWVyOwogIH0KCiAgLyoqCiAg
ICogdHJ5IHRvIGZpbmQgdGhlIHRva2VuIGZvciB0aGUgcHJvdmlkZWQgcmVxdWVzdCdzIHRv
a2VuIGtleQogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X3Rva2VuKCYkcmVxdWVzdCwg
JGNvbnN1bWVyLCAkdG9rZW5fdHlwZT0iYWNjZXNzIikgewogICAgJHRva2VuX2ZpZWxkID0g
QCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF90b2tlbicpOwogICAgJHRva2VuID0g
JHRoaXMtPmRhdGFfc3RvcmUtPmxvb2t1cF90b2tlbigKICAgICAgJGNvbnN1bWVyLCAkdG9r
ZW5fdHlwZSwgJHRva2VuX2ZpZWxkCiAgICApOwogICAgaWYgKCEkdG9rZW4pIHsKICAgICAg
dGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJbnZhbGlkICR0b2tlbl90eXBlIHRva2VuOiAk
dG9rZW5fZmllbGQiKTsKICAgIH0KICAgIHJldHVybiAkdG9rZW47CiAgfQoKICAvKioKICAg
KiBhbGwtaW4tb25lIGZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBzaWduYXR1cmUgb24gYSByZXF1
ZXN0CiAgICogc2hvdWxkIGd1ZXNzIHRoZSBzaWduYXR1cmUgbWV0aG9kIGFwcHJvcHJpYXRl
bHkKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGNoZWNrX3NpZ25hdHVyZSgmJHJlcXVlc3Qs
ICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAvLyB0aGlzIHNob3VsZCBwcm9iYWJseSBiZSBp
biBhIGRpZmZlcmVudCBtZXRob2QKICAgICR0aW1lc3RhbXAgPSBAJHJlcXVlc3QtPmdldF9w
YXJhbWV0ZXIoJ29hdXRoX3RpbWVzdGFtcCcpOwogICAgJG5vbmNlID0gQCRyZXF1ZXN0LT5n
ZXRfcGFyYW1ldGVyKCdvYXV0aF9ub25jZScpOwoKICAgICR0aGlzLT5jaGVja190aW1lc3Rh
bXAoJHRpbWVzdGFtcCk7CiAgICAkdGhpcy0+Y2hlY2tfbm9uY2UoJGNvbnN1bWVyLCAkdG9r
ZW4sICRub25jZSwgJHRpbWVzdGFtcCk7CgogICAgJHNpZ25hdHVyZV9tZXRob2QgPSAkdGhp
cy0+Z2V0X3NpZ25hdHVyZV9tZXRob2QoJHJlcXVlc3QpOwoKICAgICRzaWduYXR1cmUgPSAk
cmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfc2lnbmF0dXJlJyk7CiAgICAkdmFsaWRf
c2lnID0gJHNpZ25hdHVyZV9tZXRob2QtPmNoZWNrX3NpZ25hdHVyZSgKICAgICAgJHJlcXVl
c3QsCiAgICAgICRjb25zdW1lciwKICAgICAgJHRva2VuLAogICAgICAkc2lnbmF0dXJlCiAg
ICApOwoKICAgIGlmICghJHZhbGlkX3NpZykgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNl
cHRpb24oIkludmFsaWQgc2lnbmF0dXJlIik7CiAgICB9CiAgfQoKICAvKioKICAgKiBjaGVj
ayB0aGF0IHRoZSB0aW1lc3RhbXAgaXMgbmV3IGVub3VnaAogICAqLwogIHByaXZhdGUgZnVu
Y3Rpb24gY2hlY2tfdGltZXN0YW1wKCR0aW1lc3RhbXApIHsKICAgIGlmKCAhICR0aW1lc3Rh
bXAgKQogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAgICAgJ01pc3Npbmcg
dGltZXN0YW1wIHBhcmFtZXRlci4gVGhlIHBhcmFtZXRlciBpcyByZXF1aXJlZCcKICAgICAg
KTsKCiAgICAvLyB2ZXJpZnkgdGhhdCB0aW1lc3RhbXAgaXMgcmVjZW50aXNoCiAgICAkbm93
ID0gdGltZSgpOwogICAgaWYgKGFicygkbm93IC0gJHRpbWVzdGFtcCkgPiAkdGhpcy0+dGlt
ZXN0YW1wX3RocmVzaG9sZCkgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oCiAg
ICAgICAgIkV4cGlyZWQgdGltZXN0YW1wLCB5b3VycyAkdGltZXN0YW1wLCBvdXJzICRub3ci
CiAgICAgICk7CiAgICB9CiAgfQoKICAvKioKICAgKiBjaGVjayB0aGF0IHRoZSBub25jZSBp
cyBub3QgcmVwZWF0ZWQKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGNoZWNrX25vbmNlKCRj
b25zdW1lciwgJHRva2VuLCAkbm9uY2UsICR0aW1lc3RhbXApIHsKICAgIGlmKCAhICRub25j
ZSApCiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigKICAgICAgICAnTWlzc2luZyBu
b25jZSBwYXJhbWV0ZXIuIFRoZSBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQnCiAgICAgICk7Cgog
ICAgLy8gdmVyaWZ5IHRoYXQgdGhlIG5vbmNlIGlzIHVuaXF1ZWlzaAogICAgJGZvdW5kID0g
JHRoaXMtPmRhdGFfc3RvcmUtPmxvb2t1cF9ub25jZSgKICAgICAgJGNvbnN1bWVyLAogICAg
ICAkdG9rZW4sCiAgICAgICRub25jZSwKICAgICAgJHRpbWVzdGFtcAogICAgKTsKICAgIGlm
ICgkZm91bmQpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJOb25jZSBhbHJl
YWR5IHVzZWQ6ICRub25jZSIpOwogICAgfQogIH0KCn0KCmNsYXNzIE9BdXRoRGF0YVN0b3Jl
IHsKICBmdW5jdGlvbiBsb29rdXBfY29uc3VtZXIoJGNvbnN1bWVyX2tleSkgewogICAgLy8g
aW1wbGVtZW50IG1lCiAgfQoKICBmdW5jdGlvbiBsb29rdXBfdG9rZW4oJGNvbnN1bWVyLCAk
dG9rZW5fdHlwZSwgJHRva2VuKSB7CiAgICAvLyBpbXBsZW1lbnQgbWUKICB9CgogIGZ1bmN0
aW9uIGxvb2t1cF9ub25jZSgkY29uc3VtZXIsICR0b2tlbiwgJG5vbmNlLCAkdGltZXN0YW1w
KSB7CiAgICAvLyBpbXBsZW1lbnQgbWUKICB9CgogIGZ1bmN0aW9uIG5ld19yZXF1ZXN0X3Rv
a2VuKCRjb25zdW1lciwgJGNhbGxiYWNrID0gbnVsbCkgewogICAgLy8gcmV0dXJuIGEgbmV3
IHRva2VuIGF0dGFjaGVkIHRvIHRoaXMgY29uc3VtZXIKICB9CgogIGZ1bmN0aW9uIG5ld19h
Y2Nlc3NfdG9rZW4oJHRva2VuLCAkY29uc3VtZXIsICR2ZXJpZmllciA9IG51bGwpIHsKICAg
IC8vIHJldHVybiBhIG5ldyBhY2Nlc3MgdG9rZW4gYXR0YWNoZWQgdG8gdGhpcyBjb25zdW1l
cgogICAgLy8gZm9yIHRoZSB1c2VyIGFzc29jaWF0ZWQgd2l0aCB0aGlzIHRva2VuIGlmIHRo
ZSByZXF1ZXN0IHRva2VuCiAgICAvLyBpcyBhdXRob3JpemVkCiAgICAvLyBzaG91bGQgYWxz
byBpbnZhbGlkYXRlIHRoZSByZXF1ZXN0IHRva2VuCiAgfQoKfQoKY2xhc3MgT0F1dGhVdGls
IHsKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHVybGVuY29kZV9yZmMzOTg2KCRpbnB1dCkg
ewogIGlmIChpc19hcnJheSgkaW5wdXQpKSB7CiAgICByZXR1cm4gYXJyYXlfbWFwKGFycmF5
KCdPQXV0aFV0aWwnLCAndXJsZW5jb2RlX3JmYzM5ODYnKSwgJGlucHV0KTsKICB9IGVsc2Ug
aWYgKGlzX3NjYWxhcigkaW5wdXQpKSB7CiAgICByZXR1cm4gc3RyX3JlcGxhY2UoCiAgICAg
ICcrJywKICAgICAgJyAnLAogICAgICBzdHJfcmVwbGFjZSgnJTdFJywgJ34nLCByYXd1cmxl
bmNvZGUoJGlucHV0KSkKICAgICk7CiAgfSBlbHNlIHsKICAgIHJldHVybiAnJzsKICB9Cn0K
CgogIC8vIFRoaXMgZGVjb2RlIGZ1bmN0aW9uIGlzbid0IHRha2luZyBpbnRvIGNvbnNpZGVy
YXRpb24gdGhlIGFib3ZlCiAgLy8gbW9kaWZpY2F0aW9ucyB0byB0aGUgZW5jb2RpbmcgcHJv
Y2Vzcy4gSG93ZXZlciwgdGhpcyBtZXRob2QgZG9lc24ndAogIC8vIHNlZW0gdG8gYmUgdXNl
ZCBhbnl3aGVyZSBzbyBsZWF2aW5nIGl0IGFzIGlzLgogIHB1YmxpYyBzdGF0aWMgZnVuY3Rp
b24gdXJsZGVjb2RlX3JmYzM5ODYoJHN0cmluZykgewogICAgcmV0dXJuIHVybGRlY29kZSgk
c3RyaW5nKTsKICB9CgogIC8vIFV0aWxpdHkgZnVuY3Rpb24gZm9yIHR1cm5pbmcgdGhlIEF1
dGhvcml6YXRpb246IGhlYWRlciBpbnRvCiAgLy8gcGFyYW1ldGVycywgaGFzIHRvIGRvIHNv
bWUgdW5lc2NhcGluZwogIC8vIENhbiBmaWx0ZXIgb3V0IGFueSBub24tb2F1dGggcGFyYW1l
dGVycyBpZiBuZWVkZWQgKGRlZmF1bHQgYmVoYXZpb3VyKQogIHB1YmxpYyBzdGF0aWMgZnVu
Y3Rpb24gc3BsaXRfaGVhZGVyKCRoZWFkZXIsICRvbmx5X2FsbG93X29hdXRoX3BhcmFtZXRl
cnMgPSB0cnVlKSB7CiAgICAkcGF0dGVybiA9ICcvKChbLV9hLXpdKik9KCIoW14iXSopInwo
W14sXSopKSw/KS8nOwogICAgJG9mZnNldCA9IDA7CiAgICAkcGFyYW1zID0gYXJyYXkoKTsK
ICAgIHdoaWxlIChwcmVnX21hdGNoKCRwYXR0ZXJuLCAkaGVhZGVyLCAkbWF0Y2hlcywgUFJF
R19PRkZTRVRfQ0FQVFVSRSwgJG9mZnNldCkgPiAwKSB7CiAgICAgICRtYXRjaCA9ICRtYXRj
aGVzWzBdOwogICAgICAkaGVhZGVyX25hbWUgPSAkbWF0Y2hlc1syXVswXTsKICAgICAgJGhl
YWRlcl9jb250ZW50ID0gKGlzc2V0KCRtYXRjaGVzWzVdKSkgPyAkbWF0Y2hlc1s1XVswXSA6
ICRtYXRjaGVzWzRdWzBdOwogICAgICBpZiAocHJlZ19tYXRjaCgnL15vYXV0aF8vJywgJGhl
YWRlcl9uYW1lKSB8fCAhJG9ubHlfYWxsb3dfb2F1dGhfcGFyYW1ldGVycykgewogICAgICAg
ICRwYXJhbXNbJGhlYWRlcl9uYW1lXSA9IE9BdXRoVXRpbDo6dXJsZGVjb2RlX3JmYzM5ODYo
JGhlYWRlcl9jb250ZW50KTsKICAgICAgfQogICAgICAkb2Zmc2V0ID0gJG1hdGNoWzFdICsg
c3RybGVuKCRtYXRjaFswXSk7CiAgICB9CgogICAgaWYgKGlzc2V0KCRwYXJhbXNbJ3JlYWxt
J10pKSB7CiAgICAgIHVuc2V0KCRwYXJhbXNbJ3JlYWxtJ10pOwogICAgfQoKICAgIHJldHVy
biAkcGFyYW1zOwogIH0KCiAgLy8gaGVscGVyIHRvIHRyeSB0byBzb3J0IG91dCBoZWFkZXJz
IGZvciBwZW9wbGUgd2hvIGFyZW4ndCBydW5uaW5nIGFwYWNoZQogIHB1YmxpYyBzdGF0aWMg
ZnVuY3Rpb24gZ2V0X2hlYWRlcnMoKSB7CiAgICBpZiAoZnVuY3Rpb25fZXhpc3RzKCdhcGFj
aGVfcmVxdWVzdF9oZWFkZXJzJykpIHsKICAgICAgLy8gd2UgbmVlZCB0aGlzIHRvIGdldCB0
aGUgYWN0dWFsIEF1dGhvcml6YXRpb246IGhlYWRlcgogICAgICAvLyBiZWNhdXNlIGFwYWNo
ZSB0ZW5kcyB0byB0ZWxsIHVzIGl0IGRvZXNuJ3QgZXhpc3QKICAgICAgJGhlYWRlcnMgPSBh
cGFjaGVfcmVxdWVzdF9oZWFkZXJzKCk7CgogICAgICAvLyBzYW5pdGl6ZSB0aGUgb3V0cHV0
IG9mIGFwYWNoZV9yZXF1ZXN0X2hlYWRlcnMgYmVjYXVzZQogICAgICAvLyB3ZSBhbHdheXMg
d2FudCB0aGUga2V5cyB0byBiZSBDYXNlZC1MaWtlLVRoaXMgYW5kIGFyaCgpCiAgICAgIC8v
IHJldHVybnMgdGhlIGhlYWRlcnMgaW4gdGhlIHNhbWUgY2FzZSBhcyB0aGV5IGFyZSBpbiB0
aGUKICAgICAgLy8gcmVxdWVzdAogICAgICAkb3V0ID0gYXJyYXkoKTsKICAgICAgZm9yZWFj
aCggJGhlYWRlcnMgQVMgJGtleSA9PiAkdmFsdWUgKSB7CiAgICAgICAgJGtleSA9IHN0cl9y
ZXBsYWNlKAogICAgICAgICAgICAiICIsCiAgICAgICAgICAgICItIiwKICAgICAgICAgICAg
dWN3b3JkcyhzdHJ0b2xvd2VyKHN0cl9yZXBsYWNlKCItIiwgIiAiLCAka2V5KSkpCiAgICAg
ICAgICApOwogICAgICAgICRvdXRbJGtleV0gPSAkdmFsdWU7CiAgICAgIH0KICAgIH0gZWxz
ZSB7CiAgICAgIC8vIG90aGVyd2lzZSB3ZSBkb24ndCBoYXZlIGFwYWNoZSBhbmQgYXJlIGp1
c3QgZ29pbmcgdG8gaGF2ZSB0byBob3BlCiAgICAgIC8vIHRoYXQgJF9TRVJWRVIgYWN0dWFs
bHkgY29udGFpbnMgd2hhdCB3ZSBuZWVkCiAgICAgICRvdXQgPSBhcnJheSgpOwogICAgICBp
ZiggaXNzZXQoJF9TRVJWRVJbJ0NPTlRFTlRfVFlQRSddKSApCiAgICAgICAgJG91dFsnQ29u
dGVudC1UeXBlJ10gPSAkX1NFUlZFUlsnQ09OVEVOVF9UWVBFJ107CiAgICAgIGlmKCBpc3Nl
dCgkX0VOVlsnQ09OVEVOVF9UWVBFJ10pICkKICAgICAgICAkb3V0WydDb250ZW50LVR5cGUn
XSA9ICRfRU5WWydDT05URU5UX1RZUEUnXTsKCiAgICAgIGZvcmVhY2ggKCRfU0VSVkVSIGFz
ICRrZXkgPT4gJHZhbHVlKSB7CiAgICAgICAgaWYgKHN1YnN0cigka2V5LCAwLCA1KSA9PSAi
SFRUUF8iKSB7CiAgICAgICAgICAvLyB0aGlzIGlzIGNoYW9zLCBiYXNpY2FsbHkgaXQgaXMg
anVzdCB0aGVyZSB0byBjYXBpdGFsaXplIHRoZSBmaXJzdAogICAgICAgICAgLy8gbGV0dGVy
IG9mIGV2ZXJ5IHdvcmQgdGhhdCBpcyBub3QgYW4gaW5pdGlhbCBIVFRQIGFuZCBzdHJpcCBI
VFRQCiAgICAgICAgICAvLyBjb2RlIGZyb20gcHJ6ZW1lawogICAgICAgICAgJGtleSA9IHN0
cl9yZXBsYWNlKAogICAgICAgICAgICAiICIsCiAgICAgICAgICAgICItIiwKICAgICAgICAg
ICAgdWN3b3JkcyhzdHJ0b2xvd2VyKHN0cl9yZXBsYWNlKCJfIiwgIiAiLCBzdWJzdHIoJGtl
eSwgNSkpKSkKICAgICAgICAgICk7CiAgICAgICAgICAkb3V0WyRrZXldID0gJHZhbHVlOwog
ICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuICRvdXQ7CiAgfQoKICAvLyBUaGlz
IGZ1bmN0aW9uIHRha2VzIGEgaW5wdXQgbGlrZSBhPWImYT1jJmQ9ZSBhbmQgcmV0dXJucyB0
aGUgcGFyc2VkCiAgLy8gcGFyYW1ldGVycyBsaWtlIHRoaXMKICAvLyBhcnJheSgnYScgPT4g
YXJyYXkoJ2InLCdjJyksICdkJyA9PiAnZScpCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBw
YXJzZV9wYXJhbWV0ZXJzKCAkaW5wdXQgKSB7CiAgICBpZiAoIWlzc2V0KCRpbnB1dCkgfHwg
ISRpbnB1dCkgcmV0dXJuIGFycmF5KCk7CgogICAgJHBhaXJzID0gZXhwbG9kZSgnJicsICRp
bnB1dCk7CgogICAgJHBhcnNlZF9wYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgIGZvcmVhY2gg
KCRwYWlycyBhcyAkcGFpcikgewogICAgICAkc3BsaXQgPSBleHBsb2RlKCc9JywgJHBhaXIs
IDIpOwogICAgICAkcGFyYW1ldGVyID0gT0F1dGhVdGlsOjp1cmxkZWNvZGVfcmZjMzk4Nigk
c3BsaXRbMF0pOwogICAgICAkdmFsdWUgPSBpc3NldCgkc3BsaXRbMV0pID8gT0F1dGhVdGls
Ojp1cmxkZWNvZGVfcmZjMzk4Nigkc3BsaXRbMV0pIDogJyc7CgogICAgICBpZiAoaXNzZXQo
JHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdKSkgewogICAgICAgIC8vIFdlIGhhdmUg
YWxyZWFkeSByZWNpZXZlZCBwYXJhbWV0ZXIocykgd2l0aCB0aGlzIG5hbWUsIHNvIGFkZCB0
byB0aGUgbGlzdAogICAgICAgIC8vIG9mIHBhcmFtZXRlcnMgd2l0aCB0aGlzIG5hbWUKCiAg
ICAgICAgaWYgKGlzX3NjYWxhcigkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl0pKSB7
CiAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCBkdXBsaWNhdGUsIHNvIHRyYW5zZm9y
bSBzY2FsYXIgKHN0cmluZykgaW50byBhbiBhcnJheQogICAgICAgICAgLy8gc28gd2UgY2Fu
IGFkZCB0aGUgZHVwbGljYXRlcwogICAgICAgICAgJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJh
bWV0ZXJdID0gYXJyYXkoJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdKTsKICAgICAg
ICB9CgogICAgICAgICRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXVtdID0gJHZhbHVl
OwogICAgICB9IGVsc2UgewogICAgICAgICRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVy
XSA9ICR2YWx1ZTsKICAgICAgfQogICAgfQogICAgcmV0dXJuICRwYXJzZWRfcGFyYW1ldGVy
czsKICB9CgogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gYnVpbGRfaHR0cF9xdWVyeSgkcGFy
YW1zKSB7CiAgICBpZiAoISRwYXJhbXMpIHJldHVybiAnJzsKCiAgICAvLyBVcmxlbmNvZGUg
Ym90aCBrZXlzIGFuZCB2YWx1ZXMKICAgICRrZXlzID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVf
cmZjMzk4NihhcnJheV9rZXlzKCRwYXJhbXMpKTsKICAgICR2YWx1ZXMgPSBPQXV0aFV0aWw6
OnVybGVuY29kZV9yZmMzOTg2KGFycmF5X3ZhbHVlcygkcGFyYW1zKSk7CiAgICAkcGFyYW1z
ID0gYXJyYXlfY29tYmluZSgka2V5cywgJHZhbHVlcyk7CgogICAgLy8gUGFyYW1ldGVycyBh
cmUgc29ydGVkIGJ5IG5hbWUsIHVzaW5nIGxleGljb2dyYXBoaWNhbCBieXRlIHZhbHVlIG9y
ZGVyaW5nLgogICAgLy8gUmVmOiBTcGVjOiA5LjEuMSAoMSkKICAgIHVrc29ydCgkcGFyYW1z
LCAnc3RyY21wJyk7CgogICAgJHBhaXJzID0gYXJyYXkoKTsKICAgIGZvcmVhY2ggKCRwYXJh
bXMgYXMgJHBhcmFtZXRlciA9PiAkdmFsdWUpIHsKICAgICAgaWYgKGlzX2FycmF5KCR2YWx1
ZSkpIHsKICAgICAgICAvLyBJZiB0d28gb3IgbW9yZSBwYXJhbWV0ZXJzIHNoYXJlIHRoZSBz
YW1lIG5hbWUsIHRoZXkgYXJlIHNvcnRlZCBieSB0aGVpciB2YWx1ZQogICAgICAgIC8vIFJl
ZjogU3BlYzogOS4xLjEgKDEpCiAgICAgICAgbmF0c29ydCgkdmFsdWUpOwogICAgICAgIGZv
cmVhY2ggKCR2YWx1ZSBhcyAkZHVwbGljYXRlX3ZhbHVlKSB7CiAgICAgICAgICAkcGFpcnNb
XSA9ICRwYXJhbWV0ZXIgLiAnPScgLiAkZHVwbGljYXRlX3ZhbHVlOwogICAgICAgIH0KICAg
ICAgfSBlbHNlIHsKICAgICAgICAkcGFpcnNbXSA9ICRwYXJhbWV0ZXIgLiAnPScgLiAkdmFs
dWU7CiAgICAgIH0KICAgIH0KICAgIC8vIEZvciBlYWNoIHBhcmFtZXRlciwgdGhlIG5hbWUg
aXMgc2VwYXJhdGVkIGZyb20gdGhlIGNvcnJlc3BvbmRpbmcgdmFsdWUgYnkgYW4gJz0nIGNo
YXJhY3RlciAoQVNDSUkgY29kZSA2MSkKICAgIC8vIEVhY2ggbmFtZS12YWx1ZSBwYWlyIGlz
IHNlcGFyYXRlZCBieSBhbiAnJicgY2hhcmFjdGVyIChBU0NJSSBjb2RlIDM4KQogICAgcmV0
dXJuIGltcGxvZGUoJyYnLCAkcGFpcnMpOwogIH0KfSI7czozOiJtZDUiO3M6MzI6IjI4YWMw
OWJkZDZhZGFmZDk5M2IzN2E2YTFlYTYzZWIwIjt9
