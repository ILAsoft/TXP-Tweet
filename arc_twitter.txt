# arc_twitter v3.0-dev
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjc6
IjMuMC1kZXYiO3M6NjoiYXV0aG9yIjtzOjExOiJBbmR5IENhcnRlciI7czoxMDoiYXV0aG9y
X3VyaSI7czozMToiaHR0cDovL3JlZGhvdGNoaWxsaXByb2plY3QuY29tLyI7czoxMToiZGVz
Y3JpcHRpb24iO3M6NjA6IjxhIGhyZWY9Imh0dHA6Ly93d3cudHdpdHRlci5jb20iPlR3aXR0
ZXI8L2E+IGZvciBUZXh0cGF0dGVybiI7czo1OiJvcmRlciI7czoxOiI1IjtzOjQ6InR5cGUi
O3M6MToiMSI7czo1OiJmbGFncyI7czoxOiIzIjtzOjQ6ImhlbHAiO3M6MTY5OTE6Igk8aDEg
Y2xhc3M9InRpdGxlIj48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCAoYXJj
X3R3aXR0ZXIgZm9yIFRleHRwYXR0ZXJuKTwvaDE+CgoJPG9sPgoJCTxsaT48YSBocmVmPSIj
YXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2Fy
Y190d2l0dGVyX2luc3RhbGxhdGlvbiI+SW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxsYXRpb248
L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3RhZyI+VGhlIGFyY190d2l0
dGVyIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfc2VhcmNoX3Rh
ZyI+VGhlIGFyY190d2l0dGVyX3NlYXJjaCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0i
I2FyY190d2l0dGVyX3R3ZWV0X2J1dHRvbl90YWciPlRoZSBhcmNfdHdpdHRlcl90d2VldF9i
dXR0b24gdGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl9mb2xsb3df
YnV0dG9uX3RhZyI+VGhlIGFyY190d2l0dGVyX2ZvbGxvd19idXR0b24gdGFnPC9hPjwvbGk+
CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl90d2VldF91cmwiPlRoZSBhcmNfdHdpdHRl
cl90d2VldF91cmwgdGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl90
aW55dXJsIj5UaGUgYXJjX3R3aXR0ZXJfdGlueXVybCB0YWc8L2E+PC9saT4KCQk8bGk+PGEg
aHJlZj0iI2FyY190d2l0dGVyX2NhY2hpbmciPkNhY2hpbmc8L2E+PC9saT4KCQk8bGk+PGEg
aHJlZj0iI2FyY190d2l0dGVyX3ByZWZzIj5QcmVmZXJlbmNlczwvYT48L2xpPgoJCTxsaT48
YSBocmVmPSIjYXJjX3R3aXR0ZXJfYXJ0aWNsZSI+VHdlZXRpbmcgYXJ0aWNsZXM8L2E+PC9s
aT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX2FkbWluIj5UaGUgVHdpdHRlciB0YWI8
L2E+PC9saT4KCTwvb2w+CgoJPHA+PHNwYW4gY2xhc3M9ImNhcHMiPlRYUDwvc3Bhbj4gVHdl
ZXQgcHJvdmlkZXMgYWNjZXNzIHRvIHlvdXIgVHdpdHRlciBhY2NvdW50IHRocm91Z2ggYm90
aCB0aGUgYWRtaW4gaW50ZXJmYWNlIGFuZCB0aGUgcHVibGljIHNpZGUgb2YgeW91ciBzaXRl
LiBVcGRhdGUgVHdpdHRlciB3aGVuIHlvdSBwb3N0IGEgbmV3IGFydGljbGUgKHdpdGggYXJ0
aWNsZS1ieS1hcnRpY2xlIG9wdCBvdXQgb3B0aW9uKSwgdXBkYXRlIGFuZCB2aWV3IHlvdXIg
VHdpdHRlciBmZWVkIHRocm91Z2ggdGhlIGFkbWluIFR3aXR0ZXIgdGFiLCBhbmQgZGlzcGxh
eSBUd2l0dGVyIGZlZWRzIG9uIHlvdXIgc2l0ZS48L3A+CgoJPHA+UmVxdWlyZW1lbnRzOi08
L3A+CgoJPHVsPgoJCTxsaT5UZXh0cGF0dGVybiA0LjIrPC9saT4KCQk8bGk+PHNwYW4gY2xh
c3M9ImNhcHMiPlBIUDwvc3Bhbj4gNSBhbmQgY1VSTDwvbGk+Cgk8L3VsPgoKCTxoMiBjbGFz
cz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX2F1dGhvciI+QXV0aG9yPC9oMj4KCgk8cD48
YSBocmVmPSJodHRwOi8vcmVkaG90Y2hpbGxpcHJvamVjdC5jb20iPkFuZHkgQ2FydGVyPC9h
Pi4gRm9yIG90aGVyIFRleHRwYXR0ZXJuIHBsdWdpbnMgYnkgbWUgdmlzaXQgbXkgPGEgaHJl
Zj0iaHR0cDovL3JlZGhvdGNoaWxsaXByb2plY3QuY29tL3R4cCI+UGx1Z2lucyBwYWdlPC9h
Pi48L3A+CgoJPHA+VGhhbmtzIHRvIDxhIGhyZWY9Imh0dHA6Ly9tYW5mcmUubmV0LyI+TWlj
aGFlbCBNYW5mcmU8L2E+IGZvciBpbnNwaXJhdGlvbiBmb3IgdGhlIGFydGljbGUgdHdlZXQg
cGFydCBvZiB0aGlzIHBsdWdpbiBiYXNlZCBvbiBoaXMgPHNwYW4gY2xhc3M9InRhZyI+bWVt
X3R3aXR0ZXI8L3NwYW4+IHBsdWdpbi4gIEFkZGl0aW9uYWwgdGhhbmtzIHRvIHRoZSBncmVh
dCBUZXh0cGF0dGVybiBjb21tdW5pdHkgZm9yIGhlbHBpbmcgdG8gdGVzdCB0aGlzIHBsdWdp
biBhbmQgZm9yIHN1Z2dlc3RpbmcgbmV3IGZlYXR1cmVzLiBUaGUgT0F1dGggcGFydCBvZiB0
aGUgcGx1Z2luIGlzIHRoYW5rcyB0byA8YSBocmVmPSJodHRwOi8vdHdpdHRlci5jb20vYWJy
YWhhbSI+QWJyYWhhbSBXaWxsaWFtczwvYT4uPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIg
aWQ9ImFyY190d2l0dGVyX2luc3RhbGxhdGlvbiI+SW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxs
YXRpb248L2gyPgoKCTxwPlRvIGluc3RhbGwgZ28gdG8gdGhlICYjODIxNjtwbHVnaW5zJiM4
MjE3OyB0YWIgdW5kZXIgJiM4MjE2O2FkbWluJiM4MjE3OyBhbmQgcGFzdGUgdGhlIHBsdWdp
biBjb2RlIGludG8gdGhlICYjODIxNjtJbnN0YWxsIHBsdWdpbiYjODIxNzsgYm94LCAmIzgy
MTY7dXBsb2FkJiM4MjE3OyBhbmQgdGhlbiAmIzgyMTY7aW5zdGFsbCYjODIxNzsuIEZpbmFs
bHkgYWN0aXZhdGUgdGhlIHBsdWdpbi48L3A+CgoJPHA+QmVmb3JlIHlvdSBzdGFydCB1c2lu
ZyA8c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRlcjwvc3Bhbj4geW91IHdpbGwgbmVlZCB0
byBtYWtlIHN1cmUgdGhhdCB0aGUgY2FjaGUgZGlyZWN0b3J5IGlzIHdyaXRhYmxlLiBTZWUg
dGhlICYjODIxNjtDYWNoaW5nJiM4MjE3OyBzdWJzZWN0aW9uIGJlbG93IGZvciBmdXJ0aGVy
IGluZm9ybWF0aW9uLjwvcD4KCgk8cD48c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRlcjwv
c3Bhbj4gc2hvdWxkIG5vdyBiZSByZWFkeSBmb3IgdXNlIG9uIHRoZSBwdWJsaWMtc2lkZSBv
ZiB5b3VyIHNpdGUuPC9wPgoKCTxwPlRvIHVubG9jayB0aGUgYWRtaW4gZmVhdHVyZXMgb2Yg
dGhpcyBwbHVnaW4geW91IHdpbGwgbmVlZCB0byBhc3NvY2lhdGUgeW91ciBzaXRlIHdpdGgg
YSBUd2l0dGVyIGFjY291bnQgYnkgY29ubmVjdGluZyB0byBUd2l0dGVyIGZyb20gdGhlIHBs
dWdpbiYjODIxNztzIG9wdGlvbnMgc2NyZWVuLiBDbGljayBvbiB0aGUgbGluayB0byBjb25u
ZWN0IHRvIFR3aXR0ZXIsIHlvdSB3aWxsIGJlIGFza2VkIHRvIGxvZ2luIHRvIFR3aXR0ZXIs
IGNsaWNraW5nIHRoaXMgbGluayB3aWxsIHRlbXBvcmFyaWx5IHRha2UgeW91IHRvIHRoZSBU
d2l0dGVyIHNpdGUgd2hlcmUgeW91IHdpbGwgYmUgYXNrZWQgdG8gbG9naW4gYW5kIGFwcHJv
dmUgYWNjZXNzIGZvciA8c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCB0byBy
ZWFkIGFuZCB3cml0ZSB0byB5b3VyIFR3aXR0ZXIgYWNjb3VudC4gSWYgYWxsIGlzIHN1Y2Nl
c3NmdWwgeW91IHdpbGwgYmUgcmV0dXJuZWQgdG8gdGhlIG9wdGlvbnMgc2NyZWVuIGFuZCB5
b3VyIHVzZXIgbmFtZSB3aWxsIGFwcGVhci48L3A+CgoJPHA+QXQgYW55IHRpbWUgeW91IGNh
biBkaXNhc3NvY2lhdGUgeW91ciBUd2l0dGVyIGFjY291bnQgd2l0aCA8c3BhbiBjbGFzcz0i
Y2FwcyI+VFhQPC9zcGFuPiBUd2VldCB2aWEgeW91ciBUd2l0dGVyIGFjY291bnQgcHJlZmVy
ZW5jZXMgb24gdGhlIDxhIGhyZWY9Imh0dHA6Ly93d3cudHdpdHRlci5jb20iPlR3aXR0ZXIg
d2Vic2l0ZTwvYT4uPC9wPgoKCTxwPlRvIHVuaW5zdGFsbCA8c3BhbiBjbGFzcz0idGFnIj5h
cmNfdHdpdHRlcjwvc3Bhbj4gc2ltcGx5IGRlbGV0ZSB0aGUgcGx1Z2luIGZyb20gdGhlICYj
ODIxNjtQbHVnaW5zJiM4MjE3OyB0YWIuICBUaGlzIHdpbGwgcmVtb3ZlIHRoZSBwbHVnaW4g
Y29kZSwgZGVsZXRlIHJlbGF0ZWQgcHJlZmVyZW5jZXMgYW5kIGRyb3AgdGhlIDxzcGFuIGNs
YXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiB0YWJsZSBmcm9tIHlvdXIgVGV4dHBhdHRl
cm4gZGF0YWJhc2UuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVy
X3RhZyI+VGhlIGFyY190d2l0dGVyIHRhZzwvaDI+CgoJPGgzPlN5bnRheDwvaDM+CgoJPHA+
Jmx0O3R4cDphcmNfdHdpdHRlciB1c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDsgLyZn
dDs8L3A+CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmli
dXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJ
CQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD51c2VyPC90ZD4KCQkJ
PHRkPlR3aXR0ZXIgdXNlciBuYW1lPC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0ZXIgdXNl
cm5hbWU8L2VtPjwvdGQ+CgkJCTx0ZD51c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDs8
L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGltaXQ8L3RkPgoJCQk8dGQ+TWF4aW11bSBu
dW1iZXIgb2YgdHdlZXRzIHRvIGRpc3BsYXkgKG1heC4gMjAwKTwvdGQ+CgkJCTx0ZD4xMDwv
dGQ+CgkJCTx0ZD5saW1pdD0mcXVvdDsyNSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJ
CTx0ZD5kYXRlZm9ybWF0PC90ZD4KCQkJPHRkPkZvcm1hdCB0aGF0IHVwZGF0ZSBkYXRlcyB3
aWxsIGFwcGVhciBhczwvdGQ+CgkJCTx0ZD4gPGVtPkFyY2hpdmUgZGF0ZSBmb3JtYXQ8L2Vt
PjwvdGQ+CgkJCTx0ZD5kYXRlZm9ybWF0PSZxdW90OyViICVPZSwgJUk6JU0gJXAmcXVvdDs8
L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFiZWw8L3RkPgoJCQk8dGQ+TGFiZWwgZm9y
IHRoZSB0b3Agb2YgdGhlIGxpc3Q8L3RkPgoJCQk8dGQ+IDxlbT5ubyBsYWJlbDwvZW0+PC90
ZD4KCQkJPHRkPmxhYmVsPSZxdW90O015IFR3aXR0ZXIgdGltZWxpbmUmcXVvdDs8L3RkPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFiZWx0YWc8L3RkPgoJCQk8dGQ+SW5kZXBlbmRlbnQg
d3JhcHRhZyBmb3IgbGFiZWw8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJ
PHRkPmxhYmVsdGFnPSZxdW90O2gzJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRk
PmJyZWFrPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2Fw
cyI+SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyAod2l0aG91dCBicmFja2V0cyksIG9yIHN0cmlu
ZywgdXNlZCB0byBzZXBhcmF0ZSB0aGUgdXBkYXRlczwvdGQ+CgkJCTx0ZD5saTwvdGQ+CgkJ
CTx0ZD5icmVhaz0mcXVvdDticiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD53
cmFwdGFnPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2Fw
cyI+SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyB0byBiZSB1c2VkIGFzIHRoZSB3cmFwdGFnLCB3
aXRob3V0IGJyYWNrZXRzPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0
ZD53cmFwdGFnPSZxdW90O3VsJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNs
YXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+
Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGZvciB3cmFwdGFnPC90ZD4KCQkJ
PHRkPmFyY190d2l0dGVyPC90ZD4KCQkJPHRkPmNsYXNzPSZxdW90O3R3aXR0ZXImcXVvdDs8
L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3NfcG9zdGVkPC90ZD4KCQkJPHRkPjxz
cGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4g
Y2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gc3BhbiB0YWcgYXJvdW5kIHBvc3RlZCBkYXRl
PC90ZD4KCQkJPHRkPmFyY190d2l0dGVyLXBvc3RlZDwvdGQ+CgkJPC90cj4KCTwvdGFibGU+
CgoJPGgzPkV4YW1wbGUgdXNhZ2U8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXIgdXNl
cj0mcXVvdDtkcm1vbmtleW5pbmphJnF1b3Q7IGxpbWl0PSZxdW90OzUmcXVvdDsgd3JhcHRh
Zz0mcXVvdDt1bCZxdW90OyBicmVhaz0mcXVvdDtsaSZxdW90OyBkYXRlZm9ybWF0PSZxdW90
OyViICVPZSwgJUk6JU0gJXAmcXVvdDsgLyZndDs8L3A+CgoJPHA+UHJvZHVjZXMgYSBidWxs
ZXQgcG9pbnQgbGlzdCBvZiB0aGUgbGFzdCA1IFR3aXR0ZXIgdXBkYXRlcyBmcm9tIGRybW9u
a2V5bmluamEmIzgyMTc7cyBUd2l0dGVyIGZlZWQgd2l0aCBhIGRlZmluZWQgZGF0ZSBmb3Jt
YXQgdG8gb3ZlcnJpZGUgdGhlIGRlZmF1bHQgYXJjaGl2ZSBkYXRlIGZvcm1hdC48L3A+CgoJ
PGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfc2VhcmNoX3RhZyI+VGhlIGFy
Y190d2l0dGVyX3NlYXJjaCB0YWc8L2gyPgoKCTxoMz5TeW50YXg8L2gzPgoKCTxwPiZsdDt0
eHA6YXJjX3R3aXR0ZXJfc2VhcmNoIGhhc2h0YWdzPSZxdW90O3R4cCZxdW90OyAvJmd0Ozwv
cD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8
L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0
aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnNlYXJjaDwvdGQ+CgkJCTx0
ZD5Db21tYSBzZXBhcmF0ZWQgbGlzdCBvZiBzZWFyY2ggd29yZHM8L3RkPgoJCQk8dGQ+IDxl
bT51bnNldDwvZW0+PC90ZD4KCQkJPHRkPnNlYXJjaD0mcXVvdDt0eHAsdGV4dHBhdHRlcm4m
cXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aGFzaHRhZ3M8L3RkPgoJCQk8dGQ+
Q29tbWEgc2VwYXJhdGVkIGxpc3Qgb2YgaGFzaHRhZ3MgdG8gc2VhcmNoIGZvciAobm90IGlu
Y2x1ZGluZyB0aGUgaGFzaCk8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJ
PHRkPmhhc2h0YWdzPSZxdW90O3R4cCx0ZXh0cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4K
CQk8dHI+CgkJCTx0ZD5yZXBseTwvdGQ+CgkJCTx0ZD5Vc2VybmFtZSBvZiB0d2VldHMgaW4g
cmVwbHkgdG88L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJPHRkPnJlcGx5
PSZxdW90O3R3aXR0ZXImcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bWVudGlv
bjwvdGQ+CgkJCTx0ZD5Vc2VybmFtZSBvZiB1c2VyIG1lbnRpb25lZCBpbiB0d2VldHMgKDxp
PmkuZS48L2k+IHR3ZWV0cyBjb250YWluaW5nIEB1c2VybmFtZSk8L3RkPgoJCQk8dGQ+IDxl
bT51bnNldDwvZW0+PC90ZD4KCQkJPHRkPm1lbnRpb249JnF1b3Q7dHdpdHRlciZxdW90Ozwv
dGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5saW1pdDwvdGQ+CgkJCTx0ZD5NYXhpbXVtIG51
bWJlciBvZiB0d2VldHMgdG8gZGlzcGxheSAobWF4LiAyMDApPC90ZD4KCQkJPHRkPjEwPC90
ZD4KCQkJPHRkPmxpbWl0PSZxdW90OzI1JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJ
PHRkPmRhdGVmb3JtYXQ8L3RkPgoJCQk8dGQ+Rm9ybWF0IHRoYXQgdXBkYXRlIGRhdGVzIHdp
bGwgYXBwZWFyIGFzPC90ZD4KCQkJPHRkPiA8ZW0+QXJjaGl2ZSBkYXRlIGZvcm1hdDwvZW0+
PC90ZD4KCQkJPHRkPmRhdGVmb3JtYXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAlcCZxdW90Ozwv
dGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbDwvdGQ+CgkJCTx0ZD5MYWJlbCBmb3Ig
dGhlIHRvcCBvZiB0aGUgbGlzdDwvdGQ+CgkJCTx0ZD4gPGVtPm5vIGxhYmVsPC9lbT48L3Rk
PgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFiZWx0YWc8L3RkPgoJCQk8dGQ+SW5kZXBlbmRl
bnQgd3JhcHRhZyBmb3IgbGFiZWw8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPmJyZWFrPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJj
YXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyAod2l0aG91
dCBicmFja2V0cyksIG9yIHN0cmluZywgdXNlZCB0byBzZXBhcmF0ZSB0aGUgdXBkYXRlczwv
dGQ+CgkJCTx0ZD5saTwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD53cmFwdGFnPC90ZD4K
CQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+SFRNTDwvc3Bh
bj48L3NwYW4+IHRhZyB0byBiZSB1c2VkIGFzIHRoZSB3cmFwdGFnLCB3aXRob3V0IGJyYWNr
ZXRzPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJ
CTx0ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9
ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBmb3Igd3JhcHRhZzwv
dGQ+CgkJCTx0ZD5hcmNfdHdpdHRlcl9zZWFyY2g8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8
dGQ+Y2xhc3NfdXNlcjwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xh
c3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRv
IHNwYW4gdGFnIGFyb3VuZCB1c2VyIG5hbWU8L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXItdXNl
cjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzc19wb3N0ZWQ8L3RkPgoJCQk8dGQ+
PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFu
PiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byBzcGFuIHRhZyBhcm91bmQgcG9zdGVkIGRh
dGU8L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXItcG9zdGVkPC90ZD4KCQk8L3RyPgoJPC90YWJs
ZT4KCgk8aDM+RXhhbXBsZSB1c2FnZTwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl9z
ZWFyY2ggc2VhcmNoPSZxdW90O3BsdWdpbiZxdW90OyBoYXNodGFncz0mcXVvdDt0eHAsdGV4
dHBhdHRlcm4mcXVvdDsgbGltaXQ9JnF1b3Q7MjUmcXVvdDsgLyZndDs8L3A+CgoJPHA+UHJv
ZHVjZXMgYSBsaXN0IG9mIHR3ZWV0cyBjb250YWluaW5nIHRoZSB3b3JkICYjODIxNjtwbHVn
aW4mIzgyMTc7IGFuZCB0aGUgaGFzaHRhZ3MgJiM4MjE2OyN0eHAmIzgyMTc7IGFuZCAmIzgy
MTY7I3RleHRwYXR0ZXJuJiM4MjE3Oy4gVGhlIHRhZyB3aWxsIHJldHVybiBhIG1heGltdW0g
b2YgMjUgdHdlZXRzLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRl
cl9yZXR3ZWV0X3RhZyI+VGhlIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbiB0YWc8L2gyPgoK
CTxwPk91dHB1dHMgdGhlIFR3aXR0ZXIgdHdlZXQgYnV0dG9uIChmb3JtZXJseSAmbHQ7dHhw
OmFyY190d2l0dGVyX3JldHdlZXQgLyZndDspLjwvcD4KCgk8aDM+U3ludGF4PC9oMz4KCgk8
cD4mbHQ7dHhwOmFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbiAvJmd0OzwvcD4KCgk8aDM+VXNh
Z2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+
RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90
aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVzZXI8L3RkPgoJCQk8dGQ+VHdpdHRlciB1c2Vy
IG5hbWUgdG8gcXVvdGU8L3RkPgoJCQk8dGQ+IDxlbT5hcmNfdHdpdHRlciB1c2VybmFtZTwv
ZW0+PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZxdW90OzwvdGQ+CgkJ
PC90cj4KCQk8dHI+CgkJCTx0ZD51cmw8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMi
PjxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+PC9zcGFuPiB0byB0d2VldDwvdGQ+CgkJ
PC90cj4KCQk8dHI+CgkJCTx0ZD50ZXh0PC90ZD4KCQkJPHRkPlR3ZWV0IHRleHQ8L3RkPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+Zm9sbG93MTwvdGQ+CgkJCTx0ZD5TdWdnZXN0ZWQgVHdp
dHRlciBhY2NvdW50IHRvIGZvbGxvdywgZm9yIGV4YW1wbGUgeW91ciBvd248L3RkPgoJCQk8
dGQ+QSBUd2l0dGVyIHVzZXIgdG8gcmVjb21tZW5kPC90ZD4KCQkJPHRkPmZvbGxvdzE9JnF1
b3Q7VGV4dHBhdHRlcm4mcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Zm9sbG93
MjwvdGQ+CgkJCTx0ZD5BcyBmb2xsb3cxPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwv
dGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYW5nPC90ZD4KCQkJPHRkPkxhbmd1YWdlPC90
ZD4KCQkJPHRkPmVuPC90ZD4KCQkJPHRkPmxhbmc9JnF1b3Q7ZXMmcXVvdDs8L3RkPgoJCTwv
dHI+CgkJPHRyPgoJCQk8dGQ+Y291bnQ8L3RkPgoJCQk8dGQ+Q291bnQgYm94IHBvc2l0aW9u
LCBvcHRpb25zOiBub25lLCBob3Jpem9udGFsIG9yIHZlcnRpY2FsPC90ZD4KCQkJPHRkPmhv
cml6b250YWw8L3RkPgoJCQk8dGQ+Y291bnQ9JnF1b3Q7bm9uZSZxdW90OzwvdGQ+CgkJPC90
cj4KCQk8dHI+CgkJCTx0ZD5pbmNsdWRlX2pzPC90ZD4KCQkJPHRkPldoZXRoZXIgb3Igbm90
IHRvIGluY2x1ZGUgdGhlIHdpZGdldCBKYXZhU2NyaXB0PC90ZD4KCQkJPHRkPjE8L3RkPgoJ
CQk8dGQ+aW5jbHVkZV9qcz0mcXVvdDswJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJ
PHRkPm9wdGltaXNlX2pzPC90ZD4KCQkJPHRkPk9wdGltaXNlIHRoZSBKYXZhU2NyaXB0IGJ5
IHVzaW5nIGEgbG9jYWwgc2NyaXB0IHJhdGhlciB0aGFuIHRoYXQgaG9zdGVkIG9uIHRoZSBU
d2l0dGVyIHNpdGU8L3RkPgoJCQk8dGQ+MDwvdGQ+CgkJCTx0ZD5vcHRpbWlzZV9qcz0mcXVv
dDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRk
PjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bh
bj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gdGhlIHR3ZWV0IGJ1dHRvbjwvdGQ+CgkJ
CTx0ZD50d2l0dGVyLXNoYXJlLWJ1dHRvbjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPGgy
IGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfZm9sbG93X2J1dHRvbl90YWciPlRo
ZSBhcmNfdHdpdHRlcl9mb2xsb3dfYnV0dG9uIHRhZzwvaDI+CgoJPHA+T3V0cHV0cyB0aGUg
VHdpdHRlciBmb2xsb3cgYnV0dG9uIChhbiBhbHRlcm5hdGl2ZSB2ZXJzaW9uIGlzIGluY2x1
ZGVkIGluIGFyY190d2l0dGVyX2ludGVudHMpLjwvcD4KCgk8aDM+U3ludGF4PC9oMz4KCgk8
cD4mbHQ7dHhwOmFyY190d2l0dGVyX2ZvbGxvd19idXR0b24gLyZndDs8L3A+CgoJPGgzPlVz
YWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJPHRo
PkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBsZTwv
dGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD51c2VyPC90ZD4KCQkJPHRkPlR3aXR0ZXIgdXNl
ciBuYW1lIHRvIGZvbGxvdzwvdGQ+CgkJCTx0ZD4gPGVtPmFyY190d2l0dGVyIHVzZXJuYW1l
PC9lbT48L3RkPgoJCQk8dGQ+dXNlcj0mcXVvdDtkcm1vbmtleW5pbmphJnF1b3Q7PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhbmc8L3RkPgoJCQk8dGQ+TGFuZ3VhZ2U8L3RkPgoJ
CQk8dGQ+ZW48L3RkPgoJCQk8dGQ+bGFuZz0mcXVvdDtlcyZxdW90OzwvdGQ+CgkJPC90cj4K
CQk8dHI+CgkJCTx0ZD5jb3VudDwvdGQ+CgkJCTx0ZD5XaGV0aGVyIG9yIG5vdCB0aGUgZm9s
bG93ZXIgY291bnQgaXMgc2hvd248L3RkPgoJCQk8dGQ+MTwvdGQ+CgkJCTx0ZD5jb3VudD0m
cXVvdDswJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmluY2x1ZGVfanM8L3Rk
PgoJCQk8dGQ+V2hldGhlciBvciBub3QgdG8gaW5jbHVkZSB0aGUgd2lkZ2V0IEphdmFTY3Jp
cHQ8L3RkPgoJCQk8dGQ+MTwvdGQ+CgkJCTx0ZD5pbmNsdWRlX2pzPSZxdW90OzAmcXVvdDs8
L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+b3B0aW1pc2VfanM8L3RkPgoJCQk8dGQ+T3B0
aW1pc2UgdGhlIEphdmFTY3JpcHQgYnkgdXNpbmcgYSBsb2NhbCBzY3JpcHQgcmF0aGVyIHRo
YW4gdGhhdCBob3N0ZWQgb24gdGhlIFR3aXR0ZXIgc2l0ZTwvdGQ+CgkJCTx0ZD4wPC90ZD4K
CQkJPHRkPm9wdGltaXNlX2pzPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJ
CQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNz
PSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byB0
aGUgZm9sbG93IGJ1dHRvbjwvdGQ+CgkJCTx0ZD50d2l0dGVyLWZvbGxvdy1idXR0b248L3Rk
PgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0
dGVyX3R3ZWV0X3VybCI+YXJjX3R3aXR0ZXJfdHdlZXRfdXJsPC9oMj4KCgk8cD5SZXR1cm5z
IHRoZSA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPiBvZiB0aGUgVHdpdHRlciBzdGF0
dXMgZm9yIGFuIGFydGljbGUuPC9wPgoKCTxoMz5TeW50YXg8L2gzPgoKCTxwPiZsdDt0eHA6
YXJjX3R3aXR0ZXJfdHdlZXRfdXJsIC8mZ3Q7PC9wPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0
ZXJfdHdlZXRfdXJsJmd0O0xpbmsgdGV4dCZsdDsvdHhwOmFyY190d2l0dGVyX3R3ZWV0X3Vy
bCZndDs8L3A+CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0
cmlidXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3Ro
PgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5pZDwvdGQ+CgkJ
CTx0ZD5UZXh0cGF0dGVybiBhcnRpY2xlIElEPC90ZD4KCQkJPHRkPiA8ZW0+Y3VycmVudCBh
cnRpY2xlPC9lbT48L3RkPgoJCQk8dGQ+aWQ9JnF1b3Q7MSZxdW90OzwvdGQ+CgkJPC90cj4K
CQk8dHI+CgkJCTx0ZD50aXRsZTwvdGQ+CgkJCTx0ZD5UaXRsZSBhdHRyaWJ1dGUgb2YgdGhl
IGxpbms8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4K
CQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFz
cz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8g
dGhlIGxpbms8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJPC90
YWJsZT4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl90aW55dXJsIj5h
cmNfdHdpdHRlcl90aW55dXJsPC9oMj4KCgk8cD5SZXR1cm5zIHRoZSBzaG9ydGVuZWQgPHNw
YW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4gb2YgdGhlIGFydGljbGUgdXNlZCBmb3IgdGhl
IFR3aXR0ZXIgdXBkYXRlLjwvcD4KCgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFy
Y190d2l0dGVyX3Rpbnl1cmwgLyZndDs8L3A+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl90
aW55dXJsJmd0O0xpbmsgdGV4dCZsdDsvdHhwOmFyY190d2l0dGVyX3Rpbnl1cmwmZ3Q7PC9w
PgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwv
dGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRo
PkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aWQ8L3RkPgoJCQk8dGQ+VGV4
dHBhdHRlcm4gYXJ0aWNsZSBJRDwvdGQ+CgkJCTx0ZD4gPGVtPmN1cnJlbnQgYXJ0aWNsZTwv
ZW0+PC90ZD4KCQkJPHRkPmlkPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJ
CQk8dGQ+dGl0bGU8L3RkPgoJCQk8dGQ+VGl0bGUgYXR0cmlidXRlIG9mIHRoZSBsaW5rPC90
ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5j
bGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMi
PkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHRoZSBsaW5r
PC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJ
PGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfY2FjaGluZyI+Q2FjaGluZzwv
aDI+CgoJPHA+SW4gb3JkZXIgdG8gcHJldmVudCBleGNlc3NpdmUgcmVwZWF0aXRpdmUgY2Fs
bHMgdG8gdGhlIFR3aXR0ZXIgd2Vic2l0ZSBpdCBpcyByZWNvbW1lbmRlZCB0byBjYWNoZSBy
ZXN1bHRzLiBUd2l0dGVyIGxpbWl0cyB0aGUgbnVtYmVyIG9mIGNhbGxzIHRocm91Z2ggdGhl
IDxzcGFuIGNsYXNzPSJjYXBzIj5BUEk8L3NwYW4+LCBhbmQgY29udGludW91cyBjYWxscyB3
aWxsIHJlc3VsdCBpbiBUd2l0dGVyIGNsb3NpbmcgdG8gZnVydGhlciByZXF1ZXN0cy4gQnkg
ZGVmYXVsdCwgYXJjX3R3aXR0ZXIgY2FjaGVzIGZvciAzMCBtaW51dGUgaW50ZXJ2YWxzLjwv
cD4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJPHRoPkRlc2Ny
aXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJ
PC90cj4KCQk8dHI+CgkJCTx0ZD5jYWNoaW5nPC90ZD4KCQkJPHRkPiYjODIxNjsxJiM4MjE3
OyB0byBjYWNoZSBmZWVkLCAmIzgyMTY7MCYjODIxNzsgdG8gdHVybiBjYWNoaW5nIG9mZiAo
bm90IHJlY29tbWVuZGVkKTwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQkJPHRkPmNhY2hpbmc9JnF1
b3Q7MSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jYWNoZV9kaXI8L3RkPgoJ
CQk8dGQ+QWJzb2x1dGUgcGF0aCB0byB0aGUgY2FjaGUgZGlyZWN0b3J5IChtdXN0IGJlIHdy
aXRhYmxlKTwvdGQ+CgkJCTx0ZD4gPGVtPmFyY190d2l0dGVyIHByZWZlcmVuY2VzPC9lbT48
L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2FjaGVfdGltZTwvdGQ+CgkJCTx0ZD5UaW1l
IGluIG1pbnV0ZXMgdGhhdCB0aGUgY2FjaGUgZmlsZXMgYXJlIHN0b3JlZCBiZWZvcmUgYmVp
bmcgcmVmcmVzaGVkPC90ZD4KCQkJPHRkPjU8L3RkPgoJCQk8dGQ+Y2FjaGVfdGltZT0mcXVv
dDszMCZxdW90OzwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPHA+VGhlIGFkbWluIHNpZGUg
b2YgdGhpcyBwbHVnaW4gZW5mb3JjZXMgY2FjaGluZywgYXBhcnQgZnJvbSB3aGVuIGl0IGlz
IHBvc3RpbmcgdG8gVHdpdHRlciAoPGk+ZS5nLjwvaT4gd2hlbiBwb3N0aW5nIG9yIGRlbGV0
aW5nIGFuIHVwZGF0ZSkuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0
dGVyX3ByZWZzIj5QcmVmZXJlbmNlczwvaDI+CgoJPHA+WW91IGNhbiBhY2Nlc3MgdGhlIHBs
dWdpbnMgY29yZSBwcmVmZXJlbmNlcyBmcm9tIGVpdGhlciB0aGUgUHJlZmVyZW5jZXMgb3Ig
UGx1Z2lucyB0YWJzIGluIGFkbWluLiBTZXR1cCB5b3VyIFR3aXR0ZXIgYWNjb3VudCAoeW91
IHdpbGwgYmUgYXNrZWQgdG8gY29ubmVjdCB2aWEgVHdpdHRlciBhbmQgdGhpcyBuZWVkcyBk
b2luZyBiZWZvcmUgeW91IGNhbiB1c2UgdGhlIHBsdWdpbikgYW5kIGNoYW5nZSB0aGUgY2Fj
aGUgZGlyZWN0b3J5IHVzaW5nIGFyY190d2l0dGVyJiM4MjE3O3MgcHJlZmVyZW5jZXMuIFdp
dGhvdXQgcHJvdmlkaW5nIHlvdXIgYWNjb3VudCBsb2dpbiBkZXRhaWxzIHRoZSBhZG1pbiBh
cmVhIGZlYXR1cmVzIG9mIHRoaXMgcGx1Z2luIHdpbGwgYmUgaW5hY3RpdmUuPC9wPgoKCTxw
PllvdSBjYW4gc2VsZWN0IHRoZSA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPiBzaG9y
dGVuZXIgbWV0aG9kIHlvdSB3YW50IHRvIHVzZSB0byBsaW5rIGJhY2sgdG8geW91ciBhcnRp
Y2xlIG9uIFR3aXR0ZXIuIFBsZWFzZSBub3RlIHRoYXQgaWYgeW91IHNlbGVjdCBzbWRfc2hv
cnRfdXJsIHlvdSB3aWxsIG5lZWQgdG8gaGF2ZSBpbnN0YWxsZWQgYW5kIGFjdGl2YXRlZCB0
aGUgPGEgaHJlZj0iaHR0cDovL3RleHRwYXR0ZXJuLm9yZy9wbHVnaW5zLzEwOTkvc21kX3No
b3J0X3VybCI+PHNwYW4gY2xhc3M9InRhZyI+c21kX3Nob3J0X3VybDwvc3Bhbj4gcGx1Z2lu
PC9hPiBkZXZlbG9wZWQgYnkgU3RlZiBEYXdzb24uPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlv
biIgaWQ9ImFyY190d2l0dGVyX2FydGljbGUiPlR3ZWV0aW5nIGFydGljbGVzPC9oMj4KCgk8
cD5CeSBkZWZhdWx0IGFyY190d2l0dGVyIHdpbGwgcG9zdCBhbiB1cGRhdGUgdG8gVHdpdHRl
ciBpbmNsdWRpbmcgYSBzaG9ydGVuZWQgPHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4g
dG8geW91ciBhcnRpY2xlLiBPbmx5IGxpdmUgYW5kIGFjdGl2ZSBhcnRpY2xlcyB3aWxsIGJl
IHNlbnQgdG8gVHdpdHRlciwgPGk+aS5lLjwvaT4gYXJ0aWNsZXMgcG9zdGVkIGluIHRoZSBm
dXR1cmUgb3IgYXMgc3RpY2t5IGFydGljbGVzIHdpbGwgbm90IGJlIHNlbnQuIElmIHlvdXIg
YXJ0aWNsZSBpcyBzdWNjZXNzZnVsbHkgc3VibWl0dGVkIHRvIFR3aXR0ZXIgdGhlIHVwZGF0
ZSB3aWxsIGFwcGVhciBpbiBwbGFjZSBvZiB0aGUgVHdpdHRlciBvcHRpb24gb24gdGhlIHJp
Z2h0LWhhbmQtc2lkZSBvZiB0aGUgYXJ0aWNsZSBlZGl0IHNjcmVlbi48L3A+CgoJPHA+VHdl
ZXRzIGFyZSBzZW50IGluIHRoZSBmb2xsb3dpbmcgZm9ybWF0OiA8ZW0+VHdlZXQgcHJlZml4
PC9lbT4gPGVtPkFydGljbGUgdGl0bGU8L2VtPiA8ZW0+U2hvcnRlbmVkIDxzcGFuIGNsYXNz
PSJjYXBzIj5VUkw8L3NwYW4+PC9lbT4gPGVtPlR3ZWV0IHN1ZmZpeDwvZW0+LiBZb3UgY2Fu
IGNoYW5nZSB0aGUgcHJlZml4IGFuZCBzdWZmaXggb24gYW4gYXJ0aWNsZS1ieS1hcnRpY2xl
IGJhc2lzIGJ5IGNoYW5naW5nIHRoZSB0d2VldCBvcHRpb25zIHVuZGVyICYjODIxNjtVcGRh
dGUgVHdpdHRlciYjODIxNzsgb24gdGhlIGFydGljbGUgZWRpdG9yIHNjcmVlbi4gVGhlIGRl
ZmF1bHQgPGVtPlR3ZWV0IHByZWZpeDwvZW0+IGNhbiBiZSBzZXQgdW5kZXIgdGhlIDxzcGFu
IGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiBwcmVmZXJlbmNlcyBzY3JlZW4gKHRo
ZSBkZWZhdWx0IG9uIGluc3RhbGxhdGlvbiBpcyAmIzgyMjA7SnVzdCBwb3N0ZWQ6JiM4MjIx
OykuPC9wPgoKCTxwPlBsZWFzZSBub3RlIHRoYXQgb25jZSBhbiBhcnRpY2xlIGhhcyBiZWVu
IHR3ZWV0ZWQgdGhlIHR3ZWV0IGNhbm5vdCBiZSBlZGl0ZWQuPC9wPgoKCTxoMiBjbGFzcz0i
c2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX2FkbWluIj5UaGUgVHdpdHRlciB0YWI8L2gyPgoK
CTxwPlVuZGVyIHRoZSBFeHRlbnNpb25zIHRhYiAodGhpcyBjYW4gYmUgY2hhbmdlZCBmcm9t
IHRoZSBwbHVnaW4mIzgyMTc7cyBwcmVmZXJlbmNlIHBhZ2UpIGEgbmV3IFR3aXR0ZXIgdGFi
IHNob3VsZCBhcHBlYXIgb25jZSB5b3UgaGF2ZSBjb25uZWN0ZWQgeW91ciBzaXRlIHRvIHlv
dXIgVHdpdHRlciBhY2NvdW50LiBGcm9tIGhlcmUgeW91IHdpbGwgYmUgYWJsZSB0byBzdWJt
aXQgbmV3IFR3aXR0ZXIgdXBkYXRlcywgdmlldyBiYXNpYyBhY2NvdW50IHN0YXRpc3RpY3Ms
IGFuZCBjaGVjayBvdXQgeW91ciByZWNlbnQgdXBkYXRlcyAoaW5jbHVkaW5nIHRoZSBvcHRp
b24gdG8gZGVsZXRlIHlvdXIgdHdlZXRzKS48L3A+IjtzOjQ6ImNvZGUiO3M6NzU2ODQ6Imds
b2JhbCAkcHJlZnMsJHR4cGNmZywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksJGFyY190d2l0
dGVyX2NvbnN1bWVyU2VjcmV0OwoKJGFyY190d2l0dGVyID0gYXJyYXkoKTsKCiRhcmNfdHdp
dHRlcl9jb25zdW1lcktleSA9ICduS2NYc2x3elpoQmQwa2ZLTWV0blBBJzsKJGFyY190d2l0
dGVyX2NvbnN1bWVyU2VjcmV0ID0gJ0M2blNQQ0wzZWVIR1RCaEtDZ3dkOW9jbGN1RDBzckI4
V1ZrZlhRWUM1NCc7CgphZGRfcHJpdnMoJ3BsdWdpbl9wcmVmcy5hcmNfdHdpdHRlcicsJzEs
MicpOwpyZWdpc3Rlcl9jYWxsYmFjaygnYXJjX3R3aXR0ZXJfaW5zdGFsbCcsJ3BsdWdpbl9s
aWZlY3ljbGUuYXJjX3R3aXR0ZXInLCAnaW5zdGFsbGVkJyk7CnJlZ2lzdGVyX2NhbGxiYWNr
KCdhcmNfdHdpdHRlcl91bmluc3RhbGwnLCdwbHVnaW5fbGlmZWN5Y2xlLmFyY190d2l0dGVy
JywgJ2RlbGV0ZWQnKTsKcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY190d2l0dGVyX3ByZWZzJywn
cGx1Z2luX3ByZWZzLmFyY190d2l0dGVyJyk7CgovKgogKiBTZXR1cCBpbml0aWFsIHByZWZl
cmVuY2VzIGlmIG5vdCBpbiB0aGUgdHhwX3ByZWZzIHRhYmxlLgogKi8KaWYgKCFpc3NldCgk
cHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSkpCiAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJf
dXNlcicsICcnLCAnYXJjX3R3aXR0ZXInLCAxLCAndGV4dF9pbnB1dCcpOwppZiAoIWlzc2V0
KCRwcmVmc1snYXJjX3R3aXR0ZXJfcHJlZml4J10pKQogIHNldF9wcmVmKCdhcmNfdHdpdHRl
cl9wcmVmaXgnLCdKdXN0IHBvc3RlZDonLCAnYXJjX3R3aXR0ZXInLCAyLCAndGV4dF9pbnB1
dCcpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfc3VmZml4J10pKQogIHNldF9w
cmVmKCdhcmNfdHdpdHRlcl9zdWZmaXgnLCcnLCAnYXJjX3R3aXR0ZXInLCAyLCAndGV4dF9p
bnB1dCcpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10pKQog
IHNldF9wcmVmKCdhcmNfdHdpdHRlcl9jYWNoZV9kaXInLCR0eHBjZmdbJ3R4cGF0aCddLiRw
cmVmc1sndGVtcGRpciddLCAnYXJjX3R3aXR0ZXInLCAxLCAndGV4dF9pbnB1dCcpOwppZiAo
IWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCddKSkKICBzZXRfcHJl
ZignYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcsIDEsICdhcmNfdHdpdHRlcicsIDIsICd5
ZXNub1JhZGlvJyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl91cmxfbWV0aG9k
J10pKQogIHNldF9wcmVmKCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJywgJ3Rpbnl1cmwnLCAn
YXJjX3R3aXR0ZXInLCAyLAogICAgJ2FyY190d2l0dGVyX3VybF9tZXRob2Rfc2VsZWN0Jyk7
CmlmICghaXNzZXQoJHByZWZzWydhcmNfc2hvcnRfdXJsJ10pKQogIHNldF9wcmVmKCdhcmNf
c2hvcnRfdXJsJywgMCwgJ2FyY190d2l0dGVyJywgMiwgJ3llc25vUmFkaW8nKTsKaWYgKCFp
c3NldCgkcHJlZnNbJ2FyY19zaG9ydF9zaXRlX3VybCddKSkKICBzZXRfcHJlZignYXJjX3No
b3J0X3NpdGVfdXJsJywgJHByZWZzWydzaXRldXJsJ10sICdhcmNfdHdpdHRlcicsIDIsICd0
ZXh0X2lucHV0Jyk7Ci8vIE1ha2Ugc3VyZSB0aGF0IHRoZSBUd2l0dGVyIHRhYiBoYXMgYmVl
biBkZWZpbmVkCmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl90YWInXSkpIHsKICBz
ZXRfcHJlZignYXJjX3R3aXR0ZXJfdGFiJywgJ2V4dGVuc2lvbnMnLCAnYXJjX3R3aXR0ZXIn
LCAyLAogICAgJ2FyY190d2l0dGVyX3RhYl9zZWxlY3QnKTsKICAgICRwcmVmc1snYXJjX3R3
aXR0ZXJfdGFiJ10gPSAnZXh0ZW5zaW9ucyc7Cn0KCi8vIENoZWNrIGlmIGFyY19zaG9ydF91
cmwgaXMgZW5hYmxlZAppZiAoKGlzc2V0KCRwcmVmc1snYXJjX3Nob3J0X3VybCddKSYmJHBy
ZWZzWydhcmNfc2hvcnRfdXJsJ10pCnx8IChpc3NldCgkcHJlZnNbJ2FyY19zaG9ydF91cmxf
bWV0aG9kJ10pJiYkcHJlZnNbJ2FyY190d2l0dGVyX3VybF9tZXRob2QnXT09J2FyY190d2l0
dGVyJykpIHsKICByZWdpc3Rlcl9jYWxsYmFjaygnYXJjX3Nob3J0X3VybF9yZWRpcmVjdCcs
ICd0eHBfZGllJywgNDA0KTsKfQoKaWYgKEB0eHBpbnRlcmZhY2UgPT0gJ2FkbWluJykgewog
ICAgaWYgKCFlbXB0eSgkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSkKICAgICAgICAmJiAh
ZW1wdHkoJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddKQogICAgICAgICYmICFl
bXB0eSgkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0J10pICkgewoKICAg
ICAgICBpZiAoJHByZWZzWydhcmNfdHdpdHRlcl90YWInXSkgewogICAgICAgICAgICBhZGRf
cHJpdnMoJ2FyY19hZG1pbl90d2l0dGVyJywgJzEsMiwzLDQnKTsKICAgICAgICAgICAgcmVn
aXN0ZXJfdGFiKCRwcmVmc1snYXJjX3R3aXR0ZXJfdGFiJ10sICdhcmNfYWRtaW5fdHdpdHRl
cicsICdUd2l0dGVyJyk7CiAgICAgICAgICAgIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYWRt
aW5fdHdpdHRlcicsICdhcmNfYWRtaW5fdHdpdHRlcicpOwogICAgICAgIH0KCiAgICAgICAg
cmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hcnRpY2xlX3R3ZWV0JywgJ3BpbmcnKTsKICAgICAg
ICByZWdpc3Rlcl9jYWxsYmFjaygnYXJjX2FydGljbGVfdHdlZXQnLCAnYXJ0aWNsZScsICdl
ZGl0JywgMSk7CiAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hcHBlbmRfdHdpdHRl
cicsICdhcnRpY2xlX3VpJywgJ3N0YXR1cycpOwogICAgfQp9CgovKgogICAgUHVibGljLXNp
ZGUgZnVuY3Rpb25zCiAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09CiovCgpmdW5jdGlvbiBhcmNfdHdpdHRlcigk
YXR0cykKewogIGdsb2JhbCAkcHJlZnMsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJj
X3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgogIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAn
dXNlcicgICAgICA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSwKICAgICdwYXNzd29y
ZCcgID0+ICcnLAogICAgJ3RpbWVsaW5lJyAgPT4gJ3VzZXInLAogICAgJ2xpbWl0JyAgICAg
PT4gJzEwJywKICAgICdyZXR3ZWV0cycgID0+IGZhbHNlLAogICAgJ2RhdGVmb3JtYXQnPT4g
JHByZWZzWydhcmNoaXZlX2RhdGVmb3JtYXQnXSwKICAgICdjYWNoaW5nJyAgID0+ICcxJywK
ICAgICdjYWNoZV9kaXInID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10sCiAg
ICAnY2FjaGVfdGltZSc9PiAnNScsCiAgICAnbGFiZWwnICAgICA9PiAnJywKICAgICdsYWJl
bHRhZycgID0+ICcnLAogICAgJ2JyZWFrJyAgICAgPT4gJ2xpJywKICAgICd3cmFwdGFnJyAg
ID0+ICcnLAogICAgJ2NsYXNzJyAgICAgPT4gX19GVU5DVElPTl9fLAogICAgJ2NsYXNzX3Bv
c3RlZCcgPT4gX19GVU5DVElPTl9fLictcG9zdGVkJwogICAgKSwkYXR0cykpOwoKICAkdHdp
dCA9IG5ldyBhcmNfVHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdp
dHRlcl9jb25zdW1lclNlY3JldCk7CgogIGlmICgkY2FjaGluZykgeyAgLy8gdHVybiBvbiBj
YWNoaW5nLCByZWNvbW1lbmRlZCAoZGVmYXVsdCkKICAgICR0d2l0LT5zZXRDYWNoaW5nKHRy
dWUpOwogICAgJHR3aXQtPmNhY2hlRGlyKCRjYWNoZV9kaXIpOwogICAgJHR3aXQtPmNhY2hl
VGltZSgkY2FjaGVfdGltZSk7CiAgfSBlbHNlIHsgIC8vIHR1cm4gb2ZmIGNhY2hpbmcsIG5v
dCByZWNvbW1lbmRlZCBvdGhlciB0aGFuIGZvciB0ZXN0aW5nCiAgICAkdHdpdC0+c2V0Q2Fj
aGluZyhmYWxzZSk7CiAgfQoKICBzd2l0Y2ggKCR0aW1lbGluZSkgewogICAgY2FzZSAnaG9t
ZSc6IGNhc2UgJ2ZyaWVuZHMnOgogICAgICAkdGltZWxpbmUgPSAnc3RhdHVzZXMvZnJpZW5k
c190aW1lbGluZSc7IGJyZWFrOwogICAgY2FzZSAnbWVudGlvbnMnOgogICAgICAkdGltZWxp
bmUgPSAnc3RhdHVzZXMvbWVudGlvbnMnOyBicmVhazsKICAgIGNhc2UgJ3VzZXInOiBkZWZh
dWx0OiAkdGltZWxpbmUgPSAnc3RhdHVzZXMvdXNlcl90aW1lbGluZSc7CiAgfQoKICAkb3V0
ID0gYXJyYXkoKTsKICAkeG1sID0gJHR3aXQtPmdldCgkdGltZWxpbmUKICAgICwgYXJyYXko
J3NjcmVlbl9uYW1lJz0+JHVzZXIsJ2NvdW50Jz0+JGxpbWl0LCdpbmNsdWRlX3J0cyc9PiRy
ZXR3ZWV0cykpOwogIGlmICgkeG1sKSB7CiAgICAkdHdlZXRzID0gQCR4bWwtPnhwYXRoKCcv
c3RhdHVzZXMvc3RhdHVzJyk7CiAgICBpZiAoJHR3ZWV0cykgZm9yZWFjaCAoJHR3ZWV0cyBh
cyAkdHdlZXQpIHsKICAgICAgJHRpbWUgPSBzdHJ0b3RpbWUoaHRtbGVudGl0aWVzKCR0d2Vl
dC0+Y3JlYXRlZF9hdCkpOwogICAgICAkZGF0ZSA9IHNhZmVfc3RyZnRpbWUoJGRhdGVmb3Jt
YXQsJHRpbWUpOwogICAgICAkb3V0W10gPSBhcmNfVHdpdHRlcjo6bWFrZUxpbmtzKGh0bWxl
bnRpdGllcygkdHdlZXQtPnRleHQsIEVOVF9RVU9URVMsJ1VURi04JykpCiAgICAgICAgLicg
Jy50YWcoaHRtbGVudGl0aWVzKCRkYXRlKSwnc3BhbicsJyBjbGFzcz0iJy4kY2xhc3NfcG9z
dGVkLiciJyk7CiAgICB9CgogICAgcmV0dXJuIGRvTGFiZWwoJGxhYmVsLCAkbGFiZWx0YWcp
LmRvV3JhcCgkb3V0LCAkd3JhcHRhZywgJGJyZWFrLCAkY2xhc3MpOwogIH0KCn0KCmZ1bmN0
aW9uIGFyY190d2l0dGVyX3NlYXJjaCgkYXR0cykKewogICAgZ2xvYmFsICRwcmVmcywkYXJj
X3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiAg
ICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAgICd1c2VyJyAgICAgID0+ICRwcmVmc1sn
YXJjX3R3aXR0ZXJfdXNlciddLAogICAgICAgICdzZWFyY2gnICAgID0+ICcnLAogICAgICAg
ICdoYXNodGFncycgID0+ICcnLAogICAgICAgICd1c2VyJyAgICAgID0+ICcnLAogICAgICAg
ICdyZXBseScgICAgID0+ICcnLAogICAgICAgICdtZW50aW9uJyAgID0+ICcnLAogICAgICAg
ICdsaW1pdCcgICAgID0+ICcxMCcsCiAgICAgICAgJ2xhbmcnICAgICAgPT4gJycsCiAgICAg
ICAgJ2RhdGVmb3JtYXQnPT4gJHByZWZzWydhcmNoaXZlX2RhdGVmb3JtYXQnXSwKICAgICAg
ICAnY2FjaGluZycgICA9PiAnMScsCiAgICAgICAgJ2NhY2hlX2RpcicgPT4gJHByZWZzWydh
cmNfdHdpdHRlcl9jYWNoZV9kaXInXSwKICAgICAgICAnY2FjaGVfdGltZSc9PiAnNScsCiAg
ICAgICAgJ2xhYmVsJyAgICAgPT4gJycsCiAgICAgICAgJ2xhYmVsdGFnJyAgPT4gJycsCiAg
ICAgICAgJ2JyZWFrJyAgICAgPT4gJ2xpJywKICAgICAgICAnd3JhcHRhZycgICA9PiAnJywK
ICAgICAgICAnY2xhc3MnICAgICA9PiBfX0ZVTkNUSU9OX18sCiAgICAgICAgJ2NsYXNzX3Bv
c3RlZCcgPT4gX19GVU5DVElPTl9fLictcG9zdGVkJywKICAgICAgICAnY2xhc3NfdXNlcicg
ICA9PiBfX0ZVTkNUSU9OX18uJy11c2VyJwogICAgKSwkYXR0cykpOwoKICAgICAgICAkdHdp
dCA9IG5ldyBhcmNfVHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAg
ICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQpOwoKICAgICAgICBpZiAoJGNhY2hp
bmcpIHsgIC8vIHR1cm4gb24gY2FjaGluZywgcmVjb21tZW5kZWQgKGRlZmF1bHQpCiAgICAg
ICAgICAgICR0d2l0LT5zZXRDYWNoaW5nKHRydWUpOwogICAgICAgICAgICAkdHdpdC0+Y2Fj
aGVEaXIoJGNhY2hlX2Rpcik7CiAgICAgICAgICAgICR0d2l0LT5jYWNoZVRpbWUoJGNhY2hl
X3RpbWUpOwogICAgICAgIH0gZWxzZSB7ICAvLyB0dXJuIG9mZiBjYWNoaW5nLCBub3QgcmVj
b21tZW5kZWQgb3RoZXIgdGhhbiBmb3IgdGVzdGluZwogICAgICAgICAgICAkdHdpdC0+c2V0
Q2FjaGluZyhmYWxzZSk7CiAgICAgICAgfQoKICAgICAgICAvLyBjb25zdHJ1Y3Qgc2VhcmNo
IHF1ZXJ5CiAgICAgICAgaWYgKCFlbXB0eSgkc2VhcmNoKSkgewogICAgICAgICAgICAkdGVy
bXMgPSBleHBsb2RlKCcsJywkc2VhcmNoKTsgJHRlcm1zID0gYXJyYXlfbWFwKCd0cmltJywk
dGVybXMpOwogICAgICAgICAgICAkc2VhcmNoID0gaW1wbG9kZSgnICcsJHRlcm1zKTsKICAg
ICAgICB9CiAgICAgICAgaWYgKCRoYXNodGFncykgewogICAgICAgICAgICAkaGFzaGVzID0g
ZXhwbG9kZSgnLCcsJGhhc2h0YWdzKTsgJGhhc2hlcyA9IGFycmF5X21hcCgndHJpbScsJGhh
c2hlcyk7CiAgICAgICAgICAgICRzZWFyY2guPSAoKCRzZWFyY2gpPycgJzonJykuJyMnLmlt
cGxvZGUoJyAjJywkaGFzaGVzKTsKICAgICAgICB9CiAgICAgICAgaWYgKCRyZXBseSkgewog
ICAgICAgICAgICAkc2VhcmNoLj0gKCgkc2VhcmNoKT8nICc6JycpLid0bzonLnRyaW0oJHJl
cGx5KTsKICAgICAgICB9CiAgICAgICAgaWYgKCR1c2VyKSB7CiAgICAgICAgICAgICRzZWFy
Y2guPSAoKCRzZWFyY2gpPycgJzonJykuJ2Zyb206Jy50cmltKCR1c2VyKTsKICAgICAgICB9
CiAgICAgICAgaWYgKCRtZW50aW9uKSB7CiAgICAgICAgICAgICRzZWFyY2guPSAoKCRzZWFy
Y2gpPycgJzonJykuJ0AnLnRyaW0oJG1lbnRpb24pOwogICAgICAgIH0KCiAgICAgICAgaWYg
KGVtcHR5KCRzZWFyY2gpKSB7CiAgICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICB9IGVs
c2UgewogICAgICAgICAgICAkc2VhcmNoID0gdXJsZW5jb2RlKCRzZWFyY2gpOwogICAgICAg
IH0KCiAgICAgICAgJG91dCA9IGFycmF5KCk7CiAgICAgICAgJHR3ZWV0cyA9ICR0d2l0LT5n
ZXQoJ2h0dHA6Ly9zZWFyY2gudHdpdHRlci5jb20vc2VhcmNoLmF0b20/cT0nLiRzZWFyY2gK
ICAgICAgICAgICAgLCBhcnJheSgncnBwJz0+JGxpbWl0LCdsYW5nJz0+JGxhbmcpKTsKCiAg
ICAgICAgaWYgKCR0d2VldHMpIHsgZm9yZWFjaCAoJHR3ZWV0cy0+ZW50cnkgYXMgJHR3ZWV0
KSB7CiAgICAgICAgICAgIHByZWdfbWF0Y2goIi8oLiopIFwoKC4qKVwpLyIsJHR3ZWV0LT5h
dXRob3ItPm5hbWUsJG1hdGNoZXMpOwogICAgICAgICAgICBsaXN0KCRhdXRob3IsJHVuYW1l
LCRuYW1lKSA9ICRtYXRjaGVzOwogICAgICAgICAgICAkdGltZSA9IHN0cnRvdGltZShodG1s
ZW50aXRpZXMoJHR3ZWV0LT5wdWJsaXNoZWQpKTsKICAgICAgICAgICAgJGRhdGUgPSBzYWZl
X3N0cmZ0aW1lKCRkYXRlZm9ybWF0LCR0aW1lKTsKICAgICAgICAgICAgJHRleHQgPSAkdHdl
ZXQtPnRpdGxlOwogICAgICAgICAgICAkb3V0W10gPSB0YWcoaHJlZihodG1sZW50aXRpZXMo
JHVuYW1lKSwkdHdlZXQtPmF1dGhvci0+dXJpLAogICAgICAgICAgICAgICAgJyB0aXRsZT0i
Jy5odG1sZW50aXRpZXMoJG5hbWUpLiciJykuJzogJywnc3BhbicKICAgICAgICAgICAgICAg
ICAgICAsJyBjbGFzcz0iJy4kY2xhc3NfdXNlci4nIicpCiAgICAgICAgICAgICAgICAuYXJj
X1R3aXR0ZXI6Om1ha2VMaW5rcyhodG1sZW50aXRpZXMoJHRleHQsIEVOVF9RVU9URVMsJ1VU
Ri04JykpCiAgICAgICAgICAgICAgICAuJyAnLnRhZyhodG1sZW50aXRpZXMoJGRhdGUpLCdz
cGFuJwogICAgICAgICAgICAgICAgICAgICwnIGNsYXNzPSInLiRjbGFzc19wb3N0ZWQuJyIn
KTsKICAgICAgICB9IHJldHVybiBkb0xhYmVsKCRsYWJlbCwgJGxhYmVsdGFnKQogICAgICAg
ICAgICAuZG9XcmFwKCRvdXQsICR3cmFwdGFnLCAkYnJlYWssICRjbGFzcyk7IH0KCn0KCmZ1
bmN0aW9uIGFyY190d2l0dGVyX3R3ZWV0KCRhdHRzKSB7CiAgICBnbG9iYWwgJHRoaXNhcnRp
Y2xlOwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICdpZCcgICAgICAgID0+ICR0
aGlzYXJ0aWNsZVsndGhpc2lkJ10sCiAgICAgICdpbmNsdWRlX3VybCcgICA9PiB0cnVlCiAg
ICApLCRhdHRzKSk7CgogICAgaWYgKCRpZCkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRl
ciBzdHVmZiB0byBidWlsZCB0d2VldCBmcm9tCiAgICAgICR0d2VldCA9ICgkaW5jbHVkZV91
cmwpID8gc2FmZV9yb3coInR3ZWV0IiwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRp
ZH0iKQogICAgICAgIDogc2FmZV9yb3coIlJFUExBQ0UodHdlZXQsQ09OQ0FUKCcgJyx0aW55
dXJsKSwnJykgQVMgdHdlZXQiCiAgICAgICAgICAsICdhcmNfdHdpdHRlcicsICJhcnRpY2xl
X2lkPXskaWR9Iik7CiAgICB9CgogICAgaWYgKCR0d2VldFsndHdlZXQnXSkgewogICAgICBy
ZXR1cm4gYXJjX1R3aXR0ZXI6Om1ha2VMaW5rcygKICAgICAgICBodG1sZW50aXRpZXMoJHR3
ZWV0Wyd0d2VldCddLCBFTlRfUVVPVEVTLCdVVEYtOCcpKTsKICAgIH0KfQoKZnVuY3Rpb24g
YXJjX3R3aXR0ZXJfdHdlZXRfdXJsKCRhdHRzLCAkdGhpbmc9bnVsbCkgewogICAgZ2xvYmFs
ICR0aGlzYXJ0aWNsZSwkcHJlZnM7CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAg
J2lkJyAgICAgID0+ICR0aGlzYXJ0aWNsZVsndGhpc2lkJ10sCiAgICAgICd0aXRsZScgICA9
PiAnJywKICAgICAgJ2NsYXNzJyAgID0+ICcnCiAgICApLCRhdHRzKSk7CgogICAgaWYgKCRp
ZCkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBm
cm9tCiAgICAgICR0d2VldCA9IHNhZmVfcm93KCJ0d2VldF9pZCIKICAgICAgICAsICdhcmNf
dHdpdHRlcicsICJhcnRpY2xlX2lkPXskaWR9Iik7CiAgICB9CgogICAgaWYgKCR0d2VldFsn
dHdlZXRfaWQnXSkgewogICAgICAkdXJsID0gImh0dHA6Ly90d2l0dGVyLmNvbS8iLiRwcmVm
c1snYXJjX3R3aXR0ZXJfdXNlciddLiIvc3RhdHVzLyIuJHR3ZWV0Wyd0d2VldF9pZCddOwog
ICAgICBpZiAoJHRoaW5nPT09bnVsbCkgewogICAgICAgIHJldHVybiAkdXJsOwogICAgICB9
CiAgICAgIHJldHVybiBocmVmKHBhcnNlKCR0aGluZyksICR1cmwsCiAgICAgICAgKCR0aXRs
ZSA/ICcgdGl0bGU9IicuJHRpdGxlLiciJyA6ICcnKQogICAgICAgIC4oJGNsYXNzID8gJyBj
bGFzcz0iJy4kY2xhc3MuJyInIDogJycpKTsKICAgIH0KfQoKZnVuY3Rpb24gYXJjX3R3aXR0
ZXJfdGlueXVybCgkYXR0cywgJHRoaW5nPW51bGwpIHsKICAgIGdsb2JhbCAkdGhpc2FydGlj
bGU7CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgJ2lkJyAgICAgID0+ICR0aGlz
YXJ0aWNsZVsndGhpc2lkJ10sCiAgICAgICd0aXRsZScgICA9PiAnJywKICAgICAgJ2NsYXNz
JyAgID0+ICcnCiAgICApLCRhdHRzKSk7CgogICAgaWYgKCRpZCkgewogICAgICAvLyBGZXRj
aCBhcmNfdHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBmcm9tCiAgICAgICR0d2VldCA9
IHNhZmVfcm93KCJ0aW55dXJsIgogICAgICAgICwgJ2FyY190d2l0dGVyJywgImFydGljbGVf
aWQ9eyRpZH0iKTsKICAgIH0KCiAgICBpZiAoJHR3ZWV0Wyd0aW55dXJsJ10pIHsKICAgICAg
aWYgKCR0aGluZz09PW51bGwpIHsKICAgICAgICByZXR1cm4gJHR3ZWV0Wyd0aW55dXJsJ107
CiAgICAgIH0KCiAgICAgIHJldHVybiBocmVmKHBhcnNlKCR0aGluZyksICR0d2VldFsndGlu
eXVybCddLAogICAgICAgICgkdGl0bGUgPyAnIHRpdGxlPSInLiR0aXRsZS4nIicgOiAnJykK
ICAgICAgICAuKCRjbGFzcyA/ICcgY2xhc3M9IicuJGNsYXNzLiciJyA6ICcnKSk7CiAgICB9
Cn0KCi8qCiAqIFB1YmxpYyB0YWcgZm9yIG91dHB1dHRpbmcgd2lkZ2V0IEpTCiAqLwpmdW5j
dGlvbiBhcmNfdHdpdHRlcl93aWRnZXRfanMoJGF0dHMpCnsKICBleHRyYWN0KGxBdHRzKGFy
cmF5KAogICAgICAgICdvcHRpbWlzZScgPT4gZmFsc2UKICAgICksJGF0dHMpKTsKCiAgcmV0
dXJuIF9hcmNfdHdpdHRlcl93aWRnZXRfanMoJG9wdGltaXNlKTsKfQoKZnVuY3Rpb24gX2Fy
Y190d2l0dGVyX3dpZGdldF9qcygkb3B0aW1pc2U9dHJ1ZSkKewogIGdsb2JhbCAkYXJjX3R3
aXR0ZXI7CgogIC8vIENoZWNrIGlmIHdpZGdldCBKUyBoYXMgYWxyZWFkeSBiZWVuIG91dHB1
dAogIGlmICgkYXJjX3R3aXR0ZXJbJ3dpZGdldF9qcyddKSByZXR1cm47CgogIGlmICgkb3B0
aW1pc2U9PWZhbHNlKSB7CiAgICByZXR1cm4gJzxzY3JpcHQgc3JjPSJodHRwOi8vcGxhdGZv
cm0udHdpdHRlci5jb20vd2lkZ2V0cy5qcyIgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij48L3Nj
cmlwdD4nOwogIH0KCiAgJGpzID0gPDw8SlMKPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3Jp
cHQiPgooZnVuY3Rpb24oKSB7CiAgaWYgKHdpbmRvdy5fX3R3aXR0ZXJJbnRlbnRIYW5kbGVy
KSByZXR1cm47CiAgdmFyIGludGVudFJlZ2V4ID0gL3R3aXR0ZXJcLmNvbShcOlxkezIsNH0p
P1wvaW50ZW50XC8oXHcrKS8sCiAgICAgIHdpbmRvd09wdGlvbnMgPSAnc2Nyb2xsYmFycz15
ZXMscmVzaXphYmxlPXllcyx0b29sYmFyPW5vLGxvY2F0aW9uPXllcycsCiAgICAgIHdpZHRo
ID0gNTUwLAogICAgICBoZWlnaHQgPSA0MjAsCiAgICAgIHdpbkhlaWdodCA9IHNjcmVlbi5o
ZWlnaHQsCiAgICAgIHdpbldpZHRoID0gc2NyZWVuLndpZHRoOwoKICBmdW5jdGlvbiBoYW5k
bGVJbnRlbnQoZSkgewogICAgZSA9IGUgfHwgd2luZG93LmV2ZW50OwogICAgdmFyIHRhcmdl
dCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudCwKICAgICAgICBtLCBsZWZ0LCB0b3A7Cgog
ICAgd2hpbGUgKHRhcmdldCAmJiB0YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPT0g
J2EnKSB7CiAgICAgIHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2RlOwogICAgfQoKICAgIGlm
ICh0YXJnZXQgJiYgdGFyZ2V0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdhJyAmJiB0
YXJnZXQuaHJlZikgewogICAgICBtID0gdGFyZ2V0LmhyZWYubWF0Y2goaW50ZW50UmVnZXgp
OwogICAgICBpZiAobSkgewogICAgICAgIGxlZnQgPSBNYXRoLnJvdW5kKCh3aW5XaWR0aCAv
IDIpIC0gKHdpZHRoIC8gMikpOwogICAgICAgIHRvcCA9IDA7CgogICAgICAgIGlmICh3aW5I
ZWlnaHQgPiBoZWlnaHQpIHsKICAgICAgICAgIHRvcCA9IE1hdGgucm91bmQoKHdpbkhlaWdo
dCAvIDIpIC0gKGhlaWdodCAvIDIpKTsKICAgICAgICB9CgogICAgICAgIHdpbmRvdy5vcGVu
KHRhcmdldC5ocmVmLCAnaW50ZW50Jywgd2luZG93T3B0aW9ucyArICcsd2lkdGg9JyArIHdp
ZHRoICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcsaGVp
Z2h0PScgKyBoZWlnaHQgKyAnLGxlZnQ9JyArIGxlZnQgKyAnLHRvcD0nICsgdG9wKTsKICAg
ICAgICBlLnJldHVyblZhbHVlID0gZmFsc2U7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCAm
JiBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0KICAgIH0KICB9CgogIGlmIChkb2N1bWVu
dC5hZGRFdmVudExpc3RlbmVyKSB7CiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdj
bGljaycsIGhhbmRsZUludGVudCwgZmFsc2UpOwogIH0gZWxzZSBpZiAoZG9jdW1lbnQuYXR0
YWNoRXZlbnQpIHsKICAgIGRvY3VtZW50LmF0dGFjaEV2ZW50KCdvbmNsaWNrJywgaGFuZGxl
SW50ZW50KTsKICB9CiAgd2luZG93Ll9fdHdpdHRlckludGVudEhhbmRsZXIgPSB0cnVlOwp9
KCkpOwo8L3NjcmlwdD4KSlM7CiAgJGFyY190d2l0dGVyWyd3aWRnZXRfanMnXSA9IHRydWU7
CiAgcmV0dXJuICRqczsKfQoKLy8gRGVwcmVjYXRlZCBhcmNfdHdpdHRlcl9yZXR3ZWV0IHRh
ZywgdXNlIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbiBpbnN0ZWFkCmZ1bmN0aW9uIGFyY190
d2l0dGVyX3JldHdlZXQoJGF0dHMsICR0aGluZz1udWxsKQp7CiAgcmV0dXJuIGFyY190d2l0
dGVyX3R3ZWV0X2J1dHRvbigkYXR0cywgJHRoaW5nPW51bGwpOwp9CmZ1bmN0aW9uIGFyY190
d2l0dGVyX3R3ZWV0X2J1dHRvbigkYXR0cywgJHRoaW5nPW51bGwpCnsKICAgIGdsb2JhbCAk
cHJlZnMsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJT
ZWNyZXQ7CiAgICBnbG9iYWwgJHRoaXNhcnRpY2xlOwoKICAgIGV4dHJhY3QobEF0dHMoYXJy
YXkoCiAgICAgICAgJ3VzZXInICAgICAgICA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXIn
XSwgLy8gdmlhIHVzZXIgYWNjb3VudAogICAgICAgICd1cmwnICAgICAgICAgPT4gJycsCiAg
ICAgICAgJ3RleHQnICAgICAgICA9PiAnJywKICAgICAgICAnZm9sbG93MScgICAgID0+ICcn
LAogICAgICAgICdmb2xsb3cyJyAgICAgPT4gJycsCiAgICAgICAgJ2xhbmcnICAgICAgICA9
PiAnJywKICAgICAgICAnY291bnQnICAgICAgID0+ICdob3Jpem9udGFsJywKICAgICAgICAn
aW5jbHVkZV9qcycgID0+IHRydWUsCiAgICAgICAgJ29wdGltaXNlX2pzJyA9PiBmYWxzZSwK
ICAgICAgICAnd3JhcHRhZycgICAgID0+ICcnLAogICAgICAgICdjbGFzcycgICAgICAgPT4g
J3R3aXR0ZXItc2hhcmUtYnV0dG9uJwogICAgKSwkYXR0cykpOwoKICAgICRxID0gJyc7IC8v
IHF1ZXJ5IHN0cmluZwoKICAgIGlmICgkaWQ9JHRoaXNhcnRpY2xlWyd0aGlzaWQnXSkgewog
ICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBmcm9tCiAg
ICAgICRyb3cgPSBzYWZlX3JvdygiUkVQTEFDRSh0d2VldCxDT05DQVQoJyAnLHRpbnl1cmwp
LCcnKSBBUyB0d2VldCx0aW55dXJsIgogICAgICAgICwgJ2FyY190d2l0dGVyJywgImFydGlj
bGVfaWQ9eyRpZH0iKTsKCiAgICAgIGlmICgkdXJsPT0nJykgewogICAgICAgICR1cmwgPSAo
JHVybCkgPyAkdXJsIDogcGVybWxpbmt1cmwoJHRoaXNhcnRpY2xlKTsKICAgICAgICAkcSA9
ICd1cmw9Jy51cmxlbmNvZGUoJHVybCk7CiAgICAgIH0KICAgICAgaWYgKCR0ZXh0PT0nJykg
ewogICAgICAgICR0ZXh0ID0gKCRyb3dbJ3R3ZWV0J10pID8gJHJvd1sndHdlZXQnXSA6ICR0
aGlzYXJ0aWNsZVsndGl0bGUnXTsKICAgICAgfQogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsn
IDogJycpLid0ZXh0PScudXJsZW5jb2RlKCR0ZXh0KTsKICAgIH0KICAgIGlmICgkdXNlcikg
ewogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLid2aWE9Jy51cmxlbmNvZGUoJHVz
ZXIpOwogICAgfQogICAgaWYgKCRmb2xsb3cxJiYkZm9sbG93MikgewogICAgICAkcSAuPSAo
JHEgPyAnJmFtcDsnIDogJycpLidyZWxhdGVkPScudXJsZW5jb2RlKCRmb2xsb3cxLic6Jy4k
Zm9sbG93Mik7CiAgICB9IGVsc2VpZiAoJGZvbGxvdzF8fCRmb2xsb3cyKSB7CiAgICAgICRx
IC49ICgkcSA/ICcmYW1wOycgOiAnJykuJ3JlbGF0ZWQ9Jy51cmxlbmNvZGUoJGZvbGxvdzEu
JGZvbGxvdzIpOwogICAgfQoKICAgIHN3aXRjaCAoJGxhbmcpIHsKICAgICAgY2FzZSAnZnIn
OiBicmVhazsgY2FzZSAnZGUnOiBicmVhazsgY2FzZSAnZXMnOiBicmVhazsgY2FzZSAnanAn
OiBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICAkbGFuZyA9ICdlbic7CiAgICB9CiAg
ICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidsYW5nPScudXJsZW5jb2RlKCRsYW5nKTsK
CiAgICBzd2l0Y2ggKCRjb3VudCkgewogICAgICBjYXNlICdub25lJzogYnJlYWs7IGNhc2Ug
J3ZlcnRpY2FsJzogYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgJGNvdW50ID0gJ2hv
cml6b250YWwnOwogICAgfQogICAgJHEgLj0gKCRxID8gJyZhbXA7JyA6ICcnKS4nY291bnQ9
Jy51cmxlbmNvZGUoJGNvdW50KTsKCiAgICAkdGhpbmcgPSAoJHRoaW5nPT09bnVsbCkgPyAn
VHdlZXQnIDogcGFyc2UoJHRoaW5nKTsKCiAgICAkaHRtbCA9IGhyZWYoJHRoaW5nLCdodHRw
Oi8vdHdpdHRlci5jb20vc2hhcmU/Jy4kcQogICAgICAsICcgY2xhc3M9IicuJGNsYXNzLici
Jyk7CgogICAgJGpzID0gKCRpbmNsdWRlX2pzKSA/IF9hcmNfdHdpdHRlcl93aWRnZXRfanMo
JG9wdGltaXNlX2pzP3RydWU6ZmFsc2UpIDogJyc7CgogICAgcmV0dXJuICRqcy4kaHRtbDsK
fQoKLyoKICogVHdpdHRlciBGb2xsb3cgYnV0dG9uCiAqLwpmdW5jdGlvbiBhcmNfdHdpdHRl
cl9mb2xsb3dfYnV0dG9uKCRhdHRzLCAkdGhpbmc9bnVsbCkKewogICAgZ2xvYmFsICRwcmVm
cywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3Jl
dDsKICAgIGdsb2JhbCAkdGhpc2FydGljbGU7CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgK
ICAgICAgICAndXNlcicgICAgICAgID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLCAv
LyB2aWEgdXNlciBhY2NvdW50CiAgICAgICAgJ2xhbmcnICAgICAgICA9PiAnJywKICAgICAg
ICAnY291bnQnICAgICAgID0+IHRydWUsCiAgICAgICAgJ2luY2x1ZGVfanMnICA9PiB0cnVl
LAogICAgICAgICdvcHRpbWlzZV9qcycgPT4gZmFsc2UsCiAgICAgICAgJ2NsYXNzJyAgICAg
ICA9PiAndHdpdHRlci1mb2xsb3ctYnV0dG9uJwogICAgKSwkYXR0cykpOwoKICAgICRhdHRz
ID0gJyc7IC8vIGRhdGEgYXR0cmlidXRlcwoKICAgIHN3aXRjaCAoJGxhbmcpIHsKICAgICAg
Y2FzZSAnZnInOiBicmVhazsgY2FzZSAnZGUnOiBicmVhazsgY2FzZSAnZXMnOiBicmVhazsg
Y2FzZSAnanAnOiBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICAkbGFuZyA9ICdlbic7
CiAgICB9CiAgICAkYXR0cyAuPSAnIGRhdGEtbGFuZz0iJy51cmxlbmNvZGUoJGxhbmcpLici
JzsKCiAgICAkYXR0cyAuPSAnIGRhdGEtc2hvdy1jb3VudD0iJy4oJGNvdW50Pyd0cnVlJzon
ZmFsc2UnKS4nIic7CgogICAgJHRoaW5nID0gKCR0aGluZz09PW51bGwpID8gJ0ZvbGxvdyBA
Jy4kdXNlciA6IHBhcnNlKCR0aGluZyk7CgogICAgJGh0bWwgPSBocmVmKCR0aGluZywnaHR0
cDovL3R3aXR0ZXIuY29tLycudXJsZW5jb2RlKCR1c2VyKQogICAgICAsICcgY2xhc3M9Iicu
JGNsYXNzLiciJy4kYXR0cyk7CgogICAgJGpzID0gKCRpbmNsdWRlX2pzKSA/IF9hcmNfdHdp
dHRlcl93aWRnZXRfanMoJG9wdGltaXNlX2pzP3RydWU6ZmFsc2UpIDogJyc7CgogICAgcmV0
dXJuICRqcy4kaHRtbDsKfQoKLyoKICAgIEFkbWluLXNpZGUgZnVuY3Rpb25zCiAgICA9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09CiovCgovLyBJbnN0YWxsYXRpb24gZnVuY3Rpb24gLSBidWlsZHMgTXlTUUwgdGFi
bGUKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfaW5zdGFsbCgpCnsKCiAgICAvLyBGb3IgZmlyc3Qg
aW5zdGFsbCwgY3JlYXRlIHRhYmxlIGZvciB0d2VldHMKICAgICRzcWwgPSAiQ1JFQVRFIFRB
QkxFIElGIE5PVCBFWElTVFMgIi5QRlguImFyY190d2l0dGVyICI7CiAgICAkc3FsLj0gIihh
cmNfdHdpdHRlcmlkIElOVEVHRVIgQVVUT19JTkNSRU1FTlQgUFJJTUFSWSBLRVksCiAgICAg
ICAgYXJ0aWNsZV9pZCBJTlRFR0VSKDExKSwKICAgICAgICB0d2VldF9pZCBCSUdJTlQoMjAp
LAogICAgICAgIHR3ZWV0IFZBUkNIQVIoMTQwKSwKICAgICAgICB0aW55dXJsIFZBUkNIQVIo
MzApKTsiOwoKICAgIGlmICghc2FmZV9xdWVyeSgkc3FsKSkgewogICAgICAgIHJldHVybiAn
RXJyb3IgLSB1bmFibGUgdG8gY3JlYXRlIGFyY190d2l0dGVyIHRhYmxlJzsKICAgIH0KCn0K
Ci8vIFVuaW5zdGFsbCBmdW5jdGlvbiAtIGRlbGV0ZXMgTXlTUUwgdGFibGUgYW5kIHJlbGF0
ZWQgcHJlZmVyZW5jZXMKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdW5pbnN0YWxsKCkKewoKICAg
ICRzcWwgPSAiRFJPUCBUQUJMRSBJRiBFWElTVFMgIi5QRlguImFyY190d2l0dGVyOyI7CiAg
ICBpZiAoIXNhZmVfcXVlcnkoJHNxbCkpIHsKICAgICAgICByZXR1cm4gJ0Vycm9yIC0gdW5h
YmxlIHRvIGRlbGV0ZSBhcmNfdHdpdHRlciB0YWJsZSc7CiAgICB9CgogICAgJHNxbCA9ICJE
RUxFVEUgRlJPTSAgIi5QRlguInR4cF9wcmVmcyBXSEVSRSBldmVudD0nYXJjX3R3aXR0ZXIn
OyI7CiAgICBpZiAoIXNhZmVfcXVlcnkoJHNxbCkpIHsKICAgICAgICByZXR1cm4gJ0Vycm9y
IC0gdW5hYmxlIHRvIGRlbGV0ZSBhcmNfdHdpdHRlciBwcmVmZXJlbmNlcyc7CiAgICB9Cgp9
CmZ1bmN0aW9uIGFyY190d2l0dGVyX3VybF9tZXRob2Rfc2VsZWN0KCRuYW1lLCAkdmFsKQp7
CiAgICAkbWV0aG9kcyA9IGFycmF5KCd0aW55dXJsJyA9PiAnVGlueXVybCcsCiAgICAgICdp
c2dkJyA9PiAnSXMuZ2QnLAogICAgICAnYXJjX3R3aXR0ZXInID0+ICdUWFAgVHdlZXQnLAog
ICAgICAnc21kJyA9PiAnc21kX3Nob3J0X3VybCcpOwogICAgcmV0dXJuIHNlbGVjdElucHV0
KCRuYW1lLCAkbWV0aG9kcywgJHZhbCk7Cn0KZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdGFiX3Nl
bGVjdCgkbmFtZSwgJHZhbCkKewogICAgJHRhYnMgPSBhcnJheSgnY29udGVudCcgPT4gJ0Nv
bnRlbnQnLAogICAgICAgICdleHRlbnNpb25zJyA9PiAnRXh0ZW5zaW9ucycsCiAgICAgICAg
JycgPT4gJ0hpZGRlbicpOwogICAgcmV0dXJuIHNlbGVjdElucHV0KCRuYW1lLCAkdGFicywg
JHZhbCk7Cn0KLy8gUHJvdmlkZSBpbnRlcmZhY2UgZm9yIHNldHRpbmcgcHJlZmVyZW5jZXMK
ZnVuY3Rpb24gYXJjX3R3aXR0ZXJfcHJlZnMoJGV2ZW50LCRzdGVwKQp7CgogICAgZ2xvYmFs
ICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksJGFyY190d2l0dGVyX2NvbnN1bWVy
U2VjcmV0OwoKICAgICR1c2VyICAgICAgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl91c2Vy
J107CiAgICAkcHJlZml4ICAgICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfcHJlZml4J107
CiAgICAkc3VmZml4ICAgICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfc3VmZml4J107CiAg
ICAkdHdlZXRfZGVmYXVsdCA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCdd
OwogICAgJHVybF9tZXRob2QgICAgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3VybF9tZXRob2Qn
XTsKICAgICRzaG9ydF91cmwgICAgID0gJHByZWZzWydhcmNfc2hvcnRfdXJsJ107CiAgICAk
c2hvcnRfc2l0ZV91cmw9ICRwcmVmc1snYXJjX3Nob3J0X3NpdGVfdXJsJ107CiAgICAkY2Fj
aGVfZGlyICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ107CiAgICAkdGFi
ICAgICAgICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfdGFiJ107CgogICAgc3dpdGNoICgk
c3RlcCkgewogICAgICAgIGNhc2UgJ3ByZWZzX3NhdmUnOiBwYWdldG9wKCdUWFAgVHdlZXQn
LCAnUHJlZmVyZW5jZXMgc2F2ZWQnKTsgYnJlYWs7CiAgICAgICAgY2FzZSAncmVnaXN0ZXIn
OiBwYWdldG9wKCdUWFAgVHdlZXQnLCdDb25uZWN0IHRvIFR3aXR0ZXInKTsgYnJlYWs7CiAg
ICAgICAgY2FzZSAndmFsaWRhdGUnOgogICAgICAgIGRlZmF1bHQ6IHBhZ2V0b3AoJ1RYUCBU
d2VldCcpOwogICAgfQoKICAgICRodG1sID0gJyc7CgogICAgaWYgKCRzdGVwPT0ncmVnaXN0
ZXInKSB7IC8vIE9BdXRoIHJlZ2lzdHJhdGlvbiBwcm9jZXNzCiAgICAgICAgJHR3aXQgPSBu
ZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgICAgICwg
JGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0KTsKCiAgICAgICAgLy8gQnVpbGQgYSBjYWxs
YmFjayBVUkwgZm9yIFR3aXR0ZXIgdG8gcmV0dXJuIHRvIHRoZSBuZXh0IHN0YWdlCiAgICAg
ICAgJGNhbGxiYWNrVVJMID0gJHR3aXQtPmNhbGxiYWNrVVJMKCRldmVudCwndmFsaWRhdGUn
KTsKCiAgICAgICAgJHJlcXVlc3QgPSAkdHdpdC0+Z2V0UmVxdWVzdFRva2VuKCRjYWxsYmFj
a1VSTCk7CiAgICAgICAgJHJlcXVlc3RfdG9rZW4gPSAkcmVxdWVzdFsib2F1dGhfdG9rZW4i
XTsKICAgICAgICAkcmVxdWVzdF90b2tlbl9zZWNyZXQgPSAkcmVxdWVzdFsib2F1dGhfdG9r
ZW5fc2VjcmV0Il07CgogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9yZXF1ZXN0VG9r
ZW4nLCRyZXF1ZXN0X3Rva2VuCiAgICAgICAgICAgICwgJ2FyY190d2l0dGVyJywyKTsKICAg
ICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfcmVxdWVzdFRva2VuU2VjcmV0JywkcmVxdWVz
dF90b2tlbl9zZWNyZXQKICAgICAgICAgICAgLCAnYXJjX3R3aXR0ZXInLDIpOwoKICAgICAg
ICAkaHRtbC49IHN0YXJ0VGFibGUoJ2VkaXQnKS4KICAgICAgICAgICAgICAgIHRyKHRkKAog
ICAgICAgICAgICAgICAgICAgICgnPHA+Jy5ocmVmKCdTaWduLWluIHRvIFR3aXR0ZXInCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAsJHR3aXQtPmdldEF1dGhvcml6ZVVSTCgkcmVx
dWVzdCkpCiAgICAgICAgICAgICAgICAgICAgICAgIC4nIGFuZCBmb2xsb3cgdGhlIGluc3Ry
dWN0aW9ucyB0byBhbGxvdyBUWFAgVHdlZXQgdG8gdXNlIHlvdXIgYWNjb3VudC4gSWYgeW91
IGFyZSBhbHJlYWR5IHNpZ25lZCBpbiB0byBUd2l0dGVyIHRoZW4gdGhhdCBhY2NvdW50IHdp
bGwgYmUgYXNzb2NpYXRlZCB3aXRoIFRYUCBUd2VldCBzbyB5b3UgbWF5IG5lZWQgdG8gc2ln
biBvdXQgZmlyc3QgaWYgeW91IHdhbnQgdG8gdXNlIGEgZGlmZmVyZW50IGFjY291bnQuPC9w
PicpCiAgICAgICAgICAgICAgICApKS5lbmRUYWJsZSgpOwogICAgfSBlbHNlaWYgKCRzdGVw
PT0ndmFsaWRhdGUnKSB7CiAgICAgICAgJHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190
d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVy
U2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX3JlcXVlc3RUb2tlbiddCiAgICAgICAgICAg
ICwgJHByZWZzWydhcmNfdHdpdHRlcl9yZXF1ZXN0VG9rZW5TZWNyZXQnXSk7CiAgICAgICAg
Ly8gQXNrIFR3aXR0ZXIgZm9yIGFuIGFjY2VzcyB0b2tlbiAoYW5kIGFuIGFjY2VzcyB0b2tl
biBzZWNyZXQpCiAgICAgICAgJHJlcXVlc3QgPSAkdHdpdC0+Z2V0QWNjZXNzVG9rZW4oIGdw
cygnb2F1dGhfdmVyaWZpZXInKSApOwogICAgICAgICRhY2Nlc3NfdG9rZW4gPSAkcmVxdWVz
dFsnb2F1dGhfdG9rZW4nXTsKICAgICAgICAkYWNjZXNzX3Rva2VuX3NlY3JldCA9ICRyZXF1
ZXN0WydvYXV0aF90b2tlbl9zZWNyZXQnXTsKICAgICAgICAkdXNlciA9ICRyZXF1ZXN0Wydz
Y3JlZW5fbmFtZSddOwogICAgICAgIC8vIFN0b3JlIHRoZSBhY2Nlc3MgdG9rZW4gYW5kIHNl
Y3JldAogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbicsJGFjY2Vz
c190b2tlbiwgJ2FyY190d2l0dGVyJywyKTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0
ZXJfYWNjZXNzVG9rZW5TZWNyZXQnLCRhY2Nlc3NfdG9rZW5fc2VjcmV0CiAgICAgICAgICAg
ICwgJ2FyY190d2l0dGVyJywyKTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdXNl
cicsJHVzZXIpOwogICAgICAgICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXSA9
ICRhY2Nlc3NfdG9rZW47CiAgICAgICAgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tl
blNlY3JldCddID0gJGFjY2Vzc190b2tlbl9zZWNyZXQ7CiAgICAgICAgdW5zZXQoJHR3aXQp
OwogICAgfQoKICAgIGlmICgkc3RlcD09InByZWZzX3NhdmUiKSB7CiAgICAgICAgJHByZWZp
eCA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9wcmVmaXgnKSk7CiAgICAgICAgJHN1ZmZpeCA9
IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9zdWZmaXgnKSk7CiAgICAgICAgJHR3ZWV0X2RlZmF1
bHQgPSBncHMoJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnKTsKICAgICAgICAkdXJsX21l
dGhvZCA9IGdwcygnYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCcpOwogICAgICAgICRzaG9ydF91
cmwgPSBncHMoJ2FyY19zaG9ydF91cmwnKTsKICAgICAgICAkc2hvcnRfc2l0ZV91cmwgPSBn
cHMoJ2FyY19zaG9ydF9zaXRlX3VybCcpOwogICAgICAgICRjYWNoZV9kaXIgPSBncHMoJ2Fy
Y190d2l0dGVyX2NhY2hlX2RpcicpOwogICAgICAgICR0YWIgPSBncHMoJ2FyY190d2l0dGVy
X3RhYicpOwogICAgICAgIGlmIChzdHJsZW4oJHByZWZpeCk8PTIwKSB7CiAgICAgICAgICAg
IHNldF9wcmVmKCdhcmNfdHdpdHRlcl9wcmVmaXgnLCRwcmVmaXgpOwogICAgICAgIH0gZWxz
ZSB7CiAgICAgICAgICAgICRwcmVmaXggPSAkcHJlZnNbJ2FyY190d2l0dGVyX3ByZWZpeCdd
OwogICAgICAgIH0KICAgICAgICBpZiAoc3RybGVuKCRzdWZmaXgpPD0yMCkgewogICAgICAg
ICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfc3VmZml4Jywkc3VmZml4KTsKICAgICAgICB9
IGVsc2UgewogICAgICAgICAgICAkc3VmZml4ID0gJHByZWZzWydhcmNfdHdpdHRlcl9zdWZm
aXgnXTsKICAgICAgICB9CiAgICAgICAgJHR3ZWV0X2RlZmF1bHQgPSAoJHR3ZWV0X2RlZmF1
bHQpID8gMSA6IDA7CiAgICAgICAgJHNob3J0X3VybCA9ICgkc2hvcnRfdXJsKSA/IDEgOiAw
OwogICAgICAgIGlmICghJHNob3J0X3NpdGVfdXJsKSAkc2hvcnRfc2l0ZV91cmwgPSAkcHJl
ZnNbJ3NpdGV1cmwnXTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdHdlZXRfZGVm
YXVsdCcsJHR3ZWV0X2RlZmF1bHQpOwogICAgICAgIHNldF9wcmVmKCdhcmNfc2hvcnRfdXJs
Jywkc2hvcnRfdXJsKTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdXJsX21ldGhv
ZCcsJHVybF9tZXRob2QpOwogICAgICAgIHNldF9wcmVmKCdhcmNfc2hvcnRfc2l0ZV91cmwn
LCRzaG9ydF9zaXRlX3VybCk7CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX2NhY2hl
X2RpcicsJGNhY2hlX2Rpcik7CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3RhYics
JHRhYik7CiAgICB9CgogICAgaWYgKCAkc3RlcCE9J3JlZ2lzdGVyJyApIHsKICAgICAgICBp
ZiAoIGlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXSkKICAgICAgICAm
JiBpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0J10pICkgewog
ICAgICAgICAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3Vt
ZXJLZXkKICAgICAgICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAk
cHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10KICAgICAgICAgICAgICAgICwgJHBy
ZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKTsKICAgICAgICAgICAgJHJl
Z2lzdGVyVVJMID0gJHR3aXQtPmNhbGxiYWNrVVJMKCRldmVudCwncmVnaXN0ZXInKTsKICAg
ICAgICAgICAgJGh0bWwuPSBzdGFydFRhYmxlKCdsaXN0JykuZm9ybSgKICAgICAgICAgICAg
ICAgIHRyKAogICAgICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdUd2l0dGVyIGFjY291bnQg
ZGV0YWlscycsIDIpLDIpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudHIo
CiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl91c2Vy
Ij5Ud2l0dGVyIHVzZXJuYW1lPC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAn
IHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykK
ICAgICAgICAgICAgICAgICAgICAudGQoCiAgICAgICAgICAgICAgICAgICAgICAgICgkcHJl
ZnNbJ2FyY190d2l0dGVyX3VzZXInXSkgPwogICAgICAgICAgICAgICAgICAgICAgICAgICAg
JHVzZXIuJyAoJy5ocmVmKCdSZS1jb25uZWN0JywkcmVnaXN0ZXJVUkwpLicpJwogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgOiAnPGVtPnVua25vd248L2VtPicKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIC5ocmVmKCdDb25uZWN0IHRvIFR3aXR0ZXInLCRyZWdpc3RlclVS
TCkpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAg
ICAgICAgICAgdGRjcyhoZWQoJ1R3ZWV0IHNldHRpbmdzJywgMiksMikKICAgICAgICAgICAg
ICAgICkKICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxs
YWJlbCBmb3I9ImFyY190d2l0dGVyX3ByZWZpeCI+VHdlZXQgcHJlZml4PC9sYWJlbD4nLAog
ICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVy
dGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoZklucHV0
KCd0ZXh0JywnYXJjX3R3aXR0ZXJfcHJlZml4JywkcHJlZml4LCcnLCcnLCcnLCcnLCcnLCdh
cmNfdHdpdHRlcl9wcmVmaXgnKSkKICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAg
ICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl9zdWZmaXgiPlR3ZWV0IHN1
ZmZpeDwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1h
bGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAg
ICAgICAgLnRkKGZJbnB1dCgndGV4dCcsJ2FyY190d2l0dGVyX3N1ZmZpeCcsJHN1ZmZpeCwn
JywnJywnJywnJywnJywnYXJjX3R3aXR0ZXJfc3VmZml4JykpCiAgICAgICAgICAgICAgICAp
LnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJf
dHdlZXRfZGVmYXVsdCI+VHdlZXQgYXJ0aWNsZXMgYnkgZGVmYXVsdDwvbGFiZWw+JywKICAg
ICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRp
Y2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKHllc25vUmFk
aW8oJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnLCAkdHdlZXRfZGVmYXVsdCwgJycsICdh
cmNfdHdpdHRlcl90d2VldF9kZWZhdWx0JykpCiAgICAgICAgICAgICAgICApLnRyKAogICAg
ICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfdXJsX21ldGhv
ZCI+VVJMIHNob3J0bmVyPC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0
eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAg
ICAgICAgICAgICAgICAgICAudGQoYXJjX3R3aXR0ZXJfdXJsX21ldGhvZF9zZWxlY3QoJ2Fy
Y190d2l0dGVyX3VybF9tZXRob2QnLCR1cmxfbWV0aG9kKSkKICAgICAgICAgICAgICAgICku
dHIoCiAgICAgICAgICAgICAgICAgICAgdGRjcyhoZWQoJ1RYUCBUd2VldCBzaG9ydCBVUkwn
LCAyKSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAogICAgICAg
ICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3Nob3J0X3VybCI+RW5hYmxlIFRY
UCBUd2VldCBzaG9ydCBVUkwgcmVkaXJlY3Q8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAg
ICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlk
ZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50ZCh5ZXNub1JhZGlvKCdhcmNfc2hvcnRf
dXJsJywgJHNob3J0X3VybCwgJycsICdhcmNfc2hvcnRfdXJsJykpLAogICAgICAgICAgICAg
ICAgICAgICcgaWQ9ImFyY19zaG9ydF91cmwtb25fb2ZmIicKICAgICAgICAgICAgICAgICku
dHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfc2hvcnRfc2l0
ZV91cmwiPlRYUCBUd2VldCBzaG9ydCBzaXRlIFVSTDwvbGFiZWw+JywKICAgICAgICAgICAg
ICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWdu
OiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKGZJbnB1dCgndGV4dCcsJ2Fy
Y19zaG9ydF9zaXRlX3VybCcsJHNob3J0X3NpdGVfdXJsLCcnLCcnLCcnLCcnLCcnLCdhcmNf
c2hvcnRfc2l0ZV91cmwnKSksCiAgICAgICAgICAgICAgICAgICAgJyBpZD0iYXJjX3Nob3J0
X3NpdGVfdXJsLW9wdGlvbiInCiAgICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAg
ICAgICAgIHRkY3MoaGVkKCdUd2l0dGVyIHRhYicsIDIpLDIpCiAgICAgICAgICAgICAgICAp
LnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJf
dGFiIj5Mb2NhdGlvbiBvZiBUd2l0dGVyIHRhYjwvbGFiZWw+JywKICAgICAgICAgICAgICAg
ICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBt
aWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKGFyY190d2l0dGVyX3RhYl9zZWxl
Y3QoJ2FyY190d2l0dGVyX3RhYicsJHRhYikpCiAgICAgICAgICAgICAgICApLnRyKAogICAg
ICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdDYWNoZScsIDIpLDIpCiAgICAgICAgICAgICAg
ICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFi
ZWwgZm9yPSJhcmNfdHdpdHRlcl9jYWNoZV9kaXIiPkNhY2hlIGRpcmVjdG9yeTwvbGFiZWw+
JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7
IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKGZJ
bnB1dCgndGV4dCcsJ2FyY190d2l0dGVyX2NhY2hlX2RpcicsJGNhY2hlX2RpciwnJywnJywn
JywnJywnJywnYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJykpCiAgICAgICAgICAgICAgICApCiAg
ICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKAogICAgICAgICAg
ICAgICAgICAgICAgICBmSW5wdXQoJ3N1Ym1pdCcsICdTdWJtaXQnLCBnVHh0KCdzYXZlX2J1
dHRvbicpLCAncHVibGlzaCcpCiAgICAgICAgICAgICAgICAgICAgICAgIC5uLnNJbnB1dCgn
cHJlZnNfc2F2ZScpCiAgICAgICAgICAgICAgICAgICAgICAgIC5uLmVJbnB1dCgncGx1Z2lu
X3ByZWZzLmFyY190d2l0dGVyJykKICAgICAgICAgICAgICAgICAgICAsICcgY29sc3Bhbj0i
MiIgY2xhc3M9Im5vbGluZSInKSkpCiAgICAgICAgICAgICAgICAuZW5kVGFibGUoKTsKICAg
ICAgICB9IGVsc2VpZiAoICRzdGVwIT0ncmVnaXN0ZXInICkgewogICAgICAgICAgICAkcmVn
aXN0ZXJVUkwgPSBhcmNfdHdpdHRlcjo6Y2FsbGJhY2tVUkwoJGV2ZW50LCdyZWdpc3Rlcicp
OwogICAgICAgICAgICAkaHRtbC49IHN0YXJ0VGFibGUoJ2xpc3QnKS5mb3JtKAogICAgICAg
ICAgICAgICAgdHIoCiAgICAgICAgICAgICAgICAgICAgdGRjcyhoZWQoJ1R3aXR0ZXIgYWNj
b3VudCBkZXRhaWxzJywgMiksMikKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAg
IC50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVy
X3VzZXIiPlR3aXR0ZXIgdXNlcm5hbWU8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAg
ICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxl
OyInKQogICAgICAgICAgICAgICAgICAgIC50ZCgKICAgICAgICAgICAgICAgICAgICAgICAg
KCc8ZW0+dW5rbm93bjwvZW0+ICgnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaHJl
ZignQ29ubmVjdCB0byBUd2l0dGVyJywkcmVnaXN0ZXJVUkwpLicpJykKICAgICAgICAgICAg
ICAgICkpKQogICAgICAgICAgICAgICAgLmVuZFRhYmxlKCk7CiAgICAgICAgfQogICAgfQoK
ICAgIC8vIFNldCBqUXVlcnkgZm9yIHN3aXRjaGluZyBvbi9vZmYgcmVsZXZhbnQgYXJjX3No
b3J0X3VybCBmaWVsZHMKICAgICRqcyA9IDw8PEpTCjxzY3JpcHQgbGFuZ3VhZ2U9ImphdmFz
Y3JpcHQiIHR5cGU9InRleHQvamF2YXNjcmlwdCI+CiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0
aW9uKCl7CiAgdmFyIG9ub2ZmID0gJCgnI2FyY19zaG9ydF91cmwtb25fb2ZmJyk7CiAgdmFy
IGFyY19zaG9ydF91cmxfb2ZmID0gJCgnI2FyY19zaG9ydF91cmwtYXJjX3Nob3J0X3VybC0w
Jyk7CiAgdmFyIHVybCA9ICQoJyNhcmNfc2hvcnRfc2l0ZV91cmwtb3B0aW9uJyk7CiAgdmFy
IHVybF9tZXRob2QgPSAkKCdzZWxlY3RbbmFtZT0iYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCJd
Jyk7CgogIGlmIChhcmNfc2hvcnRfdXJsX29mZi5hdHRyKCdjaGVja2VkJyk9PXRydWUKICAm
JiAkKCdvcHRpb246c2VsZWN0ZWQnLCB1cmxfbWV0aG9kKS52YWwoKSE9J2FyY190d2l0dGVy
JykgewogICAgdXJsLmhpZGUoKTsKICB9CiAgJCgnaW5wdXQnLCBvbm9mZikuY2hhbmdlKGZ1
bmN0aW9uKCl7CiAgICBpZiAoJCgnb3B0aW9uOnNlbGVjdGVkJywgdXJsX21ldGhvZCkudmFs
KCkhPSdhcmNfdHdpdHRlcicpIHsKICAgICAgYXJjX3Nob3J0X3VybF9vZmYuYXR0cignY2hl
Y2tlZCcpPT10cnVlID8gdXJsLmhpZGUoKSA6IHVybC5zaG93KCk7CiAgICB9CiAgfSk7Cgog
IGlmICgkKCdvcHRpb246c2VsZWN0ZWQnLCB1cmxfbWV0aG9kKS52YWwoKT09J2FyY190d2l0
dGVyJykgewogICAgb25vZmYuaGlkZSgpOyB1cmwuc2hvdygpOwogIH0KICB1cmxfbWV0aG9k
LmNoYW5nZShmdW5jdGlvbigpewogICAgaWYgKCQoJ29wdGlvbjpzZWxlY3RlZCcsIHVybF9t
ZXRob2QpLnZhbCgpPT0nYXJjX3R3aXR0ZXInKSB7CiAgICAgIG9ub2ZmLnRvZ2dsZSgpOyB1
cmwuc2hvdygpOwogICAgfSBlbHNlIHsKICAgICAgb25vZmYudG9nZ2xlKCk7CiAgICAgIGFy
Y19zaG9ydF91cmxfb2ZmLmF0dHIoJ2NoZWNrZWQnKT09dHJ1ZSA/IHVybC5oaWRlKCkgOiB1
cmwuc2hvdygpOwogICAgfQogIH0pCn0pOwo8L3NjcmlwdD4KSlM7CgogICAgZWNobyAkanMu
JGh0bWw7Cn0KCi8vIEFkZCBUd2l0dGVyIHRhYiB0byBUZXh0cGF0dGVybgpmdW5jdGlvbiBh
cmNfYWRtaW5fdHdpdHRlcigkZXZlbnQsJHN0ZXApCnsKICAgIGdsb2JhbCAkcHJlZnMsICRh
cmNfdHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoK
ICAgICR0d2l0ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQog
ICAgICAgICAgICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCwgJHByZWZzWydhcmNf
dHdpdHRlcl9hY2Nlc3NUb2tlbiddCiAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRl
cl9hY2Nlc3NUb2tlblNlY3JldCddKTsKCiAgICAkdHdpdC0+Y2FjaGVEaXIoJHByZWZzWydh
cmNfdHdpdHRlcl9jYWNoZV9kaXInXSk7CgogICAgJHhtbCA9ICR0d2l0LT5nZXQoJ3VzZXJz
L3Nob3cnCiAgICAgICAgLCBhcnJheSgnc2NyZWVuX25hbWUnPT4kcHJlZnNbJ2FyY190d2l0
dGVyX3VzZXInXSkpOwogICAgJHR3aXR0ZXJVc2VyID0gQCR4bWwtPnhwYXRoKCcvdXNlcicp
OwogICAgJHR3aXR0ZXJVc2VyID0gJHR3aXR0ZXJVc2VyWzBdOwogICAgJHR3aXR0ZXJVc2Vy
VVJMID0gJ2h0dHA6Ly93d3cudHdpdHRlci5jb20vJy4kdHdpdHRlclVzZXItPnNjcmVlbl9u
YW1lOwoKICAgIGlmICgkc3RlcD09InR3ZWV0IikgeyAvLyBwb3N0IGFuIHVwZGF0ZSB0byBU
d2l0dGVyCgogICAgICAgIC8vIGZldGNoIGFuZCBjbGVhbiBtZXNzYWdlCiAgICAgICAgJG1l
c3NhZ2UgPSBzdHJpcF90YWdzKGdwcygnbWVzc2FnZScpKTsKICAgICAgICAkY291bnQgPSBz
dHJsZW4oJG1lc3NhZ2UpOwoKICAgICAgICBpZiAoJGNvdW50PD0xNDAgJiYgJGNvdW50PjAp
IHsgLy8gcG9zdCB1cGRhdGUKICAgICAgICAgICAgJHJlc3VsdCA9ICR0d2l0LT5wb3N0KCdz
dGF0dXNlcy91cGRhdGUnLCBhcnJheSgnc3RhdHVzJyA9PiAkbWVzc2FnZSkpOwogICAgICAg
IH0gZWxzZSB7IC8vIG1lc3NhZ2UgdG9vIGxvbmcsIEphdmFTY3JpcHQgaW50ZXJmYWNlIHNo
b3VsZCBwcmV2ZW50IHRoaXMKICAgICAgICAgICAgJHJlc3VsdCA9IGZhbHNlOwogICAgICAg
IH0KCiAgICAgICAgcGFnZXRvcCgnVHdpdHRlcicsCiAgICAgICAgICAgICgoJHJlc3VsdCE9
ZmFsc2UpPydUd2l0dGVyIHVwZGF0ZWQnOidFcnJvciB1cGRhdGluZyBUd2l0dGVyJykpOwoK
ICAgIH0gZWxzZWlmICgkc3RlcD09ImRlbGV0ZSIpIHsgLy8gZGVsZXRlIGFuIHVwZGF0ZSBm
cm9tIFR3aXR0ZXIKCiAgICAgICAgJGlkID0gc3RyaXBfdGFncyhncHMoJ2lkJykpOwogICAg
ICAgIGlmICgkaWQpIHsKICAgICAgICAgICAgJHR3aXQtPmRlbGV0ZSgnc3RhdHVzZXMvZGVz
dHJveScuJGlkKTsKICAgICAgICAgICAgc2FmZV9kZWxldGUoJ2FyY190d2l0dGVyJywidHdl
ZXRfaWQgPSAkaWQiKTsKICAgICAgICB9CgogICAgICAgIHBhZ2V0b3AoJ1R3aXR0ZXInLCdU
d2l0dGVyIHVwZGF0ZWQnKTsKCiAgICB9IGVsc2UgewoKICAgICAgICBwYWdldG9wKCdUd2l0
dGVyJyk7CgogICAgfQoKICAgIC8vIFByZXBhcmUgSmF2YVNjcmlwdCB0byBjcmVhdGUgVHdp
dHRlciB1cGRhdGUgaW50ZXJmYWNlCgogICAgJGpzID0gJzxzY3JpcHQgbGFuZ3VhZ2U9Imph
dmFzY3JpcHQiIHR5cGU9InRleHQvamF2YXNjcmlwdCI+JzsKICAgICRqcy49ICIkKGRvY3Vt
ZW50KS5yZWFkeShmdW5jdGlvbigpewogICAgICAgICAgICB2YXIgY291bnRlclN0eWxlID0g
J2ZvbnQtd2VpZ2h0OmJvbGQ7ZmxvYXQ6cmlnaHQ7Zm9udC1zaXplOjJlbTtsaW5lLWhlaWdo
dDoxLjJlbTsnOwogICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0eWxlJywg
Y291bnRlclN0eWxlKydjb2xvcjojY2NjOycpOwogICAgICAgICAgICAkKCcjbWVzc2FnZScp
LmtleXVwKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gMTQwLSQo
JyNtZXNzYWdlJykudmFsKCkubGVuZ3RoOwogICAgICAgICAgICAgICAgJCgnI3R3ZWV0Y291
bnQnKS5odG1sKGNvdW50KycnKTsgLy8gaGFjayB0byBmb3JjZSBvdXRwdXQgb2YgMAogICAg
ICAgICAgICAgICAgaWYgKGNvdW50PDApIHsKICAgICAgICAgICAgICAgICAgICAkKCdpbnB1
dC5wdWJsaXNoJykuYXR0cignZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTsKICAgICAgICAgICAg
ICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJCgnaW5wdXQucHVibGlzaCcpLmF0
dHIoJ2Rpc2FibGVkJywgJycpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg
aWYgKGNvdW50PDApIHsKICAgICAgICAgICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0
dHIoJ3N0eWxlJywgY291bnRlclN0eWxlKydjb2xvcjojZjAwOycpOwogICAgICAgICAgICAg
ICAgfSBlbHNlIGlmIChjb3VudDwxMCkgewogICAgICAgICAgICAgICAgICAgICQoJyN0d2Vl
dGNvdW50JykuYXR0cignc3R5bGUnLCBjb3VudGVyU3R5bGUrJ2NvbG9yOiMwMDA7Jyk7CiAg
ICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICQoJyN0d2VldGNv
dW50JykuYXR0cignc3R5bGUnLCBjb3VudGVyU3R5bGUrJ2NvbG9yOiNjY2M7Jyk7CiAgICAg
ICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgfSk7IjsKICAgICRqcy49ICI8
L3NjcmlwdD4iOwoKICAgICRvdXQgPSAnJzsKICAgICR4bWwgPSAkdHdpdC0+Z2V0KCdzdGF0
dXNlcy91c2VyX3RpbWVsaW5lJwogICAgICAgICwgYXJyYXkoJ3NjcmVlbl9uYW1lJz0+JHBy
ZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sJ2NvdW50Jz0+MjUpKTsKICAgICR0d2VldHMgPSBA
JHhtbC0+eHBhdGgoJy9zdGF0dXNlcy9zdGF0dXMnKTsKICAgIGlmICgkdHdlZXRzKSBmb3Jl
YWNoICgkdHdlZXRzIGFzICR0d2VldCkgewogICAgICAgICR0aW1lID0gc3RydG90aW1lKGh0
bWxlbnRpdGllcygkdHdlZXQtPmNyZWF0ZWRfYXQpKTsKICAgICAgICAkZGF0ZSA9IHNhZmVf
c3RyZnRpbWUoJHByZWZzWydhcmNoaXZlX2RhdGVmb3JtYXQnXSwkdGltZSk7CiAgICAgICAg
JG91dC49IHRyKHRkKCRkYXRlLCdzcGFuJykKICAgICAgICAgICAgLnRkKGFyY19Ud2l0dGVy
OjptYWtlTGlua3MoaHRtbGVudGl0aWVzKCR0d2VldC0+dGV4dAogICAgICAgICAgICAgICAg
LCBFTlRfUVVPVEVTLCdVVEYtOCcpKSkKICAgICAgICAgICAgLnRkKGRMaW5rKCdhcmNfYWRt
aW5fdHdpdHRlcicsJ2RlbGV0ZScsJ2lkJywkdHdlZXQtPmlkLCcnKSkKICAgICAgICAgICAg
KTsKICAgIH0KCiAgICAkaHRtbCA9IHN0YXJ0VGFibGUoJ2VkaXQnKQogICAgICAgICAgICAu
dHIodGQoCiAgICAgICAgICAgIGdyYWYoJzxpbWcgc3JjPSInLiR0d2l0dGVyVXNlci0+cHJv
ZmlsZV9pbWFnZV91cmwuJyIgYWx0PSJUd2l0dGVyIGF2YXRhciIgLz4nCiAgICAgICAgICAg
ICwnIHN0eWxlPSJmbG9hdDpsZWZ0O3BhZGRpbmc6MnB4OyInKQogICAgICAgICAgICAuZ3Jh
ZihocmVmKCR0d2l0dGVyVXNlci0+bmFtZSwkdHdpdHRlclVzZXJVUkwpLCcgc3R5bGU9ImZv
bnQtc2l6ZToxLjJlbTtmb250LXdlaWdodDpib2xkOyInKQogICAgICAgICAgICAuZ3JhZiho
cmVmKCR0d2l0dGVyVXNlci0+ZnJpZW5kc19jb3VudC4nIGZvbGxvd2luZycsJHR3aXR0ZXJV
c2VyVVJMLicvZm9sbG93aW5nJykKICAgICAgICAgICAgLicsICcuaHJlZigkdHdpdHRlclVz
ZXItPmZvbGxvd2Vyc19jb3VudC4nIGZvbGxvd2VycycsJHR3aXR0ZXJVc2VyVVJMLicvZm9s
bG93ZXJzJykKICAgICAgICAgICAgLicsICcuaHJlZigkdHdpdHRlclVzZXItPnN0YXR1c2Vz
X2NvdW50LicgdXBkYXRlcycsJHR3aXR0ZXJVc2VyVVJMKSkpKQogICAgICAgICAgICAudHIo
dGQoZm9ybSgKICAgICAgICAgICAgZ3JhZigiVXBkYXRlIFR3aXR0ZXIuLi48c3BhbiBpZD0n
dHdlZXRjb3VudCcgc3R5bGU9J2ZvbnQtd2VpZ2h0OmJvbGQ7ZmxvYXQ6cmlnaHQ7Jz4xNDA8
L3NwYW4+IikKICAgICAgICAgICAgLnRleHRfYXJlYSgnbWVzc2FnZScsJzUwJywnNTUwJywn
JywnbWVzc2FnZScpCiAgICAgICAgICAgIC5lSW5wdXQoJ2FyY19hZG1pbl90d2l0dGVyJykK
ICAgICAgICAgICAgLnNJbnB1dCgndHdlZXQnKS5icgogICAgICAgICAgICAuZklucHV0KCdz
dWJtaXQnLCd1cGRhdGUnLGdUeHQoJ1VwZGF0ZScpLCdwdWJsaXNoJykKICAgICAgICApKSkK
ICAgICAgICAuZW5kVGFibGUoKTsKCiAgICAvLyBBdHRhY2ggcmVjZW50IFR3aXR0ZXIgdXBk
YXRlcwoKICAgICRodG1sLj0gc3RhcnRUYWJsZSgnbGlzdCcsJycsJycsJycsJzkwJScpCiAg
ICAgICAgLiRvdXQKICAgICAgICAuZW5kVGFibGUoKTsKCiAgICAvLyBPdXRwdXQgSmF2YVNj
cmlwdCBhbmQgSFRNTAoKICAgIGVjaG8gJGpzLiRodG1sOwp9CgovLyBBZGQgVHdpdHRlciBv
cHRpb25zIHRvIGFydGljbGUgYXJ0aWNsZSBzY3JlZW4KZnVuY3Rpb24gYXJjX2FwcGVuZF90
d2l0dGVyKCRldmVudCwgJHN0ZXAsICRkYXRhLCAkcnMxKQp7CiAgICBnbG9iYWwgJHByZWZz
LCAkYXJjX3R3aXR0ZXI7CiAgICAkcHJlZml4ID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3By
ZWZpeCcpKTsKICAgICRwcmVmaXggPSAoJHByZWZpeCkgPyAkcHJlZml4IDogJHByZWZzWydh
cmNfdHdpdHRlcl9wcmVmaXgnXTsKICAgICRzdWZmaXggPSB0cmltKGdwcygnYXJjX3R3aXR0
ZXJfc3VmZml4JykpOwogICAgJHN1ZmZpeCA9ICgkc3VmZml4KSA/ICRzdWZmaXggOiAkcHJl
ZnNbJ2FyY190d2l0dGVyX3N1ZmZpeCddOwoKICAgIGlmICgkcnMxWydJRCddKSB7CiAgICAg
ICAgJHNxbCA9ICJTRUxFQ1QgdHdlZXRfaWQsdHdlZXQgRlJPTSAiLlBGWC4iYXJjX3R3aXR0
ZXIgV0hFUkUgYXJ0aWNsZV9pZD0iLiRyczFbJ0lEJ10uIjsiOwogICAgICAgICRyczIgPSBz
YWZlX3F1ZXJ5KCRzcWwpOyAkcnMyID0gbmV4dFJvdygkcnMyKTsKICAgIH0gZWxzZSB7IC8v
IG5ldyBhcnRpY2xlCiAgICAgICAgJHJzMiA9ICcnOwogICAgfQoKICAgIGlmICgkcnMxWydJ
RCddICYmICRyczJbJ3R3ZWV0X2lkJ10pIHsKICAgICAgICAkY29udGVudCA9IGFyY19Ud2l0
dGVyOjptYWtlTGlua3MoJHJzMlsndHdlZXQnXSk7CiAgICAgICAgcmV0dXJuICRkYXRhLmZp
ZWxkc2V0KCRjb250ZW50LCAnVHdpdHRlciB1cGRhdGUnLCAnYXJjX3R3aXR0ZXInKTsKICAg
IH0gZWxzZSB7CiAgICAgICAgJHZhciA9IGdwcygnYXJjX3R3ZWV0X3RoaXMnKTsKICAgICAg
ICAkdmFyID0gKCRyczFbJ0lEJ10mJiEkdmFyKSA/IDAgOiAkcHJlZnNbJ2FyY190d2l0dGVy
X3R3ZWV0X2RlZmF1bHQnXTsKICAgICAgICAkY29udGVudCAgPSB0YWcoeWVzbm9SYWRpbygn
YXJjX3R3ZWV0X3RoaXMnLCAkdmFyLCAnJywgJ2FyY190d2VldF90aGlzJyksJ3AnKTsKICAg
ICAgICAkY29udGVudCAuPSB0YWcoaHJlZignT3B0aW9ucycsJyNhcmNfdHdpdHRlcl9vcHRp
b25zJyksJ3AnLCcgY2xhc3M9InBsYWluIGxldmVyIiBzdHlsZT0ibWFyZ2luLXRvcDo1cHg7
IicpOwogICAgICAgICRjb250ZW50IC49IHRhZyh0YWcodGFnKCdUd2VldCBwcmVmaXgnLCds
YWJlbCcsICcgZm9yPSJhcmNfdHdpdHRlcl9wcmVmaXgiJykKICAgICAgICAgICAgLmZJbnB1
dCgndGV4dCcsJ2FyY190d2l0dGVyX3ByZWZpeCcsJHByZWZpeCwnZWRpdCcsJycsJycsJzIy
JywnJywnYXJjX3R3aXR0ZXJfcHJlZml4JyksJ3AnKQogICAgICAgICAgICAudGFnKHRhZygn
VHdlZXQgc3VmZml4IChlZyAjaGFzaHRhZ3MpJywnbGFiZWwnLCAnIGZvcj0iYXJjX3R3aXR0
ZXJfc3VmZml4IicpCiAgICAgICAgICAgIC5mSW5wdXQoJ3RleHQnLCdhcmNfdHdpdHRlcl9z
dWZmaXgnLCRzdWZmaXgsJ2VkaXQnLCcnLCcnLCcyMicsJycsJ2FyY190d2l0dGVyX3N1ZmZp
eCcpLCdwJykKICAgICAgICAgICAgLCdkaXYnLCcgaWQ9ImFyY190d2l0dGVyX29wdGlvbnMi
IGNsYXNzPSJ0b2dnbGUiIHN0eWxlPSJkaXNwbGF5Om5vbmUiJyk7CiAgICAgICAgaWYgKGlz
c2V0KCRhcmNfdHdpdHRlclsnZXJyb3InXSkpIHsKICAgICAgICAgICAgJGNvbnRlbnQgLj0g
JzxwPicuJGFyY190d2l0dGVyWydlcnJvciddLic8L3A+JzsKICAgICAgICB9CiAgICAgICAg
cmV0dXJuICRkYXRhLmZpZWxkc2V0KCRjb250ZW50LCAnVXBkYXRlIFR3aXR0ZXInLCAnYXJj
X3R3aXR0ZXInKTsKICAgIH0KCn0KCi8vIFVwZGF0ZSBUd2l0dGVyIHdpdGggcG9zdGVkIGFy
dGljbGUKZnVuY3Rpb24gYXJjX2FydGljbGVfdHdlZXQoJGV2ZW50LCRzdGVwKQp7CiAgICBn
bG9iYWwgJHByZWZzLCAkYXJjX3R3aXR0ZXIsICRhcmNfdHdpdHRlcl9jb25zdW1lcktleQog
ICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgICRhcnRpY2xlX2lk
ID0gZW1wdHkoJEdMT0JBTFNbJ0lEJ10pID8gZ3BzKCdJRCcpIDogJEdMT0JBTFNbJ0lEJ107
CiAgICBpZiAoIWVtcHR5KCRhcnRpY2xlX2lkKSkgewoKICAgICAgICBpbmNsdWRlX29uY2Ug
dHhwYXRoLicvcHVibGlzaC90YWdoYW5kbGVycy5waHAnOwoKICAgICAgICAkYXJ0aWNsZSA9
IHNhZmVfcm93KCJJRCwgVGl0bGUsIFNlY3Rpb24sIFBvc3RlZCIsICd0ZXh0cGF0dGVybics
CiAgICAgICAgICAgICJJRD17JGFydGljbGVfaWR9IEFORCBTdGF0dXM9NCBBTkQgbm93KCk+
PVBvc3RlZCIpOwoKICAgICAgICBpZiAoJGFydGljbGUgJiYgZ3BzKCdhcmNfdHdlZXRfdGhp
cycpKSB7IC8vIHR3ZWV0IGFydGljbGUKCiAgICAgICAgICAgIC8vIE5lZWQgdG8gbWFudWFs
bHkgdXBkYXRlIHRoZSAnVVJMIG9ubHkgdGl0bGUnIGJlZm9yZSBidWlsZGluZyB0aGUKICAg
ICAgICAgICAgLy8gVVJMCiAgICAgICAgICAgICRhcnRpY2xlWyd1cmxfdGl0bGUnXSA9IGdw
cygndXJsX3RpdGxlJyk7CiAgICAgICAgICAgIC8vIE1ha2Ugc2hvcnQgVVJMCiAgICAgICAg
ICAgICR1cmwgPSBwZXJtbGlua3VybCgkYXJ0aWNsZSk7CiAgICAgICAgICAgICRzaG9ydF91
cmwgPSBhcmNfc2hvcnRlbl91cmwoJHVybCwkcHJlZnNbJ2FyY190d2l0dGVyX3VybF9tZXRo
b2QnXSwKICAgICAgICAgICAgICAgIGFycmF5KCdpZCc9PiRhcnRpY2xlX2lkKSk7CgogICAg
ICAgICAgICBpZiAoISRzaG9ydF91cmwpIHsgLy8gRmFpbGVkIHRvIG9idGFpbiBhIHNob3J0
ZW5lZCBVUkwsIGRvIG5vdCB0d2VldCEKICAgICAgICAgICAgICAgICRhcmNfdHdpdHRlclsn
ZXJyb3InXSA9ICdVbmFibGUgdG8gb2J0YWluIGEgc2hvcnQgVVJMIGZvciB0aGlzIGFydGlj
bGUuJzsKCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KCiAg
ICAgICAgICAgIC8vIENvbnN0cnVjdCBUd2l0dGVyIHVwZGF0ZQogICAgICAgICAgICAkcHJl
Zml4ICA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9wcmVmaXgnKSk7CiAgICAgICAgICAgICRw
cmVfbGVuID0gc3RybGVuKCRwcmVmaXgpOwogICAgICAgICAgICAkcHJlZml4ICA9ICgkcHJl
Zml4ICYmICRwcmVfbGVuPD0yMCkgPyAkcHJlZml4LicgJyA6ICcnOwogICAgICAgICAgICAk
c3VmZml4ICA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9zdWZmaXgnKSk7CiAgICAgICAgICAg
ICRzdWZfbGVuID0gc3RybGVuKCRzdWZmaXgpOwogICAgICAgICAgICAkc3VmZml4ICA9ICgk
c3VmZml4ICYmICRzdWZfbGVuPD00MCkgPyAnICcuJHN1ZmZpeCA6ICcnOwogICAgICAgICAg
ICAkdXJsX2xlbiA9IHN0cmxlbigkc2hvcnRfdXJsKSsxOyAvLyBjb3VudCBVUkwgbGVuZ3Ro
ICsgMSBmb3IgcHJlZml4ZWQgc3BhY2UKICAgICAgICAgICAgaWYgKCRwcmVmaXgpICRwcmVf
bGVuICs9IDE7CiAgICAgICAgICAgIGlmICgkc3VmZml4KSAkc3VmX2xlbiArPSAxOwogICAg
ICAgICAgICBpZiAoKHN0cmxlbigkYXJ0aWNsZVsnVGl0bGUnXSkrJHVybF9sZW4rJHByZV9s
ZW4rJHN1Zl9sZW4pPjE0MCkgewogICAgICAgICAgICAgICAgJGFydGljbGVbJ1RpdGxlJ10g
PSBzdWJzdHIoJGFydGljbGVbJ1RpdGxlJ10sMCwxMzUtJHVybF9sZW4tJHByZV9sZW4tJHN1
Zl9sZW4pLicuLi4nOwogICAgICAgICAgICB9CiAgICAgICAgICAgICR0d2VldCA9ICRwcmVm
aXguJGFydGljbGVbJ1RpdGxlJ10uIiAiLiRzaG9ydF91cmwuJHN1ZmZpeDsKCiAgICAgICAg
ICAgIC8vIFVwZGF0ZSBUd2l0dGVyCiAgICAgICAgICAgICR0d2l0ID0gbmV3IGFyY190d2l0
dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAgICAgLCAkYXJjX3R3
aXR0ZXJfY29uc3VtZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4n
XQogICAgICAgICAgICAgICAgLCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2Vj
cmV0J10pOwogICAgICAgICAgICAkcmVzdWx0ID0gJHR3aXQtPnBvc3QoJ3N0YXR1c2VzL3Vw
ZGF0ZScsIGFycmF5KCdzdGF0dXMnID0+ICR0d2VldCkpOwoKICAgICAgICAgICAgJHR3ZWV0
X2lkID0gKGlzX29iamVjdCgkcmVzdWx0KSkgPyAkcmVzdWx0WzBdLT5pZCA6IDA7CgogICAg
ICAgICAgICBpZiAoJHR3ZWV0X2lkKSB7CgogICAgICAgICAgICAgICAgJHR3ZWV0ID0gYWRk
c2xhc2hlcygkdHdlZXQpOwoKICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBhcmNfdHdpdHRl
ciB0YWJsZSB3aXRoIHR3ZWV0CiAgICAgICAgICAgICAgICAkc3FsID0gIklOU0VSVCBJTlRP
ICIuUEZYLiJhcmNfdHdpdHRlciAoYXJ0aWNsZV9pZCx0d2VldF9pZCx0d2VldCx0aW55dXJs
KSAiOwogICAgICAgICAgICAgICAgJHNxbC49ICJWQUxVRVMoJGFydGljbGVfaWQsJHR3ZWV0
X2lkLFwiJHR3ZWV0XCIsJyRzaG9ydF91cmwnKTsiOwogICAgICAgICAgICAgICAgc2FmZV9x
dWVyeSgkc3FsKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgICAgICAg
IH0gZWxzZSB7CgogICAgICAgICAgICAgICAgJGFyY190d2l0dGVyWydlcnJvciddID0gJ1R3
aXR0ZXIgcmVzcG9uc2U6ICcKICAgICAgICAgICAgICAgICAgICAuJHR3aXQtPmh0dHBfY29k
ZTsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgICAgIH0KCiAgICAg
ICAgfQoKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7Cgp9CgovKgogKiBTaG9ydGVuIFVSTHMg
dXNpbmcgdmFyaW91cyBtZXRob2RzCiAqLwoKZnVuY3Rpb24gYXJjX3Nob3J0ZW5fdXJsKCR1
cmwsICRtZXRob2Q9JycsICRhdHRzPWFycmF5KCkpCnsKICBnbG9iYWwgJHByZWZzOwoKICAk
Y2ggPSBjdXJsX2luaXQoKTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfSEVBREVSLCAw
KTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIsIHRydWUpOwog
IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9USU1FT1VULCAxMCk7CgogIHN3aXRjaCAoJG1l
dGhvZCkgewogICAgY2FzZSAnc21kJzogLy8gY3JlYXRlIGEgc2hvcnRlbmVkIFVSTCB1c2lu
ZyBTTUQgU2hvcnQgVVJMCiAgICAgIHJldHVybiAoJGF0dHNbJ2lkJ10pID8gaHUuJGF0dHNb
J2lkJ10gOiBmYWxzZTsgYnJlYWs7CiAgICBjYXNlICdhcmNfdHdpdHRlcic6IC8vIG5hdGl2
ZSBVUkwgc2hvcnRlbmluZwoKICAgICAgcmV0dXJuICgkYXR0c1snaWQnXSkgPyBQUk9UT0NP
TC4kcHJlZnNbJ2FyY19zaG9ydF9zaXRlX3VybCddLicvJy4kYXR0c1snaWQnXSA6IGZhbHNl
OwogICAgICBicmVhazsKCiAgICBjYXNlICdpc2dkJzoKCiAgICAgICR1ID0gJ2h0dHA6Ly9p
cy5nZC9hcGkucGhwP2xvbmd1cmw9Jy51cmxlbmNvZGUoJHVybCk7CiAgICAgIGN1cmxfc2V0
b3B0KCRjaCwgQ1VSTE9QVF9VUkwsICR1KTsKCiAgICAgICR0aW55dXJsID0gY3VybF9leGVj
KCRjaCk7CiAgICAgIGlmICgkdGlueXVybCE9J0Vycm9yJyAmJiAkdGlueXVybCE9JycpIHsK
ICAgICAgICByZXR1cm4gJHRpbnl1cmw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdHJpZ2dl
cl9lcnJvcignYXJjX3R3aXR0ZXIgZmFpbGVkIHRvIGdldCBhIGlzLmdkIFVSTCBmb3IgJwog
ICAgICAgICAgICAuJHVybCxFX1VTRVJfV0FSTklORyk7CiAgICAgIH0KICAgICAgYnJlYWs7
CgogICAgY2FzZSAndGlueXVybCc6IGRlZmF1bHQ6IC8vIGNyZWF0ZSBhIHNob3J0ZW5lZCBV
UkwgdXNpbmcgVGlueVVSTAoKICAgICAgJHUgPSAnaHR0cDovL3Rpbnl1cmwuY29tL2FwaS1j
cmVhdGUucGhwP3VybD0nLnVybGVuY29kZSgkdXJsKTsKICAgICAgY3VybF9zZXRvcHQoJGNo
LCBDVVJMT1BUX1VSTCwgJHUpOwogICAgICAkdGlueXVybCA9IGN1cmxfZXhlYygkY2gpOwog
ICAgICBpZiAoJHRpbnl1cmwhPSdFcnJvcicgJiYgJHRpbnl1cmwhPScnKSB7CiAgICAgICAg
cmV0dXJuICR0aW55dXJsOwogICAgICB9IGVsc2UgewogICAgICAgIHRyaWdnZXJfZXJyb3Io
J2FyY190d2l0dGVyIGZhaWxlZCB0byBnZXQgYSBUaW55VVJMIGZvciAnLiR1cmwsRV9VU0VS
X1dBUk5JTkcpOwogICAgICB9CgogIH0KCiAgcmV0dXJuIGZhbHNlOyAvLyBmYWlsCgp9Cgov
KgogKiBTaG9ydGVuZWQgVVJMIHJlZGlyZWN0IGJhc2VkIG9uIHNtZF9zaG9ydF91cmwKICov
CmZ1bmN0aW9uIGFyY19zaG9ydF91cmxfcmVkaXJlY3QoJGV2ZW50LCAkc3RlcCkgewogIGds
b2JhbCAkcHJlZnM7CgogICRoYXZlX2lkID0gMDsKCiAgLy8gQ2hlY2sgaWYgdGhlcmUgaXMg
YW4gYXZhaWxhYmxlIHNob3J0IHNpdGUgdXJsIGFuZCBpZiBpdCBpcyBiZWluZyB1c2VkIGlu
CiAgLy8gdGhpcyBpbnN0YW5jZQogICRzaG9ydF9zaXRlX3VybCA9ICRwcmVmc1snYXJjX3No
b3J0X3NpdGVfdXJsJ107CiAgaWYgKCRzaG9ydF9zaXRlX3VybCkgewogICAgJHNob3J0X3Np
dGVfdXJsID0gUFJPVE9DT0wuJHNob3J0X3NpdGVfdXJsLicvJzsKICAgICR1cmxfcGFydHMg
PSBwYXJzZV91cmwoJHNob3J0X3NpdGVfdXJsKTsKICAgICRyZSA9ICcjXicuJHVybF9wYXJ0
c1sncGF0aCddLicoWzAtOV0uKikjJzsKICAgICRoYXZlX2lkID0gcHJlZ19tYXRjaCgkcmUs
ICRfU0VSVkVSWydSRVFVRVNUX1VSSSddLCAkbSk7CiAgfQoKICAvLyBGYWxsIGJhY2sgdG8g
c3RhbmRhcmQgc2l0ZSB1cmwgKHNtZF9zaG9ydF91cmwgYmVoYXZpb3VyKQogIGlmICgkaGF2
ZV9pZCkgewogICAgJHVybF9wYXJ0cyA9IHBhcnNlX3VybChodSk7CiAgICAkcmUgPSAnI14n
LiR1cmxfcGFydHNbJ3BhdGgnXS4nKFswLTldLiopIyc7CiAgICAkaGF2ZV9pZCA9IHByZWdf
bWF0Y2goJHJlLCAkX1NFUlZFUlsnUkVRVUVTVF9VUkknXSwgJG0pOwogIH0KCiAgLy8gRG8g
dGhlIHJlZGlyZWN0IGlmIHdlJ3ZlIGdvdCBhbiBhcnRpY2xlIGlkCiAgaWYgKCRoYXZlX2lk
KSB7CgkgICRpZCA9ICRtWzFdOwoJICAkcGVybWxpbmsgPSBwZXJtbGlua3VybF9pZCgkaWQp
OwoKCSAgaWYgKCRwZXJtbGluaykgewoJCSAgb2JfZW5kX2NsZWFuKCk7CgoJCSAgLy8gU3R1
cGlkLCBvdmVyIHRoZSB0b3AgaGVhZGVyIHNldHRpbmcgZm9yIElFCgkJICBoZWFkZXIoIlN0
YXR1czogMzAxIik7CgkJICBoZWFkZXIoIkhUVFAvMS4wIDMwMSBNb3ZlZCBQZXJtYW5lbnRs
eSIpOwoJCSAgaGVhZGVyKCJMb2NhdGlvbjogIi4kcGVybWxpbmssIFRSVUUsIDMwMSk7CgoJ
CSAgLy8gSW4gY2FzZSB0aGUgaGVhZGVyKCkgbWV0aG9kIGZhaWxzLCBmYWxsIGJhY2sgb24g
YSBjbGFzc2ljIHJlZGlyZWN0CgkJICBlY2hvICc8aHRtbD48aGVhZD48TUVUQSBIVFRQLUVR
VUlWPSJSZWZyZXNoIiBDT05URU5UPSIwO1VSTD0nCgkJICAgIC4kcGVybWxpbmsuJyI+PC9o
ZWFkPjxib2R5PjwvYm9keT48L2h0bWw+JzsKCQkgIGRpZSgpOwoJICB9CiAgfQoKfQoKLyoK
ICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioKKi8KCmNsYXNzIGFyY190d2l0dGVyIGV4dGVu
ZHMgVHdpdHRlck9BdXRoIHsKICAgIC8vIENhY2hpbmcgdmFyaWFibGVzCiAgICBwcml2YXRl
ICRfY2FjaGUgPSB0cnVlOwogICAgcHJpdmF0ZSAkX2NhY2hlX2RpciA9ICcuL3RtcCc7CiAg
ICBwcml2YXRlICRfY2FjaGVfdGltZSA9IDE4MDA7IC8vIDMwIG1pbnV0ZSBjYWNoZQoKICAg
IGZ1bmN0aW9uIF9fY29uc3RydWN0KCRjb25zdW1lcl9rZXksICRjb25zdW1lcl9zZWNyZXQs
ICRvYXV0aF90b2tlbiA9IE5VTEwKICAgICAgICAsICRvYXV0aF90b2tlbl9zZWNyZXQgPSBO
VUxMKQogICAgewogICAgICAgIHBhcmVudDo6X19jb25zdHJ1Y3QoJGNvbnN1bWVyX2tleSwg
JGNvbnN1bWVyX3NlY3JldCwgJG9hdXRoX3Rva2VuCiAgICAgICAgICAgICwgJG9hdXRoX3Rv
a2VuX3NlY3JldCk7CiAgICAgICAgJHRoaXMtPmZvcm1hdCA9ICd4bWwnOwogICAgICAgICR0
aGlzLT50aW1lb3V0ID0gMTU7CiAgICAgICAgJHRoaXMtPmNvbm5lY3R0aW1lb3V0ID0gMTU7
CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGNhbGxiYWNrVVJMKCRldmVudCwkc3RlcCkK
ICAgIHsKICAgICAgICByZXR1cm4gcHJlZ19yZXBsYWNlKCcvXD8uKi8nLCAnJyxQUk9UT0NP
TC4kX1NFUlZFUlsnU0VSVkVSX05BTUUnXS4kX1NFUlZFUlsnUkVRVUVTVF9VUkknXSkKICAg
ICAgICAgIC4nP2V2ZW50PScuJGV2ZW50LicmYW1wO3N0ZXA9Jy4kc3RlcDsKICAgIH0KCiAg
ICAvLyBjcmVhdGUgVHdpdHRlciBhbmQgZXh0ZXJuYWwgbGlua3MgaW4gdGV4dAogICAgcHVi
bGljIHN0YXRpYyBmdW5jdGlvbiBtYWtlTGlua3MoJHRleHQpCiAgICB7CiAgICAgICAgJHVy
bCA9ICcvXGIoaHR0cHxodHRwc3xmdHApOlwvXC8oW0EtWjAtOV1bQS1aMC05Xy1dKig/Olwu
W0EtWjAtOV1bQS1aMC05Xy1dKikrKTo/KFxkKyk/XC8/KFtcL1x3K1wuXSspXGIvaSc7CiAg
ICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2UoJHVybCwgIjxhIGhyZWY9JyQwJz4kMDwvYT4i
LCAkdGV4dCk7CiAgICAgICAgJHVybCA9ICcvXGIoXnxccyl3d3cuKFthLXpfQS1aMC05XSsp
KChcLlthLXpdKykrKVxiL2knOwogICAgICAgICR0ZXh0ID0gcHJlZ19yZXBsYWNlKCR1cmws
ICI8YSBocmVmPSdodHRwOi8vd3d3LiQyJDMnPnd3dy4kMiQzPC9hPiIsICR0ZXh0KTsKICAg
ICAgICAkdGV4dCA9IHByZWdfcmVwbGFjZSgiLyhefFxzKUAoW2Etel9BLVowLTldKykvIiwK
ICAgICAgICAgICAgIiQxQDxhIGhyZWY9J2h0dHA6Ly90d2l0dGVyLmNvbS8kMic+JDI8L2E+
IiwkdGV4dCk7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2UoIi8oXnxccykoXCMoW2Et
el9BLVowLTk6Xy1dKykpLyIsCiAgICAgICAgICAgICIkMTxhIGhyZWY9J2h0dHA6Ly90d2l0
dGVyLmNvbS9zZWFyY2g/cT0lMjMkMyc+JDI8L2E+IiwkdGV4dCk7CiAgICAgICAgcmV0dXJu
ICR0ZXh0OwogIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gZ2V0KCR1cmwsICRwYXJhbXMgPSBh
cnJheSgpKQogICAgewogICAgICAgICRhcGlfdXJsID0gbWQ1KCR1cmwudXJsZW5jb2RlKHNl
cmlhbGl6ZSgkcGFyYW1zKSkpOwogICAgICAgICRkYXRhID0gJyc7CgogICAgICAgIGlmICgk
dGhpcy0+X2NhY2hlKSB7IC8vIGNoZWNrIGZvciBjYWNoZWQgeG1sCgogICAgICAgICAgICAk
ZGF0YSA9ICR0aGlzLT5fcmV0cmlldmVDYWNoZSgkYXBpX3VybCk7CgogICAgICAgIH0KICAg
ICAgICBpZiAoZW1wdHkoJGRhdGEpKSB7CiAgICAgICAgICAgICRkYXRhID0gcGFyZW50Ojpn
ZXQoJHVybCwgJHBhcmFtcyk7CiAgICAgICAgICAgIGlmICgkdGhpcy0+aHR0cF9jb2RlPT09
MjAwICYmICR4bWw9c2ltcGxleG1sX2xvYWRfc3RyaW5nKCRkYXRhKSkgeyAvLyBzYXZlIGNh
Y2hlCiAgICAgICAgICAgICAgICAkZmlsZSA9ICR0aGlzLT5fY2FjaGVfZGlyLicvJy4kYXBp
X3VybDsKICAgICAgICAgICAgICAgIGZpbGVfcHV0X2NvbnRlbnRzKCRmaWxlLCRkYXRhLExP
Q0tfRVgpOwogICAgICAgICAgICAgICAgcmV0dXJuICR4bWw7CiAgICAgICAgICAgIH0gZWxz
ZSB7IC8vIGZhaWxlZCB0byByZXRyaWV2ZSBkYXRhIGZyb20gVHdpdHRlcgoKICAgICAgICAg
ICAgICAgIGlmICgkdGhpcy0+X2NhY2hlKSB7IC8vIGF0dGVtcHQgdG8gZm9yY2UgY2FjaGVk
IHhtbCByZXR1cm4KCiAgICAgICAgICAgICAgICAgICAgJGRhdGEgPSAkdGhpcy0+X3JldHJp
ZXZlQ2FjaGUoJGFwaV91cmwsdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKCRkYXRh
KSByZXR1cm4gQHNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSk7CgogICAgICAgICAgICAg
ICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgICAgIH0KICAg
ICAgICB9IGVsc2UgeyAvLyByZXR1cm4gY2FjaGVkIHhtbAogICAgICAgICAgICByZXR1cm4g
QHNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSk7CiAgICAgICAgfQogICAgfSAvL2VuZCBn
ZXQoKQoKICAgIGZ1bmN0aW9uIHBvc3QoJHVybCwgJHBhcmFtcyA9IGFycmF5KCkpCiAgICB7
CiAgICAgICAgJGRhdGEgPSBwYXJlbnQ6OnBvc3QoJHVybCwkcGFyYW1zKTsKICAgICAgICBy
ZXR1cm4gc2ltcGxleG1sX2xvYWRfc3RyaW5nKCRkYXRhKTsKICAgIH0KCiAgICBmdW5jdGlv
biBkZWxldGUoJHVybCwgJHBhcmFtcyA9IGFycmF5KCkpCiAgICB7CiAgICAgICAgJGRhdGEg
PSBwYXJlbnQ6OmRlbGV0ZSgkdXJsLCRwYXJhbXMpOwogICAgICAgIHJldHVybiBzaW1wbGV4
bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwogICAgfQoKICAgIC8vIENhY2hlIG1ldGhvZHMKCiAg
ICBwdWJsaWMgZnVuY3Rpb24gc2V0Q2FjaGluZygkY2FjaGU9dHJ1ZSkKICAgIHsKICAgICAg
ICAkdGhpcy0+X2NhY2hlID0gKCRjYWNoZSkgPyB0cnVlIDogZmFsc2U7CiAgICAgICAgcmV0
dXJuIHRydWU7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGNhY2hlRGlyKCRsb2MpCiAg
ICB7CiAgICAgICAgJHRoaXMtPl9jYWNoZV9kaXIgPSAkbG9jOwogICAgICAgIHJldHVybiB0
cnVlOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjYWNoZVRpbWUoJG1pbnMpCiAgICB7
CiAgICAgICAgJHRoaXMtPl9jYWNoZV90aW1lID0gJG1pbnMqNjA7IC8vIGNvbnZlcnQgbWlu
dXRlcyBpbnRvIHNlY29uZHMKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcml2
YXRlIGZ1bmN0aW9uIF9yZXRyaWV2ZUNhY2hlKCR1cmwsJG92ZXJpZGVfdGltZW91dD1mYWxz
ZSkKICAgIHsKICAgICAgICAkZmlsZSA9ICR0aGlzLT5fY2FjaGVfZGlyLicvJy4kdXJsOwog
ICAgICAgIGlmIChmaWxlX2V4aXN0cygkZmlsZSkpIHsKCiAgICAgICAgICAgICRkaWZmID0g
dGltZSgpIC0gZmlsZW10aW1lKCRmaWxlKTsKICAgICAgICAgICAgaWYgKCRvdmVyaWRlX3Rp
bWVvdXQgfHwgJGRpZmYgPCAkdGhpcy0+X2NhY2hlX3RpbWUpIHsKICAgICAgICAgICAgICAg
IHJldHVybiBmaWxlX2dldF9jb250ZW50cygkZmlsZSk7CiAgICAgICAgICAgIH0gZWxzZSB7
CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAg
fSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KfQoK
LyoKICogQWJyYWhhbSBXaWxsaWFtcyAoYWJyYWhhbUBhYnJhaC5hbSkgaHR0cDovL2FicmFo
LmFtCiAqCiAqIFRoZSBmaXJzdCBQSFAgTGlicmFyeSB0byBzdXBwb3J0IE9BdXRoIGZvciBU
d2l0dGVyJ3MgUkVTVCBBUEkuCiAqLwoKLyoqCiAqIFR3aXR0ZXIgT0F1dGggY2xhc3MKICov
CmNsYXNzIFR3aXR0ZXJPQXV0aCB7CiAgLyogQ29udGFpbnMgdGhlIGxhc3QgSFRUUCBzdGF0
dXMgY29kZSByZXR1cm5lZC4gKi8KICBwdWJsaWMgJGh0dHBfY29kZTsKICAvKiBDb250YWlu
cyB0aGUgbGFzdCBBUEkgY2FsbC4gKi8KICBwdWJsaWMgJHVybDsKICAvKiBTZXQgdXAgdGhl
IEFQSSByb290IFVSTC4gKi8KICBwdWJsaWMgJGhvc3QgPSAiaHR0cHM6Ly9hcGkudHdpdHRl
ci5jb20vMS8iOwogIC8qIFNldCB0aW1lb3V0IGRlZmF1bHQuICovCiAgcHVibGljICR0aW1l
b3V0ID0gMzA7CiAgLyogU2V0IGNvbm5lY3QgdGltZW91dC4gKi8KICBwdWJsaWMgJGNvbm5l
Y3R0aW1lb3V0ID0gMzA7CiAgLyogVmVyaWZ5IFNTTCBDZXJ0LiAqLwogIHB1YmxpYyAkc3Ns
X3ZlcmlmeXBlZXIgPSBGQUxTRTsKICAvKiBSZXNwb25zIGZvcm1hdC4gKi8KICBwdWJsaWMg
JGZvcm1hdCA9ICdqc29uJzsKICAvKiBEZWNvZGUgcmV0dXJuZWQganNvbiBkYXRhLiAqLwog
IHB1YmxpYyAkZGVjb2RlX2pzb24gPSBUUlVFOwogIC8qIENvbnRhaW5zIHRoZSBsYXN0IEhU
VFAgaGVhZGVycyByZXR1cm5lZC4gKi8KICBwdWJsaWMgJGh0dHBfaW5mbzsKICAvKiBTZXQg
dGhlIHVzZXJhZ25ldC4gKi8KICBwdWJsaWMgJHVzZXJhZ2VudCA9ICdUd2l0dGVyT0F1dGgg
djAuMi4wLWJldGEyJzsKICAvKiBJbW1lZGlhdGVseSByZXRyeSB0aGUgQVBJIGNhbGwgaWYg
dGhlIHJlc3BvbnNlIHdhcyBub3Qgc3VjY2Vzc2Z1bC4gKi8KICAvL3B1YmxpYyAkcmV0cnkg
PSBUUlVFOwoKCgoKICAvKioKICAgKiBTZXQgQVBJIFVSTFMKICAgKi8KICBmdW5jdGlvbiBh
Y2Nlc3NUb2tlblVSTCgpICB7IHJldHVybiAnaHR0cHM6Ly9hcGkudHdpdHRlci5jb20vb2F1
dGgvYWNjZXNzX3Rva2VuJzsgfQogIGZ1bmN0aW9uIGF1dGhlbnRpY2F0ZVVSTCgpIHsgcmV0
dXJuICdodHRwczovL3R3aXR0ZXIuY29tL29hdXRoL2F1dGhlbnRpY2F0ZSc7IH0KICBmdW5j
dGlvbiBhdXRob3JpemVVUkwoKSAgICB7IHJldHVybiAnaHR0cHM6Ly90d2l0dGVyLmNvbS9v
YXV0aC9hdXRob3JpemUnOyB9CiAgZnVuY3Rpb24gcmVxdWVzdFRva2VuVVJMKCkgeyByZXR1
cm4gJ2h0dHBzOi8vYXBpLnR3aXR0ZXIuY29tL29hdXRoL3JlcXVlc3RfdG9rZW4nOyB9Cgog
IC8qKgogICAqIERlYnVnIGhlbHBlcnMKICAgKi8KICBmdW5jdGlvbiBsYXN0U3RhdHVzQ29k
ZSgpIHsgcmV0dXJuICR0aGlzLT5odHRwX3N0YXR1czsgfQogIGZ1bmN0aW9uIGxhc3RBUElD
YWxsKCkgeyByZXR1cm4gJHRoaXMtPmxhc3RfYXBpX2NhbGw7IH0KCiAgLyoqCiAgICogY29u
c3RydWN0IFR3aXR0ZXJPQXV0aCBvYmplY3QKICAgKi8KICBmdW5jdGlvbiBfX2NvbnN0cnVj
dCgkY29uc3VtZXJfa2V5LCAkY29uc3VtZXJfc2VjcmV0LCAkb2F1dGhfdG9rZW4gPSBOVUxM
LCAkb2F1dGhfdG9rZW5fc2VjcmV0ID0gTlVMTCkgewogICAgJHRoaXMtPnNoYTFfbWV0aG9k
ID0gbmV3IE9BdXRoU2lnbmF0dXJlTWV0aG9kX0hNQUNfU0hBMSgpOwogICAgJHRoaXMtPmNv
bnN1bWVyID0gbmV3IE9BdXRoQ29uc3VtZXIoJGNvbnN1bWVyX2tleSwgJGNvbnN1bWVyX3Nl
Y3JldCk7CiAgICBpZiAoIWVtcHR5KCRvYXV0aF90b2tlbikgJiYgIWVtcHR5KCRvYXV0aF90
b2tlbl9zZWNyZXQpKSB7CiAgICAgICR0aGlzLT50b2tlbiA9IG5ldyBPQXV0aENvbnN1bWVy
KCRvYXV0aF90b2tlbiwgJG9hdXRoX3Rva2VuX3NlY3JldCk7CiAgICB9IGVsc2UgewogICAg
ICAkdGhpcy0+dG9rZW4gPSBOVUxMOwogICAgfQogIH0KCgogIC8qKgogICAqIEdldCBhIHJl
cXVlc3RfdG9rZW4gZnJvbSBUd2l0dGVyCiAgICoKICAgKiBAcmV0dXJucyBhIGtleS92YWx1
ZSBhcnJheSBjb250YWluaW5nIG9hdXRoX3Rva2VuIGFuZCBvYXV0aF90b2tlbl9zZWNyZXQK
ICAgKi8KICBmdW5jdGlvbiBnZXRSZXF1ZXN0VG9rZW4oJG9hdXRoX2NhbGxiYWNrID0gTlVM
TCkgewogICAgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgaWYgKCFlbXB0eSgkb2F1dGhf
Y2FsbGJhY2spKSB7CiAgICAgICRwYXJhbWV0ZXJzWydvYXV0aF9jYWxsYmFjayddID0gJG9h
dXRoX2NhbGxiYWNrOwogICAgfQogICAgJHJlcXVlc3QgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0
KCR0aGlzLT5yZXF1ZXN0VG9rZW5VUkwoKSwgJ0dFVCcsICRwYXJhbWV0ZXJzKTsKICAgICR0
b2tlbiA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygkcmVxdWVzdCk7CiAgICAkdGhp
cy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigkdG9rZW5bJ29hdXRoX3Rva2VuJ10sICR0
b2tlblsnb2F1dGhfdG9rZW5fc2VjcmV0J10pOwogICAgcmV0dXJuICR0b2tlbjsKICB9Cgog
IC8qKgogICAqIEdldCB0aGUgYXV0aG9yaXplIFVSTAogICAqCiAgICogQHJldHVybnMgYSBz
dHJpbmcKICAgKi8KICBmdW5jdGlvbiBnZXRBdXRob3JpemVVUkwoJHRva2VuLCAkc2lnbl9p
bl93aXRoX3R3aXR0ZXIgPSBUUlVFKSB7CiAgICBpZiAoaXNfYXJyYXkoJHRva2VuKSkgewog
ICAgICAkdG9rZW4gPSAkdG9rZW5bJ29hdXRoX3Rva2VuJ107CiAgICB9CiAgICBpZiAoZW1w
dHkoJHNpZ25faW5fd2l0aF90d2l0dGVyKSkgewogICAgICByZXR1cm4gJHRoaXMtPmF1dGhv
cml6ZVVSTCgpIC4gIj9vYXV0aF90b2tlbj17JHRva2VufSI7CiAgICB9IGVsc2UgewogICAg
ICAgcmV0dXJuICR0aGlzLT5hdXRoZW50aWNhdGVVUkwoKSAuICI/b2F1dGhfdG9rZW49eyR0
b2tlbn0iOwogICAgfQogIH0KCiAgLyoqCiAgICogRXhjaGFuZ2UgcmVxdWVzdCB0b2tlbiBh
bmQgc2VjcmV0IGZvciBhbiBhY2Nlc3MgdG9rZW4gYW5kCiAgICogc2VjcmV0LCB0byBzaWdu
IEFQSSBjYWxscy4KICAgKgogICAqIEByZXR1cm5zIGFycmF5KCJvYXV0aF90b2tlbiIgPT4g
InRoZS1hY2Nlc3MtdG9rZW4iLAogICAqICAgICAgICAgICAgICAgICJvYXV0aF90b2tlbl9z
ZWNyZXQiID0+ICJ0aGUtYWNjZXNzLXNlY3JldCIsCiAgICogICAgICAgICAgICAgICAgInVz
ZXJfaWQiID0+ICI5NDM2OTkyIiwKICAgKiAgICAgICAgICAgICAgICAic2NyZWVuX25hbWUi
ID0+ICJhYnJhaGFtIikKICAgKi8KICBmdW5jdGlvbiBnZXRBY2Nlc3NUb2tlbigkb2F1dGhf
dmVyaWZpZXIgPSBGQUxTRSkgewogICAgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgaWYg
KCFlbXB0eSgkb2F1dGhfdmVyaWZpZXIpKSB7CiAgICAgICRwYXJhbWV0ZXJzWydvYXV0aF92
ZXJpZmllciddID0gJG9hdXRoX3ZlcmlmaWVyOwogICAgfQogICAgJHJlcXVlc3QgPSAkdGhp
cy0+b0F1dGhSZXF1ZXN0KCR0aGlzLT5hY2Nlc3NUb2tlblVSTCgpLCAnR0VUJywgJHBhcmFt
ZXRlcnMpOwogICAgJHRva2VuID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKCRyZXF1
ZXN0KTsKICAgICR0aGlzLT50b2tlbiA9IG5ldyBPQXV0aENvbnN1bWVyKCR0b2tlblsnb2F1
dGhfdG9rZW4nXSwgJHRva2VuWydvYXV0aF90b2tlbl9zZWNyZXQnXSk7CiAgICByZXR1cm4g
JHRva2VuOwogIH0KCiAgLyoqCiAgICogT25lIHRpbWUgZXhjaGFuZ2Ugb2YgdXNlcm5hbWUg
YW5kIHBhc3N3b3JkIGZvciBhY2Nlc3MgdG9rZW4gYW5kIHNlY3JldC4KICAgKgogICAqIEBy
ZXR1cm5zIGFycmF5KCJvYXV0aF90b2tlbiIgPT4gInRoZS1hY2Nlc3MtdG9rZW4iLAogICAq
ICAgICAgICAgICAgICAgICJvYXV0aF90b2tlbl9zZWNyZXQiID0+ICJ0aGUtYWNjZXNzLXNl
Y3JldCIsCiAgICogICAgICAgICAgICAgICAgInVzZXJfaWQiID0+ICI5NDM2OTkyIiwKICAg
KiAgICAgICAgICAgICAgICAic2NyZWVuX25hbWUiID0+ICJhYnJhaGFtIiwKICAgKiAgICAg
ICAgICAgICAgICAieF9hdXRoX2V4cGlyZXMiID0+ICIwIikKICAgKi8KICBmdW5jdGlvbiBn
ZXRYQXV0aFRva2VuKCR1c2VybmFtZSwgJHBhc3N3b3JkKSB7CiAgICAkcGFyYW1ldGVycyA9
IGFycmF5KCk7CiAgICAkcGFyYW1ldGVyc1sneF9hdXRoX3VzZXJuYW1lJ10gPSAkdXNlcm5h
bWU7CiAgICAkcGFyYW1ldGVyc1sneF9hdXRoX3Bhc3N3b3JkJ10gPSAkcGFzc3dvcmQ7CiAg
ICAkcGFyYW1ldGVyc1sneF9hdXRoX21vZGUnXSA9ICdjbGllbnRfYXV0aCc7CiAgICAkcmVx
dWVzdCA9ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHRoaXMtPmFjY2Vzc1Rva2VuVVJMKCksICdQ
T1NUJywgJHBhcmFtZXRlcnMpOwogICAgJHRva2VuID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJh
bWV0ZXJzKCRyZXF1ZXN0KTsKICAgICR0aGlzLT50b2tlbiA9IG5ldyBPQXV0aENvbnN1bWVy
KCR0b2tlblsnb2F1dGhfdG9rZW4nXSwgJHRva2VuWydvYXV0aF90b2tlbl9zZWNyZXQnXSk7
CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAgLyoqCiAgICogR0VUIHdyYXBwZXIgZm9yIG9B
dXRoUmVxdWVzdC4KICAgKi8KICBmdW5jdGlvbiBnZXQoJHVybCwgJHBhcmFtZXRlcnMgPSBh
cnJheSgpKSB7CiAgICAkcmVzcG9uc2UgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR1cmwsICdH
RVQnLCAkcGFyYW1ldGVycyk7CiAgICBpZiAoJHRoaXMtPmZvcm1hdCA9PT0gJ2pzb24nICYm
ICR0aGlzLT5kZWNvZGVfanNvbikgewogICAgICByZXR1cm4ganNvbl9kZWNvZGUoJHJlc3Bv
bnNlKTsKICAgIH0KICAgIHJldHVybiAkcmVzcG9uc2U7CiAgfQoKICAvKioKICAgKiBQT1NU
IHdyYXBwZXIgZm9yIG9BdXRoUmVxdWVzdC4KICAgKi8KICBmdW5jdGlvbiBwb3N0KCR1cmws
ICRwYXJhbWV0ZXJzID0gYXJyYXkoKSkgewogICAgJHJlc3BvbnNlID0gJHRoaXMtPm9BdXRo
UmVxdWVzdCgkdXJsLCAnUE9TVCcsICRwYXJhbWV0ZXJzKTsKICAgIGlmICgkdGhpcy0+Zm9y
bWF0ID09PSAnanNvbicgJiYgJHRoaXMtPmRlY29kZV9qc29uKSB7CiAgICAgIHJldHVybiBq
c29uX2RlY29kZSgkcmVzcG9uc2UpOwogICAgfQogICAgcmV0dXJuICRyZXNwb25zZTsKICB9
CgogIC8qKgogICAqIERFTEVURSB3cmFwcGVyIGZvciBvQXV0aFJlcWV1c3QuCiAgICovCiAg
ZnVuY3Rpb24gZGVsZXRlKCR1cmwsICRwYXJhbWV0ZXJzID0gYXJyYXkoKSkgewogICAgJHJl
c3BvbnNlID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdXJsLCAnREVMRVRFJywgJHBhcmFtZXRl
cnMpOwogICAgaWYgKCR0aGlzLT5mb3JtYXQgPT09ICdqc29uJyAmJiAkdGhpcy0+ZGVjb2Rl
X2pzb24pIHsKICAgICAgcmV0dXJuIGpzb25fZGVjb2RlKCRyZXNwb25zZSk7CiAgICB9CiAg
ICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoqCiAgICogRm9ybWF0IGFuZCBzaWduIGFu
IE9BdXRoIC8gQVBJIHJlcXVlc3QKICAgKi8KICBmdW5jdGlvbiBvQXV0aFJlcXVlc3QoJHVy
bCwgJG1ldGhvZCwgJHBhcmFtZXRlcnMpIHsKICAgIGlmIChzdHJycG9zKCR1cmwsICdodHRw
czovLycpICE9PSAwICYmIHN0cnJwb3MoJHVybCwgJ2h0dHA6Ly8nKSAhPT0gMCkgewogICAg
ICAkdXJsID0gInskdGhpcy0+aG9zdH17JHVybH0ueyR0aGlzLT5mb3JtYXR9IjsKICAgIH0K
ICAgICRyZXF1ZXN0ID0gT0F1dGhSZXF1ZXN0Ojpmcm9tX2NvbnN1bWVyX2FuZF90b2tlbigk
dGhpcy0+Y29uc3VtZXIsICR0aGlzLT50b2tlbiwgJG1ldGhvZCwgJHVybCwgJHBhcmFtZXRl
cnMpOwogICAgJHJlcXVlc3QtPnNpZ25fcmVxdWVzdCgkdGhpcy0+c2hhMV9tZXRob2QsICR0
aGlzLT5jb25zdW1lciwgJHRoaXMtPnRva2VuKTsKICAgIHN3aXRjaCAoJG1ldGhvZCkgewog
ICAgY2FzZSAnR0VUJzoKICAgICAgcmV0dXJuICR0aGlzLT5odHRwKCRyZXF1ZXN0LT50b191
cmwoKSwgJ0dFVCcpOwogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuICR0aGlzLT5odHRwKCRy
ZXF1ZXN0LT5nZXRfbm9ybWFsaXplZF9odHRwX3VybCgpLCAkbWV0aG9kLCAkcmVxdWVzdC0+
dG9fcG9zdGRhdGEoKSk7CiAgICB9CiAgfQoKICAvKioKICAgKiBNYWtlIGFuIEhUVFAgcmVx
dWVzdAogICAqCiAgICogQHJldHVybiBBUEkgcmVzdWx0cwogICAqLwogIGZ1bmN0aW9uIGh0
dHAoJHVybCwgJG1ldGhvZCwgJHBvc3RmaWVsZHMgPSBOVUxMKSB7CiAgICAkdGhpcy0+aHR0
cF9pbmZvID0gYXJyYXkoKTsKICAgICRjaSA9IGN1cmxfaW5pdCgpOwogICAgLyogQ3VybCBz
ZXR0aW5ncyAqLwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1VTRVJBR0VOVCwgJHRo
aXMtPnVzZXJhZ2VudCk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfQ09OTkVDVFRJ
TUVPVVQsICR0aGlzLT5jb25uZWN0dGltZW91dCk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENV
UkxPUFRfVElNRU9VVCwgJHRoaXMtPnRpbWVvdXQpOwogICAgY3VybF9zZXRvcHQoJGNpLCBD
VVJMT1BUX1JFVFVSTlRSQU5TRkVSLCBUUlVFKTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VS
TE9QVF9IVFRQSEVBREVSLCBhcnJheSgnRXhwZWN0OicpKTsKICAgIGN1cmxfc2V0b3B0KCRj
aSwgQ1VSTE9QVF9TU0xfVkVSSUZZUEVFUiwgJHRoaXMtPnNzbF92ZXJpZnlwZWVyKTsKICAg
IGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9IRUFERVJGVU5DVElPTiwgYXJyYXkoJHRoaXMs
ICdnZXRIZWFkZXInKSk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfSEVBREVSLCBG
QUxTRSk7CgogICAgc3dpdGNoICgkbWV0aG9kKSB7CiAgICAgIGNhc2UgJ1BPU1QnOgogICAg
ICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9QT1NULCBUUlVFKTsKICAgICAgICBpZiAo
IWVtcHR5KCRwb3N0ZmllbGRzKSkgewogICAgICAgICAgY3VybF9zZXRvcHQoJGNpLCBDVVJM
T1BUX1BPU1RGSUVMRFMsICRwb3N0ZmllbGRzKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7
CiAgICAgIGNhc2UgJ0RFTEVURSc6CiAgICAgICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BU
X0NVU1RPTVJFUVVFU1QsICdERUxFVEUnKTsKICAgICAgICBpZiAoIWVtcHR5KCRwb3N0Zmll
bGRzKSkgewogICAgICAgICAgJHVybCA9ICJ7JHVybH0/eyRwb3N0ZmllbGRzfSI7CiAgICAg
ICAgfQogICAgfQoKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9VUkwsICR1cmwpOwog
ICAgJHJlc3BvbnNlID0gY3VybF9leGVjKCRjaSk7CiAgICAkdGhpcy0+aHR0cF9jb2RlID0g
Y3VybF9nZXRpbmZvKCRjaSwgQ1VSTElORk9fSFRUUF9DT0RFKTsKICAgICR0aGlzLT5odHRw
X2luZm8gPSBhcnJheV9tZXJnZSgkdGhpcy0+aHR0cF9pbmZvLCBjdXJsX2dldGluZm8oJGNp
KSk7CiAgICAkdGhpcy0+dXJsID0gJHVybDsKICAgIGN1cmxfY2xvc2UgKCRjaSk7CiAgICBy
ZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoqCiAgICogR2V0IHRoZSBoZWFkZXIgaW5mbyB0
byBzdG9yZS4KICAgKi8KICBmdW5jdGlvbiBnZXRIZWFkZXIoJGNoLCAkaGVhZGVyKSB7CiAg
ICAkaSA9IHN0cnBvcygkaGVhZGVyLCAnOicpOwogICAgaWYgKCFlbXB0eSgkaSkpIHsKICAg
ICAgJGtleSA9IHN0cl9yZXBsYWNlKCctJywgJ18nLCBzdHJ0b2xvd2VyKHN1YnN0cigkaGVh
ZGVyLCAwLCAkaSkpKTsKICAgICAgJHZhbHVlID0gdHJpbShzdWJzdHIoJGhlYWRlciwgJGkg
KyAyKSk7CiAgICAgICR0aGlzLT5odHRwX2hlYWRlclska2V5XSA9ICR2YWx1ZTsKICAgIH0K
ICAgIHJldHVybiBzdHJsZW4oJGhlYWRlcik7CiAgfQp9CgpjbGFzcyBPQXV0aEV4Y2VwdGlv
biBleHRlbmRzIEV4Y2VwdGlvbiB7CiAgLy8gcGFzcwp9CgpjbGFzcyBPQXV0aENvbnN1bWVy
IHsKICBwdWJsaWMgJGtleTsKICBwdWJsaWMgJHNlY3JldDsKCiAgZnVuY3Rpb24gX19jb25z
dHJ1Y3QoJGtleSwgJHNlY3JldCwgJGNhbGxiYWNrX3VybD1OVUxMKSB7CiAgICAkdGhpcy0+
a2V5ID0gJGtleTsKICAgICR0aGlzLT5zZWNyZXQgPSAkc2VjcmV0OwogICAgJHRoaXMtPmNh
bGxiYWNrX3VybCA9ICRjYWxsYmFja191cmw7CiAgfQoKICBmdW5jdGlvbiBfX3RvU3RyaW5n
KCkgewogICAgcmV0dXJuICJPQXV0aENvbnN1bWVyW2tleT0kdGhpcy0+a2V5LHNlY3JldD0k
dGhpcy0+c2VjcmV0XSI7CiAgfQp9CgpjbGFzcyBPQXV0aFRva2VuIHsKICAvLyBhY2Nlc3Mg
dG9rZW5zIGFuZCByZXF1ZXN0IHRva2VucwogIHB1YmxpYyAka2V5OwogIHB1YmxpYyAkc2Vj
cmV0OwoKICAvKioKICAgKiBrZXkgPSB0aGUgdG9rZW4KICAgKiBzZWNyZXQgPSB0aGUgdG9r
ZW4gc2VjcmV0CiAgICovCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGtleSwgJHNlY3JldCkg
ewogICAgJHRoaXMtPmtleSA9ICRrZXk7CiAgICAkdGhpcy0+c2VjcmV0ID0gJHNlY3JldDsK
ICB9CgogIC8qKgogICAqIGdlbmVyYXRlcyB0aGUgYmFzaWMgc3RyaW5nIHNlcmlhbGl6YXRp
b24gb2YgYSB0b2tlbiB0aGF0IGEgc2VydmVyCiAgICogd291bGQgcmVzcG9uZCB0byByZXF1
ZXN0X3Rva2VuIGFuZCBhY2Nlc3NfdG9rZW4gY2FsbHMgd2l0aAogICAqLwogIGZ1bmN0aW9u
IHRvX3N0cmluZygpIHsKICAgIHJldHVybiAib2F1dGhfdG9rZW49IiAuCiAgICAgICAgICAg
T0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkdGhpcy0+a2V5KSAuCiAgICAgICAgICAg
IiZvYXV0aF90b2tlbl9zZWNyZXQ9IiAuCiAgICAgICAgICAgT0F1dGhVdGlsOjp1cmxlbmNv
ZGVfcmZjMzk4NigkdGhpcy0+c2VjcmV0KTsKICB9CgogIGZ1bmN0aW9uIF9fdG9TdHJpbmco
KSB7CiAgICByZXR1cm4gJHRoaXMtPnRvX3N0cmluZygpOwogIH0KfQoKLyoqCiAqIEEgY2xh
c3MgZm9yIGltcGxlbWVudGluZyBhIFNpZ25hdHVyZSBNZXRob2QKICogU2VlIHNlY3Rpb24g
OSAoIlNpZ25pbmcgUmVxdWVzdHMiKSBpbiB0aGUgc3BlYwogKi8KYWJzdHJhY3QgY2xhc3Mg
T0F1dGhTaWduYXR1cmVNZXRob2QgewogIC8qKgogICAqIE5lZWRzIHRvIHJldHVybiB0aGUg
bmFtZSBvZiB0aGUgU2lnbmF0dXJlIE1ldGhvZCAoaWUgSE1BQy1TSEExKQogICAqIEByZXR1
cm4gc3RyaW5nCiAgICovCiAgYWJzdHJhY3QgcHVibGljIGZ1bmN0aW9uIGdldF9uYW1lKCk7
CgogIC8qKgogICAqIEJ1aWxkIHVwIHRoZSBzaWduYXR1cmUKICAgKiBOT1RFOiBUaGUgb3V0
cHV0IG9mIHRoaXMgZnVuY3Rpb24gTVVTVCBOT1QgYmUgdXJsZW5jb2RlZC4KICAgKiB0aGUg
ZW5jb2RpbmcgaXMgaGFuZGxlZCBpbiBPQXV0aFJlcXVlc3Qgd2hlbiB0aGUgZmluYWwKICAg
KiByZXF1ZXN0IGlzIHNlcmlhbGl6ZWQKICAgKiBAcGFyYW0gT0F1dGhSZXF1ZXN0ICRyZXF1
ZXN0CiAgICogQHBhcmFtIE9BdXRoQ29uc3VtZXIgJGNvbnN1bWVyCiAgICogQHBhcmFtIE9B
dXRoVG9rZW4gJHRva2VuCiAgICogQHJldHVybiBzdHJpbmcKICAgKi8KICBhYnN0cmFjdCBw
dWJsaWMgZnVuY3Rpb24gYnVpbGRfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0
b2tlbik7CgogIC8qKgogICAqIFZlcmlmaWVzIHRoYXQgYSBnaXZlbiBzaWduYXR1cmUgaXMg
Y29ycmVjdAogICAqIEBwYXJhbSBPQXV0aFJlcXVlc3QgJHJlcXVlc3QKICAgKiBAcGFyYW0g
T0F1dGhDb25zdW1lciAkY29uc3VtZXIKICAgKiBAcGFyYW0gT0F1dGhUb2tlbiAkdG9rZW4K
ICAgKiBAcGFyYW0gc3RyaW5nICRzaWduYXR1cmUKICAgKiBAcmV0dXJuIGJvb2wKICAgKi8K
ICBwdWJsaWMgZnVuY3Rpb24gY2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIs
ICR0b2tlbiwgJHNpZ25hdHVyZSkgewogICAgJGJ1aWx0ID0gJHRoaXMtPmJ1aWxkX3NpZ25h
dHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAgcmV0dXJuICRidWlsdCA9
PSAkc2lnbmF0dXJlOwogIH0KfQoKLyoqCiAqIFRoZSBITUFDLVNIQTEgc2lnbmF0dXJlIG1l
dGhvZCB1c2VzIHRoZSBITUFDLVNIQTEgc2lnbmF0dXJlIGFsZ29yaXRobSBhcyBkZWZpbmVk
IGluIFtSRkMyMTA0XQogKiB3aGVyZSB0aGUgU2lnbmF0dXJlIEJhc2UgU3RyaW5nIGlzIHRo
ZSB0ZXh0IGFuZCB0aGUga2V5IGlzIHRoZSBjb25jYXRlbmF0ZWQgdmFsdWVzIChlYWNoIGZp
cnN0CiAqIGVuY29kZWQgcGVyIFBhcmFtZXRlciBFbmNvZGluZykgb2YgdGhlIENvbnN1bWVy
IFNlY3JldCBhbmQgVG9rZW4gU2VjcmV0LCBzZXBhcmF0ZWQgYnkgYW4gJyYnCiAqIGNoYXJh
Y3RlciAoQVNDSUkgY29kZSAzOCkgZXZlbiBpZiBlbXB0eS4KICogICAtIENoYXB0ZXIgOS4y
ICgiSE1BQy1TSEExIikKICovCmNsYXNzIE9BdXRoU2lnbmF0dXJlTWV0aG9kX0hNQUNfU0hB
MSBleHRlbmRzIE9BdXRoU2lnbmF0dXJlTWV0aG9kIHsKICBmdW5jdGlvbiBnZXRfbmFtZSgp
IHsKICAgIHJldHVybiAiSE1BQy1TSEExIjsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBidWls
ZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAkYmFzZV9z
dHJpbmcgPSAkcmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpOwogICAgJHJl
cXVlc3QtPmJhc2Vfc3RyaW5nID0gJGJhc2Vfc3RyaW5nOwoKICAgICRrZXlfcGFydHMgPSBh
cnJheSgKICAgICAgJGNvbnN1bWVyLT5zZWNyZXQsCiAgICAgICgkdG9rZW4pID8gJHRva2Vu
LT5zZWNyZXQgOiAiIgogICAgKTsKCiAgICAka2V5X3BhcnRzID0gT0F1dGhVdGlsOjp1cmxl
bmNvZGVfcmZjMzk4Nigka2V5X3BhcnRzKTsKICAgICRrZXkgPSBpbXBsb2RlKCcmJywgJGtl
eV9wYXJ0cyk7CgogICAgcmV0dXJuIGJhc2U2NF9lbmNvZGUoaGFzaF9obWFjKCdzaGExJywg
JGJhc2Vfc3RyaW5nLCAka2V5LCB0cnVlKSk7CiAgfQp9CgovKioKICogVGhlIFBMQUlOVEVY
VCBtZXRob2QgZG9lcyBub3QgcHJvdmlkZSBhbnkgc2VjdXJpdHkgcHJvdGVjdGlvbiBhbmQg
U0hPVUxEIG9ubHkgYmUgdXNlZAogKiBvdmVyIGEgc2VjdXJlIGNoYW5uZWwgc3VjaCBhcyBI
VFRQUy4gSXQgZG9lcyBub3QgdXNlIHRoZSBTaWduYXR1cmUgQmFzZSBTdHJpbmcuCiAqICAg
LSBDaGFwdGVyIDkuNCAoIlBMQUlOVEVYVCIpCiAqLwpjbGFzcyBPQXV0aFNpZ25hdHVyZU1l
dGhvZF9QTEFJTlRFWFQgZXh0ZW5kcyBPQXV0aFNpZ25hdHVyZU1ldGhvZCB7CiAgcHVibGlj
IGZ1bmN0aW9uIGdldF9uYW1lKCkgewogICAgcmV0dXJuICJQTEFJTlRFWFQiOwogIH0KCiAg
LyoqCiAgICogb2F1dGhfc2lnbmF0dXJlIGlzIHNldCB0byB0aGUgY29uY2F0ZW5hdGVkIGVu
Y29kZWQgdmFsdWVzIG9mIHRoZSBDb25zdW1lciBTZWNyZXQgYW5kCiAgICogVG9rZW4gU2Vj
cmV0LCBzZXBhcmF0ZWQgYnkgYSAnJicgY2hhcmFjdGVyIChBU0NJSSBjb2RlIDM4KSwgZXZl
biBpZiBlaXRoZXIgc2VjcmV0IGlzCiAgICogZW1wdHkuIFRoZSByZXN1bHQgTVVTVCBiZSBl
bmNvZGVkIGFnYWluLgogICAqICAgLSBDaGFwdGVyIDkuNC4xICgiR2VuZXJhdGluZyBTaWdu
YXR1cmVzIikKICAgKgogICAqIFBsZWFzZSBub3RlIHRoYXQgdGhlIHNlY29uZCBlbmNvZGlu
ZyBNVVNUIE5PVCBoYXBwZW4gaW4gdGhlIFNpZ25hdHVyZU1ldGhvZCwgYXMKICAgKiBPQXV0
aFJlcXVlc3QgaGFuZGxlcyB0aGlzIQogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBidWlsZF9z
aWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAka2V5X3BhcnRz
ID0gYXJyYXkoCiAgICAgICRjb25zdW1lci0+c2VjcmV0LAogICAgICAoJHRva2VuKSA/ICR0
b2tlbi0+c2VjcmV0IDogIiIKICAgICk7CgogICAgJGtleV9wYXJ0cyA9IE9BdXRoVXRpbDo6
dXJsZW5jb2RlX3JmYzM5ODYoJGtleV9wYXJ0cyk7CiAgICAka2V5ID0gaW1wbG9kZSgnJics
ICRrZXlfcGFydHMpOwogICAgJHJlcXVlc3QtPmJhc2Vfc3RyaW5nID0gJGtleTsKCiAgICBy
ZXR1cm4gJGtleTsKICB9Cn0KCi8qKgogKiBUaGUgUlNBLVNIQTEgc2lnbmF0dXJlIG1ldGhv
ZCB1c2VzIHRoZSBSU0FTU0EtUEtDUzEtdjFfNSBzaWduYXR1cmUgYWxnb3JpdGhtIGFzIGRl
ZmluZWQgaW4KICogW1JGQzM0NDddIHNlY3Rpb24gOC4yIChtb3JlIHNpbXBseSBrbm93biBh
cyBQS0NTIzEpLCB1c2luZyBTSEEtMSBhcyB0aGUgaGFzaCBmdW5jdGlvbiBmb3IKICogRU1T
QS1QS0NTMS12MV81LiBJdCBpcyBhc3N1bWVkIHRoYXQgdGhlIENvbnN1bWVyIGhhcyBwcm92
aWRlZCBpdHMgUlNBIHB1YmxpYyBrZXkgaW4gYQogKiB2ZXJpZmllZCB3YXkgdG8gdGhlIFNl
cnZpY2UgUHJvdmlkZXIsIGluIGEgbWFubmVyIHdoaWNoIGlzIGJleW9uZCB0aGUgc2NvcGUg
b2YgdGhpcwogKiBzcGVjaWZpY2F0aW9uLgogKiAgIC0gQ2hhcHRlciA5LjMgKCJSU0EtU0hB
MSIpCiAqLwphYnN0cmFjdCBjbGFzcyBPQXV0aFNpZ25hdHVyZU1ldGhvZF9SU0FfU0hBMSBl
eHRlbmRzIE9BdXRoU2lnbmF0dXJlTWV0aG9kIHsKICBwdWJsaWMgZnVuY3Rpb24gZ2V0X25h
bWUoKSB7CiAgICByZXR1cm4gIlJTQS1TSEExIjsKICB9CgogIC8vIFVwIHRvIHRoZSBTUCB0
byBpbXBsZW1lbnQgdGhpcyBsb29rdXAgb2Yga2V5cy4gUG9zc2libGUgaWRlYXMgYXJlOgog
IC8vICgxKSBkbyBhIGxvb2t1cCBpbiBhIHRhYmxlIG9mIHRydXN0ZWQgY2VydHMga2V5ZWQg
b2ZmIG9mIGNvbnN1bWVyCiAgLy8gKDIpIGZldGNoIHZpYSBodHRwIHVzaW5nIGEgdXJsIHBy
b3ZpZGVkIGJ5IHRoZSByZXF1ZXN0ZXIKICAvLyAoMykgc29tZSBzb3J0IG9mIHNwZWNpZmlj
IGRpc2NvdmVyeSBjb2RlIGJhc2VkIG9uIHJlcXVlc3QKICAvLwogIC8vIEVpdGhlciB3YXkg
c2hvdWxkIHJldHVybiBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgY2VydGlmaWNh
dGUKICBwcm90ZWN0ZWQgYWJzdHJhY3QgZnVuY3Rpb24gZmV0Y2hfcHVibGljX2NlcnQoJiRy
ZXF1ZXN0KTsKCiAgLy8gVXAgdG8gdGhlIFNQIHRvIGltcGxlbWVudCB0aGlzIGxvb2t1cCBv
ZiBrZXlzLiBQb3NzaWJsZSBpZGVhcyBhcmU6CiAgLy8gKDEpIGRvIGEgbG9va3VwIGluIGEg
dGFibGUgb2YgdHJ1c3RlZCBjZXJ0cyBrZXllZCBvZmYgb2YgY29uc3VtZXIKICAvLwogIC8v
IEVpdGhlciB3YXkgc2hvdWxkIHJldHVybiBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0
aGUgY2VydGlmaWNhdGUKICBwcm90ZWN0ZWQgYWJzdHJhY3QgZnVuY3Rpb24gZmV0Y2hfcHJp
dmF0ZV9jZXJ0KCYkcmVxdWVzdCk7CgogIHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWduYXR1
cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAkYmFzZV9zdHJpbmcgPSAk
cmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpOwogICAgJHJlcXVlc3QtPmJh
c2Vfc3RyaW5nID0gJGJhc2Vfc3RyaW5nOwoKICAgIC8vIEZldGNoIHRoZSBwcml2YXRlIGtl
eSBjZXJ0IGJhc2VkIG9uIHRoZSByZXF1ZXN0CiAgICAkY2VydCA9ICR0aGlzLT5mZXRjaF9w
cml2YXRlX2NlcnQoJHJlcXVlc3QpOwoKICAgIC8vIFB1bGwgdGhlIHByaXZhdGUga2V5IElE
IGZyb20gdGhlIGNlcnRpZmljYXRlCiAgICAkcHJpdmF0ZWtleWlkID0gb3BlbnNzbF9nZXRf
cHJpdmF0ZWtleSgkY2VydCk7CgogICAgLy8gU2lnbiB1c2luZyB0aGUga2V5CiAgICAkb2sg
PSBvcGVuc3NsX3NpZ24oJGJhc2Vfc3RyaW5nLCAkc2lnbmF0dXJlLCAkcHJpdmF0ZWtleWlk
KTsKCiAgICAvLyBSZWxlYXNlIHRoZSBrZXkgcmVzb3VyY2UKICAgIG9wZW5zc2xfZnJlZV9r
ZXkoJHByaXZhdGVrZXlpZCk7CgogICAgcmV0dXJuIGJhc2U2NF9lbmNvZGUoJHNpZ25hdHVy
ZSk7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gY2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAk
Y29uc3VtZXIsICR0b2tlbiwgJHNpZ25hdHVyZSkgewogICAgJGRlY29kZWRfc2lnID0gYmFz
ZTY0X2RlY29kZSgkc2lnbmF0dXJlKTsKCiAgICAkYmFzZV9zdHJpbmcgPSAkcmVxdWVzdC0+
Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpOwoKICAgIC8vIEZldGNoIHRoZSBwdWJsaWMg
a2V5IGNlcnQgYmFzZWQgb24gdGhlIHJlcXVlc3QKICAgICRjZXJ0ID0gJHRoaXMtPmZldGNo
X3B1YmxpY19jZXJ0KCRyZXF1ZXN0KTsKCiAgICAvLyBQdWxsIHRoZSBwdWJsaWMga2V5IElE
IGZyb20gdGhlIGNlcnRpZmljYXRlCiAgICAkcHVibGlja2V5aWQgPSBvcGVuc3NsX2dldF9w
dWJsaWNrZXkoJGNlcnQpOwoKICAgIC8vIENoZWNrIHRoZSBjb21wdXRlZCBzaWduYXR1cmUg
YWdhaW5zdCB0aGUgb25lIHBhc3NlZCBpbiB0aGUgcXVlcnkKICAgICRvayA9IG9wZW5zc2xf
dmVyaWZ5KCRiYXNlX3N0cmluZywgJGRlY29kZWRfc2lnLCAkcHVibGlja2V5aWQpOwoKICAg
IC8vIFJlbGVhc2UgdGhlIGtleSByZXNvdXJjZQogICAgb3BlbnNzbF9mcmVlX2tleSgkcHVi
bGlja2V5aWQpOwoKICAgIHJldHVybiAkb2sgPT0gMTsKICB9Cn0KCmNsYXNzIE9BdXRoUmVx
dWVzdCB7CiAgcHJpdmF0ZSAkcGFyYW1ldGVyczsKICBwcml2YXRlICRodHRwX21ldGhvZDsK
ICBwcml2YXRlICRodHRwX3VybDsKICAvLyBmb3IgZGVidWcgcHVycG9zZXMKICBwdWJsaWMg
JGJhc2Vfc3RyaW5nOwogIHB1YmxpYyBzdGF0aWMgJHZlcnNpb24gPSAnMS4wJzsKICBwdWJs
aWMgc3RhdGljICRQT1NUX0lOUFVUID0gJ3BocDovL2lucHV0JzsKCiAgZnVuY3Rpb24gX19j
b25zdHJ1Y3QoJGh0dHBfbWV0aG9kLCAkaHR0cF91cmwsICRwYXJhbWV0ZXJzPU5VTEwpIHsK
ICAgIEAkcGFyYW1ldGVycyBvciAkcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICAkcGFyYW1l
dGVycyA9IGFycmF5X21lcmdlKCBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMocGFyc2Vf
dXJsKCRodHRwX3VybCwgUEhQX1VSTF9RVUVSWSkpLCAkcGFyYW1ldGVycyk7CiAgICAkdGhp
cy0+cGFyYW1ldGVycyA9ICRwYXJhbWV0ZXJzOwogICAgJHRoaXMtPmh0dHBfbWV0aG9kID0g
JGh0dHBfbWV0aG9kOwogICAgJHRoaXMtPmh0dHBfdXJsID0gJGh0dHBfdXJsOwogIH0KCgog
IC8qKgogICAqIGF0dGVtcHQgdG8gYnVpbGQgdXAgYSByZXF1ZXN0IGZyb20gd2hhdCB3YXMg
cGFzc2VkIHRvIHRoZSBzZXJ2ZXIKICAgKi8KICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGZy
b21fcmVxdWVzdCgkaHR0cF9tZXRob2Q9TlVMTCwgJGh0dHBfdXJsPU5VTEwsICRwYXJhbWV0
ZXJzPU5VTEwpIHsKICAgICRzY2hlbWUgPSAoIWlzc2V0KCRfU0VSVkVSWydIVFRQUyddKSB8
fCAkX1NFUlZFUlsnSFRUUFMnXSAhPSAib24iKQogICAgICAgICAgICAgID8gJ2h0dHAnCiAg
ICAgICAgICAgICAgOiAnaHR0cHMnOwogICAgQCRodHRwX3VybCBvciAkaHR0cF91cmwgPSAk
c2NoZW1lIC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzovLycgLiAkX1NFUlZF
UlsnSFRUUF9IT1NUJ10gLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnOicgLgog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkX1NFUlZFUlsnU0VSVkVSX1BPUlQnXSAu
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRfU0VSVkVSWydSRVFVRVNUX1VSSSdd
OwogICAgQCRodHRwX21ldGhvZCBvciAkaHR0cF9tZXRob2QgPSAkX1NFUlZFUlsnUkVRVUVT
VF9NRVRIT0QnXTsKCiAgICAvLyBXZSB3ZXJlbid0IGhhbmRlZCBhbnkgcGFyYW1ldGVycywg
c28gbGV0J3MgZmluZCB0aGUgb25lcyByZWxldmFudCB0bwogICAgLy8gdGhpcyByZXF1ZXN0
LgogICAgLy8gSWYgeW91IHJ1biBYTUwtUlBDIG9yIHNpbWlsYXIgeW91IHNob3VsZCB1c2Ug
dGhpcyB0byBwcm92aWRlIHlvdXIgb3duCiAgICAvLyBwYXJzZWQgcGFyYW1ldGVyLWxpc3QK
ICAgIGlmICghJHBhcmFtZXRlcnMpIHsKICAgICAgLy8gRmluZCByZXF1ZXN0IGhlYWRlcnMK
ICAgICAgJHJlcXVlc3RfaGVhZGVycyA9IE9BdXRoVXRpbDo6Z2V0X2hlYWRlcnMoKTsKCiAg
ICAgIC8vIFBhcnNlIHRoZSBxdWVyeS1zdHJpbmcgdG8gZmluZCBHRVQgcGFyYW1ldGVycwog
ICAgICAkcGFyYW1ldGVycyA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygkX1NFUlZF
UlsnUVVFUllfU1RSSU5HJ10pOwoKICAgICAgLy8gSXQncyBhIFBPU1QgcmVxdWVzdCBvZiB0
aGUgcHJvcGVyIGNvbnRlbnQtdHlwZSwgc28gcGFyc2UgUE9TVAogICAgICAvLyBwYXJhbWV0
ZXJzIGFuZCBhZGQgdGhvc2Ugb3ZlcnJpZGluZyBhbnkgZHVwbGljYXRlcyBmcm9tIEdFVAog
ICAgICBpZiAoJGh0dHBfbWV0aG9kID09ICJQT1NUIgogICAgICAgICAgJiYgQHN0cnN0cigk
cmVxdWVzdF9oZWFkZXJzWyJDb250ZW50LVR5cGUiXSwKICAgICAgICAgICAgICAgICAgICAg
ImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpCiAgICAgICAgICApIHsKICAg
ICAgICAkcG9zdF9kYXRhID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKAogICAgICAg
ICAgZmlsZV9nZXRfY29udGVudHMoc2VsZjo6JFBPU1RfSU5QVVQpCiAgICAgICAgKTsKICAg
ICAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCRwYXJhbWV0ZXJzLCAkcG9zdF9kYXRh
KTsKICAgICAgfQoKICAgICAgLy8gV2UgaGF2ZSBhIEF1dGhvcml6YXRpb24taGVhZGVyIHdp
dGggT0F1dGggZGF0YS4gUGFyc2UgdGhlIGhlYWRlcgogICAgICAvLyBhbmQgYWRkIHRob3Nl
IG92ZXJyaWRpbmcgYW55IGR1cGxpY2F0ZXMgZnJvbSBHRVQgb3IgUE9TVAogICAgICBpZiAo
QHN1YnN0cigkcmVxdWVzdF9oZWFkZXJzWydBdXRob3JpemF0aW9uJ10sIDAsIDYpID09ICJP
QXV0aCAiKSB7CiAgICAgICAgJGhlYWRlcl9wYXJhbWV0ZXJzID0gT0F1dGhVdGlsOjpzcGxp
dF9oZWFkZXIoCiAgICAgICAgICAkcmVxdWVzdF9oZWFkZXJzWydBdXRob3JpemF0aW9uJ10K
ICAgICAgICApOwogICAgICAgICRwYXJhbWV0ZXJzID0gYXJyYXlfbWVyZ2UoJHBhcmFtZXRl
cnMsICRoZWFkZXJfcGFyYW1ldGVycyk7CiAgICAgIH0KCiAgICB9CgogICAgcmV0dXJuIG5l
dyBPQXV0aFJlcXVlc3QoJGh0dHBfbWV0aG9kLCAkaHR0cF91cmwsICRwYXJhbWV0ZXJzKTsK
ICB9CgogIC8qKgogICAqIHByZXR0eSBtdWNoIGEgaGVscGVyIGZ1bmN0aW9uIHRvIHNldCB1
cCB0aGUgcmVxdWVzdAogICAqLwogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZnJvbV9jb25z
dW1lcl9hbmRfdG9rZW4oJGNvbnN1bWVyLCAkdG9rZW4sICRodHRwX21ldGhvZCwgJGh0dHBf
dXJsLCAkcGFyYW1ldGVycz1OVUxMKSB7CiAgICBAJHBhcmFtZXRlcnMgb3IgJHBhcmFtZXRl
cnMgPSBhcnJheSgpOwogICAgJGRlZmF1bHRzID0gYXJyYXkoIm9hdXRoX3ZlcnNpb24iID0+
IE9BdXRoUmVxdWVzdDo6JHZlcnNpb24sCiAgICAgICAgICAgICAgICAgICAgICAib2F1dGhf
bm9uY2UiID0+IE9BdXRoUmVxdWVzdDo6Z2VuZXJhdGVfbm9uY2UoKSwKICAgICAgICAgICAg
ICAgICAgICAgICJvYXV0aF90aW1lc3RhbXAiID0+IE9BdXRoUmVxdWVzdDo6Z2VuZXJhdGVf
dGltZXN0YW1wKCksCiAgICAgICAgICAgICAgICAgICAgICAib2F1dGhfY29uc3VtZXJfa2V5
IiA9PiAkY29uc3VtZXItPmtleSk7CiAgICBpZiAoJHRva2VuKQogICAgICAkZGVmYXVsdHNb
J29hdXRoX3Rva2VuJ10gPSAkdG9rZW4tPmtleTsKCiAgICAkcGFyYW1ldGVycyA9IGFycmF5
X21lcmdlKCRkZWZhdWx0cywgJHBhcmFtZXRlcnMpOwoKICAgIHJldHVybiBuZXcgT0F1dGhS
ZXF1ZXN0KCRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVycyk7CiAgfQoKICBw
dWJsaWMgZnVuY3Rpb24gc2V0X3BhcmFtZXRlcigkbmFtZSwgJHZhbHVlLCAkYWxsb3dfZHVw
bGljYXRlcyA9IHRydWUpIHsKICAgIGlmICgkYWxsb3dfZHVwbGljYXRlcyAmJiBpc3NldCgk
dGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pKSB7CiAgICAgIC8vIFdlIGhhdmUgYWxyZWFkeSBh
ZGRlZCBwYXJhbWV0ZXIocykgd2l0aCB0aGlzIG5hbWUsIHNvIGFkZCB0byB0aGUgbGlzdAog
ICAgICBpZiAoaXNfc2NhbGFyKCR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSkpIHsKICAgICAg
ICAvLyBUaGlzIGlzIHRoZSBmaXJzdCBkdXBsaWNhdGUsIHNvIHRyYW5zZm9ybSBzY2FsYXIg
KHN0cmluZykKICAgICAgICAvLyBpbnRvIGFuIGFycmF5IHNvIHdlIGNhbiBhZGQgdGhlIGR1
cGxpY2F0ZXMKICAgICAgICAkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0gPSBhcnJheSgkdGhp
cy0+cGFyYW1ldGVyc1skbmFtZV0pOwogICAgICB9CgogICAgICAkdGhpcy0+cGFyYW1ldGVy
c1skbmFtZV1bXSA9ICR2YWx1ZTsKICAgIH0gZWxzZSB7CiAgICAgICR0aGlzLT5wYXJhbWV0
ZXJzWyRuYW1lXSA9ICR2YWx1ZTsKICAgIH0KICB9CgogIHB1YmxpYyBmdW5jdGlvbiBnZXRf
cGFyYW1ldGVyKCRuYW1lKSB7CiAgICByZXR1cm4gaXNzZXQoJHRoaXMtPnBhcmFtZXRlcnNb
JG5hbWVdKSA/ICR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSA6IG51bGw7CiAgfQoKICBwdWJs
aWMgZnVuY3Rpb24gZ2V0X3BhcmFtZXRlcnMoKSB7CiAgICByZXR1cm4gJHRoaXMtPnBhcmFt
ZXRlcnM7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gdW5zZXRfcGFyYW1ldGVyKCRuYW1lKSB7
CiAgICB1bnNldCgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pOwogIH0KCiAgLyoqCiAgICog
VGhlIHJlcXVlc3QgcGFyYW1ldGVycywgc29ydGVkIGFuZCBjb25jYXRlbmF0ZWQgaW50byBh
IG5vcm1hbGl6ZWQgc3RyaW5nLgogICAqIEByZXR1cm4gc3RyaW5nCiAgICovCiAgcHVibGlj
IGZ1bmN0aW9uIGdldF9zaWduYWJsZV9wYXJhbWV0ZXJzKCkgewogICAgLy8gR3JhYiBhbGwg
cGFyYW1ldGVycwogICAgJHBhcmFtcyA9ICR0aGlzLT5wYXJhbWV0ZXJzOwoKICAgIC8vIFJl
bW92ZSBvYXV0aF9zaWduYXR1cmUgaWYgcHJlc2VudAogICAgLy8gUmVmOiBTcGVjOiA5LjEu
MSAoIlRoZSBvYXV0aF9zaWduYXR1cmUgcGFyYW1ldGVyIE1VU1QgYmUgZXhjbHVkZWQuIikK
ICAgIGlmIChpc3NldCgkcGFyYW1zWydvYXV0aF9zaWduYXR1cmUnXSkpIHsKICAgICAgdW5z
ZXQoJHBhcmFtc1snb2F1dGhfc2lnbmF0dXJlJ10pOwogICAgfQoKICAgIHJldHVybiBPQXV0
aFV0aWw6OmJ1aWxkX2h0dHBfcXVlcnkoJHBhcmFtcyk7CiAgfQoKICAvKioKICAgKiBSZXR1
cm5zIHRoZSBiYXNlIHN0cmluZyBvZiB0aGlzIHJlcXVlc3QKICAgKgogICAqIFRoZSBiYXNl
IHN0cmluZyBkZWZpbmVkIGFzIHRoZSBtZXRob2QsIHRoZSB1cmwKICAgKiBhbmQgdGhlIHBh
cmFtZXRlcnMgKG5vcm1hbGl6ZWQpLCBlYWNoIHVybGVuY29kZWQKICAgKiBhbmQgdGhlIGNv
bmNhdGVkIHdpdGggJi4KICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZ2V0X3NpZ25hdHVyZV9i
YXNlX3N0cmluZygpIHsKICAgICRwYXJ0cyA9IGFycmF5KAogICAgICAkdGhpcy0+Z2V0X25v
cm1hbGl6ZWRfaHR0cF9tZXRob2QoKSwKICAgICAgJHRoaXMtPmdldF9ub3JtYWxpemVkX2h0
dHBfdXJsKCksCiAgICAgICR0aGlzLT5nZXRfc2lnbmFibGVfcGFyYW1ldGVycygpCiAgICAp
OwoKICAgICRwYXJ0cyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJHBhcnRzKTsK
CiAgICByZXR1cm4gaW1wbG9kZSgnJicsICRwYXJ0cyk7CiAgfQoKICAvKioKICAgKiBqdXN0
IHVwcGVyY2FzZXMgdGhlIGh0dHAgbWV0aG9kCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGdl
dF9ub3JtYWxpemVkX2h0dHBfbWV0aG9kKCkgewogICAgcmV0dXJuIHN0cnRvdXBwZXIoJHRo
aXMtPmh0dHBfbWV0aG9kKTsKICB9CgogIC8qKgogICAqIHBhcnNlcyB0aGUgdXJsIGFuZCBy
ZWJ1aWxkcyBpdCB0byBiZQogICAqIHNjaGVtZTovL2hvc3QvcGF0aAogICAqLwogIHB1Ymxp
YyBmdW5jdGlvbiBnZXRfbm9ybWFsaXplZF9odHRwX3VybCgpIHsKICAgICRwYXJ0cyA9IHBh
cnNlX3VybCgkdGhpcy0+aHR0cF91cmwpOwoKICAgICRwb3J0ID0gQCRwYXJ0c1sncG9ydCdd
OwogICAgJHNjaGVtZSA9ICRwYXJ0c1snc2NoZW1lJ107CiAgICAkaG9zdCA9ICRwYXJ0c1sn
aG9zdCddOwogICAgJHBhdGggPSBAJHBhcnRzWydwYXRoJ107CgogICAgJHBvcnQgb3IgJHBv
cnQgPSAoJHNjaGVtZSA9PSAnaHR0cHMnKSA/ICc0NDMnIDogJzgwJzsKCiAgICBpZiAoKCRz
Y2hlbWUgPT0gJ2h0dHBzJyAmJiAkcG9ydCAhPSAnNDQzJykKICAgICAgICB8fCAoJHNjaGVt
ZSA9PSAnaHR0cCcgJiYgJHBvcnQgIT0gJzgwJykpIHsKICAgICAgJGhvc3QgPSAiJGhvc3Q6
JHBvcnQiOwogICAgfQogICAgcmV0dXJuICIkc2NoZW1lOi8vJGhvc3QkcGF0aCI7CiAgfQoK
ICAvKioKICAgKiBidWlsZHMgYSB1cmwgdXNhYmxlIGZvciBhIEdFVCByZXF1ZXN0CiAgICov
CiAgcHVibGljIGZ1bmN0aW9uIHRvX3VybCgpIHsKICAgICRwb3N0X2RhdGEgPSAkdGhpcy0+
dG9fcG9zdGRhdGEoKTsKICAgICRvdXQgPSAkdGhpcy0+Z2V0X25vcm1hbGl6ZWRfaHR0cF91
cmwoKTsKICAgIGlmICgkcG9zdF9kYXRhKSB7CiAgICAgICRvdXQgLj0gJz8nLiRwb3N0X2Rh
dGE7CiAgICB9CiAgICByZXR1cm4gJG91dDsKICB9CgogIC8qKgogICAqIGJ1aWxkcyB0aGUg
ZGF0YSBvbmUgd291bGQgc2VuZCBpbiBhIFBPU1QgcmVxdWVzdAogICAqLwogIHB1YmxpYyBm
dW5jdGlvbiB0b19wb3N0ZGF0YSgpIHsKICAgIHJldHVybiBPQXV0aFV0aWw6OmJ1aWxkX2h0
dHBfcXVlcnkoJHRoaXMtPnBhcmFtZXRlcnMpOwogIH0KCiAgLyoqCiAgICogYnVpbGRzIHRo
ZSBBdXRob3JpemF0aW9uOiBoZWFkZXIKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gdG9faGVh
ZGVyKCRyZWFsbT1udWxsKSB7CiAgICAkZmlyc3QgPSB0cnVlOwogIGlmKCRyZWFsbSkgewog
ICAgICAkb3V0ID0gJ0F1dGhvcml6YXRpb246IE9BdXRoIHJlYWxtPSInIC4gT0F1dGhVdGls
Ojp1cmxlbmNvZGVfcmZjMzk4NigkcmVhbG0pIC4gJyInOwogICAgICAkZmlyc3QgPSBmYWxz
ZTsKICAgIH0gZWxzZQogICAgICAkb3V0ID0gJ0F1dGhvcml6YXRpb246IE9BdXRoJzsKCiAg
ICAkdG90YWwgPSBhcnJheSgpOwogICAgZm9yZWFjaCAoJHRoaXMtPnBhcmFtZXRlcnMgYXMg
JGsgPT4gJHYpIHsKICAgICAgaWYgKHN1YnN0cigkaywgMCwgNSkgIT0gIm9hdXRoIikgY29u
dGludWU7CiAgICAgIGlmIChpc19hcnJheSgkdikpIHsKICAgICAgICB0aHJvdyBuZXcgT0F1
dGhFeGNlcHRpb24oJ0FycmF5cyBub3Qgc3VwcG9ydGVkIGluIGhlYWRlcnMnKTsKICAgICAg
fQogICAgICAkb3V0IC49ICgkZmlyc3QpID8gJyAnIDogJywnOwogICAgICAkb3V0IC49IE9B
dXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJGspIC4KICAgICAgICAgICAgICAnPSInIC4K
ICAgICAgICAgICAgICBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCR2KSAuCiAgICAg
ICAgICAgICAgJyInOwogICAgICAkZmlyc3QgPSBmYWxzZTsKICAgIH0KICAgIHJldHVybiAk
b3V0OwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIF9fdG9TdHJpbmcoKSB7CiAgICByZXR1cm4g
JHRoaXMtPnRvX3VybCgpOwogIH0KCgogIHB1YmxpYyBmdW5jdGlvbiBzaWduX3JlcXVlc3Qo
JHNpZ25hdHVyZV9tZXRob2QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAkdGhpcy0+c2V0
X3BhcmFtZXRlcigKICAgICAgIm9hdXRoX3NpZ25hdHVyZV9tZXRob2QiLAogICAgICAkc2ln
bmF0dXJlX21ldGhvZC0+Z2V0X25hbWUoKSwKICAgICAgZmFsc2UKICAgICk7CiAgICAkc2ln
bmF0dXJlID0gJHRoaXMtPmJ1aWxkX3NpZ25hdHVyZSgkc2lnbmF0dXJlX21ldGhvZCwgJGNv
bnN1bWVyLCAkdG9rZW4pOwogICAgJHRoaXMtPnNldF9wYXJhbWV0ZXIoIm9hdXRoX3NpZ25h
dHVyZSIsICRzaWduYXR1cmUsIGZhbHNlKTsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBidWls
ZF9zaWduYXR1cmUoJHNpZ25hdHVyZV9tZXRob2QsICRjb25zdW1lciwgJHRva2VuKSB7CiAg
ICAkc2lnbmF0dXJlID0gJHNpZ25hdHVyZV9tZXRob2QtPmJ1aWxkX3NpZ25hdHVyZSgkdGhp
cywgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAgcmV0dXJuICRzaWduYXR1cmU7CiAgfQoKICAv
KioKICAgKiB1dGlsIGZ1bmN0aW9uOiBjdXJyZW50IHRpbWVzdGFtcAogICAqLwogIHByaXZh
dGUgc3RhdGljIGZ1bmN0aW9uIGdlbmVyYXRlX3RpbWVzdGFtcCgpIHsKICAgIHJldHVybiB0
aW1lKCk7CiAgfQoKICAvKioKICAgKiB1dGlsIGZ1bmN0aW9uOiBjdXJyZW50IG5vbmNlCiAg
ICovCiAgcHJpdmF0ZSBzdGF0aWMgZnVuY3Rpb24gZ2VuZXJhdGVfbm9uY2UoKSB7CiAgICAk
bXQgPSBtaWNyb3RpbWUoKTsKICAgICRyYW5kID0gbXRfcmFuZCgpOwoKICAgIHJldHVybiBt
ZDUoJG10IC4gJHJhbmQpOyAvLyBtZDVzIGxvb2sgbmljZXIgdGhhbiBudW1iZXJzCiAgfQp9
CgpjbGFzcyBPQXV0aFNlcnZlciB7CiAgcHJvdGVjdGVkICR0aW1lc3RhbXBfdGhyZXNob2xk
ID0gMzAwOyAvLyBpbiBzZWNvbmRzLCBmaXZlIG1pbnV0ZXMKICBwcm90ZWN0ZWQgJHZlcnNp
b24gPSAnMS4wJzsgICAgICAgICAgICAgLy8gaGkgYmxhaW5lCiAgcHJvdGVjdGVkICRzaWdu
YXR1cmVfbWV0aG9kcyA9IGFycmF5KCk7CgogIHByb3RlY3RlZCAkZGF0YV9zdG9yZTsKCiAg
ZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGRhdGFfc3RvcmUpIHsKICAgICR0aGlzLT5kYXRhX3N0
b3JlID0gJGRhdGFfc3RvcmU7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gYWRkX3NpZ25hdHVy
ZV9tZXRob2QoJHNpZ25hdHVyZV9tZXRob2QpIHsKICAgICR0aGlzLT5zaWduYXR1cmVfbWV0
aG9kc1skc2lnbmF0dXJlX21ldGhvZC0+Z2V0X25hbWUoKV0gPQogICAgICAkc2lnbmF0dXJl
X21ldGhvZDsKICB9CgogIC8vIGhpZ2ggbGV2ZWwgZnVuY3Rpb25zCgogIC8qKgogICAqIHBy
b2Nlc3MgYSByZXF1ZXN0X3Rva2VuIHJlcXVlc3QKICAgKiByZXR1cm5zIHRoZSByZXF1ZXN0
IHRva2VuIG9uIHN1Y2Nlc3MKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZmV0Y2hfcmVxdWVz
dF90b2tlbigmJHJlcXVlc3QpIHsKICAgICR0aGlzLT5nZXRfdmVyc2lvbigkcmVxdWVzdCk7
CgogICAgJGNvbnN1bWVyID0gJHRoaXMtPmdldF9jb25zdW1lcigkcmVxdWVzdCk7CgogICAg
Ly8gbm8gdG9rZW4gcmVxdWlyZWQgZm9yIHRoZSBpbml0aWFsIHRva2VuIHJlcXVlc3QKICAg
ICR0b2tlbiA9IE5VTEw7CgogICAgJHRoaXMtPmNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwg
JGNvbnN1bWVyLCAkdG9rZW4pOwoKICAgIC8vIFJldiBBIGNoYW5nZQogICAgJGNhbGxiYWNr
ID0gJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX2NhbGxiYWNrJyk7CiAgICAkbmV3
X3Rva2VuID0gJHRoaXMtPmRhdGFfc3RvcmUtPm5ld19yZXF1ZXN0X3Rva2VuKCRjb25zdW1l
ciwgJGNhbGxiYWNrKTsKCiAgICByZXR1cm4gJG5ld190b2tlbjsKICB9CgogIC8qKgogICAq
IHByb2Nlc3MgYW4gYWNjZXNzX3Rva2VuIHJlcXVlc3QKICAgKiByZXR1cm5zIHRoZSBhY2Nl
c3MgdG9rZW4gb24gc3VjY2VzcwogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBmZXRjaF9hY2Nl
c3NfdG9rZW4oJiRyZXF1ZXN0KSB7CiAgICAkdGhpcy0+Z2V0X3ZlcnNpb24oJHJlcXVlc3Qp
OwoKICAgICRjb25zdW1lciA9ICR0aGlzLT5nZXRfY29uc3VtZXIoJHJlcXVlc3QpOwoKICAg
IC8vIHJlcXVpcmVzIGF1dGhvcml6ZWQgcmVxdWVzdCB0b2tlbgogICAgJHRva2VuID0gJHRo
aXMtPmdldF90b2tlbigkcmVxdWVzdCwgJGNvbnN1bWVyLCAicmVxdWVzdCIpOwoKICAgICR0
aGlzLT5jaGVja19zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKTsKCiAg
ICAvLyBSZXYgQSBjaGFuZ2UKICAgICR2ZXJpZmllciA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1l
dGVyKCdvYXV0aF92ZXJpZmllcicpOwogICAgJG5ld190b2tlbiA9ICR0aGlzLT5kYXRhX3N0
b3JlLT5uZXdfYWNjZXNzX3Rva2VuKCR0b2tlbiwgJGNvbnN1bWVyLCAkdmVyaWZpZXIpOwoK
ICAgIHJldHVybiAkbmV3X3Rva2VuOwogIH0KCiAgLyoqCiAgICogdmVyaWZ5IGFuIGFwaSBj
YWxsLCBjaGVja3MgYWxsIHRoZSBwYXJhbWV0ZXJzCiAgICovCiAgcHVibGljIGZ1bmN0aW9u
IHZlcmlmeV9yZXF1ZXN0KCYkcmVxdWVzdCkgewogICAgJHRoaXMtPmdldF92ZXJzaW9uKCRy
ZXF1ZXN0KTsKICAgICRjb25zdW1lciA9ICR0aGlzLT5nZXRfY29uc3VtZXIoJHJlcXVlc3Qp
OwogICAgJHRva2VuID0gJHRoaXMtPmdldF90b2tlbigkcmVxdWVzdCwgJGNvbnN1bWVyLCAi
YWNjZXNzIik7CiAgICAkdGhpcy0+Y2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3Vt
ZXIsICR0b2tlbik7CiAgICByZXR1cm4gYXJyYXkoJGNvbnN1bWVyLCAkdG9rZW4pOwogIH0K
CiAgLy8gSW50ZXJuYWxzIGZyb20gaGVyZQogIC8qKgogICAqIHZlcnNpb24gMQogICAqLwog
IHByaXZhdGUgZnVuY3Rpb24gZ2V0X3ZlcnNpb24oJiRyZXF1ZXN0KSB7CiAgICAkdmVyc2lv
biA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCJvYXV0aF92ZXJzaW9uIik7CiAgICBpZiAo
ISR2ZXJzaW9uKSB7CiAgICAgIC8vIFNlcnZpY2UgUHJvdmlkZXJzIE1VU1QgYXNzdW1lIHRo
ZSBwcm90b2NvbCB2ZXJzaW9uIHRvIGJlIDEuMCBpZiB0aGlzIHBhcmFtZXRlciBpcyBub3Qg
cHJlc2VudC4KICAgICAgLy8gQ2hhcHRlciA3LjAgKCJBY2Nlc3NpbmcgUHJvdGVjdGVkIFJl
c3NvdXJjZXMiKQogICAgICAkdmVyc2lvbiA9ICcxLjAnOwogICAgfQogICAgaWYgKCR2ZXJz
aW9uICE9PSAkdGhpcy0+dmVyc2lvbikgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRp
b24oIk9BdXRoIHZlcnNpb24gJyR2ZXJzaW9uJyBub3Qgc3VwcG9ydGVkIik7CiAgICB9CiAg
ICByZXR1cm4gJHZlcnNpb247CiAgfQoKICAvKioKICAgKiBmaWd1cmUgb3V0IHRoZSBzaWdu
YXR1cmUgd2l0aCBzb21lIGRlZmF1bHRzCiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBnZXRf
c2lnbmF0dXJlX21ldGhvZCgmJHJlcXVlc3QpIHsKICAgICRzaWduYXR1cmVfbWV0aG9kID0K
ICAgICAgICBAJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoIm9hdXRoX3NpZ25hdHVyZV9tZXRo
b2QiKTsKCiAgICBpZiAoISRzaWduYXR1cmVfbWV0aG9kKSB7CiAgICAgIC8vIEFjY29yZGlu
ZyB0byBjaGFwdGVyIDcgKCJBY2Nlc3NpbmcgUHJvdGVjdGVkIFJlc3NvdXJjZXMiKSB0aGUg
c2lnbmF0dXJlLW1ldGhvZAogICAgICAvLyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQsIGFuZCB3
ZSBjYW4ndCBqdXN0IGZhbGxiYWNrIHRvIFBMQUlOVEVYVAogICAgICB0aHJvdyBuZXcgT0F1
dGhFeGNlcHRpb24oJ05vIHNpZ25hdHVyZSBtZXRob2QgcGFyYW1ldGVyLiBUaGlzIHBhcmFt
ZXRlciBpcyByZXF1aXJlZCcpOwogICAgfQoKICAgIGlmICghaW5fYXJyYXkoJHNpZ25hdHVy
ZV9tZXRob2QsCiAgICAgICAgICAgICAgICAgIGFycmF5X2tleXMoJHRoaXMtPnNpZ25hdHVy
ZV9tZXRob2RzKSkpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKAogICAgICAg
ICJTaWduYXR1cmUgbWV0aG9kICckc2lnbmF0dXJlX21ldGhvZCcgbm90IHN1cHBvcnRlZCAi
IC4KICAgICAgICAidHJ5IG9uZSBvZiB0aGUgZm9sbG93aW5nOiAiIC4KICAgICAgICBpbXBs
b2RlKCIsICIsIGFycmF5X2tleXMoJHRoaXMtPnNpZ25hdHVyZV9tZXRob2RzKSkKICAgICAg
KTsKICAgIH0KICAgIHJldHVybiAkdGhpcy0+c2lnbmF0dXJlX21ldGhvZHNbJHNpZ25hdHVy
ZV9tZXRob2RdOwogIH0KCiAgLyoqCiAgICogdHJ5IHRvIGZpbmQgdGhlIGNvbnN1bWVyIGZv
ciB0aGUgcHJvdmlkZWQgcmVxdWVzdCdzIGNvbnN1bWVyIGtleQogICAqLwogIHByaXZhdGUg
ZnVuY3Rpb24gZ2V0X2NvbnN1bWVyKCYkcmVxdWVzdCkgewogICAgJGNvbnN1bWVyX2tleSA9
IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcigib2F1dGhfY29uc3VtZXJfa2V5Iik7CiAgICBp
ZiAoISRjb25zdW1lcl9rZXkpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJ
bnZhbGlkIGNvbnN1bWVyIGtleSIpOwogICAgfQoKICAgICRjb25zdW1lciA9ICR0aGlzLT5k
YXRhX3N0b3JlLT5sb29rdXBfY29uc3VtZXIoJGNvbnN1bWVyX2tleSk7CiAgICBpZiAoISRj
b25zdW1lcikgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIkludmFsaWQgY29u
c3VtZXIiKTsKICAgIH0KCiAgICByZXR1cm4gJGNvbnN1bWVyOwogIH0KCiAgLyoqCiAgICog
dHJ5IHRvIGZpbmQgdGhlIHRva2VuIGZvciB0aGUgcHJvdmlkZWQgcmVxdWVzdCdzIHRva2Vu
IGtleQogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X3Rva2VuKCYkcmVxdWVzdCwgJGNv
bnN1bWVyLCAkdG9rZW5fdHlwZT0iYWNjZXNzIikgewogICAgJHRva2VuX2ZpZWxkID0gQCRy
ZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF90b2tlbicpOwogICAgJHRva2VuID0gJHRo
aXMtPmRhdGFfc3RvcmUtPmxvb2t1cF90b2tlbigKICAgICAgJGNvbnN1bWVyLCAkdG9rZW5f
dHlwZSwgJHRva2VuX2ZpZWxkCiAgICApOwogICAgaWYgKCEkdG9rZW4pIHsKICAgICAgdGhy
b3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJbnZhbGlkICR0b2tlbl90eXBlIHRva2VuOiAkdG9r
ZW5fZmllbGQiKTsKICAgIH0KICAgIHJldHVybiAkdG9rZW47CiAgfQoKICAvKioKICAgKiBh
bGwtaW4tb25lIGZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBzaWduYXR1cmUgb24gYSByZXF1ZXN0
CiAgICogc2hvdWxkIGd1ZXNzIHRoZSBzaWduYXR1cmUgbWV0aG9kIGFwcHJvcHJpYXRlbHkK
ICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGNoZWNrX3NpZ25hdHVyZSgmJHJlcXVlc3QsICRj
b25zdW1lciwgJHRva2VuKSB7CiAgICAvLyB0aGlzIHNob3VsZCBwcm9iYWJseSBiZSBpbiBh
IGRpZmZlcmVudCBtZXRob2QKICAgICR0aW1lc3RhbXAgPSBAJHJlcXVlc3QtPmdldF9wYXJh
bWV0ZXIoJ29hdXRoX3RpbWVzdGFtcCcpOwogICAgJG5vbmNlID0gQCRyZXF1ZXN0LT5nZXRf
cGFyYW1ldGVyKCdvYXV0aF9ub25jZScpOwoKICAgICR0aGlzLT5jaGVja190aW1lc3RhbXAo
JHRpbWVzdGFtcCk7CiAgICAkdGhpcy0+Y2hlY2tfbm9uY2UoJGNvbnN1bWVyLCAkdG9rZW4s
ICRub25jZSwgJHRpbWVzdGFtcCk7CgogICAgJHNpZ25hdHVyZV9tZXRob2QgPSAkdGhpcy0+
Z2V0X3NpZ25hdHVyZV9tZXRob2QoJHJlcXVlc3QpOwoKICAgICRzaWduYXR1cmUgPSAkcmVx
dWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfc2lnbmF0dXJlJyk7CiAgICAkdmFsaWRfc2ln
ID0gJHNpZ25hdHVyZV9tZXRob2QtPmNoZWNrX3NpZ25hdHVyZSgKICAgICAgJHJlcXVlc3Qs
CiAgICAgICRjb25zdW1lciwKICAgICAgJHRva2VuLAogICAgICAkc2lnbmF0dXJlCiAgICAp
OwoKICAgIGlmICghJHZhbGlkX3NpZykgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRp
b24oIkludmFsaWQgc2lnbmF0dXJlIik7CiAgICB9CiAgfQoKICAvKioKICAgKiBjaGVjayB0
aGF0IHRoZSB0aW1lc3RhbXAgaXMgbmV3IGVub3VnaAogICAqLwogIHByaXZhdGUgZnVuY3Rp
b24gY2hlY2tfdGltZXN0YW1wKCR0aW1lc3RhbXApIHsKICAgIGlmKCAhICR0aW1lc3RhbXAg
KQogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAgICAgJ01pc3NpbmcgdGlt
ZXN0YW1wIHBhcmFtZXRlci4gVGhlIHBhcmFtZXRlciBpcyByZXF1aXJlZCcKICAgICAgKTsK
CiAgICAvLyB2ZXJpZnkgdGhhdCB0aW1lc3RhbXAgaXMgcmVjZW50aXNoCiAgICAkbm93ID0g
dGltZSgpOwogICAgaWYgKGFicygkbm93IC0gJHRpbWVzdGFtcCkgPiAkdGhpcy0+dGltZXN0
YW1wX3RocmVzaG9sZCkgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAg
ICAgIkV4cGlyZWQgdGltZXN0YW1wLCB5b3VycyAkdGltZXN0YW1wLCBvdXJzICRub3ciCiAg
ICAgICk7CiAgICB9CiAgfQoKICAvKioKICAgKiBjaGVjayB0aGF0IHRoZSBub25jZSBpcyBu
b3QgcmVwZWF0ZWQKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGNoZWNrX25vbmNlKCRjb25z
dW1lciwgJHRva2VuLCAkbm9uY2UsICR0aW1lc3RhbXApIHsKICAgIGlmKCAhICRub25jZSAp
CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigKICAgICAgICAnTWlzc2luZyBub25j
ZSBwYXJhbWV0ZXIuIFRoZSBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQnCiAgICAgICk7CgogICAg
Ly8gdmVyaWZ5IHRoYXQgdGhlIG5vbmNlIGlzIHVuaXF1ZWlzaAogICAgJGZvdW5kID0gJHRo
aXMtPmRhdGFfc3RvcmUtPmxvb2t1cF9ub25jZSgKICAgICAgJGNvbnN1bWVyLAogICAgICAk
dG9rZW4sCiAgICAgICRub25jZSwKICAgICAgJHRpbWVzdGFtcAogICAgKTsKICAgIGlmICgk
Zm91bmQpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJOb25jZSBhbHJlYWR5
IHVzZWQ6ICRub25jZSIpOwogICAgfQogIH0KCn0KCmNsYXNzIE9BdXRoRGF0YVN0b3JlIHsK
ICBmdW5jdGlvbiBsb29rdXBfY29uc3VtZXIoJGNvbnN1bWVyX2tleSkgewogICAgLy8gaW1w
bGVtZW50IG1lCiAgfQoKICBmdW5jdGlvbiBsb29rdXBfdG9rZW4oJGNvbnN1bWVyLCAkdG9r
ZW5fdHlwZSwgJHRva2VuKSB7CiAgICAvLyBpbXBsZW1lbnQgbWUKICB9CgogIGZ1bmN0aW9u
IGxvb2t1cF9ub25jZSgkY29uc3VtZXIsICR0b2tlbiwgJG5vbmNlLCAkdGltZXN0YW1wKSB7
CiAgICAvLyBpbXBsZW1lbnQgbWUKICB9CgogIGZ1bmN0aW9uIG5ld19yZXF1ZXN0X3Rva2Vu
KCRjb25zdW1lciwgJGNhbGxiYWNrID0gbnVsbCkgewogICAgLy8gcmV0dXJuIGEgbmV3IHRv
a2VuIGF0dGFjaGVkIHRvIHRoaXMgY29uc3VtZXIKICB9CgogIGZ1bmN0aW9uIG5ld19hY2Nl
c3NfdG9rZW4oJHRva2VuLCAkY29uc3VtZXIsICR2ZXJpZmllciA9IG51bGwpIHsKICAgIC8v
IHJldHVybiBhIG5ldyBhY2Nlc3MgdG9rZW4gYXR0YWNoZWQgdG8gdGhpcyBjb25zdW1lcgog
ICAgLy8gZm9yIHRoZSB1c2VyIGFzc29jaWF0ZWQgd2l0aCB0aGlzIHRva2VuIGlmIHRoZSBy
ZXF1ZXN0IHRva2VuCiAgICAvLyBpcyBhdXRob3JpemVkCiAgICAvLyBzaG91bGQgYWxzbyBp
bnZhbGlkYXRlIHRoZSByZXF1ZXN0IHRva2VuCiAgfQoKfQoKY2xhc3MgT0F1dGhVdGlsIHsK
ICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHVybGVuY29kZV9yZmMzOTg2KCRpbnB1dCkgewog
IGlmIChpc19hcnJheSgkaW5wdXQpKSB7CiAgICByZXR1cm4gYXJyYXlfbWFwKGFycmF5KCdP
QXV0aFV0aWwnLCAndXJsZW5jb2RlX3JmYzM5ODYnKSwgJGlucHV0KTsKICB9IGVsc2UgaWYg
KGlzX3NjYWxhcigkaW5wdXQpKSB7CiAgICByZXR1cm4gc3RyX3JlcGxhY2UoCiAgICAgICcr
JywKICAgICAgJyAnLAogICAgICBzdHJfcmVwbGFjZSgnJTdFJywgJ34nLCByYXd1cmxlbmNv
ZGUoJGlucHV0KSkKICAgICk7CiAgfSBlbHNlIHsKICAgIHJldHVybiAnJzsKICB9Cn0KCgog
IC8vIFRoaXMgZGVjb2RlIGZ1bmN0aW9uIGlzbid0IHRha2luZyBpbnRvIGNvbnNpZGVyYXRp
b24gdGhlIGFib3ZlCiAgLy8gbW9kaWZpY2F0aW9ucyB0byB0aGUgZW5jb2RpbmcgcHJvY2Vz
cy4gSG93ZXZlciwgdGhpcyBtZXRob2QgZG9lc24ndAogIC8vIHNlZW0gdG8gYmUgdXNlZCBh
bnl3aGVyZSBzbyBsZWF2aW5nIGl0IGFzIGlzLgogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24g
dXJsZGVjb2RlX3JmYzM5ODYoJHN0cmluZykgewogICAgcmV0dXJuIHVybGRlY29kZSgkc3Ry
aW5nKTsKICB9CgogIC8vIFV0aWxpdHkgZnVuY3Rpb24gZm9yIHR1cm5pbmcgdGhlIEF1dGhv
cml6YXRpb246IGhlYWRlciBpbnRvCiAgLy8gcGFyYW1ldGVycywgaGFzIHRvIGRvIHNvbWUg
dW5lc2NhcGluZwogIC8vIENhbiBmaWx0ZXIgb3V0IGFueSBub24tb2F1dGggcGFyYW1ldGVy
cyBpZiBuZWVkZWQgKGRlZmF1bHQgYmVoYXZpb3VyKQogIHB1YmxpYyBzdGF0aWMgZnVuY3Rp
b24gc3BsaXRfaGVhZGVyKCRoZWFkZXIsICRvbmx5X2FsbG93X29hdXRoX3BhcmFtZXRlcnMg
PSB0cnVlKSB7CiAgICAkcGF0dGVybiA9ICcvKChbLV9hLXpdKik9KCIoW14iXSopInwoW14s
XSopKSw/KS8nOwogICAgJG9mZnNldCA9IDA7CiAgICAkcGFyYW1zID0gYXJyYXkoKTsKICAg
IHdoaWxlIChwcmVnX21hdGNoKCRwYXR0ZXJuLCAkaGVhZGVyLCAkbWF0Y2hlcywgUFJFR19P
RkZTRVRfQ0FQVFVSRSwgJG9mZnNldCkgPiAwKSB7CiAgICAgICRtYXRjaCA9ICRtYXRjaGVz
WzBdOwogICAgICAkaGVhZGVyX25hbWUgPSAkbWF0Y2hlc1syXVswXTsKICAgICAgJGhlYWRl
cl9jb250ZW50ID0gKGlzc2V0KCRtYXRjaGVzWzVdKSkgPyAkbWF0Y2hlc1s1XVswXSA6ICRt
YXRjaGVzWzRdWzBdOwogICAgICBpZiAocHJlZ19tYXRjaCgnL15vYXV0aF8vJywgJGhlYWRl
cl9uYW1lKSB8fCAhJG9ubHlfYWxsb3dfb2F1dGhfcGFyYW1ldGVycykgewogICAgICAgICRw
YXJhbXNbJGhlYWRlcl9uYW1lXSA9IE9BdXRoVXRpbDo6dXJsZGVjb2RlX3JmYzM5ODYoJGhl
YWRlcl9jb250ZW50KTsKICAgICAgfQogICAgICAkb2Zmc2V0ID0gJG1hdGNoWzFdICsgc3Ry
bGVuKCRtYXRjaFswXSk7CiAgICB9CgogICAgaWYgKGlzc2V0KCRwYXJhbXNbJ3JlYWxtJ10p
KSB7CiAgICAgIHVuc2V0KCRwYXJhbXNbJ3JlYWxtJ10pOwogICAgfQoKICAgIHJldHVybiAk
cGFyYW1zOwogIH0KCiAgLy8gaGVscGVyIHRvIHRyeSB0byBzb3J0IG91dCBoZWFkZXJzIGZv
ciBwZW9wbGUgd2hvIGFyZW4ndCBydW5uaW5nIGFwYWNoZQogIHB1YmxpYyBzdGF0aWMgZnVu
Y3Rpb24gZ2V0X2hlYWRlcnMoKSB7CiAgICBpZiAoZnVuY3Rpb25fZXhpc3RzKCdhcGFjaGVf
cmVxdWVzdF9oZWFkZXJzJykpIHsKICAgICAgLy8gd2UgbmVlZCB0aGlzIHRvIGdldCB0aGUg
YWN0dWFsIEF1dGhvcml6YXRpb246IGhlYWRlcgogICAgICAvLyBiZWNhdXNlIGFwYWNoZSB0
ZW5kcyB0byB0ZWxsIHVzIGl0IGRvZXNuJ3QgZXhpc3QKICAgICAgJGhlYWRlcnMgPSBhcGFj
aGVfcmVxdWVzdF9oZWFkZXJzKCk7CgogICAgICAvLyBzYW5pdGl6ZSB0aGUgb3V0cHV0IG9m
IGFwYWNoZV9yZXF1ZXN0X2hlYWRlcnMgYmVjYXVzZQogICAgICAvLyB3ZSBhbHdheXMgd2Fu
dCB0aGUga2V5cyB0byBiZSBDYXNlZC1MaWtlLVRoaXMgYW5kIGFyaCgpCiAgICAgIC8vIHJl
dHVybnMgdGhlIGhlYWRlcnMgaW4gdGhlIHNhbWUgY2FzZSBhcyB0aGV5IGFyZSBpbiB0aGUK
ICAgICAgLy8gcmVxdWVzdAogICAgICAkb3V0ID0gYXJyYXkoKTsKICAgICAgZm9yZWFjaCgg
JGhlYWRlcnMgQVMgJGtleSA9PiAkdmFsdWUgKSB7CiAgICAgICAgJGtleSA9IHN0cl9yZXBs
YWNlKAogICAgICAgICAgICAiICIsCiAgICAgICAgICAgICItIiwKICAgICAgICAgICAgdWN3
b3JkcyhzdHJ0b2xvd2VyKHN0cl9yZXBsYWNlKCItIiwgIiAiLCAka2V5KSkpCiAgICAgICAg
ICApOwogICAgICAgICRvdXRbJGtleV0gPSAkdmFsdWU7CiAgICAgIH0KICAgIH0gZWxzZSB7
CiAgICAgIC8vIG90aGVyd2lzZSB3ZSBkb24ndCBoYXZlIGFwYWNoZSBhbmQgYXJlIGp1c3Qg
Z29pbmcgdG8gaGF2ZSB0byBob3BlCiAgICAgIC8vIHRoYXQgJF9TRVJWRVIgYWN0dWFsbHkg
Y29udGFpbnMgd2hhdCB3ZSBuZWVkCiAgICAgICRvdXQgPSBhcnJheSgpOwogICAgICBpZigg
aXNzZXQoJF9TRVJWRVJbJ0NPTlRFTlRfVFlQRSddKSApCiAgICAgICAgJG91dFsnQ29udGVu
dC1UeXBlJ10gPSAkX1NFUlZFUlsnQ09OVEVOVF9UWVBFJ107CiAgICAgIGlmKCBpc3NldCgk
X0VOVlsnQ09OVEVOVF9UWVBFJ10pICkKICAgICAgICAkb3V0WydDb250ZW50LVR5cGUnXSA9
ICRfRU5WWydDT05URU5UX1RZUEUnXTsKCiAgICAgIGZvcmVhY2ggKCRfU0VSVkVSIGFzICRr
ZXkgPT4gJHZhbHVlKSB7CiAgICAgICAgaWYgKHN1YnN0cigka2V5LCAwLCA1KSA9PSAiSFRU
UF8iKSB7CiAgICAgICAgICAvLyB0aGlzIGlzIGNoYW9zLCBiYXNpY2FsbHkgaXQgaXMganVz
dCB0aGVyZSB0byBjYXBpdGFsaXplIHRoZSBmaXJzdAogICAgICAgICAgLy8gbGV0dGVyIG9m
IGV2ZXJ5IHdvcmQgdGhhdCBpcyBub3QgYW4gaW5pdGlhbCBIVFRQIGFuZCBzdHJpcCBIVFRQ
CiAgICAgICAgICAvLyBjb2RlIGZyb20gcHJ6ZW1lawogICAgICAgICAgJGtleSA9IHN0cl9y
ZXBsYWNlKAogICAgICAgICAgICAiICIsCiAgICAgICAgICAgICItIiwKICAgICAgICAgICAg
dWN3b3JkcyhzdHJ0b2xvd2VyKHN0cl9yZXBsYWNlKCJfIiwgIiAiLCBzdWJzdHIoJGtleSwg
NSkpKSkKICAgICAgICAgICk7CiAgICAgICAgICAkb3V0WyRrZXldID0gJHZhbHVlOwogICAg
ICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuICRvdXQ7CiAgfQoKICAvLyBUaGlzIGZ1
bmN0aW9uIHRha2VzIGEgaW5wdXQgbGlrZSBhPWImYT1jJmQ9ZSBhbmQgcmV0dXJucyB0aGUg
cGFyc2VkCiAgLy8gcGFyYW1ldGVycyBsaWtlIHRoaXMKICAvLyBhcnJheSgnYScgPT4gYXJy
YXkoJ2InLCdjJyksICdkJyA9PiAnZScpCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBwYXJz
ZV9wYXJhbWV0ZXJzKCAkaW5wdXQgKSB7CiAgICBpZiAoIWlzc2V0KCRpbnB1dCkgfHwgISRp
bnB1dCkgcmV0dXJuIGFycmF5KCk7CgogICAgJHBhaXJzID0gZXhwbG9kZSgnJicsICRpbnB1
dCk7CgogICAgJHBhcnNlZF9wYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgIGZvcmVhY2ggKCRw
YWlycyBhcyAkcGFpcikgewogICAgICAkc3BsaXQgPSBleHBsb2RlKCc9JywgJHBhaXIsIDIp
OwogICAgICAkcGFyYW1ldGVyID0gT0F1dGhVdGlsOjp1cmxkZWNvZGVfcmZjMzk4Nigkc3Bs
aXRbMF0pOwogICAgICAkdmFsdWUgPSBpc3NldCgkc3BsaXRbMV0pID8gT0F1dGhVdGlsOjp1
cmxkZWNvZGVfcmZjMzk4Nigkc3BsaXRbMV0pIDogJyc7CgogICAgICBpZiAoaXNzZXQoJHBh
cnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdKSkgewogICAgICAgIC8vIFdlIGhhdmUgYWxy
ZWFkeSByZWNpZXZlZCBwYXJhbWV0ZXIocykgd2l0aCB0aGlzIG5hbWUsIHNvIGFkZCB0byB0
aGUgbGlzdAogICAgICAgIC8vIG9mIHBhcmFtZXRlcnMgd2l0aCB0aGlzIG5hbWUKCiAgICAg
ICAgaWYgKGlzX3NjYWxhcigkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl0pKSB7CiAg
ICAgICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCBkdXBsaWNhdGUsIHNvIHRyYW5zZm9ybSBz
Y2FsYXIgKHN0cmluZykgaW50byBhbiBhcnJheQogICAgICAgICAgLy8gc28gd2UgY2FuIGFk
ZCB0aGUgZHVwbGljYXRlcwogICAgICAgICAgJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0
ZXJdID0gYXJyYXkoJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdKTsKICAgICAgICB9
CgogICAgICAgICRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXVtdID0gJHZhbHVlOwog
ICAgICB9IGVsc2UgewogICAgICAgICRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSA9
ICR2YWx1ZTsKICAgICAgfQogICAgfQogICAgcmV0dXJuICRwYXJzZWRfcGFyYW1ldGVyczsK
ICB9CgogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gYnVpbGRfaHR0cF9xdWVyeSgkcGFyYW1z
KSB7CiAgICBpZiAoISRwYXJhbXMpIHJldHVybiAnJzsKCiAgICAvLyBVcmxlbmNvZGUgYm90
aCBrZXlzIGFuZCB2YWx1ZXMKICAgICRrZXlzID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZj
Mzk4NihhcnJheV9rZXlzKCRwYXJhbXMpKTsKICAgICR2YWx1ZXMgPSBPQXV0aFV0aWw6OnVy
bGVuY29kZV9yZmMzOTg2KGFycmF5X3ZhbHVlcygkcGFyYW1zKSk7CiAgICAkcGFyYW1zID0g
YXJyYXlfY29tYmluZSgka2V5cywgJHZhbHVlcyk7CgogICAgLy8gUGFyYW1ldGVycyBhcmUg
c29ydGVkIGJ5IG5hbWUsIHVzaW5nIGxleGljb2dyYXBoaWNhbCBieXRlIHZhbHVlIG9yZGVy
aW5nLgogICAgLy8gUmVmOiBTcGVjOiA5LjEuMSAoMSkKICAgIHVrc29ydCgkcGFyYW1zLCAn
c3RyY21wJyk7CgogICAgJHBhaXJzID0gYXJyYXkoKTsKICAgIGZvcmVhY2ggKCRwYXJhbXMg
YXMgJHBhcmFtZXRlciA9PiAkdmFsdWUpIHsKICAgICAgaWYgKGlzX2FycmF5KCR2YWx1ZSkp
IHsKICAgICAgICAvLyBJZiB0d28gb3IgbW9yZSBwYXJhbWV0ZXJzIHNoYXJlIHRoZSBzYW1l
IG5hbWUsIHRoZXkgYXJlIHNvcnRlZCBieSB0aGVpciB2YWx1ZQogICAgICAgIC8vIFJlZjog
U3BlYzogOS4xLjEgKDEpCiAgICAgICAgbmF0c29ydCgkdmFsdWUpOwogICAgICAgIGZvcmVh
Y2ggKCR2YWx1ZSBhcyAkZHVwbGljYXRlX3ZhbHVlKSB7CiAgICAgICAgICAkcGFpcnNbXSA9
ICRwYXJhbWV0ZXIgLiAnPScgLiAkZHVwbGljYXRlX3ZhbHVlOwogICAgICAgIH0KICAgICAg
fSBlbHNlIHsKICAgICAgICAkcGFpcnNbXSA9ICRwYXJhbWV0ZXIgLiAnPScgLiAkdmFsdWU7
CiAgICAgIH0KICAgIH0KICAgIC8vIEZvciBlYWNoIHBhcmFtZXRlciwgdGhlIG5hbWUgaXMg
c2VwYXJhdGVkIGZyb20gdGhlIGNvcnJlc3BvbmRpbmcgdmFsdWUgYnkgYW4gJz0nIGNoYXJh
Y3RlciAoQVNDSUkgY29kZSA2MSkKICAgIC8vIEVhY2ggbmFtZS12YWx1ZSBwYWlyIGlzIHNl
cGFyYXRlZCBieSBhbiAnJicgY2hhcmFjdGVyIChBU0NJSSBjb2RlIDM4KQogICAgcmV0dXJu
IGltcGxvZGUoJyYnLCAkcGFpcnMpOwogIH0KfSI7czozOiJtZDUiO3M6MzI6IjdjNjdiMmMw
ZGI1NzFlZjg3YTUzNmRhOWY2ZDViMzJlIjt9
