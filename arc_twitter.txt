# arc_twitter v3.0-dev
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjc6
IjMuMC1kZXYiO3M6NjoiYXV0aG9yIjtzOjExOiJBbmR5IENhcnRlciI7czoxMDoiYXV0aG9y
X3VyaSI7czozMToiaHR0cDovL3JlZGhvdGNoaWxsaXByb2plY3QuY29tLyI7czoxMToiZGVz
Y3JpcHRpb24iO3M6NjA6IjxhIGhyZWY9Imh0dHA6Ly93d3cudHdpdHRlci5jb20iPlR3aXR0
ZXI8L2E+IGZvciBUZXh0cGF0dGVybiI7czo1OiJvcmRlciI7czoxOiI1IjtzOjQ6InR5cGUi
O3M6MToiMSI7czo1OiJmbGFncyI7czoxOiIzIjtzOjQ6ImhlbHAiO3M6MTU0NTY6Igk8aDEg
Y2xhc3M9InRpdGxlIj48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCAoYXJj
X3R3aXR0ZXIgZm9yIFRleHRwYXR0ZXJuKTwvaDE+CgoJPG9sPgoJCTxsaT48YSBocmVmPSIj
YXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2Fy
Y190d2l0dGVyX2luc3RhbGxhdGlvbiI+SW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxsYXRpb248
L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3RhZyI+VGhlIGFyY190d2l0
dGVyIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfc2VhcmNoX3Rh
ZyI+VGhlIGFyY190d2l0dGVyX3NlYXJjaCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0i
I2FyY190d2l0dGVyX3JldHdlZXRfdGFnIj5UaGUgYXJjX3R3aXR0ZXJfcmV0d2VldCB0YWc8
L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3R3ZWV0X3VybCI+VGhlIGFy
Y190d2l0dGVyX3R3ZWV0X3VybCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190
d2l0dGVyX3Rpbnl1cmwiPlRoZSBhcmNfdHdpdHRlcl90aW55dXJsIHRhZzwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfY2FjaGluZyI+Q2FjaGluZzwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfcHJlZnMiPlByZWZlcmVuY2VzPC9hPjwvbGk+
CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl9hcnRpY2xlIj5Ud2VldGluZyBhcnRpY2xl
czwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfYWRtaW4iPlRoZSBUd2l0
dGVyIHRhYjwvYT48L2xpPgoJPC9vbD4KCgk8cD48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9z
cGFuPiBUd2VldCBwcm92aWRlcyBhY2Nlc3MgdG8geW91ciBUd2l0dGVyIGFjY291bnQgdGhy
b3VnaCBib3RoIHRoZSBhZG1pbiBpbnRlcmZhY2UgYW5kIHRoZSBwdWJsaWMgc2lkZSBvZiB5
b3VyIHNpdGUuIFVwZGF0ZSBUd2l0dGVyIHdoZW4geW91IHBvc3QgYSBuZXcgYXJ0aWNsZSAo
d2l0aCBhcnRpY2xlLWJ5LWFydGljbGUgb3B0IG91dCBvcHRpb24pLCB1cGRhdGUgYW5kIHZp
ZXcgeW91ciBUd2l0dGVyIGZlZWQgdGhyb3VnaCB0aGUgYWRtaW4gVHdpdHRlciB0YWIsIGFu
ZCBkaXNwbGF5IFR3aXR0ZXIgZmVlZHMgb24geW91ciBzaXRlLjwvcD4KCgk8cD5SZXF1aXJl
bWVudHM6LTwvcD4KCgk8dWw+CgkJPGxpPlRleHRwYXR0ZXJuIDQuMis8L2xpPgoJCTxsaT48
c3BhbiBjbGFzcz0iY2FwcyI+UEhQPC9zcGFuPiA1IGFuZCBjVVJMPC9saT4KCTwvdWw+CgoJ
PGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2gy
PgoKCTxwPjxhIGhyZWY9Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbSI+QW5keSBD
YXJ0ZXI8L2E+LiBGb3Igb3RoZXIgVGV4dHBhdHRlcm4gcGx1Z2lucyBieSBtZSB2aXNpdCBt
eSA8YSBocmVmPSJodHRwOi8vcmVkaG90Y2hpbGxpcHJvamVjdC5jb20vdHhwIj5QbHVnaW5z
IHBhZ2U8L2E+LjwvcD4KCgk8cD5UaGFua3MgdG8gPGEgaHJlZj0iaHR0cDovL21hbmZyZS5u
ZXQvIj5NaWNoYWVsIE1hbmZyZTwvYT4gZm9yIGluc3BpcmF0aW9uIGZvciB0aGUgYXJ0aWNs
ZSB0d2VldCBwYXJ0IG9mIHRoaXMgcGx1Z2luIGJhc2VkIG9uIGhpcyA8c3BhbiBjbGFzcz0i
dGFnIj5tZW1fdHdpdHRlcjwvc3Bhbj4gcGx1Z2luLiAgQWRkaXRpb25hbCB0aGFua3MgdG8g
dGhlIGdyZWF0IFRleHRwYXR0ZXJuIGNvbW11bml0eSBmb3IgaGVscGluZyB0byB0ZXN0IHRo
aXMgcGx1Z2luIGFuZCBmb3Igc3VnZ2VzdGluZyBuZXcgZmVhdHVyZXMuIFRoZSBPQXV0aCBw
YXJ0IG9mIHRoZSBwbHVnaW4gaXMgdGhhbmtzIHRvIDxhIGhyZWY9Imh0dHA6Ly90d2l0dGVy
LmNvbS9hYnJhaGFtIj5BYnJhaGFtIFdpbGxpYW1zPC9hPi48L3A+CgoJPGgyIGNsYXNzPSJz
ZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfaW5zdGFsbGF0aW9uIj5JbnN0YWxsYXRpb24gLyBV
bmluc3RhbGxhdGlvbjwvaDI+CgoJPHA+VG8gaW5zdGFsbCBnbyB0byB0aGUgJiM4MjE2O3Bs
dWdpbnMmIzgyMTc7IHRhYiB1bmRlciAmIzgyMTY7YWRtaW4mIzgyMTc7IGFuZCBwYXN0ZSB0
aGUgcGx1Z2luIGNvZGUgaW50byB0aGUgJiM4MjE2O0luc3RhbGwgcGx1Z2luJiM4MjE3OyBi
b3gsICYjODIxNjt1cGxvYWQmIzgyMTc7IGFuZCB0aGVuICYjODIxNjtpbnN0YWxsJiM4MjE3
Oy4gRmluYWxseSBhY3RpdmF0ZSB0aGUgcGx1Z2luLjwvcD4KCgk8cD5CZWZvcmUgeW91IHN0
YXJ0IHVzaW5nIDxzcGFuIGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiB5b3Ugd2ls
bCBuZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IHRoZSBjYWNoZSBkaXJlY3RvcnkgaXMgd3JpdGFi
bGUuIFNlZSB0aGUgJiM4MjE2O0NhY2hpbmcmIzgyMTc7IHN1YnNlY3Rpb24gYmVsb3cgZm9y
IGZ1cnRoZXIgaW5mb3JtYXRpb24uPC9wPgoKCTxwPjxzcGFuIGNsYXNzPSJ0YWciPmFyY190
d2l0dGVyPC9zcGFuPiBzaG91bGQgbm93IGJlIHJlYWR5IGZvciB1c2Ugb24gdGhlIHB1Ymxp
Yy1zaWRlIG9mIHlvdXIgc2l0ZS48L3A+CgoJPHA+VG8gdW5sb2NrIHRoZSBhZG1pbiBmZWF0
dXJlcyBvZiB0aGlzIHBsdWdpbiB5b3Ugd2lsbCBuZWVkIHRvIGFzc29jaWF0ZSB5b3VyIHNp
dGUgd2l0aCBhIFR3aXR0ZXIgYWNjb3VudCBieSBjb25uZWN0aW5nIHRvIFR3aXR0ZXIgZnJv
bSB0aGUgcGx1Z2luJiM4MjE3O3Mgb3B0aW9ucyBzY3JlZW4uIENsaWNrIG9uIHRoZSBsaW5r
IHRvIGNvbm5lY3QgdG8gVHdpdHRlciwgeW91IHdpbGwgYmUgYXNrZWQgdG8gbG9naW4gdG8g
VHdpdHRlciwgY2xpY2tpbmcgdGhpcyBsaW5rIHdpbGwgdGVtcG9yYXJpbHkgdGFrZSB5b3Ug
dG8gdGhlIFR3aXR0ZXIgc2l0ZSB3aGVyZSB5b3Ugd2lsbCBiZSBhc2tlZCB0byBsb2dpbiBh
bmQgYXBwcm92ZSBhY2Nlc3MgZm9yIDxzcGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3
ZWV0IHRvIHJlYWQgYW5kIHdyaXRlIHRvIHlvdXIgVHdpdHRlciBhY2NvdW50LiBJZiBhbGwg
aXMgc3VjY2Vzc2Z1bCB5b3Ugd2lsbCBiZSByZXR1cm5lZCB0byB0aGUgb3B0aW9ucyBzY3Jl
ZW4gYW5kIHlvdXIgdXNlciBuYW1lIHdpbGwgYXBwZWFyLjwvcD4KCgk8cD5BdCBhbnkgdGlt
ZSB5b3UgY2FuIGRpc2Fzc29jaWF0ZSB5b3VyIFR3aXR0ZXIgYWNjb3VudCB3aXRoIDxzcGFu
IGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0IHZpYSB5b3VyIFR3aXR0ZXIgYWNjb3Vu
dCBwcmVmZXJlbmNlcyBvbiB0aGUgPGEgaHJlZj0iaHR0cDovL3d3dy50d2l0dGVyLmNvbSI+
VHdpdHRlciB3ZWJzaXRlPC9hPi48L3A+CgoJPHA+VG8gdW5pbnN0YWxsIDxzcGFuIGNsYXNz
PSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiBzaW1wbHkgZGVsZXRlIHRoZSBwbHVnaW4gZnJv
bSB0aGUgJiM4MjE2O1BsdWdpbnMmIzgyMTc7IHRhYi4gIFRoaXMgd2lsbCByZW1vdmUgdGhl
IHBsdWdpbiBjb2RlLCBkZWxldGUgcmVsYXRlZCBwcmVmZXJlbmNlcyBhbmQgZHJvcCB0aGUg
PHNwYW4gY2xhc3M9InRhZyI+YXJjX3R3aXR0ZXI8L3NwYW4+IHRhYmxlIGZyb20geW91ciBU
ZXh0cGF0dGVybiBkYXRhYmFzZS48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJj
X3R3aXR0ZXJfdGFnIj5UaGUgYXJjX3R3aXR0ZXIgdGFnPC9oMj4KCgk8aDM+U3ludGF4PC9o
Mz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyIHVzZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZx
dW90OyAvJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0
aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVs
dDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVzZXI8
L3RkPgoJCQk8dGQ+VHdpdHRlciB1c2VyIG5hbWU8L3RkPgoJCQk8dGQ+IDxlbT5hcmNfdHdp
dHRlciB1c2VybmFtZTwvZW0+PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXluaW5q
YSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5saW1pdDwvdGQ+CgkJCTx0ZD5N
YXhpbXVtIG51bWJlciBvZiB0d2VldHMgdG8gZGlzcGxheSAobWF4LiAyMDApPC90ZD4KCQkJ
PHRkPjEwPC90ZD4KCQkJPHRkPmxpbWl0PSZxdW90OzI1JnF1b3Q7PC90ZD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmRhdGVmb3JtYXQ8L3RkPgoJCQk8dGQ+Rm9ybWF0IHRoYXQgdXBkYXRl
IGRhdGVzIHdpbGwgYXBwZWFyIGFzPC90ZD4KCQkJPHRkPiA8ZW0+QXJjaGl2ZSBkYXRlIGZv
cm1hdDwvZW0+PC90ZD4KCQkJPHRkPmRhdGVmb3JtYXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAl
cCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbDwvdGQ+CgkJCTx0ZD5M
YWJlbCBmb3IgdGhlIHRvcCBvZiB0aGUgbGlzdDwvdGQ+CgkJCTx0ZD4gPGVtPm5vIGxhYmVs
PC9lbT48L3RkPgoJCQk8dGQ+bGFiZWw9JnF1b3Q7TXkgVHdpdHRlciB0aW1lbGluZSZxdW90
OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbHRhZzwvdGQ+CgkJCTx0ZD5JbmRl
cGVuZGVudCB3cmFwdGFnIGZvciBsYWJlbDwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48
L3RkPgoJCQk8dGQ+bGFiZWx0YWc9JnF1b3Q7aDMmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRy
PgoJCQk8dGQ+YnJlYWs8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNs
YXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnICh3aXRob3V0IGJyYWNrZXRzKSwg
b3Igc3RyaW5nLCB1c2VkIHRvIHNlcGFyYXRlIHRoZSB1cGRhdGVzPC90ZD4KCQkJPHRkPmxp
PC90ZD4KCQkJPHRkPmJyZWFrPSZxdW90O2JyJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4K
CQkJPHRkPndyYXB0YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNs
YXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVzZWQgYXMgdGhlIHdy
YXB0YWcsIHdpdGhvdXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90
ZD4KCQkJPHRkPndyYXB0YWc9JnF1b3Q7dWwmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJ
CQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNz
PSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgZm9yIHdyYXB0YWc8
L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXI8L3RkPgoJCQk8dGQ+Y2xhc3M9JnF1b3Q7dHdpdHRl
ciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzc19wb3N0ZWQ8L3RkPgoJ
CQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+
PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byBzcGFuIHRhZyBhcm91bmQgcG9z
dGVkIGRhdGU8L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXItcG9zdGVkPC90ZD4KCQk8L3RyPgoJ
PC90YWJsZT4KCgk8aDM+RXhhbXBsZSB1c2FnZTwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdp
dHRlciB1c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDsgbGltaXQ9JnF1b3Q7NSZxdW90
OyB3cmFwdGFnPSZxdW90O3VsJnF1b3Q7IGJyZWFrPSZxdW90O2xpJnF1b3Q7IGRhdGVmb3Jt
YXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAlcCZxdW90OyAvJmd0OzwvcD4KCgk8cD5Qcm9kdWNl
cyBhIGJ1bGxldCBwb2ludCBsaXN0IG9mIHRoZSBsYXN0IDUgVHdpdHRlciB1cGRhdGVzIGZy
b20gZHJtb25rZXluaW5qYSYjODIxNztzIFR3aXR0ZXIgZmVlZCB3aXRoIGEgZGVmaW5lZCBk
YXRlIGZvcm1hdCB0byBvdmVycmlkZSB0aGUgZGVmYXVsdCBhcmNoaXZlIGRhdGUgZm9ybWF0
LjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9zZWFyY2hfdGFn
Ij5UaGUgYXJjX3R3aXR0ZXJfc2VhcmNoIHRhZzwvaDI+CgoJPGgzPlN5bnRheDwvaDM+CgoJ
PHA+Jmx0O3R4cDphcmNfdHdpdHRlcl9zZWFyY2ggaGFzaHRhZ3M9JnF1b3Q7dHhwJnF1b3Q7
IC8mZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0
dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90
aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+c2VhcmNoPC90
ZD4KCQkJPHRkPkNvbW1hIHNlcGFyYXRlZCBsaXN0IG9mIHNlYXJjaCB3b3JkczwvdGQ+CgkJ
CTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+c2VhcmNoPSZxdW90O3R4cCx0ZXh0
cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5oYXNodGFnczwvdGQ+
CgkJCTx0ZD5Db21tYSBzZXBhcmF0ZWQgbGlzdCBvZiBoYXNodGFncyB0byBzZWFyY2ggZm9y
IChub3QgaW5jbHVkaW5nIHRoZSBoYXNoKTwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48
L3RkPgoJCQk8dGQ+aGFzaHRhZ3M9JnF1b3Q7dHhwLHRleHRwYXR0ZXJuJnF1b3Q7PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPnJlcGx5PC90ZD4KCQkJPHRkPlVzZXJuYW1lIG9mIHR3
ZWV0cyBpbiByZXBseSB0bzwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8
dGQ+cmVwbHk9JnF1b3Q7dHdpdHRlciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5tZW50aW9uPC90ZD4KCQkJPHRkPlVzZXJuYW1lIG9mIHVzZXIgbWVudGlvbmVkIGluIHR3
ZWV0cyAoPGk+aS5lLjwvaT4gdHdlZXRzIGNvbnRhaW5pbmcgQHVzZXJuYW1lKTwvdGQ+CgkJ
CTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+bWVudGlvbj0mcXVvdDt0d2l0dGVy
JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxpbWl0PC90ZD4KCQkJPHRkPk1h
eGltdW0gbnVtYmVyIG9mIHR3ZWV0cyB0byBkaXNwbGF5IChtYXguIDIwMCk8L3RkPgoJCQk8
dGQ+MTA8L3RkPgoJCQk8dGQ+bGltaXQ9JnF1b3Q7MjUmcXVvdDs8L3RkPgoJCTwvdHI+CgkJ
PHRyPgoJCQk8dGQ+ZGF0ZWZvcm1hdDwvdGQ+CgkJCTx0ZD5Gb3JtYXQgdGhhdCB1cGRhdGUg
ZGF0ZXMgd2lsbCBhcHBlYXIgYXM8L3RkPgoJCQk8dGQ+IDxlbT5BcmNoaXZlIGRhdGUgZm9y
bWF0PC9lbT48L3RkPgoJCQk8dGQ+ZGF0ZWZvcm1hdD0mcXVvdDslYiAlT2UsICVJOiVNICVw
JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsPC90ZD4KCQkJPHRkPkxh
YmVsIGZvciB0aGUgdG9wIG9mIHRoZSBsaXN0PC90ZD4KCQkJPHRkPiA8ZW0+bm8gbGFiZWw8
L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbHRhZzwvdGQ+CgkJCTx0ZD5J
bmRlcGVuZGVudCB3cmFwdGFnIGZvciBsYWJlbDwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9l
bT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+YnJlYWs8L3RkPgoJCQk8dGQ+PHNwYW4g
Y2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFn
ICh3aXRob3V0IGJyYWNrZXRzKSwgb3Igc3RyaW5nLCB1c2VkIHRvIHNlcGFyYXRlIHRoZSB1
cGRhdGVzPC90ZD4KCQkJPHRkPmxpPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPndyYXB0
YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5I
VE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVzZWQgYXMgdGhlIHdyYXB0YWcsIHdpdGhv
dXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3Bh
biBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGZvciB3
cmFwdGFnPC90ZD4KCQkJPHRkPmFyY190d2l0dGVyX3NlYXJjaDwvdGQ+CgkJPC90cj4KCQk8
dHI+CgkJCTx0ZD5jbGFzc191c2VyPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48
c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFw
cGxpZWQgdG8gc3BhbiB0YWcgYXJvdW5kIHVzZXIgbmFtZTwvdGQ+CgkJCTx0ZD5hcmNfdHdp
dHRlci11c2VyPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzX3Bvc3RlZDwvdGQ+
CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bh
bj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHNwYW4gdGFnIGFyb3VuZCBw
b3N0ZWQgZGF0ZTwvdGQ+CgkJCTx0ZD5hcmNfdHdpdHRlci1wb3N0ZWQ8L3RkPgoJCTwvdHI+
Cgk8L3RhYmxlPgoKCTxoMz5FeGFtcGxlIHVzYWdlPC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190
d2l0dGVyX3NlYXJjaCBzZWFyY2g9JnF1b3Q7cGx1Z2luJnF1b3Q7IGhhc2h0YWdzPSZxdW90
O3R4cCx0ZXh0cGF0dGVybiZxdW90OyBsaW1pdD0mcXVvdDsyNSZxdW90OyAvJmd0OzwvcD4K
Cgk8cD5Qcm9kdWNlcyBhIGxpc3Qgb2YgdHdlZXRzIGNvbnRhaW5pbmcgdGhlIHdvcmQgJiM4
MjE2O3BsdWdpbiYjODIxNzsgYW5kIHRoZSBoYXNodGFncyAmIzgyMTY7I3R4cCYjODIxNzsg
YW5kICYjODIxNjsjdGV4dHBhdHRlcm4mIzgyMTc7LiBUaGUgdGFnIHdpbGwgcmV0dXJuIGEg
bWF4aW11bSBvZiAyNSB0d2VldHMuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFy
Y190d2l0dGVyX3JldHdlZXRfdGFnIj5UaGUgYXJjX3R3aXR0ZXJfcmV0d2VldCB0YWc8L2gy
PgoKCTxoMz5TeW50YXg8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfcmV0d2VldCAv
Jmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRy
aWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+
CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVzZXI8L3RkPgoJ
CQk8dGQ+VHdpdHRlciB1c2VyIG5hbWUgdG8gcXVvdGU8L3RkPgoJCQk8dGQ+IDxlbT5hcmNf
dHdpdHRlciB1c2VybmFtZTwvZW0+PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXlu
aW5qYSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD51cmw8L3RkPgoJCQk8dGQ+
PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+PC9zcGFu
PiB0byByZXR3ZWV0PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnRleHQ8L3RkPgoJCQk8
dGQ+UmV0d2VldCB0ZXh0PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmZvbGxvdzE8L3Rk
PgoJCQk8dGQ+U3VnZ2VzdGVkIFR3aXR0ZXIgYWNjb3VudCB0byBmb2xsb3csIGZvciBleGFt
cGxlIHlvdXIgb3duPC90ZD4KCQkJPHRkPkEgVHdpdHRlciB1c2VyIHRvIHJlY29tbWVuZDwv
dGQ+CgkJCTx0ZD5mb2xsb3cxPSZxdW90O1RleHRwYXR0ZXJuJnF1b3Q7PC90ZD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPmZvbGxvdzI8L3RkPgoJCQk8dGQ+QXMgZm9sbG93MTwvdGQ+CgkJ
CTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFuZzwv
dGQ+CgkJCTx0ZD5MYW5ndWFnZTwvdGQ+CgkJCTx0ZD5lbjwvdGQ+CgkJCTx0ZD5sYW5nPSZx
dW90O2VzJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNvdW50PC90ZD4KCQkJ
PHRkPkNvdW50IGJveCBwb3NpdGlvbiwgb3B0aW9uczogbm9uZSwgaG9yaXpvbnRhbCBvciB2
ZXJ0aWNhbDwvdGQ+CgkJCTx0ZD5ob3Jpem9udGFsPC90ZD4KCQkJPHRkPmNvdW50PSZxdW90
O25vbmUmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aW5jbHVkZV9qczwvdGQ+
CgkJCTx0ZD5XaGV0aGVyIG9yIG5vdCB0byBpbmNsdWRlIHRoZSBKYXZhU2NyaXB0PC90ZD4K
CQkJPHRkPjE8L3RkPgoJCQk8dGQ+aW5jbHVkZV9qcz0mcXVvdDswJnF1b3Q7PC90ZD4KCQk8
L3RyPgoJCTx0cj4KCQkJPHRkPndyYXB0YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNh
cHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVz
ZWQgYXMgdGhlIHdyYXB0YWcsIHdpdGhvdXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51
bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRk
PjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bh
bj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gdGhlIHJldHdlZXQgYnV0dG9uPC90ZD4K
CQkJPHRkPnR3aXR0ZXItc2hhcmUtYnV0dG9uPC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8
aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl90d2VldF91cmwiPmFyY190d2l0
dGVyX3R3ZWV0X3VybDwvaDI+CgoJPHA+UmV0dXJucyB0aGUgPHNwYW4gY2xhc3M9ImNhcHMi
PlVSTDwvc3Bhbj4gb2YgdGhlIFR3aXR0ZXIgc3RhdHVzIGZvciBhbiBhcnRpY2xlLjwvcD4K
Cgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyX3R3ZWV0X3VybCAv
Jmd0OzwvcD4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyX3R3ZWV0X3VybCZndDtMaW5rIHRl
eHQmbHQ7L3R4cDphcmNfdHdpdHRlcl90d2VldF91cmwmZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwv
aDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNj
cmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+aWQ8L3RkPgoJCQk8dGQ+VGV4dHBhdHRlcm4gYXJ0aWNs
ZSBJRDwvdGQ+CgkJCTx0ZD4gPGVtPmN1cnJlbnQgYXJ0aWNsZTwvZW0+PC90ZD4KCQkJPHRk
PmlkPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+dGl0bGU8L3Rk
PgoJCQk8dGQ+VGl0bGUgYXR0cmlidXRlIG9mIHRoZSBsaW5rPC90ZD4KCQkJPHRkPiA8ZW0+
dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0
ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3Nw
YW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHRoZSBsaW5rPC90ZD4KCQkJPHRkPiA8
ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPGgyIGNsYXNzPSJzZWN0
aW9uIiBpZD0iYXJjX3R3aXR0ZXJfdGlueXVybCI+YXJjX3R3aXR0ZXJfdGlueXVybDwvaDI+
CgoJPHA+UmV0dXJucyB0aGUgc2hvcnRlbmVkIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3Nw
YW4+IG9mIHRoZSBhcnRpY2xlIHVzZWQgZm9yIHRoZSBUd2l0dGVyIHVwZGF0ZS48L3A+CgoJ
PGgzPlN5bnRheDwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl90aW55dXJsIC8mZ3Q7
PC9wPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfdGlueXVybCZndDtMaW5rIHRleHQmbHQ7
L3R4cDphcmNfdHdpdHRlcl90aW55dXJsJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0
YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248
L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmlkPC90ZD4KCQkJPHRkPlRleHRwYXR0ZXJuIGFydGljbGUgSUQ8L3Rk
PgoJCQk8dGQ+IDxlbT5jdXJyZW50IGFydGljbGU8L2VtPjwvdGQ+CgkJCTx0ZD5pZD0mcXVv
dDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnRpdGxlPC90ZD4KCQkJPHRk
PlRpdGxlIGF0dHJpYnV0ZSBvZiB0aGUgbGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9l
bT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4g
Y2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFz
cyBhdHRyaWJ1dGUgYXBwbGllZCB0byB0aGUgbGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0
PC9lbT48L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9
ImFyY190d2l0dGVyX2NhY2hpbmciPkNhY2hpbmc8L2gyPgoKCTxwPkluIG9yZGVyIHRvIHBy
ZXZlbnQgZXhjZXNzaXZlIHJlcGVhdGl0aXZlIGNhbGxzIHRvIHRoZSBUd2l0dGVyIHdlYnNp
dGUgaXQgaXMgcmVjb21tZW5kZWQgdG8gY2FjaGUgcmVzdWx0cy4gVHdpdHRlciBsaW1pdHMg
dGhlIG51bWJlciBvZiBjYWxscyB0aHJvdWdoIHRoZSA8c3BhbiBjbGFzcz0iY2FwcyI+QVBJ
PC9zcGFuPiwgYW5kIGNvbnRpbnVvdXMgY2FsbHMgd2lsbCByZXN1bHQgaW4gVHdpdHRlciBj
bG9zaW5nIHRvIGZ1cnRoZXIgcmVxdWVzdHMuIEJ5IGRlZmF1bHQsIGFyY190d2l0dGVyIGNh
Y2hlcyBmb3IgMzAgbWludXRlIGludGVydmFscy48L3A+CgoJPHRhYmxlPgoJCTx0cj4KCQkJ
PHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZh
dWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2Fj
aGluZzwvdGQ+CgkJCTx0ZD4mIzgyMTY7MSYjODIxNzsgdG8gY2FjaGUgZmVlZCwgJiM4MjE2
OzAmIzgyMTc7IHRvIHR1cm4gY2FjaGluZyBvZmYgKG5vdCByZWNvbW1lbmRlZCk8L3RkPgoJ
CQk8dGQ+MTwvdGQ+CgkJCTx0ZD5jYWNoaW5nPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+Y2FjaGVfZGlyPC90ZD4KCQkJPHRkPkFic29sdXRlIHBhdGggdG8g
dGhlIGNhY2hlIGRpcmVjdG9yeSAobXVzdCBiZSB3cml0YWJsZSk8L3RkPgoJCQk8dGQ+IDxl
bT5hcmNfdHdpdHRlciBwcmVmZXJlbmNlczwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJ
PHRkPmNhY2hlX3RpbWU8L3RkPgoJCQk8dGQ+VGltZSBpbiBtaW51dGVzIHRoYXQgdGhlIGNh
Y2hlIGZpbGVzIGFyZSBzdG9yZWQgYmVmb3JlIGJlaW5nIHJlZnJlc2hlZDwvdGQ+CgkJCTx0
ZD41PC90ZD4KCQkJPHRkPmNhY2hlX3RpbWU9JnF1b3Q7MzAmcXVvdDs8L3RkPgoJCTwvdHI+
Cgk8L3RhYmxlPgoKCTxwPlRoZSBhZG1pbiBzaWRlIG9mIHRoaXMgcGx1Z2luIGVuZm9yY2Vz
IGNhY2hpbmcsIGFwYXJ0IGZyb20gd2hlbiBpdCBpcyBwb3N0aW5nIHRvIFR3aXR0ZXIgKDxp
PmUuZy48L2k+IHdoZW4gcG9zdGluZyBvciBkZWxldGluZyBhbiB1cGRhdGUpLjwvcD4KCgk8
aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9wcmVmcyI+UHJlZmVyZW5jZXM8
L2gyPgoKCTxwPllvdSBjYW4gYWNjZXNzIHRoZSBwbHVnaW5zIGNvcmUgcHJlZmVyZW5jZXMg
ZnJvbSBlaXRoZXIgdGhlIFByZWZlcmVuY2VzIG9yIFBsdWdpbnMgdGFicyBpbiBhZG1pbi4g
U2V0dXAgeW91ciBUd2l0dGVyIGFjY291bnQgKHlvdSB3aWxsIGJlIGFza2VkIHRvIGNvbm5l
Y3QgdmlhIFR3aXR0ZXIgYW5kIHRoaXMgbmVlZHMgZG9pbmcgYmVmb3JlIHlvdSBjYW4gdXNl
IHRoZSBwbHVnaW4pIGFuZCBjaGFuZ2UgdGhlIGNhY2hlIGRpcmVjdG9yeSB1c2luZyBhcmNf
dHdpdHRlciYjODIxNztzIHByZWZlcmVuY2VzLiBXaXRob3V0IHByb3ZpZGluZyB5b3VyIGFj
Y291bnQgbG9naW4gZGV0YWlscyB0aGUgYWRtaW4gYXJlYSBmZWF0dXJlcyBvZiB0aGlzIHBs
dWdpbiB3aWxsIGJlIGluYWN0aXZlLjwvcD4KCgk8cD5Zb3UgY2FuIHNlbGVjdCB0aGUgPHNw
YW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4gc2hvcnRlbmVyIG1ldGhvZCB5b3Ugd2FudCB0
byB1c2UgdG8gbGluayBiYWNrIHRvIHlvdXIgYXJ0aWNsZSBvbiBUd2l0dGVyLiBQbGVhc2Ug
bm90ZSB0aGF0IGlmIHlvdSBzZWxlY3Qgc21kX3Nob3J0X3VybCB5b3Ugd2lsbCBuZWVkIHRv
IGhhdmUgaW5zdGFsbGVkIGFuZCBhY3RpdmF0ZWQgdGhlIDxhIGhyZWY9Imh0dHA6Ly90ZXh0
cGF0dGVybi5vcmcvcGx1Z2lucy8xMDk5L3NtZF9zaG9ydF91cmwiPjxzcGFuIGNsYXNzPSJ0
YWciPnNtZF9zaG9ydF91cmw8L3NwYW4+IHBsdWdpbjwvYT4gZGV2ZWxvcGVkIGJ5IFN0ZWYg
RGF3c29uLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9hcnRp
Y2xlIj5Ud2VldGluZyBhcnRpY2xlczwvaDI+CgoJPHA+QnkgZGVmYXVsdCBhcmNfdHdpdHRl
ciB3aWxsIHBvc3QgYW4gdXBkYXRlIHRvIFR3aXR0ZXIgaW5jbHVkaW5nIGEgc2hvcnRlbmVk
IDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+IHRvIHlvdXIgYXJ0aWNsZS4gT25seSBs
aXZlIGFuZCBhY3RpdmUgYXJ0aWNsZXMgd2lsbCBiZSBzZW50IHRvIFR3aXR0ZXIsIDxpPmku
ZS48L2k+IGFydGljbGVzIHBvc3RlZCBpbiB0aGUgZnV0dXJlIG9yIGFzIHN0aWNreSBhcnRp
Y2xlcyB3aWxsIG5vdCBiZSBzZW50LiBJZiB5b3VyIGFydGljbGUgaXMgc3VjY2Vzc2Z1bGx5
IHN1Ym1pdHRlZCB0byBUd2l0dGVyIHRoZSB1cGRhdGUgd2lsbCBhcHBlYXIgaW4gcGxhY2Ug
b2YgdGhlIFR3aXR0ZXIgb3B0aW9uIG9uIHRoZSByaWdodC1oYW5kLXNpZGUgb2YgdGhlIGFy
dGljbGUgZWRpdCBzY3JlZW4uPC9wPgoKCTxwPlR3ZWV0cyBhcmUgc2VudCBpbiB0aGUgZm9s
bG93aW5nIGZvcm1hdDogPGVtPlR3ZWV0IHByZWZpeDwvZW0+IDxlbT5BcnRpY2xlIHRpdGxl
PC9lbT4gPGVtPlNob3J0ZW5lZCA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPjwvZW0+
IDxlbT5Ud2VldCBzdWZmaXg8L2VtPi4gWW91IGNhbiBjaGFuZ2UgdGhlIHByZWZpeCBhbmQg
c3VmZml4IG9uIGFuIGFydGljbGUtYnktYXJ0aWNsZSBiYXNpcyBieSBjaGFuZ2luZyB0aGUg
dHdlZXQgb3B0aW9ucyB1bmRlciAmIzgyMTY7VXBkYXRlIFR3aXR0ZXImIzgyMTc7IG9uIHRo
ZSBhcnRpY2xlIGVkaXRvciBzY3JlZW4uIFRoZSBkZWZhdWx0IDxlbT5Ud2VldCBwcmVmaXg8
L2VtPiBjYW4gYmUgc2V0IHVuZGVyIHRoZSA8c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRl
cjwvc3Bhbj4gcHJlZmVyZW5jZXMgc2NyZWVuICh0aGUgZGVmYXVsdCBvbiBpbnN0YWxsYXRp
b24gaXMgJiM4MjIwO0p1c3QgcG9zdGVkOiYjODIyMTspLjwvcD4KCgk8cD5QbGVhc2Ugbm90
ZSB0aGF0IG9uY2UgYW4gYXJ0aWNsZSBoYXMgYmVlbiB0d2VldGVkIHRoZSB0d2VldCBjYW5u
b3QgYmUgZWRpdGVkLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRl
cl9hZG1pbiI+VGhlIFR3aXR0ZXIgdGFiPC9oMj4KCgk8cD5VbmRlciB0aGUgRXh0ZW5zaW9u
cyB0YWIgKHRoaXMgY2FuIGJlIGNoYW5nZWQgZnJvbSB0aGUgcGx1Z2luJiM4MjE3O3MgcHJl
ZmVyZW5jZSBwYWdlKSBhIG5ldyBUd2l0dGVyIHRhYiBzaG91bGQgYXBwZWFyIG9uY2UgeW91
IGhhdmUgY29ubmVjdGVkIHlvdXIgc2l0ZSB0byB5b3VyIFR3aXR0ZXIgYWNjb3VudC4gRnJv
bSBoZXJlIHlvdSB3aWxsIGJlIGFibGUgdG8gc3VibWl0IG5ldyBUd2l0dGVyIHVwZGF0ZXMs
IHZpZXcgYmFzaWMgYWNjb3VudCBzdGF0aXN0aWNzLCBhbmQgY2hlY2sgb3V0IHlvdXIgcmVj
ZW50IHVwZGF0ZXMgKGluY2x1ZGluZyB0aGUgb3B0aW9uIHRvIGRlbGV0ZSB5b3VyIHR3ZWV0
cykuPC9wPiI7czo0OiJjb2RlIjtzOjcxMzM5OiJnbG9iYWwgJHByZWZzLCR0eHBjZmcsJGFy
Y190d2l0dGVyX2NvbnN1bWVyS2V5LCRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiRh
cmNfdHdpdHRlciA9IGFycmF5KCk7CgokYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkgPSAnbktj
WHNsd3paaEJkMGtmS01ldG5QQSc7CiRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCA9ICdD
Nm5TUENMM2VlSEdUQmhLQ2d3ZDlvY2xjdUQwc3JCOFdWa2ZYUVlDNTQnOwoKYWRkX3ByaXZz
KCdwbHVnaW5fcHJlZnMuYXJjX3R3aXR0ZXInLCcxLDInKTsKcmVnaXN0ZXJfY2FsbGJhY2so
J2FyY190d2l0dGVyX2luc3RhbGwnLCdwbHVnaW5fbGlmZWN5Y2xlLmFyY190d2l0dGVyJywg
J2luc3RhbGxlZCcpOwpyZWdpc3Rlcl9jYWxsYmFjaygnYXJjX3R3aXR0ZXJfdW5pbnN0YWxs
JywncGx1Z2luX2xpZmVjeWNsZS5hcmNfdHdpdHRlcicsICdkZWxldGVkJyk7CnJlZ2lzdGVy
X2NhbGxiYWNrKCdhcmNfdHdpdHRlcl9wcmVmcycsJ3BsdWdpbl9wcmVmcy5hcmNfdHdpdHRl
cicpOwpyZWdpc3Rlcl9jYWxsYmFjaygnYXJjX3Nob3J0X3VybF9yZWRpcmVjdCcsICd0eHBf
ZGllJywgNDA0KTsKCgppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddKSkK
ICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl91c2VyJywgJycsICdhcmNfdHdpdHRlcicsIDEs
ICd0ZXh0X2lucHV0Jyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl9wcmVmaXgn
XSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3ByZWZpeCcsJ0p1c3QgcG9zdGVkOicsICdh
cmNfdHdpdHRlcicsIDIsICd0ZXh0X2lucHV0Jyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNf
dHdpdHRlcl9jYWNoZV9kaXInXSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX2NhY2hlX2Rp
cicsJHR4cGNmZ1sndHhwYXRoJ10uJHByZWZzWyd0ZW1wZGlyJ10sICdhcmNfdHdpdHRlcics
IDEsICd0ZXh0X2lucHV0Jyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl90d2Vl
dF9kZWZhdWx0J10pKQogIHNldF9wcmVmKCdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0Jywg
MSwgJ2FyY190d2l0dGVyJywgMiwgJ3llc25vUmFkaW8nKTsKaWYgKCFpc3NldCgkcHJlZnNb
J2FyY190d2l0dGVyX3VybF9tZXRob2QnXSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3Vy
bF9tZXRob2QnLCAndGlueXVybCcsICdhcmNfdHdpdHRlcicsIDIsCiAgICAnYXJjX3R3aXR0
ZXJfdXJsX21ldGhvZF9zZWxlY3QnKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY19zaG9ydF91
cmwnXSkpCiAgc2V0X3ByZWYoJ2FyY19zaG9ydF91cmwnLCAwLCAnYXJjX3R3aXR0ZXInLCAy
LCAneWVzbm9SYWRpbycpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3Nob3J0X3NpdGVfdXJs
J10pKQogIHNldF9wcmVmKCdhcmNfc2hvcnRfc2l0ZV91cmwnLCAkcHJlZnNbJ3NpdGV1cmwn
XSwgJ2FyY190d2l0dGVyJywgMiwgJ3RleHRfaW5wdXQnKTsKLy8gTWFrZSBzdXJlIHRoYXQg
dGhlIFR3aXR0ZXIgdGFiIGhhcyBiZWVuIGRlZmluZWQKaWYgKCFpc3NldCgkcHJlZnNbJ2Fy
Y190d2l0dGVyX3RhYiddKSkgewogIHNldF9wcmVmKCdhcmNfdHdpdHRlcl90YWInLCAnZXh0
ZW5zaW9ucycsICdhcmNfdHdpdHRlcicsIDIsCiAgICAnYXJjX3R3aXR0ZXJfdGFiX3NlbGVj
dCcpOwogICAgJHByZWZzWydhcmNfdHdpdHRlcl90YWInXSA9ICdleHRlbnNpb25zJzsKfQoK
aWYgKEB0eHBpbnRlcmZhY2UgPT0gJ2FkbWluJykgewogICAgaWYgKCFlbXB0eSgkcHJlZnNb
J2FyY190d2l0dGVyX3VzZXInXSkKICAgICAgICAmJiAhZW1wdHkoJHByZWZzWydhcmNfdHdp
dHRlcl9hY2Nlc3NUb2tlbiddKQogICAgICAgICYmICFlbXB0eSgkcHJlZnNbJ2FyY190d2l0
dGVyX2FjY2Vzc1Rva2VuU2VjcmV0J10pICkgewoKICAgICAgICBpZiAoJHByZWZzWydhcmNf
dHdpdHRlcl90YWInXSkgewogICAgICAgICAgICBhZGRfcHJpdnMoJ2FyY19hZG1pbl90d2l0
dGVyJywgJzEsMiwzLDQnKTsKICAgICAgICAgICAgcmVnaXN0ZXJfdGFiKCRwcmVmc1snYXJj
X3R3aXR0ZXJfdGFiJ10sICdhcmNfYWRtaW5fdHdpdHRlcicsICdUd2l0dGVyJyk7CiAgICAg
ICAgICAgIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYWRtaW5fdHdpdHRlcicsICdhcmNfYWRt
aW5fdHdpdHRlcicpOwogICAgICAgIH0KCiAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2Fy
Y19hcnRpY2xlX3R3ZWV0JywgJ3BpbmcnKTsKICAgICAgICByZWdpc3Rlcl9jYWxsYmFjaygn
YXJjX2FydGljbGVfdHdlZXQnLCAnYXJ0aWNsZScsICdlZGl0JywgMSk7CiAgICAgICAgcmVn
aXN0ZXJfY2FsbGJhY2soJ2FyY19hcHBlbmRfdHdpdHRlcicsICdhcnRpY2xlX3VpJywgJ3N0
YXR1cycpOwogICAgfQp9CgovKgogICAgUHVibGljLXNpZGUgZnVuY3Rpb25zCiAgICA9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09CiovCgpmdW5jdGlvbiBhcmNfdHdpdHRlcigkYXR0cykKewogIGdsb2JhbCAkcHJl
ZnMsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNy
ZXQ7CgogIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAndXNlcicgICAgICA9PiAkcHJlZnNb
J2FyY190d2l0dGVyX3VzZXInXSwKICAgICdwYXNzd29yZCcgID0+ICcnLAogICAgJ3RpbWVs
aW5lJyAgPT4gJ3VzZXInLAogICAgJ2xpbWl0JyAgICAgPT4gJzEwJywKICAgICdyZXR3ZWV0
cycgID0+IGZhbHNlLAogICAgJ2RhdGVmb3JtYXQnPT4gJHByZWZzWydhcmNoaXZlX2RhdGVm
b3JtYXQnXSwKICAgICdjYWNoaW5nJyAgID0+ICcxJywKICAgICdjYWNoZV9kaXInID0+ICRw
cmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10sCiAgICAnY2FjaGVfdGltZSc9PiAnNScs
CiAgICAnbGFiZWwnICAgICA9PiAnJywKICAgICdsYWJlbHRhZycgID0+ICcnLAogICAgJ2Jy
ZWFrJyAgICAgPT4gJ2xpJywKICAgICd3cmFwdGFnJyAgID0+ICcnLAogICAgJ2NsYXNzJyAg
ICAgPT4gX19GVU5DVElPTl9fLAogICAgJ2NsYXNzX3Bvc3RlZCcgPT4gX19GVU5DVElPTl9f
LictcG9zdGVkJwogICAgKSwkYXR0cykpOwoKICAkdHdpdCA9IG5ldyBhcmNfVHdpdHRlcigk
YXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCk7
CgogIGlmICgkY2FjaGluZykgeyAgLy8gdHVybiBvbiBjYWNoaW5nLCByZWNvbW1lbmRlZCAo
ZGVmYXVsdCkKICAgICR0d2l0LT5zZXRDYWNoaW5nKHRydWUpOwogICAgJHR3aXQtPmNhY2hl
RGlyKCRjYWNoZV9kaXIpOwogICAgJHR3aXQtPmNhY2hlVGltZSgkY2FjaGVfdGltZSk7CiAg
fSBlbHNlIHsgIC8vIHR1cm4gb2ZmIGNhY2hpbmcsIG5vdCByZWNvbW1lbmRlZCBvdGhlciB0
aGFuIGZvciB0ZXN0aW5nCiAgICAkdHdpdC0+c2V0Q2FjaGluZyhmYWxzZSk7CiAgfQoKICBz
d2l0Y2ggKCR0aW1lbGluZSkgewogICAgY2FzZSAnaG9tZSc6IGNhc2UgJ2ZyaWVuZHMnOgog
ICAgICAkdGltZWxpbmUgPSAnc3RhdHVzZXMvZnJpZW5kc190aW1lbGluZSc7IGJyZWFrOwog
ICAgY2FzZSAnbWVudGlvbnMnOgogICAgICAkdGltZWxpbmUgPSAnc3RhdHVzZXMvbWVudGlv
bnMnOyBicmVhazsKICAgIGNhc2UgJ3VzZXInOiBkZWZhdWx0OiAkdGltZWxpbmUgPSAnc3Rh
dHVzZXMvdXNlcl90aW1lbGluZSc7CiAgfQoKICAkb3V0ID0gYXJyYXkoKTsKICAkeG1sID0g
JHR3aXQtPmdldCgkdGltZWxpbmUKICAgICwgYXJyYXkoJ3NjcmVlbl9uYW1lJz0+JHVzZXIs
J2NvdW50Jz0+JGxpbWl0LCdpbmNsdWRlX3J0cyc9PiRyZXR3ZWV0cykpOwogIGlmICgkeG1s
KSB7CiAgICAkdHdlZXRzID0gQCR4bWwtPnhwYXRoKCcvc3RhdHVzZXMvc3RhdHVzJyk7CiAg
ICBpZiAoJHR3ZWV0cykgZm9yZWFjaCAoJHR3ZWV0cyBhcyAkdHdlZXQpIHsKICAgICAgJHRp
bWUgPSBzdHJ0b3RpbWUoaHRtbGVudGl0aWVzKCR0d2VldC0+Y3JlYXRlZF9hdCkpOwogICAg
ICAkZGF0ZSA9IHNhZmVfc3RyZnRpbWUoJGRhdGVmb3JtYXQsJHRpbWUpOwogICAgICAkb3V0
W10gPSBhcmNfVHdpdHRlcjo6bWFrZUxpbmtzKGh0bWxlbnRpdGllcygkdHdlZXQtPnRleHQs
IEVOVF9RVU9URVMsJ1VURi04JykpCiAgICAgICAgLicgJy50YWcoaHRtbGVudGl0aWVzKCRk
YXRlKSwnc3BhbicsJyBjbGFzcz0iJy4kY2xhc3NfcG9zdGVkLiciJyk7CiAgICB9CgogICAg
cmV0dXJuIGRvTGFiZWwoJGxhYmVsLCAkbGFiZWx0YWcpLmRvV3JhcCgkb3V0LCAkd3JhcHRh
ZywgJGJyZWFrLCAkY2xhc3MpOwogIH0KCn0KCmZ1bmN0aW9uIGFyY190d2l0dGVyX3NlYXJj
aCgkYXR0cykKewogICAgZ2xvYmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXks
ICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5
KAogICAgICAgICd1c2VyJyAgICAgID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLAog
ICAgICAgICdzZWFyY2gnICAgID0+ICcnLAogICAgICAgICdoYXNodGFncycgID0+ICcnLAog
ICAgICAgICd1c2VyJyAgICAgID0+ICcnLAogICAgICAgICdyZXBseScgICAgID0+ICcnLAog
ICAgICAgICdtZW50aW9uJyAgID0+ICcnLAogICAgICAgICdsaW1pdCcgICAgID0+ICcxMCcs
CiAgICAgICAgJ2xhbmcnICAgICAgPT4gJycsCiAgICAgICAgJ2RhdGVmb3JtYXQnPT4gJHBy
ZWZzWydhcmNoaXZlX2RhdGVmb3JtYXQnXSwKICAgICAgICAnY2FjaGluZycgICA9PiAnMScs
CiAgICAgICAgJ2NhY2hlX2RpcicgPT4gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXIn
XSwKICAgICAgICAnY2FjaGVfdGltZSc9PiAnNScsCiAgICAgICAgJ2xhYmVsJyAgICAgPT4g
JycsCiAgICAgICAgJ2xhYmVsdGFnJyAgPT4gJycsCiAgICAgICAgJ2JyZWFrJyAgICAgPT4g
J2xpJywKICAgICAgICAnd3JhcHRhZycgICA9PiAnJywKICAgICAgICAnY2xhc3MnICAgICA9
PiBfX0ZVTkNUSU9OX18sCiAgICAgICAgJ2NsYXNzX3Bvc3RlZCcgPT4gX19GVU5DVElPTl9f
LictcG9zdGVkJywKICAgICAgICAnY2xhc3NfdXNlcicgICA9PiBfX0ZVTkNUSU9OX18uJy11
c2VyJwogICAgKSwkYXR0cykpOwoKICAgICAgICAkdHdpdCA9IG5ldyBhcmNfVHdpdHRlcigk
YXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29u
c3VtZXJTZWNyZXQpOwoKICAgICAgICBpZiAoJGNhY2hpbmcpIHsgIC8vIHR1cm4gb24gY2Fj
aGluZywgcmVjb21tZW5kZWQgKGRlZmF1bHQpCiAgICAgICAgICAgICR0d2l0LT5zZXRDYWNo
aW5nKHRydWUpOwogICAgICAgICAgICAkdHdpdC0+Y2FjaGVEaXIoJGNhY2hlX2Rpcik7CiAg
ICAgICAgICAgICR0d2l0LT5jYWNoZVRpbWUoJGNhY2hlX3RpbWUpOwogICAgICAgIH0gZWxz
ZSB7ICAvLyB0dXJuIG9mZiBjYWNoaW5nLCBub3QgcmVjb21tZW5kZWQgb3RoZXIgdGhhbiBm
b3IgdGVzdGluZwogICAgICAgICAgICAkdHdpdC0+c2V0Q2FjaGluZyhmYWxzZSk7CiAgICAg
ICAgfQoKICAgICAgICAvLyBjb25zdHJ1Y3Qgc2VhcmNoIHF1ZXJ5CiAgICAgICAgaWYgKCFl
bXB0eSgkc2VhcmNoKSkgewogICAgICAgICAgICAkdGVybXMgPSBleHBsb2RlKCcsJywkc2Vh
cmNoKTsgJHRlcm1zID0gYXJyYXlfbWFwKCd0cmltJywkdGVybXMpOwogICAgICAgICAgICAk
c2VhcmNoID0gaW1wbG9kZSgnICcsJHRlcm1zKTsKICAgICAgICB9CiAgICAgICAgaWYgKCRo
YXNodGFncykgewogICAgICAgICAgICAkaGFzaGVzID0gZXhwbG9kZSgnLCcsJGhhc2h0YWdz
KTsgJGhhc2hlcyA9IGFycmF5X21hcCgndHJpbScsJGhhc2hlcyk7CiAgICAgICAgICAgICRz
ZWFyY2guPSAoKCRzZWFyY2gpPycgJzonJykuJyMnLmltcGxvZGUoJyAjJywkaGFzaGVzKTsK
ICAgICAgICB9CiAgICAgICAgaWYgKCRyZXBseSkgewogICAgICAgICAgICAkc2VhcmNoLj0g
KCgkc2VhcmNoKT8nICc6JycpLid0bzonLnRyaW0oJHJlcGx5KTsKICAgICAgICB9CiAgICAg
ICAgaWYgKCR1c2VyKSB7CiAgICAgICAgICAgICRzZWFyY2guPSAoKCRzZWFyY2gpPycgJzon
JykuJ2Zyb206Jy50cmltKCR1c2VyKTsKICAgICAgICB9CiAgICAgICAgaWYgKCRtZW50aW9u
KSB7CiAgICAgICAgICAgICRzZWFyY2guPSAoKCRzZWFyY2gpPycgJzonJykuJ0AnLnRyaW0o
JG1lbnRpb24pOwogICAgICAgIH0KCiAgICAgICAgaWYgKGVtcHR5KCRzZWFyY2gpKSB7CiAg
ICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkc2Vh
cmNoID0gdXJsZW5jb2RlKCRzZWFyY2gpOwogICAgICAgIH0KCiAgICAgICAgJG91dCA9IGFy
cmF5KCk7CiAgICAgICAgJHR3ZWV0cyA9ICR0d2l0LT5nZXQoJ2h0dHA6Ly9zZWFyY2gudHdp
dHRlci5jb20vc2VhcmNoLmF0b20/cT0nLiRzZWFyY2gKICAgICAgICAgICAgLCBhcnJheSgn
cnBwJz0+JGxpbWl0LCdsYW5nJz0+JGxhbmcpKTsKCiAgICAgICAgaWYgKCR0d2VldHMpIHsg
Zm9yZWFjaCAoJHR3ZWV0cy0+ZW50cnkgYXMgJHR3ZWV0KSB7CiAgICAgICAgICAgIHByZWdf
bWF0Y2goIi8oLiopIFwoKC4qKVwpLyIsJHR3ZWV0LT5hdXRob3ItPm5hbWUsJG1hdGNoZXMp
OwogICAgICAgICAgICBsaXN0KCRhdXRob3IsJHVuYW1lLCRuYW1lKSA9ICRtYXRjaGVzOwog
ICAgICAgICAgICAkdGltZSA9IHN0cnRvdGltZShodG1sZW50aXRpZXMoJHR3ZWV0LT5wdWJs
aXNoZWQpKTsKICAgICAgICAgICAgJGRhdGUgPSBzYWZlX3N0cmZ0aW1lKCRkYXRlZm9ybWF0
LCR0aW1lKTsKICAgICAgICAgICAgJHRleHQgPSAkdHdlZXQtPnRpdGxlOwogICAgICAgICAg
ICAkb3V0W10gPSB0YWcoaHJlZihodG1sZW50aXRpZXMoJHVuYW1lKSwkdHdlZXQtPmF1dGhv
ci0+dXJpLAogICAgICAgICAgICAgICAgJyB0aXRsZT0iJy5odG1sZW50aXRpZXMoJG5hbWUp
LiciJykuJzogJywnc3BhbicKICAgICAgICAgICAgICAgICAgICAsJyBjbGFzcz0iJy4kY2xh
c3NfdXNlci4nIicpCiAgICAgICAgICAgICAgICAuYXJjX1R3aXR0ZXI6Om1ha2VMaW5rcyho
dG1sZW50aXRpZXMoJHRleHQsIEVOVF9RVU9URVMsJ1VURi04JykpCiAgICAgICAgICAgICAg
ICAuJyAnLnRhZyhodG1sZW50aXRpZXMoJGRhdGUpLCdzcGFuJwogICAgICAgICAgICAgICAg
ICAgICwnIGNsYXNzPSInLiRjbGFzc19wb3N0ZWQuJyInKTsKICAgICAgICB9IHJldHVybiBk
b0xhYmVsKCRsYWJlbCwgJGxhYmVsdGFnKQogICAgICAgICAgICAuZG9XcmFwKCRvdXQsICR3
cmFwdGFnLCAkYnJlYWssICRjbGFzcyk7IH0KCn0KCmZ1bmN0aW9uIGFyY190d2l0dGVyX3R3
ZWV0KCRhdHRzKSB7CiAgICBnbG9iYWwgJHRoaXNhcnRpY2xlOwoKICAgIGV4dHJhY3QobEF0
dHMoYXJyYXkoCiAgICAgICdpZCcgICAgICAgID0+ICR0aGlzYXJ0aWNsZVsndGhpc2lkJ10s
CiAgICAgICdpbmNsdWRlX3VybCcgICA9PiB0cnVlCiAgICApLCRhdHRzKSk7CgogICAgaWYg
KCRpZCkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2Vl
dCBmcm9tCiAgICAgICR0d2VldCA9ICgkaW5jbHVkZV91cmwpID8gc2FmZV9yb3coInR3ZWV0
IiwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKQogICAgICAgIDogc2FmZV9y
b3coIlJFUExBQ0UodHdlZXQsQ09OQ0FUKCcgJyx0aW55dXJsKSwnJykgQVMgdHdlZXQiCiAg
ICAgICAgICAsICdhcmNfdHdpdHRlcicsICJhcnRpY2xlX2lkPXskaWR9Iik7CiAgICB9Cgog
ICAgaWYgKCR0d2VldFsndHdlZXQnXSkgewogICAgICByZXR1cm4gYXJjX1R3aXR0ZXI6Om1h
a2VMaW5rcygKICAgICAgICBodG1sZW50aXRpZXMoJHR3ZWV0Wyd0d2VldCddLCBFTlRfUVVP
VEVTLCdVVEYtOCcpKTsKICAgIH0KfQoKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdHdlZXRfdXJs
KCRhdHRzLCAkdGhpbmc9bnVsbCkgewogICAgZ2xvYmFsICR0aGlzYXJ0aWNsZSwkcHJlZnM7
CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgJ2lkJyAgICAgID0+ICR0aGlzYXJ0
aWNsZVsndGhpc2lkJ10sCiAgICAgICd0aXRsZScgICA9PiAnJywKICAgICAgJ2NsYXNzJyAg
ID0+ICcnCiAgICApLCRhdHRzKSk7CgogICAgaWYgKCRpZCkgewogICAgICAvLyBGZXRjaCBh
cmNfdHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBmcm9tCiAgICAgICR0d2VldCA9IHNh
ZmVfcm93KCJ0d2VldF9pZCIKICAgICAgICAsICdhcmNfdHdpdHRlcicsICJhcnRpY2xlX2lk
PXskaWR9Iik7CiAgICB9CgogICAgaWYgKCR0d2VldFsndHdlZXRfaWQnXSkgewogICAgICAk
dXJsID0gImh0dHA6Ly90d2l0dGVyLmNvbS8iLiRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlcidd
LiIvc3RhdHVzLyIuJHR3ZWV0Wyd0d2VldF9pZCddOwogICAgICBpZiAoJHRoaW5nPT09bnVs
bCkgewogICAgICAgIHJldHVybiAkdXJsOwogICAgICB9CiAgICAgIHJldHVybiBocmVmKHBh
cnNlKCR0aGluZyksICR1cmwsCiAgICAgICAgKCR0aXRsZSA/ICcgdGl0bGU9IicuJHRpdGxl
LiciJyA6ICcnKQogICAgICAgIC4oJGNsYXNzID8gJyBjbGFzcz0iJy4kY2xhc3MuJyInIDog
JycpKTsKICAgIH0KfQoKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdGlueXVybCgkYXR0cywgJHRo
aW5nPW51bGwpIHsKICAgIGdsb2JhbCAkdGhpc2FydGljbGU7CgogICAgZXh0cmFjdChsQXR0
cyhhcnJheSgKICAgICAgJ2lkJyAgICAgID0+ICR0aGlzYXJ0aWNsZVsndGhpc2lkJ10sCiAg
ICAgICd0aXRsZScgICA9PiAnJywKICAgICAgJ2NsYXNzJyAgID0+ICcnCiAgICApLCRhdHRz
KSk7CgogICAgaWYgKCRpZCkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0
byBidWlsZCB0d2VldCBmcm9tCiAgICAgICR0d2VldCA9IHNhZmVfcm93KCJ0aW55dXJsIgog
ICAgICAgICwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKTsKICAgIH0KCiAg
ICBpZiAoJHR3ZWV0Wyd0aW55dXJsJ10pIHsKICAgICAgaWYgKCR0aGluZz09PW51bGwpIHsK
ICAgICAgICByZXR1cm4gJHR3ZWV0Wyd0aW55dXJsJ107CiAgICAgIH0KCiAgICAgIHJldHVy
biBocmVmKHBhcnNlKCR0aGluZyksICR0d2VldFsndGlueXVybCddLAogICAgICAgICgkdGl0
bGUgPyAnIHRpdGxlPSInLiR0aXRsZS4nIicgOiAnJykKICAgICAgICAuKCRjbGFzcyA/ICcg
Y2xhc3M9IicuJGNsYXNzLiciJyA6ICcnKSk7CiAgICB9Cn0KCmZ1bmN0aW9uIGFyY190d2l0
dGVyX3JldHdlZXQoJGF0dHMsICR0aGluZz1udWxsKQp7CiAgICBnbG9iYWwgJHByZWZzLCRh
cmNfdHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0Owog
ICAgZ2xvYmFsICR0aGlzYXJ0aWNsZTsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAg
ICAgICd1c2VyJyAgICAgID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLCAvLyB2aWEg
dXNlciBhY2NvdW50CiAgICAgICAgJ3VybCcgICAgICAgPT4gJycsCiAgICAgICAgJ3RleHQn
ICAgICAgPT4gJycsCiAgICAgICAgJ2ZvbGxvdzEnICAgPT4gJycsCiAgICAgICAgJ2ZvbGxv
dzInICAgPT4gJycsCiAgICAgICAgJ2xhbmcnICAgICAgPT4gJycsCiAgICAgICAgJ2NvdW50
JyAgICAgPT4gJ2hvcml6b250YWwnLAogICAgICAgICdpbmNsdWRlX2pzJz0+IHRydWUsCiAg
ICAgICAgJ3dyYXB0YWcnICAgPT4gJycsCiAgICAgICAgJ2NsYXNzJyAgICAgPT4gJ3R3aXR0
ZXItc2hhcmUtYnV0dG9uJwogICAgKSwkYXR0cykpOwoKICAgICRxID0gJyc7IC8vIHF1ZXJ5
IHN0cmluZwoKICAgIGlmICgkaWQ9JHRoaXNhcnRpY2xlWyd0aGlzaWQnXSkgewogICAgICAv
LyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBmcm9tCiAgICAgICRy
b3cgPSBzYWZlX3JvdygiUkVQTEFDRSh0d2VldCxDT05DQVQoJyAnLHRpbnl1cmwpLCcnKSBB
UyB0d2VldCx0aW55dXJsIgogICAgICAgICwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9
eyRpZH0iKTsKCiAgICAgIGlmICgkdXJsPT0nJykgewogICAgICAgICR1cmwgPSAoJHVybCkg
PyAkdXJsIDogcGVybWxpbmt1cmwoJHRoaXNhcnRpY2xlKTsKICAgICAgICAkcSA9ICd1cmw9
Jy51cmxlbmNvZGUoJHVybCk7CiAgICAgIH0KICAgICAgaWYgKCR0ZXh0PT0nJykgewogICAg
ICAgICR0ZXh0ID0gKCRyb3dbJ3R3ZWV0J10pID8gJHJvd1sndHdlZXQnXSA6ICR0aGlzYXJ0
aWNsZVsndGl0bGUnXTsKICAgICAgfQogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycp
Lid0ZXh0PScudXJsZW5jb2RlKCR0ZXh0KTsKICAgIH0KICAgIGlmICgkdXNlcikgewogICAg
ICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLid2aWE9Jy51cmxlbmNvZGUoJHVzZXIpOwog
ICAgfQogICAgaWYgKCRmb2xsb3cxJiYkZm9sbG93MikgewogICAgICAkcSAuPSAoJHEgPyAn
JmFtcDsnIDogJycpLidyZWxhdGVkPScudXJsZW5jb2RlKCRmb2xsb3cxLic6Jy4kZm9sbG93
Mik7CiAgICB9IGVsc2VpZiAoJGZvbGxvdzF8fCRmb2xsb3cyKSB7CiAgICAgICRxIC49ICgk
cSA/ICcmYW1wOycgOiAnJykuJ3JlbGF0ZWQ9Jy51cmxlbmNvZGUoJGZvbGxvdzEuJGZvbGxv
dzIpOwogICAgfQoKICAgIHN3aXRjaCAoJGxhbmcpIHsKICAgICAgY2FzZSAnZnInOiBicmVh
azsgY2FzZSAnZGUnOiBicmVhazsgY2FzZSAnZXMnOiBicmVhazsgY2FzZSAnanAnOiBicmVh
azsKICAgICAgZGVmYXVsdDoKICAgICAgICAkbGFuZyA9ICdlbic7CiAgICB9CiAgICAkcSAu
PSAoJHEgPyAnJmFtcDsnIDogJycpLidsYW5nPScudXJsZW5jb2RlKCRsYW5nKTsKCiAgICBz
d2l0Y2ggKCRjb3VudCkgewogICAgICBjYXNlICdub25lJzogYnJlYWs7IGNhc2UgJ3ZlcnRp
Y2FsJzogYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgJGNvdW50ID0gJ2hvcml6b250
YWwnOwogICAgfQogICAgJHEgLj0gKCRxID8gJyZhbXA7JyA6ICcnKS4nY291bnQ9Jy51cmxl
bmNvZGUoJGNvdW50KTsKCiAgICAkdGhpbmcgPSAoJHRoaW5nPT09bnVsbCkgPyAnVHdlZXQn
IDogcGFyc2UoJHRoaW5nKTsKCiAgICAkaHRtbCA9IGhyZWYoJHRoaW5nLCdodHRwOi8vdHdp
dHRlci5jb20vc2hhcmU/Jy4kcQogICAgICAsICcgY2xhc3M9IicuJGNsYXNzLiciJyk7Cgog
ICAgJGpzID0gKCRpbmNsdWRlX2pzKSA/CiAgICAgICc8c2NyaXB0IHNyYz0iaHR0cDovL3Bs
YXRmb3JtLnR3aXR0ZXIuY29tL3dpZGdldHMuanMiIHR5cGU9InRleHQvamF2YXNjcmlwdCI+
PC9zY3JpcHQ+JwogICAgICA6ICcnOwoKICAgIHJldHVybiAkanMuJGh0bWw7Cn0KCi8qCiAg
ICBBZG1pbi1zaWRlIGZ1bmN0aW9ucwogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoqLwoKLy8gSW5zdGFsbGF0
aW9uIGZ1bmN0aW9uIC0gYnVpbGRzIE15U1FMIHRhYmxlCmZ1bmN0aW9uIGFyY190d2l0dGVy
X2luc3RhbGwoKQp7CgogICAgLy8gRm9yIGZpcnN0IGluc3RhbGwsIGNyZWF0ZSB0YWJsZSBm
b3IgdHdlZXRzCiAgICAkc3FsID0gIkNSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTICIuUEZY
LiJhcmNfdHdpdHRlciAiOwogICAgJHNxbC49ICIoYXJjX3R3aXR0ZXJpZCBJTlRFR0VSIEFV
VE9fSU5DUkVNRU5UIFBSSU1BUlkgS0VZLAogICAgICAgIGFydGljbGVfaWQgSU5URUdFUigx
MSksCiAgICAgICAgdHdlZXRfaWQgQklHSU5UKDIwKSwKICAgICAgICB0d2VldCBWQVJDSEFS
KDE0MCksCiAgICAgICAgdGlueXVybCBWQVJDSEFSKDMwKSk7IjsKCiAgICBpZiAoIXNhZmVf
cXVlcnkoJHNxbCkpIHsKICAgICAgICByZXR1cm4gJ0Vycm9yIC0gdW5hYmxlIHRvIGNyZWF0
ZSBhcmNfdHdpdHRlciB0YWJsZSc7CiAgICB9Cgp9CgovLyBVbmluc3RhbGwgZnVuY3Rpb24g
LSBkZWxldGVzIE15U1FMIHRhYmxlIGFuZCByZWxhdGVkIHByZWZlcmVuY2VzCmZ1bmN0aW9u
IGFyY190d2l0dGVyX3VuaW5zdGFsbCgpCnsKCiAgICAkc3FsID0gIkRST1AgVEFCTEUgSUYg
RVhJU1RTICIuUEZYLiJhcmNfdHdpdHRlcjsiOwogICAgaWYgKCFzYWZlX3F1ZXJ5KCRzcWwp
KSB7CiAgICAgICAgcmV0dXJuICdFcnJvciAtIHVuYWJsZSB0byBkZWxldGUgYXJjX3R3aXR0
ZXIgdGFibGUnOwogICAgfQoKICAgICRzcWwgPSAiREVMRVRFIEZST00gICIuUEZYLiJ0eHBf
cHJlZnMgV0hFUkUgZXZlbnQ9J2FyY190d2l0dGVyJzsiOwogICAgaWYgKCFzYWZlX3F1ZXJ5
KCRzcWwpKSB7CiAgICAgICAgcmV0dXJuICdFcnJvciAtIHVuYWJsZSB0byBkZWxldGUgYXJj
X3R3aXR0ZXIgcHJlZmVyZW5jZXMnOwogICAgfQoKfQpmdW5jdGlvbiBhcmNfdHdpdHRlcl91
cmxfbWV0aG9kX3NlbGVjdCgkbmFtZSwgJHZhbCkKewogICAgJG1ldGhvZHMgPSBhcnJheSgn
dGlueXVybCcgPT4gJ1Rpbnl1cmwnLAogICAgICAnaXNnZCcgPT4gJ0lzLmdkJywKICAgICAg
J2FyY190d2l0dGVyJyA9PiAnVFhQIFR3ZWV0JywKICAgICAgJ3NtZCcgPT4gJ3NtZF9zaG9y
dF91cmwnKTsKICAgIHJldHVybiBzZWxlY3RJbnB1dCgkbmFtZSwgJG1ldGhvZHMsICR2YWwp
Owp9CmZ1bmN0aW9uIGFyY190d2l0dGVyX3RhYl9zZWxlY3QoJG5hbWUsICR2YWwpCnsKICAg
ICR0YWJzID0gYXJyYXkoJ2NvbnRlbnQnID0+ICdDb250ZW50JywKICAgICAgICAnZXh0ZW5z
aW9ucycgPT4gJ0V4dGVuc2lvbnMnLAogICAgICAgICcnID0+ICdIaWRkZW4nKTsKICAgIHJl
dHVybiBzZWxlY3RJbnB1dCgkbmFtZSwgJHRhYnMsICR2YWwpOwp9Ci8vIFByb3ZpZGUgaW50
ZXJmYWNlIGZvciBzZXR0aW5nIHByZWZlcmVuY2VzCmZ1bmN0aW9uIGFyY190d2l0dGVyX3By
ZWZzKCRldmVudCwkc3RlcCkKewoKICAgIGdsb2JhbCAkcHJlZnMsJGFyY190d2l0dGVyX2Nv
bnN1bWVyS2V5LCRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiAgICAkdXNlciAgICAg
ICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddOwogICAgJHByZWZpeCAgICAgICAg
PSAkcHJlZnNbJ2FyY190d2l0dGVyX3ByZWZpeCddOwogICAgJHR3ZWV0X2RlZmF1bHQgPSAk
cHJlZnNbJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnXTsKICAgICR1cmxfbWV0aG9kICAg
ID0gJHByZWZzWydhcmNfdHdpdHRlcl91cmxfbWV0aG9kJ107CiAgICAkc2hvcnRfdXJsICAg
ICA9ICRwcmVmc1snYXJjX3Nob3J0X3VybCddOwogICAgJHNob3J0X3NpdGVfdXJsPSAkcHJl
ZnNbJ2FyY19zaG9ydF9zaXRlX3VybCddOwogICAgJGNhY2hlX2RpciAgICAgPSAkcHJlZnNb
J2FyY190d2l0dGVyX2NhY2hlX2RpciddOwogICAgJHRhYiAgICAgICAgICAgPSAkcHJlZnNb
J2FyY190d2l0dGVyX3RhYiddOwoKICAgIHN3aXRjaCAoJHN0ZXApIHsKICAgICAgICBjYXNl
ICdwcmVmc19zYXZlJzogcGFnZXRvcCgnVFhQIFR3ZWV0JywgJ1ByZWZlcmVuY2VzIHNhdmVk
Jyk7IGJyZWFrOwogICAgICAgIGNhc2UgJ3JlZ2lzdGVyJzogcGFnZXRvcCgnVFhQIFR3ZWV0
JywnQ29ubmVjdCB0byBUd2l0dGVyJyk7IGJyZWFrOwogICAgICAgIGNhc2UgJ3ZhbGlkYXRl
JzoKICAgICAgICBkZWZhdWx0OiBwYWdldG9wKCdUWFAgVHdlZXQnKTsKICAgIH0KCiAgICAk
aHRtbCA9ICcnOwoKICAgIGlmICgkc3RlcD09J3JlZ2lzdGVyJykgeyAvLyBPQXV0aCByZWdp
c3RyYXRpb24gcHJvY2VzcwogICAgICAgICR0d2l0ID0gbmV3IGFyY190d2l0dGVyKCRhcmNf
dHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAsICRhcmNfdHdpdHRlcl9jb25zdW1l
clNlY3JldCk7CgogICAgICAgIC8vIEJ1aWxkIGEgY2FsbGJhY2sgVVJMIGZvciBUd2l0dGVy
IHRvIHJldHVybiB0byB0aGUgbmV4dCBzdGFnZQogICAgICAgICRjYWxsYmFja1VSTCA9ICR0
d2l0LT5jYWxsYmFja1VSTCgkZXZlbnQsJ3ZhbGlkYXRlJyk7CgogICAgICAgICRyZXF1ZXN0
ID0gJHR3aXQtPmdldFJlcXVlc3RUb2tlbigkY2FsbGJhY2tVUkwpOwogICAgICAgICRyZXF1
ZXN0X3Rva2VuID0gJHJlcXVlc3RbIm9hdXRoX3Rva2VuIl07CiAgICAgICAgJHJlcXVlc3Rf
dG9rZW5fc2VjcmV0ID0gJHJlcXVlc3RbIm9hdXRoX3Rva2VuX3NlY3JldCJdOwoKICAgICAg
ICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfcmVxdWVzdFRva2VuJywkcmVxdWVzdF90b2tlbgog
ICAgICAgICAgICAsICdhcmNfdHdpdHRlcicsMik7CiAgICAgICAgc2V0X3ByZWYoJ2FyY190
d2l0dGVyX3JlcXVlc3RUb2tlblNlY3JldCcsJHJlcXVlc3RfdG9rZW5fc2VjcmV0CiAgICAg
ICAgICAgICwgJ2FyY190d2l0dGVyJywyKTsKCiAgICAgICAgJGh0bWwuPSBzdGFydFRhYmxl
KCdlZGl0JykuCiAgICAgICAgICAgICAgICB0cih0ZCgKICAgICAgICAgICAgICAgICAgICAo
JzxwPicuaHJlZignU2lnbi1pbiB0byBUd2l0dGVyJwogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgLCR0d2l0LT5nZXRBdXRob3JpemVVUkwoJHJlcXVlc3QpKQogICAgICAgICAgICAg
ICAgICAgICAgICAuJyBhbmQgZm9sbG93IHRoZSBpbnN0cnVjdGlvbnMgdG8gYWxsb3cgVFhQ
IFR3ZWV0IHRvIHVzZSB5b3VyIGFjY291bnQuIElmIHlvdSBhcmUgYWxyZWFkeSBzaWduZWQg
aW4gdG8gVHdpdHRlciB0aGVuIHRoYXQgYWNjb3VudCB3aWxsIGJlIGFzc29jaWF0ZWQgd2l0
aCBUWFAgVHdlZXQgc28geW91IG1heSBuZWVkIHRvIHNpZ24gb3V0IGZpcnN0IGlmIHlvdSB3
YW50IHRvIHVzZSBhIGRpZmZlcmVudCBhY2NvdW50LjwvcD4nKQogICAgICAgICAgICAgICAg
KSkuZW5kVGFibGUoKTsKICAgIH0gZWxzZWlmICgkc3RlcD09J3ZhbGlkYXRlJykgewogICAg
ICAgICR0d2l0ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQog
ICAgICAgICAgICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCwgJHByZWZzWydhcmNf
dHdpdHRlcl9yZXF1ZXN0VG9rZW4nXQogICAgICAgICAgICAsICRwcmVmc1snYXJjX3R3aXR0
ZXJfcmVxdWVzdFRva2VuU2VjcmV0J10pOwogICAgICAgIC8vIEFzayBUd2l0dGVyIGZvciBh
biBhY2Nlc3MgdG9rZW4gKGFuZCBhbiBhY2Nlc3MgdG9rZW4gc2VjcmV0KQogICAgICAgICRy
ZXF1ZXN0ID0gJHR3aXQtPmdldEFjY2Vzc1Rva2VuKCBncHMoJ29hdXRoX3ZlcmlmaWVyJykg
KTsKICAgICAgICAkYWNjZXNzX3Rva2VuID0gJHJlcXVlc3RbJ29hdXRoX3Rva2VuJ107CiAg
ICAgICAgJGFjY2Vzc190b2tlbl9zZWNyZXQgPSAkcmVxdWVzdFsnb2F1dGhfdG9rZW5fc2Vj
cmV0J107CiAgICAgICAgJHVzZXIgPSAkcmVxdWVzdFsnc2NyZWVuX25hbWUnXTsKICAgICAg
ICAvLyBTdG9yZSB0aGUgYWNjZXNzIHRva2VuIGFuZCBzZWNyZXQKICAgICAgICBzZXRfcHJl
ZignYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nLCRhY2Nlc3NfdG9rZW4sICdhcmNfdHdpdHRl
cicsMik7CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0
JywkYWNjZXNzX3Rva2VuX3NlY3JldAogICAgICAgICAgICAsICdhcmNfdHdpdHRlcicsMik7
CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3VzZXInLCR1c2VyKTsKICAgICAgICAk
cHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10gPSAkYWNjZXNzX3Rva2VuOwogICAg
ICAgICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSA9ICRhY2Nlc3Nf
dG9rZW5fc2VjcmV0OwogICAgICAgIHVuc2V0KCR0d2l0KTsKICAgIH0KCiAgICBpZiAoJHN0
ZXA9PSJwcmVmc19zYXZlIikgewogICAgICAgICRwcmVmaXggPSB0cmltKGdwcygnYXJjX3R3
aXR0ZXJfcHJlZml4JykpOwogICAgICAgICR0d2VldF9kZWZhdWx0ID0gZ3BzKCdhcmNfdHdp
dHRlcl90d2VldF9kZWZhdWx0Jyk7CiAgICAgICAgJHVybF9tZXRob2QgPSBncHMoJ2FyY190
d2l0dGVyX3VybF9tZXRob2QnKTsKICAgICAgICAkc2hvcnRfdXJsID0gZ3BzKCdhcmNfc2hv
cnRfdXJsJyk7CiAgICAgICAgJHNob3J0X3NpdGVfdXJsID0gZ3BzKCdhcmNfc2hvcnRfc2l0
ZV91cmwnKTsKICAgICAgICAkY2FjaGVfZGlyID0gZ3BzKCdhcmNfdHdpdHRlcl9jYWNoZV9k
aXInKTsKICAgICAgICAkdGFiID0gZ3BzKCdhcmNfdHdpdHRlcl90YWInKTsKICAgICAgICBp
ZiAoc3RybGVuKCRwcmVmaXgpPD0yMCkgewogICAgICAgICAgICBzZXRfcHJlZignYXJjX3R3
aXR0ZXJfcHJlZml4JywkcHJlZml4KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAk
cHJlZml4ID0gJHByZWZzWydhcmNfdHdpdHRlcl9wcmVmaXgnXTsKICAgICAgICB9CiAgICAg
ICAgJHR3ZWV0X2RlZmF1bHQgPSAoJHR3ZWV0X2RlZmF1bHQpID8gMSA6IDA7CiAgICAgICAg
c2V0X3ByZWYoJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnLCR0d2VldF9kZWZhdWx0KTsK
ICAgICAgICBzZXRfcHJlZignYXJjX3Nob3J0X3VybCcsJHNob3J0X3VybCk7CiAgICAgICAg
c2V0X3ByZWYoJ2FyY190d2l0dGVyX3VybF9tZXRob2QnLCR1cmxfbWV0aG9kKTsKICAgICAg
ICBzZXRfcHJlZignYXJjX3Nob3J0X3NpdGVfdXJsJywkc2hvcnRfc2l0ZV91cmwpOwogICAg
ICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9jYWNoZV9kaXInLCRjYWNoZV9kaXIpOwogICAg
ICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl90YWInLCR0YWIpOwogICAgfQoKICAgIGlmICgg
JHN0ZXAhPSdyZWdpc3RlcicgKSB7CiAgICAgICAgaWYgKCBpc3NldCgkcHJlZnNbJ2FyY190
d2l0dGVyX2FjY2Vzc1Rva2VuJ10pCiAgICAgICAgJiYgaXNzZXQoJHByZWZzWydhcmNfdHdp
dHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKSApIHsKICAgICAgICAgICAgJHR3aXQgPSBuZXcg
YXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgICAgICAgICAs
ICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nl
c3NUb2tlbiddCiAgICAgICAgICAgICAgICAsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNz
VG9rZW5TZWNyZXQnXSk7CiAgICAgICAgICAgICRyZWdpc3RlclVSTCA9ICR0d2l0LT5jYWxs
YmFja1VSTCgkZXZlbnQsJ3JlZ2lzdGVyJyk7CiAgICAgICAgICAgICRodG1sLj0gc3RhcnRU
YWJsZSgnbGlzdCcpLmZvcm0oCiAgICAgICAgICAgICAgICB0cigKICAgICAgICAgICAgICAg
ICAgICB0ZGNzKGhlZCgnVHdpdHRlciBhY2NvdW50IGRldGFpbHMnLCAyKSwyKQogICAgICAg
ICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAogICAgICAgICAgICAgICAgICAgIHRk
YSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfdXNlciI+VHdpdHRlciB1c2VybmFtZTwvbGFi
ZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmln
aHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRk
KAogICAgICAgICAgICAgICAgICAgICAgICAoJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10p
ID8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICR1c2VyLicgKCcuaHJlZignUmUtY29u
bmVjdCcsJHJlZ2lzdGVyVVJMKS4nKScKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDog
JzxlbT51bmtub3duPC9lbT4nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaHJlZign
Q29ubmVjdCB0byBUd2l0dGVyJywkcmVnaXN0ZXJVUkwpKQogICAgICAgICAgICAgICAgKQog
ICAgICAgICAgICAgICAgLnRyKAogICAgICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdUd2Vl
dCBzZXR0aW5ncycsIDIpLDIpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAu
dHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl9j
YWNoZV9kaXIiPlR3ZWV0IHByZWZpeDwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAg
ICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7
IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKGZJbnB1dCgndGV4dCcsJ2FyY190d2l0dGVy
X3ByZWZpeCcsJHByZWZpeCwnJywnJywnJywnJywnJywnYXJjX3R3aXR0ZXJfcHJlZml4Jykp
CiAgICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVs
IGZvcj0iYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCI+VHdlZXQgYXJ0aWNsZXMgYnkgZGVm
YXVsdDwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1h
bGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAg
ICAgICAgLnRkKHllc25vUmFkaW8oJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnLCAkdHdl
ZXRfZGVmYXVsdCwgJycsICdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0JykpCiAgICAgICAg
ICAgICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJj
X3R3aXR0ZXJfdXJsX21ldGhvZCI+VVJMIHNob3J0bmVyPC9sYWJlbD4nLAogICAgICAgICAg
ICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxp
Z246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoYXJjX3R3aXR0ZXJfdXJs
X21ldGhvZF9zZWxlY3QoJ2FyY190d2l0dGVyX3VybF9tZXRob2QnLCR1cmxfbWV0aG9kKSkK
ICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAgICAgICAgICAgdGRjcyhoZWQoJ1RY
UCBUd2VldCBzaG9ydCBVUkwnLCAyKSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAg
ICAgICAgLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3No
b3J0X3VybF9tZXRob2QiPkVuYWJsZSBUWFAgVHdlZXQgc2hvcnQgVVJMIHJlZGlyZWN0PC9s
YWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiBy
aWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAu
dGQoeWVzbm9SYWRpbygnYXJjX3Nob3J0X3VybCcsICRzaG9ydF91cmwsICcnLCAnYXJjX3No
b3J0X3VybCcpKSwKICAgICAgICAgICAgICAgICAgICAnIGlkPSJhcmNfc2hvcnRfdXJsLW9u
X29mZiInCiAgICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgn
PGxhYmVsIGZvcj0iYXJjX3Nob3J0X3NpdGVfdXJsIj5UWFAgVHdlZXQgc2hvcnQgc2l0ZSBV
Ukw8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxp
Z246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAg
ICAgIC50ZChmSW5wdXQoJ3RleHQnLCdhcmNfc2hvcnRfc2l0ZV91cmwnLCRzaG9ydF9zaXRl
X3VybCwnJywnJywnJywnJywnJywnYXJjX3Nob3J0X3NpdGVfdXJsJykpLAogICAgICAgICAg
ICAgICAgICAgICcgaWQ9ImFyY19zaG9ydF9zaXRlX3VybC1vcHRpb24iJwogICAgICAgICAg
ICAgICAgKS50cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVHdpdHRlciB0YWIn
LCAyKSwyKQogICAgICAgICAgICAgICAgKS50cigKICAgICAgICAgICAgICAgICAgICB0ZGEo
JzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX3RhYiI+TG9jYXRpb24gb2YgVHdpdHRlciB0YWI8
L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246
IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAg
IC50ZChhcmNfdHdpdHRlcl90YWJfc2VsZWN0KCdhcmNfdHdpdHRlcl90YWInLCR0YWIpKQog
ICAgICAgICAgICAgICAgKS50cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnQ2Fj
aGUnLCAyKSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAogICAg
ICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfY2FjaGVfZGly
Ij5DYWNoZSBkaXJlY3Rvcnk8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcg
c3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQog
ICAgICAgICAgICAgICAgICAgIC50ZChmSW5wdXQoJ3RleHQnLCdhcmNfdHdpdHRlcl9jYWNo
ZV9kaXInLCRjYWNoZV9kaXIsJycsJycsJycsJycsJycsJ2FyY190d2l0dGVyX2NhY2hlX2Rp
cicpKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAogICAgICAgICAg
ICAgICAgICAgIHRkYSgKICAgICAgICAgICAgICAgICAgICAgICAgZklucHV0KCdzdWJtaXQn
LCAnU3VibWl0JywgZ1R4dCgnc2F2ZV9idXR0b24nKSwgJ3B1Ymxpc2gnKQogICAgICAgICAg
ICAgICAgICAgICAgICAubi5zSW5wdXQoJ3ByZWZzX3NhdmUnKQogICAgICAgICAgICAgICAg
ICAgICAgICAubi5lSW5wdXQoJ3BsdWdpbl9wcmVmcy5hcmNfdHdpdHRlcicpCiAgICAgICAg
ICAgICAgICAgICAgLCAnIGNvbHNwYW49IjIiIGNsYXNzPSJub2xpbmUiJykpKQogICAgICAg
ICAgICAgICAgLmVuZFRhYmxlKCk7CiAgICAgICAgfSBlbHNlaWYgKCAkc3RlcCE9J3JlZ2lz
dGVyJyApIHsKICAgICAgICAgICAgJHJlZ2lzdGVyVVJMID0gYXJjX3R3aXR0ZXI6OmNhbGxi
YWNrVVJMKCRldmVudCwncmVnaXN0ZXInKTsKICAgICAgICAgICAgJGh0bWwuPSBzdGFydFRh
YmxlKCdsaXN0JykuZm9ybSgKICAgICAgICAgICAgICAgIHRyKAogICAgICAgICAgICAgICAg
ICAgIHRkY3MoaGVkKCdUd2l0dGVyIGFjY291bnQgZGV0YWlscycsIDIpLDIpCiAgICAgICAg
ICAgICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAgICAgICAgdGRh
KCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl91c2VyIj5Ud2l0dGVyIHVzZXJuYW1lPC9sYWJl
bD4nLAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdo
dDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQo
CiAgICAgICAgICAgICAgICAgICAgICAgICgnPGVtPnVua25vd248L2VtPiAoJwogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgLmhyZWYoJ0Nvbm5lY3QgdG8gVHdpdHRlcicsJHJlZ2lz
dGVyVVJMKS4nKScpCiAgICAgICAgICAgICAgICApKSkKICAgICAgICAgICAgICAgIC5lbmRU
YWJsZSgpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBTZXQgalF1ZXJ5IGZvciBzd2l0Y2hp
bmcgb24vb2ZmIHJlbGV2YW50IGFyY19zaG9ydF91cmwgZmllbGRzCiAgICAkanMgPSA8PDxK
Uwo8c2NyaXB0IGxhbmd1YWdlPSJqYXZhc2NyaXB0IiB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQi
PgokKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpewogIHZhciBvbm9mZiA9ICQoJyNhcmNf
c2hvcnRfdXJsLW9uX29mZicpOwogIHZhciBhcmNfc2hvcnRfdXJsX29mZiA9ICQoJyNhcmNf
c2hvcnRfdXJsLWFyY19zaG9ydF91cmwtMCcpOwogIHZhciB1cmwgPSAkKCcjYXJjX3Nob3J0
X3NpdGVfdXJsLW9wdGlvbicpOwogIHZhciB1cmxfbWV0aG9kID0gJCgnc2VsZWN0W25hbWU9
ImFyY190d2l0dGVyX3VybF9tZXRob2QiXScpOwoKICBpZiAoYXJjX3Nob3J0X3VybF9vZmYu
YXR0cignY2hlY2tlZCcpPT10cnVlCiAgJiYgJCgnb3B0aW9uOnNlbGVjdGVkJywgdXJsX21l
dGhvZCkudmFsKCkhPSdhcmNfdHdpdHRlcicpIHsKICAgIHVybC5oaWRlKCk7CiAgfQogICQo
J2lucHV0Jywgb25vZmYpLmNoYW5nZShmdW5jdGlvbigpewogICAgaWYgKCQoJ29wdGlvbjpz
ZWxlY3RlZCcsIHVybF9tZXRob2QpLnZhbCgpIT0nYXJjX3R3aXR0ZXInKSB7CiAgICAgIGFy
Y19zaG9ydF91cmxfb2ZmLmF0dHIoJ2NoZWNrZWQnKT09dHJ1ZSA/IHVybC5oaWRlKCkgOiB1
cmwuc2hvdygpOwogICAgfQogIH0pOwoKICBpZiAoJCgnb3B0aW9uOnNlbGVjdGVkJywgdXJs
X21ldGhvZCkudmFsKCk9PSdhcmNfdHdpdHRlcicpIHsKICAgIG9ub2ZmLmhpZGUoKTsgdXJs
LnNob3coKTsKICB9CiAgdXJsX21ldGhvZC5jaGFuZ2UoZnVuY3Rpb24oKXsKICAgIGlmICgk
KCdvcHRpb246c2VsZWN0ZWQnLCB1cmxfbWV0aG9kKS52YWwoKT09J2FyY190d2l0dGVyJykg
ewogICAgICBvbm9mZi50b2dnbGUoKTsgdXJsLnNob3coKTsKICAgIH0gZWxzZSB7CiAgICAg
IG9ub2ZmLnRvZ2dsZSgpOwogICAgICBhcmNfc2hvcnRfdXJsX29mZi5hdHRyKCdjaGVja2Vk
Jyk9PXRydWUgPyB1cmwuaGlkZSgpIDogdXJsLnNob3coKTsKICAgIH0KICB9KQp9KTsKPC9z
Y3JpcHQ+CkpTOwoKICAgIGVjaG8gJGpzLiRodG1sOwp9CgovLyBBZGQgVHdpdHRlciB0YWIg
dG8gVGV4dHBhdHRlcm4KZnVuY3Rpb24gYXJjX2FkbWluX3R3aXR0ZXIoJGV2ZW50LCRzdGVw
KQp7CiAgICBnbG9iYWwgJHByZWZzLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNf
dHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigk
YXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29u
c3VtZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXQogICAgICAg
ICAgICAsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSk7CgogICAg
JHR3aXQtPmNhY2hlRGlyKCRwcmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10pOwoKICAg
ICR4bWwgPSAkdHdpdC0+Z2V0KCd1c2Vycy9zaG93JwogICAgICAgICwgYXJyYXkoJ3NjcmVl
bl9uYW1lJz0+JHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10pKTsKICAgICR0d2l0dGVyVXNl
ciA9IEAkeG1sLT54cGF0aCgnL3VzZXInKTsKICAgICR0d2l0dGVyVXNlciA9ICR0d2l0dGVy
VXNlclswXTsKICAgICR0d2l0dGVyVXNlclVSTCA9ICdodHRwOi8vd3d3LnR3aXR0ZXIuY29t
LycuJHR3aXR0ZXJVc2VyLT5zY3JlZW5fbmFtZTsKCiAgICBpZiAoJHN0ZXA9PSJ0d2VldCIp
IHsgLy8gcG9zdCBhbiB1cGRhdGUgdG8gVHdpdHRlcgoKICAgICAgICAvLyBmZXRjaCBhbmQg
Y2xlYW4gbWVzc2FnZQogICAgICAgICRtZXNzYWdlID0gc3RyaXBfdGFncyhncHMoJ21lc3Nh
Z2UnKSk7CiAgICAgICAgJGNvdW50ID0gc3RybGVuKCRtZXNzYWdlKTsKCiAgICAgICAgaWYg
KCRjb3VudDw9MTQwICYmICRjb3VudD4wKSB7IC8vIHBvc3QgdXBkYXRlCiAgICAgICAgICAg
ICRyZXN1bHQgPSAkdHdpdC0+cG9zdCgnc3RhdHVzZXMvdXBkYXRlJywgYXJyYXkoJ3N0YXR1
cycgPT4gJG1lc3NhZ2UpKTsKICAgICAgICB9IGVsc2UgeyAvLyBtZXNzYWdlIHRvbyBsb25n
LCBKYXZhU2NyaXB0IGludGVyZmFjZSBzaG91bGQgcHJldmVudCB0aGlzCiAgICAgICAgICAg
ICRyZXN1bHQgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHBhZ2V0b3AoJ1R3aXR0ZXIn
LAogICAgICAgICAgICAoKCRyZXN1bHQhPWZhbHNlKT8nVHdpdHRlciB1cGRhdGVkJzonRXJy
b3IgdXBkYXRpbmcgVHdpdHRlcicpKTsKCiAgICB9IGVsc2VpZiAoJHN0ZXA9PSJkZWxldGUi
KSB7IC8vIGRlbGV0ZSBhbiB1cGRhdGUgZnJvbSBUd2l0dGVyCgogICAgICAgICRpZCA9IHN0
cmlwX3RhZ3MoZ3BzKCdpZCcpKTsKICAgICAgICBpZiAoJGlkKSB7CiAgICAgICAgICAgICR0
d2l0LT5kZWxldGUoJ3N0YXR1c2VzL2Rlc3Ryb3knLiRpZCk7CiAgICAgICAgICAgIHNhZmVf
ZGVsZXRlKCdhcmNfdHdpdHRlcicsInR3ZWV0X2lkID0gJGlkIik7CiAgICAgICAgfQoKICAg
ICAgICBwYWdldG9wKCdUd2l0dGVyJywnVHdpdHRlciB1cGRhdGVkJyk7CgogICAgfSBlbHNl
IHsKCiAgICAgICAgcGFnZXRvcCgnVHdpdHRlcicpOwoKICAgIH0KCiAgICAvLyBQcmVwYXJl
IEphdmFTY3JpcHQgdG8gY3JlYXRlIFR3aXR0ZXIgdXBkYXRlIGludGVyZmFjZQoKICAgICRq
cyA9ICc8c2NyaXB0IGxhbmd1YWdlPSJqYXZhc2NyaXB0IiB0eXBlPSJ0ZXh0L2phdmFzY3Jp
cHQiPic7CiAgICAkanMuPSAiJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXsKICAgICAg
ICAgICAgdmFyIGNvdW50ZXJTdHlsZSA9ICdmb250LXdlaWdodDpib2xkO2Zsb2F0OnJpZ2h0
O2ZvbnQtc2l6ZToyZW07bGluZS1oZWlnaHQ6MS4yZW07JzsKICAgICAgICAgICAgJCgnI3R3
ZWV0Y291bnQnKS5hdHRyKCdzdHlsZScsIGNvdW50ZXJTdHlsZSsnY29sb3I6I2NjYzsnKTsK
ICAgICAgICAgICAgJCgnI21lc3NhZ2UnKS5rZXl1cChmdW5jdGlvbigpIHsKICAgICAgICAg
ICAgICAgIHZhciBjb3VudCA9IDE0MC0kKCcjbWVzc2FnZScpLnZhbCgpLmxlbmd0aDsKICAg
ICAgICAgICAgICAgICQoJyN0d2VldGNvdW50JykuaHRtbChjb3VudCsnJyk7IC8vIGhhY2sg
dG8gZm9yY2Ugb3V0cHV0IG9mIDAKICAgICAgICAgICAgICAgIGlmIChjb3VudDwwKSB7CiAg
ICAgICAgICAgICAgICAgICAgJCgnaW5wdXQucHVibGlzaCcpLmF0dHIoJ2Rpc2FibGVkJywg
J2Rpc2FibGVkJyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAg
ICAgICQoJ2lucHV0LnB1Ymxpc2gnKS5hdHRyKCdkaXNhYmxlZCcsICcnKTsKICAgICAgICAg
ICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChjb3VudDwwKSB7CiAgICAgICAgICAgICAg
ICAgICAgJCgnI3R3ZWV0Y291bnQnKS5hdHRyKCdzdHlsZScsIGNvdW50ZXJTdHlsZSsnY29s
b3I6I2YwMDsnKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY291bnQ8MTApIHsKICAg
ICAgICAgICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0eWxlJywgY291bnRl
clN0eWxlKydjb2xvcjojMDAwOycpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAg
ICAgICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0eWxlJywgY291bnRlclN0
eWxlKydjb2xvcjojY2NjOycpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQog
ICAgICAgIH0pOyI7CiAgICAkanMuPSAiPC9zY3JpcHQ+IjsKCiAgICAkb3V0ID0gJyc7CiAg
ICAkeG1sID0gJHR3aXQtPmdldCgnc3RhdHVzZXMvdXNlcl90aW1lbGluZScKICAgICAgICAs
IGFycmF5KCdzY3JlZW5fbmFtZSc9PiRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLCdjb3Vu
dCc9PjI1KSk7CiAgICAkdHdlZXRzID0gQCR4bWwtPnhwYXRoKCcvc3RhdHVzZXMvc3RhdHVz
Jyk7CiAgICBpZiAoJHR3ZWV0cykgZm9yZWFjaCAoJHR3ZWV0cyBhcyAkdHdlZXQpIHsKICAg
ICAgICAkdGltZSA9IHN0cnRvdGltZShodG1sZW50aXRpZXMoJHR3ZWV0LT5jcmVhdGVkX2F0
KSk7CiAgICAgICAgJGRhdGUgPSBzYWZlX3N0cmZ0aW1lKCRwcmVmc1snYXJjaGl2ZV9kYXRl
Zm9ybWF0J10sJHRpbWUpOwogICAgICAgICRvdXQuPSB0cih0ZCgkZGF0ZSwnc3BhbicpCiAg
ICAgICAgICAgIC50ZChhcmNfVHdpdHRlcjo6bWFrZUxpbmtzKGh0bWxlbnRpdGllcygkdHdl
ZXQtPnRleHQKICAgICAgICAgICAgICAgICwgRU5UX1FVT1RFUywnVVRGLTgnKSkpCiAgICAg
ICAgICAgIC50ZChkTGluaygnYXJjX2FkbWluX3R3aXR0ZXInLCdkZWxldGUnLCdpZCcsJHR3
ZWV0LT5pZCwnJykpCiAgICAgICAgICAgICk7CiAgICB9CgogICAgJGh0bWwgPSBzdGFydFRh
YmxlKCdlZGl0JykKICAgICAgICAgICAgLnRyKHRkKAogICAgICAgICAgICBncmFmKCc8aW1n
IHNyYz0iJy4kdHdpdHRlclVzZXItPnByb2ZpbGVfaW1hZ2VfdXJsLiciIGFsdD0iVHdpdHRl
ciBhdmF0YXIiIC8+JwogICAgICAgICAgICAsJyBzdHlsZT0iZmxvYXQ6bGVmdDtwYWRkaW5n
OjJweDsiJykKICAgICAgICAgICAgLmdyYWYoaHJlZigkdHdpdHRlclVzZXItPm5hbWUsJHR3
aXR0ZXJVc2VyVVJMKSwnIHN0eWxlPSJmb250LXNpemU6MS4yZW07Zm9udC13ZWlnaHQ6Ym9s
ZDsiJykKICAgICAgICAgICAgLmdyYWYoaHJlZigkdHdpdHRlclVzZXItPmZyaWVuZHNfY291
bnQuJyBmb2xsb3dpbmcnLCR0d2l0dGVyVXNlclVSTC4nL2ZvbGxvd2luZycpCiAgICAgICAg
ICAgIC4nLCAnLmhyZWYoJHR3aXR0ZXJVc2VyLT5mb2xsb3dlcnNfY291bnQuJyBmb2xsb3dl
cnMnLCR0d2l0dGVyVXNlclVSTC4nL2ZvbGxvd2VycycpCiAgICAgICAgICAgIC4nLCAnLmhy
ZWYoJHR3aXR0ZXJVc2VyLT5zdGF0dXNlc19jb3VudC4nIHVwZGF0ZXMnLCR0d2l0dGVyVXNl
clVSTCkpKSkKICAgICAgICAgICAgLnRyKHRkKGZvcm0oCiAgICAgICAgICAgIGdyYWYoIlVw
ZGF0ZSBUd2l0dGVyLi4uPHNwYW4gaWQ9J3R3ZWV0Y291bnQnIHN0eWxlPSdmb250LXdlaWdo
dDpib2xkO2Zsb2F0OnJpZ2h0Oyc+MTQwPC9zcGFuPiIpCiAgICAgICAgICAgIC50ZXh0X2Fy
ZWEoJ21lc3NhZ2UnLCc1MCcsJzU1MCcsJycsJ21lc3NhZ2UnKQogICAgICAgICAgICAuZUlu
cHV0KCdhcmNfYWRtaW5fdHdpdHRlcicpCiAgICAgICAgICAgIC5zSW5wdXQoJ3R3ZWV0Jyku
YnIKICAgICAgICAgICAgLmZJbnB1dCgnc3VibWl0JywndXBkYXRlJyxnVHh0KCdVcGRhdGUn
KSwncHVibGlzaCcpCiAgICAgICAgKSkpCiAgICAgICAgLmVuZFRhYmxlKCk7CgogICAgLy8g
QXR0YWNoIHJlY2VudCBUd2l0dGVyIHVwZGF0ZXMKCiAgICAkaHRtbC49IHN0YXJ0VGFibGUo
J2xpc3QnLCcnLCcnLCcnLCc5MCUnKQogICAgICAgIC4kb3V0CiAgICAgICAgLmVuZFRhYmxl
KCk7CgogICAgLy8gT3V0cHV0IEphdmFTY3JpcHQgYW5kIEhUTUwKCiAgICBlY2hvICRqcy4k
aHRtbDsKfQoKLy8gQWRkIFR3aXR0ZXIgb3B0aW9ucyB0byBhcnRpY2xlIGFydGljbGUgc2Ny
ZWVuCmZ1bmN0aW9uIGFyY19hcHBlbmRfdHdpdHRlcigkZXZlbnQsICRzdGVwLCAkZGF0YSwg
JHJzMSkKewogICAgZ2xvYmFsICRwcmVmcywgJGFyY190d2l0dGVyOwogICAgJHByZWZpeCA9
IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9wcmVmaXgnKSk7CiAgICAkcHJlZml4ID0gKCRwcmVm
aXgpID8gJHByZWZpeCA6ICRwcmVmc1snYXJjX3R3aXR0ZXJfcHJlZml4J107CiAgICAkc3Vm
Zml4ID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3N1ZmZpeCcpKTsKCiAgICBpZiAoJHJzMVsn
SUQnXSkgewogICAgICAgICRzcWwgPSAiU0VMRUNUIHR3ZWV0X2lkLHR3ZWV0IEZST00gIi5Q
RlguImFyY190d2l0dGVyIFdIRVJFIGFydGljbGVfaWQ9Ii4kcnMxWydJRCddLiI7IjsKICAg
ICAgICAkcnMyID0gc2FmZV9xdWVyeSgkc3FsKTsgJHJzMiA9IG5leHRSb3coJHJzMik7CiAg
ICB9IGVsc2UgeyAvLyBuZXcgYXJ0aWNsZQogICAgICAgICRyczIgPSAnJzsKICAgIH0KCiAg
ICBpZiAoJHJzMVsnSUQnXSAmJiAkcnMyWyd0d2VldF9pZCddKSB7CiAgICAgICAgJGNvbnRl
bnQgPSBhcmNfVHdpdHRlcjo6bWFrZUxpbmtzKCRyczJbJ3R3ZWV0J10pOwogICAgICAgIHJl
dHVybiAkZGF0YS5maWVsZHNldCgkY29udGVudCwgJ1R3aXR0ZXIgdXBkYXRlJywgJ2FyY190
d2l0dGVyJyk7CiAgICB9IGVsc2UgewogICAgICAgICR2YXIgPSAoJHJzMVsnSUQnXSkgPyAw
IDogJHByZWZzWydhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0J107CiAgICAgICAgJGNvbnRl
bnQgID0gdGFnKHllc25vUmFkaW8oJ2FyY190d2VldF90aGlzJywgJHZhciwgJycsICdhcmNf
dHdlZXRfdGhpcycpLCdwJyk7CiAgICAgICAgJGNvbnRlbnQgLj0gdGFnKGhyZWYoJ09wdGlv
bnMnLCcjYXJjX3R3aXR0ZXJfb3B0aW9ucycpLCdwJywnIGNsYXNzPSJwbGFpbiBsZXZlciIg
c3R5bGU9Im1hcmdpbi10b3A6NXB4OyInKTsKICAgICAgICAkY29udGVudCAuPSB0YWcodGFn
KHRhZygnVHdlZXQgcHJlZml4JywnbGFiZWwnLCAnIGZvcj0iYXJjX3R3aXR0ZXJfcHJlZml4
IicpCiAgICAgICAgICAgIC5mSW5wdXQoJ3RleHQnLCdhcmNfdHdpdHRlcl9wcmVmaXgnLCRw
cmVmaXgsJ2VkaXQnLCcnLCcnLCcyMicsJycsJ2FyY190d2l0dGVyX3ByZWZpeCcpLCdwJykK
ICAgICAgICAgICAgLnRhZyh0YWcoJ1R3ZWV0IHN1ZmZpeCAoZWcgI2hhc2h0YWdzKScsJ2xh
YmVsJywgJyBmb3I9ImFyY190d2l0dGVyX3N1ZmZpeCInKQogICAgICAgICAgICAuZklucHV0
KCd0ZXh0JywnYXJjX3R3aXR0ZXJfc3VmZml4Jywkc3VmZml4LCdlZGl0JywnJywnJywnMjIn
LCcnLCdhcmNfdHdpdHRlcl9zdWZmaXgnKSwncCcpCiAgICAgICAgICAgICwnZGl2JywnIGlk
PSJhcmNfdHdpdHRlcl9vcHRpb25zIiBjbGFzcz0idG9nZ2xlIiBzdHlsZT0iZGlzcGxheTpu
b25lIicpOwogICAgICAgIGlmIChpc3NldCgkYXJjX3R3aXR0ZXJbJ2Vycm9yJ10pKSB7CiAg
ICAgICAgICAgICRjb250ZW50IC49ICc8cD4nLiRhcmNfdHdpdHRlclsnZXJyb3InXS4nPC9w
Pic7CiAgICAgICAgfQogICAgICAgIHJldHVybiAkZGF0YS5maWVsZHNldCgkY29udGVudCwg
J1VwZGF0ZSBUd2l0dGVyJywgJ2FyY190d2l0dGVyJyk7CiAgICB9Cgp9CgovLyBVcGRhdGUg
VHdpdHRlciB3aXRoIHBvc3RlZCBhcnRpY2xlCmZ1bmN0aW9uIGFyY19hcnRpY2xlX3R3ZWV0
KCRldmVudCwkc3RlcCkKewogICAgZ2xvYmFsICRwcmVmcywgJGFyY190d2l0dGVyLCAkYXJj
X3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNl
Y3JldDsKCiAgICAkYXJ0aWNsZV9pZCA9IGVtcHR5KCRHTE9CQUxTWydJRCddKSA/IGdwcygn
SUQnKSA6ICRHTE9CQUxTWydJRCddOwogICAgaWYgKCFlbXB0eSgkYXJ0aWNsZV9pZCkpIHsK
CiAgICAgICAgaW5jbHVkZV9vbmNlIHR4cGF0aC4nL3B1Ymxpc2gvdGFnaGFuZGxlcnMucGhw
JzsKCiAgICAgICAgJGFydGljbGUgPSBzYWZlX3JvdygiSUQsIFRpdGxlLCBTZWN0aW9uLCBQ
b3N0ZWQiLCAndGV4dHBhdHRlcm4nLAogICAgICAgICAgICAiSUQ9eyRhcnRpY2xlX2lkfSBB
TkQgU3RhdHVzPTQgQU5EIG5vdygpPj1Qb3N0ZWQiKTsKCiAgICAgICAgaWYgKCRhcnRpY2xl
ICYmIGdwcygnYXJjX3R3ZWV0X3RoaXMnKSkgeyAvLyB0d2VldCBhcnRpY2xlCgogICAgICAg
ICAgICAvLyBOZWVkIHRvIG1hbnVhbGx5IHVwZGF0ZSB0aGUgJ1VSTCBvbmx5IHRpdGxlJyBi
ZWZvcmUgYnVpbGRpbmcgdGhlCiAgICAgICAgICAgIC8vIFVSTAogICAgICAgICAgICAkYXJ0
aWNsZVsndXJsX3RpdGxlJ10gPSBncHMoJ3VybF90aXRsZScpOwogICAgICAgICAgICAvLyBN
YWtlIHNob3J0IFVSTAogICAgICAgICAgICAkdXJsID0gcGVybWxpbmt1cmwoJGFydGljbGUp
OwogICAgICAgICAgICAkc2hvcnRfdXJsID0gYXJjX3Nob3J0ZW5fdXJsKCR1cmwsJHByZWZz
WydhcmNfdHdpdHRlcl91cmxfbWV0aG9kJ10sCiAgICAgICAgICAgICAgICBhcnJheSgnaWQn
PT4kYXJ0aWNsZV9pZCkpOwoKICAgICAgICAgICAgaWYgKCEkc2hvcnRfdXJsKSB7IC8vIEZh
aWxlZCB0byBvYnRhaW4gYSBzaG9ydGVuZWQgVVJMLCBkbyBub3QgdHdlZXQhCiAgICAgICAg
ICAgICAgICAkYXJjX3R3aXR0ZXJbJ2Vycm9yJ10gPSAnVW5hYmxlIHRvIG9idGFpbiBhIHNo
b3J0IFVSTCBmb3IgdGhpcyBhcnRpY2xlLic7CgogICAgICAgICAgICAgICAgcmV0dXJuIGZh
bHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBDb25zdHJ1Y3QgVHdpdHRlciB1
cGRhdGUKICAgICAgICAgICAgJHByZWZpeCAgPSB0cmltKGdwcygnYXJjX3R3aXR0ZXJfcHJl
Zml4JykpOwogICAgICAgICAgICAkcHJlX2xlbiA9IHN0cmxlbigkcHJlZml4KTsKICAgICAg
ICAgICAgJHByZWZpeCAgPSAoJHByZWZpeCAmJiAkcHJlX2xlbjw9MjApID8gJHByZWZpeC4n
ICcgOiAnJzsKICAgICAgICAgICAgJHN1ZmZpeCAgPSB0cmltKGdwcygnYXJjX3R3aXR0ZXJf
c3VmZml4JykpOwogICAgICAgICAgICAkc3VmX2xlbiA9IHN0cmxlbigkc3VmZml4KTsKICAg
ICAgICAgICAgJHN1ZmZpeCAgPSAoJHN1ZmZpeCAmJiAkc3VmX2xlbjw9NDApID8gJyAnLiRz
dWZmaXggOiAnJzsKICAgICAgICAgICAgJHVybF9sZW4gPSBzdHJsZW4oJHNob3J0X3VybCkr
MTsgLy8gY291bnQgVVJMIGxlbmd0aCArIDEgZm9yIHByZWZpeGVkIHNwYWNlCiAgICAgICAg
ICAgIGlmICgkcHJlZml4KSAkcHJlX2xlbiArPSAxOwogICAgICAgICAgICBpZiAoJHN1ZmZp
eCkgJHN1Zl9sZW4gKz0gMTsKICAgICAgICAgICAgaWYgKChzdHJsZW4oJGFydGljbGVbJ1Rp
dGxlJ10pKyR1cmxfbGVuKyRwcmVfbGVuKyRzdWZfbGVuKT4xNDApIHsKICAgICAgICAgICAg
ICAgICRhcnRpY2xlWydUaXRsZSddID0gc3Vic3RyKCRhcnRpY2xlWydUaXRsZSddLDAsMTM1
LSR1cmxfbGVuLSRwcmVfbGVuLSRzdWZfbGVuKS4nLi4uJzsKICAgICAgICAgICAgfQogICAg
ICAgICAgICAkdHdlZXQgPSAkcHJlZml4LiRhcnRpY2xlWydUaXRsZSddLiIgIi4kc2hvcnRf
dXJsLiRzdWZmaXg7CgogICAgICAgICAgICAvLyBVcGRhdGUgVHdpdHRlcgogICAgICAgICAg
ICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAg
ICAgICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2Fy
Y190d2l0dGVyX2FjY2Vzc1Rva2VuJ10KICAgICAgICAgICAgICAgICwgJHByZWZzWydhcmNf
dHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKTsKICAgICAgICAgICAgJHJlc3VsdCA9ICR0
d2l0LT5wb3N0KCdzdGF0dXNlcy91cGRhdGUnLCBhcnJheSgnc3RhdHVzJyA9PiAkdHdlZXQp
KTsKCiAgICAgICAgICAgICR0d2VldF9pZCA9IChpc19vYmplY3QoJHJlc3VsdCkpID8gJHJl
c3VsdFswXS0+aWQgOiAwOwoKICAgICAgICAgICAgaWYgKCR0d2VldF9pZCkgewoKICAgICAg
ICAgICAgICAgICR0d2VldCA9IGFkZHNsYXNoZXMoJHR3ZWV0KTsKCiAgICAgICAgICAgICAg
ICAvLyB1cGRhdGUgYXJjX3R3aXR0ZXIgdGFibGUgd2l0aCB0d2VldAogICAgICAgICAgICAg
ICAgJHNxbCA9ICJJTlNFUlQgSU5UTyAiLlBGWC4iYXJjX3R3aXR0ZXIgKGFydGljbGVfaWQs
dHdlZXRfaWQsdHdlZXQsdGlueXVybCkgIjsKICAgICAgICAgICAgICAgICRzcWwuPSAiVkFM
VUVTKCRhcnRpY2xlX2lkLCR0d2VldF9pZCxcIiR0d2VldFwiLCckc2hvcnRfdXJsJyk7IjsK
ICAgICAgICAgICAgICAgIHNhZmVfcXVlcnkoJHNxbCk7CgogICAgICAgICAgICAgICAgcmV0
dXJuIHRydWU7CgogICAgICAgICAgICB9IGVsc2UgewoKICAgICAgICAgICAgICAgICRhcmNf
dHdpdHRlclsnZXJyb3InXSA9ICdUd2l0dGVyIHJlc3BvbnNlOiAnCiAgICAgICAgICAgICAg
ICAgICAgLiR0d2l0LT5odHRwX2NvZGU7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7
CgogICAgICAgICAgICB9CgogICAgICAgIH0KCiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwoK
fQoKLyoKICogU2hvcnRlbiBVUkxzIHVzaW5nIHZhcmlvdXMgbWV0aG9kcwogKi8KCmZ1bmN0
aW9uIGFyY19zaG9ydGVuX3VybCgkdXJsLCAkbWV0aG9kPScnLCAkYXR0cz1hcnJheSgpKQp7
CiAgZ2xvYmFsICRwcmVmczsKCiAgJGNoID0gY3VybF9pbml0KCk7CiAgY3VybF9zZXRvcHQo
JGNoLCBDVVJMT1BUX0hFQURFUiwgMCk7CiAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1JF
VFVSTlRSQU5TRkVSLCB0cnVlKTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVElNRU9V
VCwgMTApOwoKICBzd2l0Y2ggKCRtZXRob2QpIHsKICAgIGNhc2UgJ3NtZCc6IC8vIGNyZWF0
ZSBhIHNob3J0ZW5lZCBVUkwgdXNpbmcgU01EIFNob3J0IFVSTAogICAgICByZXR1cm4gKCRh
dHRzWydpZCddKSA/IGh1LiRhdHRzWydpZCddIDogZmFsc2U7IGJyZWFrOwogICAgY2FzZSAn
YXJjX3R3aXR0ZXInOiAvLyBuYXRpdmUgVVJMIHNob3J0ZW5pbmcKCiAgICAgIHJldHVybiAo
JGF0dHNbJ2lkJ10pID8gJHByZWZzWydhcmNfc2hvcnRfc2l0ZV91cmwnXS4kYXR0c1snaWQn
XSA6IGZhbHNlOwogICAgICBicmVhazsKCiAgICBjYXNlICdpc2dkJzoKCiAgICAgICR1ID0g
J2h0dHA6Ly9pcy5nZC9hcGkucGhwP2xvbmd1cmw9Jy51cmxlbmNvZGUoJHVybCk7CiAgICAg
IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VUkwsICR1KTsKCiAgICAgICR0aW55dXJsID0g
Y3VybF9leGVjKCRjaCk7CiAgICAgIGlmICgkdGlueXVybCE9J0Vycm9yJyAmJiAkdGlueXVy
bCE9JycpIHsKICAgICAgICByZXR1cm4gJHRpbnl1cmw7CiAgICAgIH0gZWxzZSB7CiAgICAg
ICAgdHJpZ2dlcl9lcnJvcignYXJjX3R3aXR0ZXIgZmFpbGVkIHRvIGdldCBhIGlzLmdkIFVS
TCBmb3IgJwogICAgICAgICAgICAuJHVybCxFX1VTRVJfV0FSTklORyk7CiAgICAgIH0KICAg
ICAgYnJlYWs7CgogICAgY2FzZSAndGlueXVybCc6IGRlZmF1bHQ6IC8vIGNyZWF0ZSBhIHNo
b3J0ZW5lZCBVUkwgdXNpbmcgVGlueVVSTAoKICAgICAgJHUgPSAnaHR0cDovL3Rpbnl1cmwu
Y29tL2FwaS1jcmVhdGUucGhwP3VybD0nLnVybGVuY29kZSgkdXJsKTsKICAgICAgY3VybF9z
ZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwgJHUpOwogICAgICAkdGlueXVybCA9IGN1cmxfZXhl
YygkY2gpOwogICAgICBpZiAoJHRpbnl1cmwhPSdFcnJvcicgJiYgJHRpbnl1cmwhPScnKSB7
CiAgICAgICAgcmV0dXJuICR0aW55dXJsOwogICAgICB9IGVsc2UgewogICAgICAgIHRyaWdn
ZXJfZXJyb3IoJ2FyY190d2l0dGVyIGZhaWxlZCB0byBnZXQgYSBUaW55VVJMIGZvciAnLiR1
cmwsRV9VU0VSX1dBUk5JTkcpOwogICAgICB9CgogIH0KCiAgcmV0dXJuIGZhbHNlOyAvLyBm
YWlsCgp9CgovKgogKiBTaG9ydGVuZWQgVVJMIHJlZGlyZWN0IGJhc2VkIG9uIHNtZF9zaG9y
dF91cmwKICovCmZ1bmN0aW9uIGFyY19zaG9ydF91cmxfcmVkaXJlY3QoJGV2ZW50LCAkc3Rl
cCkgewogIGdsb2JhbCAkcHJlZnM7CgogIC8vIE9ubHkgdXNlIHJlZGlyZWN0IGlmIGVuYWJs
ZWQKICBpZiAoJHByZWZzWydhcmNfc2hvcnRfdXJsJ10pIHsKCiAgICAkaGF2ZV9pZCA9IDA7
CgogICAgLy8gQ2hlY2sgaWYgdGhlcmUgaXMgYW4gYXZhaWxhYmxlIHNob3J0IHNpdGUgdXJs
IGFuZCBpZiBpdCBpcyBiZWluZyB1c2VkIGluCiAgICAvLyB0aGlzIGluc3RhbmNlCiAgICAk
c2hvcnRfc2l0ZV91cmwgPSAkcHJlZnNbJ2FyY19zaG9ydF9zaXRlX3VybCddOwogICAgaWYg
KCRzaG9ydF9zaXRlX3VybCkgewogICAgICAkdXJsX3BhcnRzID0gcGFyc2VfdXJsKCRzaG9y
dF9zaXRlX3VybCk7CiAgICAgICRyZSA9ICcjXicuJHVybF9wYXJ0c1sncGF0aCddLicoWzAt
OV0uKikjJzsKICAgICAgJGhhdmVfaWQgPSBwcmVnX21hdGNoKCRyZSwgJF9TRVJWRVJbJ1JF
UVVFU1RfVVJJJ10sICRtKTsKICAgIH0KCiAgICAvLyBGYWxsIGJhY2sgdG8gc3RhbmRhcmQg
c2l0ZSB1cmwgKHNtZF9zaG9ydF91cmwgYmVoYXZpb3VyKQogICAgaWYgKCRoYXZlX2lkKSB7
CiAgICAgICR1cmxfcGFydHMgPSBwYXJzZV91cmwoaHUpOwogICAgICAkcmUgPSAnI14nLiR1
cmxfcGFydHNbJ3BhdGgnXS4nKFswLTldLiopIyc7CiAgICAgICRoYXZlX2lkID0gcHJlZ19t
YXRjaCgkcmUsICRfU0VSVkVSWydSRVFVRVNUX1VSSSddLCAkbSk7CiAgICB9CgogICAgLy8g
RG8gdGhlIHJlZGlyZWN0IGlmIHdlJ3ZlIGdvdCBhbiBhcnRpY2xlIGlkCgkgIGlmICgkaGF2
ZV9pZCkgewoJCSAgJGlkID0gJG1bMV07CgkJICAkcGVybWxpbmsgPSBwZXJtbGlua3VybF9p
ZCgkaWQpOwoKCQkgIGlmICgkcGVybWxpbmspIHsKCQkJICBvYl9lbmRfY2xlYW4oKTsKCgkJ
CSAgLy8gU3R1cGlkLCBvdmVyIHRoZSB0b3AgaGVhZGVyIHNldHRpbmcgZm9yIElFCgkJCSAg
aGVhZGVyKCJTdGF0dXM6IDMwMSIpOwoJCQkgIGhlYWRlcigiSFRUUC8xLjAgMzAxIE1vdmVk
IFBlcm1hbmVudGx5Iik7CgkJCSAgaGVhZGVyKCJMb2NhdGlvbjogIi4kcGVybWxpbmssIFRS
VUUsIDMwMSk7CgoJCQkgIC8vIEluIGNhc2UgdGhlIGhlYWRlcigpIG1ldGhvZCBmYWlscywg
ZmFsbCBiYWNrIG9uIGEgY2xhc3NpYyByZWRpcmVjdAoJCQkgIGVjaG8gJzxodG1sPjxoZWFk
PjxNRVRBIEhUVFAtRVFVSVY9IlJlZnJlc2giIENPTlRFTlQ9IjA7VVJMPScKCQkJICAgIC4k
cGVybWxpbmsuJyI+PC9oZWFkPjxib2R5PjwvYm9keT48L2h0bWw+JzsKCQkJICBkaWUoKTsK
CQkgIH0KCSAgfQoKICB9Cgp9CgovKgogKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgoqLwoK
Y2xhc3MgYXJjX3R3aXR0ZXIgZXh0ZW5kcyBUd2l0dGVyT0F1dGggewogICAgLy8gQ2FjaGlu
ZyB2YXJpYWJsZXMKICAgIHByaXZhdGUgJF9jYWNoZSA9IHRydWU7CiAgICBwcml2YXRlICRf
Y2FjaGVfZGlyID0gJy4vdG1wJzsKICAgIHByaXZhdGUgJF9jYWNoZV90aW1lID0gMTgwMDsg
Ly8gMzAgbWludXRlIGNhY2hlCgogICAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGNvbnN1bWVy
X2tleSwgJGNvbnN1bWVyX3NlY3JldCwgJG9hdXRoX3Rva2VuID0gTlVMTAogICAgICAgICwg
JG9hdXRoX3Rva2VuX3NlY3JldCA9IE5VTEwpCiAgICB7CiAgICAgICAgcGFyZW50OjpfX2Nv
bnN0cnVjdCgkY29uc3VtZXJfa2V5LCAkY29uc3VtZXJfc2VjcmV0LCAkb2F1dGhfdG9rZW4K
ICAgICAgICAgICAgLCAkb2F1dGhfdG9rZW5fc2VjcmV0KTsKICAgICAgICAkdGhpcy0+Zm9y
bWF0ID0gJ3htbCc7CiAgICAgICAgJHRoaXMtPnRpbWVvdXQgPSAxNTsKICAgICAgICAkdGhp
cy0+Y29ubmVjdHRpbWVvdXQgPSAxNTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gY2Fs
bGJhY2tVUkwoJGV2ZW50LCRzdGVwKQogICAgewogICAgICAgIHJldHVybiBodS4ndGV4dHBh
dHRlcm4vaW5kZXgucGhwP2V2ZW50PScuJGV2ZW50LicmYW1wO3N0ZXA9Jy4kc3RlcDsKICAg
IH0KCiAgICAvLyBjcmVhdGUgVHdpdHRlciBhbmQgZXh0ZXJuYWwgbGlua3MgaW4gdGV4dAog
ICAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBtYWtlTGlua3MoJHRleHQpCiAgICB7CiAgICAg
ICAgJHVybCA9ICcvXGIoaHR0cHxodHRwc3xmdHApOlwvXC8oW0EtWjAtOV1bQS1aMC05Xy1d
Kig/OlwuW0EtWjAtOV1bQS1aMC05Xy1dKikrKTo/KFxkKyk/XC8/KFtcL1x3K1wuXSspXGIv
aSc7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2UoJHVybCwgIjxhIGhyZWY9JyQwJz4k
MDwvYT4iLCAkdGV4dCk7CiAgICAgICAgJHVybCA9ICcvXGIoXnxccyl3d3cuKFthLXpfQS1a
MC05XSspKChcLlthLXpdKykrKVxiL2knOwogICAgICAgICR0ZXh0ID0gcHJlZ19yZXBsYWNl
KCR1cmwsICI8YSBocmVmPSdodHRwOi8vd3d3LiQyJDMnPnd3dy4kMiQzPC9hPiIsICR0ZXh0
KTsKICAgICAgICAkdGV4dCA9IHByZWdfcmVwbGFjZSgiLyhefFxzKUAoW2Etel9BLVowLTld
KykvIiwKICAgICAgICAgICAgIiQxQDxhIGhyZWY9J2h0dHA6Ly90d2l0dGVyLmNvbS8kMic+
JDI8L2E+IiwkdGV4dCk7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2UoIi8oXnxccyko
XCMoW2Etel9BLVowLTk6Xy1dKykpLyIsCiAgICAgICAgICAgICIkMTxhIGhyZWY9J2h0dHA6
Ly90d2l0dGVyLmNvbS9zZWFyY2g/cT0lMjMkMyc+JDI8L2E+IiwkdGV4dCk7CiAgICAgICAg
cmV0dXJuICR0ZXh0OwogIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gZ2V0KCR1cmwsICRwYXJh
bXMgPSBhcnJheSgpKQogICAgewogICAgICAgICRhcGlfdXJsID0gbWQ1KCR1cmwudXJsZW5j
b2RlKHNlcmlhbGl6ZSgkcGFyYW1zKSkpOwogICAgICAgICRkYXRhID0gJyc7CgogICAgICAg
IGlmICgkdGhpcy0+X2NhY2hlKSB7IC8vIGNoZWNrIGZvciBjYWNoZWQgeG1sCgogICAgICAg
ICAgICAkZGF0YSA9ICR0aGlzLT5fcmV0cmlldmVDYWNoZSgkYXBpX3VybCk7CgogICAgICAg
IH0KICAgICAgICBpZiAoZW1wdHkoJGRhdGEpKSB7CiAgICAgICAgICAgICRkYXRhID0gcGFy
ZW50OjpnZXQoJHVybCwgJHBhcmFtcyk7CiAgICAgICAgICAgIGlmICgkdGhpcy0+aHR0cF9j
b2RlPT09MjAwICYmICR4bWw9c2ltcGxleG1sX2xvYWRfc3RyaW5nKCRkYXRhKSkgeyAvLyBz
YXZlIGNhY2hlCiAgICAgICAgICAgICAgICAkZmlsZSA9ICR0aGlzLT5fY2FjaGVfZGlyLicv
Jy4kYXBpX3VybDsKICAgICAgICAgICAgICAgIGZpbGVfcHV0X2NvbnRlbnRzKCRmaWxlLCRk
YXRhLExPQ0tfRVgpOwogICAgICAgICAgICAgICAgcmV0dXJuICR4bWw7CiAgICAgICAgICAg
IH0gZWxzZSB7IC8vIGZhaWxlZCB0byByZXRyaWV2ZSBkYXRhIGZyb20gVHdpdHRlcgoKICAg
ICAgICAgICAgICAgIGlmICgkdGhpcy0+X2NhY2hlKSB7IC8vIGF0dGVtcHQgdG8gZm9yY2Ug
Y2FjaGVkIHhtbCByZXR1cm4KCiAgICAgICAgICAgICAgICAgICAgJGRhdGEgPSAkdGhpcy0+
X3JldHJpZXZlQ2FjaGUoJGFwaV91cmwsdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgaWYg
KCRkYXRhKSByZXR1cm4gQHNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSk7CgogICAgICAg
ICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgICAg
IH0KICAgICAgICB9IGVsc2UgeyAvLyByZXR1cm4gY2FjaGVkIHhtbAogICAgICAgICAgICBy
ZXR1cm4gQHNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSk7CiAgICAgICAgfQogICAgfSAv
L2VuZCBnZXQoKQoKICAgIGZ1bmN0aW9uIHBvc3QoJHVybCwgJHBhcmFtcyA9IGFycmF5KCkp
CiAgICB7CiAgICAgICAgJGRhdGEgPSBwYXJlbnQ6OnBvc3QoJHVybCwkcGFyYW1zKTsKICAg
ICAgICByZXR1cm4gc2ltcGxleG1sX2xvYWRfc3RyaW5nKCRkYXRhKTsKICAgIH0KCiAgICBm
dW5jdGlvbiBkZWxldGUoJHVybCwgJHBhcmFtcyA9IGFycmF5KCkpCiAgICB7CiAgICAgICAg
JGRhdGEgPSBwYXJlbnQ6OmRlbGV0ZSgkdXJsLCRwYXJhbXMpOwogICAgICAgIHJldHVybiBz
aW1wbGV4bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwogICAgfQoKICAgIC8vIENhY2hlIG1ldGhv
ZHMKCiAgICBwdWJsaWMgZnVuY3Rpb24gc2V0Q2FjaGluZygkY2FjaGU9dHJ1ZSkKICAgIHsK
ICAgICAgICAkdGhpcy0+X2NhY2hlID0gKCRjYWNoZSkgPyB0cnVlIDogZmFsc2U7CiAgICAg
ICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGNhY2hlRGlyKCRs
b2MpCiAgICB7CiAgICAgICAgJHRoaXMtPl9jYWNoZV9kaXIgPSAkbG9jOwogICAgICAgIHJl
dHVybiB0cnVlOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjYWNoZVRpbWUoJG1pbnMp
CiAgICB7CiAgICAgICAgJHRoaXMtPl9jYWNoZV90aW1lID0gJG1pbnMqNjA7IC8vIGNvbnZl
cnQgbWludXRlcyBpbnRvIHNlY29uZHMKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAg
ICBwcml2YXRlIGZ1bmN0aW9uIF9yZXRyaWV2ZUNhY2hlKCR1cmwsJG92ZXJpZGVfdGltZW91
dD1mYWxzZSkKICAgIHsKICAgICAgICAkZmlsZSA9ICR0aGlzLT5fY2FjaGVfZGlyLicvJy4k
dXJsOwogICAgICAgIGlmIChmaWxlX2V4aXN0cygkZmlsZSkpIHsKCiAgICAgICAgICAgICRk
aWZmID0gdGltZSgpIC0gZmlsZW10aW1lKCRmaWxlKTsKICAgICAgICAgICAgaWYgKCRvdmVy
aWRlX3RpbWVvdXQgfHwgJGRpZmYgPCAkdGhpcy0+X2NhY2hlX3RpbWUpIHsKICAgICAgICAg
ICAgICAgIHJldHVybiBmaWxlX2dldF9jb250ZW50cygkZmlsZSk7CiAgICAgICAgICAgIH0g
ZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KCiAg
ICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAg
IH0KfQoKLyoKICogQWJyYWhhbSBXaWxsaWFtcyAoYWJyYWhhbUBhYnJhaC5hbSkgaHR0cDov
L2FicmFoLmFtCiAqCiAqIFRoZSBmaXJzdCBQSFAgTGlicmFyeSB0byBzdXBwb3J0IE9BdXRo
IGZvciBUd2l0dGVyJ3MgUkVTVCBBUEkuCiAqLwoKLyoqCiAqIFR3aXR0ZXIgT0F1dGggY2xh
c3MKICovCmNsYXNzIFR3aXR0ZXJPQXV0aCB7CiAgLyogQ29udGFpbnMgdGhlIGxhc3QgSFRU
UCBzdGF0dXMgY29kZSByZXR1cm5lZC4gKi8KICBwdWJsaWMgJGh0dHBfY29kZTsKICAvKiBD
b250YWlucyB0aGUgbGFzdCBBUEkgY2FsbC4gKi8KICBwdWJsaWMgJHVybDsKICAvKiBTZXQg
dXAgdGhlIEFQSSByb290IFVSTC4gKi8KICBwdWJsaWMgJGhvc3QgPSAiaHR0cHM6Ly9hcGku
dHdpdHRlci5jb20vMS8iOwogIC8qIFNldCB0aW1lb3V0IGRlZmF1bHQuICovCiAgcHVibGlj
ICR0aW1lb3V0ID0gMzA7CiAgLyogU2V0IGNvbm5lY3QgdGltZW91dC4gKi8KICBwdWJsaWMg
JGNvbm5lY3R0aW1lb3V0ID0gMzA7CiAgLyogVmVyaWZ5IFNTTCBDZXJ0LiAqLwogIHB1Ymxp
YyAkc3NsX3ZlcmlmeXBlZXIgPSBGQUxTRTsKICAvKiBSZXNwb25zIGZvcm1hdC4gKi8KICBw
dWJsaWMgJGZvcm1hdCA9ICdqc29uJzsKICAvKiBEZWNvZGUgcmV0dXJuZWQganNvbiBkYXRh
LiAqLwogIHB1YmxpYyAkZGVjb2RlX2pzb24gPSBUUlVFOwogIC8qIENvbnRhaW5zIHRoZSBs
YXN0IEhUVFAgaGVhZGVycyByZXR1cm5lZC4gKi8KICBwdWJsaWMgJGh0dHBfaW5mbzsKICAv
KiBTZXQgdGhlIHVzZXJhZ25ldC4gKi8KICBwdWJsaWMgJHVzZXJhZ2VudCA9ICdUd2l0dGVy
T0F1dGggdjAuMi4wLWJldGEyJzsKICAvKiBJbW1lZGlhdGVseSByZXRyeSB0aGUgQVBJIGNh
bGwgaWYgdGhlIHJlc3BvbnNlIHdhcyBub3Qgc3VjY2Vzc2Z1bC4gKi8KICAvL3B1YmxpYyAk
cmV0cnkgPSBUUlVFOwoKCgoKICAvKioKICAgKiBTZXQgQVBJIFVSTFMKICAgKi8KICBmdW5j
dGlvbiBhY2Nlc3NUb2tlblVSTCgpICB7IHJldHVybiAnaHR0cHM6Ly9hcGkudHdpdHRlci5j
b20vb2F1dGgvYWNjZXNzX3Rva2VuJzsgfQogIGZ1bmN0aW9uIGF1dGhlbnRpY2F0ZVVSTCgp
IHsgcmV0dXJuICdodHRwczovL3R3aXR0ZXIuY29tL29hdXRoL2F1dGhlbnRpY2F0ZSc7IH0K
ICBmdW5jdGlvbiBhdXRob3JpemVVUkwoKSAgICB7IHJldHVybiAnaHR0cHM6Ly90d2l0dGVy
LmNvbS9vYXV0aC9hdXRob3JpemUnOyB9CiAgZnVuY3Rpb24gcmVxdWVzdFRva2VuVVJMKCkg
eyByZXR1cm4gJ2h0dHBzOi8vYXBpLnR3aXR0ZXIuY29tL29hdXRoL3JlcXVlc3RfdG9rZW4n
OyB9CgogIC8qKgogICAqIERlYnVnIGhlbHBlcnMKICAgKi8KICBmdW5jdGlvbiBsYXN0U3Rh
dHVzQ29kZSgpIHsgcmV0dXJuICR0aGlzLT5odHRwX3N0YXR1czsgfQogIGZ1bmN0aW9uIGxh
c3RBUElDYWxsKCkgeyByZXR1cm4gJHRoaXMtPmxhc3RfYXBpX2NhbGw7IH0KCiAgLyoqCiAg
ICogY29uc3RydWN0IFR3aXR0ZXJPQXV0aCBvYmplY3QKICAgKi8KICBmdW5jdGlvbiBfX2Nv
bnN0cnVjdCgkY29uc3VtZXJfa2V5LCAkY29uc3VtZXJfc2VjcmV0LCAkb2F1dGhfdG9rZW4g
PSBOVUxMLCAkb2F1dGhfdG9rZW5fc2VjcmV0ID0gTlVMTCkgewogICAgJHRoaXMtPnNoYTFf
bWV0aG9kID0gbmV3IE9BdXRoU2lnbmF0dXJlTWV0aG9kX0hNQUNfU0hBMSgpOwogICAgJHRo
aXMtPmNvbnN1bWVyID0gbmV3IE9BdXRoQ29uc3VtZXIoJGNvbnN1bWVyX2tleSwgJGNvbnN1
bWVyX3NlY3JldCk7CiAgICBpZiAoIWVtcHR5KCRvYXV0aF90b2tlbikgJiYgIWVtcHR5KCRv
YXV0aF90b2tlbl9zZWNyZXQpKSB7CiAgICAgICR0aGlzLT50b2tlbiA9IG5ldyBPQXV0aENv
bnN1bWVyKCRvYXV0aF90b2tlbiwgJG9hdXRoX3Rva2VuX3NlY3JldCk7CiAgICB9IGVsc2Ug
ewogICAgICAkdGhpcy0+dG9rZW4gPSBOVUxMOwogICAgfQogIH0KCgogIC8qKgogICAqIEdl
dCBhIHJlcXVlc3RfdG9rZW4gZnJvbSBUd2l0dGVyCiAgICoKICAgKiBAcmV0dXJucyBhIGtl
eS92YWx1ZSBhcnJheSBjb250YWluaW5nIG9hdXRoX3Rva2VuIGFuZCBvYXV0aF90b2tlbl9z
ZWNyZXQKICAgKi8KICBmdW5jdGlvbiBnZXRSZXF1ZXN0VG9rZW4oJG9hdXRoX2NhbGxiYWNr
ID0gTlVMTCkgewogICAgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgaWYgKCFlbXB0eSgk
b2F1dGhfY2FsbGJhY2spKSB7CiAgICAgICRwYXJhbWV0ZXJzWydvYXV0aF9jYWxsYmFjaydd
ID0gJG9hdXRoX2NhbGxiYWNrOwogICAgfQogICAgJHJlcXVlc3QgPSAkdGhpcy0+b0F1dGhS
ZXF1ZXN0KCR0aGlzLT5yZXF1ZXN0VG9rZW5VUkwoKSwgJ0dFVCcsICRwYXJhbWV0ZXJzKTsK
ICAgICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygkcmVxdWVzdCk7CiAg
ICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigkdG9rZW5bJ29hdXRoX3Rva2Vu
J10sICR0b2tlblsnb2F1dGhfdG9rZW5fc2VjcmV0J10pOwogICAgcmV0dXJuICR0b2tlbjsK
ICB9CgogIC8qKgogICAqIEdldCB0aGUgYXV0aG9yaXplIFVSTAogICAqCiAgICogQHJldHVy
bnMgYSBzdHJpbmcKICAgKi8KICBmdW5jdGlvbiBnZXRBdXRob3JpemVVUkwoJHRva2VuLCAk
c2lnbl9pbl93aXRoX3R3aXR0ZXIgPSBUUlVFKSB7CiAgICBpZiAoaXNfYXJyYXkoJHRva2Vu
KSkgewogICAgICAkdG9rZW4gPSAkdG9rZW5bJ29hdXRoX3Rva2VuJ107CiAgICB9CiAgICBp
ZiAoZW1wdHkoJHNpZ25faW5fd2l0aF90d2l0dGVyKSkgewogICAgICByZXR1cm4gJHRoaXMt
PmF1dGhvcml6ZVVSTCgpIC4gIj9vYXV0aF90b2tlbj17JHRva2VufSI7CiAgICB9IGVsc2Ug
ewogICAgICAgcmV0dXJuICR0aGlzLT5hdXRoZW50aWNhdGVVUkwoKSAuICI/b2F1dGhfdG9r
ZW49eyR0b2tlbn0iOwogICAgfQogIH0KCiAgLyoqCiAgICogRXhjaGFuZ2UgcmVxdWVzdCB0
b2tlbiBhbmQgc2VjcmV0IGZvciBhbiBhY2Nlc3MgdG9rZW4gYW5kCiAgICogc2VjcmV0LCB0
byBzaWduIEFQSSBjYWxscy4KICAgKgogICAqIEByZXR1cm5zIGFycmF5KCJvYXV0aF90b2tl
biIgPT4gInRoZS1hY2Nlc3MtdG9rZW4iLAogICAqICAgICAgICAgICAgICAgICJvYXV0aF90
b2tlbl9zZWNyZXQiID0+ICJ0aGUtYWNjZXNzLXNlY3JldCIsCiAgICogICAgICAgICAgICAg
ICAgInVzZXJfaWQiID0+ICI5NDM2OTkyIiwKICAgKiAgICAgICAgICAgICAgICAic2NyZWVu
X25hbWUiID0+ICJhYnJhaGFtIikKICAgKi8KICBmdW5jdGlvbiBnZXRBY2Nlc3NUb2tlbigk
b2F1dGhfdmVyaWZpZXIgPSBGQUxTRSkgewogICAgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwog
ICAgaWYgKCFlbXB0eSgkb2F1dGhfdmVyaWZpZXIpKSB7CiAgICAgICRwYXJhbWV0ZXJzWydv
YXV0aF92ZXJpZmllciddID0gJG9hdXRoX3ZlcmlmaWVyOwogICAgfQogICAgJHJlcXVlc3Qg
PSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR0aGlzLT5hY2Nlc3NUb2tlblVSTCgpLCAnR0VUJywg
JHBhcmFtZXRlcnMpOwogICAgJHRva2VuID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJz
KCRyZXF1ZXN0KTsKICAgICR0aGlzLT50b2tlbiA9IG5ldyBPQXV0aENvbnN1bWVyKCR0b2tl
blsnb2F1dGhfdG9rZW4nXSwgJHRva2VuWydvYXV0aF90b2tlbl9zZWNyZXQnXSk7CiAgICBy
ZXR1cm4gJHRva2VuOwogIH0KCiAgLyoqCiAgICogT25lIHRpbWUgZXhjaGFuZ2Ugb2YgdXNl
cm5hbWUgYW5kIHBhc3N3b3JkIGZvciBhY2Nlc3MgdG9rZW4gYW5kIHNlY3JldC4KICAgKgog
ICAqIEByZXR1cm5zIGFycmF5KCJvYXV0aF90b2tlbiIgPT4gInRoZS1hY2Nlc3MtdG9rZW4i
LAogICAqICAgICAgICAgICAgICAgICJvYXV0aF90b2tlbl9zZWNyZXQiID0+ICJ0aGUtYWNj
ZXNzLXNlY3JldCIsCiAgICogICAgICAgICAgICAgICAgInVzZXJfaWQiID0+ICI5NDM2OTky
IiwKICAgKiAgICAgICAgICAgICAgICAic2NyZWVuX25hbWUiID0+ICJhYnJhaGFtIiwKICAg
KiAgICAgICAgICAgICAgICAieF9hdXRoX2V4cGlyZXMiID0+ICIwIikKICAgKi8KICBmdW5j
dGlvbiBnZXRYQXV0aFRva2VuKCR1c2VybmFtZSwgJHBhc3N3b3JkKSB7CiAgICAkcGFyYW1l
dGVycyA9IGFycmF5KCk7CiAgICAkcGFyYW1ldGVyc1sneF9hdXRoX3VzZXJuYW1lJ10gPSAk
dXNlcm5hbWU7CiAgICAkcGFyYW1ldGVyc1sneF9hdXRoX3Bhc3N3b3JkJ10gPSAkcGFzc3dv
cmQ7CiAgICAkcGFyYW1ldGVyc1sneF9hdXRoX21vZGUnXSA9ICdjbGllbnRfYXV0aCc7CiAg
ICAkcmVxdWVzdCA9ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHRoaXMtPmFjY2Vzc1Rva2VuVVJM
KCksICdQT1NUJywgJHBhcmFtZXRlcnMpOwogICAgJHRva2VuID0gT0F1dGhVdGlsOjpwYXJz
ZV9wYXJhbWV0ZXJzKCRyZXF1ZXN0KTsKICAgICR0aGlzLT50b2tlbiA9IG5ldyBPQXV0aENv
bnN1bWVyKCR0b2tlblsnb2F1dGhfdG9rZW4nXSwgJHRva2VuWydvYXV0aF90b2tlbl9zZWNy
ZXQnXSk7CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAgLyoqCiAgICogR0VUIHdyYXBwZXIg
Zm9yIG9BdXRoUmVxdWVzdC4KICAgKi8KICBmdW5jdGlvbiBnZXQoJHVybCwgJHBhcmFtZXRl
cnMgPSBhcnJheSgpKSB7CiAgICAkcmVzcG9uc2UgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR1
cmwsICdHRVQnLCAkcGFyYW1ldGVycyk7CiAgICBpZiAoJHRoaXMtPmZvcm1hdCA9PT0gJ2pz
b24nICYmICR0aGlzLT5kZWNvZGVfanNvbikgewogICAgICByZXR1cm4ganNvbl9kZWNvZGUo
JHJlc3BvbnNlKTsKICAgIH0KICAgIHJldHVybiAkcmVzcG9uc2U7CiAgfQoKICAvKioKICAg
KiBQT1NUIHdyYXBwZXIgZm9yIG9BdXRoUmVxdWVzdC4KICAgKi8KICBmdW5jdGlvbiBwb3N0
KCR1cmwsICRwYXJhbWV0ZXJzID0gYXJyYXkoKSkgewogICAgJHJlc3BvbnNlID0gJHRoaXMt
Pm9BdXRoUmVxdWVzdCgkdXJsLCAnUE9TVCcsICRwYXJhbWV0ZXJzKTsKICAgIGlmICgkdGhp
cy0+Zm9ybWF0ID09PSAnanNvbicgJiYgJHRoaXMtPmRlY29kZV9qc29uKSB7CiAgICAgIHJl
dHVybiBqc29uX2RlY29kZSgkcmVzcG9uc2UpOwogICAgfQogICAgcmV0dXJuICRyZXNwb25z
ZTsKICB9CgogIC8qKgogICAqIERFTEVURSB3cmFwcGVyIGZvciBvQXV0aFJlcWV1c3QuCiAg
ICovCiAgZnVuY3Rpb24gZGVsZXRlKCR1cmwsICRwYXJhbWV0ZXJzID0gYXJyYXkoKSkgewog
ICAgJHJlc3BvbnNlID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdXJsLCAnREVMRVRFJywgJHBh
cmFtZXRlcnMpOwogICAgaWYgKCR0aGlzLT5mb3JtYXQgPT09ICdqc29uJyAmJiAkdGhpcy0+
ZGVjb2RlX2pzb24pIHsKICAgICAgcmV0dXJuIGpzb25fZGVjb2RlKCRyZXNwb25zZSk7CiAg
ICB9CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoqCiAgICogRm9ybWF0IGFuZCBz
aWduIGFuIE9BdXRoIC8gQVBJIHJlcXVlc3QKICAgKi8KICBmdW5jdGlvbiBvQXV0aFJlcXVl
c3QoJHVybCwgJG1ldGhvZCwgJHBhcmFtZXRlcnMpIHsKICAgIGlmIChzdHJycG9zKCR1cmws
ICdodHRwczovLycpICE9PSAwICYmIHN0cnJwb3MoJHVybCwgJ2h0dHA6Ly8nKSAhPT0gMCkg
ewogICAgICAkdXJsID0gInskdGhpcy0+aG9zdH17JHVybH0ueyR0aGlzLT5mb3JtYXR9IjsK
ICAgIH0KICAgICRyZXF1ZXN0ID0gT0F1dGhSZXF1ZXN0Ojpmcm9tX2NvbnN1bWVyX2FuZF90
b2tlbigkdGhpcy0+Y29uc3VtZXIsICR0aGlzLT50b2tlbiwgJG1ldGhvZCwgJHVybCwgJHBh
cmFtZXRlcnMpOwogICAgJHJlcXVlc3QtPnNpZ25fcmVxdWVzdCgkdGhpcy0+c2hhMV9tZXRo
b2QsICR0aGlzLT5jb25zdW1lciwgJHRoaXMtPnRva2VuKTsKICAgIHN3aXRjaCAoJG1ldGhv
ZCkgewogICAgY2FzZSAnR0VUJzoKICAgICAgcmV0dXJuICR0aGlzLT5odHRwKCRyZXF1ZXN0
LT50b191cmwoKSwgJ0dFVCcpOwogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuICR0aGlzLT5o
dHRwKCRyZXF1ZXN0LT5nZXRfbm9ybWFsaXplZF9odHRwX3VybCgpLCAkbWV0aG9kLCAkcmVx
dWVzdC0+dG9fcG9zdGRhdGEoKSk7CiAgICB9CiAgfQoKICAvKioKICAgKiBNYWtlIGFuIEhU
VFAgcmVxdWVzdAogICAqCiAgICogQHJldHVybiBBUEkgcmVzdWx0cwogICAqLwogIGZ1bmN0
aW9uIGh0dHAoJHVybCwgJG1ldGhvZCwgJHBvc3RmaWVsZHMgPSBOVUxMKSB7CiAgICAkdGhp
cy0+aHR0cF9pbmZvID0gYXJyYXkoKTsKICAgICRjaSA9IGN1cmxfaW5pdCgpOwogICAgLyog
Q3VybCBzZXR0aW5ncyAqLwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1VTRVJBR0VO
VCwgJHRoaXMtPnVzZXJhZ2VudCk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfQ09O
TkVDVFRJTUVPVVQsICR0aGlzLT5jb25uZWN0dGltZW91dCk7CiAgICBjdXJsX3NldG9wdCgk
Y2ksIENVUkxPUFRfVElNRU9VVCwgJHRoaXMtPnRpbWVvdXQpOwogICAgY3VybF9zZXRvcHQo
JGNpLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCBUUlVFKTsKICAgIGN1cmxfc2V0b3B0KCRj
aSwgQ1VSTE9QVF9IVFRQSEVBREVSLCBhcnJheSgnRXhwZWN0OicpKTsKICAgIGN1cmxfc2V0
b3B0KCRjaSwgQ1VSTE9QVF9TU0xfVkVSSUZZUEVFUiwgJHRoaXMtPnNzbF92ZXJpZnlwZWVy
KTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9IRUFERVJGVU5DVElPTiwgYXJyYXko
JHRoaXMsICdnZXRIZWFkZXInKSk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfSEVB
REVSLCBGQUxTRSk7CgogICAgc3dpdGNoICgkbWV0aG9kKSB7CiAgICAgIGNhc2UgJ1BPU1Qn
OgogICAgICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9QT1NULCBUUlVFKTsKICAgICAg
ICBpZiAoIWVtcHR5KCRwb3N0ZmllbGRzKSkgewogICAgICAgICAgY3VybF9zZXRvcHQoJGNp
LCBDVVJMT1BUX1BPU1RGSUVMRFMsICRwb3N0ZmllbGRzKTsKICAgICAgICB9CiAgICAgICAg
YnJlYWs7CiAgICAgIGNhc2UgJ0RFTEVURSc6CiAgICAgICAgY3VybF9zZXRvcHQoJGNpLCBD
VVJMT1BUX0NVU1RPTVJFUVVFU1QsICdERUxFVEUnKTsKICAgICAgICBpZiAoIWVtcHR5KCRw
b3N0ZmllbGRzKSkgewogICAgICAgICAgJHVybCA9ICJ7JHVybH0/eyRwb3N0ZmllbGRzfSI7
CiAgICAgICAgfQogICAgfQoKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9VUkwsICR1
cmwpOwogICAgJHJlc3BvbnNlID0gY3VybF9leGVjKCRjaSk7CiAgICAkdGhpcy0+aHR0cF9j
b2RlID0gY3VybF9nZXRpbmZvKCRjaSwgQ1VSTElORk9fSFRUUF9DT0RFKTsKICAgICR0aGlz
LT5odHRwX2luZm8gPSBhcnJheV9tZXJnZSgkdGhpcy0+aHR0cF9pbmZvLCBjdXJsX2dldGlu
Zm8oJGNpKSk7CiAgICAkdGhpcy0+dXJsID0gJHVybDsKICAgIGN1cmxfY2xvc2UgKCRjaSk7
CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoqCiAgICogR2V0IHRoZSBoZWFkZXIg
aW5mbyB0byBzdG9yZS4KICAgKi8KICBmdW5jdGlvbiBnZXRIZWFkZXIoJGNoLCAkaGVhZGVy
KSB7CiAgICAkaSA9IHN0cnBvcygkaGVhZGVyLCAnOicpOwogICAgaWYgKCFlbXB0eSgkaSkp
IHsKICAgICAgJGtleSA9IHN0cl9yZXBsYWNlKCctJywgJ18nLCBzdHJ0b2xvd2VyKHN1YnN0
cigkaGVhZGVyLCAwLCAkaSkpKTsKICAgICAgJHZhbHVlID0gdHJpbShzdWJzdHIoJGhlYWRl
ciwgJGkgKyAyKSk7CiAgICAgICR0aGlzLT5odHRwX2hlYWRlclska2V5XSA9ICR2YWx1ZTsK
ICAgIH0KICAgIHJldHVybiBzdHJsZW4oJGhlYWRlcik7CiAgfQp9CgpjbGFzcyBPQXV0aEV4
Y2VwdGlvbiBleHRlbmRzIEV4Y2VwdGlvbiB7CiAgLy8gcGFzcwp9CgpjbGFzcyBPQXV0aENv
bnN1bWVyIHsKICBwdWJsaWMgJGtleTsKICBwdWJsaWMgJHNlY3JldDsKCiAgZnVuY3Rpb24g
X19jb25zdHJ1Y3QoJGtleSwgJHNlY3JldCwgJGNhbGxiYWNrX3VybD1OVUxMKSB7CiAgICAk
dGhpcy0+a2V5ID0gJGtleTsKICAgICR0aGlzLT5zZWNyZXQgPSAkc2VjcmV0OwogICAgJHRo
aXMtPmNhbGxiYWNrX3VybCA9ICRjYWxsYmFja191cmw7CiAgfQoKICBmdW5jdGlvbiBfX3Rv
U3RyaW5nKCkgewogICAgcmV0dXJuICJPQXV0aENvbnN1bWVyW2tleT0kdGhpcy0+a2V5LHNl
Y3JldD0kdGhpcy0+c2VjcmV0XSI7CiAgfQp9CgpjbGFzcyBPQXV0aFRva2VuIHsKICAvLyBh
Y2Nlc3MgdG9rZW5zIGFuZCByZXF1ZXN0IHRva2VucwogIHB1YmxpYyAka2V5OwogIHB1Ymxp
YyAkc2VjcmV0OwoKICAvKioKICAgKiBrZXkgPSB0aGUgdG9rZW4KICAgKiBzZWNyZXQgPSB0
aGUgdG9rZW4gc2VjcmV0CiAgICovCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGtleSwgJHNl
Y3JldCkgewogICAgJHRoaXMtPmtleSA9ICRrZXk7CiAgICAkdGhpcy0+c2VjcmV0ID0gJHNl
Y3JldDsKICB9CgogIC8qKgogICAqIGdlbmVyYXRlcyB0aGUgYmFzaWMgc3RyaW5nIHNlcmlh
bGl6YXRpb24gb2YgYSB0b2tlbiB0aGF0IGEgc2VydmVyCiAgICogd291bGQgcmVzcG9uZCB0
byByZXF1ZXN0X3Rva2VuIGFuZCBhY2Nlc3NfdG9rZW4gY2FsbHMgd2l0aAogICAqLwogIGZ1
bmN0aW9uIHRvX3N0cmluZygpIHsKICAgIHJldHVybiAib2F1dGhfdG9rZW49IiAuCiAgICAg
ICAgICAgT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkdGhpcy0+a2V5KSAuCiAgICAg
ICAgICAgIiZvYXV0aF90b2tlbl9zZWNyZXQ9IiAuCiAgICAgICAgICAgT0F1dGhVdGlsOjp1
cmxlbmNvZGVfcmZjMzk4NigkdGhpcy0+c2VjcmV0KTsKICB9CgogIGZ1bmN0aW9uIF9fdG9T
dHJpbmcoKSB7CiAgICByZXR1cm4gJHRoaXMtPnRvX3N0cmluZygpOwogIH0KfQoKLyoqCiAq
IEEgY2xhc3MgZm9yIGltcGxlbWVudGluZyBhIFNpZ25hdHVyZSBNZXRob2QKICogU2VlIHNl
Y3Rpb24gOSAoIlNpZ25pbmcgUmVxdWVzdHMiKSBpbiB0aGUgc3BlYwogKi8KYWJzdHJhY3Qg
Y2xhc3MgT0F1dGhTaWduYXR1cmVNZXRob2QgewogIC8qKgogICAqIE5lZWRzIHRvIHJldHVy
biB0aGUgbmFtZSBvZiB0aGUgU2lnbmF0dXJlIE1ldGhvZCAoaWUgSE1BQy1TSEExKQogICAq
IEByZXR1cm4gc3RyaW5nCiAgICovCiAgYWJzdHJhY3QgcHVibGljIGZ1bmN0aW9uIGdldF9u
YW1lKCk7CgogIC8qKgogICAqIEJ1aWxkIHVwIHRoZSBzaWduYXR1cmUKICAgKiBOT1RFOiBU
aGUgb3V0cHV0IG9mIHRoaXMgZnVuY3Rpb24gTVVTVCBOT1QgYmUgdXJsZW5jb2RlZC4KICAg
KiB0aGUgZW5jb2RpbmcgaXMgaGFuZGxlZCBpbiBPQXV0aFJlcXVlc3Qgd2hlbiB0aGUgZmlu
YWwKICAgKiByZXF1ZXN0IGlzIHNlcmlhbGl6ZWQKICAgKiBAcGFyYW0gT0F1dGhSZXF1ZXN0
ICRyZXF1ZXN0CiAgICogQHBhcmFtIE9BdXRoQ29uc3VtZXIgJGNvbnN1bWVyCiAgICogQHBh
cmFtIE9BdXRoVG9rZW4gJHRva2VuCiAgICogQHJldHVybiBzdHJpbmcKICAgKi8KICBhYnN0
cmFjdCBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3Vt
ZXIsICR0b2tlbik7CgogIC8qKgogICAqIFZlcmlmaWVzIHRoYXQgYSBnaXZlbiBzaWduYXR1
cmUgaXMgY29ycmVjdAogICAqIEBwYXJhbSBPQXV0aFJlcXVlc3QgJHJlcXVlc3QKICAgKiBA
cGFyYW0gT0F1dGhDb25zdW1lciAkY29uc3VtZXIKICAgKiBAcGFyYW0gT0F1dGhUb2tlbiAk
dG9rZW4KICAgKiBAcGFyYW0gc3RyaW5nICRzaWduYXR1cmUKICAgKiBAcmV0dXJuIGJvb2wK
ICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gY2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29u
c3VtZXIsICR0b2tlbiwgJHNpZ25hdHVyZSkgewogICAgJGJ1aWx0ID0gJHRoaXMtPmJ1aWxk
X3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAgcmV0dXJuICRi
dWlsdCA9PSAkc2lnbmF0dXJlOwogIH0KfQoKLyoqCiAqIFRoZSBITUFDLVNIQTEgc2lnbmF0
dXJlIG1ldGhvZCB1c2VzIHRoZSBITUFDLVNIQTEgc2lnbmF0dXJlIGFsZ29yaXRobSBhcyBk
ZWZpbmVkIGluIFtSRkMyMTA0XQogKiB3aGVyZSB0aGUgU2lnbmF0dXJlIEJhc2UgU3RyaW5n
IGlzIHRoZSB0ZXh0IGFuZCB0aGUga2V5IGlzIHRoZSBjb25jYXRlbmF0ZWQgdmFsdWVzIChl
YWNoIGZpcnN0CiAqIGVuY29kZWQgcGVyIFBhcmFtZXRlciBFbmNvZGluZykgb2YgdGhlIENv
bnN1bWVyIFNlY3JldCBhbmQgVG9rZW4gU2VjcmV0LCBzZXBhcmF0ZWQgYnkgYW4gJyYnCiAq
IGNoYXJhY3RlciAoQVNDSUkgY29kZSAzOCkgZXZlbiBpZiBlbXB0eS4KICogICAtIENoYXB0
ZXIgOS4yICgiSE1BQy1TSEExIikKICovCmNsYXNzIE9BdXRoU2lnbmF0dXJlTWV0aG9kX0hN
QUNfU0hBMSBleHRlbmRzIE9BdXRoU2lnbmF0dXJlTWV0aG9kIHsKICBmdW5jdGlvbiBnZXRf
bmFtZSgpIHsKICAgIHJldHVybiAiSE1BQy1TSEExIjsKICB9CgogIHB1YmxpYyBmdW5jdGlv
biBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAk
YmFzZV9zdHJpbmcgPSAkcmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpOwog
ICAgJHJlcXVlc3QtPmJhc2Vfc3RyaW5nID0gJGJhc2Vfc3RyaW5nOwoKICAgICRrZXlfcGFy
dHMgPSBhcnJheSgKICAgICAgJGNvbnN1bWVyLT5zZWNyZXQsCiAgICAgICgkdG9rZW4pID8g
JHRva2VuLT5zZWNyZXQgOiAiIgogICAgKTsKCiAgICAka2V5X3BhcnRzID0gT0F1dGhVdGls
Ojp1cmxlbmNvZGVfcmZjMzk4Nigka2V5X3BhcnRzKTsKICAgICRrZXkgPSBpbXBsb2RlKCcm
JywgJGtleV9wYXJ0cyk7CgogICAgcmV0dXJuIGJhc2U2NF9lbmNvZGUoaGFzaF9obWFjKCdz
aGExJywgJGJhc2Vfc3RyaW5nLCAka2V5LCB0cnVlKSk7CiAgfQp9CgovKioKICogVGhlIFBM
QUlOVEVYVCBtZXRob2QgZG9lcyBub3QgcHJvdmlkZSBhbnkgc2VjdXJpdHkgcHJvdGVjdGlv
biBhbmQgU0hPVUxEIG9ubHkgYmUgdXNlZAogKiBvdmVyIGEgc2VjdXJlIGNoYW5uZWwgc3Vj
aCBhcyBIVFRQUy4gSXQgZG9lcyBub3QgdXNlIHRoZSBTaWduYXR1cmUgQmFzZSBTdHJpbmcu
CiAqICAgLSBDaGFwdGVyIDkuNCAoIlBMQUlOVEVYVCIpCiAqLwpjbGFzcyBPQXV0aFNpZ25h
dHVyZU1ldGhvZF9QTEFJTlRFWFQgZXh0ZW5kcyBPQXV0aFNpZ25hdHVyZU1ldGhvZCB7CiAg
cHVibGljIGZ1bmN0aW9uIGdldF9uYW1lKCkgewogICAgcmV0dXJuICJQTEFJTlRFWFQiOwog
IH0KCiAgLyoqCiAgICogb2F1dGhfc2lnbmF0dXJlIGlzIHNldCB0byB0aGUgY29uY2F0ZW5h
dGVkIGVuY29kZWQgdmFsdWVzIG9mIHRoZSBDb25zdW1lciBTZWNyZXQgYW5kCiAgICogVG9r
ZW4gU2VjcmV0LCBzZXBhcmF0ZWQgYnkgYSAnJicgY2hhcmFjdGVyIChBU0NJSSBjb2RlIDM4
KSwgZXZlbiBpZiBlaXRoZXIgc2VjcmV0IGlzCiAgICogZW1wdHkuIFRoZSByZXN1bHQgTVVT
VCBiZSBlbmNvZGVkIGFnYWluLgogICAqICAgLSBDaGFwdGVyIDkuNC4xICgiR2VuZXJhdGlu
ZyBTaWduYXR1cmVzIikKICAgKgogICAqIFBsZWFzZSBub3RlIHRoYXQgdGhlIHNlY29uZCBl
bmNvZGluZyBNVVNUIE5PVCBoYXBwZW4gaW4gdGhlIFNpZ25hdHVyZU1ldGhvZCwgYXMKICAg
KiBPQXV0aFJlcXVlc3QgaGFuZGxlcyB0aGlzIQogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBi
dWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAka2V5
X3BhcnRzID0gYXJyYXkoCiAgICAgICRjb25zdW1lci0+c2VjcmV0LAogICAgICAoJHRva2Vu
KSA/ICR0b2tlbi0+c2VjcmV0IDogIiIKICAgICk7CgogICAgJGtleV9wYXJ0cyA9IE9BdXRo
VXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJGtleV9wYXJ0cyk7CiAgICAka2V5ID0gaW1wbG9k
ZSgnJicsICRrZXlfcGFydHMpOwogICAgJHJlcXVlc3QtPmJhc2Vfc3RyaW5nID0gJGtleTsK
CiAgICByZXR1cm4gJGtleTsKICB9Cn0KCi8qKgogKiBUaGUgUlNBLVNIQTEgc2lnbmF0dXJl
IG1ldGhvZCB1c2VzIHRoZSBSU0FTU0EtUEtDUzEtdjFfNSBzaWduYXR1cmUgYWxnb3JpdGht
IGFzIGRlZmluZWQgaW4KICogW1JGQzM0NDddIHNlY3Rpb24gOC4yIChtb3JlIHNpbXBseSBr
bm93biBhcyBQS0NTIzEpLCB1c2luZyBTSEEtMSBhcyB0aGUgaGFzaCBmdW5jdGlvbiBmb3IK
ICogRU1TQS1QS0NTMS12MV81LiBJdCBpcyBhc3N1bWVkIHRoYXQgdGhlIENvbnN1bWVyIGhh
cyBwcm92aWRlZCBpdHMgUlNBIHB1YmxpYyBrZXkgaW4gYQogKiB2ZXJpZmllZCB3YXkgdG8g
dGhlIFNlcnZpY2UgUHJvdmlkZXIsIGluIGEgbWFubmVyIHdoaWNoIGlzIGJleW9uZCB0aGUg
c2NvcGUgb2YgdGhpcwogKiBzcGVjaWZpY2F0aW9uLgogKiAgIC0gQ2hhcHRlciA5LjMgKCJS
U0EtU0hBMSIpCiAqLwphYnN0cmFjdCBjbGFzcyBPQXV0aFNpZ25hdHVyZU1ldGhvZF9SU0Ff
U0hBMSBleHRlbmRzIE9BdXRoU2lnbmF0dXJlTWV0aG9kIHsKICBwdWJsaWMgZnVuY3Rpb24g
Z2V0X25hbWUoKSB7CiAgICByZXR1cm4gIlJTQS1TSEExIjsKICB9CgogIC8vIFVwIHRvIHRo
ZSBTUCB0byBpbXBsZW1lbnQgdGhpcyBsb29rdXAgb2Yga2V5cy4gUG9zc2libGUgaWRlYXMg
YXJlOgogIC8vICgxKSBkbyBhIGxvb2t1cCBpbiBhIHRhYmxlIG9mIHRydXN0ZWQgY2VydHMg
a2V5ZWQgb2ZmIG9mIGNvbnN1bWVyCiAgLy8gKDIpIGZldGNoIHZpYSBodHRwIHVzaW5nIGEg
dXJsIHByb3ZpZGVkIGJ5IHRoZSByZXF1ZXN0ZXIKICAvLyAoMykgc29tZSBzb3J0IG9mIHNw
ZWNpZmljIGRpc2NvdmVyeSBjb2RlIGJhc2VkIG9uIHJlcXVlc3QKICAvLwogIC8vIEVpdGhl
ciB3YXkgc2hvdWxkIHJldHVybiBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgY2Vy
dGlmaWNhdGUKICBwcm90ZWN0ZWQgYWJzdHJhY3QgZnVuY3Rpb24gZmV0Y2hfcHVibGljX2Nl
cnQoJiRyZXF1ZXN0KTsKCiAgLy8gVXAgdG8gdGhlIFNQIHRvIGltcGxlbWVudCB0aGlzIGxv
b2t1cCBvZiBrZXlzLiBQb3NzaWJsZSBpZGVhcyBhcmU6CiAgLy8gKDEpIGRvIGEgbG9va3Vw
IGluIGEgdGFibGUgb2YgdHJ1c3RlZCBjZXJ0cyBrZXllZCBvZmYgb2YgY29uc3VtZXIKICAv
LwogIC8vIEVpdGhlciB3YXkgc2hvdWxkIHJldHVybiBhIHN0cmluZyByZXByZXNlbnRhdGlv
biBvZiB0aGUgY2VydGlmaWNhdGUKICBwcm90ZWN0ZWQgYWJzdHJhY3QgZnVuY3Rpb24gZmV0
Y2hfcHJpdmF0ZV9jZXJ0KCYkcmVxdWVzdCk7CgogIHB1YmxpYyBmdW5jdGlvbiBidWlsZF9z
aWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAkYmFzZV9zdHJp
bmcgPSAkcmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpOwogICAgJHJlcXVl
c3QtPmJhc2Vfc3RyaW5nID0gJGJhc2Vfc3RyaW5nOwoKICAgIC8vIEZldGNoIHRoZSBwcml2
YXRlIGtleSBjZXJ0IGJhc2VkIG9uIHRoZSByZXF1ZXN0CiAgICAkY2VydCA9ICR0aGlzLT5m
ZXRjaF9wcml2YXRlX2NlcnQoJHJlcXVlc3QpOwoKICAgIC8vIFB1bGwgdGhlIHByaXZhdGUg
a2V5IElEIGZyb20gdGhlIGNlcnRpZmljYXRlCiAgICAkcHJpdmF0ZWtleWlkID0gb3BlbnNz
bF9nZXRfcHJpdmF0ZWtleSgkY2VydCk7CgogICAgLy8gU2lnbiB1c2luZyB0aGUga2V5CiAg
ICAkb2sgPSBvcGVuc3NsX3NpZ24oJGJhc2Vfc3RyaW5nLCAkc2lnbmF0dXJlLCAkcHJpdmF0
ZWtleWlkKTsKCiAgICAvLyBSZWxlYXNlIHRoZSBrZXkgcmVzb3VyY2UKICAgIG9wZW5zc2xf
ZnJlZV9rZXkoJHByaXZhdGVrZXlpZCk7CgogICAgcmV0dXJuIGJhc2U2NF9lbmNvZGUoJHNp
Z25hdHVyZSk7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gY2hlY2tfc2lnbmF0dXJlKCRyZXF1
ZXN0LCAkY29uc3VtZXIsICR0b2tlbiwgJHNpZ25hdHVyZSkgewogICAgJGRlY29kZWRfc2ln
ID0gYmFzZTY0X2RlY29kZSgkc2lnbmF0dXJlKTsKCiAgICAkYmFzZV9zdHJpbmcgPSAkcmVx
dWVzdC0+Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpOwoKICAgIC8vIEZldGNoIHRoZSBw
dWJsaWMga2V5IGNlcnQgYmFzZWQgb24gdGhlIHJlcXVlc3QKICAgICRjZXJ0ID0gJHRoaXMt
PmZldGNoX3B1YmxpY19jZXJ0KCRyZXF1ZXN0KTsKCiAgICAvLyBQdWxsIHRoZSBwdWJsaWMg
a2V5IElEIGZyb20gdGhlIGNlcnRpZmljYXRlCiAgICAkcHVibGlja2V5aWQgPSBvcGVuc3Ns
X2dldF9wdWJsaWNrZXkoJGNlcnQpOwoKICAgIC8vIENoZWNrIHRoZSBjb21wdXRlZCBzaWdu
YXR1cmUgYWdhaW5zdCB0aGUgb25lIHBhc3NlZCBpbiB0aGUgcXVlcnkKICAgICRvayA9IG9w
ZW5zc2xfdmVyaWZ5KCRiYXNlX3N0cmluZywgJGRlY29kZWRfc2lnLCAkcHVibGlja2V5aWQp
OwoKICAgIC8vIFJlbGVhc2UgdGhlIGtleSByZXNvdXJjZQogICAgb3BlbnNzbF9mcmVlX2tl
eSgkcHVibGlja2V5aWQpOwoKICAgIHJldHVybiAkb2sgPT0gMTsKICB9Cn0KCmNsYXNzIE9B
dXRoUmVxdWVzdCB7CiAgcHJpdmF0ZSAkcGFyYW1ldGVyczsKICBwcml2YXRlICRodHRwX21l
dGhvZDsKICBwcml2YXRlICRodHRwX3VybDsKICAvLyBmb3IgZGVidWcgcHVycG9zZXMKICBw
dWJsaWMgJGJhc2Vfc3RyaW5nOwogIHB1YmxpYyBzdGF0aWMgJHZlcnNpb24gPSAnMS4wJzsK
ICBwdWJsaWMgc3RhdGljICRQT1NUX0lOUFVUID0gJ3BocDovL2lucHV0JzsKCiAgZnVuY3Rp
b24gX19jb25zdHJ1Y3QoJGh0dHBfbWV0aG9kLCAkaHR0cF91cmwsICRwYXJhbWV0ZXJzPU5V
TEwpIHsKICAgIEAkcGFyYW1ldGVycyBvciAkcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICAk
cGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMo
cGFyc2VfdXJsKCRodHRwX3VybCwgUEhQX1VSTF9RVUVSWSkpLCAkcGFyYW1ldGVycyk7CiAg
ICAkdGhpcy0+cGFyYW1ldGVycyA9ICRwYXJhbWV0ZXJzOwogICAgJHRoaXMtPmh0dHBfbWV0
aG9kID0gJGh0dHBfbWV0aG9kOwogICAgJHRoaXMtPmh0dHBfdXJsID0gJGh0dHBfdXJsOwog
IH0KCgogIC8qKgogICAqIGF0dGVtcHQgdG8gYnVpbGQgdXAgYSByZXF1ZXN0IGZyb20gd2hh
dCB3YXMgcGFzc2VkIHRvIHRoZSBzZXJ2ZXIKICAgKi8KICBwdWJsaWMgc3RhdGljIGZ1bmN0
aW9uIGZyb21fcmVxdWVzdCgkaHR0cF9tZXRob2Q9TlVMTCwgJGh0dHBfdXJsPU5VTEwsICRw
YXJhbWV0ZXJzPU5VTEwpIHsKICAgICRzY2hlbWUgPSAoIWlzc2V0KCRfU0VSVkVSWydIVFRQ
UyddKSB8fCAkX1NFUlZFUlsnSFRUUFMnXSAhPSAib24iKQogICAgICAgICAgICAgID8gJ2h0
dHAnCiAgICAgICAgICAgICAgOiAnaHR0cHMnOwogICAgQCRodHRwX3VybCBvciAkaHR0cF91
cmwgPSAkc2NoZW1lIC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzovLycgLiAk
X1NFUlZFUlsnSFRUUF9IT1NUJ10gLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAn
OicgLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkX1NFUlZFUlsnU0VSVkVSX1BP
UlQnXSAuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRfU0VSVkVSWydSRVFVRVNU
X1VSSSddOwogICAgQCRodHRwX21ldGhvZCBvciAkaHR0cF9tZXRob2QgPSAkX1NFUlZFUlsn
UkVRVUVTVF9NRVRIT0QnXTsKCiAgICAvLyBXZSB3ZXJlbid0IGhhbmRlZCBhbnkgcGFyYW1l
dGVycywgc28gbGV0J3MgZmluZCB0aGUgb25lcyByZWxldmFudCB0bwogICAgLy8gdGhpcyBy
ZXF1ZXN0LgogICAgLy8gSWYgeW91IHJ1biBYTUwtUlBDIG9yIHNpbWlsYXIgeW91IHNob3Vs
ZCB1c2UgdGhpcyB0byBwcm92aWRlIHlvdXIgb3duCiAgICAvLyBwYXJzZWQgcGFyYW1ldGVy
LWxpc3QKICAgIGlmICghJHBhcmFtZXRlcnMpIHsKICAgICAgLy8gRmluZCByZXF1ZXN0IGhl
YWRlcnMKICAgICAgJHJlcXVlc3RfaGVhZGVycyA9IE9BdXRoVXRpbDo6Z2V0X2hlYWRlcnMo
KTsKCiAgICAgIC8vIFBhcnNlIHRoZSBxdWVyeS1zdHJpbmcgdG8gZmluZCBHRVQgcGFyYW1l
dGVycwogICAgICAkcGFyYW1ldGVycyA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygk
X1NFUlZFUlsnUVVFUllfU1RSSU5HJ10pOwoKICAgICAgLy8gSXQncyBhIFBPU1QgcmVxdWVz
dCBvZiB0aGUgcHJvcGVyIGNvbnRlbnQtdHlwZSwgc28gcGFyc2UgUE9TVAogICAgICAvLyBw
YXJhbWV0ZXJzIGFuZCBhZGQgdGhvc2Ugb3ZlcnJpZGluZyBhbnkgZHVwbGljYXRlcyBmcm9t
IEdFVAogICAgICBpZiAoJGh0dHBfbWV0aG9kID09ICJQT1NUIgogICAgICAgICAgJiYgQHN0
cnN0cigkcmVxdWVzdF9oZWFkZXJzWyJDb250ZW50LVR5cGUiXSwKICAgICAgICAgICAgICAg
ICAgICAgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpCiAgICAgICAgICAp
IHsKICAgICAgICAkcG9zdF9kYXRhID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKAog
ICAgICAgICAgZmlsZV9nZXRfY29udGVudHMoc2VsZjo6JFBPU1RfSU5QVVQpCiAgICAgICAg
KTsKICAgICAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCRwYXJhbWV0ZXJzLCAkcG9z
dF9kYXRhKTsKICAgICAgfQoKICAgICAgLy8gV2UgaGF2ZSBhIEF1dGhvcml6YXRpb24taGVh
ZGVyIHdpdGggT0F1dGggZGF0YS4gUGFyc2UgdGhlIGhlYWRlcgogICAgICAvLyBhbmQgYWRk
IHRob3NlIG92ZXJyaWRpbmcgYW55IGR1cGxpY2F0ZXMgZnJvbSBHRVQgb3IgUE9TVAogICAg
ICBpZiAoQHN1YnN0cigkcmVxdWVzdF9oZWFkZXJzWydBdXRob3JpemF0aW9uJ10sIDAsIDYp
ID09ICJPQXV0aCAiKSB7CiAgICAgICAgJGhlYWRlcl9wYXJhbWV0ZXJzID0gT0F1dGhVdGls
OjpzcGxpdF9oZWFkZXIoCiAgICAgICAgICAkcmVxdWVzdF9oZWFkZXJzWydBdXRob3JpemF0
aW9uJ10KICAgICAgICApOwogICAgICAgICRwYXJhbWV0ZXJzID0gYXJyYXlfbWVyZ2UoJHBh
cmFtZXRlcnMsICRoZWFkZXJfcGFyYW1ldGVycyk7CiAgICAgIH0KCiAgICB9CgogICAgcmV0
dXJuIG5ldyBPQXV0aFJlcXVlc3QoJGh0dHBfbWV0aG9kLCAkaHR0cF91cmwsICRwYXJhbWV0
ZXJzKTsKICB9CgogIC8qKgogICAqIHByZXR0eSBtdWNoIGEgaGVscGVyIGZ1bmN0aW9uIHRv
IHNldCB1cCB0aGUgcmVxdWVzdAogICAqLwogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZnJv
bV9jb25zdW1lcl9hbmRfdG9rZW4oJGNvbnN1bWVyLCAkdG9rZW4sICRodHRwX21ldGhvZCwg
JGh0dHBfdXJsLCAkcGFyYW1ldGVycz1OVUxMKSB7CiAgICBAJHBhcmFtZXRlcnMgb3IgJHBh
cmFtZXRlcnMgPSBhcnJheSgpOwogICAgJGRlZmF1bHRzID0gYXJyYXkoIm9hdXRoX3ZlcnNp
b24iID0+IE9BdXRoUmVxdWVzdDo6JHZlcnNpb24sCiAgICAgICAgICAgICAgICAgICAgICAi
b2F1dGhfbm9uY2UiID0+IE9BdXRoUmVxdWVzdDo6Z2VuZXJhdGVfbm9uY2UoKSwKICAgICAg
ICAgICAgICAgICAgICAgICJvYXV0aF90aW1lc3RhbXAiID0+IE9BdXRoUmVxdWVzdDo6Z2Vu
ZXJhdGVfdGltZXN0YW1wKCksCiAgICAgICAgICAgICAgICAgICAgICAib2F1dGhfY29uc3Vt
ZXJfa2V5IiA9PiAkY29uc3VtZXItPmtleSk7CiAgICBpZiAoJHRva2VuKQogICAgICAkZGVm
YXVsdHNbJ29hdXRoX3Rva2VuJ10gPSAkdG9rZW4tPmtleTsKCiAgICAkcGFyYW1ldGVycyA9
IGFycmF5X21lcmdlKCRkZWZhdWx0cywgJHBhcmFtZXRlcnMpOwoKICAgIHJldHVybiBuZXcg
T0F1dGhSZXF1ZXN0KCRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVycyk7CiAg
fQoKICBwdWJsaWMgZnVuY3Rpb24gc2V0X3BhcmFtZXRlcigkbmFtZSwgJHZhbHVlLCAkYWxs
b3dfZHVwbGljYXRlcyA9IHRydWUpIHsKICAgIGlmICgkYWxsb3dfZHVwbGljYXRlcyAmJiBp
c3NldCgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pKSB7CiAgICAgIC8vIFdlIGhhdmUgYWxy
ZWFkeSBhZGRlZCBwYXJhbWV0ZXIocykgd2l0aCB0aGlzIG5hbWUsIHNvIGFkZCB0byB0aGUg
bGlzdAogICAgICBpZiAoaXNfc2NhbGFyKCR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSkpIHsK
ICAgICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCBkdXBsaWNhdGUsIHNvIHRyYW5zZm9ybSBz
Y2FsYXIgKHN0cmluZykKICAgICAgICAvLyBpbnRvIGFuIGFycmF5IHNvIHdlIGNhbiBhZGQg
dGhlIGR1cGxpY2F0ZXMKICAgICAgICAkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0gPSBhcnJh
eSgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pOwogICAgICB9CgogICAgICAkdGhpcy0+cGFy
YW1ldGVyc1skbmFtZV1bXSA9ICR2YWx1ZTsKICAgIH0gZWxzZSB7CiAgICAgICR0aGlzLT5w
YXJhbWV0ZXJzWyRuYW1lXSA9ICR2YWx1ZTsKICAgIH0KICB9CgogIHB1YmxpYyBmdW5jdGlv
biBnZXRfcGFyYW1ldGVyKCRuYW1lKSB7CiAgICByZXR1cm4gaXNzZXQoJHRoaXMtPnBhcmFt
ZXRlcnNbJG5hbWVdKSA/ICR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSA6IG51bGw7CiAgfQoK
ICBwdWJsaWMgZnVuY3Rpb24gZ2V0X3BhcmFtZXRlcnMoKSB7CiAgICByZXR1cm4gJHRoaXMt
PnBhcmFtZXRlcnM7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gdW5zZXRfcGFyYW1ldGVyKCRu
YW1lKSB7CiAgICB1bnNldCgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pOwogIH0KCiAgLyoq
CiAgICogVGhlIHJlcXVlc3QgcGFyYW1ldGVycywgc29ydGVkIGFuZCBjb25jYXRlbmF0ZWQg
aW50byBhIG5vcm1hbGl6ZWQgc3RyaW5nLgogICAqIEByZXR1cm4gc3RyaW5nCiAgICovCiAg
cHVibGljIGZ1bmN0aW9uIGdldF9zaWduYWJsZV9wYXJhbWV0ZXJzKCkgewogICAgLy8gR3Jh
YiBhbGwgcGFyYW1ldGVycwogICAgJHBhcmFtcyA9ICR0aGlzLT5wYXJhbWV0ZXJzOwoKICAg
IC8vIFJlbW92ZSBvYXV0aF9zaWduYXR1cmUgaWYgcHJlc2VudAogICAgLy8gUmVmOiBTcGVj
OiA5LjEuMSAoIlRoZSBvYXV0aF9zaWduYXR1cmUgcGFyYW1ldGVyIE1VU1QgYmUgZXhjbHVk
ZWQuIikKICAgIGlmIChpc3NldCgkcGFyYW1zWydvYXV0aF9zaWduYXR1cmUnXSkpIHsKICAg
ICAgdW5zZXQoJHBhcmFtc1snb2F1dGhfc2lnbmF0dXJlJ10pOwogICAgfQoKICAgIHJldHVy
biBPQXV0aFV0aWw6OmJ1aWxkX2h0dHBfcXVlcnkoJHBhcmFtcyk7CiAgfQoKICAvKioKICAg
KiBSZXR1cm5zIHRoZSBiYXNlIHN0cmluZyBvZiB0aGlzIHJlcXVlc3QKICAgKgogICAqIFRo
ZSBiYXNlIHN0cmluZyBkZWZpbmVkIGFzIHRoZSBtZXRob2QsIHRoZSB1cmwKICAgKiBhbmQg
dGhlIHBhcmFtZXRlcnMgKG5vcm1hbGl6ZWQpLCBlYWNoIHVybGVuY29kZWQKICAgKiBhbmQg
dGhlIGNvbmNhdGVkIHdpdGggJi4KICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZ2V0X3NpZ25h
dHVyZV9iYXNlX3N0cmluZygpIHsKICAgICRwYXJ0cyA9IGFycmF5KAogICAgICAkdGhpcy0+
Z2V0X25vcm1hbGl6ZWRfaHR0cF9tZXRob2QoKSwKICAgICAgJHRoaXMtPmdldF9ub3JtYWxp
emVkX2h0dHBfdXJsKCksCiAgICAgICR0aGlzLT5nZXRfc2lnbmFibGVfcGFyYW1ldGVycygp
CiAgICApOwoKICAgICRwYXJ0cyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJHBh
cnRzKTsKCiAgICByZXR1cm4gaW1wbG9kZSgnJicsICRwYXJ0cyk7CiAgfQoKICAvKioKICAg
KiBqdXN0IHVwcGVyY2FzZXMgdGhlIGh0dHAgbWV0aG9kCiAgICovCiAgcHVibGljIGZ1bmN0
aW9uIGdldF9ub3JtYWxpemVkX2h0dHBfbWV0aG9kKCkgewogICAgcmV0dXJuIHN0cnRvdXBw
ZXIoJHRoaXMtPmh0dHBfbWV0aG9kKTsKICB9CgogIC8qKgogICAqIHBhcnNlcyB0aGUgdXJs
IGFuZCByZWJ1aWxkcyBpdCB0byBiZQogICAqIHNjaGVtZTovL2hvc3QvcGF0aAogICAqLwog
IHB1YmxpYyBmdW5jdGlvbiBnZXRfbm9ybWFsaXplZF9odHRwX3VybCgpIHsKICAgICRwYXJ0
cyA9IHBhcnNlX3VybCgkdGhpcy0+aHR0cF91cmwpOwoKICAgICRwb3J0ID0gQCRwYXJ0c1sn
cG9ydCddOwogICAgJHNjaGVtZSA9ICRwYXJ0c1snc2NoZW1lJ107CiAgICAkaG9zdCA9ICRw
YXJ0c1snaG9zdCddOwogICAgJHBhdGggPSBAJHBhcnRzWydwYXRoJ107CgogICAgJHBvcnQg
b3IgJHBvcnQgPSAoJHNjaGVtZSA9PSAnaHR0cHMnKSA/ICc0NDMnIDogJzgwJzsKCiAgICBp
ZiAoKCRzY2hlbWUgPT0gJ2h0dHBzJyAmJiAkcG9ydCAhPSAnNDQzJykKICAgICAgICB8fCAo
JHNjaGVtZSA9PSAnaHR0cCcgJiYgJHBvcnQgIT0gJzgwJykpIHsKICAgICAgJGhvc3QgPSAi
JGhvc3Q6JHBvcnQiOwogICAgfQogICAgcmV0dXJuICIkc2NoZW1lOi8vJGhvc3QkcGF0aCI7
CiAgfQoKICAvKioKICAgKiBidWlsZHMgYSB1cmwgdXNhYmxlIGZvciBhIEdFVCByZXF1ZXN0
CiAgICovCiAgcHVibGljIGZ1bmN0aW9uIHRvX3VybCgpIHsKICAgICRwb3N0X2RhdGEgPSAk
dGhpcy0+dG9fcG9zdGRhdGEoKTsKICAgICRvdXQgPSAkdGhpcy0+Z2V0X25vcm1hbGl6ZWRf
aHR0cF91cmwoKTsKICAgIGlmICgkcG9zdF9kYXRhKSB7CiAgICAgICRvdXQgLj0gJz8nLiRw
b3N0X2RhdGE7CiAgICB9CiAgICByZXR1cm4gJG91dDsKICB9CgogIC8qKgogICAqIGJ1aWxk
cyB0aGUgZGF0YSBvbmUgd291bGQgc2VuZCBpbiBhIFBPU1QgcmVxdWVzdAogICAqLwogIHB1
YmxpYyBmdW5jdGlvbiB0b19wb3N0ZGF0YSgpIHsKICAgIHJldHVybiBPQXV0aFV0aWw6OmJ1
aWxkX2h0dHBfcXVlcnkoJHRoaXMtPnBhcmFtZXRlcnMpOwogIH0KCiAgLyoqCiAgICogYnVp
bGRzIHRoZSBBdXRob3JpemF0aW9uOiBoZWFkZXIKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24g
dG9faGVhZGVyKCRyZWFsbT1udWxsKSB7CiAgICAkZmlyc3QgPSB0cnVlOwogIGlmKCRyZWFs
bSkgewogICAgICAkb3V0ID0gJ0F1dGhvcml6YXRpb246IE9BdXRoIHJlYWxtPSInIC4gT0F1
dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkcmVhbG0pIC4gJyInOwogICAgICAkZmlyc3Qg
PSBmYWxzZTsKICAgIH0gZWxzZQogICAgICAkb3V0ID0gJ0F1dGhvcml6YXRpb246IE9BdXRo
JzsKCiAgICAkdG90YWwgPSBhcnJheSgpOwogICAgZm9yZWFjaCAoJHRoaXMtPnBhcmFtZXRl
cnMgYXMgJGsgPT4gJHYpIHsKICAgICAgaWYgKHN1YnN0cigkaywgMCwgNSkgIT0gIm9hdXRo
IikgY29udGludWU7CiAgICAgIGlmIChpc19hcnJheSgkdikpIHsKICAgICAgICB0aHJvdyBu
ZXcgT0F1dGhFeGNlcHRpb24oJ0FycmF5cyBub3Qgc3VwcG9ydGVkIGluIGhlYWRlcnMnKTsK
ICAgICAgfQogICAgICAkb3V0IC49ICgkZmlyc3QpID8gJyAnIDogJywnOwogICAgICAkb3V0
IC49IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJGspIC4KICAgICAgICAgICAgICAn
PSInIC4KICAgICAgICAgICAgICBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCR2KSAu
CiAgICAgICAgICAgICAgJyInOwogICAgICAkZmlyc3QgPSBmYWxzZTsKICAgIH0KICAgIHJl
dHVybiAkb3V0OwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIF9fdG9TdHJpbmcoKSB7CiAgICBy
ZXR1cm4gJHRoaXMtPnRvX3VybCgpOwogIH0KCgogIHB1YmxpYyBmdW5jdGlvbiBzaWduX3Jl
cXVlc3QoJHNpZ25hdHVyZV9tZXRob2QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAkdGhp
cy0+c2V0X3BhcmFtZXRlcigKICAgICAgIm9hdXRoX3NpZ25hdHVyZV9tZXRob2QiLAogICAg
ICAkc2lnbmF0dXJlX21ldGhvZC0+Z2V0X25hbWUoKSwKICAgICAgZmFsc2UKICAgICk7CiAg
ICAkc2lnbmF0dXJlID0gJHRoaXMtPmJ1aWxkX3NpZ25hdHVyZSgkc2lnbmF0dXJlX21ldGhv
ZCwgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAgJHRoaXMtPnNldF9wYXJhbWV0ZXIoIm9hdXRo
X3NpZ25hdHVyZSIsICRzaWduYXR1cmUsIGZhbHNlKTsKICB9CgogIHB1YmxpYyBmdW5jdGlv
biBidWlsZF9zaWduYXR1cmUoJHNpZ25hdHVyZV9tZXRob2QsICRjb25zdW1lciwgJHRva2Vu
KSB7CiAgICAkc2lnbmF0dXJlID0gJHNpZ25hdHVyZV9tZXRob2QtPmJ1aWxkX3NpZ25hdHVy
ZSgkdGhpcywgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAgcmV0dXJuICRzaWduYXR1cmU7CiAg
fQoKICAvKioKICAgKiB1dGlsIGZ1bmN0aW9uOiBjdXJyZW50IHRpbWVzdGFtcAogICAqLwog
IHByaXZhdGUgc3RhdGljIGZ1bmN0aW9uIGdlbmVyYXRlX3RpbWVzdGFtcCgpIHsKICAgIHJl
dHVybiB0aW1lKCk7CiAgfQoKICAvKioKICAgKiB1dGlsIGZ1bmN0aW9uOiBjdXJyZW50IG5v
bmNlCiAgICovCiAgcHJpdmF0ZSBzdGF0aWMgZnVuY3Rpb24gZ2VuZXJhdGVfbm9uY2UoKSB7
CiAgICAkbXQgPSBtaWNyb3RpbWUoKTsKICAgICRyYW5kID0gbXRfcmFuZCgpOwoKICAgIHJl
dHVybiBtZDUoJG10IC4gJHJhbmQpOyAvLyBtZDVzIGxvb2sgbmljZXIgdGhhbiBudW1iZXJz
CiAgfQp9CgpjbGFzcyBPQXV0aFNlcnZlciB7CiAgcHJvdGVjdGVkICR0aW1lc3RhbXBfdGhy
ZXNob2xkID0gMzAwOyAvLyBpbiBzZWNvbmRzLCBmaXZlIG1pbnV0ZXMKICBwcm90ZWN0ZWQg
JHZlcnNpb24gPSAnMS4wJzsgICAgICAgICAgICAgLy8gaGkgYmxhaW5lCiAgcHJvdGVjdGVk
ICRzaWduYXR1cmVfbWV0aG9kcyA9IGFycmF5KCk7CgogIHByb3RlY3RlZCAkZGF0YV9zdG9y
ZTsKCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGRhdGFfc3RvcmUpIHsKICAgICR0aGlzLT5k
YXRhX3N0b3JlID0gJGRhdGFfc3RvcmU7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gYWRkX3Np
Z25hdHVyZV9tZXRob2QoJHNpZ25hdHVyZV9tZXRob2QpIHsKICAgICR0aGlzLT5zaWduYXR1
cmVfbWV0aG9kc1skc2lnbmF0dXJlX21ldGhvZC0+Z2V0X25hbWUoKV0gPQogICAgICAkc2ln
bmF0dXJlX21ldGhvZDsKICB9CgogIC8vIGhpZ2ggbGV2ZWwgZnVuY3Rpb25zCgogIC8qKgog
ICAqIHByb2Nlc3MgYSByZXF1ZXN0X3Rva2VuIHJlcXVlc3QKICAgKiByZXR1cm5zIHRoZSBy
ZXF1ZXN0IHRva2VuIG9uIHN1Y2Nlc3MKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZmV0Y2hf
cmVxdWVzdF90b2tlbigmJHJlcXVlc3QpIHsKICAgICR0aGlzLT5nZXRfdmVyc2lvbigkcmVx
dWVzdCk7CgogICAgJGNvbnN1bWVyID0gJHRoaXMtPmdldF9jb25zdW1lcigkcmVxdWVzdCk7
CgogICAgLy8gbm8gdG9rZW4gcmVxdWlyZWQgZm9yIHRoZSBpbml0aWFsIHRva2VuIHJlcXVl
c3QKICAgICR0b2tlbiA9IE5VTEw7CgogICAgJHRoaXMtPmNoZWNrX3NpZ25hdHVyZSgkcmVx
dWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwoKICAgIC8vIFJldiBBIGNoYW5nZQogICAgJGNh
bGxiYWNrID0gJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX2NhbGxiYWNrJyk7CiAg
ICAkbmV3X3Rva2VuID0gJHRoaXMtPmRhdGFfc3RvcmUtPm5ld19yZXF1ZXN0X3Rva2VuKCRj
b25zdW1lciwgJGNhbGxiYWNrKTsKCiAgICByZXR1cm4gJG5ld190b2tlbjsKICB9CgogIC8q
KgogICAqIHByb2Nlc3MgYW4gYWNjZXNzX3Rva2VuIHJlcXVlc3QKICAgKiByZXR1cm5zIHRo
ZSBhY2Nlc3MgdG9rZW4gb24gc3VjY2VzcwogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBmZXRj
aF9hY2Nlc3NfdG9rZW4oJiRyZXF1ZXN0KSB7CiAgICAkdGhpcy0+Z2V0X3ZlcnNpb24oJHJl
cXVlc3QpOwoKICAgICRjb25zdW1lciA9ICR0aGlzLT5nZXRfY29uc3VtZXIoJHJlcXVlc3Qp
OwoKICAgIC8vIHJlcXVpcmVzIGF1dGhvcml6ZWQgcmVxdWVzdCB0b2tlbgogICAgJHRva2Vu
ID0gJHRoaXMtPmdldF90b2tlbigkcmVxdWVzdCwgJGNvbnN1bWVyLCAicmVxdWVzdCIpOwoK
ICAgICR0aGlzLT5jaGVja19zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2Vu
KTsKCiAgICAvLyBSZXYgQSBjaGFuZ2UKICAgICR2ZXJpZmllciA9ICRyZXF1ZXN0LT5nZXRf
cGFyYW1ldGVyKCdvYXV0aF92ZXJpZmllcicpOwogICAgJG5ld190b2tlbiA9ICR0aGlzLT5k
YXRhX3N0b3JlLT5uZXdfYWNjZXNzX3Rva2VuKCR0b2tlbiwgJGNvbnN1bWVyLCAkdmVyaWZp
ZXIpOwoKICAgIHJldHVybiAkbmV3X3Rva2VuOwogIH0KCiAgLyoqCiAgICogdmVyaWZ5IGFu
IGFwaSBjYWxsLCBjaGVja3MgYWxsIHRoZSBwYXJhbWV0ZXJzCiAgICovCiAgcHVibGljIGZ1
bmN0aW9uIHZlcmlmeV9yZXF1ZXN0KCYkcmVxdWVzdCkgewogICAgJHRoaXMtPmdldF92ZXJz
aW9uKCRyZXF1ZXN0KTsKICAgICRjb25zdW1lciA9ICR0aGlzLT5nZXRfY29uc3VtZXIoJHJl
cXVlc3QpOwogICAgJHRva2VuID0gJHRoaXMtPmdldF90b2tlbigkcmVxdWVzdCwgJGNvbnN1
bWVyLCAiYWNjZXNzIik7CiAgICAkdGhpcy0+Y2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAk
Y29uc3VtZXIsICR0b2tlbik7CiAgICByZXR1cm4gYXJyYXkoJGNvbnN1bWVyLCAkdG9rZW4p
OwogIH0KCiAgLy8gSW50ZXJuYWxzIGZyb20gaGVyZQogIC8qKgogICAqIHZlcnNpb24gMQog
ICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X3ZlcnNpb24oJiRyZXF1ZXN0KSB7CiAgICAk
dmVyc2lvbiA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCJvYXV0aF92ZXJzaW9uIik7CiAg
ICBpZiAoISR2ZXJzaW9uKSB7CiAgICAgIC8vIFNlcnZpY2UgUHJvdmlkZXJzIE1VU1QgYXNz
dW1lIHRoZSBwcm90b2NvbCB2ZXJzaW9uIHRvIGJlIDEuMCBpZiB0aGlzIHBhcmFtZXRlciBp
cyBub3QgcHJlc2VudC4KICAgICAgLy8gQ2hhcHRlciA3LjAgKCJBY2Nlc3NpbmcgUHJvdGVj
dGVkIFJlc3NvdXJjZXMiKQogICAgICAkdmVyc2lvbiA9ICcxLjAnOwogICAgfQogICAgaWYg
KCR2ZXJzaW9uICE9PSAkdGhpcy0+dmVyc2lvbikgewogICAgICB0aHJvdyBuZXcgT0F1dGhF
eGNlcHRpb24oIk9BdXRoIHZlcnNpb24gJyR2ZXJzaW9uJyBub3Qgc3VwcG9ydGVkIik7CiAg
ICB9CiAgICByZXR1cm4gJHZlcnNpb247CiAgfQoKICAvKioKICAgKiBmaWd1cmUgb3V0IHRo
ZSBzaWduYXR1cmUgd2l0aCBzb21lIGRlZmF1bHRzCiAgICovCiAgcHJpdmF0ZSBmdW5jdGlv
biBnZXRfc2lnbmF0dXJlX21ldGhvZCgmJHJlcXVlc3QpIHsKICAgICRzaWduYXR1cmVfbWV0
aG9kID0KICAgICAgICBAJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoIm9hdXRoX3NpZ25hdHVy
ZV9tZXRob2QiKTsKCiAgICBpZiAoISRzaWduYXR1cmVfbWV0aG9kKSB7CiAgICAgIC8vIEFj
Y29yZGluZyB0byBjaGFwdGVyIDcgKCJBY2Nlc3NpbmcgUHJvdGVjdGVkIFJlc3NvdXJjZXMi
KSB0aGUgc2lnbmF0dXJlLW1ldGhvZAogICAgICAvLyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQs
IGFuZCB3ZSBjYW4ndCBqdXN0IGZhbGxiYWNrIHRvIFBMQUlOVEVYVAogICAgICB0aHJvdyBu
ZXcgT0F1dGhFeGNlcHRpb24oJ05vIHNpZ25hdHVyZSBtZXRob2QgcGFyYW1ldGVyLiBUaGlz
IHBhcmFtZXRlciBpcyByZXF1aXJlZCcpOwogICAgfQoKICAgIGlmICghaW5fYXJyYXkoJHNp
Z25hdHVyZV9tZXRob2QsCiAgICAgICAgICAgICAgICAgIGFycmF5X2tleXMoJHRoaXMtPnNp
Z25hdHVyZV9tZXRob2RzKSkpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKAog
ICAgICAgICJTaWduYXR1cmUgbWV0aG9kICckc2lnbmF0dXJlX21ldGhvZCcgbm90IHN1cHBv
cnRlZCAiIC4KICAgICAgICAidHJ5IG9uZSBvZiB0aGUgZm9sbG93aW5nOiAiIC4KICAgICAg
ICBpbXBsb2RlKCIsICIsIGFycmF5X2tleXMoJHRoaXMtPnNpZ25hdHVyZV9tZXRob2RzKSkK
ICAgICAgKTsKICAgIH0KICAgIHJldHVybiAkdGhpcy0+c2lnbmF0dXJlX21ldGhvZHNbJHNp
Z25hdHVyZV9tZXRob2RdOwogIH0KCiAgLyoqCiAgICogdHJ5IHRvIGZpbmQgdGhlIGNvbnN1
bWVyIGZvciB0aGUgcHJvdmlkZWQgcmVxdWVzdCdzIGNvbnN1bWVyIGtleQogICAqLwogIHBy
aXZhdGUgZnVuY3Rpb24gZ2V0X2NvbnN1bWVyKCYkcmVxdWVzdCkgewogICAgJGNvbnN1bWVy
X2tleSA9IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcigib2F1dGhfY29uc3VtZXJfa2V5Iik7
CiAgICBpZiAoISRjb25zdW1lcl9rZXkpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0
aW9uKCJJbnZhbGlkIGNvbnN1bWVyIGtleSIpOwogICAgfQoKICAgICRjb25zdW1lciA9ICR0
aGlzLT5kYXRhX3N0b3JlLT5sb29rdXBfY29uc3VtZXIoJGNvbnN1bWVyX2tleSk7CiAgICBp
ZiAoISRjb25zdW1lcikgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIkludmFs
aWQgY29uc3VtZXIiKTsKICAgIH0KCiAgICByZXR1cm4gJGNvbnN1bWVyOwogIH0KCiAgLyoq
CiAgICogdHJ5IHRvIGZpbmQgdGhlIHRva2VuIGZvciB0aGUgcHJvdmlkZWQgcmVxdWVzdCdz
IHRva2VuIGtleQogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X3Rva2VuKCYkcmVxdWVz
dCwgJGNvbnN1bWVyLCAkdG9rZW5fdHlwZT0iYWNjZXNzIikgewogICAgJHRva2VuX2ZpZWxk
ID0gQCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF90b2tlbicpOwogICAgJHRva2Vu
ID0gJHRoaXMtPmRhdGFfc3RvcmUtPmxvb2t1cF90b2tlbigKICAgICAgJGNvbnN1bWVyLCAk
dG9rZW5fdHlwZSwgJHRva2VuX2ZpZWxkCiAgICApOwogICAgaWYgKCEkdG9rZW4pIHsKICAg
ICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJbnZhbGlkICR0b2tlbl90eXBlIHRva2Vu
OiAkdG9rZW5fZmllbGQiKTsKICAgIH0KICAgIHJldHVybiAkdG9rZW47CiAgfQoKICAvKioK
ICAgKiBhbGwtaW4tb25lIGZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBzaWduYXR1cmUgb24gYSBy
ZXF1ZXN0CiAgICogc2hvdWxkIGd1ZXNzIHRoZSBzaWduYXR1cmUgbWV0aG9kIGFwcHJvcHJp
YXRlbHkKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGNoZWNrX3NpZ25hdHVyZSgmJHJlcXVl
c3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAvLyB0aGlzIHNob3VsZCBwcm9iYWJseSBi
ZSBpbiBhIGRpZmZlcmVudCBtZXRob2QKICAgICR0aW1lc3RhbXAgPSBAJHJlcXVlc3QtPmdl
dF9wYXJhbWV0ZXIoJ29hdXRoX3RpbWVzdGFtcCcpOwogICAgJG5vbmNlID0gQCRyZXF1ZXN0
LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF9ub25jZScpOwoKICAgICR0aGlzLT5jaGVja190aW1l
c3RhbXAoJHRpbWVzdGFtcCk7CiAgICAkdGhpcy0+Y2hlY2tfbm9uY2UoJGNvbnN1bWVyLCAk
dG9rZW4sICRub25jZSwgJHRpbWVzdGFtcCk7CgogICAgJHNpZ25hdHVyZV9tZXRob2QgPSAk
dGhpcy0+Z2V0X3NpZ25hdHVyZV9tZXRob2QoJHJlcXVlc3QpOwoKICAgICRzaWduYXR1cmUg
PSAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfc2lnbmF0dXJlJyk7CiAgICAkdmFs
aWRfc2lnID0gJHNpZ25hdHVyZV9tZXRob2QtPmNoZWNrX3NpZ25hdHVyZSgKICAgICAgJHJl
cXVlc3QsCiAgICAgICRjb25zdW1lciwKICAgICAgJHRva2VuLAogICAgICAkc2lnbmF0dXJl
CiAgICApOwoKICAgIGlmICghJHZhbGlkX3NpZykgewogICAgICB0aHJvdyBuZXcgT0F1dGhF
eGNlcHRpb24oIkludmFsaWQgc2lnbmF0dXJlIik7CiAgICB9CiAgfQoKICAvKioKICAgKiBj
aGVjayB0aGF0IHRoZSB0aW1lc3RhbXAgaXMgbmV3IGVub3VnaAogICAqLwogIHByaXZhdGUg
ZnVuY3Rpb24gY2hlY2tfdGltZXN0YW1wKCR0aW1lc3RhbXApIHsKICAgIGlmKCAhICR0aW1l
c3RhbXAgKQogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAgICAgJ01pc3Np
bmcgdGltZXN0YW1wIHBhcmFtZXRlci4gVGhlIHBhcmFtZXRlciBpcyByZXF1aXJlZCcKICAg
ICAgKTsKCiAgICAvLyB2ZXJpZnkgdGhhdCB0aW1lc3RhbXAgaXMgcmVjZW50aXNoCiAgICAk
bm93ID0gdGltZSgpOwogICAgaWYgKGFicygkbm93IC0gJHRpbWVzdGFtcCkgPiAkdGhpcy0+
dGltZXN0YW1wX3RocmVzaG9sZCkgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24o
CiAgICAgICAgIkV4cGlyZWQgdGltZXN0YW1wLCB5b3VycyAkdGltZXN0YW1wLCBvdXJzICRu
b3ciCiAgICAgICk7CiAgICB9CiAgfQoKICAvKioKICAgKiBjaGVjayB0aGF0IHRoZSBub25j
ZSBpcyBub3QgcmVwZWF0ZWQKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGNoZWNrX25vbmNl
KCRjb25zdW1lciwgJHRva2VuLCAkbm9uY2UsICR0aW1lc3RhbXApIHsKICAgIGlmKCAhICRu
b25jZSApCiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigKICAgICAgICAnTWlzc2lu
ZyBub25jZSBwYXJhbWV0ZXIuIFRoZSBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQnCiAgICAgICk7
CgogICAgLy8gdmVyaWZ5IHRoYXQgdGhlIG5vbmNlIGlzIHVuaXF1ZWlzaAogICAgJGZvdW5k
ID0gJHRoaXMtPmRhdGFfc3RvcmUtPmxvb2t1cF9ub25jZSgKICAgICAgJGNvbnN1bWVyLAog
ICAgICAkdG9rZW4sCiAgICAgICRub25jZSwKICAgICAgJHRpbWVzdGFtcAogICAgKTsKICAg
IGlmICgkZm91bmQpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJOb25jZSBh
bHJlYWR5IHVzZWQ6ICRub25jZSIpOwogICAgfQogIH0KCn0KCmNsYXNzIE9BdXRoRGF0YVN0
b3JlIHsKICBmdW5jdGlvbiBsb29rdXBfY29uc3VtZXIoJGNvbnN1bWVyX2tleSkgewogICAg
Ly8gaW1wbGVtZW50IG1lCiAgfQoKICBmdW5jdGlvbiBsb29rdXBfdG9rZW4oJGNvbnN1bWVy
LCAkdG9rZW5fdHlwZSwgJHRva2VuKSB7CiAgICAvLyBpbXBsZW1lbnQgbWUKICB9CgogIGZ1
bmN0aW9uIGxvb2t1cF9ub25jZSgkY29uc3VtZXIsICR0b2tlbiwgJG5vbmNlLCAkdGltZXN0
YW1wKSB7CiAgICAvLyBpbXBsZW1lbnQgbWUKICB9CgogIGZ1bmN0aW9uIG5ld19yZXF1ZXN0
X3Rva2VuKCRjb25zdW1lciwgJGNhbGxiYWNrID0gbnVsbCkgewogICAgLy8gcmV0dXJuIGEg
bmV3IHRva2VuIGF0dGFjaGVkIHRvIHRoaXMgY29uc3VtZXIKICB9CgogIGZ1bmN0aW9uIG5l
d19hY2Nlc3NfdG9rZW4oJHRva2VuLCAkY29uc3VtZXIsICR2ZXJpZmllciA9IG51bGwpIHsK
ICAgIC8vIHJldHVybiBhIG5ldyBhY2Nlc3MgdG9rZW4gYXR0YWNoZWQgdG8gdGhpcyBjb25z
dW1lcgogICAgLy8gZm9yIHRoZSB1c2VyIGFzc29jaWF0ZWQgd2l0aCB0aGlzIHRva2VuIGlm
IHRoZSByZXF1ZXN0IHRva2VuCiAgICAvLyBpcyBhdXRob3JpemVkCiAgICAvLyBzaG91bGQg
YWxzbyBpbnZhbGlkYXRlIHRoZSByZXF1ZXN0IHRva2VuCiAgfQoKfQoKY2xhc3MgT0F1dGhV
dGlsIHsKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHVybGVuY29kZV9yZmMzOTg2KCRpbnB1
dCkgewogIGlmIChpc19hcnJheSgkaW5wdXQpKSB7CiAgICByZXR1cm4gYXJyYXlfbWFwKGFy
cmF5KCdPQXV0aFV0aWwnLCAndXJsZW5jb2RlX3JmYzM5ODYnKSwgJGlucHV0KTsKICB9IGVs
c2UgaWYgKGlzX3NjYWxhcigkaW5wdXQpKSB7CiAgICByZXR1cm4gc3RyX3JlcGxhY2UoCiAg
ICAgICcrJywKICAgICAgJyAnLAogICAgICBzdHJfcmVwbGFjZSgnJTdFJywgJ34nLCByYXd1
cmxlbmNvZGUoJGlucHV0KSkKICAgICk7CiAgfSBlbHNlIHsKICAgIHJldHVybiAnJzsKICB9
Cn0KCgogIC8vIFRoaXMgZGVjb2RlIGZ1bmN0aW9uIGlzbid0IHRha2luZyBpbnRvIGNvbnNp
ZGVyYXRpb24gdGhlIGFib3ZlCiAgLy8gbW9kaWZpY2F0aW9ucyB0byB0aGUgZW5jb2Rpbmcg
cHJvY2Vzcy4gSG93ZXZlciwgdGhpcyBtZXRob2QgZG9lc24ndAogIC8vIHNlZW0gdG8gYmUg
dXNlZCBhbnl3aGVyZSBzbyBsZWF2aW5nIGl0IGFzIGlzLgogIHB1YmxpYyBzdGF0aWMgZnVu
Y3Rpb24gdXJsZGVjb2RlX3JmYzM5ODYoJHN0cmluZykgewogICAgcmV0dXJuIHVybGRlY29k
ZSgkc3RyaW5nKTsKICB9CgogIC8vIFV0aWxpdHkgZnVuY3Rpb24gZm9yIHR1cm5pbmcgdGhl
IEF1dGhvcml6YXRpb246IGhlYWRlciBpbnRvCiAgLy8gcGFyYW1ldGVycywgaGFzIHRvIGRv
IHNvbWUgdW5lc2NhcGluZwogIC8vIENhbiBmaWx0ZXIgb3V0IGFueSBub24tb2F1dGggcGFy
YW1ldGVycyBpZiBuZWVkZWQgKGRlZmF1bHQgYmVoYXZpb3VyKQogIHB1YmxpYyBzdGF0aWMg
ZnVuY3Rpb24gc3BsaXRfaGVhZGVyKCRoZWFkZXIsICRvbmx5X2FsbG93X29hdXRoX3BhcmFt
ZXRlcnMgPSB0cnVlKSB7CiAgICAkcGF0dGVybiA9ICcvKChbLV9hLXpdKik9KCIoW14iXSop
InwoW14sXSopKSw/KS8nOwogICAgJG9mZnNldCA9IDA7CiAgICAkcGFyYW1zID0gYXJyYXko
KTsKICAgIHdoaWxlIChwcmVnX21hdGNoKCRwYXR0ZXJuLCAkaGVhZGVyLCAkbWF0Y2hlcywg
UFJFR19PRkZTRVRfQ0FQVFVSRSwgJG9mZnNldCkgPiAwKSB7CiAgICAgICRtYXRjaCA9ICRt
YXRjaGVzWzBdOwogICAgICAkaGVhZGVyX25hbWUgPSAkbWF0Y2hlc1syXVswXTsKICAgICAg
JGhlYWRlcl9jb250ZW50ID0gKGlzc2V0KCRtYXRjaGVzWzVdKSkgPyAkbWF0Y2hlc1s1XVsw
XSA6ICRtYXRjaGVzWzRdWzBdOwogICAgICBpZiAocHJlZ19tYXRjaCgnL15vYXV0aF8vJywg
JGhlYWRlcl9uYW1lKSB8fCAhJG9ubHlfYWxsb3dfb2F1dGhfcGFyYW1ldGVycykgewogICAg
ICAgICRwYXJhbXNbJGhlYWRlcl9uYW1lXSA9IE9BdXRoVXRpbDo6dXJsZGVjb2RlX3JmYzM5
ODYoJGhlYWRlcl9jb250ZW50KTsKICAgICAgfQogICAgICAkb2Zmc2V0ID0gJG1hdGNoWzFd
ICsgc3RybGVuKCRtYXRjaFswXSk7CiAgICB9CgogICAgaWYgKGlzc2V0KCRwYXJhbXNbJ3Jl
YWxtJ10pKSB7CiAgICAgIHVuc2V0KCRwYXJhbXNbJ3JlYWxtJ10pOwogICAgfQoKICAgIHJl
dHVybiAkcGFyYW1zOwogIH0KCiAgLy8gaGVscGVyIHRvIHRyeSB0byBzb3J0IG91dCBoZWFk
ZXJzIGZvciBwZW9wbGUgd2hvIGFyZW4ndCBydW5uaW5nIGFwYWNoZQogIHB1YmxpYyBzdGF0
aWMgZnVuY3Rpb24gZ2V0X2hlYWRlcnMoKSB7CiAgICBpZiAoZnVuY3Rpb25fZXhpc3RzKCdh
cGFjaGVfcmVxdWVzdF9oZWFkZXJzJykpIHsKICAgICAgLy8gd2UgbmVlZCB0aGlzIHRvIGdl
dCB0aGUgYWN0dWFsIEF1dGhvcml6YXRpb246IGhlYWRlcgogICAgICAvLyBiZWNhdXNlIGFw
YWNoZSB0ZW5kcyB0byB0ZWxsIHVzIGl0IGRvZXNuJ3QgZXhpc3QKICAgICAgJGhlYWRlcnMg
PSBhcGFjaGVfcmVxdWVzdF9oZWFkZXJzKCk7CgogICAgICAvLyBzYW5pdGl6ZSB0aGUgb3V0
cHV0IG9mIGFwYWNoZV9yZXF1ZXN0X2hlYWRlcnMgYmVjYXVzZQogICAgICAvLyB3ZSBhbHdh
eXMgd2FudCB0aGUga2V5cyB0byBiZSBDYXNlZC1MaWtlLVRoaXMgYW5kIGFyaCgpCiAgICAg
IC8vIHJldHVybnMgdGhlIGhlYWRlcnMgaW4gdGhlIHNhbWUgY2FzZSBhcyB0aGV5IGFyZSBp
biB0aGUKICAgICAgLy8gcmVxdWVzdAogICAgICAkb3V0ID0gYXJyYXkoKTsKICAgICAgZm9y
ZWFjaCggJGhlYWRlcnMgQVMgJGtleSA9PiAkdmFsdWUgKSB7CiAgICAgICAgJGtleSA9IHN0
cl9yZXBsYWNlKAogICAgICAgICAgICAiICIsCiAgICAgICAgICAgICItIiwKICAgICAgICAg
ICAgdWN3b3JkcyhzdHJ0b2xvd2VyKHN0cl9yZXBsYWNlKCItIiwgIiAiLCAka2V5KSkpCiAg
ICAgICAgICApOwogICAgICAgICRvdXRbJGtleV0gPSAkdmFsdWU7CiAgICAgIH0KICAgIH0g
ZWxzZSB7CiAgICAgIC8vIG90aGVyd2lzZSB3ZSBkb24ndCBoYXZlIGFwYWNoZSBhbmQgYXJl
IGp1c3QgZ29pbmcgdG8gaGF2ZSB0byBob3BlCiAgICAgIC8vIHRoYXQgJF9TRVJWRVIgYWN0
dWFsbHkgY29udGFpbnMgd2hhdCB3ZSBuZWVkCiAgICAgICRvdXQgPSBhcnJheSgpOwogICAg
ICBpZiggaXNzZXQoJF9TRVJWRVJbJ0NPTlRFTlRfVFlQRSddKSApCiAgICAgICAgJG91dFsn
Q29udGVudC1UeXBlJ10gPSAkX1NFUlZFUlsnQ09OVEVOVF9UWVBFJ107CiAgICAgIGlmKCBp
c3NldCgkX0VOVlsnQ09OVEVOVF9UWVBFJ10pICkKICAgICAgICAkb3V0WydDb250ZW50LVR5
cGUnXSA9ICRfRU5WWydDT05URU5UX1RZUEUnXTsKCiAgICAgIGZvcmVhY2ggKCRfU0VSVkVS
IGFzICRrZXkgPT4gJHZhbHVlKSB7CiAgICAgICAgaWYgKHN1YnN0cigka2V5LCAwLCA1KSA9
PSAiSFRUUF8iKSB7CiAgICAgICAgICAvLyB0aGlzIGlzIGNoYW9zLCBiYXNpY2FsbHkgaXQg
aXMganVzdCB0aGVyZSB0byBjYXBpdGFsaXplIHRoZSBmaXJzdAogICAgICAgICAgLy8gbGV0
dGVyIG9mIGV2ZXJ5IHdvcmQgdGhhdCBpcyBub3QgYW4gaW5pdGlhbCBIVFRQIGFuZCBzdHJp
cCBIVFRQCiAgICAgICAgICAvLyBjb2RlIGZyb20gcHJ6ZW1lawogICAgICAgICAgJGtleSA9
IHN0cl9yZXBsYWNlKAogICAgICAgICAgICAiICIsCiAgICAgICAgICAgICItIiwKICAgICAg
ICAgICAgdWN3b3JkcyhzdHJ0b2xvd2VyKHN0cl9yZXBsYWNlKCJfIiwgIiAiLCBzdWJzdHIo
JGtleSwgNSkpKSkKICAgICAgICAgICk7CiAgICAgICAgICAkb3V0WyRrZXldID0gJHZhbHVl
OwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuICRvdXQ7CiAgfQoKICAvLyBU
aGlzIGZ1bmN0aW9uIHRha2VzIGEgaW5wdXQgbGlrZSBhPWImYT1jJmQ9ZSBhbmQgcmV0dXJu
cyB0aGUgcGFyc2VkCiAgLy8gcGFyYW1ldGVycyBsaWtlIHRoaXMKICAvLyBhcnJheSgnYScg
PT4gYXJyYXkoJ2InLCdjJyksICdkJyA9PiAnZScpCiAgcHVibGljIHN0YXRpYyBmdW5jdGlv
biBwYXJzZV9wYXJhbWV0ZXJzKCAkaW5wdXQgKSB7CiAgICBpZiAoIWlzc2V0KCRpbnB1dCkg
fHwgISRpbnB1dCkgcmV0dXJuIGFycmF5KCk7CgogICAgJHBhaXJzID0gZXhwbG9kZSgnJics
ICRpbnB1dCk7CgogICAgJHBhcnNlZF9wYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgIGZvcmVh
Y2ggKCRwYWlycyBhcyAkcGFpcikgewogICAgICAkc3BsaXQgPSBleHBsb2RlKCc9JywgJHBh
aXIsIDIpOwogICAgICAkcGFyYW1ldGVyID0gT0F1dGhVdGlsOjp1cmxkZWNvZGVfcmZjMzk4
Nigkc3BsaXRbMF0pOwogICAgICAkdmFsdWUgPSBpc3NldCgkc3BsaXRbMV0pID8gT0F1dGhV
dGlsOjp1cmxkZWNvZGVfcmZjMzk4Nigkc3BsaXRbMV0pIDogJyc7CgogICAgICBpZiAoaXNz
ZXQoJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdKSkgewogICAgICAgIC8vIFdlIGhh
dmUgYWxyZWFkeSByZWNpZXZlZCBwYXJhbWV0ZXIocykgd2l0aCB0aGlzIG5hbWUsIHNvIGFk
ZCB0byB0aGUgbGlzdAogICAgICAgIC8vIG9mIHBhcmFtZXRlcnMgd2l0aCB0aGlzIG5hbWUK
CiAgICAgICAgaWYgKGlzX3NjYWxhcigkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl0p
KSB7CiAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCBkdXBsaWNhdGUsIHNvIHRyYW5z
Zm9ybSBzY2FsYXIgKHN0cmluZykgaW50byBhbiBhcnJheQogICAgICAgICAgLy8gc28gd2Ug
Y2FuIGFkZCB0aGUgZHVwbGljYXRlcwogICAgICAgICAgJHBhcnNlZF9wYXJhbWV0ZXJzWyRw
YXJhbWV0ZXJdID0gYXJyYXkoJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdKTsKICAg
ICAgICB9CgogICAgICAgICRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXVtdID0gJHZh
bHVlOwogICAgICB9IGVsc2UgewogICAgICAgICRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1l
dGVyXSA9ICR2YWx1ZTsKICAgICAgfQogICAgfQogICAgcmV0dXJuICRwYXJzZWRfcGFyYW1l
dGVyczsKICB9CgogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gYnVpbGRfaHR0cF9xdWVyeSgk
cGFyYW1zKSB7CiAgICBpZiAoISRwYXJhbXMpIHJldHVybiAnJzsKCiAgICAvLyBVcmxlbmNv
ZGUgYm90aCBrZXlzIGFuZCB2YWx1ZXMKICAgICRrZXlzID0gT0F1dGhVdGlsOjp1cmxlbmNv
ZGVfcmZjMzk4NihhcnJheV9rZXlzKCRwYXJhbXMpKTsKICAgICR2YWx1ZXMgPSBPQXV0aFV0
aWw6OnVybGVuY29kZV9yZmMzOTg2KGFycmF5X3ZhbHVlcygkcGFyYW1zKSk7CiAgICAkcGFy
YW1zID0gYXJyYXlfY29tYmluZSgka2V5cywgJHZhbHVlcyk7CgogICAgLy8gUGFyYW1ldGVy
cyBhcmUgc29ydGVkIGJ5IG5hbWUsIHVzaW5nIGxleGljb2dyYXBoaWNhbCBieXRlIHZhbHVl
IG9yZGVyaW5nLgogICAgLy8gUmVmOiBTcGVjOiA5LjEuMSAoMSkKICAgIHVrc29ydCgkcGFy
YW1zLCAnc3RyY21wJyk7CgogICAgJHBhaXJzID0gYXJyYXkoKTsKICAgIGZvcmVhY2ggKCRw
YXJhbXMgYXMgJHBhcmFtZXRlciA9PiAkdmFsdWUpIHsKICAgICAgaWYgKGlzX2FycmF5KCR2
YWx1ZSkpIHsKICAgICAgICAvLyBJZiB0d28gb3IgbW9yZSBwYXJhbWV0ZXJzIHNoYXJlIHRo
ZSBzYW1lIG5hbWUsIHRoZXkgYXJlIHNvcnRlZCBieSB0aGVpciB2YWx1ZQogICAgICAgIC8v
IFJlZjogU3BlYzogOS4xLjEgKDEpCiAgICAgICAgbmF0c29ydCgkdmFsdWUpOwogICAgICAg
IGZvcmVhY2ggKCR2YWx1ZSBhcyAkZHVwbGljYXRlX3ZhbHVlKSB7CiAgICAgICAgICAkcGFp
cnNbXSA9ICRwYXJhbWV0ZXIgLiAnPScgLiAkZHVwbGljYXRlX3ZhbHVlOwogICAgICAgIH0K
ICAgICAgfSBlbHNlIHsKICAgICAgICAkcGFpcnNbXSA9ICRwYXJhbWV0ZXIgLiAnPScgLiAk
dmFsdWU7CiAgICAgIH0KICAgIH0KICAgIC8vIEZvciBlYWNoIHBhcmFtZXRlciwgdGhlIG5h
bWUgaXMgc2VwYXJhdGVkIGZyb20gdGhlIGNvcnJlc3BvbmRpbmcgdmFsdWUgYnkgYW4gJz0n
IGNoYXJhY3RlciAoQVNDSUkgY29kZSA2MSkKICAgIC8vIEVhY2ggbmFtZS12YWx1ZSBwYWly
IGlzIHNlcGFyYXRlZCBieSBhbiAnJicgY2hhcmFjdGVyIChBU0NJSSBjb2RlIDM4KQogICAg
cmV0dXJuIGltcGxvZGUoJyYnLCAkcGFpcnMpOwogIH0KfSI7czozOiJtZDUiO3M6MzI6ImQ1
ZGM4OTE5MTU5NzdlNjU2MDgzNTM0MDhkMjFhMzMyIjt9
