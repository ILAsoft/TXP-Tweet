# arc_twitter v3.0-dev
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjc6
IjMuMC1kZXYiO3M6NjoiYXV0aG9yIjtzOjExOiJBbmR5IENhcnRlciI7czoxMDoiYXV0aG9y
X3VyaSI7czozMToiaHR0cDovL3JlZGhvdGNoaWxsaXByb2plY3QuY29tLyI7czoxMToiZGVz
Y3JpcHRpb24iO3M6NjA6IjxhIGhyZWY9Imh0dHA6Ly93d3cudHdpdHRlci5jb20iPlR3aXR0
ZXI8L2E+IGZvciBUZXh0cGF0dGVybiI7czo1OiJvcmRlciI7czoxOiI1IjtzOjQ6InR5cGUi
O3M6MToiMSI7czo1OiJmbGFncyI7czoxOiIzIjtzOjQ6ImhlbHAiO3M6MTU0NTY6Igk8aDEg
Y2xhc3M9InRpdGxlIj48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCAoYXJj
X3R3aXR0ZXIgZm9yIFRleHRwYXR0ZXJuKTwvaDE+CgoJPG9sPgoJCTxsaT48YSBocmVmPSIj
YXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2Fy
Y190d2l0dGVyX2luc3RhbGxhdGlvbiI+SW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxsYXRpb248
L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3RhZyI+VGhlIGFyY190d2l0
dGVyIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfc2VhcmNoX3Rh
ZyI+VGhlIGFyY190d2l0dGVyX3NlYXJjaCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0i
I2FyY190d2l0dGVyX3JldHdlZXRfdGFnIj5UaGUgYXJjX3R3aXR0ZXJfcmV0d2VldCB0YWc8
L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3R3ZWV0X3VybCI+VGhlIGFy
Y190d2l0dGVyX3R3ZWV0X3VybCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190
d2l0dGVyX3Rpbnl1cmwiPlRoZSBhcmNfdHdpdHRlcl90aW55dXJsIHRhZzwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfY2FjaGluZyI+Q2FjaGluZzwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfcHJlZnMiPlByZWZlcmVuY2VzPC9hPjwvbGk+
CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl9hcnRpY2xlIj5Ud2VldGluZyBhcnRpY2xl
czwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfYWRtaW4iPlRoZSBUd2l0
dGVyIHRhYjwvYT48L2xpPgoJPC9vbD4KCgk8cD48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9z
cGFuPiBUd2VldCBwcm92aWRlcyBhY2Nlc3MgdG8geW91ciBUd2l0dGVyIGFjY291bnQgdGhy
b3VnaCBib3RoIHRoZSBhZG1pbiBpbnRlcmZhY2UgYW5kIHRoZSBwdWJsaWMgc2lkZSBvZiB5
b3VyIHNpdGUuIFVwZGF0ZSBUd2l0dGVyIHdoZW4geW91IHBvc3QgYSBuZXcgYXJ0aWNsZSAo
d2l0aCBhcnRpY2xlLWJ5LWFydGljbGUgb3B0IG91dCBvcHRpb24pLCB1cGRhdGUgYW5kIHZp
ZXcgeW91ciBUd2l0dGVyIGZlZWQgdGhyb3VnaCB0aGUgYWRtaW4gVHdpdHRlciB0YWIsIGFu
ZCBkaXNwbGF5IFR3aXR0ZXIgZmVlZHMgb24geW91ciBzaXRlLjwvcD4KCgk8cD5SZXF1aXJl
bWVudHM6LTwvcD4KCgk8dWw+CgkJPGxpPlRleHRwYXR0ZXJuIDQuMis8L2xpPgoJCTxsaT48
c3BhbiBjbGFzcz0iY2FwcyI+UEhQPC9zcGFuPiA1IGFuZCBjVVJMPC9saT4KCTwvdWw+CgoJ
PGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2gy
PgoKCTxwPjxhIGhyZWY9Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbSI+QW5keSBD
YXJ0ZXI8L2E+LiBGb3Igb3RoZXIgVGV4dHBhdHRlcm4gcGx1Z2lucyBieSBtZSB2aXNpdCBt
eSA8YSBocmVmPSJodHRwOi8vcmVkaG90Y2hpbGxpcHJvamVjdC5jb20vdHhwIj5QbHVnaW5z
IHBhZ2U8L2E+LjwvcD4KCgk8cD5UaGFua3MgdG8gPGEgaHJlZj0iaHR0cDovL21hbmZyZS5u
ZXQvIj5NaWNoYWVsIE1hbmZyZTwvYT4gZm9yIGluc3BpcmF0aW9uIGZvciB0aGUgYXJ0aWNs
ZSB0d2VldCBwYXJ0IG9mIHRoaXMgcGx1Z2luIGJhc2VkIG9uIGhpcyA8c3BhbiBjbGFzcz0i
dGFnIj5tZW1fdHdpdHRlcjwvc3Bhbj4gcGx1Z2luLiAgQWRkaXRpb25hbCB0aGFua3MgdG8g
dGhlIGdyZWF0IFRleHRwYXR0ZXJuIGNvbW11bml0eSBmb3IgaGVscGluZyB0byB0ZXN0IHRo
aXMgcGx1Z2luIGFuZCBmb3Igc3VnZ2VzdGluZyBuZXcgZmVhdHVyZXMuIFRoZSBPQXV0aCBw
YXJ0IG9mIHRoZSBwbHVnaW4gaXMgdGhhbmtzIHRvIDxhIGhyZWY9Imh0dHA6Ly90d2l0dGVy
LmNvbS9hYnJhaGFtIj5BYnJhaGFtIFdpbGxpYW1zPC9hPi48L3A+CgoJPGgyIGNsYXNzPSJz
ZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfaW5zdGFsbGF0aW9uIj5JbnN0YWxsYXRpb24gLyBV
bmluc3RhbGxhdGlvbjwvaDI+CgoJPHA+VG8gaW5zdGFsbCBnbyB0byB0aGUgJiM4MjE2O3Bs
dWdpbnMmIzgyMTc7IHRhYiB1bmRlciAmIzgyMTY7YWRtaW4mIzgyMTc7IGFuZCBwYXN0ZSB0
aGUgcGx1Z2luIGNvZGUgaW50byB0aGUgJiM4MjE2O0luc3RhbGwgcGx1Z2luJiM4MjE3OyBi
b3gsICYjODIxNjt1cGxvYWQmIzgyMTc7IGFuZCB0aGVuICYjODIxNjtpbnN0YWxsJiM4MjE3
Oy4gRmluYWxseSBhY3RpdmF0ZSB0aGUgcGx1Z2luLjwvcD4KCgk8cD5CZWZvcmUgeW91IHN0
YXJ0IHVzaW5nIDxzcGFuIGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiB5b3Ugd2ls
bCBuZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IHRoZSBjYWNoZSBkaXJlY3RvcnkgaXMgd3JpdGFi
bGUuIFNlZSB0aGUgJiM4MjE2O0NhY2hpbmcmIzgyMTc7IHN1YnNlY3Rpb24gYmVsb3cgZm9y
IGZ1cnRoZXIgaW5mb3JtYXRpb24uPC9wPgoKCTxwPjxzcGFuIGNsYXNzPSJ0YWciPmFyY190
d2l0dGVyPC9zcGFuPiBzaG91bGQgbm93IGJlIHJlYWR5IGZvciB1c2Ugb24gdGhlIHB1Ymxp
Yy1zaWRlIG9mIHlvdXIgc2l0ZS48L3A+CgoJPHA+VG8gdW5sb2NrIHRoZSBhZG1pbiBmZWF0
dXJlcyBvZiB0aGlzIHBsdWdpbiB5b3Ugd2lsbCBuZWVkIHRvIGFzc29jaWF0ZSB5b3VyIHNp
dGUgd2l0aCBhIFR3aXR0ZXIgYWNjb3VudCBieSBjb25uZWN0aW5nIHRvIFR3aXR0ZXIgZnJv
bSB0aGUgcGx1Z2luJiM4MjE3O3Mgb3B0aW9ucyBzY3JlZW4uIENsaWNrIG9uIHRoZSBsaW5r
IHRvIGNvbm5lY3QgdG8gVHdpdHRlciwgeW91IHdpbGwgYmUgYXNrZWQgdG8gbG9naW4gdG8g
VHdpdHRlciwgY2xpY2tpbmcgdGhpcyBsaW5rIHdpbGwgdGVtcG9yYXJpbHkgdGFrZSB5b3Ug
dG8gdGhlIFR3aXR0ZXIgc2l0ZSB3aGVyZSB5b3Ugd2lsbCBiZSBhc2tlZCB0byBsb2dpbiBh
bmQgYXBwcm92ZSBhY2Nlc3MgZm9yIDxzcGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3
ZWV0IHRvIHJlYWQgYW5kIHdyaXRlIHRvIHlvdXIgVHdpdHRlciBhY2NvdW50LiBJZiBhbGwg
aXMgc3VjY2Vzc2Z1bCB5b3Ugd2lsbCBiZSByZXR1cm5lZCB0byB0aGUgb3B0aW9ucyBzY3Jl
ZW4gYW5kIHlvdXIgdXNlciBuYW1lIHdpbGwgYXBwZWFyLjwvcD4KCgk8cD5BdCBhbnkgdGlt
ZSB5b3UgY2FuIGRpc2Fzc29jaWF0ZSB5b3VyIFR3aXR0ZXIgYWNjb3VudCB3aXRoIDxzcGFu
IGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0IHZpYSB5b3VyIFR3aXR0ZXIgYWNjb3Vu
dCBwcmVmZXJlbmNlcyBvbiB0aGUgPGEgaHJlZj0iaHR0cDovL3d3dy50d2l0dGVyLmNvbSI+
VHdpdHRlciB3ZWJzaXRlPC9hPi48L3A+CgoJPHA+VG8gdW5pbnN0YWxsIDxzcGFuIGNsYXNz
PSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiBzaW1wbHkgZGVsZXRlIHRoZSBwbHVnaW4gZnJv
bSB0aGUgJiM4MjE2O1BsdWdpbnMmIzgyMTc7IHRhYi4gIFRoaXMgd2lsbCByZW1vdmUgdGhl
IHBsdWdpbiBjb2RlLCBkZWxldGUgcmVsYXRlZCBwcmVmZXJlbmNlcyBhbmQgZHJvcCB0aGUg
PHNwYW4gY2xhc3M9InRhZyI+YXJjX3R3aXR0ZXI8L3NwYW4+IHRhYmxlIGZyb20geW91ciBU
ZXh0cGF0dGVybiBkYXRhYmFzZS48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJj
X3R3aXR0ZXJfdGFnIj5UaGUgYXJjX3R3aXR0ZXIgdGFnPC9oMj4KCgk8aDM+U3ludGF4PC9o
Mz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyIHVzZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZx
dW90OyAvJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0
aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVs
dDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVzZXI8
L3RkPgoJCQk8dGQ+VHdpdHRlciB1c2VyIG5hbWU8L3RkPgoJCQk8dGQ+IDxlbT5hcmNfdHdp
dHRlciB1c2VybmFtZTwvZW0+PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXluaW5q
YSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5saW1pdDwvdGQ+CgkJCTx0ZD5N
YXhpbXVtIG51bWJlciBvZiB0d2VldHMgdG8gZGlzcGxheSAobWF4LiAyMDApPC90ZD4KCQkJ
PHRkPjEwPC90ZD4KCQkJPHRkPmxpbWl0PSZxdW90OzI1JnF1b3Q7PC90ZD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmRhdGVmb3JtYXQ8L3RkPgoJCQk8dGQ+Rm9ybWF0IHRoYXQgdXBkYXRl
IGRhdGVzIHdpbGwgYXBwZWFyIGFzPC90ZD4KCQkJPHRkPiA8ZW0+QXJjaGl2ZSBkYXRlIGZv
cm1hdDwvZW0+PC90ZD4KCQkJPHRkPmRhdGVmb3JtYXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAl
cCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbDwvdGQ+CgkJCTx0ZD5M
YWJlbCBmb3IgdGhlIHRvcCBvZiB0aGUgbGlzdDwvdGQ+CgkJCTx0ZD4gPGVtPm5vIGxhYmVs
PC9lbT48L3RkPgoJCQk8dGQ+bGFiZWw9JnF1b3Q7TXkgVHdpdHRlciB0aW1lbGluZSZxdW90
OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbHRhZzwvdGQ+CgkJCTx0ZD5JbmRl
cGVuZGVudCB3cmFwdGFnIGZvciBsYWJlbDwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48
L3RkPgoJCQk8dGQ+bGFiZWx0YWc9JnF1b3Q7aDMmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRy
PgoJCQk8dGQ+YnJlYWs8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNs
YXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnICh3aXRob3V0IGJyYWNrZXRzKSwg
b3Igc3RyaW5nLCB1c2VkIHRvIHNlcGFyYXRlIHRoZSB1cGRhdGVzPC90ZD4KCQkJPHRkPmxp
PC90ZD4KCQkJPHRkPmJyZWFrPSZxdW90O2JyJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4K
CQkJPHRkPndyYXB0YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNs
YXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVzZWQgYXMgdGhlIHdy
YXB0YWcsIHdpdGhvdXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90
ZD4KCQkJPHRkPndyYXB0YWc9JnF1b3Q7dWwmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJ
CQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNz
PSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgZm9yIHdyYXB0YWc8
L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXI8L3RkPgoJCQk8dGQ+Y2xhc3M9JnF1b3Q7dHdpdHRl
ciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzc19wb3N0ZWQ8L3RkPgoJ
CQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+
PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byBzcGFuIHRhZyBhcm91bmQgcG9z
dGVkIGRhdGU8L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXItcG9zdGVkPC90ZD4KCQk8L3RyPgoJ
PC90YWJsZT4KCgk8aDM+RXhhbXBsZSB1c2FnZTwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdp
dHRlciB1c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDsgbGltaXQ9JnF1b3Q7NSZxdW90
OyB3cmFwdGFnPSZxdW90O3VsJnF1b3Q7IGJyZWFrPSZxdW90O2xpJnF1b3Q7IGRhdGVmb3Jt
YXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAlcCZxdW90OyAvJmd0OzwvcD4KCgk8cD5Qcm9kdWNl
cyBhIGJ1bGxldCBwb2ludCBsaXN0IG9mIHRoZSBsYXN0IDUgVHdpdHRlciB1cGRhdGVzIGZy
b20gZHJtb25rZXluaW5qYSYjODIxNztzIFR3aXR0ZXIgZmVlZCB3aXRoIGEgZGVmaW5lZCBk
YXRlIGZvcm1hdCB0byBvdmVycmlkZSB0aGUgZGVmYXVsdCBhcmNoaXZlIGRhdGUgZm9ybWF0
LjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9zZWFyY2hfdGFn
Ij5UaGUgYXJjX3R3aXR0ZXJfc2VhcmNoIHRhZzwvaDI+CgoJPGgzPlN5bnRheDwvaDM+CgoJ
PHA+Jmx0O3R4cDphcmNfdHdpdHRlcl9zZWFyY2ggaGFzaHRhZ3M9JnF1b3Q7dHhwJnF1b3Q7
IC8mZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0
dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90
aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+c2VhcmNoPC90
ZD4KCQkJPHRkPkNvbW1hIHNlcGFyYXRlZCBsaXN0IG9mIHNlYXJjaCB3b3JkczwvdGQ+CgkJ
CTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+c2VhcmNoPSZxdW90O3R4cCx0ZXh0
cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5oYXNodGFnczwvdGQ+
CgkJCTx0ZD5Db21tYSBzZXBhcmF0ZWQgbGlzdCBvZiBoYXNodGFncyB0byBzZWFyY2ggZm9y
IChub3QgaW5jbHVkaW5nIHRoZSBoYXNoKTwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48
L3RkPgoJCQk8dGQ+aGFzaHRhZ3M9JnF1b3Q7dHhwLHRleHRwYXR0ZXJuJnF1b3Q7PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPnJlcGx5PC90ZD4KCQkJPHRkPlVzZXJuYW1lIG9mIHR3
ZWV0cyBpbiByZXBseSB0bzwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8
dGQ+cmVwbHk9JnF1b3Q7dHdpdHRlciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5tZW50aW9uPC90ZD4KCQkJPHRkPlVzZXJuYW1lIG9mIHVzZXIgbWVudGlvbmVkIGluIHR3
ZWV0cyAoPGk+aS5lLjwvaT4gdHdlZXRzIGNvbnRhaW5pbmcgQHVzZXJuYW1lKTwvdGQ+CgkJ
CTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+bWVudGlvbj0mcXVvdDt0d2l0dGVy
JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxpbWl0PC90ZD4KCQkJPHRkPk1h
eGltdW0gbnVtYmVyIG9mIHR3ZWV0cyB0byBkaXNwbGF5IChtYXguIDIwMCk8L3RkPgoJCQk8
dGQ+MTA8L3RkPgoJCQk8dGQ+bGltaXQ9JnF1b3Q7MjUmcXVvdDs8L3RkPgoJCTwvdHI+CgkJ
PHRyPgoJCQk8dGQ+ZGF0ZWZvcm1hdDwvdGQ+CgkJCTx0ZD5Gb3JtYXQgdGhhdCB1cGRhdGUg
ZGF0ZXMgd2lsbCBhcHBlYXIgYXM8L3RkPgoJCQk8dGQ+IDxlbT5BcmNoaXZlIGRhdGUgZm9y
bWF0PC9lbT48L3RkPgoJCQk8dGQ+ZGF0ZWZvcm1hdD0mcXVvdDslYiAlT2UsICVJOiVNICVw
JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsPC90ZD4KCQkJPHRkPkxh
YmVsIGZvciB0aGUgdG9wIG9mIHRoZSBsaXN0PC90ZD4KCQkJPHRkPiA8ZW0+bm8gbGFiZWw8
L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbHRhZzwvdGQ+CgkJCTx0ZD5J
bmRlcGVuZGVudCB3cmFwdGFnIGZvciBsYWJlbDwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9l
bT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+YnJlYWs8L3RkPgoJCQk8dGQ+PHNwYW4g
Y2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFn
ICh3aXRob3V0IGJyYWNrZXRzKSwgb3Igc3RyaW5nLCB1c2VkIHRvIHNlcGFyYXRlIHRoZSB1
cGRhdGVzPC90ZD4KCQkJPHRkPmxpPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPndyYXB0
YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5I
VE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVzZWQgYXMgdGhlIHdyYXB0YWcsIHdpdGhv
dXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3Bh
biBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGZvciB3
cmFwdGFnPC90ZD4KCQkJPHRkPmFyY190d2l0dGVyX3NlYXJjaDwvdGQ+CgkJPC90cj4KCQk8
dHI+CgkJCTx0ZD5jbGFzc191c2VyPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48
c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFw
cGxpZWQgdG8gc3BhbiB0YWcgYXJvdW5kIHVzZXIgbmFtZTwvdGQ+CgkJCTx0ZD5hcmNfdHdp
dHRlci11c2VyPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzX3Bvc3RlZDwvdGQ+
CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bh
bj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHNwYW4gdGFnIGFyb3VuZCBw
b3N0ZWQgZGF0ZTwvdGQ+CgkJCTx0ZD5hcmNfdHdpdHRlci1wb3N0ZWQ8L3RkPgoJCTwvdHI+
Cgk8L3RhYmxlPgoKCTxoMz5FeGFtcGxlIHVzYWdlPC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190
d2l0dGVyX3NlYXJjaCBzZWFyY2g9JnF1b3Q7cGx1Z2luJnF1b3Q7IGhhc2h0YWdzPSZxdW90
O3R4cCx0ZXh0cGF0dGVybiZxdW90OyBsaW1pdD0mcXVvdDsyNSZxdW90OyAvJmd0OzwvcD4K
Cgk8cD5Qcm9kdWNlcyBhIGxpc3Qgb2YgdHdlZXRzIGNvbnRhaW5pbmcgdGhlIHdvcmQgJiM4
MjE2O3BsdWdpbiYjODIxNzsgYW5kIHRoZSBoYXNodGFncyAmIzgyMTY7I3R4cCYjODIxNzsg
YW5kICYjODIxNjsjdGV4dHBhdHRlcm4mIzgyMTc7LiBUaGUgdGFnIHdpbGwgcmV0dXJuIGEg
bWF4aW11bSBvZiAyNSB0d2VldHMuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFy
Y190d2l0dGVyX3JldHdlZXRfdGFnIj5UaGUgYXJjX3R3aXR0ZXJfcmV0d2VldCB0YWc8L2gy
PgoKCTxoMz5TeW50YXg8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfcmV0d2VldCAv
Jmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRy
aWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+
CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVzZXI8L3RkPgoJ
CQk8dGQ+VHdpdHRlciB1c2VyIG5hbWUgdG8gcXVvdGU8L3RkPgoJCQk8dGQ+IDxlbT5hcmNf
dHdpdHRlciB1c2VybmFtZTwvZW0+PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXlu
aW5qYSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD51cmw8L3RkPgoJCQk8dGQ+
PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+PC9zcGFu
PiB0byByZXR3ZWV0PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnRleHQ8L3RkPgoJCQk8
dGQ+UmV0d2VldCB0ZXh0PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmZvbGxvdzE8L3Rk
PgoJCQk8dGQ+U3VnZ2VzdGVkIFR3aXR0ZXIgYWNjb3VudCB0byBmb2xsb3csIGZvciBleGFt
cGxlIHlvdXIgb3duPC90ZD4KCQkJPHRkPkEgVHdpdHRlciB1c2VyIHRvIHJlY29tbWVuZDwv
dGQ+CgkJCTx0ZD5mb2xsb3cxPSZxdW90O1RleHRwYXR0ZXJuJnF1b3Q7PC90ZD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPmZvbGxvdzI8L3RkPgoJCQk8dGQ+QXMgZm9sbG93MTwvdGQ+CgkJ
CTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFuZzwv
dGQ+CgkJCTx0ZD5MYW5ndWFnZTwvdGQ+CgkJCTx0ZD5lbjwvdGQ+CgkJCTx0ZD5sYW5nPSZx
dW90O2VzJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNvdW50PC90ZD4KCQkJ
PHRkPkNvdW50IGJveCBwb3NpdGlvbiwgb3B0aW9uczogbm9uZSwgaG9yaXpvbnRhbCBvciB2
ZXJ0aWNhbDwvdGQ+CgkJCTx0ZD5ob3Jpem9udGFsPC90ZD4KCQkJPHRkPmNvdW50PSZxdW90
O25vbmUmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aW5jbHVkZV9qczwvdGQ+
CgkJCTx0ZD5XaGV0aGVyIG9yIG5vdCB0byBpbmNsdWRlIHRoZSBKYXZhU2NyaXB0PC90ZD4K
CQkJPHRkPjE8L3RkPgoJCQk8dGQ+aW5jbHVkZV9qcz0mcXVvdDswJnF1b3Q7PC90ZD4KCQk8
L3RyPgoJCTx0cj4KCQkJPHRkPndyYXB0YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNh
cHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVz
ZWQgYXMgdGhlIHdyYXB0YWcsIHdpdGhvdXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51
bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRk
PjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bh
bj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gdGhlIHJldHdlZXQgYnV0dG9uPC90ZD4K
CQkJPHRkPnR3aXR0ZXItc2hhcmUtYnV0dG9uPC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8
aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl90d2VldF91cmwiPmFyY190d2l0
dGVyX3R3ZWV0X3VybDwvaDI+CgoJPHA+UmV0dXJucyB0aGUgPHNwYW4gY2xhc3M9ImNhcHMi
PlVSTDwvc3Bhbj4gb2YgdGhlIFR3aXR0ZXIgc3RhdHVzIGZvciBhbiBhcnRpY2xlLjwvcD4K
Cgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyX3R3ZWV0X3VybCAv
Jmd0OzwvcD4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyX3R3ZWV0X3VybCZndDtMaW5rIHRl
eHQmbHQ7L3R4cDphcmNfdHdpdHRlcl90d2VldF91cmwmZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwv
aDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNj
cmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+aWQ8L3RkPgoJCQk8dGQ+VGV4dHBhdHRlcm4gYXJ0aWNs
ZSBJRDwvdGQ+CgkJCTx0ZD4gPGVtPmN1cnJlbnQgYXJ0aWNsZTwvZW0+PC90ZD4KCQkJPHRk
PmlkPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+dGl0bGU8L3Rk
PgoJCQk8dGQ+VGl0bGUgYXR0cmlidXRlIG9mIHRoZSBsaW5rPC90ZD4KCQkJPHRkPiA8ZW0+
dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0
ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3Nw
YW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHRoZSBsaW5rPC90ZD4KCQkJPHRkPiA8
ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPGgyIGNsYXNzPSJzZWN0
aW9uIiBpZD0iYXJjX3R3aXR0ZXJfdGlueXVybCI+YXJjX3R3aXR0ZXJfdGlueXVybDwvaDI+
CgoJPHA+UmV0dXJucyB0aGUgc2hvcnRlbmVkIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3Nw
YW4+IG9mIHRoZSBhcnRpY2xlIHVzZWQgZm9yIHRoZSBUd2l0dGVyIHVwZGF0ZS48L3A+CgoJ
PGgzPlN5bnRheDwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl90aW55dXJsIC8mZ3Q7
PC9wPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfdGlueXVybCZndDtMaW5rIHRleHQmbHQ7
L3R4cDphcmNfdHdpdHRlcl90aW55dXJsJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0
YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248
L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmlkPC90ZD4KCQkJPHRkPlRleHRwYXR0ZXJuIGFydGljbGUgSUQ8L3Rk
PgoJCQk8dGQ+IDxlbT5jdXJyZW50IGFydGljbGU8L2VtPjwvdGQ+CgkJCTx0ZD5pZD0mcXVv
dDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnRpdGxlPC90ZD4KCQkJPHRk
PlRpdGxlIGF0dHJpYnV0ZSBvZiB0aGUgbGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9l
bT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4g
Y2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFz
cyBhdHRyaWJ1dGUgYXBwbGllZCB0byB0aGUgbGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0
PC9lbT48L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9
ImFyY190d2l0dGVyX2NhY2hpbmciPkNhY2hpbmc8L2gyPgoKCTxwPkluIG9yZGVyIHRvIHBy
ZXZlbnQgZXhjZXNzaXZlIHJlcGVhdGl0aXZlIGNhbGxzIHRvIHRoZSBUd2l0dGVyIHdlYnNp
dGUgaXQgaXMgcmVjb21tZW5kZWQgdG8gY2FjaGUgcmVzdWx0cy4gVHdpdHRlciBsaW1pdHMg
dGhlIG51bWJlciBvZiBjYWxscyB0aHJvdWdoIHRoZSA8c3BhbiBjbGFzcz0iY2FwcyI+QVBJ
PC9zcGFuPiwgYW5kIGNvbnRpbnVvdXMgY2FsbHMgd2lsbCByZXN1bHQgaW4gVHdpdHRlciBj
bG9zaW5nIHRvIGZ1cnRoZXIgcmVxdWVzdHMuIEJ5IGRlZmF1bHQsIGFyY190d2l0dGVyIGNh
Y2hlcyBmb3IgMzAgbWludXRlIGludGVydmFscy48L3A+CgoJPHRhYmxlPgoJCTx0cj4KCQkJ
PHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZh
dWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2Fj
aGluZzwvdGQ+CgkJCTx0ZD4mIzgyMTY7MSYjODIxNzsgdG8gY2FjaGUgZmVlZCwgJiM4MjE2
OzAmIzgyMTc7IHRvIHR1cm4gY2FjaGluZyBvZmYgKG5vdCByZWNvbW1lbmRlZCk8L3RkPgoJ
CQk8dGQ+MTwvdGQ+CgkJCTx0ZD5jYWNoaW5nPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+Y2FjaGVfZGlyPC90ZD4KCQkJPHRkPkFic29sdXRlIHBhdGggdG8g
dGhlIGNhY2hlIGRpcmVjdG9yeSAobXVzdCBiZSB3cml0YWJsZSk8L3RkPgoJCQk8dGQ+IDxl
bT5hcmNfdHdpdHRlciBwcmVmZXJlbmNlczwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJ
PHRkPmNhY2hlX3RpbWU8L3RkPgoJCQk8dGQ+VGltZSBpbiBtaW51dGVzIHRoYXQgdGhlIGNh
Y2hlIGZpbGVzIGFyZSBzdG9yZWQgYmVmb3JlIGJlaW5nIHJlZnJlc2hlZDwvdGQ+CgkJCTx0
ZD41PC90ZD4KCQkJPHRkPmNhY2hlX3RpbWU9JnF1b3Q7MzAmcXVvdDs8L3RkPgoJCTwvdHI+
Cgk8L3RhYmxlPgoKCTxwPlRoZSBhZG1pbiBzaWRlIG9mIHRoaXMgcGx1Z2luIGVuZm9yY2Vz
IGNhY2hpbmcsIGFwYXJ0IGZyb20gd2hlbiBpdCBpcyBwb3N0aW5nIHRvIFR3aXR0ZXIgKDxp
PmUuZy48L2k+IHdoZW4gcG9zdGluZyBvciBkZWxldGluZyBhbiB1cGRhdGUpLjwvcD4KCgk8
aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9wcmVmcyI+UHJlZmVyZW5jZXM8
L2gyPgoKCTxwPllvdSBjYW4gYWNjZXNzIHRoZSBwbHVnaW5zIGNvcmUgcHJlZmVyZW5jZXMg
ZnJvbSBlaXRoZXIgdGhlIFByZWZlcmVuY2VzIG9yIFBsdWdpbnMgdGFicyBpbiBhZG1pbi4g
U2V0dXAgeW91ciBUd2l0dGVyIGFjY291bnQgKHlvdSB3aWxsIGJlIGFza2VkIHRvIGNvbm5l
Y3QgdmlhIFR3aXR0ZXIgYW5kIHRoaXMgbmVlZHMgZG9pbmcgYmVmb3JlIHlvdSBjYW4gdXNl
IHRoZSBwbHVnaW4pIGFuZCBjaGFuZ2UgdGhlIGNhY2hlIGRpcmVjdG9yeSB1c2luZyBhcmNf
dHdpdHRlciYjODIxNztzIHByZWZlcmVuY2VzLiBXaXRob3V0IHByb3ZpZGluZyB5b3VyIGFj
Y291bnQgbG9naW4gZGV0YWlscyB0aGUgYWRtaW4gYXJlYSBmZWF0dXJlcyBvZiB0aGlzIHBs
dWdpbiB3aWxsIGJlIGluYWN0aXZlLjwvcD4KCgk8cD5Zb3UgY2FuIHNlbGVjdCB0aGUgPHNw
YW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4gc2hvcnRlbmVyIG1ldGhvZCB5b3Ugd2FudCB0
byB1c2UgdG8gbGluayBiYWNrIHRvIHlvdXIgYXJ0aWNsZSBvbiBUd2l0dGVyLiBQbGVhc2Ug
bm90ZSB0aGF0IGlmIHlvdSBzZWxlY3Qgc21kX3Nob3J0X3VybCB5b3Ugd2lsbCBuZWVkIHRv
IGhhdmUgaW5zdGFsbGVkIGFuZCBhY3RpdmF0ZWQgdGhlIDxhIGhyZWY9Imh0dHA6Ly90ZXh0
cGF0dGVybi5vcmcvcGx1Z2lucy8xMDk5L3NtZF9zaG9ydF91cmwiPjxzcGFuIGNsYXNzPSJ0
YWciPnNtZF9zaG9ydF91cmw8L3NwYW4+IHBsdWdpbjwvYT4gZGV2ZWxvcGVkIGJ5IFN0ZWYg
RGF3c29uLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9hcnRp
Y2xlIj5Ud2VldGluZyBhcnRpY2xlczwvaDI+CgoJPHA+QnkgZGVmYXVsdCBhcmNfdHdpdHRl
ciB3aWxsIHBvc3QgYW4gdXBkYXRlIHRvIFR3aXR0ZXIgaW5jbHVkaW5nIGEgc2hvcnRlbmVk
IDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+IHRvIHlvdXIgYXJ0aWNsZS4gT25seSBs
aXZlIGFuZCBhY3RpdmUgYXJ0aWNsZXMgd2lsbCBiZSBzZW50IHRvIFR3aXR0ZXIsIDxpPmku
ZS48L2k+IGFydGljbGVzIHBvc3RlZCBpbiB0aGUgZnV0dXJlIG9yIGFzIHN0aWNreSBhcnRp
Y2xlcyB3aWxsIG5vdCBiZSBzZW50LiBJZiB5b3VyIGFydGljbGUgaXMgc3VjY2Vzc2Z1bGx5
IHN1Ym1pdHRlZCB0byBUd2l0dGVyIHRoZSB1cGRhdGUgd2lsbCBhcHBlYXIgaW4gcGxhY2Ug
b2YgdGhlIFR3aXR0ZXIgb3B0aW9uIG9uIHRoZSByaWdodC1oYW5kLXNpZGUgb2YgdGhlIGFy
dGljbGUgZWRpdCBzY3JlZW4uPC9wPgoKCTxwPlR3ZWV0cyBhcmUgc2VudCBpbiB0aGUgZm9s
bG93aW5nIGZvcm1hdDogPGVtPlR3ZWV0IHByZWZpeDwvZW0+IDxlbT5BcnRpY2xlIHRpdGxl
PC9lbT4gPGVtPlNob3J0ZW5lZCA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPjwvZW0+
IDxlbT5Ud2VldCBzdWZmaXg8L2VtPi4gWW91IGNhbiBjaGFuZ2UgdGhlIHByZWZpeCBhbmQg
c3VmZml4IG9uIGFuIGFydGljbGUtYnktYXJ0aWNsZSBiYXNpcyBieSBjaGFuZ2luZyB0aGUg
dHdlZXQgb3B0aW9ucyB1bmRlciAmIzgyMTY7VXBkYXRlIFR3aXR0ZXImIzgyMTc7IG9uIHRo
ZSBhcnRpY2xlIGVkaXRvciBzY3JlZW4uIFRoZSBkZWZhdWx0IDxlbT5Ud2VldCBwcmVmaXg8
L2VtPiBjYW4gYmUgc2V0IHVuZGVyIHRoZSA8c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRl
cjwvc3Bhbj4gcHJlZmVyZW5jZXMgc2NyZWVuICh0aGUgZGVmYXVsdCBvbiBpbnN0YWxsYXRp
b24gaXMgJiM4MjIwO0p1c3QgcG9zdGVkOiYjODIyMTspLjwvcD4KCgk8cD5QbGVhc2Ugbm90
ZSB0aGF0IG9uY2UgYW4gYXJ0aWNsZSBoYXMgYmVlbiB0d2VldGVkIHRoZSB0d2VldCBjYW5u
b3QgYmUgZWRpdGVkLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRl
cl9hZG1pbiI+VGhlIFR3aXR0ZXIgdGFiPC9oMj4KCgk8cD5VbmRlciB0aGUgRXh0ZW5zaW9u
cyB0YWIgKHRoaXMgY2FuIGJlIGNoYW5nZWQgZnJvbSB0aGUgcGx1Z2luJiM4MjE3O3MgcHJl
ZmVyZW5jZSBwYWdlKSBhIG5ldyBUd2l0dGVyIHRhYiBzaG91bGQgYXBwZWFyIG9uY2UgeW91
IGhhdmUgY29ubmVjdGVkIHlvdXIgc2l0ZSB0byB5b3VyIFR3aXR0ZXIgYWNjb3VudC4gRnJv
bSBoZXJlIHlvdSB3aWxsIGJlIGFibGUgdG8gc3VibWl0IG5ldyBUd2l0dGVyIHVwZGF0ZXMs
IHZpZXcgYmFzaWMgYWNjb3VudCBzdGF0aXN0aWNzLCBhbmQgY2hlY2sgb3V0IHlvdXIgcmVj
ZW50IHVwZGF0ZXMgKGluY2x1ZGluZyB0aGUgb3B0aW9uIHRvIGRlbGV0ZSB5b3VyIHR3ZWV0
cykuPC9wPiI7czo0OiJjb2RlIjtzOjczMzc5OiJnbG9iYWwgJHByZWZzLCR0eHBjZmcsJGFy
Y190d2l0dGVyX2NvbnN1bWVyS2V5LCRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiRh
cmNfdHdpdHRlciA9IGFycmF5KCk7CgokYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkgPSAnbktj
WHNsd3paaEJkMGtmS01ldG5QQSc7CiRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCA9ICdD
Nm5TUENMM2VlSEdUQmhLQ2d3ZDlvY2xjdUQwc3JCOFdWa2ZYUVlDNTQnOwoKYWRkX3ByaXZz
KCdwbHVnaW5fcHJlZnMuYXJjX3R3aXR0ZXInLCcxLDInKTsKcmVnaXN0ZXJfY2FsbGJhY2so
J2FyY190d2l0dGVyX2luc3RhbGwnLCdwbHVnaW5fbGlmZWN5Y2xlLmFyY190d2l0dGVyJywg
J2luc3RhbGxlZCcpOwpyZWdpc3Rlcl9jYWxsYmFjaygnYXJjX3R3aXR0ZXJfdW5pbnN0YWxs
JywncGx1Z2luX2xpZmVjeWNsZS5hcmNfdHdpdHRlcicsICdkZWxldGVkJyk7CnJlZ2lzdGVy
X2NhbGxiYWNrKCdhcmNfdHdpdHRlcl9wcmVmcycsJ3BsdWdpbl9wcmVmcy5hcmNfdHdpdHRl
cicpOwoKLyoKICogU2V0dXAgaW5pdGlhbCBwcmVmZXJlbmNlcyBpZiBub3QgaW4gdGhlIHR4
cF9wcmVmcyB0YWJsZS4KICovCmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl91c2Vy
J10pKQogICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3VzZXInLCAnJywgJ2FyY190d2l0dGVy
JywgMSwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX3By
ZWZpeCddKSkKICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfcHJlZml4JywnSnVzdCBwb3N0ZWQ6
JywgJ2FyY190d2l0dGVyJywgMiwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3NldCgkcHJlZnNb
J2FyY190d2l0dGVyX2NhY2hlX2RpciddKSkKICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfY2Fj
aGVfZGlyJywkdHhwY2ZnWyd0eHBhdGgnXS4kcHJlZnNbJ3RlbXBkaXInXSwgJ2FyY190d2l0
dGVyJywgMSwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVy
X3R3ZWV0X2RlZmF1bHQnXSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1
bHQnLCAxLCAnYXJjX3R3aXR0ZXInLCAyLCAneWVzbm9SYWRpbycpOwppZiAoIWlzc2V0KCRw
cmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddKSkKICBzZXRfcHJlZignYXJjX3R3aXR0
ZXJfdXJsX21ldGhvZCcsICd0aW55dXJsJywgJ2FyY190d2l0dGVyJywgMiwKICAgICdhcmNf
dHdpdHRlcl91cmxfbWV0aG9kX3NlbGVjdCcpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3No
b3J0X3VybCddKSkKICBzZXRfcHJlZignYXJjX3Nob3J0X3VybCcsIDAsICdhcmNfdHdpdHRl
cicsIDIsICd5ZXNub1JhZGlvJyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfc2hvcnRfc2l0
ZV91cmwnXSkpCiAgc2V0X3ByZWYoJ2FyY19zaG9ydF9zaXRlX3VybCcsICRwcmVmc1snc2l0
ZXVybCddLCAnYXJjX3R3aXR0ZXInLCAyLCAndGV4dF9pbnB1dCcpOwovLyBNYWtlIHN1cmUg
dGhhdCB0aGUgVHdpdHRlciB0YWIgaGFzIGJlZW4gZGVmaW5lZAppZiAoIWlzc2V0KCRwcmVm
c1snYXJjX3R3aXR0ZXJfdGFiJ10pKSB7CiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3RhYics
ICdleHRlbnNpb25zJywgJ2FyY190d2l0dGVyJywgMiwKICAgICdhcmNfdHdpdHRlcl90YWJf
c2VsZWN0Jyk7CiAgICAkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddID0gJ2V4dGVuc2lvbnMn
Owp9CgovLyBDaGVjayBpZiBhcmNfc2hvcnRfdXJsIGlzIGVuYWJsZWQKaWYgKCRwcmVmc1sn
YXJjX3Nob3J0X3VybCddIHx8ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddPT0n
YXJjX3R3aXR0ZXInKSB7CiAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19zaG9ydF91cmxfcmVk
aXJlY3QnLCAndHhwX2RpZScsIDQwNCk7Cn0KCmlmIChAdHhwaW50ZXJmYWNlID09ICdhZG1p
bicpIHsKICAgIGlmICghZW1wdHkoJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10pCiAgICAg
ICAgJiYgIWVtcHR5KCRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXSkKICAgICAg
ICAmJiAhZW1wdHkoJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKSAp
IHsKCiAgICAgICAgaWYgKCRwcmVmc1snYXJjX3R3aXR0ZXJfdGFiJ10pIHsKICAgICAgICAg
ICAgYWRkX3ByaXZzKCdhcmNfYWRtaW5fdHdpdHRlcicsICcxLDIsMyw0Jyk7CiAgICAgICAg
ICAgIHJlZ2lzdGVyX3RhYigkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddLCAnYXJjX2FkbWlu
X3R3aXR0ZXInLCAnVHdpdHRlcicpOwogICAgICAgICAgICByZWdpc3Rlcl9jYWxsYmFjaygn
YXJjX2FkbWluX3R3aXR0ZXInLCAnYXJjX2FkbWluX3R3aXR0ZXInKTsKICAgICAgICB9Cgog
ICAgICAgIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYXJ0aWNsZV90d2VldCcsICdwaW5nJyk7
CiAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hcnRpY2xlX3R3ZWV0JywgJ2FydGlj
bGUnLCAnZWRpdCcsIDEpOwogICAgICAgIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYXBwZW5k
X3R3aXR0ZXInLCAnYXJ0aWNsZV91aScsICdzdGF0dXMnKTsKICAgIH0KfQoKLyoKICAgIFB1
YmxpYy1zaWRlIGZ1bmN0aW9ucwogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoqLwoKZnVuY3Rpb24gYXJjX3R3
aXR0ZXIoJGF0dHMpCnsKICBnbG9iYWwgJHByZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1lcktl
eSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICBleHRyYWN0KGxBdHRzKGFycmF5
KAogICAgJ3VzZXInICAgICAgPT4gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sCiAgICAn
cGFzc3dvcmQnICA9PiAnJywKICAgICd0aW1lbGluZScgID0+ICd1c2VyJywKICAgICdsaW1p
dCcgICAgID0+ICcxMCcsCiAgICAncmV0d2VldHMnICA9PiBmYWxzZSwKICAgICdkYXRlZm9y
bWF0Jz0+ICRwcmVmc1snYXJjaGl2ZV9kYXRlZm9ybWF0J10sCiAgICAnY2FjaGluZycgICA9
PiAnMScsCiAgICAnY2FjaGVfZGlyJyA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX2NhY2hlX2Rp
ciddLAogICAgJ2NhY2hlX3RpbWUnPT4gJzUnLAogICAgJ2xhYmVsJyAgICAgPT4gJycsCiAg
ICAnbGFiZWx0YWcnICA9PiAnJywKICAgICdicmVhaycgICAgID0+ICdsaScsCiAgICAnd3Jh
cHRhZycgICA9PiAnJywKICAgICdjbGFzcycgICAgID0+IF9fRlVOQ1RJT05fXywKICAgICdj
bGFzc19wb3N0ZWQnID0+IF9fRlVOQ1RJT05fXy4nLXBvc3RlZCcKICAgICksJGF0dHMpKTsK
CiAgJHR3aXQgPSBuZXcgYXJjX1R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAk
YXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQpOwoKICBpZiAoJGNhY2hpbmcpIHsgIC8vIHR1
cm4gb24gY2FjaGluZywgcmVjb21tZW5kZWQgKGRlZmF1bHQpCiAgICAkdHdpdC0+c2V0Q2Fj
aGluZyh0cnVlKTsKICAgICR0d2l0LT5jYWNoZURpcigkY2FjaGVfZGlyKTsKICAgICR0d2l0
LT5jYWNoZVRpbWUoJGNhY2hlX3RpbWUpOwogIH0gZWxzZSB7ICAvLyB0dXJuIG9mZiBjYWNo
aW5nLCBub3QgcmVjb21tZW5kZWQgb3RoZXIgdGhhbiBmb3IgdGVzdGluZwogICAgJHR3aXQt
PnNldENhY2hpbmcoZmFsc2UpOwogIH0KCiAgc3dpdGNoICgkdGltZWxpbmUpIHsKICAgIGNh
c2UgJ2hvbWUnOiBjYXNlICdmcmllbmRzJzoKICAgICAgJHRpbWVsaW5lID0gJ3N0YXR1c2Vz
L2ZyaWVuZHNfdGltZWxpbmUnOyBicmVhazsKICAgIGNhc2UgJ21lbnRpb25zJzoKICAgICAg
JHRpbWVsaW5lID0gJ3N0YXR1c2VzL21lbnRpb25zJzsgYnJlYWs7CiAgICBjYXNlICd1c2Vy
JzogZGVmYXVsdDogJHRpbWVsaW5lID0gJ3N0YXR1c2VzL3VzZXJfdGltZWxpbmUnOwogIH0K
CiAgJG91dCA9IGFycmF5KCk7CiAgJHhtbCA9ICR0d2l0LT5nZXQoJHRpbWVsaW5lCiAgICAs
IGFycmF5KCdzY3JlZW5fbmFtZSc9PiR1c2VyLCdjb3VudCc9PiRsaW1pdCwnaW5jbHVkZV9y
dHMnPT4kcmV0d2VldHMpKTsKICBpZiAoJHhtbCkgewogICAgJHR3ZWV0cyA9IEAkeG1sLT54
cGF0aCgnL3N0YXR1c2VzL3N0YXR1cycpOwogICAgaWYgKCR0d2VldHMpIGZvcmVhY2ggKCR0
d2VldHMgYXMgJHR3ZWV0KSB7CiAgICAgICR0aW1lID0gc3RydG90aW1lKGh0bWxlbnRpdGll
cygkdHdlZXQtPmNyZWF0ZWRfYXQpKTsKICAgICAgJGRhdGUgPSBzYWZlX3N0cmZ0aW1lKCRk
YXRlZm9ybWF0LCR0aW1lKTsKICAgICAgJG91dFtdID0gYXJjX1R3aXR0ZXI6Om1ha2VMaW5r
cyhodG1sZW50aXRpZXMoJHR3ZWV0LT50ZXh0LCBFTlRfUVVPVEVTLCdVVEYtOCcpKQogICAg
ICAgIC4nICcudGFnKGh0bWxlbnRpdGllcygkZGF0ZSksJ3NwYW4nLCcgY2xhc3M9IicuJGNs
YXNzX3Bvc3RlZC4nIicpOwogICAgfQoKICAgIHJldHVybiBkb0xhYmVsKCRsYWJlbCwgJGxh
YmVsdGFnKS5kb1dyYXAoJG91dCwgJHdyYXB0YWcsICRicmVhaywgJGNsYXNzKTsKICB9Cgp9
CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl9zZWFyY2goJGF0dHMpCnsKICAgIGdsb2JhbCAkcHJl
ZnMsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNy
ZXQ7CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgICAndXNlcicgICAgICA9PiAk
cHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSwKICAgICAgICAnc2VhcmNoJyAgICA9PiAnJywK
ICAgICAgICAnaGFzaHRhZ3MnICA9PiAnJywKICAgICAgICAndXNlcicgICAgICA9PiAnJywK
ICAgICAgICAncmVwbHknICAgICA9PiAnJywKICAgICAgICAnbWVudGlvbicgICA9PiAnJywK
ICAgICAgICAnbGltaXQnICAgICA9PiAnMTAnLAogICAgICAgICdsYW5nJyAgICAgID0+ICcn
LAogICAgICAgICdkYXRlZm9ybWF0Jz0+ICRwcmVmc1snYXJjaGl2ZV9kYXRlZm9ybWF0J10s
CiAgICAgICAgJ2NhY2hpbmcnICAgPT4gJzEnLAogICAgICAgICdjYWNoZV9kaXInID0+ICRw
cmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10sCiAgICAgICAgJ2NhY2hlX3RpbWUnPT4g
JzUnLAogICAgICAgICdsYWJlbCcgICAgID0+ICcnLAogICAgICAgICdsYWJlbHRhZycgID0+
ICcnLAogICAgICAgICdicmVhaycgICAgID0+ICdsaScsCiAgICAgICAgJ3dyYXB0YWcnICAg
PT4gJycsCiAgICAgICAgJ2NsYXNzJyAgICAgPT4gX19GVU5DVElPTl9fLAogICAgICAgICdj
bGFzc19wb3N0ZWQnID0+IF9fRlVOQ1RJT05fXy4nLXBvc3RlZCcsCiAgICAgICAgJ2NsYXNz
X3VzZXInICAgPT4gX19GVU5DVElPTl9fLictdXNlcicKICAgICksJGF0dHMpKTsKCiAgICAg
ICAgJHR3aXQgPSBuZXcgYXJjX1R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAg
ICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0KTsKCiAgICAgICAgaWYg
KCRjYWNoaW5nKSB7ICAvLyB0dXJuIG9uIGNhY2hpbmcsIHJlY29tbWVuZGVkIChkZWZhdWx0
KQogICAgICAgICAgICAkdHdpdC0+c2V0Q2FjaGluZyh0cnVlKTsKICAgICAgICAgICAgJHR3
aXQtPmNhY2hlRGlyKCRjYWNoZV9kaXIpOwogICAgICAgICAgICAkdHdpdC0+Y2FjaGVUaW1l
KCRjYWNoZV90aW1lKTsKICAgICAgICB9IGVsc2UgeyAgLy8gdHVybiBvZmYgY2FjaGluZywg
bm90IHJlY29tbWVuZGVkIG90aGVyIHRoYW4gZm9yIHRlc3RpbmcKICAgICAgICAgICAgJHR3
aXQtPnNldENhY2hpbmcoZmFsc2UpOwogICAgICAgIH0KCiAgICAgICAgLy8gY29uc3RydWN0
IHNlYXJjaCBxdWVyeQogICAgICAgIGlmICghZW1wdHkoJHNlYXJjaCkpIHsKICAgICAgICAg
ICAgJHRlcm1zID0gZXhwbG9kZSgnLCcsJHNlYXJjaCk7ICR0ZXJtcyA9IGFycmF5X21hcCgn
dHJpbScsJHRlcm1zKTsKICAgICAgICAgICAgJHNlYXJjaCA9IGltcGxvZGUoJyAnLCR0ZXJt
cyk7CiAgICAgICAgfQogICAgICAgIGlmICgkaGFzaHRhZ3MpIHsKICAgICAgICAgICAgJGhh
c2hlcyA9IGV4cGxvZGUoJywnLCRoYXNodGFncyk7ICRoYXNoZXMgPSBhcnJheV9tYXAoJ3Ry
aW0nLCRoYXNoZXMpOwogICAgICAgICAgICAkc2VhcmNoLj0gKCgkc2VhcmNoKT8nICc6Jycp
LicjJy5pbXBsb2RlKCcgIycsJGhhc2hlcyk7CiAgICAgICAgfQogICAgICAgIGlmICgkcmVw
bHkpIHsKICAgICAgICAgICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/JyAnOicnKS4ndG86Jy50
cmltKCRyZXBseSk7CiAgICAgICAgfQogICAgICAgIGlmICgkdXNlcikgewogICAgICAgICAg
ICAkc2VhcmNoLj0gKCgkc2VhcmNoKT8nICc6JycpLidmcm9tOicudHJpbSgkdXNlcik7CiAg
ICAgICAgfQogICAgICAgIGlmICgkbWVudGlvbikgewogICAgICAgICAgICAkc2VhcmNoLj0g
KCgkc2VhcmNoKT8nICc6JycpLidAJy50cmltKCRtZW50aW9uKTsKICAgICAgICB9CgogICAg
ICAgIGlmIChlbXB0eSgkc2VhcmNoKSkgewogICAgICAgICAgICByZXR1cm4gJyc7CiAgICAg
ICAgfSBlbHNlIHsKICAgICAgICAgICAgJHNlYXJjaCA9IHVybGVuY29kZSgkc2VhcmNoKTsK
ICAgICAgICB9CgogICAgICAgICRvdXQgPSBhcnJheSgpOwogICAgICAgICR0d2VldHMgPSAk
dHdpdC0+Z2V0KCdodHRwOi8vc2VhcmNoLnR3aXR0ZXIuY29tL3NlYXJjaC5hdG9tP3E9Jy4k
c2VhcmNoCiAgICAgICAgICAgICwgYXJyYXkoJ3JwcCc9PiRsaW1pdCwnbGFuZyc9PiRsYW5n
KSk7CgogICAgICAgIGlmICgkdHdlZXRzKSB7IGZvcmVhY2ggKCR0d2VldHMtPmVudHJ5IGFz
ICR0d2VldCkgewogICAgICAgICAgICBwcmVnX21hdGNoKCIvKC4qKSBcKCguKilcKS8iLCR0
d2VldC0+YXV0aG9yLT5uYW1lLCRtYXRjaGVzKTsKICAgICAgICAgICAgbGlzdCgkYXV0aG9y
LCR1bmFtZSwkbmFtZSkgPSAkbWF0Y2hlczsKICAgICAgICAgICAgJHRpbWUgPSBzdHJ0b3Rp
bWUoaHRtbGVudGl0aWVzKCR0d2VldC0+cHVibGlzaGVkKSk7CiAgICAgICAgICAgICRkYXRl
ID0gc2FmZV9zdHJmdGltZSgkZGF0ZWZvcm1hdCwkdGltZSk7CiAgICAgICAgICAgICR0ZXh0
ID0gJHR3ZWV0LT50aXRsZTsKICAgICAgICAgICAgJG91dFtdID0gdGFnKGhyZWYoaHRtbGVu
dGl0aWVzKCR1bmFtZSksJHR3ZWV0LT5hdXRob3ItPnVyaSwKICAgICAgICAgICAgICAgICcg
dGl0bGU9IicuaHRtbGVudGl0aWVzKCRuYW1lKS4nIicpLic6ICcsJ3NwYW4nCiAgICAgICAg
ICAgICAgICAgICAgLCcgY2xhc3M9IicuJGNsYXNzX3VzZXIuJyInKQogICAgICAgICAgICAg
ICAgLmFyY19Ud2l0dGVyOjptYWtlTGlua3MoaHRtbGVudGl0aWVzKCR0ZXh0LCBFTlRfUVVP
VEVTLCdVVEYtOCcpKQogICAgICAgICAgICAgICAgLicgJy50YWcoaHRtbGVudGl0aWVzKCRk
YXRlKSwnc3BhbicKICAgICAgICAgICAgICAgICAgICAsJyBjbGFzcz0iJy4kY2xhc3NfcG9z
dGVkLiciJyk7CiAgICAgICAgfSByZXR1cm4gZG9MYWJlbCgkbGFiZWwsICRsYWJlbHRhZykK
ICAgICAgICAgICAgLmRvV3JhcCgkb3V0LCAkd3JhcHRhZywgJGJyZWFrLCAkY2xhc3MpOyB9
Cgp9CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl90d2VldCgkYXR0cykgewogICAgZ2xvYmFsICR0
aGlzYXJ0aWNsZTsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAnaWQnICAgICAg
ICA9PiAkdGhpc2FydGljbGVbJ3RoaXNpZCddLAogICAgICAnaW5jbHVkZV91cmwnICAgPT4g
dHJ1ZQogICAgKSwkYXR0cykpOwoKICAgIGlmICgkaWQpIHsKICAgICAgLy8gRmV0Y2ggYXJj
X3R3aXR0ZXIgc3R1ZmYgdG8gYnVpbGQgdHdlZXQgZnJvbQogICAgICAkdHdlZXQgPSAoJGlu
Y2x1ZGVfdXJsKSA/IHNhZmVfcm93KCJ0d2VldCIsICdhcmNfdHdpdHRlcicsICJhcnRpY2xl
X2lkPXskaWR9IikKICAgICAgICA6IHNhZmVfcm93KCJSRVBMQUNFKHR3ZWV0LENPTkNBVCgn
ICcsdGlueXVybCksJycpIEFTIHR3ZWV0IgogICAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAi
YXJ0aWNsZV9pZD17JGlkfSIpOwogICAgfQoKICAgIGlmICgkdHdlZXRbJ3R3ZWV0J10pIHsK
ICAgICAgcmV0dXJuIGFyY19Ud2l0dGVyOjptYWtlTGlua3MoCiAgICAgICAgaHRtbGVudGl0
aWVzKCR0d2VldFsndHdlZXQnXSwgRU5UX1FVT1RFUywnVVRGLTgnKSk7CiAgICB9Cn0KCmZ1
bmN0aW9uIGFyY190d2l0dGVyX3R3ZWV0X3VybCgkYXR0cywgJHRoaW5nPW51bGwpIHsKICAg
IGdsb2JhbCAkdGhpc2FydGljbGUsJHByZWZzOwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXko
CiAgICAgICdpZCcgICAgICA9PiAkdGhpc2FydGljbGVbJ3RoaXNpZCddLAogICAgICAndGl0
bGUnICAgPT4gJycsCiAgICAgICdjbGFzcycgICA9PiAnJwogICAgKSwkYXR0cykpOwoKICAg
IGlmICgkaWQpIHsKICAgICAgLy8gRmV0Y2ggYXJjX3R3aXR0ZXIgc3R1ZmYgdG8gYnVpbGQg
dHdlZXQgZnJvbQogICAgICAkdHdlZXQgPSBzYWZlX3JvdygidHdlZXRfaWQiCiAgICAgICAg
LCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlkfSIpOwogICAgfQoKICAgIGlmICgk
dHdlZXRbJ3R3ZWV0X2lkJ10pIHsKICAgICAgJHVybCA9ICJodHRwOi8vdHdpdHRlci5jb20v
Ii4kcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXS4iL3N0YXR1cy8iLiR0d2VldFsndHdlZXRf
aWQnXTsKICAgICAgaWYgKCR0aGluZz09PW51bGwpIHsKICAgICAgICByZXR1cm4gJHVybDsK
ICAgICAgfQogICAgICByZXR1cm4gaHJlZihwYXJzZSgkdGhpbmcpLCAkdXJsLAogICAgICAg
ICgkdGl0bGUgPyAnIHRpdGxlPSInLiR0aXRsZS4nIicgOiAnJykKICAgICAgICAuKCRjbGFz
cyA/ICcgY2xhc3M9IicuJGNsYXNzLiciJyA6ICcnKSk7CiAgICB9Cn0KCmZ1bmN0aW9uIGFy
Y190d2l0dGVyX3Rpbnl1cmwoJGF0dHMsICR0aGluZz1udWxsKSB7CiAgICBnbG9iYWwgJHRo
aXNhcnRpY2xlOwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICdpZCcgICAgICA9
PiAkdGhpc2FydGljbGVbJ3RoaXNpZCddLAogICAgICAndGl0bGUnICAgPT4gJycsCiAgICAg
ICdjbGFzcycgICA9PiAnJwogICAgKSwkYXR0cykpOwoKICAgIGlmICgkaWQpIHsKICAgICAg
Ly8gRmV0Y2ggYXJjX3R3aXR0ZXIgc3R1ZmYgdG8gYnVpbGQgdHdlZXQgZnJvbQogICAgICAk
dHdlZXQgPSBzYWZlX3JvdygidGlueXVybCIKICAgICAgICAsICdhcmNfdHdpdHRlcicsICJh
cnRpY2xlX2lkPXskaWR9Iik7CiAgICB9CgogICAgaWYgKCR0d2VldFsndGlueXVybCddKSB7
CiAgICAgIGlmICgkdGhpbmc9PT1udWxsKSB7CiAgICAgICAgcmV0dXJuICR0d2VldFsndGlu
eXVybCddOwogICAgICB9CgogICAgICByZXR1cm4gaHJlZihwYXJzZSgkdGhpbmcpLCAkdHdl
ZXRbJ3Rpbnl1cmwnXSwKICAgICAgICAoJHRpdGxlID8gJyB0aXRsZT0iJy4kdGl0bGUuJyIn
IDogJycpCiAgICAgICAgLigkY2xhc3MgPyAnIGNsYXNzPSInLiRjbGFzcy4nIicgOiAnJykp
OwogICAgfQp9CgpmdW5jdGlvbiBfYXJjX3R3aXR0ZXJfd2lkZ2V0X2pzKCkKewogIGdsb2Jh
bCAkYXJjX3R3aXR0ZXI7CgogIC8vIENoZWNrIGlmIHdpZGdldCBKUyBoYXMgYWxyZWFkeSBi
ZWVuIG91dHB1dAogIGlmICgkYXJjX3R3aXR0ZXJbJ3dpZGdldF9qcyddKSByZXR1cm47Cgog
ICRqcyA9IDw8PEpTCjxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KKGZ1bmN0aW9u
KCkgewogIGlmICh3aW5kb3cuX190d2l0dGVySW50ZW50SGFuZGxlcikgcmV0dXJuOwogIHZh
ciBpbnRlbnRSZWdleCA9IC90d2l0dGVyXC5jb20oXDpcZHsyLDR9KT9cL2ludGVudFwvKFx3
KykvLAogICAgICB3aW5kb3dPcHRpb25zID0gJ3Njcm9sbGJhcnM9eWVzLHJlc2l6YWJsZT15
ZXMsdG9vbGJhcj1ubyxsb2NhdGlvbj15ZXMnLAogICAgICB3aWR0aCA9IDU1MCwKICAgICAg
aGVpZ2h0ID0gNDIwLAogICAgICB3aW5IZWlnaHQgPSBzY3JlZW4uaGVpZ2h0LAogICAgICB3
aW5XaWR0aCA9IHNjcmVlbi53aWR0aDsKCiAgZnVuY3Rpb24gaGFuZGxlSW50ZW50KGUpIHsK
ICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsKICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldCB8
fCBlLnNyY0VsZW1lbnQsCiAgICAgICAgbSwgbGVmdCwgdG9wOwoKICAgIHdoaWxlICh0YXJn
ZXQgJiYgdGFyZ2V0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgIT09ICdhJykgewogICAgICB0
YXJnZXQgPSB0YXJnZXQucGFyZW50Tm9kZTsKICAgIH0KCiAgICBpZiAodGFyZ2V0ICYmIHRh
cmdldC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnYScgJiYgdGFyZ2V0LmhyZWYpIHsK
ICAgICAgbSA9IHRhcmdldC5ocmVmLm1hdGNoKGludGVudFJlZ2V4KTsKICAgICAgaWYgKG0p
IHsKICAgICAgICBsZWZ0ID0gTWF0aC5yb3VuZCgod2luV2lkdGggLyAyKSAtICh3aWR0aCAv
IDIpKTsKICAgICAgICB0b3AgPSAwOwoKICAgICAgICBpZiAod2luSGVpZ2h0ID4gaGVpZ2h0
KSB7CiAgICAgICAgICB0b3AgPSBNYXRoLnJvdW5kKCh3aW5IZWlnaHQgLyAyKSAtIChoZWln
aHQgLyAyKSk7CiAgICAgICAgfQoKICAgICAgICB3aW5kb3cub3Blbih0YXJnZXQuaHJlZiwg
J2ludGVudCcsIHdpbmRvd09wdGlvbnMgKyAnLHdpZHRoPScgKyB3aWR0aCArCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLGhlaWdodD0nICsgaGVpZ2h0
ICsgJyxsZWZ0PScgKyBsZWZ0ICsgJyx0b3A9JyArIHRvcCk7CiAgICAgICAgZS5yZXR1cm5W
YWx1ZSA9IGZhbHNlOwogICAgICAgIGUucHJldmVudERlZmF1bHQgJiYgZS5wcmV2ZW50RGVm
YXVsdCgpOwogICAgICB9CiAgICB9CiAgfQoKICBpZiAoZG9jdW1lbnQuYWRkRXZlbnRMaXN0
ZW5lcikgewogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVJ
bnRlbnQsIGZhbHNlKTsKICB9IGVsc2UgaWYgKGRvY3VtZW50LmF0dGFjaEV2ZW50KSB7CiAg
ICBkb2N1bWVudC5hdHRhY2hFdmVudCgnb25jbGljaycsIGhhbmRsZUludGVudCk7CiAgfQog
IHdpbmRvdy5fX3R3aXR0ZXJJbnRlbnRIYW5kbGVyID0gdHJ1ZTsKfSgpKTsKPC9zY3JpcHQ+
CkpTOwogICRhcmNfdHdpdHRlclsnd2lkZ2V0X2pzJ10gPSB0cnVlOwogIHJldHVybiAkanM7
Cn0KCi8vIERlcHJlY2F0ZWQgYXJjX3R3aXR0ZXJfcmV0d2VldCB0YWcsIHVzZSBhcmNfdHdp
dHRlcl90d2VldF9idXR0b24gaW5zdGVhZApmdW5jdGlvbiBhcmNfdHdpdHRlcl9yZXR3ZWV0
KCRhdHRzLCAkdGhpbmc9bnVsbCkKewogIHJldHVybiBhcmNfdHdpdHRlcl90d2VldF9idXR0
b24oJGF0dHMsICR0aGluZz1udWxsKTsKfQpmdW5jdGlvbiBhcmNfdHdpdHRlcl90d2VldF9i
dXR0b24oJGF0dHMsICR0aGluZz1udWxsKQp7CiAgICBnbG9iYWwgJHByZWZzLCRhcmNfdHdp
dHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwogICAgZ2xv
YmFsICR0aGlzYXJ0aWNsZTsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAgICd1
c2VyJyAgICAgID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLCAvLyB2aWEgdXNlciBh
Y2NvdW50CiAgICAgICAgJ3VybCcgICAgICAgPT4gJycsCiAgICAgICAgJ3RleHQnICAgICAg
PT4gJycsCiAgICAgICAgJ2ZvbGxvdzEnICAgPT4gJycsCiAgICAgICAgJ2ZvbGxvdzInICAg
PT4gJycsCiAgICAgICAgJ2xhbmcnICAgICAgPT4gJycsCiAgICAgICAgJ2NvdW50JyAgICAg
PT4gJ2hvcml6b250YWwnLAogICAgICAgICdpbmNsdWRlX2pzJz0+IHRydWUsCiAgICAgICAg
J3dyYXB0YWcnICAgPT4gJycsCiAgICAgICAgJ2NsYXNzJyAgICAgPT4gJ3R3aXR0ZXItc2hh
cmUtYnV0dG9uJwogICAgKSwkYXR0cykpOwoKICAgICRxID0gJyc7IC8vIHF1ZXJ5IHN0cmlu
ZwoKICAgIGlmICgkaWQ9JHRoaXNhcnRpY2xlWyd0aGlzaWQnXSkgewogICAgICAvLyBGZXRj
aCBhcmNfdHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBmcm9tCiAgICAgICRyb3cgPSBz
YWZlX3JvdygiUkVQTEFDRSh0d2VldCxDT05DQVQoJyAnLHRpbnl1cmwpLCcnKSBBUyB0d2Vl
dCx0aW55dXJsIgogICAgICAgICwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0i
KTsKCiAgICAgIGlmICgkdXJsPT0nJykgewogICAgICAgICR1cmwgPSAoJHVybCkgPyAkdXJs
IDogcGVybWxpbmt1cmwoJHRoaXNhcnRpY2xlKTsKICAgICAgICAkcSA9ICd1cmw9Jy51cmxl
bmNvZGUoJHVybCk7CiAgICAgIH0KICAgICAgaWYgKCR0ZXh0PT0nJykgewogICAgICAgICR0
ZXh0ID0gKCRyb3dbJ3R3ZWV0J10pID8gJHJvd1sndHdlZXQnXSA6ICR0aGlzYXJ0aWNsZVsn
dGl0bGUnXTsKICAgICAgfQogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLid0ZXh0
PScudXJsZW5jb2RlKCR0ZXh0KTsKICAgIH0KICAgIGlmICgkdXNlcikgewogICAgICAkcSAu
PSAoJHEgPyAnJmFtcDsnIDogJycpLid2aWE9Jy51cmxlbmNvZGUoJHVzZXIpOwogICAgfQog
ICAgaWYgKCRmb2xsb3cxJiYkZm9sbG93MikgewogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsn
IDogJycpLidyZWxhdGVkPScudXJsZW5jb2RlKCRmb2xsb3cxLic6Jy4kZm9sbG93Mik7CiAg
ICB9IGVsc2VpZiAoJGZvbGxvdzF8fCRmb2xsb3cyKSB7CiAgICAgICRxIC49ICgkcSA/ICcm
YW1wOycgOiAnJykuJ3JlbGF0ZWQ9Jy51cmxlbmNvZGUoJGZvbGxvdzEuJGZvbGxvdzIpOwog
ICAgfQoKICAgIHN3aXRjaCAoJGxhbmcpIHsKICAgICAgY2FzZSAnZnInOiBicmVhazsgY2Fz
ZSAnZGUnOiBicmVhazsgY2FzZSAnZXMnOiBicmVhazsgY2FzZSAnanAnOiBicmVhazsKICAg
ICAgZGVmYXVsdDoKICAgICAgICAkbGFuZyA9ICdlbic7CiAgICB9CiAgICAkcSAuPSAoJHEg
PyAnJmFtcDsnIDogJycpLidsYW5nPScudXJsZW5jb2RlKCRsYW5nKTsKCiAgICBzd2l0Y2gg
KCRjb3VudCkgewogICAgICBjYXNlICdub25lJzogYnJlYWs7IGNhc2UgJ3ZlcnRpY2FsJzog
YnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgJGNvdW50ID0gJ2hvcml6b250YWwnOwog
ICAgfQogICAgJHEgLj0gKCRxID8gJyZhbXA7JyA6ICcnKS4nY291bnQ9Jy51cmxlbmNvZGUo
JGNvdW50KTsKCiAgICAkdGhpbmcgPSAoJHRoaW5nPT09bnVsbCkgPyAnVHdlZXQnIDogcGFy
c2UoJHRoaW5nKTsKCiAgICAkaHRtbCA9IGhyZWYoJHRoaW5nLCdodHRwOi8vdHdpdHRlci5j
b20vc2hhcmU/Jy4kcQogICAgICAsICcgY2xhc3M9IicuJGNsYXNzLiciJyk7CgogICAgJGpz
ID0gKCRpbmNsdWRlX2pzKSA/CiAgICAgICc8c2NyaXB0IHNyYz0iaHR0cDovL3BsYXRmb3Jt
LnR3aXR0ZXIuY29tL3dpZGdldHMuanMiIHR5cGU9InRleHQvamF2YXNjcmlwdCI+PC9zY3Jp
cHQ+JwogICAgICA6ICcnOwoKICAgIHJldHVybiAkanMuJGh0bWw7Cn0KCi8qCiAgICBBZG1p
bi1zaWRlIGZ1bmN0aW9ucwogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoqLwoKLy8gSW5zdGFsbGF0aW9uIGZ1
bmN0aW9uIC0gYnVpbGRzIE15U1FMIHRhYmxlCmZ1bmN0aW9uIGFyY190d2l0dGVyX2luc3Rh
bGwoKQp7CgogICAgLy8gRm9yIGZpcnN0IGluc3RhbGwsIGNyZWF0ZSB0YWJsZSBmb3IgdHdl
ZXRzCiAgICAkc3FsID0gIkNSRUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTICIuUEZYLiJhcmNf
dHdpdHRlciAiOwogICAgJHNxbC49ICIoYXJjX3R3aXR0ZXJpZCBJTlRFR0VSIEFVVE9fSU5D
UkVNRU5UIFBSSU1BUlkgS0VZLAogICAgICAgIGFydGljbGVfaWQgSU5URUdFUigxMSksCiAg
ICAgICAgdHdlZXRfaWQgQklHSU5UKDIwKSwKICAgICAgICB0d2VldCBWQVJDSEFSKDE0MCks
CiAgICAgICAgdGlueXVybCBWQVJDSEFSKDMwKSk7IjsKCiAgICBpZiAoIXNhZmVfcXVlcnko
JHNxbCkpIHsKICAgICAgICByZXR1cm4gJ0Vycm9yIC0gdW5hYmxlIHRvIGNyZWF0ZSBhcmNf
dHdpdHRlciB0YWJsZSc7CiAgICB9Cgp9CgovLyBVbmluc3RhbGwgZnVuY3Rpb24gLSBkZWxl
dGVzIE15U1FMIHRhYmxlIGFuZCByZWxhdGVkIHByZWZlcmVuY2VzCmZ1bmN0aW9uIGFyY190
d2l0dGVyX3VuaW5zdGFsbCgpCnsKCiAgICAkc3FsID0gIkRST1AgVEFCTEUgSUYgRVhJU1RT
ICIuUEZYLiJhcmNfdHdpdHRlcjsiOwogICAgaWYgKCFzYWZlX3F1ZXJ5KCRzcWwpKSB7CiAg
ICAgICAgcmV0dXJuICdFcnJvciAtIHVuYWJsZSB0byBkZWxldGUgYXJjX3R3aXR0ZXIgdGFi
bGUnOwogICAgfQoKICAgICRzcWwgPSAiREVMRVRFIEZST00gICIuUEZYLiJ0eHBfcHJlZnMg
V0hFUkUgZXZlbnQ9J2FyY190d2l0dGVyJzsiOwogICAgaWYgKCFzYWZlX3F1ZXJ5KCRzcWwp
KSB7CiAgICAgICAgcmV0dXJuICdFcnJvciAtIHVuYWJsZSB0byBkZWxldGUgYXJjX3R3aXR0
ZXIgcHJlZmVyZW5jZXMnOwogICAgfQoKfQpmdW5jdGlvbiBhcmNfdHdpdHRlcl91cmxfbWV0
aG9kX3NlbGVjdCgkbmFtZSwgJHZhbCkKewogICAgJG1ldGhvZHMgPSBhcnJheSgndGlueXVy
bCcgPT4gJ1Rpbnl1cmwnLAogICAgICAnaXNnZCcgPT4gJ0lzLmdkJywKICAgICAgJ2FyY190
d2l0dGVyJyA9PiAnVFhQIFR3ZWV0JywKICAgICAgJ3NtZCcgPT4gJ3NtZF9zaG9ydF91cmwn
KTsKICAgIHJldHVybiBzZWxlY3RJbnB1dCgkbmFtZSwgJG1ldGhvZHMsICR2YWwpOwp9CmZ1
bmN0aW9uIGFyY190d2l0dGVyX3RhYl9zZWxlY3QoJG5hbWUsICR2YWwpCnsKICAgICR0YWJz
ID0gYXJyYXkoJ2NvbnRlbnQnID0+ICdDb250ZW50JywKICAgICAgICAnZXh0ZW5zaW9ucycg
PT4gJ0V4dGVuc2lvbnMnLAogICAgICAgICcnID0+ICdIaWRkZW4nKTsKICAgIHJldHVybiBz
ZWxlY3RJbnB1dCgkbmFtZSwgJHRhYnMsICR2YWwpOwp9Ci8vIFByb3ZpZGUgaW50ZXJmYWNl
IGZvciBzZXR0aW5nIHByZWZlcmVuY2VzCmZ1bmN0aW9uIGFyY190d2l0dGVyX3ByZWZzKCRl
dmVudCwkc3RlcCkKewoKICAgIGdsb2JhbCAkcHJlZnMsJGFyY190d2l0dGVyX2NvbnN1bWVy
S2V5LCRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiAgICAkdXNlciAgICAgICAgICA9
ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddOwogICAgJHByZWZpeCAgICAgICAgPSAkcHJl
ZnNbJ2FyY190d2l0dGVyX3ByZWZpeCddOwogICAgJHR3ZWV0X2RlZmF1bHQgPSAkcHJlZnNb
J2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnXTsKICAgICR1cmxfbWV0aG9kICAgID0gJHBy
ZWZzWydhcmNfdHdpdHRlcl91cmxfbWV0aG9kJ107CiAgICAkc2hvcnRfdXJsICAgICA9ICRw
cmVmc1snYXJjX3Nob3J0X3VybCddOwogICAgJHNob3J0X3NpdGVfdXJsPSAkcHJlZnNbJ2Fy
Y19zaG9ydF9zaXRlX3VybCddOwogICAgJGNhY2hlX2RpciAgICAgPSAkcHJlZnNbJ2FyY190
d2l0dGVyX2NhY2hlX2RpciddOwogICAgJHRhYiAgICAgICAgICAgPSAkcHJlZnNbJ2FyY190
d2l0dGVyX3RhYiddOwoKICAgIHN3aXRjaCAoJHN0ZXApIHsKICAgICAgICBjYXNlICdwcmVm
c19zYXZlJzogcGFnZXRvcCgnVFhQIFR3ZWV0JywgJ1ByZWZlcmVuY2VzIHNhdmVkJyk7IGJy
ZWFrOwogICAgICAgIGNhc2UgJ3JlZ2lzdGVyJzogcGFnZXRvcCgnVFhQIFR3ZWV0JywnQ29u
bmVjdCB0byBUd2l0dGVyJyk7IGJyZWFrOwogICAgICAgIGNhc2UgJ3ZhbGlkYXRlJzoKICAg
ICAgICBkZWZhdWx0OiBwYWdldG9wKCdUWFAgVHdlZXQnKTsKICAgIH0KCiAgICAkaHRtbCA9
ICcnOwoKICAgIGlmICgkc3RlcD09J3JlZ2lzdGVyJykgeyAvLyBPQXV0aCByZWdpc3RyYXRp
b24gcHJvY2VzcwogICAgICAgICR0d2l0ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRl
cl9jb25zdW1lcktleQogICAgICAgICAgICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3Jl
dCk7CgogICAgICAgIC8vIEJ1aWxkIGEgY2FsbGJhY2sgVVJMIGZvciBUd2l0dGVyIHRvIHJl
dHVybiB0byB0aGUgbmV4dCBzdGFnZQogICAgICAgICRjYWxsYmFja1VSTCA9ICR0d2l0LT5j
YWxsYmFja1VSTCgkZXZlbnQsJ3ZhbGlkYXRlJyk7CgogICAgICAgICRyZXF1ZXN0ID0gJHR3
aXQtPmdldFJlcXVlc3RUb2tlbigkY2FsbGJhY2tVUkwpOwogICAgICAgICRyZXF1ZXN0X3Rv
a2VuID0gJHJlcXVlc3RbIm9hdXRoX3Rva2VuIl07CiAgICAgICAgJHJlcXVlc3RfdG9rZW5f
c2VjcmV0ID0gJHJlcXVlc3RbIm9hdXRoX3Rva2VuX3NlY3JldCJdOwoKICAgICAgICBzZXRf
cHJlZignYXJjX3R3aXR0ZXJfcmVxdWVzdFRva2VuJywkcmVxdWVzdF90b2tlbgogICAgICAg
ICAgICAsICdhcmNfdHdpdHRlcicsMik7CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVy
X3JlcXVlc3RUb2tlblNlY3JldCcsJHJlcXVlc3RfdG9rZW5fc2VjcmV0CiAgICAgICAgICAg
ICwgJ2FyY190d2l0dGVyJywyKTsKCiAgICAgICAgJGh0bWwuPSBzdGFydFRhYmxlKCdlZGl0
JykuCiAgICAgICAgICAgICAgICB0cih0ZCgKICAgICAgICAgICAgICAgICAgICAoJzxwPicu
aHJlZignU2lnbi1pbiB0byBUd2l0dGVyJwogICAgICAgICAgICAgICAgICAgICAgICAgICAg
LCR0d2l0LT5nZXRBdXRob3JpemVVUkwoJHJlcXVlc3QpKQogICAgICAgICAgICAgICAgICAg
ICAgICAuJyBhbmQgZm9sbG93IHRoZSBpbnN0cnVjdGlvbnMgdG8gYWxsb3cgVFhQIFR3ZWV0
IHRvIHVzZSB5b3VyIGFjY291bnQuIElmIHlvdSBhcmUgYWxyZWFkeSBzaWduZWQgaW4gdG8g
VHdpdHRlciB0aGVuIHRoYXQgYWNjb3VudCB3aWxsIGJlIGFzc29jaWF0ZWQgd2l0aCBUWFAg
VHdlZXQgc28geW91IG1heSBuZWVkIHRvIHNpZ24gb3V0IGZpcnN0IGlmIHlvdSB3YW50IHRv
IHVzZSBhIGRpZmZlcmVudCBhY2NvdW50LjwvcD4nKQogICAgICAgICAgICAgICAgKSkuZW5k
VGFibGUoKTsKICAgIH0gZWxzZWlmICgkc3RlcD09J3ZhbGlkYXRlJykgewogICAgICAgICR0
d2l0ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAg
ICAgICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCwgJHByZWZzWydhcmNfdHdpdHRl
cl9yZXF1ZXN0VG9rZW4nXQogICAgICAgICAgICAsICRwcmVmc1snYXJjX3R3aXR0ZXJfcmVx
dWVzdFRva2VuU2VjcmV0J10pOwogICAgICAgIC8vIEFzayBUd2l0dGVyIGZvciBhbiBhY2Nl
c3MgdG9rZW4gKGFuZCBhbiBhY2Nlc3MgdG9rZW4gc2VjcmV0KQogICAgICAgICRyZXF1ZXN0
ID0gJHR3aXQtPmdldEFjY2Vzc1Rva2VuKCBncHMoJ29hdXRoX3ZlcmlmaWVyJykgKTsKICAg
ICAgICAkYWNjZXNzX3Rva2VuID0gJHJlcXVlc3RbJ29hdXRoX3Rva2VuJ107CiAgICAgICAg
JGFjY2Vzc190b2tlbl9zZWNyZXQgPSAkcmVxdWVzdFsnb2F1dGhfdG9rZW5fc2VjcmV0J107
CiAgICAgICAgJHVzZXIgPSAkcmVxdWVzdFsnc2NyZWVuX25hbWUnXTsKICAgICAgICAvLyBT
dG9yZSB0aGUgYWNjZXNzIHRva2VuIGFuZCBzZWNyZXQKICAgICAgICBzZXRfcHJlZignYXJj
X3R3aXR0ZXJfYWNjZXNzVG9rZW4nLCRhY2Nlc3NfdG9rZW4sICdhcmNfdHdpdHRlcicsMik7
CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0JywkYWNj
ZXNzX3Rva2VuX3NlY3JldAogICAgICAgICAgICAsICdhcmNfdHdpdHRlcicsMik7CiAgICAg
ICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3VzZXInLCR1c2VyKTsKICAgICAgICAkcHJlZnNb
J2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10gPSAkYWNjZXNzX3Rva2VuOwogICAgICAgICRw
cmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSA9ICRhY2Nlc3NfdG9rZW5f
c2VjcmV0OwogICAgICAgIHVuc2V0KCR0d2l0KTsKICAgIH0KCiAgICBpZiAoJHN0ZXA9PSJw
cmVmc19zYXZlIikgewogICAgICAgICRwcmVmaXggPSB0cmltKGdwcygnYXJjX3R3aXR0ZXJf
cHJlZml4JykpOwogICAgICAgICR0d2VldF9kZWZhdWx0ID0gZ3BzKCdhcmNfdHdpdHRlcl90
d2VldF9kZWZhdWx0Jyk7CiAgICAgICAgJHVybF9tZXRob2QgPSBncHMoJ2FyY190d2l0dGVy
X3VybF9tZXRob2QnKTsKICAgICAgICAkc2hvcnRfdXJsID0gZ3BzKCdhcmNfc2hvcnRfdXJs
Jyk7CiAgICAgICAgJHNob3J0X3NpdGVfdXJsID0gZ3BzKCdhcmNfc2hvcnRfc2l0ZV91cmwn
KTsKICAgICAgICAkY2FjaGVfZGlyID0gZ3BzKCdhcmNfdHdpdHRlcl9jYWNoZV9kaXInKTsK
ICAgICAgICAkdGFiID0gZ3BzKCdhcmNfdHdpdHRlcl90YWInKTsKICAgICAgICBpZiAoc3Ry
bGVuKCRwcmVmaXgpPD0yMCkgewogICAgICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJf
cHJlZml4JywkcHJlZml4KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkcHJlZml4
ID0gJHByZWZzWydhcmNfdHdpdHRlcl9wcmVmaXgnXTsKICAgICAgICB9CiAgICAgICAgJHR3
ZWV0X2RlZmF1bHQgPSAoJHR3ZWV0X2RlZmF1bHQpID8gMSA6IDA7CiAgICAgICAgJHNob3J0
X3VybCA9ICgkc2hvcnRfdXJsKSA/IDEgOiAwOwogICAgICAgIGlmICghJHNob3J0X3NpdGVf
dXJsKSAkc2hvcnRfc2l0ZV91cmwgPSAkcHJlZnNbJ3NpdGV1cmwnXTsKICAgICAgICBzZXRf
cHJlZignYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcsJHR3ZWV0X2RlZmF1bHQpOwogICAg
ICAgIHNldF9wcmVmKCdhcmNfc2hvcnRfdXJsJywkc2hvcnRfdXJsKTsKICAgICAgICBzZXRf
cHJlZignYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCcsJHVybF9tZXRob2QpOwogICAgICAgIHNl
dF9wcmVmKCdhcmNfc2hvcnRfc2l0ZV91cmwnLCRzaG9ydF9zaXRlX3VybCk7CiAgICAgICAg
c2V0X3ByZWYoJ2FyY190d2l0dGVyX2NhY2hlX2RpcicsJGNhY2hlX2Rpcik7CiAgICAgICAg
c2V0X3ByZWYoJ2FyY190d2l0dGVyX3RhYicsJHRhYik7CiAgICB9CgogICAgaWYgKCAkc3Rl
cCE9J3JlZ2lzdGVyJyApIHsKICAgICAgICBpZiAoIGlzc2V0KCRwcmVmc1snYXJjX3R3aXR0
ZXJfYWNjZXNzVG9rZW4nXSkKICAgICAgICAmJiBpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVy
X2FjY2Vzc1Rva2VuU2VjcmV0J10pICkgewogICAgICAgICAgICAkdHdpdCA9IG5ldyBhcmNf
dHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgICAgICwgJGFy
Y190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rv
a2VuJ10KICAgICAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tl
blNlY3JldCddKTsKICAgICAgICAgICAgJHJlZ2lzdGVyVVJMID0gJHR3aXQtPmNhbGxiYWNr
VVJMKCRldmVudCwncmVnaXN0ZXInKTsKICAgICAgICAgICAgJGh0bWwuPSBzdGFydFRhYmxl
KCdsaXN0JykuZm9ybSgKICAgICAgICAgICAgICAgIHRyKAogICAgICAgICAgICAgICAgICAg
IHRkY3MoaGVkKCdUd2l0dGVyIGFjY291bnQgZGV0YWlscycsIDIpLDIpCiAgICAgICAgICAg
ICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8
bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl91c2VyIj5Ud2l0dGVyIHVzZXJuYW1lPC9sYWJlbD4n
LAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsg
dmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoCiAg
ICAgICAgICAgICAgICAgICAgICAgICgkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSkgPwog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgJHVzZXIuJyAoJy5ocmVmKCdSZS1jb25uZWN0
JywkcmVnaXN0ZXJVUkwpLicpJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnPGVt
PnVua25vd248L2VtPicKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5ocmVmKCdDb25u
ZWN0IHRvIFR3aXR0ZXInLCRyZWdpc3RlclVSTCkpCiAgICAgICAgICAgICAgICApCiAgICAg
ICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAgICAgICAgdGRjcyhoZWQoJ1R3ZWV0IHNl
dHRpbmdzJywgMiksMikKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50cigK
ICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX2NhY2hl
X2RpciI+VHdlZXQgcHJlZml4PC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAn
IHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykK
ICAgICAgICAgICAgICAgICAgICAudGQoZklucHV0KCd0ZXh0JywnYXJjX3R3aXR0ZXJfcHJl
Zml4JywkcHJlZml4LCcnLCcnLCcnLCcnLCcnLCdhcmNfdHdpdHRlcl9wcmVmaXgnKSkKICAg
ICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9y
PSJhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0Ij5Ud2VldCBhcnRpY2xlcyBieSBkZWZhdWx0
PC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWdu
OiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAg
ICAudGQoeWVzbm9SYWRpbygnYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcsICR0d2VldF9k
ZWZhdWx0LCAnJywgJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnKSkKICAgICAgICAgICAg
ICAgICkudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdp
dHRlcl91cmxfbWV0aG9kIj5VUkwgc2hvcnRuZXI8L2xhYmVsPicsCiAgICAgICAgICAgICAg
ICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjog
bWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50ZChhcmNfdHdpdHRlcl91cmxfbWV0
aG9kX3NlbGVjdCgnYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCcsJHVybF9tZXRob2QpKQogICAg
ICAgICAgICAgICAgKS50cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVFhQIFR3
ZWV0IHNob3J0IFVSTCcsIDIpLDIpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAg
ICAudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfc2hvcnRf
dXJsIj5FbmFibGUgVFhQIFR3ZWV0IHNob3J0IFVSTCByZWRpcmVjdDwvbGFiZWw+JywKICAg
ICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRp
Y2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKHllc25vUmFk
aW8oJ2FyY19zaG9ydF91cmwnLCAkc2hvcnRfdXJsLCAnJywgJ2FyY19zaG9ydF91cmwnKSks
CiAgICAgICAgICAgICAgICAgICAgJyBpZD0iYXJjX3Nob3J0X3VybC1vbl9vZmYiJwogICAg
ICAgICAgICAgICAgKS50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9
ImFyY19zaG9ydF9zaXRlX3VybCI+VFhQIFR3ZWV0IHNob3J0IHNpdGUgVVJMPC9sYWJlbD4n
LAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsg
dmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoZklu
cHV0KCd0ZXh0JywnYXJjX3Nob3J0X3NpdGVfdXJsJywkc2hvcnRfc2l0ZV91cmwsJycsJycs
JycsJycsJycsJ2FyY19zaG9ydF9zaXRlX3VybCcpKSwKICAgICAgICAgICAgICAgICAgICAn
IGlkPSJhcmNfc2hvcnRfc2l0ZV91cmwtb3B0aW9uIicKICAgICAgICAgICAgICAgICkudHIo
CiAgICAgICAgICAgICAgICAgICAgdGRjcyhoZWQoJ1R3aXR0ZXIgdGFiJywgMiksMikKICAg
ICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9y
PSJhcmNfdHdpdHRlcl90YWIiPkxvY2F0aW9uIG9mIFR3aXR0ZXIgdGFiPC9sYWJlbD4nLAog
ICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVy
dGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoYXJjX3R3
aXR0ZXJfdGFiX3NlbGVjdCgnYXJjX3R3aXR0ZXJfdGFiJywkdGFiKSkKICAgICAgICAgICAg
ICAgICkudHIoCiAgICAgICAgICAgICAgICAgICAgdGRjcyhoZWQoJ0NhY2hlJywgMiksMikK
ICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAg
ICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX2NhY2hlX2RpciI+Q2FjaGUgZGly
ZWN0b3J5PC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0
LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAg
ICAgICAgICAudGQoZklucHV0KCd0ZXh0JywnYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJywkY2Fj
aGVfZGlyLCcnLCcnLCcnLCcnLCcnLCdhcmNfdHdpdHRlcl9jYWNoZV9kaXInKSkKICAgICAg
ICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0
ZGEoCiAgICAgICAgICAgICAgICAgICAgICAgIGZJbnB1dCgnc3VibWl0JywgJ1N1Ym1pdCcs
IGdUeHQoJ3NhdmVfYnV0dG9uJyksICdwdWJsaXNoJykKICAgICAgICAgICAgICAgICAgICAg
ICAgLm4uc0lucHV0KCdwcmVmc19zYXZlJykKICAgICAgICAgICAgICAgICAgICAgICAgLm4u
ZUlucHV0KCdwbHVnaW5fcHJlZnMuYXJjX3R3aXR0ZXInKQogICAgICAgICAgICAgICAgICAg
ICwgJyBjb2xzcGFuPSIyIiBjbGFzcz0ibm9saW5lIicpKSkKICAgICAgICAgICAgICAgIC5l
bmRUYWJsZSgpOwogICAgICAgIH0gZWxzZWlmICggJHN0ZXAhPSdyZWdpc3RlcicgKSB7CiAg
ICAgICAgICAgICRyZWdpc3RlclVSTCA9IGFyY190d2l0dGVyOjpjYWxsYmFja1VSTCgkZXZl
bnQsJ3JlZ2lzdGVyJyk7CiAgICAgICAgICAgICRodG1sLj0gc3RhcnRUYWJsZSgnbGlzdCcp
LmZvcm0oCiAgICAgICAgICAgICAgICB0cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhl
ZCgnVHdpdHRlciBhY2NvdW50IGRldGFpbHMnLCAyKSwyKQogICAgICAgICAgICAgICAgKQog
ICAgICAgICAgICAgICAgLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZv
cj0iYXJjX3R3aXR0ZXJfdXNlciI+VHdpdHRlciB1c2VybmFtZTwvbGFiZWw+JywKICAgICAg
ICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2Fs
LWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKAogICAgICAgICAg
ICAgICAgICAgICAgICAoJzxlbT51bmtub3duPC9lbT4gKCcKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIC5ocmVmKCdDb25uZWN0IHRvIFR3aXR0ZXInLCRyZWdpc3RlclVSTCkuJykn
KQogICAgICAgICAgICAgICAgKSkpCiAgICAgICAgICAgICAgICAuZW5kVGFibGUoKTsKICAg
ICAgICB9CiAgICB9CgogICAgLy8gU2V0IGpRdWVyeSBmb3Igc3dpdGNoaW5nIG9uL29mZiBy
ZWxldmFudCBhcmNfc2hvcnRfdXJsIGZpZWxkcwogICAgJGpzID0gPDw8SlMKPHNjcmlwdCBs
YW5ndWFnZT0iamF2YXNjcmlwdCIgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KJChkb2N1bWVu
dCkucmVhZHkoZnVuY3Rpb24oKXsKICB2YXIgb25vZmYgPSAkKCcjYXJjX3Nob3J0X3VybC1v
bl9vZmYnKTsKICB2YXIgYXJjX3Nob3J0X3VybF9vZmYgPSAkKCcjYXJjX3Nob3J0X3VybC1h
cmNfc2hvcnRfdXJsLTAnKTsKICB2YXIgdXJsID0gJCgnI2FyY19zaG9ydF9zaXRlX3VybC1v
cHRpb24nKTsKICB2YXIgdXJsX21ldGhvZCA9ICQoJ3NlbGVjdFtuYW1lPSJhcmNfdHdpdHRl
cl91cmxfbWV0aG9kIl0nKTsKCiAgaWYgKGFyY19zaG9ydF91cmxfb2ZmLmF0dHIoJ2NoZWNr
ZWQnKT09dHJ1ZQogICYmICQoJ29wdGlvbjpzZWxlY3RlZCcsIHVybF9tZXRob2QpLnZhbCgp
IT0nYXJjX3R3aXR0ZXInKSB7CiAgICB1cmwuaGlkZSgpOwogIH0KICAkKCdpbnB1dCcsIG9u
b2ZmKS5jaGFuZ2UoZnVuY3Rpb24oKXsKICAgIGlmICgkKCdvcHRpb246c2VsZWN0ZWQnLCB1
cmxfbWV0aG9kKS52YWwoKSE9J2FyY190d2l0dGVyJykgewogICAgICBhcmNfc2hvcnRfdXJs
X29mZi5hdHRyKCdjaGVja2VkJyk9PXRydWUgPyB1cmwuaGlkZSgpIDogdXJsLnNob3coKTsK
ICAgIH0KICB9KTsKCiAgaWYgKCQoJ29wdGlvbjpzZWxlY3RlZCcsIHVybF9tZXRob2QpLnZh
bCgpPT0nYXJjX3R3aXR0ZXInKSB7CiAgICBvbm9mZi5oaWRlKCk7IHVybC5zaG93KCk7CiAg
fQogIHVybF9tZXRob2QuY2hhbmdlKGZ1bmN0aW9uKCl7CiAgICBpZiAoJCgnb3B0aW9uOnNl
bGVjdGVkJywgdXJsX21ldGhvZCkudmFsKCk9PSdhcmNfdHdpdHRlcicpIHsKICAgICAgb25v
ZmYudG9nZ2xlKCk7IHVybC5zaG93KCk7CiAgICB9IGVsc2UgewogICAgICBvbm9mZi50b2dn
bGUoKTsKICAgICAgYXJjX3Nob3J0X3VybF9vZmYuYXR0cignY2hlY2tlZCcpPT10cnVlID8g
dXJsLmhpZGUoKSA6IHVybC5zaG93KCk7CiAgICB9CiAgfSkKfSk7Cjwvc2NyaXB0PgpKUzsK
CiAgICBlY2hvICRqcy4kaHRtbDsKfQoKLy8gQWRkIFR3aXR0ZXIgdGFiIHRvIFRleHRwYXR0
ZXJuCmZ1bmN0aW9uIGFyY19hZG1pbl90d2l0dGVyKCRldmVudCwkc3RlcCkKewogICAgZ2xv
YmFsICRwcmVmcywgJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29u
c3VtZXJTZWNyZXQ7CgogICAgJHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVy
X2NvbnN1bWVyS2V5CiAgICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0
LCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10KICAgICAgICAgICAgLCAkcHJl
ZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0J10pOwoKICAgICR0d2l0LT5jYWNo
ZURpcigkcHJlZnNbJ2FyY190d2l0dGVyX2NhY2hlX2RpciddKTsKCiAgICAkeG1sID0gJHR3
aXQtPmdldCgndXNlcnMvc2hvdycKICAgICAgICAsIGFycmF5KCdzY3JlZW5fbmFtZSc9PiRw
cmVmc1snYXJjX3R3aXR0ZXJfdXNlciddKSk7CiAgICAkdHdpdHRlclVzZXIgPSBAJHhtbC0+
eHBhdGgoJy91c2VyJyk7CiAgICAkdHdpdHRlclVzZXIgPSAkdHdpdHRlclVzZXJbMF07CiAg
ICAkdHdpdHRlclVzZXJVUkwgPSAnaHR0cDovL3d3dy50d2l0dGVyLmNvbS8nLiR0d2l0dGVy
VXNlci0+c2NyZWVuX25hbWU7CgogICAgaWYgKCRzdGVwPT0idHdlZXQiKSB7IC8vIHBvc3Qg
YW4gdXBkYXRlIHRvIFR3aXR0ZXIKCiAgICAgICAgLy8gZmV0Y2ggYW5kIGNsZWFuIG1lc3Nh
Z2UKICAgICAgICAkbWVzc2FnZSA9IHN0cmlwX3RhZ3MoZ3BzKCdtZXNzYWdlJykpOwogICAg
ICAgICRjb3VudCA9IHN0cmxlbigkbWVzc2FnZSk7CgogICAgICAgIGlmICgkY291bnQ8PTE0
MCAmJiAkY291bnQ+MCkgeyAvLyBwb3N0IHVwZGF0ZQogICAgICAgICAgICAkcmVzdWx0ID0g
JHR3aXQtPnBvc3QoJ3N0YXR1c2VzL3VwZGF0ZScsIGFycmF5KCdzdGF0dXMnID0+ICRtZXNz
YWdlKSk7CiAgICAgICAgfSBlbHNlIHsgLy8gbWVzc2FnZSB0b28gbG9uZywgSmF2YVNjcmlw
dCBpbnRlcmZhY2Ugc2hvdWxkIHByZXZlbnQgdGhpcwogICAgICAgICAgICAkcmVzdWx0ID0g
ZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBwYWdldG9wKCdUd2l0dGVyJywKICAgICAgICAg
ICAgKCgkcmVzdWx0IT1mYWxzZSk/J1R3aXR0ZXIgdXBkYXRlZCc6J0Vycm9yIHVwZGF0aW5n
IFR3aXR0ZXInKSk7CgogICAgfSBlbHNlaWYgKCRzdGVwPT0iZGVsZXRlIikgeyAvLyBkZWxl
dGUgYW4gdXBkYXRlIGZyb20gVHdpdHRlcgoKICAgICAgICAkaWQgPSBzdHJpcF90YWdzKGdw
cygnaWQnKSk7CiAgICAgICAgaWYgKCRpZCkgewogICAgICAgICAgICAkdHdpdC0+ZGVsZXRl
KCdzdGF0dXNlcy9kZXN0cm95Jy4kaWQpOwogICAgICAgICAgICBzYWZlX2RlbGV0ZSgnYXJj
X3R3aXR0ZXInLCJ0d2VldF9pZCA9ICRpZCIpOwogICAgICAgIH0KCiAgICAgICAgcGFnZXRv
cCgnVHdpdHRlcicsJ1R3aXR0ZXIgdXBkYXRlZCcpOwoKICAgIH0gZWxzZSB7CgogICAgICAg
IHBhZ2V0b3AoJ1R3aXR0ZXInKTsKCiAgICB9CgogICAgLy8gUHJlcGFyZSBKYXZhU2NyaXB0
IHRvIGNyZWF0ZSBUd2l0dGVyIHVwZGF0ZSBpbnRlcmZhY2UKCiAgICAkanMgPSAnPHNjcmlw
dCBsYW5ndWFnZT0iamF2YXNjcmlwdCIgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4nOwogICAg
JGpzLj0gIiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHZhciBj
b3VudGVyU3R5bGUgPSAnZm9udC13ZWlnaHQ6Ym9sZDtmbG9hdDpyaWdodDtmb250LXNpemU6
MmVtO2xpbmUtaGVpZ2h0OjEuMmVtOyc7CiAgICAgICAgICAgICQoJyN0d2VldGNvdW50Jyku
YXR0cignc3R5bGUnLCBjb3VudGVyU3R5bGUrJ2NvbG9yOiNjY2M7Jyk7CiAgICAgICAgICAg
ICQoJyNtZXNzYWdlJykua2V5dXAoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB2YXIg
Y291bnQgPSAxNDAtJCgnI21lc3NhZ2UnKS52YWwoKS5sZW5ndGg7CiAgICAgICAgICAgICAg
ICAkKCcjdHdlZXRjb3VudCcpLmh0bWwoY291bnQrJycpOyAvLyBoYWNrIHRvIGZvcmNlIG91
dHB1dCBvZiAwCiAgICAgICAgICAgICAgICBpZiAoY291bnQ8MCkgewogICAgICAgICAgICAg
ICAgICAgICQoJ2lucHV0LnB1Ymxpc2gnKS5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcp
OwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkKCdpbnB1
dC5wdWJsaXNoJykuYXR0cignZGlzYWJsZWQnLCAnJyk7CiAgICAgICAgICAgICAgICB9CiAg
ICAgICAgICAgICAgICBpZiAoY291bnQ8MCkgewogICAgICAgICAgICAgICAgICAgICQoJyN0
d2VldGNvdW50JykuYXR0cignc3R5bGUnLCBjb3VudGVyU3R5bGUrJ2NvbG9yOiNmMDA7Jyk7
CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvdW50PDEwKSB7CiAgICAgICAgICAgICAg
ICAgICAgJCgnI3R3ZWV0Y291bnQnKS5hdHRyKCdzdHlsZScsIGNvdW50ZXJTdHlsZSsnY29s
b3I6IzAwMDsnKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAg
ICAgJCgnI3R3ZWV0Y291bnQnKS5hdHRyKCdzdHlsZScsIGNvdW50ZXJTdHlsZSsnY29sb3I6
I2NjYzsnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICB9KTsi
OwogICAgJGpzLj0gIjwvc2NyaXB0PiI7CgogICAgJG91dCA9ICcnOwogICAgJHhtbCA9ICR0
d2l0LT5nZXQoJ3N0YXR1c2VzL3VzZXJfdGltZWxpbmUnCiAgICAgICAgLCBhcnJheSgnc2Ny
ZWVuX25hbWUnPT4kcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSwnY291bnQnPT4yNSkpOwog
ICAgJHR3ZWV0cyA9IEAkeG1sLT54cGF0aCgnL3N0YXR1c2VzL3N0YXR1cycpOwogICAgaWYg
KCR0d2VldHMpIGZvcmVhY2ggKCR0d2VldHMgYXMgJHR3ZWV0KSB7CiAgICAgICAgJHRpbWUg
PSBzdHJ0b3RpbWUoaHRtbGVudGl0aWVzKCR0d2VldC0+Y3JlYXRlZF9hdCkpOwogICAgICAg
ICRkYXRlID0gc2FmZV9zdHJmdGltZSgkcHJlZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCddLCR0
aW1lKTsKICAgICAgICAkb3V0Lj0gdHIodGQoJGRhdGUsJ3NwYW4nKQogICAgICAgICAgICAu
dGQoYXJjX1R3aXR0ZXI6Om1ha2VMaW5rcyhodG1sZW50aXRpZXMoJHR3ZWV0LT50ZXh0CiAg
ICAgICAgICAgICAgICAsIEVOVF9RVU9URVMsJ1VURi04JykpKQogICAgICAgICAgICAudGQo
ZExpbmsoJ2FyY19hZG1pbl90d2l0dGVyJywnZGVsZXRlJywnaWQnLCR0d2VldC0+aWQsJycp
KQogICAgICAgICAgICApOwogICAgfQoKICAgICRodG1sID0gc3RhcnRUYWJsZSgnZWRpdCcp
CiAgICAgICAgICAgIC50cih0ZCgKICAgICAgICAgICAgZ3JhZignPGltZyBzcmM9IicuJHR3
aXR0ZXJVc2VyLT5wcm9maWxlX2ltYWdlX3VybC4nIiBhbHQ9IlR3aXR0ZXIgYXZhdGFyIiAv
PicKICAgICAgICAgICAgLCcgc3R5bGU9ImZsb2F0OmxlZnQ7cGFkZGluZzoycHg7IicpCiAg
ICAgICAgICAgIC5ncmFmKGhyZWYoJHR3aXR0ZXJVc2VyLT5uYW1lLCR0d2l0dGVyVXNlclVS
TCksJyBzdHlsZT0iZm9udC1zaXplOjEuMmVtO2ZvbnQtd2VpZ2h0OmJvbGQ7IicpCiAgICAg
ICAgICAgIC5ncmFmKGhyZWYoJHR3aXR0ZXJVc2VyLT5mcmllbmRzX2NvdW50LicgZm9sbG93
aW5nJywkdHdpdHRlclVzZXJVUkwuJy9mb2xsb3dpbmcnKQogICAgICAgICAgICAuJywgJy5o
cmVmKCR0d2l0dGVyVXNlci0+Zm9sbG93ZXJzX2NvdW50LicgZm9sbG93ZXJzJywkdHdpdHRl
clVzZXJVUkwuJy9mb2xsb3dlcnMnKQogICAgICAgICAgICAuJywgJy5ocmVmKCR0d2l0dGVy
VXNlci0+c3RhdHVzZXNfY291bnQuJyB1cGRhdGVzJywkdHdpdHRlclVzZXJVUkwpKSkpCiAg
ICAgICAgICAgIC50cih0ZChmb3JtKAogICAgICAgICAgICBncmFmKCJVcGRhdGUgVHdpdHRl
ci4uLjxzcGFuIGlkPSd0d2VldGNvdW50JyBzdHlsZT0nZm9udC13ZWlnaHQ6Ym9sZDtmbG9h
dDpyaWdodDsnPjE0MDwvc3Bhbj4iKQogICAgICAgICAgICAudGV4dF9hcmVhKCdtZXNzYWdl
JywnNTAnLCc1NTAnLCcnLCdtZXNzYWdlJykKICAgICAgICAgICAgLmVJbnB1dCgnYXJjX2Fk
bWluX3R3aXR0ZXInKQogICAgICAgICAgICAuc0lucHV0KCd0d2VldCcpLmJyCiAgICAgICAg
ICAgIC5mSW5wdXQoJ3N1Ym1pdCcsJ3VwZGF0ZScsZ1R4dCgnVXBkYXRlJyksJ3B1Ymxpc2gn
KQogICAgICAgICkpKQogICAgICAgIC5lbmRUYWJsZSgpOwoKICAgIC8vIEF0dGFjaCByZWNl
bnQgVHdpdHRlciB1cGRhdGVzCgogICAgJGh0bWwuPSBzdGFydFRhYmxlKCdsaXN0JywnJywn
JywnJywnOTAlJykKICAgICAgICAuJG91dAogICAgICAgIC5lbmRUYWJsZSgpOwoKICAgIC8v
IE91dHB1dCBKYXZhU2NyaXB0IGFuZCBIVE1MCgogICAgZWNobyAkanMuJGh0bWw7Cn0KCi8v
IEFkZCBUd2l0dGVyIG9wdGlvbnMgdG8gYXJ0aWNsZSBhcnRpY2xlIHNjcmVlbgpmdW5jdGlv
biBhcmNfYXBwZW5kX3R3aXR0ZXIoJGV2ZW50LCAkc3RlcCwgJGRhdGEsICRyczEpCnsKICAg
IGdsb2JhbCAkcHJlZnMsICRhcmNfdHdpdHRlcjsKICAgICRwcmVmaXggPSB0cmltKGdwcygn
YXJjX3R3aXR0ZXJfcHJlZml4JykpOwogICAgJHByZWZpeCA9ICgkcHJlZml4KSA/ICRwcmVm
aXggOiAkcHJlZnNbJ2FyY190d2l0dGVyX3ByZWZpeCddOwogICAgJHN1ZmZpeCA9IHRyaW0o
Z3BzKCdhcmNfdHdpdHRlcl9zdWZmaXgnKSk7CgogICAgaWYgKCRyczFbJ0lEJ10pIHsKICAg
ICAgICAkc3FsID0gIlNFTEVDVCB0d2VldF9pZCx0d2VldCBGUk9NICIuUEZYLiJhcmNfdHdp
dHRlciBXSEVSRSBhcnRpY2xlX2lkPSIuJHJzMVsnSUQnXS4iOyI7CiAgICAgICAgJHJzMiA9
IHNhZmVfcXVlcnkoJHNxbCk7ICRyczIgPSBuZXh0Um93KCRyczIpOwogICAgfSBlbHNlIHsg
Ly8gbmV3IGFydGljbGUKICAgICAgICAkcnMyID0gJyc7CiAgICB9CgogICAgaWYgKCRyczFb
J0lEJ10gJiYgJHJzMlsndHdlZXRfaWQnXSkgewogICAgICAgICRjb250ZW50ID0gYXJjX1R3
aXR0ZXI6Om1ha2VMaW5rcygkcnMyWyd0d2VldCddKTsKICAgICAgICByZXR1cm4gJGRhdGEu
ZmllbGRzZXQoJGNvbnRlbnQsICdUd2l0dGVyIHVwZGF0ZScsICdhcmNfdHdpdHRlcicpOwog
ICAgfSBlbHNlIHsKICAgICAgICAkdmFyID0gKCRyczFbJ0lEJ10pID8gMCA6ICRwcmVmc1sn
YXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCddOwogICAgICAgICRjb250ZW50ICA9IHRhZyh5
ZXNub1JhZGlvKCdhcmNfdHdlZXRfdGhpcycsICR2YXIsICcnLCAnYXJjX3R3ZWV0X3RoaXMn
KSwncCcpOwogICAgICAgICRjb250ZW50IC49IHRhZyhocmVmKCdPcHRpb25zJywnI2FyY190
d2l0dGVyX29wdGlvbnMnKSwncCcsJyBjbGFzcz0icGxhaW4gbGV2ZXIiIHN0eWxlPSJtYXJn
aW4tdG9wOjVweDsiJyk7CiAgICAgICAgJGNvbnRlbnQgLj0gdGFnKHRhZyh0YWcoJ1R3ZWV0
IHByZWZpeCcsJ2xhYmVsJywgJyBmb3I9ImFyY190d2l0dGVyX3ByZWZpeCInKQogICAgICAg
ICAgICAuZklucHV0KCd0ZXh0JywnYXJjX3R3aXR0ZXJfcHJlZml4JywkcHJlZml4LCdlZGl0
JywnJywnJywnMjInLCcnLCdhcmNfdHdpdHRlcl9wcmVmaXgnKSwncCcpCiAgICAgICAgICAg
IC50YWcodGFnKCdUd2VldCBzdWZmaXggKGVnICNoYXNodGFncyknLCdsYWJlbCcsICcgZm9y
PSJhcmNfdHdpdHRlcl9zdWZmaXgiJykKICAgICAgICAgICAgLmZJbnB1dCgndGV4dCcsJ2Fy
Y190d2l0dGVyX3N1ZmZpeCcsJHN1ZmZpeCwnZWRpdCcsJycsJycsJzIyJywnJywnYXJjX3R3
aXR0ZXJfc3VmZml4JyksJ3AnKQogICAgICAgICAgICAsJ2RpdicsJyBpZD0iYXJjX3R3aXR0
ZXJfb3B0aW9ucyIgY2xhc3M9InRvZ2dsZSIgc3R5bGU9ImRpc3BsYXk6bm9uZSInKTsKICAg
ICAgICBpZiAoaXNzZXQoJGFyY190d2l0dGVyWydlcnJvciddKSkgewogICAgICAgICAgICAk
Y29udGVudCAuPSAnPHA+Jy4kYXJjX3R3aXR0ZXJbJ2Vycm9yJ10uJzwvcD4nOwogICAgICAg
IH0KICAgICAgICByZXR1cm4gJGRhdGEuZmllbGRzZXQoJGNvbnRlbnQsICdVcGRhdGUgVHdp
dHRlcicsICdhcmNfdHdpdHRlcicpOwogICAgfQoKfQoKLy8gVXBkYXRlIFR3aXR0ZXIgd2l0
aCBwb3N0ZWQgYXJ0aWNsZQpmdW5jdGlvbiBhcmNfYXJ0aWNsZV90d2VldCgkZXZlbnQsJHN0
ZXApCnsKICAgIGdsb2JhbCAkcHJlZnMsICRhcmNfdHdpdHRlciwgJGFyY190d2l0dGVyX2Nv
bnN1bWVyS2V5CiAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgogICAg
JGFydGljbGVfaWQgPSBlbXB0eSgkR0xPQkFMU1snSUQnXSkgPyBncHMoJ0lEJykgOiAkR0xP
QkFMU1snSUQnXTsKICAgIGlmICghZW1wdHkoJGFydGljbGVfaWQpKSB7CgogICAgICAgIGlu
Y2x1ZGVfb25jZSB0eHBhdGguJy9wdWJsaXNoL3RhZ2hhbmRsZXJzLnBocCc7CgogICAgICAg
ICRhcnRpY2xlID0gc2FmZV9yb3coIklELCBUaXRsZSwgU2VjdGlvbiwgUG9zdGVkIiwgJ3Rl
eHRwYXR0ZXJuJywKICAgICAgICAgICAgIklEPXskYXJ0aWNsZV9pZH0gQU5EIFN0YXR1cz00
IEFORCBub3coKT49UG9zdGVkIik7CgogICAgICAgIGlmICgkYXJ0aWNsZSAmJiBncHMoJ2Fy
Y190d2VldF90aGlzJykpIHsgLy8gdHdlZXQgYXJ0aWNsZQoKICAgICAgICAgICAgLy8gTmVl
ZCB0byBtYW51YWxseSB1cGRhdGUgdGhlICdVUkwgb25seSB0aXRsZScgYmVmb3JlIGJ1aWxk
aW5nIHRoZQogICAgICAgICAgICAvLyBVUkwKICAgICAgICAgICAgJGFydGljbGVbJ3VybF90
aXRsZSddID0gZ3BzKCd1cmxfdGl0bGUnKTsKICAgICAgICAgICAgLy8gTWFrZSBzaG9ydCBV
UkwKICAgICAgICAgICAgJHVybCA9IHBlcm1saW5rdXJsKCRhcnRpY2xlKTsKICAgICAgICAg
ICAgJHNob3J0X3VybCA9IGFyY19zaG9ydGVuX3VybCgkdXJsLCRwcmVmc1snYXJjX3R3aXR0
ZXJfdXJsX21ldGhvZCddLAogICAgICAgICAgICAgICAgYXJyYXkoJ2lkJz0+JGFydGljbGVf
aWQpKTsKCiAgICAgICAgICAgIGlmICghJHNob3J0X3VybCkgeyAvLyBGYWlsZWQgdG8gb2J0
YWluIGEgc2hvcnRlbmVkIFVSTCwgZG8gbm90IHR3ZWV0IQogICAgICAgICAgICAgICAgJGFy
Y190d2l0dGVyWydlcnJvciddID0gJ1VuYWJsZSB0byBvYnRhaW4gYSBzaG9ydCBVUkwgZm9y
IHRoaXMgYXJ0aWNsZS4nOwoKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAg
ICAgICAgfQoKICAgICAgICAgICAgLy8gQ29uc3RydWN0IFR3aXR0ZXIgdXBkYXRlCiAgICAg
ICAgICAgICRwcmVmaXggID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3ByZWZpeCcpKTsKICAg
ICAgICAgICAgJHByZV9sZW4gPSBzdHJsZW4oJHByZWZpeCk7CiAgICAgICAgICAgICRwcmVm
aXggID0gKCRwcmVmaXggJiYgJHByZV9sZW48PTIwKSA/ICRwcmVmaXguJyAnIDogJyc7CiAg
ICAgICAgICAgICRzdWZmaXggID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3N1ZmZpeCcpKTsK
ICAgICAgICAgICAgJHN1Zl9sZW4gPSBzdHJsZW4oJHN1ZmZpeCk7CiAgICAgICAgICAgICRz
dWZmaXggID0gKCRzdWZmaXggJiYgJHN1Zl9sZW48PTQwKSA/ICcgJy4kc3VmZml4IDogJyc7
CiAgICAgICAgICAgICR1cmxfbGVuID0gc3RybGVuKCRzaG9ydF91cmwpKzE7IC8vIGNvdW50
IFVSTCBsZW5ndGggKyAxIGZvciBwcmVmaXhlZCBzcGFjZQogICAgICAgICAgICBpZiAoJHBy
ZWZpeCkgJHByZV9sZW4gKz0gMTsKICAgICAgICAgICAgaWYgKCRzdWZmaXgpICRzdWZfbGVu
ICs9IDE7CiAgICAgICAgICAgIGlmICgoc3RybGVuKCRhcnRpY2xlWydUaXRsZSddKSskdXJs
X2xlbiskcHJlX2xlbiskc3VmX2xlbik+MTQwKSB7CiAgICAgICAgICAgICAgICAkYXJ0aWNs
ZVsnVGl0bGUnXSA9IHN1YnN0cigkYXJ0aWNsZVsnVGl0bGUnXSwwLDEzNS0kdXJsX2xlbi0k
cHJlX2xlbi0kc3VmX2xlbikuJy4uLic7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJHR3
ZWV0ID0gJHByZWZpeC4kYXJ0aWNsZVsnVGl0bGUnXS4iICIuJHNob3J0X3VybC4kc3VmZml4
OwoKICAgICAgICAgICAgLy8gVXBkYXRlIFR3aXR0ZXIKICAgICAgICAgICAgJHR3aXQgPSBu
ZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgICAgICAg
ICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCwgJHByZWZzWydhcmNfdHdpdHRlcl9h
Y2Nlc3NUb2tlbiddCiAgICAgICAgICAgICAgICAsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNj
ZXNzVG9rZW5TZWNyZXQnXSk7CiAgICAgICAgICAgICRyZXN1bHQgPSAkdHdpdC0+cG9zdCgn
c3RhdHVzZXMvdXBkYXRlJywgYXJyYXkoJ3N0YXR1cycgPT4gJHR3ZWV0KSk7CgogICAgICAg
ICAgICAkdHdlZXRfaWQgPSAoaXNfb2JqZWN0KCRyZXN1bHQpKSA/ICRyZXN1bHRbMF0tPmlk
IDogMDsKCiAgICAgICAgICAgIGlmICgkdHdlZXRfaWQpIHsKCiAgICAgICAgICAgICAgICAk
dHdlZXQgPSBhZGRzbGFzaGVzKCR0d2VldCk7CgogICAgICAgICAgICAgICAgLy8gdXBkYXRl
IGFyY190d2l0dGVyIHRhYmxlIHdpdGggdHdlZXQKICAgICAgICAgICAgICAgICRzcWwgPSAi
SU5TRVJUIElOVE8gIi5QRlguImFyY190d2l0dGVyIChhcnRpY2xlX2lkLHR3ZWV0X2lkLHR3
ZWV0LHRpbnl1cmwpICI7CiAgICAgICAgICAgICAgICAkc3FsLj0gIlZBTFVFUygkYXJ0aWNs
ZV9pZCwkdHdlZXRfaWQsXCIkdHdlZXRcIiwnJHNob3J0X3VybCcpOyI7CiAgICAgICAgICAg
ICAgICBzYWZlX3F1ZXJ5KCRzcWwpOwoKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwoK
ICAgICAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgICAgICAkYXJjX3R3aXR0ZXJbJ2Vy
cm9yJ10gPSAnVHdpdHRlciByZXNwb25zZTogJwogICAgICAgICAgICAgICAgICAgIC4kdHdp
dC0+aHR0cF9jb2RlOwogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAg
ICAgfQoKICAgICAgICB9CgogICAgfQoKICAgIHJldHVybiBmYWxzZTsKCn0KCi8qCiAqIFNo
b3J0ZW4gVVJMcyB1c2luZyB2YXJpb3VzIG1ldGhvZHMKICovCgpmdW5jdGlvbiBhcmNfc2hv
cnRlbl91cmwoJHVybCwgJG1ldGhvZD0nJywgJGF0dHM9YXJyYXkoKSkKewogIGdsb2JhbCAk
cHJlZnM7CgogICRjaCA9IGN1cmxfaW5pdCgpOwogIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9Q
VF9IRUFERVIsIDApOwogIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZF
UiwgdHJ1ZSk7CiAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1RJTUVPVVQsIDEwKTsKCiAg
c3dpdGNoICgkbWV0aG9kKSB7CiAgICBjYXNlICdzbWQnOiAvLyBjcmVhdGUgYSBzaG9ydGVu
ZWQgVVJMIHVzaW5nIFNNRCBTaG9ydCBVUkwKICAgICAgcmV0dXJuICgkYXR0c1snaWQnXSkg
PyBodS4kYXR0c1snaWQnXSA6IGZhbHNlOyBicmVhazsKICAgIGNhc2UgJ2FyY190d2l0dGVy
JzogLy8gbmF0aXZlIFVSTCBzaG9ydGVuaW5nCgogICAgICByZXR1cm4gKCRhdHRzWydpZCdd
KSA/IFBST1RPQ09MLiRwcmVmc1snYXJjX3Nob3J0X3NpdGVfdXJsJ10uJy8nLiRhdHRzWydp
ZCddIDogZmFsc2U7CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgJ2lzZ2QnOgoKICAgICAgJHUg
PSAnaHR0cDovL2lzLmdkL2FwaS5waHA/bG9uZ3VybD0nLnVybGVuY29kZSgkdXJsKTsKICAg
ICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwgJHUpOwoKICAgICAgJHRpbnl1cmwg
PSBjdXJsX2V4ZWMoJGNoKTsKICAgICAgaWYgKCR0aW55dXJsIT0nRXJyb3InICYmICR0aW55
dXJsIT0nJykgewogICAgICAgIHJldHVybiAkdGlueXVybDsKICAgICAgfSBlbHNlIHsKICAg
ICAgICB0cmlnZ2VyX2Vycm9yKCdhcmNfdHdpdHRlciBmYWlsZWQgdG8gZ2V0IGEgaXMuZ2Qg
VVJMIGZvciAnCiAgICAgICAgICAgIC4kdXJsLEVfVVNFUl9XQVJOSU5HKTsKICAgICAgfQog
ICAgICBicmVhazsKCiAgICBjYXNlICd0aW55dXJsJzogZGVmYXVsdDogLy8gY3JlYXRlIGEg
c2hvcnRlbmVkIFVSTCB1c2luZyBUaW55VVJMCgogICAgICAkdSA9ICdodHRwOi8vdGlueXVy
bC5jb20vYXBpLWNyZWF0ZS5waHA/dXJsPScudXJsZW5jb2RlKCR1cmwpOwogICAgICBjdXJs
X3NldG9wdCgkY2gsIENVUkxPUFRfVVJMLCAkdSk7CiAgICAgICR0aW55dXJsID0gY3VybF9l
eGVjKCRjaCk7CiAgICAgIGlmICgkdGlueXVybCE9J0Vycm9yJyAmJiAkdGlueXVybCE9Jycp
IHsKICAgICAgICByZXR1cm4gJHRpbnl1cmw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdHJp
Z2dlcl9lcnJvcignYXJjX3R3aXR0ZXIgZmFpbGVkIHRvIGdldCBhIFRpbnlVUkwgZm9yICcu
JHVybCxFX1VTRVJfV0FSTklORyk7CiAgICAgIH0KCiAgfQoKICByZXR1cm4gZmFsc2U7IC8v
IGZhaWwKCn0KCi8qCiAqIFNob3J0ZW5lZCBVUkwgcmVkaXJlY3QgYmFzZWQgb24gc21kX3No
b3J0X3VybAogKi8KZnVuY3Rpb24gYXJjX3Nob3J0X3VybF9yZWRpcmVjdCgkZXZlbnQsICRz
dGVwKSB7CiAgZ2xvYmFsICRwcmVmczsKCiAgJGhhdmVfaWQgPSAwOwoKICAvLyBDaGVjayBp
ZiB0aGVyZSBpcyBhbiBhdmFpbGFibGUgc2hvcnQgc2l0ZSB1cmwgYW5kIGlmIGl0IGlzIGJl
aW5nIHVzZWQgaW4KICAvLyB0aGlzIGluc3RhbmNlCiAgJHNob3J0X3NpdGVfdXJsID0gJHBy
ZWZzWydhcmNfc2hvcnRfc2l0ZV91cmwnXTsKICBpZiAoJHNob3J0X3NpdGVfdXJsKSB7CiAg
ICAkc2hvcnRfc2l0ZV91cmwgPSBQUk9UT0NPTC4kc2hvcnRfc2l0ZV91cmwuJy8nOwogICAg
JHVybF9wYXJ0cyA9IHBhcnNlX3VybCgkc2hvcnRfc2l0ZV91cmwpOwogICAgJHJlID0gJyNe
Jy4kdXJsX3BhcnRzWydwYXRoJ10uJyhbMC05XS4qKSMnOwogICAgJGhhdmVfaWQgPSBwcmVn
X21hdGNoKCRyZSwgJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ10sICRtKTsKICB9CgogIC8vIEZh
bGwgYmFjayB0byBzdGFuZGFyZCBzaXRlIHVybCAoc21kX3Nob3J0X3VybCBiZWhhdmlvdXIp
CiAgaWYgKCRoYXZlX2lkKSB7CiAgICAkdXJsX3BhcnRzID0gcGFyc2VfdXJsKGh1KTsKICAg
ICRyZSA9ICcjXicuJHVybF9wYXJ0c1sncGF0aCddLicoWzAtOV0uKikjJzsKICAgICRoYXZl
X2lkID0gcHJlZ19tYXRjaCgkcmUsICRfU0VSVkVSWydSRVFVRVNUX1VSSSddLCAkbSk7CiAg
fQoKICAvLyBEbyB0aGUgcmVkaXJlY3QgaWYgd2UndmUgZ290IGFuIGFydGljbGUgaWQKICBp
ZiAoJGhhdmVfaWQpIHsKCSAgJGlkID0gJG1bMV07CgkgICRwZXJtbGluayA9IHBlcm1saW5r
dXJsX2lkKCRpZCk7CgoJICBpZiAoJHBlcm1saW5rKSB7CgkJICBvYl9lbmRfY2xlYW4oKTsK
CgkJICAvLyBTdHVwaWQsIG92ZXIgdGhlIHRvcCBoZWFkZXIgc2V0dGluZyBmb3IgSUUKCQkg
IGhlYWRlcigiU3RhdHVzOiAzMDEiKTsKCQkgIGhlYWRlcigiSFRUUC8xLjAgMzAxIE1vdmVk
IFBlcm1hbmVudGx5Iik7CgkJICBoZWFkZXIoIkxvY2F0aW9uOiAiLiRwZXJtbGluaywgVFJV
RSwgMzAxKTsKCgkJICAvLyBJbiBjYXNlIHRoZSBoZWFkZXIoKSBtZXRob2QgZmFpbHMsIGZh
bGwgYmFjayBvbiBhIGNsYXNzaWMgcmVkaXJlY3QKCQkgIGVjaG8gJzxodG1sPjxoZWFkPjxN
RVRBIEhUVFAtRVFVSVY9IlJlZnJlc2giIENPTlRFTlQ9IjA7VVJMPScKCQkgICAgLiRwZXJt
bGluay4nIj48L2hlYWQ+PGJvZHk+PC9ib2R5PjwvaHRtbD4nOwoJCSAgZGllKCk7CgkgIH0K
ICB9Cgp9CgovKgogKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgoqLwoKY2xhc3MgYXJjX3R3
aXR0ZXIgZXh0ZW5kcyBUd2l0dGVyT0F1dGggewogICAgLy8gQ2FjaGluZyB2YXJpYWJsZXMK
ICAgIHByaXZhdGUgJF9jYWNoZSA9IHRydWU7CiAgICBwcml2YXRlICRfY2FjaGVfZGlyID0g
Jy4vdG1wJzsKICAgIHByaXZhdGUgJF9jYWNoZV90aW1lID0gMTgwMDsgLy8gMzAgbWludXRl
IGNhY2hlCgogICAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGNvbnN1bWVyX2tleSwgJGNvbnN1
bWVyX3NlY3JldCwgJG9hdXRoX3Rva2VuID0gTlVMTAogICAgICAgICwgJG9hdXRoX3Rva2Vu
X3NlY3JldCA9IE5VTEwpCiAgICB7CiAgICAgICAgcGFyZW50OjpfX2NvbnN0cnVjdCgkY29u
c3VtZXJfa2V5LCAkY29uc3VtZXJfc2VjcmV0LCAkb2F1dGhfdG9rZW4KICAgICAgICAgICAg
LCAkb2F1dGhfdG9rZW5fc2VjcmV0KTsKICAgICAgICAkdGhpcy0+Zm9ybWF0ID0gJ3htbCc7
CiAgICAgICAgJHRoaXMtPnRpbWVvdXQgPSAxNTsKICAgICAgICAkdGhpcy0+Y29ubmVjdHRp
bWVvdXQgPSAxNTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gY2FsbGJhY2tVUkwoJGV2
ZW50LCRzdGVwKQogICAgewogICAgICAgIHJldHVybiBodS4ndGV4dHBhdHRlcm4vaW5kZXgu
cGhwP2V2ZW50PScuJGV2ZW50LicmYW1wO3N0ZXA9Jy4kc3RlcDsKICAgIH0KCiAgICAvLyBj
cmVhdGUgVHdpdHRlciBhbmQgZXh0ZXJuYWwgbGlua3MgaW4gdGV4dAogICAgcHVibGljIHN0
YXRpYyBmdW5jdGlvbiBtYWtlTGlua3MoJHRleHQpCiAgICB7CiAgICAgICAgJHVybCA9ICcv
XGIoaHR0cHxodHRwc3xmdHApOlwvXC8oW0EtWjAtOV1bQS1aMC05Xy1dKig/OlwuW0EtWjAt
OV1bQS1aMC05Xy1dKikrKTo/KFxkKyk/XC8/KFtcL1x3K1wuXSspXGIvaSc7CiAgICAgICAg
JHRleHQgPSBwcmVnX3JlcGxhY2UoJHVybCwgIjxhIGhyZWY9JyQwJz4kMDwvYT4iLCAkdGV4
dCk7CiAgICAgICAgJHVybCA9ICcvXGIoXnxccyl3d3cuKFthLXpfQS1aMC05XSspKChcLlth
LXpdKykrKVxiL2knOwogICAgICAgICR0ZXh0ID0gcHJlZ19yZXBsYWNlKCR1cmwsICI8YSBo
cmVmPSdodHRwOi8vd3d3LiQyJDMnPnd3dy4kMiQzPC9hPiIsICR0ZXh0KTsKICAgICAgICAk
dGV4dCA9IHByZWdfcmVwbGFjZSgiLyhefFxzKUAoW2Etel9BLVowLTldKykvIiwKICAgICAg
ICAgICAgIiQxQDxhIGhyZWY9J2h0dHA6Ly90d2l0dGVyLmNvbS8kMic+JDI8L2E+IiwkdGV4
dCk7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2UoIi8oXnxccykoXCMoW2Etel9BLVow
LTk6Xy1dKykpLyIsCiAgICAgICAgICAgICIkMTxhIGhyZWY9J2h0dHA6Ly90d2l0dGVyLmNv
bS9zZWFyY2g/cT0lMjMkMyc+JDI8L2E+IiwkdGV4dCk7CiAgICAgICAgcmV0dXJuICR0ZXh0
OwogIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gZ2V0KCR1cmwsICRwYXJhbXMgPSBhcnJheSgp
KQogICAgewogICAgICAgICRhcGlfdXJsID0gbWQ1KCR1cmwudXJsZW5jb2RlKHNlcmlhbGl6
ZSgkcGFyYW1zKSkpOwogICAgICAgICRkYXRhID0gJyc7CgogICAgICAgIGlmICgkdGhpcy0+
X2NhY2hlKSB7IC8vIGNoZWNrIGZvciBjYWNoZWQgeG1sCgogICAgICAgICAgICAkZGF0YSA9
ICR0aGlzLT5fcmV0cmlldmVDYWNoZSgkYXBpX3VybCk7CgogICAgICAgIH0KICAgICAgICBp
ZiAoZW1wdHkoJGRhdGEpKSB7CiAgICAgICAgICAgICRkYXRhID0gcGFyZW50OjpnZXQoJHVy
bCwgJHBhcmFtcyk7CiAgICAgICAgICAgIGlmICgkdGhpcy0+aHR0cF9jb2RlPT09MjAwICYm
ICR4bWw9c2ltcGxleG1sX2xvYWRfc3RyaW5nKCRkYXRhKSkgeyAvLyBzYXZlIGNhY2hlCiAg
ICAgICAgICAgICAgICAkZmlsZSA9ICR0aGlzLT5fY2FjaGVfZGlyLicvJy4kYXBpX3VybDsK
ICAgICAgICAgICAgICAgIGZpbGVfcHV0X2NvbnRlbnRzKCRmaWxlLCRkYXRhLExPQ0tfRVgp
OwogICAgICAgICAgICAgICAgcmV0dXJuICR4bWw7CiAgICAgICAgICAgIH0gZWxzZSB7IC8v
IGZhaWxlZCB0byByZXRyaWV2ZSBkYXRhIGZyb20gVHdpdHRlcgoKICAgICAgICAgICAgICAg
IGlmICgkdGhpcy0+X2NhY2hlKSB7IC8vIGF0dGVtcHQgdG8gZm9yY2UgY2FjaGVkIHhtbCBy
ZXR1cm4KCiAgICAgICAgICAgICAgICAgICAgJGRhdGEgPSAkdGhpcy0+X3JldHJpZXZlQ2Fj
aGUoJGFwaV91cmwsdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKCRkYXRhKSByZXR1
cm4gQHNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSk7CgogICAgICAgICAgICAgICAgfQoK
ICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgICAgIH0KICAgICAgICB9
IGVsc2UgeyAvLyByZXR1cm4gY2FjaGVkIHhtbAogICAgICAgICAgICByZXR1cm4gQHNpbXBs
ZXhtbF9sb2FkX3N0cmluZygkZGF0YSk7CiAgICAgICAgfQogICAgfSAvL2VuZCBnZXQoKQoK
ICAgIGZ1bmN0aW9uIHBvc3QoJHVybCwgJHBhcmFtcyA9IGFycmF5KCkpCiAgICB7CiAgICAg
ICAgJGRhdGEgPSBwYXJlbnQ6OnBvc3QoJHVybCwkcGFyYW1zKTsKICAgICAgICByZXR1cm4g
c2ltcGxleG1sX2xvYWRfc3RyaW5nKCRkYXRhKTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWxl
dGUoJHVybCwgJHBhcmFtcyA9IGFycmF5KCkpCiAgICB7CiAgICAgICAgJGRhdGEgPSBwYXJl
bnQ6OmRlbGV0ZSgkdXJsLCRwYXJhbXMpOwogICAgICAgIHJldHVybiBzaW1wbGV4bWxfbG9h
ZF9zdHJpbmcoJGRhdGEpOwogICAgfQoKICAgIC8vIENhY2hlIG1ldGhvZHMKCiAgICBwdWJs
aWMgZnVuY3Rpb24gc2V0Q2FjaGluZygkY2FjaGU9dHJ1ZSkKICAgIHsKICAgICAgICAkdGhp
cy0+X2NhY2hlID0gKCRjYWNoZSkgPyB0cnVlIDogZmFsc2U7CiAgICAgICAgcmV0dXJuIHRy
dWU7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGNhY2hlRGlyKCRsb2MpCiAgICB7CiAg
ICAgICAgJHRoaXMtPl9jYWNoZV9kaXIgPSAkbG9jOwogICAgICAgIHJldHVybiB0cnVlOwog
ICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjYWNoZVRpbWUoJG1pbnMpCiAgICB7CiAgICAg
ICAgJHRoaXMtPl9jYWNoZV90aW1lID0gJG1pbnMqNjA7IC8vIGNvbnZlcnQgbWludXRlcyBp
bnRvIHNlY29uZHMKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcml2YXRlIGZ1
bmN0aW9uIF9yZXRyaWV2ZUNhY2hlKCR1cmwsJG92ZXJpZGVfdGltZW91dD1mYWxzZSkKICAg
IHsKICAgICAgICAkZmlsZSA9ICR0aGlzLT5fY2FjaGVfZGlyLicvJy4kdXJsOwogICAgICAg
IGlmIChmaWxlX2V4aXN0cygkZmlsZSkpIHsKCiAgICAgICAgICAgICRkaWZmID0gdGltZSgp
IC0gZmlsZW10aW1lKCRmaWxlKTsKICAgICAgICAgICAgaWYgKCRvdmVyaWRlX3RpbWVvdXQg
fHwgJGRpZmYgPCAkdGhpcy0+X2NhY2hlX3RpbWUpIHsKICAgICAgICAgICAgICAgIHJldHVy
biBmaWxlX2dldF9jb250ZW50cygkZmlsZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAg
ICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgfSBlbHNl
IHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KfQoKLyoKICog
QWJyYWhhbSBXaWxsaWFtcyAoYWJyYWhhbUBhYnJhaC5hbSkgaHR0cDovL2FicmFoLmFtCiAq
CiAqIFRoZSBmaXJzdCBQSFAgTGlicmFyeSB0byBzdXBwb3J0IE9BdXRoIGZvciBUd2l0dGVy
J3MgUkVTVCBBUEkuCiAqLwoKLyoqCiAqIFR3aXR0ZXIgT0F1dGggY2xhc3MKICovCmNsYXNz
IFR3aXR0ZXJPQXV0aCB7CiAgLyogQ29udGFpbnMgdGhlIGxhc3QgSFRUUCBzdGF0dXMgY29k
ZSByZXR1cm5lZC4gKi8KICBwdWJsaWMgJGh0dHBfY29kZTsKICAvKiBDb250YWlucyB0aGUg
bGFzdCBBUEkgY2FsbC4gKi8KICBwdWJsaWMgJHVybDsKICAvKiBTZXQgdXAgdGhlIEFQSSBy
b290IFVSTC4gKi8KICBwdWJsaWMgJGhvc3QgPSAiaHR0cHM6Ly9hcGkudHdpdHRlci5jb20v
MS8iOwogIC8qIFNldCB0aW1lb3V0IGRlZmF1bHQuICovCiAgcHVibGljICR0aW1lb3V0ID0g
MzA7CiAgLyogU2V0IGNvbm5lY3QgdGltZW91dC4gKi8KICBwdWJsaWMgJGNvbm5lY3R0aW1l
b3V0ID0gMzA7CiAgLyogVmVyaWZ5IFNTTCBDZXJ0LiAqLwogIHB1YmxpYyAkc3NsX3Zlcmlm
eXBlZXIgPSBGQUxTRTsKICAvKiBSZXNwb25zIGZvcm1hdC4gKi8KICBwdWJsaWMgJGZvcm1h
dCA9ICdqc29uJzsKICAvKiBEZWNvZGUgcmV0dXJuZWQganNvbiBkYXRhLiAqLwogIHB1Ymxp
YyAkZGVjb2RlX2pzb24gPSBUUlVFOwogIC8qIENvbnRhaW5zIHRoZSBsYXN0IEhUVFAgaGVh
ZGVycyByZXR1cm5lZC4gKi8KICBwdWJsaWMgJGh0dHBfaW5mbzsKICAvKiBTZXQgdGhlIHVz
ZXJhZ25ldC4gKi8KICBwdWJsaWMgJHVzZXJhZ2VudCA9ICdUd2l0dGVyT0F1dGggdjAuMi4w
LWJldGEyJzsKICAvKiBJbW1lZGlhdGVseSByZXRyeSB0aGUgQVBJIGNhbGwgaWYgdGhlIHJl
c3BvbnNlIHdhcyBub3Qgc3VjY2Vzc2Z1bC4gKi8KICAvL3B1YmxpYyAkcmV0cnkgPSBUUlVF
OwoKCgoKICAvKioKICAgKiBTZXQgQVBJIFVSTFMKICAgKi8KICBmdW5jdGlvbiBhY2Nlc3NU
b2tlblVSTCgpICB7IHJldHVybiAnaHR0cHM6Ly9hcGkudHdpdHRlci5jb20vb2F1dGgvYWNj
ZXNzX3Rva2VuJzsgfQogIGZ1bmN0aW9uIGF1dGhlbnRpY2F0ZVVSTCgpIHsgcmV0dXJuICdo
dHRwczovL3R3aXR0ZXIuY29tL29hdXRoL2F1dGhlbnRpY2F0ZSc7IH0KICBmdW5jdGlvbiBh
dXRob3JpemVVUkwoKSAgICB7IHJldHVybiAnaHR0cHM6Ly90d2l0dGVyLmNvbS9vYXV0aC9h
dXRob3JpemUnOyB9CiAgZnVuY3Rpb24gcmVxdWVzdFRva2VuVVJMKCkgeyByZXR1cm4gJ2h0
dHBzOi8vYXBpLnR3aXR0ZXIuY29tL29hdXRoL3JlcXVlc3RfdG9rZW4nOyB9CgogIC8qKgog
ICAqIERlYnVnIGhlbHBlcnMKICAgKi8KICBmdW5jdGlvbiBsYXN0U3RhdHVzQ29kZSgpIHsg
cmV0dXJuICR0aGlzLT5odHRwX3N0YXR1czsgfQogIGZ1bmN0aW9uIGxhc3RBUElDYWxsKCkg
eyByZXR1cm4gJHRoaXMtPmxhc3RfYXBpX2NhbGw7IH0KCiAgLyoqCiAgICogY29uc3RydWN0
IFR3aXR0ZXJPQXV0aCBvYmplY3QKICAgKi8KICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkY29u
c3VtZXJfa2V5LCAkY29uc3VtZXJfc2VjcmV0LCAkb2F1dGhfdG9rZW4gPSBOVUxMLCAkb2F1
dGhfdG9rZW5fc2VjcmV0ID0gTlVMTCkgewogICAgJHRoaXMtPnNoYTFfbWV0aG9kID0gbmV3
IE9BdXRoU2lnbmF0dXJlTWV0aG9kX0hNQUNfU0hBMSgpOwogICAgJHRoaXMtPmNvbnN1bWVy
ID0gbmV3IE9BdXRoQ29uc3VtZXIoJGNvbnN1bWVyX2tleSwgJGNvbnN1bWVyX3NlY3JldCk7
CiAgICBpZiAoIWVtcHR5KCRvYXV0aF90b2tlbikgJiYgIWVtcHR5KCRvYXV0aF90b2tlbl9z
ZWNyZXQpKSB7CiAgICAgICR0aGlzLT50b2tlbiA9IG5ldyBPQXV0aENvbnN1bWVyKCRvYXV0
aF90b2tlbiwgJG9hdXRoX3Rva2VuX3NlY3JldCk7CiAgICB9IGVsc2UgewogICAgICAkdGhp
cy0+dG9rZW4gPSBOVUxMOwogICAgfQogIH0KCgogIC8qKgogICAqIEdldCBhIHJlcXVlc3Rf
dG9rZW4gZnJvbSBUd2l0dGVyCiAgICoKICAgKiBAcmV0dXJucyBhIGtleS92YWx1ZSBhcnJh
eSBjb250YWluaW5nIG9hdXRoX3Rva2VuIGFuZCBvYXV0aF90b2tlbl9zZWNyZXQKICAgKi8K
ICBmdW5jdGlvbiBnZXRSZXF1ZXN0VG9rZW4oJG9hdXRoX2NhbGxiYWNrID0gTlVMTCkgewog
ICAgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgaWYgKCFlbXB0eSgkb2F1dGhfY2FsbGJh
Y2spKSB7CiAgICAgICRwYXJhbWV0ZXJzWydvYXV0aF9jYWxsYmFjayddID0gJG9hdXRoX2Nh
bGxiYWNrOwogICAgfQogICAgJHJlcXVlc3QgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR0aGlz
LT5yZXF1ZXN0VG9rZW5VUkwoKSwgJ0dFVCcsICRwYXJhbWV0ZXJzKTsKICAgICR0b2tlbiA9
IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygkcmVxdWVzdCk7CiAgICAkdGhpcy0+dG9r
ZW4gPSBuZXcgT0F1dGhDb25zdW1lcigkdG9rZW5bJ29hdXRoX3Rva2VuJ10sICR0b2tlblsn
b2F1dGhfdG9rZW5fc2VjcmV0J10pOwogICAgcmV0dXJuICR0b2tlbjsKICB9CgogIC8qKgog
ICAqIEdldCB0aGUgYXV0aG9yaXplIFVSTAogICAqCiAgICogQHJldHVybnMgYSBzdHJpbmcK
ICAgKi8KICBmdW5jdGlvbiBnZXRBdXRob3JpemVVUkwoJHRva2VuLCAkc2lnbl9pbl93aXRo
X3R3aXR0ZXIgPSBUUlVFKSB7CiAgICBpZiAoaXNfYXJyYXkoJHRva2VuKSkgewogICAgICAk
dG9rZW4gPSAkdG9rZW5bJ29hdXRoX3Rva2VuJ107CiAgICB9CiAgICBpZiAoZW1wdHkoJHNp
Z25faW5fd2l0aF90d2l0dGVyKSkgewogICAgICByZXR1cm4gJHRoaXMtPmF1dGhvcml6ZVVS
TCgpIC4gIj9vYXV0aF90b2tlbj17JHRva2VufSI7CiAgICB9IGVsc2UgewogICAgICAgcmV0
dXJuICR0aGlzLT5hdXRoZW50aWNhdGVVUkwoKSAuICI/b2F1dGhfdG9rZW49eyR0b2tlbn0i
OwogICAgfQogIH0KCiAgLyoqCiAgICogRXhjaGFuZ2UgcmVxdWVzdCB0b2tlbiBhbmQgc2Vj
cmV0IGZvciBhbiBhY2Nlc3MgdG9rZW4gYW5kCiAgICogc2VjcmV0LCB0byBzaWduIEFQSSBj
YWxscy4KICAgKgogICAqIEByZXR1cm5zIGFycmF5KCJvYXV0aF90b2tlbiIgPT4gInRoZS1h
Y2Nlc3MtdG9rZW4iLAogICAqICAgICAgICAgICAgICAgICJvYXV0aF90b2tlbl9zZWNyZXQi
ID0+ICJ0aGUtYWNjZXNzLXNlY3JldCIsCiAgICogICAgICAgICAgICAgICAgInVzZXJfaWQi
ID0+ICI5NDM2OTkyIiwKICAgKiAgICAgICAgICAgICAgICAic2NyZWVuX25hbWUiID0+ICJh
YnJhaGFtIikKICAgKi8KICBmdW5jdGlvbiBnZXRBY2Nlc3NUb2tlbigkb2F1dGhfdmVyaWZp
ZXIgPSBGQUxTRSkgewogICAgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgaWYgKCFlbXB0
eSgkb2F1dGhfdmVyaWZpZXIpKSB7CiAgICAgICRwYXJhbWV0ZXJzWydvYXV0aF92ZXJpZmll
ciddID0gJG9hdXRoX3ZlcmlmaWVyOwogICAgfQogICAgJHJlcXVlc3QgPSAkdGhpcy0+b0F1
dGhSZXF1ZXN0KCR0aGlzLT5hY2Nlc3NUb2tlblVSTCgpLCAnR0VUJywgJHBhcmFtZXRlcnMp
OwogICAgJHRva2VuID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKCRyZXF1ZXN0KTsK
ICAgICR0aGlzLT50b2tlbiA9IG5ldyBPQXV0aENvbnN1bWVyKCR0b2tlblsnb2F1dGhfdG9r
ZW4nXSwgJHRva2VuWydvYXV0aF90b2tlbl9zZWNyZXQnXSk7CiAgICByZXR1cm4gJHRva2Vu
OwogIH0KCiAgLyoqCiAgICogT25lIHRpbWUgZXhjaGFuZ2Ugb2YgdXNlcm5hbWUgYW5kIHBh
c3N3b3JkIGZvciBhY2Nlc3MgdG9rZW4gYW5kIHNlY3JldC4KICAgKgogICAqIEByZXR1cm5z
IGFycmF5KCJvYXV0aF90b2tlbiIgPT4gInRoZS1hY2Nlc3MtdG9rZW4iLAogICAqICAgICAg
ICAgICAgICAgICJvYXV0aF90b2tlbl9zZWNyZXQiID0+ICJ0aGUtYWNjZXNzLXNlY3JldCIs
CiAgICogICAgICAgICAgICAgICAgInVzZXJfaWQiID0+ICI5NDM2OTkyIiwKICAgKiAgICAg
ICAgICAgICAgICAic2NyZWVuX25hbWUiID0+ICJhYnJhaGFtIiwKICAgKiAgICAgICAgICAg
ICAgICAieF9hdXRoX2V4cGlyZXMiID0+ICIwIikKICAgKi8KICBmdW5jdGlvbiBnZXRYQXV0
aFRva2VuKCR1c2VybmFtZSwgJHBhc3N3b3JkKSB7CiAgICAkcGFyYW1ldGVycyA9IGFycmF5
KCk7CiAgICAkcGFyYW1ldGVyc1sneF9hdXRoX3VzZXJuYW1lJ10gPSAkdXNlcm5hbWU7CiAg
ICAkcGFyYW1ldGVyc1sneF9hdXRoX3Bhc3N3b3JkJ10gPSAkcGFzc3dvcmQ7CiAgICAkcGFy
YW1ldGVyc1sneF9hdXRoX21vZGUnXSA9ICdjbGllbnRfYXV0aCc7CiAgICAkcmVxdWVzdCA9
ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHRoaXMtPmFjY2Vzc1Rva2VuVVJMKCksICdQT1NUJywg
JHBhcmFtZXRlcnMpOwogICAgJHRva2VuID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJz
KCRyZXF1ZXN0KTsKICAgICR0aGlzLT50b2tlbiA9IG5ldyBPQXV0aENvbnN1bWVyKCR0b2tl
blsnb2F1dGhfdG9rZW4nXSwgJHRva2VuWydvYXV0aF90b2tlbl9zZWNyZXQnXSk7CiAgICBy
ZXR1cm4gJHRva2VuOwogIH0KCiAgLyoqCiAgICogR0VUIHdyYXBwZXIgZm9yIG9BdXRoUmVx
dWVzdC4KICAgKi8KICBmdW5jdGlvbiBnZXQoJHVybCwgJHBhcmFtZXRlcnMgPSBhcnJheSgp
KSB7CiAgICAkcmVzcG9uc2UgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR1cmwsICdHRVQnLCAk
cGFyYW1ldGVycyk7CiAgICBpZiAoJHRoaXMtPmZvcm1hdCA9PT0gJ2pzb24nICYmICR0aGlz
LT5kZWNvZGVfanNvbikgewogICAgICByZXR1cm4ganNvbl9kZWNvZGUoJHJlc3BvbnNlKTsK
ICAgIH0KICAgIHJldHVybiAkcmVzcG9uc2U7CiAgfQoKICAvKioKICAgKiBQT1NUIHdyYXBw
ZXIgZm9yIG9BdXRoUmVxdWVzdC4KICAgKi8KICBmdW5jdGlvbiBwb3N0KCR1cmwsICRwYXJh
bWV0ZXJzID0gYXJyYXkoKSkgewogICAgJHJlc3BvbnNlID0gJHRoaXMtPm9BdXRoUmVxdWVz
dCgkdXJsLCAnUE9TVCcsICRwYXJhbWV0ZXJzKTsKICAgIGlmICgkdGhpcy0+Zm9ybWF0ID09
PSAnanNvbicgJiYgJHRoaXMtPmRlY29kZV9qc29uKSB7CiAgICAgIHJldHVybiBqc29uX2Rl
Y29kZSgkcmVzcG9uc2UpOwogICAgfQogICAgcmV0dXJuICRyZXNwb25zZTsKICB9CgogIC8q
KgogICAqIERFTEVURSB3cmFwcGVyIGZvciBvQXV0aFJlcWV1c3QuCiAgICovCiAgZnVuY3Rp
b24gZGVsZXRlKCR1cmwsICRwYXJhbWV0ZXJzID0gYXJyYXkoKSkgewogICAgJHJlc3BvbnNl
ID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdXJsLCAnREVMRVRFJywgJHBhcmFtZXRlcnMpOwog
ICAgaWYgKCR0aGlzLT5mb3JtYXQgPT09ICdqc29uJyAmJiAkdGhpcy0+ZGVjb2RlX2pzb24p
IHsKICAgICAgcmV0dXJuIGpzb25fZGVjb2RlKCRyZXNwb25zZSk7CiAgICB9CiAgICByZXR1
cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoqCiAgICogRm9ybWF0IGFuZCBzaWduIGFuIE9BdXRo
IC8gQVBJIHJlcXVlc3QKICAgKi8KICBmdW5jdGlvbiBvQXV0aFJlcXVlc3QoJHVybCwgJG1l
dGhvZCwgJHBhcmFtZXRlcnMpIHsKICAgIGlmIChzdHJycG9zKCR1cmwsICdodHRwczovLycp
ICE9PSAwICYmIHN0cnJwb3MoJHVybCwgJ2h0dHA6Ly8nKSAhPT0gMCkgewogICAgICAkdXJs
ID0gInskdGhpcy0+aG9zdH17JHVybH0ueyR0aGlzLT5mb3JtYXR9IjsKICAgIH0KICAgICRy
ZXF1ZXN0ID0gT0F1dGhSZXF1ZXN0Ojpmcm9tX2NvbnN1bWVyX2FuZF90b2tlbigkdGhpcy0+
Y29uc3VtZXIsICR0aGlzLT50b2tlbiwgJG1ldGhvZCwgJHVybCwgJHBhcmFtZXRlcnMpOwog
ICAgJHJlcXVlc3QtPnNpZ25fcmVxdWVzdCgkdGhpcy0+c2hhMV9tZXRob2QsICR0aGlzLT5j
b25zdW1lciwgJHRoaXMtPnRva2VuKTsKICAgIHN3aXRjaCAoJG1ldGhvZCkgewogICAgY2Fz
ZSAnR0VUJzoKICAgICAgcmV0dXJuICR0aGlzLT5odHRwKCRyZXF1ZXN0LT50b191cmwoKSwg
J0dFVCcpOwogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuICR0aGlzLT5odHRwKCRyZXF1ZXN0
LT5nZXRfbm9ybWFsaXplZF9odHRwX3VybCgpLCAkbWV0aG9kLCAkcmVxdWVzdC0+dG9fcG9z
dGRhdGEoKSk7CiAgICB9CiAgfQoKICAvKioKICAgKiBNYWtlIGFuIEhUVFAgcmVxdWVzdAog
ICAqCiAgICogQHJldHVybiBBUEkgcmVzdWx0cwogICAqLwogIGZ1bmN0aW9uIGh0dHAoJHVy
bCwgJG1ldGhvZCwgJHBvc3RmaWVsZHMgPSBOVUxMKSB7CiAgICAkdGhpcy0+aHR0cF9pbmZv
ID0gYXJyYXkoKTsKICAgICRjaSA9IGN1cmxfaW5pdCgpOwogICAgLyogQ3VybCBzZXR0aW5n
cyAqLwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1VTRVJBR0VOVCwgJHRoaXMtPnVz
ZXJhZ2VudCk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfQ09OTkVDVFRJTUVPVVQs
ICR0aGlzLT5jb25uZWN0dGltZW91dCk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRf
VElNRU9VVCwgJHRoaXMtPnRpbWVvdXQpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BU
X1JFVFVSTlRSQU5TRkVSLCBUUlVFKTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9I
VFRQSEVBREVSLCBhcnJheSgnRXhwZWN0OicpKTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VS
TE9QVF9TU0xfVkVSSUZZUEVFUiwgJHRoaXMtPnNzbF92ZXJpZnlwZWVyKTsKICAgIGN1cmxf
c2V0b3B0KCRjaSwgQ1VSTE9QVF9IRUFERVJGVU5DVElPTiwgYXJyYXkoJHRoaXMsICdnZXRI
ZWFkZXInKSk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfSEVBREVSLCBGQUxTRSk7
CgogICAgc3dpdGNoICgkbWV0aG9kKSB7CiAgICAgIGNhc2UgJ1BPU1QnOgogICAgICAgIGN1
cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9QT1NULCBUUlVFKTsKICAgICAgICBpZiAoIWVtcHR5
KCRwb3N0ZmllbGRzKSkgewogICAgICAgICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1BP
U1RGSUVMRFMsICRwb3N0ZmllbGRzKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAg
IGNhc2UgJ0RFTEVURSc6CiAgICAgICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0NVU1RP
TVJFUVVFU1QsICdERUxFVEUnKTsKICAgICAgICBpZiAoIWVtcHR5KCRwb3N0ZmllbGRzKSkg
ewogICAgICAgICAgJHVybCA9ICJ7JHVybH0/eyRwb3N0ZmllbGRzfSI7CiAgICAgICAgfQog
ICAgfQoKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9VUkwsICR1cmwpOwogICAgJHJl
c3BvbnNlID0gY3VybF9leGVjKCRjaSk7CiAgICAkdGhpcy0+aHR0cF9jb2RlID0gY3VybF9n
ZXRpbmZvKCRjaSwgQ1VSTElORk9fSFRUUF9DT0RFKTsKICAgICR0aGlzLT5odHRwX2luZm8g
PSBhcnJheV9tZXJnZSgkdGhpcy0+aHR0cF9pbmZvLCBjdXJsX2dldGluZm8oJGNpKSk7CiAg
ICAkdGhpcy0+dXJsID0gJHVybDsKICAgIGN1cmxfY2xvc2UgKCRjaSk7CiAgICByZXR1cm4g
JHJlc3BvbnNlOwogIH0KCiAgLyoqCiAgICogR2V0IHRoZSBoZWFkZXIgaW5mbyB0byBzdG9y
ZS4KICAgKi8KICBmdW5jdGlvbiBnZXRIZWFkZXIoJGNoLCAkaGVhZGVyKSB7CiAgICAkaSA9
IHN0cnBvcygkaGVhZGVyLCAnOicpOwogICAgaWYgKCFlbXB0eSgkaSkpIHsKICAgICAgJGtl
eSA9IHN0cl9yZXBsYWNlKCctJywgJ18nLCBzdHJ0b2xvd2VyKHN1YnN0cigkaGVhZGVyLCAw
LCAkaSkpKTsKICAgICAgJHZhbHVlID0gdHJpbShzdWJzdHIoJGhlYWRlciwgJGkgKyAyKSk7
CiAgICAgICR0aGlzLT5odHRwX2hlYWRlclska2V5XSA9ICR2YWx1ZTsKICAgIH0KICAgIHJl
dHVybiBzdHJsZW4oJGhlYWRlcik7CiAgfQp9CgpjbGFzcyBPQXV0aEV4Y2VwdGlvbiBleHRl
bmRzIEV4Y2VwdGlvbiB7CiAgLy8gcGFzcwp9CgpjbGFzcyBPQXV0aENvbnN1bWVyIHsKICBw
dWJsaWMgJGtleTsKICBwdWJsaWMgJHNlY3JldDsKCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3Qo
JGtleSwgJHNlY3JldCwgJGNhbGxiYWNrX3VybD1OVUxMKSB7CiAgICAkdGhpcy0+a2V5ID0g
JGtleTsKICAgICR0aGlzLT5zZWNyZXQgPSAkc2VjcmV0OwogICAgJHRoaXMtPmNhbGxiYWNr
X3VybCA9ICRjYWxsYmFja191cmw7CiAgfQoKICBmdW5jdGlvbiBfX3RvU3RyaW5nKCkgewog
ICAgcmV0dXJuICJPQXV0aENvbnN1bWVyW2tleT0kdGhpcy0+a2V5LHNlY3JldD0kdGhpcy0+
c2VjcmV0XSI7CiAgfQp9CgpjbGFzcyBPQXV0aFRva2VuIHsKICAvLyBhY2Nlc3MgdG9rZW5z
IGFuZCByZXF1ZXN0IHRva2VucwogIHB1YmxpYyAka2V5OwogIHB1YmxpYyAkc2VjcmV0OwoK
ICAvKioKICAgKiBrZXkgPSB0aGUgdG9rZW4KICAgKiBzZWNyZXQgPSB0aGUgdG9rZW4gc2Vj
cmV0CiAgICovCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGtleSwgJHNlY3JldCkgewogICAg
JHRoaXMtPmtleSA9ICRrZXk7CiAgICAkdGhpcy0+c2VjcmV0ID0gJHNlY3JldDsKICB9Cgog
IC8qKgogICAqIGdlbmVyYXRlcyB0aGUgYmFzaWMgc3RyaW5nIHNlcmlhbGl6YXRpb24gb2Yg
YSB0b2tlbiB0aGF0IGEgc2VydmVyCiAgICogd291bGQgcmVzcG9uZCB0byByZXF1ZXN0X3Rv
a2VuIGFuZCBhY2Nlc3NfdG9rZW4gY2FsbHMgd2l0aAogICAqLwogIGZ1bmN0aW9uIHRvX3N0
cmluZygpIHsKICAgIHJldHVybiAib2F1dGhfdG9rZW49IiAuCiAgICAgICAgICAgT0F1dGhV
dGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkdGhpcy0+a2V5KSAuCiAgICAgICAgICAgIiZvYXV0
aF90b2tlbl9zZWNyZXQ9IiAuCiAgICAgICAgICAgT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZj
Mzk4NigkdGhpcy0+c2VjcmV0KTsKICB9CgogIGZ1bmN0aW9uIF9fdG9TdHJpbmcoKSB7CiAg
ICByZXR1cm4gJHRoaXMtPnRvX3N0cmluZygpOwogIH0KfQoKLyoqCiAqIEEgY2xhc3MgZm9y
IGltcGxlbWVudGluZyBhIFNpZ25hdHVyZSBNZXRob2QKICogU2VlIHNlY3Rpb24gOSAoIlNp
Z25pbmcgUmVxdWVzdHMiKSBpbiB0aGUgc3BlYwogKi8KYWJzdHJhY3QgY2xhc3MgT0F1dGhT
aWduYXR1cmVNZXRob2QgewogIC8qKgogICAqIE5lZWRzIHRvIHJldHVybiB0aGUgbmFtZSBv
ZiB0aGUgU2lnbmF0dXJlIE1ldGhvZCAoaWUgSE1BQy1TSEExKQogICAqIEByZXR1cm4gc3Ry
aW5nCiAgICovCiAgYWJzdHJhY3QgcHVibGljIGZ1bmN0aW9uIGdldF9uYW1lKCk7CgogIC8q
KgogICAqIEJ1aWxkIHVwIHRoZSBzaWduYXR1cmUKICAgKiBOT1RFOiBUaGUgb3V0cHV0IG9m
IHRoaXMgZnVuY3Rpb24gTVVTVCBOT1QgYmUgdXJsZW5jb2RlZC4KICAgKiB0aGUgZW5jb2Rp
bmcgaXMgaGFuZGxlZCBpbiBPQXV0aFJlcXVlc3Qgd2hlbiB0aGUgZmluYWwKICAgKiByZXF1
ZXN0IGlzIHNlcmlhbGl6ZWQKICAgKiBAcGFyYW0gT0F1dGhSZXF1ZXN0ICRyZXF1ZXN0CiAg
ICogQHBhcmFtIE9BdXRoQ29uc3VtZXIgJGNvbnN1bWVyCiAgICogQHBhcmFtIE9BdXRoVG9r
ZW4gJHRva2VuCiAgICogQHJldHVybiBzdHJpbmcKICAgKi8KICBhYnN0cmFjdCBwdWJsaWMg
ZnVuY3Rpb24gYnVpbGRfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7
CgogIC8qKgogICAqIFZlcmlmaWVzIHRoYXQgYSBnaXZlbiBzaWduYXR1cmUgaXMgY29ycmVj
dAogICAqIEBwYXJhbSBPQXV0aFJlcXVlc3QgJHJlcXVlc3QKICAgKiBAcGFyYW0gT0F1dGhD
b25zdW1lciAkY29uc3VtZXIKICAgKiBAcGFyYW0gT0F1dGhUb2tlbiAkdG9rZW4KICAgKiBA
cGFyYW0gc3RyaW5nICRzaWduYXR1cmUKICAgKiBAcmV0dXJuIGJvb2wKICAgKi8KICBwdWJs
aWMgZnVuY3Rpb24gY2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tl
biwgJHNpZ25hdHVyZSkgewogICAgJGJ1aWx0ID0gJHRoaXMtPmJ1aWxkX3NpZ25hdHVyZSgk
cmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAgcmV0dXJuICRidWlsdCA9PSAkc2ln
bmF0dXJlOwogIH0KfQoKLyoqCiAqIFRoZSBITUFDLVNIQTEgc2lnbmF0dXJlIG1ldGhvZCB1
c2VzIHRoZSBITUFDLVNIQTEgc2lnbmF0dXJlIGFsZ29yaXRobSBhcyBkZWZpbmVkIGluIFtS
RkMyMTA0XQogKiB3aGVyZSB0aGUgU2lnbmF0dXJlIEJhc2UgU3RyaW5nIGlzIHRoZSB0ZXh0
IGFuZCB0aGUga2V5IGlzIHRoZSBjb25jYXRlbmF0ZWQgdmFsdWVzIChlYWNoIGZpcnN0CiAq
IGVuY29kZWQgcGVyIFBhcmFtZXRlciBFbmNvZGluZykgb2YgdGhlIENvbnN1bWVyIFNlY3Jl
dCBhbmQgVG9rZW4gU2VjcmV0LCBzZXBhcmF0ZWQgYnkgYW4gJyYnCiAqIGNoYXJhY3RlciAo
QVNDSUkgY29kZSAzOCkgZXZlbiBpZiBlbXB0eS4KICogICAtIENoYXB0ZXIgOS4yICgiSE1B
Qy1TSEExIikKICovCmNsYXNzIE9BdXRoU2lnbmF0dXJlTWV0aG9kX0hNQUNfU0hBMSBleHRl
bmRzIE9BdXRoU2lnbmF0dXJlTWV0aG9kIHsKICBmdW5jdGlvbiBnZXRfbmFtZSgpIHsKICAg
IHJldHVybiAiSE1BQy1TSEExIjsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWdu
YXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAkYmFzZV9zdHJpbmcg
PSAkcmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpOwogICAgJHJlcXVlc3Qt
PmJhc2Vfc3RyaW5nID0gJGJhc2Vfc3RyaW5nOwoKICAgICRrZXlfcGFydHMgPSBhcnJheSgK
ICAgICAgJGNvbnN1bWVyLT5zZWNyZXQsCiAgICAgICgkdG9rZW4pID8gJHRva2VuLT5zZWNy
ZXQgOiAiIgogICAgKTsKCiAgICAka2V5X3BhcnRzID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVf
cmZjMzk4Nigka2V5X3BhcnRzKTsKICAgICRrZXkgPSBpbXBsb2RlKCcmJywgJGtleV9wYXJ0
cyk7CgogICAgcmV0dXJuIGJhc2U2NF9lbmNvZGUoaGFzaF9obWFjKCdzaGExJywgJGJhc2Vf
c3RyaW5nLCAka2V5LCB0cnVlKSk7CiAgfQp9CgovKioKICogVGhlIFBMQUlOVEVYVCBtZXRo
b2QgZG9lcyBub3QgcHJvdmlkZSBhbnkgc2VjdXJpdHkgcHJvdGVjdGlvbiBhbmQgU0hPVUxE
IG9ubHkgYmUgdXNlZAogKiBvdmVyIGEgc2VjdXJlIGNoYW5uZWwgc3VjaCBhcyBIVFRQUy4g
SXQgZG9lcyBub3QgdXNlIHRoZSBTaWduYXR1cmUgQmFzZSBTdHJpbmcuCiAqICAgLSBDaGFw
dGVyIDkuNCAoIlBMQUlOVEVYVCIpCiAqLwpjbGFzcyBPQXV0aFNpZ25hdHVyZU1ldGhvZF9Q
TEFJTlRFWFQgZXh0ZW5kcyBPQXV0aFNpZ25hdHVyZU1ldGhvZCB7CiAgcHVibGljIGZ1bmN0
aW9uIGdldF9uYW1lKCkgewogICAgcmV0dXJuICJQTEFJTlRFWFQiOwogIH0KCiAgLyoqCiAg
ICogb2F1dGhfc2lnbmF0dXJlIGlzIHNldCB0byB0aGUgY29uY2F0ZW5hdGVkIGVuY29kZWQg
dmFsdWVzIG9mIHRoZSBDb25zdW1lciBTZWNyZXQgYW5kCiAgICogVG9rZW4gU2VjcmV0LCBz
ZXBhcmF0ZWQgYnkgYSAnJicgY2hhcmFjdGVyIChBU0NJSSBjb2RlIDM4KSwgZXZlbiBpZiBl
aXRoZXIgc2VjcmV0IGlzCiAgICogZW1wdHkuIFRoZSByZXN1bHQgTVVTVCBiZSBlbmNvZGVk
IGFnYWluLgogICAqICAgLSBDaGFwdGVyIDkuNC4xICgiR2VuZXJhdGluZyBTaWduYXR1cmVz
IikKICAgKgogICAqIFBsZWFzZSBub3RlIHRoYXQgdGhlIHNlY29uZCBlbmNvZGluZyBNVVNU
IE5PVCBoYXBwZW4gaW4gdGhlIFNpZ25hdHVyZU1ldGhvZCwgYXMKICAgKiBPQXV0aFJlcXVl
c3QgaGFuZGxlcyB0aGlzIQogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWduYXR1
cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAka2V5X3BhcnRzID0gYXJy
YXkoCiAgICAgICRjb25zdW1lci0+c2VjcmV0LAogICAgICAoJHRva2VuKSA/ICR0b2tlbi0+
c2VjcmV0IDogIiIKICAgICk7CgogICAgJGtleV9wYXJ0cyA9IE9BdXRoVXRpbDo6dXJsZW5j
b2RlX3JmYzM5ODYoJGtleV9wYXJ0cyk7CiAgICAka2V5ID0gaW1wbG9kZSgnJicsICRrZXlf
cGFydHMpOwogICAgJHJlcXVlc3QtPmJhc2Vfc3RyaW5nID0gJGtleTsKCiAgICByZXR1cm4g
JGtleTsKICB9Cn0KCi8qKgogKiBUaGUgUlNBLVNIQTEgc2lnbmF0dXJlIG1ldGhvZCB1c2Vz
IHRoZSBSU0FTU0EtUEtDUzEtdjFfNSBzaWduYXR1cmUgYWxnb3JpdGhtIGFzIGRlZmluZWQg
aW4KICogW1JGQzM0NDddIHNlY3Rpb24gOC4yIChtb3JlIHNpbXBseSBrbm93biBhcyBQS0NT
IzEpLCB1c2luZyBTSEEtMSBhcyB0aGUgaGFzaCBmdW5jdGlvbiBmb3IKICogRU1TQS1QS0NT
MS12MV81LiBJdCBpcyBhc3N1bWVkIHRoYXQgdGhlIENvbnN1bWVyIGhhcyBwcm92aWRlZCBp
dHMgUlNBIHB1YmxpYyBrZXkgaW4gYQogKiB2ZXJpZmllZCB3YXkgdG8gdGhlIFNlcnZpY2Ug
UHJvdmlkZXIsIGluIGEgbWFubmVyIHdoaWNoIGlzIGJleW9uZCB0aGUgc2NvcGUgb2YgdGhp
cwogKiBzcGVjaWZpY2F0aW9uLgogKiAgIC0gQ2hhcHRlciA5LjMgKCJSU0EtU0hBMSIpCiAq
LwphYnN0cmFjdCBjbGFzcyBPQXV0aFNpZ25hdHVyZU1ldGhvZF9SU0FfU0hBMSBleHRlbmRz
IE9BdXRoU2lnbmF0dXJlTWV0aG9kIHsKICBwdWJsaWMgZnVuY3Rpb24gZ2V0X25hbWUoKSB7
CiAgICByZXR1cm4gIlJTQS1TSEExIjsKICB9CgogIC8vIFVwIHRvIHRoZSBTUCB0byBpbXBs
ZW1lbnQgdGhpcyBsb29rdXAgb2Yga2V5cy4gUG9zc2libGUgaWRlYXMgYXJlOgogIC8vICgx
KSBkbyBhIGxvb2t1cCBpbiBhIHRhYmxlIG9mIHRydXN0ZWQgY2VydHMga2V5ZWQgb2ZmIG9m
IGNvbnN1bWVyCiAgLy8gKDIpIGZldGNoIHZpYSBodHRwIHVzaW5nIGEgdXJsIHByb3ZpZGVk
IGJ5IHRoZSByZXF1ZXN0ZXIKICAvLyAoMykgc29tZSBzb3J0IG9mIHNwZWNpZmljIGRpc2Nv
dmVyeSBjb2RlIGJhc2VkIG9uIHJlcXVlc3QKICAvLwogIC8vIEVpdGhlciB3YXkgc2hvdWxk
IHJldHVybiBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgY2VydGlmaWNhdGUKICBw
cm90ZWN0ZWQgYWJzdHJhY3QgZnVuY3Rpb24gZmV0Y2hfcHVibGljX2NlcnQoJiRyZXF1ZXN0
KTsKCiAgLy8gVXAgdG8gdGhlIFNQIHRvIGltcGxlbWVudCB0aGlzIGxvb2t1cCBvZiBrZXlz
LiBQb3NzaWJsZSBpZGVhcyBhcmU6CiAgLy8gKDEpIGRvIGEgbG9va3VwIGluIGEgdGFibGUg
b2YgdHJ1c3RlZCBjZXJ0cyBrZXllZCBvZmYgb2YgY29uc3VtZXIKICAvLwogIC8vIEVpdGhl
ciB3YXkgc2hvdWxkIHJldHVybiBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgY2Vy
dGlmaWNhdGUKICBwcm90ZWN0ZWQgYWJzdHJhY3QgZnVuY3Rpb24gZmV0Y2hfcHJpdmF0ZV9j
ZXJ0KCYkcmVxdWVzdCk7CgogIHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHJl
cXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAkYmFzZV9zdHJpbmcgPSAkcmVxdWVz
dC0+Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpOwogICAgJHJlcXVlc3QtPmJhc2Vfc3Ry
aW5nID0gJGJhc2Vfc3RyaW5nOwoKICAgIC8vIEZldGNoIHRoZSBwcml2YXRlIGtleSBjZXJ0
IGJhc2VkIG9uIHRoZSByZXF1ZXN0CiAgICAkY2VydCA9ICR0aGlzLT5mZXRjaF9wcml2YXRl
X2NlcnQoJHJlcXVlc3QpOwoKICAgIC8vIFB1bGwgdGhlIHByaXZhdGUga2V5IElEIGZyb20g
dGhlIGNlcnRpZmljYXRlCiAgICAkcHJpdmF0ZWtleWlkID0gb3BlbnNzbF9nZXRfcHJpdmF0
ZWtleSgkY2VydCk7CgogICAgLy8gU2lnbiB1c2luZyB0aGUga2V5CiAgICAkb2sgPSBvcGVu
c3NsX3NpZ24oJGJhc2Vfc3RyaW5nLCAkc2lnbmF0dXJlLCAkcHJpdmF0ZWtleWlkKTsKCiAg
ICAvLyBSZWxlYXNlIHRoZSBrZXkgcmVzb3VyY2UKICAgIG9wZW5zc2xfZnJlZV9rZXkoJHBy
aXZhdGVrZXlpZCk7CgogICAgcmV0dXJuIGJhc2U2NF9lbmNvZGUoJHNpZ25hdHVyZSk7CiAg
fQoKICBwdWJsaWMgZnVuY3Rpb24gY2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3Vt
ZXIsICR0b2tlbiwgJHNpZ25hdHVyZSkgewogICAgJGRlY29kZWRfc2lnID0gYmFzZTY0X2Rl
Y29kZSgkc2lnbmF0dXJlKTsKCiAgICAkYmFzZV9zdHJpbmcgPSAkcmVxdWVzdC0+Z2V0X3Np
Z25hdHVyZV9iYXNlX3N0cmluZygpOwoKICAgIC8vIEZldGNoIHRoZSBwdWJsaWMga2V5IGNl
cnQgYmFzZWQgb24gdGhlIHJlcXVlc3QKICAgICRjZXJ0ID0gJHRoaXMtPmZldGNoX3B1Ymxp
Y19jZXJ0KCRyZXF1ZXN0KTsKCiAgICAvLyBQdWxsIHRoZSBwdWJsaWMga2V5IElEIGZyb20g
dGhlIGNlcnRpZmljYXRlCiAgICAkcHVibGlja2V5aWQgPSBvcGVuc3NsX2dldF9wdWJsaWNr
ZXkoJGNlcnQpOwoKICAgIC8vIENoZWNrIHRoZSBjb21wdXRlZCBzaWduYXR1cmUgYWdhaW5z
dCB0aGUgb25lIHBhc3NlZCBpbiB0aGUgcXVlcnkKICAgICRvayA9IG9wZW5zc2xfdmVyaWZ5
KCRiYXNlX3N0cmluZywgJGRlY29kZWRfc2lnLCAkcHVibGlja2V5aWQpOwoKICAgIC8vIFJl
bGVhc2UgdGhlIGtleSByZXNvdXJjZQogICAgb3BlbnNzbF9mcmVlX2tleSgkcHVibGlja2V5
aWQpOwoKICAgIHJldHVybiAkb2sgPT0gMTsKICB9Cn0KCmNsYXNzIE9BdXRoUmVxdWVzdCB7
CiAgcHJpdmF0ZSAkcGFyYW1ldGVyczsKICBwcml2YXRlICRodHRwX21ldGhvZDsKICBwcml2
YXRlICRodHRwX3VybDsKICAvLyBmb3IgZGVidWcgcHVycG9zZXMKICBwdWJsaWMgJGJhc2Vf
c3RyaW5nOwogIHB1YmxpYyBzdGF0aWMgJHZlcnNpb24gPSAnMS4wJzsKICBwdWJsaWMgc3Rh
dGljICRQT1NUX0lOUFVUID0gJ3BocDovL2lucHV0JzsKCiAgZnVuY3Rpb24gX19jb25zdHJ1
Y3QoJGh0dHBfbWV0aG9kLCAkaHR0cF91cmwsICRwYXJhbWV0ZXJzPU5VTEwpIHsKICAgIEAk
cGFyYW1ldGVycyBvciAkcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICAkcGFyYW1ldGVycyA9
IGFycmF5X21lcmdlKCBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMocGFyc2VfdXJsKCRo
dHRwX3VybCwgUEhQX1VSTF9RVUVSWSkpLCAkcGFyYW1ldGVycyk7CiAgICAkdGhpcy0+cGFy
YW1ldGVycyA9ICRwYXJhbWV0ZXJzOwogICAgJHRoaXMtPmh0dHBfbWV0aG9kID0gJGh0dHBf
bWV0aG9kOwogICAgJHRoaXMtPmh0dHBfdXJsID0gJGh0dHBfdXJsOwogIH0KCgogIC8qKgog
ICAqIGF0dGVtcHQgdG8gYnVpbGQgdXAgYSByZXF1ZXN0IGZyb20gd2hhdCB3YXMgcGFzc2Vk
IHRvIHRoZSBzZXJ2ZXIKICAgKi8KICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGZyb21fcmVx
dWVzdCgkaHR0cF9tZXRob2Q9TlVMTCwgJGh0dHBfdXJsPU5VTEwsICRwYXJhbWV0ZXJzPU5V
TEwpIHsKICAgICRzY2hlbWUgPSAoIWlzc2V0KCRfU0VSVkVSWydIVFRQUyddKSB8fCAkX1NF
UlZFUlsnSFRUUFMnXSAhPSAib24iKQogICAgICAgICAgICAgID8gJ2h0dHAnCiAgICAgICAg
ICAgICAgOiAnaHR0cHMnOwogICAgQCRodHRwX3VybCBvciAkaHR0cF91cmwgPSAkc2NoZW1l
IC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzovLycgLiAkX1NFUlZFUlsnSFRU
UF9IT1NUJ10gLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnOicgLgogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAkX1NFUlZFUlsnU0VSVkVSX1BPUlQnXSAuCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICRfU0VSVkVSWydSRVFVRVNUX1VSSSddOwogICAg
QCRodHRwX21ldGhvZCBvciAkaHR0cF9tZXRob2QgPSAkX1NFUlZFUlsnUkVRVUVTVF9NRVRI
T0QnXTsKCiAgICAvLyBXZSB3ZXJlbid0IGhhbmRlZCBhbnkgcGFyYW1ldGVycywgc28gbGV0
J3MgZmluZCB0aGUgb25lcyByZWxldmFudCB0bwogICAgLy8gdGhpcyByZXF1ZXN0LgogICAg
Ly8gSWYgeW91IHJ1biBYTUwtUlBDIG9yIHNpbWlsYXIgeW91IHNob3VsZCB1c2UgdGhpcyB0
byBwcm92aWRlIHlvdXIgb3duCiAgICAvLyBwYXJzZWQgcGFyYW1ldGVyLWxpc3QKICAgIGlm
ICghJHBhcmFtZXRlcnMpIHsKICAgICAgLy8gRmluZCByZXF1ZXN0IGhlYWRlcnMKICAgICAg
JHJlcXVlc3RfaGVhZGVycyA9IE9BdXRoVXRpbDo6Z2V0X2hlYWRlcnMoKTsKCiAgICAgIC8v
IFBhcnNlIHRoZSBxdWVyeS1zdHJpbmcgdG8gZmluZCBHRVQgcGFyYW1ldGVycwogICAgICAk
cGFyYW1ldGVycyA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygkX1NFUlZFUlsnUVVF
UllfU1RSSU5HJ10pOwoKICAgICAgLy8gSXQncyBhIFBPU1QgcmVxdWVzdCBvZiB0aGUgcHJv
cGVyIGNvbnRlbnQtdHlwZSwgc28gcGFyc2UgUE9TVAogICAgICAvLyBwYXJhbWV0ZXJzIGFu
ZCBhZGQgdGhvc2Ugb3ZlcnJpZGluZyBhbnkgZHVwbGljYXRlcyBmcm9tIEdFVAogICAgICBp
ZiAoJGh0dHBfbWV0aG9kID09ICJQT1NUIgogICAgICAgICAgJiYgQHN0cnN0cigkcmVxdWVz
dF9oZWFkZXJzWyJDb250ZW50LVR5cGUiXSwKICAgICAgICAgICAgICAgICAgICAgImFwcGxp
Y2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpCiAgICAgICAgICApIHsKICAgICAgICAk
cG9zdF9kYXRhID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKAogICAgICAgICAgZmls
ZV9nZXRfY29udGVudHMoc2VsZjo6JFBPU1RfSU5QVVQpCiAgICAgICAgKTsKICAgICAgICAk
cGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCRwYXJhbWV0ZXJzLCAkcG9zdF9kYXRhKTsKICAg
ICAgfQoKICAgICAgLy8gV2UgaGF2ZSBhIEF1dGhvcml6YXRpb24taGVhZGVyIHdpdGggT0F1
dGggZGF0YS4gUGFyc2UgdGhlIGhlYWRlcgogICAgICAvLyBhbmQgYWRkIHRob3NlIG92ZXJy
aWRpbmcgYW55IGR1cGxpY2F0ZXMgZnJvbSBHRVQgb3IgUE9TVAogICAgICBpZiAoQHN1YnN0
cigkcmVxdWVzdF9oZWFkZXJzWydBdXRob3JpemF0aW9uJ10sIDAsIDYpID09ICJPQXV0aCAi
KSB7CiAgICAgICAgJGhlYWRlcl9wYXJhbWV0ZXJzID0gT0F1dGhVdGlsOjpzcGxpdF9oZWFk
ZXIoCiAgICAgICAgICAkcmVxdWVzdF9oZWFkZXJzWydBdXRob3JpemF0aW9uJ10KICAgICAg
ICApOwogICAgICAgICRwYXJhbWV0ZXJzID0gYXJyYXlfbWVyZ2UoJHBhcmFtZXRlcnMsICRo
ZWFkZXJfcGFyYW1ldGVycyk7CiAgICAgIH0KCiAgICB9CgogICAgcmV0dXJuIG5ldyBPQXV0
aFJlcXVlc3QoJGh0dHBfbWV0aG9kLCAkaHR0cF91cmwsICRwYXJhbWV0ZXJzKTsKICB9Cgog
IC8qKgogICAqIHByZXR0eSBtdWNoIGEgaGVscGVyIGZ1bmN0aW9uIHRvIHNldCB1cCB0aGUg
cmVxdWVzdAogICAqLwogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZnJvbV9jb25zdW1lcl9h
bmRfdG9rZW4oJGNvbnN1bWVyLCAkdG9rZW4sICRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAk
cGFyYW1ldGVycz1OVUxMKSB7CiAgICBAJHBhcmFtZXRlcnMgb3IgJHBhcmFtZXRlcnMgPSBh
cnJheSgpOwogICAgJGRlZmF1bHRzID0gYXJyYXkoIm9hdXRoX3ZlcnNpb24iID0+IE9BdXRo
UmVxdWVzdDo6JHZlcnNpb24sCiAgICAgICAgICAgICAgICAgICAgICAib2F1dGhfbm9uY2Ui
ID0+IE9BdXRoUmVxdWVzdDo6Z2VuZXJhdGVfbm9uY2UoKSwKICAgICAgICAgICAgICAgICAg
ICAgICJvYXV0aF90aW1lc3RhbXAiID0+IE9BdXRoUmVxdWVzdDo6Z2VuZXJhdGVfdGltZXN0
YW1wKCksCiAgICAgICAgICAgICAgICAgICAgICAib2F1dGhfY29uc3VtZXJfa2V5IiA9PiAk
Y29uc3VtZXItPmtleSk7CiAgICBpZiAoJHRva2VuKQogICAgICAkZGVmYXVsdHNbJ29hdXRo
X3Rva2VuJ10gPSAkdG9rZW4tPmtleTsKCiAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdl
KCRkZWZhdWx0cywgJHBhcmFtZXRlcnMpOwoKICAgIHJldHVybiBuZXcgT0F1dGhSZXF1ZXN0
KCRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVycyk7CiAgfQoKICBwdWJsaWMg
ZnVuY3Rpb24gc2V0X3BhcmFtZXRlcigkbmFtZSwgJHZhbHVlLCAkYWxsb3dfZHVwbGljYXRl
cyA9IHRydWUpIHsKICAgIGlmICgkYWxsb3dfZHVwbGljYXRlcyAmJiBpc3NldCgkdGhpcy0+
cGFyYW1ldGVyc1skbmFtZV0pKSB7CiAgICAgIC8vIFdlIGhhdmUgYWxyZWFkeSBhZGRlZCBw
YXJhbWV0ZXIocykgd2l0aCB0aGlzIG5hbWUsIHNvIGFkZCB0byB0aGUgbGlzdAogICAgICBp
ZiAoaXNfc2NhbGFyKCR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSkpIHsKICAgICAgICAvLyBU
aGlzIGlzIHRoZSBmaXJzdCBkdXBsaWNhdGUsIHNvIHRyYW5zZm9ybSBzY2FsYXIgKHN0cmlu
ZykKICAgICAgICAvLyBpbnRvIGFuIGFycmF5IHNvIHdlIGNhbiBhZGQgdGhlIGR1cGxpY2F0
ZXMKICAgICAgICAkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0gPSBhcnJheSgkdGhpcy0+cGFy
YW1ldGVyc1skbmFtZV0pOwogICAgICB9CgogICAgICAkdGhpcy0+cGFyYW1ldGVyc1skbmFt
ZV1bXSA9ICR2YWx1ZTsKICAgIH0gZWxzZSB7CiAgICAgICR0aGlzLT5wYXJhbWV0ZXJzWyRu
YW1lXSA9ICR2YWx1ZTsKICAgIH0KICB9CgogIHB1YmxpYyBmdW5jdGlvbiBnZXRfcGFyYW1l
dGVyKCRuYW1lKSB7CiAgICByZXR1cm4gaXNzZXQoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVd
KSA/ICR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSA6IG51bGw7CiAgfQoKICBwdWJsaWMgZnVu
Y3Rpb24gZ2V0X3BhcmFtZXRlcnMoKSB7CiAgICByZXR1cm4gJHRoaXMtPnBhcmFtZXRlcnM7
CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gdW5zZXRfcGFyYW1ldGVyKCRuYW1lKSB7CiAgICB1
bnNldCgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pOwogIH0KCiAgLyoqCiAgICogVGhlIHJl
cXVlc3QgcGFyYW1ldGVycywgc29ydGVkIGFuZCBjb25jYXRlbmF0ZWQgaW50byBhIG5vcm1h
bGl6ZWQgc3RyaW5nLgogICAqIEByZXR1cm4gc3RyaW5nCiAgICovCiAgcHVibGljIGZ1bmN0
aW9uIGdldF9zaWduYWJsZV9wYXJhbWV0ZXJzKCkgewogICAgLy8gR3JhYiBhbGwgcGFyYW1l
dGVycwogICAgJHBhcmFtcyA9ICR0aGlzLT5wYXJhbWV0ZXJzOwoKICAgIC8vIFJlbW92ZSBv
YXV0aF9zaWduYXR1cmUgaWYgcHJlc2VudAogICAgLy8gUmVmOiBTcGVjOiA5LjEuMSAoIlRo
ZSBvYXV0aF9zaWduYXR1cmUgcGFyYW1ldGVyIE1VU1QgYmUgZXhjbHVkZWQuIikKICAgIGlm
IChpc3NldCgkcGFyYW1zWydvYXV0aF9zaWduYXR1cmUnXSkpIHsKICAgICAgdW5zZXQoJHBh
cmFtc1snb2F1dGhfc2lnbmF0dXJlJ10pOwogICAgfQoKICAgIHJldHVybiBPQXV0aFV0aWw6
OmJ1aWxkX2h0dHBfcXVlcnkoJHBhcmFtcyk7CiAgfQoKICAvKioKICAgKiBSZXR1cm5zIHRo
ZSBiYXNlIHN0cmluZyBvZiB0aGlzIHJlcXVlc3QKICAgKgogICAqIFRoZSBiYXNlIHN0cmlu
ZyBkZWZpbmVkIGFzIHRoZSBtZXRob2QsIHRoZSB1cmwKICAgKiBhbmQgdGhlIHBhcmFtZXRl
cnMgKG5vcm1hbGl6ZWQpLCBlYWNoIHVybGVuY29kZWQKICAgKiBhbmQgdGhlIGNvbmNhdGVk
IHdpdGggJi4KICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZ2V0X3NpZ25hdHVyZV9iYXNlX3N0
cmluZygpIHsKICAgICRwYXJ0cyA9IGFycmF5KAogICAgICAkdGhpcy0+Z2V0X25vcm1hbGl6
ZWRfaHR0cF9tZXRob2QoKSwKICAgICAgJHRoaXMtPmdldF9ub3JtYWxpemVkX2h0dHBfdXJs
KCksCiAgICAgICR0aGlzLT5nZXRfc2lnbmFibGVfcGFyYW1ldGVycygpCiAgICApOwoKICAg
ICRwYXJ0cyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJHBhcnRzKTsKCiAgICBy
ZXR1cm4gaW1wbG9kZSgnJicsICRwYXJ0cyk7CiAgfQoKICAvKioKICAgKiBqdXN0IHVwcGVy
Y2FzZXMgdGhlIGh0dHAgbWV0aG9kCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGdldF9ub3Jt
YWxpemVkX2h0dHBfbWV0aG9kKCkgewogICAgcmV0dXJuIHN0cnRvdXBwZXIoJHRoaXMtPmh0
dHBfbWV0aG9kKTsKICB9CgogIC8qKgogICAqIHBhcnNlcyB0aGUgdXJsIGFuZCByZWJ1aWxk
cyBpdCB0byBiZQogICAqIHNjaGVtZTovL2hvc3QvcGF0aAogICAqLwogIHB1YmxpYyBmdW5j
dGlvbiBnZXRfbm9ybWFsaXplZF9odHRwX3VybCgpIHsKICAgICRwYXJ0cyA9IHBhcnNlX3Vy
bCgkdGhpcy0+aHR0cF91cmwpOwoKICAgICRwb3J0ID0gQCRwYXJ0c1sncG9ydCddOwogICAg
JHNjaGVtZSA9ICRwYXJ0c1snc2NoZW1lJ107CiAgICAkaG9zdCA9ICRwYXJ0c1snaG9zdCdd
OwogICAgJHBhdGggPSBAJHBhcnRzWydwYXRoJ107CgogICAgJHBvcnQgb3IgJHBvcnQgPSAo
JHNjaGVtZSA9PSAnaHR0cHMnKSA/ICc0NDMnIDogJzgwJzsKCiAgICBpZiAoKCRzY2hlbWUg
PT0gJ2h0dHBzJyAmJiAkcG9ydCAhPSAnNDQzJykKICAgICAgICB8fCAoJHNjaGVtZSA9PSAn
aHR0cCcgJiYgJHBvcnQgIT0gJzgwJykpIHsKICAgICAgJGhvc3QgPSAiJGhvc3Q6JHBvcnQi
OwogICAgfQogICAgcmV0dXJuICIkc2NoZW1lOi8vJGhvc3QkcGF0aCI7CiAgfQoKICAvKioK
ICAgKiBidWlsZHMgYSB1cmwgdXNhYmxlIGZvciBhIEdFVCByZXF1ZXN0CiAgICovCiAgcHVi
bGljIGZ1bmN0aW9uIHRvX3VybCgpIHsKICAgICRwb3N0X2RhdGEgPSAkdGhpcy0+dG9fcG9z
dGRhdGEoKTsKICAgICRvdXQgPSAkdGhpcy0+Z2V0X25vcm1hbGl6ZWRfaHR0cF91cmwoKTsK
ICAgIGlmICgkcG9zdF9kYXRhKSB7CiAgICAgICRvdXQgLj0gJz8nLiRwb3N0X2RhdGE7CiAg
ICB9CiAgICByZXR1cm4gJG91dDsKICB9CgogIC8qKgogICAqIGJ1aWxkcyB0aGUgZGF0YSBv
bmUgd291bGQgc2VuZCBpbiBhIFBPU1QgcmVxdWVzdAogICAqLwogIHB1YmxpYyBmdW5jdGlv
biB0b19wb3N0ZGF0YSgpIHsKICAgIHJldHVybiBPQXV0aFV0aWw6OmJ1aWxkX2h0dHBfcXVl
cnkoJHRoaXMtPnBhcmFtZXRlcnMpOwogIH0KCiAgLyoqCiAgICogYnVpbGRzIHRoZSBBdXRo
b3JpemF0aW9uOiBoZWFkZXIKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gdG9faGVhZGVyKCRy
ZWFsbT1udWxsKSB7CiAgICAkZmlyc3QgPSB0cnVlOwogIGlmKCRyZWFsbSkgewogICAgICAk
b3V0ID0gJ0F1dGhvcml6YXRpb246IE9BdXRoIHJlYWxtPSInIC4gT0F1dGhVdGlsOjp1cmxl
bmNvZGVfcmZjMzk4NigkcmVhbG0pIC4gJyInOwogICAgICAkZmlyc3QgPSBmYWxzZTsKICAg
IH0gZWxzZQogICAgICAkb3V0ID0gJ0F1dGhvcml6YXRpb246IE9BdXRoJzsKCiAgICAkdG90
YWwgPSBhcnJheSgpOwogICAgZm9yZWFjaCAoJHRoaXMtPnBhcmFtZXRlcnMgYXMgJGsgPT4g
JHYpIHsKICAgICAgaWYgKHN1YnN0cigkaywgMCwgNSkgIT0gIm9hdXRoIikgY29udGludWU7
CiAgICAgIGlmIChpc19hcnJheSgkdikpIHsKICAgICAgICB0aHJvdyBuZXcgT0F1dGhFeGNl
cHRpb24oJ0FycmF5cyBub3Qgc3VwcG9ydGVkIGluIGhlYWRlcnMnKTsKICAgICAgfQogICAg
ICAkb3V0IC49ICgkZmlyc3QpID8gJyAnIDogJywnOwogICAgICAkb3V0IC49IE9BdXRoVXRp
bDo6dXJsZW5jb2RlX3JmYzM5ODYoJGspIC4KICAgICAgICAgICAgICAnPSInIC4KICAgICAg
ICAgICAgICBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCR2KSAuCiAgICAgICAgICAg
ICAgJyInOwogICAgICAkZmlyc3QgPSBmYWxzZTsKICAgIH0KICAgIHJldHVybiAkb3V0Owog
IH0KCiAgcHVibGljIGZ1bmN0aW9uIF9fdG9TdHJpbmcoKSB7CiAgICByZXR1cm4gJHRoaXMt
PnRvX3VybCgpOwogIH0KCgogIHB1YmxpYyBmdW5jdGlvbiBzaWduX3JlcXVlc3QoJHNpZ25h
dHVyZV9tZXRob2QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAkdGhpcy0+c2V0X3BhcmFt
ZXRlcigKICAgICAgIm9hdXRoX3NpZ25hdHVyZV9tZXRob2QiLAogICAgICAkc2lnbmF0dXJl
X21ldGhvZC0+Z2V0X25hbWUoKSwKICAgICAgZmFsc2UKICAgICk7CiAgICAkc2lnbmF0dXJl
ID0gJHRoaXMtPmJ1aWxkX3NpZ25hdHVyZSgkc2lnbmF0dXJlX21ldGhvZCwgJGNvbnN1bWVy
LCAkdG9rZW4pOwogICAgJHRoaXMtPnNldF9wYXJhbWV0ZXIoIm9hdXRoX3NpZ25hdHVyZSIs
ICRzaWduYXR1cmUsIGZhbHNlKTsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWdu
YXR1cmUoJHNpZ25hdHVyZV9tZXRob2QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAkc2ln
bmF0dXJlID0gJHNpZ25hdHVyZV9tZXRob2QtPmJ1aWxkX3NpZ25hdHVyZSgkdGhpcywgJGNv
bnN1bWVyLCAkdG9rZW4pOwogICAgcmV0dXJuICRzaWduYXR1cmU7CiAgfQoKICAvKioKICAg
KiB1dGlsIGZ1bmN0aW9uOiBjdXJyZW50IHRpbWVzdGFtcAogICAqLwogIHByaXZhdGUgc3Rh
dGljIGZ1bmN0aW9uIGdlbmVyYXRlX3RpbWVzdGFtcCgpIHsKICAgIHJldHVybiB0aW1lKCk7
CiAgfQoKICAvKioKICAgKiB1dGlsIGZ1bmN0aW9uOiBjdXJyZW50IG5vbmNlCiAgICovCiAg
cHJpdmF0ZSBzdGF0aWMgZnVuY3Rpb24gZ2VuZXJhdGVfbm9uY2UoKSB7CiAgICAkbXQgPSBt
aWNyb3RpbWUoKTsKICAgICRyYW5kID0gbXRfcmFuZCgpOwoKICAgIHJldHVybiBtZDUoJG10
IC4gJHJhbmQpOyAvLyBtZDVzIGxvb2sgbmljZXIgdGhhbiBudW1iZXJzCiAgfQp9CgpjbGFz
cyBPQXV0aFNlcnZlciB7CiAgcHJvdGVjdGVkICR0aW1lc3RhbXBfdGhyZXNob2xkID0gMzAw
OyAvLyBpbiBzZWNvbmRzLCBmaXZlIG1pbnV0ZXMKICBwcm90ZWN0ZWQgJHZlcnNpb24gPSAn
MS4wJzsgICAgICAgICAgICAgLy8gaGkgYmxhaW5lCiAgcHJvdGVjdGVkICRzaWduYXR1cmVf
bWV0aG9kcyA9IGFycmF5KCk7CgogIHByb3RlY3RlZCAkZGF0YV9zdG9yZTsKCiAgZnVuY3Rp
b24gX19jb25zdHJ1Y3QoJGRhdGFfc3RvcmUpIHsKICAgICR0aGlzLT5kYXRhX3N0b3JlID0g
JGRhdGFfc3RvcmU7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gYWRkX3NpZ25hdHVyZV9tZXRo
b2QoJHNpZ25hdHVyZV9tZXRob2QpIHsKICAgICR0aGlzLT5zaWduYXR1cmVfbWV0aG9kc1sk
c2lnbmF0dXJlX21ldGhvZC0+Z2V0X25hbWUoKV0gPQogICAgICAkc2lnbmF0dXJlX21ldGhv
ZDsKICB9CgogIC8vIGhpZ2ggbGV2ZWwgZnVuY3Rpb25zCgogIC8qKgogICAqIHByb2Nlc3Mg
YSByZXF1ZXN0X3Rva2VuIHJlcXVlc3QKICAgKiByZXR1cm5zIHRoZSByZXF1ZXN0IHRva2Vu
IG9uIHN1Y2Nlc3MKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZmV0Y2hfcmVxdWVzdF90b2tl
bigmJHJlcXVlc3QpIHsKICAgICR0aGlzLT5nZXRfdmVyc2lvbigkcmVxdWVzdCk7CgogICAg
JGNvbnN1bWVyID0gJHRoaXMtPmdldF9jb25zdW1lcigkcmVxdWVzdCk7CgogICAgLy8gbm8g
dG9rZW4gcmVxdWlyZWQgZm9yIHRoZSBpbml0aWFsIHRva2VuIHJlcXVlc3QKICAgICR0b2tl
biA9IE5VTEw7CgogICAgJHRoaXMtPmNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1
bWVyLCAkdG9rZW4pOwoKICAgIC8vIFJldiBBIGNoYW5nZQogICAgJGNhbGxiYWNrID0gJHJl
cXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX2NhbGxiYWNrJyk7CiAgICAkbmV3X3Rva2Vu
ID0gJHRoaXMtPmRhdGFfc3RvcmUtPm5ld19yZXF1ZXN0X3Rva2VuKCRjb25zdW1lciwgJGNh
bGxiYWNrKTsKCiAgICByZXR1cm4gJG5ld190b2tlbjsKICB9CgogIC8qKgogICAqIHByb2Nl
c3MgYW4gYWNjZXNzX3Rva2VuIHJlcXVlc3QKICAgKiByZXR1cm5zIHRoZSBhY2Nlc3MgdG9r
ZW4gb24gc3VjY2VzcwogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBmZXRjaF9hY2Nlc3NfdG9r
ZW4oJiRyZXF1ZXN0KSB7CiAgICAkdGhpcy0+Z2V0X3ZlcnNpb24oJHJlcXVlc3QpOwoKICAg
ICRjb25zdW1lciA9ICR0aGlzLT5nZXRfY29uc3VtZXIoJHJlcXVlc3QpOwoKICAgIC8vIHJl
cXVpcmVzIGF1dGhvcml6ZWQgcmVxdWVzdCB0b2tlbgogICAgJHRva2VuID0gJHRoaXMtPmdl
dF90b2tlbigkcmVxdWVzdCwgJGNvbnN1bWVyLCAicmVxdWVzdCIpOwoKICAgICR0aGlzLT5j
aGVja19zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKTsKCiAgICAvLyBS
ZXYgQSBjaGFuZ2UKICAgICR2ZXJpZmllciA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdv
YXV0aF92ZXJpZmllcicpOwogICAgJG5ld190b2tlbiA9ICR0aGlzLT5kYXRhX3N0b3JlLT5u
ZXdfYWNjZXNzX3Rva2VuKCR0b2tlbiwgJGNvbnN1bWVyLCAkdmVyaWZpZXIpOwoKICAgIHJl
dHVybiAkbmV3X3Rva2VuOwogIH0KCiAgLyoqCiAgICogdmVyaWZ5IGFuIGFwaSBjYWxsLCBj
aGVja3MgYWxsIHRoZSBwYXJhbWV0ZXJzCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIHZlcmlm
eV9yZXF1ZXN0KCYkcmVxdWVzdCkgewogICAgJHRoaXMtPmdldF92ZXJzaW9uKCRyZXF1ZXN0
KTsKICAgICRjb25zdW1lciA9ICR0aGlzLT5nZXRfY29uc3VtZXIoJHJlcXVlc3QpOwogICAg
JHRva2VuID0gJHRoaXMtPmdldF90b2tlbigkcmVxdWVzdCwgJGNvbnN1bWVyLCAiYWNjZXNz
Iik7CiAgICAkdGhpcy0+Y2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0
b2tlbik7CiAgICByZXR1cm4gYXJyYXkoJGNvbnN1bWVyLCAkdG9rZW4pOwogIH0KCiAgLy8g
SW50ZXJuYWxzIGZyb20gaGVyZQogIC8qKgogICAqIHZlcnNpb24gMQogICAqLwogIHByaXZh
dGUgZnVuY3Rpb24gZ2V0X3ZlcnNpb24oJiRyZXF1ZXN0KSB7CiAgICAkdmVyc2lvbiA9ICRy
ZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCJvYXV0aF92ZXJzaW9uIik7CiAgICBpZiAoISR2ZXJz
aW9uKSB7CiAgICAgIC8vIFNlcnZpY2UgUHJvdmlkZXJzIE1VU1QgYXNzdW1lIHRoZSBwcm90
b2NvbCB2ZXJzaW9uIHRvIGJlIDEuMCBpZiB0aGlzIHBhcmFtZXRlciBpcyBub3QgcHJlc2Vu
dC4KICAgICAgLy8gQ2hhcHRlciA3LjAgKCJBY2Nlc3NpbmcgUHJvdGVjdGVkIFJlc3NvdXJj
ZXMiKQogICAgICAkdmVyc2lvbiA9ICcxLjAnOwogICAgfQogICAgaWYgKCR2ZXJzaW9uICE9
PSAkdGhpcy0+dmVyc2lvbikgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIk9B
dXRoIHZlcnNpb24gJyR2ZXJzaW9uJyBub3Qgc3VwcG9ydGVkIik7CiAgICB9CiAgICByZXR1
cm4gJHZlcnNpb247CiAgfQoKICAvKioKICAgKiBmaWd1cmUgb3V0IHRoZSBzaWduYXR1cmUg
d2l0aCBzb21lIGRlZmF1bHRzCiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBnZXRfc2lnbmF0
dXJlX21ldGhvZCgmJHJlcXVlc3QpIHsKICAgICRzaWduYXR1cmVfbWV0aG9kID0KICAgICAg
ICBAJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoIm9hdXRoX3NpZ25hdHVyZV9tZXRob2QiKTsK
CiAgICBpZiAoISRzaWduYXR1cmVfbWV0aG9kKSB7CiAgICAgIC8vIEFjY29yZGluZyB0byBj
aGFwdGVyIDcgKCJBY2Nlc3NpbmcgUHJvdGVjdGVkIFJlc3NvdXJjZXMiKSB0aGUgc2lnbmF0
dXJlLW1ldGhvZAogICAgICAvLyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQsIGFuZCB3ZSBjYW4n
dCBqdXN0IGZhbGxiYWNrIHRvIFBMQUlOVEVYVAogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNl
cHRpb24oJ05vIHNpZ25hdHVyZSBtZXRob2QgcGFyYW1ldGVyLiBUaGlzIHBhcmFtZXRlciBp
cyByZXF1aXJlZCcpOwogICAgfQoKICAgIGlmICghaW5fYXJyYXkoJHNpZ25hdHVyZV9tZXRo
b2QsCiAgICAgICAgICAgICAgICAgIGFycmF5X2tleXMoJHRoaXMtPnNpZ25hdHVyZV9tZXRo
b2RzKSkpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKAogICAgICAgICJTaWdu
YXR1cmUgbWV0aG9kICckc2lnbmF0dXJlX21ldGhvZCcgbm90IHN1cHBvcnRlZCAiIC4KICAg
ICAgICAidHJ5IG9uZSBvZiB0aGUgZm9sbG93aW5nOiAiIC4KICAgICAgICBpbXBsb2RlKCIs
ICIsIGFycmF5X2tleXMoJHRoaXMtPnNpZ25hdHVyZV9tZXRob2RzKSkKICAgICAgKTsKICAg
IH0KICAgIHJldHVybiAkdGhpcy0+c2lnbmF0dXJlX21ldGhvZHNbJHNpZ25hdHVyZV9tZXRo
b2RdOwogIH0KCiAgLyoqCiAgICogdHJ5IHRvIGZpbmQgdGhlIGNvbnN1bWVyIGZvciB0aGUg
cHJvdmlkZWQgcmVxdWVzdCdzIGNvbnN1bWVyIGtleQogICAqLwogIHByaXZhdGUgZnVuY3Rp
b24gZ2V0X2NvbnN1bWVyKCYkcmVxdWVzdCkgewogICAgJGNvbnN1bWVyX2tleSA9IEAkcmVx
dWVzdC0+Z2V0X3BhcmFtZXRlcigib2F1dGhfY29uc3VtZXJfa2V5Iik7CiAgICBpZiAoISRj
b25zdW1lcl9rZXkpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJbnZhbGlk
IGNvbnN1bWVyIGtleSIpOwogICAgfQoKICAgICRjb25zdW1lciA9ICR0aGlzLT5kYXRhX3N0
b3JlLT5sb29rdXBfY29uc3VtZXIoJGNvbnN1bWVyX2tleSk7CiAgICBpZiAoISRjb25zdW1l
cikgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIkludmFsaWQgY29uc3VtZXIi
KTsKICAgIH0KCiAgICByZXR1cm4gJGNvbnN1bWVyOwogIH0KCiAgLyoqCiAgICogdHJ5IHRv
IGZpbmQgdGhlIHRva2VuIGZvciB0aGUgcHJvdmlkZWQgcmVxdWVzdCdzIHRva2VuIGtleQog
ICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X3Rva2VuKCYkcmVxdWVzdCwgJGNvbnN1bWVy
LCAkdG9rZW5fdHlwZT0iYWNjZXNzIikgewogICAgJHRva2VuX2ZpZWxkID0gQCRyZXF1ZXN0
LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF90b2tlbicpOwogICAgJHRva2VuID0gJHRoaXMtPmRh
dGFfc3RvcmUtPmxvb2t1cF90b2tlbigKICAgICAgJGNvbnN1bWVyLCAkdG9rZW5fdHlwZSwg
JHRva2VuX2ZpZWxkCiAgICApOwogICAgaWYgKCEkdG9rZW4pIHsKICAgICAgdGhyb3cgbmV3
IE9BdXRoRXhjZXB0aW9uKCJJbnZhbGlkICR0b2tlbl90eXBlIHRva2VuOiAkdG9rZW5fZmll
bGQiKTsKICAgIH0KICAgIHJldHVybiAkdG9rZW47CiAgfQoKICAvKioKICAgKiBhbGwtaW4t
b25lIGZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBzaWduYXR1cmUgb24gYSByZXF1ZXN0CiAgICog
c2hvdWxkIGd1ZXNzIHRoZSBzaWduYXR1cmUgbWV0aG9kIGFwcHJvcHJpYXRlbHkKICAgKi8K
ICBwcml2YXRlIGZ1bmN0aW9uIGNoZWNrX3NpZ25hdHVyZSgmJHJlcXVlc3QsICRjb25zdW1l
ciwgJHRva2VuKSB7CiAgICAvLyB0aGlzIHNob3VsZCBwcm9iYWJseSBiZSBpbiBhIGRpZmZl
cmVudCBtZXRob2QKICAgICR0aW1lc3RhbXAgPSBAJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIo
J29hdXRoX3RpbWVzdGFtcCcpOwogICAgJG5vbmNlID0gQCRyZXF1ZXN0LT5nZXRfcGFyYW1l
dGVyKCdvYXV0aF9ub25jZScpOwoKICAgICR0aGlzLT5jaGVja190aW1lc3RhbXAoJHRpbWVz
dGFtcCk7CiAgICAkdGhpcy0+Y2hlY2tfbm9uY2UoJGNvbnN1bWVyLCAkdG9rZW4sICRub25j
ZSwgJHRpbWVzdGFtcCk7CgogICAgJHNpZ25hdHVyZV9tZXRob2QgPSAkdGhpcy0+Z2V0X3Np
Z25hdHVyZV9tZXRob2QoJHJlcXVlc3QpOwoKICAgICRzaWduYXR1cmUgPSAkcmVxdWVzdC0+
Z2V0X3BhcmFtZXRlcignb2F1dGhfc2lnbmF0dXJlJyk7CiAgICAkdmFsaWRfc2lnID0gJHNp
Z25hdHVyZV9tZXRob2QtPmNoZWNrX3NpZ25hdHVyZSgKICAgICAgJHJlcXVlc3QsCiAgICAg
ICRjb25zdW1lciwKICAgICAgJHRva2VuLAogICAgICAkc2lnbmF0dXJlCiAgICApOwoKICAg
IGlmICghJHZhbGlkX3NpZykgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIklu
dmFsaWQgc2lnbmF0dXJlIik7CiAgICB9CiAgfQoKICAvKioKICAgKiBjaGVjayB0aGF0IHRo
ZSB0aW1lc3RhbXAgaXMgbmV3IGVub3VnaAogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gY2hl
Y2tfdGltZXN0YW1wKCR0aW1lc3RhbXApIHsKICAgIGlmKCAhICR0aW1lc3RhbXAgKQogICAg
ICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAgICAgJ01pc3NpbmcgdGltZXN0YW1w
IHBhcmFtZXRlci4gVGhlIHBhcmFtZXRlciBpcyByZXF1aXJlZCcKICAgICAgKTsKCiAgICAv
LyB2ZXJpZnkgdGhhdCB0aW1lc3RhbXAgaXMgcmVjZW50aXNoCiAgICAkbm93ID0gdGltZSgp
OwogICAgaWYgKGFicygkbm93IC0gJHRpbWVzdGFtcCkgPiAkdGhpcy0+dGltZXN0YW1wX3Ro
cmVzaG9sZCkgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAgICAgIkV4
cGlyZWQgdGltZXN0YW1wLCB5b3VycyAkdGltZXN0YW1wLCBvdXJzICRub3ciCiAgICAgICk7
CiAgICB9CiAgfQoKICAvKioKICAgKiBjaGVjayB0aGF0IHRoZSBub25jZSBpcyBub3QgcmVw
ZWF0ZWQKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGNoZWNrX25vbmNlKCRjb25zdW1lciwg
JHRva2VuLCAkbm9uY2UsICR0aW1lc3RhbXApIHsKICAgIGlmKCAhICRub25jZSApCiAgICAg
IHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigKICAgICAgICAnTWlzc2luZyBub25jZSBwYXJh
bWV0ZXIuIFRoZSBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQnCiAgICAgICk7CgogICAgLy8gdmVy
aWZ5IHRoYXQgdGhlIG5vbmNlIGlzIHVuaXF1ZWlzaAogICAgJGZvdW5kID0gJHRoaXMtPmRh
dGFfc3RvcmUtPmxvb2t1cF9ub25jZSgKICAgICAgJGNvbnN1bWVyLAogICAgICAkdG9rZW4s
CiAgICAgICRub25jZSwKICAgICAgJHRpbWVzdGFtcAogICAgKTsKICAgIGlmICgkZm91bmQp
IHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJOb25jZSBhbHJlYWR5IHVzZWQ6
ICRub25jZSIpOwogICAgfQogIH0KCn0KCmNsYXNzIE9BdXRoRGF0YVN0b3JlIHsKICBmdW5j
dGlvbiBsb29rdXBfY29uc3VtZXIoJGNvbnN1bWVyX2tleSkgewogICAgLy8gaW1wbGVtZW50
IG1lCiAgfQoKICBmdW5jdGlvbiBsb29rdXBfdG9rZW4oJGNvbnN1bWVyLCAkdG9rZW5fdHlw
ZSwgJHRva2VuKSB7CiAgICAvLyBpbXBsZW1lbnQgbWUKICB9CgogIGZ1bmN0aW9uIGxvb2t1
cF9ub25jZSgkY29uc3VtZXIsICR0b2tlbiwgJG5vbmNlLCAkdGltZXN0YW1wKSB7CiAgICAv
LyBpbXBsZW1lbnQgbWUKICB9CgogIGZ1bmN0aW9uIG5ld19yZXF1ZXN0X3Rva2VuKCRjb25z
dW1lciwgJGNhbGxiYWNrID0gbnVsbCkgewogICAgLy8gcmV0dXJuIGEgbmV3IHRva2VuIGF0
dGFjaGVkIHRvIHRoaXMgY29uc3VtZXIKICB9CgogIGZ1bmN0aW9uIG5ld19hY2Nlc3NfdG9r
ZW4oJHRva2VuLCAkY29uc3VtZXIsICR2ZXJpZmllciA9IG51bGwpIHsKICAgIC8vIHJldHVy
biBhIG5ldyBhY2Nlc3MgdG9rZW4gYXR0YWNoZWQgdG8gdGhpcyBjb25zdW1lcgogICAgLy8g
Zm9yIHRoZSB1c2VyIGFzc29jaWF0ZWQgd2l0aCB0aGlzIHRva2VuIGlmIHRoZSByZXF1ZXN0
IHRva2VuCiAgICAvLyBpcyBhdXRob3JpemVkCiAgICAvLyBzaG91bGQgYWxzbyBpbnZhbGlk
YXRlIHRoZSByZXF1ZXN0IHRva2VuCiAgfQoKfQoKY2xhc3MgT0F1dGhVdGlsIHsKICBwdWJs
aWMgc3RhdGljIGZ1bmN0aW9uIHVybGVuY29kZV9yZmMzOTg2KCRpbnB1dCkgewogIGlmIChp
c19hcnJheSgkaW5wdXQpKSB7CiAgICByZXR1cm4gYXJyYXlfbWFwKGFycmF5KCdPQXV0aFV0
aWwnLCAndXJsZW5jb2RlX3JmYzM5ODYnKSwgJGlucHV0KTsKICB9IGVsc2UgaWYgKGlzX3Nj
YWxhcigkaW5wdXQpKSB7CiAgICByZXR1cm4gc3RyX3JlcGxhY2UoCiAgICAgICcrJywKICAg
ICAgJyAnLAogICAgICBzdHJfcmVwbGFjZSgnJTdFJywgJ34nLCByYXd1cmxlbmNvZGUoJGlu
cHV0KSkKICAgICk7CiAgfSBlbHNlIHsKICAgIHJldHVybiAnJzsKICB9Cn0KCgogIC8vIFRo
aXMgZGVjb2RlIGZ1bmN0aW9uIGlzbid0IHRha2luZyBpbnRvIGNvbnNpZGVyYXRpb24gdGhl
IGFib3ZlCiAgLy8gbW9kaWZpY2F0aW9ucyB0byB0aGUgZW5jb2RpbmcgcHJvY2Vzcy4gSG93
ZXZlciwgdGhpcyBtZXRob2QgZG9lc24ndAogIC8vIHNlZW0gdG8gYmUgdXNlZCBhbnl3aGVy
ZSBzbyBsZWF2aW5nIGl0IGFzIGlzLgogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gdXJsZGVj
b2RlX3JmYzM5ODYoJHN0cmluZykgewogICAgcmV0dXJuIHVybGRlY29kZSgkc3RyaW5nKTsK
ICB9CgogIC8vIFV0aWxpdHkgZnVuY3Rpb24gZm9yIHR1cm5pbmcgdGhlIEF1dGhvcml6YXRp
b246IGhlYWRlciBpbnRvCiAgLy8gcGFyYW1ldGVycywgaGFzIHRvIGRvIHNvbWUgdW5lc2Nh
cGluZwogIC8vIENhbiBmaWx0ZXIgb3V0IGFueSBub24tb2F1dGggcGFyYW1ldGVycyBpZiBu
ZWVkZWQgKGRlZmF1bHQgYmVoYXZpb3VyKQogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gc3Bs
aXRfaGVhZGVyKCRoZWFkZXIsICRvbmx5X2FsbG93X29hdXRoX3BhcmFtZXRlcnMgPSB0cnVl
KSB7CiAgICAkcGF0dGVybiA9ICcvKChbLV9hLXpdKik9KCIoW14iXSopInwoW14sXSopKSw/
KS8nOwogICAgJG9mZnNldCA9IDA7CiAgICAkcGFyYW1zID0gYXJyYXkoKTsKICAgIHdoaWxl
IChwcmVnX21hdGNoKCRwYXR0ZXJuLCAkaGVhZGVyLCAkbWF0Y2hlcywgUFJFR19PRkZTRVRf
Q0FQVFVSRSwgJG9mZnNldCkgPiAwKSB7CiAgICAgICRtYXRjaCA9ICRtYXRjaGVzWzBdOwog
ICAgICAkaGVhZGVyX25hbWUgPSAkbWF0Y2hlc1syXVswXTsKICAgICAgJGhlYWRlcl9jb250
ZW50ID0gKGlzc2V0KCRtYXRjaGVzWzVdKSkgPyAkbWF0Y2hlc1s1XVswXSA6ICRtYXRjaGVz
WzRdWzBdOwogICAgICBpZiAocHJlZ19tYXRjaCgnL15vYXV0aF8vJywgJGhlYWRlcl9uYW1l
KSB8fCAhJG9ubHlfYWxsb3dfb2F1dGhfcGFyYW1ldGVycykgewogICAgICAgICRwYXJhbXNb
JGhlYWRlcl9uYW1lXSA9IE9BdXRoVXRpbDo6dXJsZGVjb2RlX3JmYzM5ODYoJGhlYWRlcl9j
b250ZW50KTsKICAgICAgfQogICAgICAkb2Zmc2V0ID0gJG1hdGNoWzFdICsgc3RybGVuKCRt
YXRjaFswXSk7CiAgICB9CgogICAgaWYgKGlzc2V0KCRwYXJhbXNbJ3JlYWxtJ10pKSB7CiAg
ICAgIHVuc2V0KCRwYXJhbXNbJ3JlYWxtJ10pOwogICAgfQoKICAgIHJldHVybiAkcGFyYW1z
OwogIH0KCiAgLy8gaGVscGVyIHRvIHRyeSB0byBzb3J0IG91dCBoZWFkZXJzIGZvciBwZW9w
bGUgd2hvIGFyZW4ndCBydW5uaW5nIGFwYWNoZQogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24g
Z2V0X2hlYWRlcnMoKSB7CiAgICBpZiAoZnVuY3Rpb25fZXhpc3RzKCdhcGFjaGVfcmVxdWVz
dF9oZWFkZXJzJykpIHsKICAgICAgLy8gd2UgbmVlZCB0aGlzIHRvIGdldCB0aGUgYWN0dWFs
IEF1dGhvcml6YXRpb246IGhlYWRlcgogICAgICAvLyBiZWNhdXNlIGFwYWNoZSB0ZW5kcyB0
byB0ZWxsIHVzIGl0IGRvZXNuJ3QgZXhpc3QKICAgICAgJGhlYWRlcnMgPSBhcGFjaGVfcmVx
dWVzdF9oZWFkZXJzKCk7CgogICAgICAvLyBzYW5pdGl6ZSB0aGUgb3V0cHV0IG9mIGFwYWNo
ZV9yZXF1ZXN0X2hlYWRlcnMgYmVjYXVzZQogICAgICAvLyB3ZSBhbHdheXMgd2FudCB0aGUg
a2V5cyB0byBiZSBDYXNlZC1MaWtlLVRoaXMgYW5kIGFyaCgpCiAgICAgIC8vIHJldHVybnMg
dGhlIGhlYWRlcnMgaW4gdGhlIHNhbWUgY2FzZSBhcyB0aGV5IGFyZSBpbiB0aGUKICAgICAg
Ly8gcmVxdWVzdAogICAgICAkb3V0ID0gYXJyYXkoKTsKICAgICAgZm9yZWFjaCggJGhlYWRl
cnMgQVMgJGtleSA9PiAkdmFsdWUgKSB7CiAgICAgICAgJGtleSA9IHN0cl9yZXBsYWNlKAog
ICAgICAgICAgICAiICIsCiAgICAgICAgICAgICItIiwKICAgICAgICAgICAgdWN3b3Jkcyhz
dHJ0b2xvd2VyKHN0cl9yZXBsYWNlKCItIiwgIiAiLCAka2V5KSkpCiAgICAgICAgICApOwog
ICAgICAgICRvdXRbJGtleV0gPSAkdmFsdWU7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAg
IC8vIG90aGVyd2lzZSB3ZSBkb24ndCBoYXZlIGFwYWNoZSBhbmQgYXJlIGp1c3QgZ29pbmcg
dG8gaGF2ZSB0byBob3BlCiAgICAgIC8vIHRoYXQgJF9TRVJWRVIgYWN0dWFsbHkgY29udGFp
bnMgd2hhdCB3ZSBuZWVkCiAgICAgICRvdXQgPSBhcnJheSgpOwogICAgICBpZiggaXNzZXQo
JF9TRVJWRVJbJ0NPTlRFTlRfVFlQRSddKSApCiAgICAgICAgJG91dFsnQ29udGVudC1UeXBl
J10gPSAkX1NFUlZFUlsnQ09OVEVOVF9UWVBFJ107CiAgICAgIGlmKCBpc3NldCgkX0VOVlsn
Q09OVEVOVF9UWVBFJ10pICkKICAgICAgICAkb3V0WydDb250ZW50LVR5cGUnXSA9ICRfRU5W
WydDT05URU5UX1RZUEUnXTsKCiAgICAgIGZvcmVhY2ggKCRfU0VSVkVSIGFzICRrZXkgPT4g
JHZhbHVlKSB7CiAgICAgICAgaWYgKHN1YnN0cigka2V5LCAwLCA1KSA9PSAiSFRUUF8iKSB7
CiAgICAgICAgICAvLyB0aGlzIGlzIGNoYW9zLCBiYXNpY2FsbHkgaXQgaXMganVzdCB0aGVy
ZSB0byBjYXBpdGFsaXplIHRoZSBmaXJzdAogICAgICAgICAgLy8gbGV0dGVyIG9mIGV2ZXJ5
IHdvcmQgdGhhdCBpcyBub3QgYW4gaW5pdGlhbCBIVFRQIGFuZCBzdHJpcCBIVFRQCiAgICAg
ICAgICAvLyBjb2RlIGZyb20gcHJ6ZW1lawogICAgICAgICAgJGtleSA9IHN0cl9yZXBsYWNl
KAogICAgICAgICAgICAiICIsCiAgICAgICAgICAgICItIiwKICAgICAgICAgICAgdWN3b3Jk
cyhzdHJ0b2xvd2VyKHN0cl9yZXBsYWNlKCJfIiwgIiAiLCBzdWJzdHIoJGtleSwgNSkpKSkK
ICAgICAgICAgICk7CiAgICAgICAgICAkb3V0WyRrZXldID0gJHZhbHVlOwogICAgICAgIH0K
ICAgICAgfQogICAgfQogICAgcmV0dXJuICRvdXQ7CiAgfQoKICAvLyBUaGlzIGZ1bmN0aW9u
IHRha2VzIGEgaW5wdXQgbGlrZSBhPWImYT1jJmQ9ZSBhbmQgcmV0dXJucyB0aGUgcGFyc2Vk
CiAgLy8gcGFyYW1ldGVycyBsaWtlIHRoaXMKICAvLyBhcnJheSgnYScgPT4gYXJyYXkoJ2In
LCdjJyksICdkJyA9PiAnZScpCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBwYXJzZV9wYXJh
bWV0ZXJzKCAkaW5wdXQgKSB7CiAgICBpZiAoIWlzc2V0KCRpbnB1dCkgfHwgISRpbnB1dCkg
cmV0dXJuIGFycmF5KCk7CgogICAgJHBhaXJzID0gZXhwbG9kZSgnJicsICRpbnB1dCk7Cgog
ICAgJHBhcnNlZF9wYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgIGZvcmVhY2ggKCRwYWlycyBh
cyAkcGFpcikgewogICAgICAkc3BsaXQgPSBleHBsb2RlKCc9JywgJHBhaXIsIDIpOwogICAg
ICAkcGFyYW1ldGVyID0gT0F1dGhVdGlsOjp1cmxkZWNvZGVfcmZjMzk4Nigkc3BsaXRbMF0p
OwogICAgICAkdmFsdWUgPSBpc3NldCgkc3BsaXRbMV0pID8gT0F1dGhVdGlsOjp1cmxkZWNv
ZGVfcmZjMzk4Nigkc3BsaXRbMV0pIDogJyc7CgogICAgICBpZiAoaXNzZXQoJHBhcnNlZF9w
YXJhbWV0ZXJzWyRwYXJhbWV0ZXJdKSkgewogICAgICAgIC8vIFdlIGhhdmUgYWxyZWFkeSBy
ZWNpZXZlZCBwYXJhbWV0ZXIocykgd2l0aCB0aGlzIG5hbWUsIHNvIGFkZCB0byB0aGUgbGlz
dAogICAgICAgIC8vIG9mIHBhcmFtZXRlcnMgd2l0aCB0aGlzIG5hbWUKCiAgICAgICAgaWYg
KGlzX3NjYWxhcigkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl0pKSB7CiAgICAgICAg
ICAvLyBUaGlzIGlzIHRoZSBmaXJzdCBkdXBsaWNhdGUsIHNvIHRyYW5zZm9ybSBzY2FsYXIg
KHN0cmluZykgaW50byBhbiBhcnJheQogICAgICAgICAgLy8gc28gd2UgY2FuIGFkZCB0aGUg
ZHVwbGljYXRlcwogICAgICAgICAgJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdID0g
YXJyYXkoJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdKTsKICAgICAgICB9CgogICAg
ICAgICRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXVtdID0gJHZhbHVlOwogICAgICB9
IGVsc2UgewogICAgICAgICRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSA9ICR2YWx1
ZTsKICAgICAgfQogICAgfQogICAgcmV0dXJuICRwYXJzZWRfcGFyYW1ldGVyczsKICB9Cgog
IHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gYnVpbGRfaHR0cF9xdWVyeSgkcGFyYW1zKSB7CiAg
ICBpZiAoISRwYXJhbXMpIHJldHVybiAnJzsKCiAgICAvLyBVcmxlbmNvZGUgYm90aCBrZXlz
IGFuZCB2YWx1ZXMKICAgICRrZXlzID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4Nihh
cnJheV9rZXlzKCRwYXJhbXMpKTsKICAgICR2YWx1ZXMgPSBPQXV0aFV0aWw6OnVybGVuY29k
ZV9yZmMzOTg2KGFycmF5X3ZhbHVlcygkcGFyYW1zKSk7CiAgICAkcGFyYW1zID0gYXJyYXlf
Y29tYmluZSgka2V5cywgJHZhbHVlcyk7CgogICAgLy8gUGFyYW1ldGVycyBhcmUgc29ydGVk
IGJ5IG5hbWUsIHVzaW5nIGxleGljb2dyYXBoaWNhbCBieXRlIHZhbHVlIG9yZGVyaW5nLgog
ICAgLy8gUmVmOiBTcGVjOiA5LjEuMSAoMSkKICAgIHVrc29ydCgkcGFyYW1zLCAnc3RyY21w
Jyk7CgogICAgJHBhaXJzID0gYXJyYXkoKTsKICAgIGZvcmVhY2ggKCRwYXJhbXMgYXMgJHBh
cmFtZXRlciA9PiAkdmFsdWUpIHsKICAgICAgaWYgKGlzX2FycmF5KCR2YWx1ZSkpIHsKICAg
ICAgICAvLyBJZiB0d28gb3IgbW9yZSBwYXJhbWV0ZXJzIHNoYXJlIHRoZSBzYW1lIG5hbWUs
IHRoZXkgYXJlIHNvcnRlZCBieSB0aGVpciB2YWx1ZQogICAgICAgIC8vIFJlZjogU3BlYzog
OS4xLjEgKDEpCiAgICAgICAgbmF0c29ydCgkdmFsdWUpOwogICAgICAgIGZvcmVhY2ggKCR2
YWx1ZSBhcyAkZHVwbGljYXRlX3ZhbHVlKSB7CiAgICAgICAgICAkcGFpcnNbXSA9ICRwYXJh
bWV0ZXIgLiAnPScgLiAkZHVwbGljYXRlX3ZhbHVlOwogICAgICAgIH0KICAgICAgfSBlbHNl
IHsKICAgICAgICAkcGFpcnNbXSA9ICRwYXJhbWV0ZXIgLiAnPScgLiAkdmFsdWU7CiAgICAg
IH0KICAgIH0KICAgIC8vIEZvciBlYWNoIHBhcmFtZXRlciwgdGhlIG5hbWUgaXMgc2VwYXJh
dGVkIGZyb20gdGhlIGNvcnJlc3BvbmRpbmcgdmFsdWUgYnkgYW4gJz0nIGNoYXJhY3RlciAo
QVNDSUkgY29kZSA2MSkKICAgIC8vIEVhY2ggbmFtZS12YWx1ZSBwYWlyIGlzIHNlcGFyYXRl
ZCBieSBhbiAnJicgY2hhcmFjdGVyIChBU0NJSSBjb2RlIDM4KQogICAgcmV0dXJuIGltcGxv
ZGUoJyYnLCAkcGFpcnMpOwogIH0KfSI7czozOiJtZDUiO3M6MzI6IjZlNGFjZGE3YTFiYWEy
YjNmMzg1ZTljYTMyNTE2ODFmIjt9
