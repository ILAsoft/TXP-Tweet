# arc_twitter v3.3.0
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjU6
IjMuMy4wIjtzOjY6ImF1dGhvciI7czoxMToiQW5keSBDYXJ0ZXIiO3M6MTA6ImF1dGhvcl91
cmkiO3M6MzE6Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbS8iO3M6MTE6ImRlc2Ny
aXB0aW9uIjtzOjYwOiI8YSBocmVmPSJodHRwOi8vd3d3LnR3aXR0ZXIuY29tIj5Ud2l0dGVy
PC9hPiBmb3IgVGV4dHBhdHRlcm4iO3M6NToib3JkZXIiO3M6MToiNSI7czo0OiJ0eXBlIjtz
OjE6IjUiO3M6NToiZmxhZ3MiO3M6MToiMyI7czo0OiJoZWxwIjtzOjE3OTc2OiIJPGgxIGNs
YXNzPSJ0aXRsZSI+PHNwYW4gY2xhc3M9ImNhcHMiPlRYUDwvc3Bhbj4gVHdlZXQgKGFyY190
d2l0dGVyIGZvciBUZXh0cGF0dGVybik8L2gxPgoKCTxvbD4KCQk8bGk+PGEgaHJlZj0iI2Fy
Y190d2l0dGVyX2F1dGhvciI+QXV0aG9yPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNf
dHdpdHRlcl9pbnN0YWxsYXRpb24iPkluc3RhbGxhdGlvbiAvIFVuaW5zdGFsbGF0aW9uPC9h
PjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl90YWciPlRoZSBhcmNfdHdpdHRl
ciB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3NlYXJjaF90YWci
PlRoZSBhcmNfdHdpdHRlcl9zZWFyY2ggdGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNh
cmNfdHdpdHRlcl90d2VldF9idXR0b25fdGFnIj5UaGUgYXJjX3R3aXR0ZXJfdHdlZXRfYnV0
dG9uIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfZm9sbG93X2J1
dHRvbl90YWciPlRoZSBhcmNfdHdpdHRlcl9mb2xsb3dfYnV0dG9uIHRhZzwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfdHdlZXRfdXJsIj5UaGUgYXJjX3R3aXR0ZXJf
dHdlZXRfdXJsIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfdGlu
eXVybCI+VGhlIGFyY190d2l0dGVyX3Rpbnl1cmwgdGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhy
ZWY9IiNhcmNfdHdpdHRlcl9jYWNoaW5nIj5DYWNoaW5nPC9hPjwvbGk+CgkJPGxpPjxhIGhy
ZWY9IiNhcmNfdHdpdHRlcl9wcmVmcyI+UHJlZmVyZW5jZXM8L2E+PC9saT4KCQk8bGk+PGEg
aHJlZj0iI2FyY190d2l0dGVyX2FydGljbGUiPlR3ZWV0aW5nIGFydGljbGVzPC9hPjwvbGk+
CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl9hZG1pbiI+VGhlIFR3aXR0ZXIgdGFiPC9h
PjwvbGk+Cgk8L29sPgoKCTxwPjxzcGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0
IHByb3ZpZGVzIGFjY2VzcyB0byB5b3VyIFR3aXR0ZXIgYWNjb3VudCB0aHJvdWdoIGJvdGgg
dGhlIGFkbWluIGludGVyZmFjZSBhbmQgdGhlIHB1YmxpYyBzaWRlIG9mIHlvdXIgc2l0ZS4g
VXBkYXRlIFR3aXR0ZXIgd2hlbiB5b3UgcG9zdCBhIG5ldyBhcnRpY2xlICh3aXRoIGFydGlj
bGUtYnktYXJ0aWNsZSBvcHQgb3V0IG9wdGlvbiksIHVwZGF0ZSBhbmQgdmlldyB5b3VyIFR3
aXR0ZXIgZmVlZCB0aHJvdWdoIHRoZSBhZG1pbiBUd2l0dGVyIHRhYiwgYW5kIGRpc3BsYXkg
VHdpdHRlciBmZWVkcyBvbiB5b3VyIHNpdGUuPC9wPgoKCTxwPlJlcXVpcmVtZW50czotPC9w
PgoKCTx1bD4KCQk8bGk+VGV4dHBhdHRlcm4gNC41KzwvbGk+CgkJPGxpPjxzcGFuIGNsYXNz
PSJjYXBzIj5QSFA8L3NwYW4+IDUgYW5kIGNVUkw8L2xpPgoJPC91bD4KCgk8aDIgY2xhc3M9
InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9hdXRob3IiPkF1dGhvcjwvaDI+CgoJPHA+PGEg
aHJlZj0iaHR0cDovL3JlZGhvdGNoaWxsaXByb2plY3QuY29tIj5BbmR5IENhcnRlcjwvYT4u
IEZvciBvdGhlciBUZXh0cGF0dGVybiBwbHVnaW5zIGJ5IG1lIHZpc2l0IG15IDxhIGhyZWY9
Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbS90eHAiPlBsdWdpbnMgcGFnZTwvYT4u
PC9wPgoKCTxwPkNvbnRyaWJ1dG9yczogQW5keSBDYXJ0ZXIsIFBoaWwgV2FyZWhhbSBhbmQg
VG9tbXkgU2NobXVja2VyLjwvcD4KCgk8cD5UaGFua3MgdG8gPGEgaHJlZj0iaHR0cDovL21h
bmZyZS5uZXQvIj5NaWNoYWVsIE1hbmZyZTwvYT4gZm9yIGluc3BpcmF0aW9uIGZvciB0aGUg
YXJ0aWNsZSB0d2VldCBwYXJ0IG9mIHRoaXMgcGx1Z2luIGJhc2VkIG9uIGhpcyA8c3BhbiBj
bGFzcz0idGFnIj5tZW1fdHdpdHRlcjwvc3Bhbj4gcGx1Z2luLiAgQWRkaXRpb25hbCB0aGFu
a3MgdG8gdGhlIGdyZWF0IFRleHRwYXR0ZXJuIGNvbW11bml0eSBmb3IgaGVscGluZyB0byB0
ZXN0IHRoaXMgcGx1Z2luIGFuZCBmb3Igc3VnZ2VzdGluZyBuZXcgZmVhdHVyZXMuIFRoZSBP
QXV0aCBwYXJ0IG9mIHRoZSBwbHVnaW4gaXMgdGhhbmtzIHRvIDxhIGhyZWY9Imh0dHA6Ly90
d2l0dGVyLmNvbS9hYnJhaGFtIj5BYnJhaGFtIFdpbGxpYW1zPC9hPi48L3A+CgoJPGgyIGNs
YXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfaW5zdGFsbGF0aW9uIj5JbnN0YWxsYXRp
b24gLyBVbmluc3RhbGxhdGlvbjwvaDI+CgoJPHA+VG8gaW5zdGFsbCBnbyB0byB0aGUgJiM4
MjE2O3BsdWdpbnMmIzgyMTc7IHRhYiB1bmRlciAmIzgyMTY7YWRtaW4mIzgyMTc7IGFuZCBw
YXN0ZSB0aGUgcGx1Z2luIGNvZGUgaW50byB0aGUgJiM4MjE2O0luc3RhbGwgcGx1Z2luJiM4
MjE3OyBib3gsICYjODIxNjt1cGxvYWQmIzgyMTc7IGFuZCB0aGVuICYjODIxNjtpbnN0YWxs
JiM4MjE3Oy4gVGhlIHBsdWdpbiB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgYWN0aXZhdGVkLjwv
cD4KCgk8cD5CZWZvcmUgeW91IHN0YXJ0IHVzaW5nIDxzcGFuIGNsYXNzPSJ0YWciPmFyY190
d2l0dGVyPC9zcGFuPiB5b3Ugd2lsbCBuZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IHRoZSBjYWNo
ZSBkaXJlY3RvcnkgaXMgd3JpdGFibGUuIFNlZSB0aGUgJiM4MjE2O0NhY2hpbmcmIzgyMTc7
IHN1YnNlY3Rpb24gYmVsb3cgZm9yIGZ1cnRoZXIgaW5mb3JtYXRpb24uPC9wPgoKCTxwPjxz
cGFuIGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiBzaG91bGQgbm93IGJlIHJlYWR5
IGZvciB1c2Ugb24gdGhlIHB1YmxpYy1zaWRlIG9mIHlvdXIgc2l0ZS48L3A+CgoJPHA+VG8g
dW5sb2NrIHRoZSBhZG1pbiBmZWF0dXJlcyBvZiB0aGlzIHBsdWdpbiB5b3Ugd2lsbCBuZWVk
IHRvIGFzc29jaWF0ZSB5b3VyIHNpdGUgd2l0aCBhIFR3aXR0ZXIgYWNjb3VudCBieSBjb25u
ZWN0aW5nIHRvIFR3aXR0ZXIgZnJvbSB0aGUgcGx1Z2luJiM4MjE3O3Mgb3B0aW9ucyBzY3Jl
ZW4uIENsaWNrIG9uIHRoZSBsaW5rIHRvIGNvbm5lY3QgdG8gVHdpdHRlciwgeW91IHdpbGwg
YmUgYXNrZWQgdG8gbG9naW4gdG8gVHdpdHRlciwgY2xpY2tpbmcgdGhpcyBsaW5rIHdpbGwg
dGVtcG9yYXJpbHkgdGFrZSB5b3UgdG8gdGhlIFR3aXR0ZXIgc2l0ZSB3aGVyZSB5b3Ugd2ls
bCBiZSBhc2tlZCB0byBsb2dpbiBhbmQgYXBwcm92ZSBhY2Nlc3MgZm9yIDxzcGFuIGNsYXNz
PSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0IHRvIHJlYWQgYW5kIHdyaXRlIHRvIHlvdXIgVHdp
dHRlciBhY2NvdW50LiBJZiBhbGwgaXMgc3VjY2Vzc2Z1bCB5b3Ugd2lsbCBiZSByZXR1cm5l
ZCB0byB0aGUgb3B0aW9ucyBzY3JlZW4gYW5kIHlvdXIgdXNlciBuYW1lIHdpbGwgYXBwZWFy
LjwvcD4KCgk8cD5BdCBhbnkgdGltZSB5b3UgY2FuIGRpc2Fzc29jaWF0ZSB5b3VyIFR3aXR0
ZXIgYWNjb3VudCB3aXRoIDxzcGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0IHZp
YSB5b3VyIFR3aXR0ZXIgYWNjb3VudCBwcmVmZXJlbmNlcyBvbiB0aGUgPGEgaHJlZj0iaHR0
cDovL3d3dy50d2l0dGVyLmNvbSI+VHdpdHRlciB3ZWJzaXRlPC9hPi48L3A+CgoJPHA+VG8g
dW5pbnN0YWxsIDxzcGFuIGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiBzaW1wbHkg
ZGVsZXRlIHRoZSBwbHVnaW4gZnJvbSB0aGUgJiM4MjE2O1BsdWdpbnMmIzgyMTc7IHRhYi4g
IFRoaXMgd2lsbCByZW1vdmUgdGhlIHBsdWdpbiBjb2RlLCBkZWxldGUgcmVsYXRlZCBwcmVm
ZXJlbmNlcyBhbmQgZHJvcCB0aGUgPHNwYW4gY2xhc3M9InRhZyI+YXJjX3R3aXR0ZXI8L3Nw
YW4+IHRhYmxlIGZyb20geW91ciBUZXh0cGF0dGVybiBkYXRhYmFzZS48L3A+CgoJPGgyIGNs
YXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfdGFnIj5UaGUgYXJjX3R3aXR0ZXIgdGFn
PC9oMj4KCgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyIHVzZXI9
JnF1b3Q7ZHJtb25rZXluaW5qYSZxdW90OyAvJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoK
CTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRp
b248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPnVzZXI8L3RkPgoJCQk8dGQ+VHdpdHRlciB1c2VyIG5hbWU8L3Rk
PgoJCQk8dGQ+IDxlbT5hcmNfdHdpdHRlciB1c2VybmFtZTwvZW0+PC90ZD4KCQkJPHRkPnVz
ZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5yZXR3ZWV0czwvdGQ+CgkJCTx0ZD4xIHRvIGluY2x1ZGUgcmV0d2VldHMsIDAgdG8gZXhj
bHVkZSB0aGVtIGZyb20gdGhlIGZlZWQ8L3RkPgoJCQk8dGQ+MDwvdGQ+CgkJPC90cj4KCQk8
dHI+CgkJCTx0ZD5yZXBsaWVzPC90ZD4KCQkJPHRkPjEgdG8gaW5jbHVkZSByZXBsaWVzLCAw
IHRvIGV4Y2x1ZGUgdGhlbSBmcm9tIHRoZSBmZWVkPC90ZD4KCQkJPHRkPjE8L3RkPgoJCTwv
dHI+CgkJPHRyPgoJCQk8dGQ+bGltaXQ8L3RkPgoJCQk8dGQ+TWF4aW11bSBudW1iZXIgb2Yg
dHdlZXRzIHRvIGRpc3BsYXkgKG1heC4gMjAwKTwvdGQ+CgkJCTx0ZD4xMDwvdGQ+CgkJCTx0
ZD5saW1pdD0mcXVvdDsyNSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5mZXRj
aDwvdGQ+CgkJCTx0ZD5NYXhpbXVtIG51bWJlciBvZiB0d2VldHMgdG8gcmV0cmlldmUgZnJv
bSBUd2l0dGVyIChtYXguIDIwMCk8c3VwIGNsYXNzPSJmb290bm90ZSI+PGEgaHJlZj0iI2Zu
NTA1MDA5ODgyNTA3NWI4MzU3OThiNCI+MTwvYT48L3N1cD48L3RkPgoJCQk8dGQ+MDwvdGQ+
CgkJCTx0ZD5mZXRjaD0mcXVvdDs1MCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5kYXRlZm9ybWF0PC90ZD4KCQkJPHRkPkZvcm1hdCB0aGF0IHVwZGF0ZSBkYXRlcyB3aWxs
IGFwcGVhciBhczwvdGQ+CgkJCTx0ZD4gPGVtPkFyY2hpdmUgZGF0ZSBmb3JtYXQ8L2VtPjwv
dGQ+CgkJCTx0ZD5kYXRlZm9ybWF0PSZxdW90OyViICVPZSwgJUk6JU0gJXAmcXVvdDs8L3Rk
PgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFiZWw8L3RkPgoJCQk8dGQ+TGFiZWwgZm9yIHRo
ZSB0b3Agb2YgdGhlIGxpc3Q8L3RkPgoJCQk8dGQ+IDxlbT5ubyBsYWJlbDwvZW0+PC90ZD4K
CQkJPHRkPmxhYmVsPSZxdW90O015IFR3aXR0ZXIgdGltZWxpbmUmcXVvdDs8L3RkPgoJCTwv
dHI+CgkJPHRyPgoJCQk8dGQ+bGFiZWx0YWc8L3RkPgoJCQk8dGQ+SW5kZXBlbmRlbnQgd3Jh
cHRhZyBmb3IgbGFiZWw8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJPHRk
PmxhYmVsdGFnPSZxdW90O2gzJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmJy
ZWFrPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+
SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyAod2l0aG91dCBicmFja2V0cyksIG9yIHN0cmluZywg
dXNlZCB0byBzZXBhcmF0ZSB0aGUgdXBkYXRlczwvdGQ+CgkJCTx0ZD5saTwvdGQ+CgkJCTx0
ZD5icmVhaz0mcXVvdDticiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD53cmFw
dGFnPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+
SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyB0byBiZSB1c2VkIGFzIHRoZSB3cmFwdGFnLCB3aXRo
b3V0IGJyYWNrZXRzPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0ZD53
cmFwdGFnPSZxdW90O3VsJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNz
PC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NT
PC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGZvciB3cmFwdGFnPC90ZD4KCQkJPHRk
PmFyY190d2l0dGVyPC90ZD4KCQkJPHRkPmNsYXNzPSZxdW90O3R3aXR0ZXImcXVvdDs8L3Rk
PgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3NfcG9zdGVkPC90ZD4KCQkJPHRkPjxzcGFu
IGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xh
c3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gc3BhbiB0YWcgYXJvdW5kIHBvc3RlZCBkYXRlPC90
ZD4KCQkJPHRkPmFyY190d2l0dGVyLXBvc3RlZDwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJ
PHAgaWQ9ImZuNTA1MDA5ODgyNTA3NWI4MzU3OThiNCIgY2xhc3M9ImZvb3Rub3RlIj48c3Vw
PjE8L3N1cD4gVHdpdHRlciYjODIxNztzIDxzcGFuIGNsYXNzPSJjYXBzIj5BUEk8L3NwYW4+
IGNvdW50cyB0aGUgbnVtYmVyIG9mIHR3ZWV0cyB0byByZXR1cm4gYmVmb3JlIGFwcGx5aW5n
IHNvbWUgb2YgdGhlIGZpbHRlcnMsIHNvIHRoZSByZXNwb25zZSBjYW4gYmUgZmV3ZXIgdHdl
ZXRzIHRoYW4gZXhwZWN0ZWQuIFRvIGhlbHAgYXZvaWQgdGhpcyB5b3UgY2FuIHNldCBhIDxl
bT5mZXRjaDwvZW0+IGxpbWl0IHRoYXQgaXMgaGlnaGVyIHRoYW4gdGhlIGRpc3BsYXkgPGVt
PmxpbWl0PC9lbT4gdGhhdCB5b3Ugd2FudCB0byBvdXRwdXQuIElmIDxlbT5mZXRjaDwvZW0+
IGlzIGxlc3MgdGhhbiA8ZW0+bGltaXQ8L2VtPiB0aGUgbGF0dGVyIHdpbGwgYmUgdXNlZCBp
bnN0ZWFkLjwvcD4KCgk8aDM+RXhhbXBsZSB1c2FnZTwvaDM+CgoJPHA+Jmx0O3R4cDphcmNf
dHdpdHRlciB1c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDsgbGltaXQ9JnF1b3Q7NSZx
dW90OyB3cmFwdGFnPSZxdW90O3VsJnF1b3Q7IGJyZWFrPSZxdW90O2xpJnF1b3Q7IGRhdGVm
b3JtYXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAlcCZxdW90OyAvJmd0OzwvcD4KCgk8cD5Qcm9k
dWNlcyBhIGJ1bGxldCBwb2ludCBsaXN0IG9mIHRoZSBsYXN0IDUgVHdpdHRlciB1cGRhdGVz
IGZyb20gZHJtb25rZXluaW5qYSYjODIxNztzIFR3aXR0ZXIgZmVlZCB3aXRoIGEgZGVmaW5l
ZCBkYXRlIGZvcm1hdCB0byBvdmVycmlkZSB0aGUgZGVmYXVsdCBhcmNoaXZlIGRhdGUgZm9y
bWF0LjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9zZWFyY2hf
dGFnIj5UaGUgYXJjX3R3aXR0ZXJfc2VhcmNoIHRhZzwvaDI+CgoJPGgzPlN5bnRheDwvaDM+
CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl9zZWFyY2ggaGFzaHRhZ3M9JnF1b3Q7dHhwJnF1
b3Q7IC8mZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRo
PkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0
PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+c2VhcmNo
PC90ZD4KCQkJPHRkPkNvbW1hIHNlcGFyYXRlZCBsaXN0IG9mIHNlYXJjaCB3b3JkczwvdGQ+
CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+c2VhcmNoPSZxdW90O3R4cCx0
ZXh0cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5oYXNodGFnczwv
dGQ+CgkJCTx0ZD5Db21tYSBzZXBhcmF0ZWQgbGlzdCBvZiBoYXNodGFncyB0byBzZWFyY2gg
Zm9yIChub3QgaW5jbHVkaW5nIHRoZSBoYXNoKTwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9l
bT48L3RkPgoJCQk8dGQ+aGFzaHRhZ3M9JnF1b3Q7dHhwLHRleHRwYXR0ZXJuJnF1b3Q7PC90
ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnJlcGx5PC90ZD4KCQkJPHRkPlVzZXJuYW1lIG9m
IHR3ZWV0cyBpbiByZXBseSB0bzwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJ
CQk8dGQ+cmVwbHk9JnF1b3Q7dHdpdHRlciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJ
CTx0ZD5tZW50aW9uPC90ZD4KCQkJPHRkPlVzZXJuYW1lIG9mIHVzZXIgbWVudGlvbmVkIGlu
IHR3ZWV0cyAoPGk+aS5lLjwvaT4gdHdlZXRzIGNvbnRhaW5pbmcgQHVzZXJuYW1lKTwvdGQ+
CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+bWVudGlvbj0mcXVvdDt0d2l0
dGVyJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxpbWl0PC90ZD4KCQkJPHRk
Pk1heGltdW0gbnVtYmVyIG9mIHR3ZWV0cyB0byBkaXNwbGF5IChtYXguIDIwMCk8L3RkPgoJ
CQk8dGQ+MTA8L3RkPgoJCQk8dGQ+bGltaXQ9JnF1b3Q7MjUmcXVvdDs8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+ZGF0ZWZvcm1hdDwvdGQ+CgkJCTx0ZD5Gb3JtYXQgdGhhdCB1cGRh
dGUgZGF0ZXMgd2lsbCBhcHBlYXIgYXM8L3RkPgoJCQk8dGQ+IDxlbT5BcmNoaXZlIGRhdGUg
Zm9ybWF0PC9lbT48L3RkPgoJCQk8dGQ+ZGF0ZWZvcm1hdD0mcXVvdDslYiAlT2UsICVJOiVN
ICVwJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsPC90ZD4KCQkJPHRk
PkxhYmVsIGZvciB0aGUgdG9wIG9mIHRoZSBsaXN0PC90ZD4KCQkJPHRkPiA8ZW0+bm8gbGFi
ZWw8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbHRhZzwvdGQ+CgkJCTx0
ZD5JbmRlcGVuZGVudCB3cmFwdGFnIGZvciBsYWJlbDwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0
PC9lbT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+YnJlYWs8L3RkPgoJCQk8dGQ+PHNw
YW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4g
dGFnICh3aXRob3V0IGJyYWNrZXRzKSwgb3Igc3RyaW5nLCB1c2VkIHRvIHNlcGFyYXRlIHRo
ZSB1cGRhdGVzPC90ZD4KCQkJPHRkPmxpPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPndy
YXB0YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBz
Ij5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVzZWQgYXMgdGhlIHdyYXB0YWcsIHdp
dGhvdXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48
c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGZv
ciB3cmFwdGFnPC90ZD4KCQkJPHRkPmFyY190d2l0dGVyX3NlYXJjaDwvdGQ+CgkJPC90cj4K
CQk8dHI+CgkJCTx0ZD5jbGFzc191c2VyPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBz
Ij48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRl
IGFwcGxpZWQgdG8gc3BhbiB0YWcgYXJvdW5kIHVzZXIgbmFtZTwvdGQ+CgkJCTx0ZD5hcmNf
dHdpdHRlci11c2VyPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzX3Bvc3RlZDwv
dGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwv
c3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHNwYW4gdGFnIGFyb3Vu
ZCBwb3N0ZWQgZGF0ZTwvdGQ+CgkJCTx0ZD5hcmNfdHdpdHRlci1wb3N0ZWQ8L3RkPgoJCTwv
dHI+Cgk8L3RhYmxlPgoKCTxoMz5FeGFtcGxlIHVzYWdlPC9oMz4KCgk8cD4mbHQ7dHhwOmFy
Y190d2l0dGVyX3NlYXJjaCBzZWFyY2g9JnF1b3Q7cGx1Z2luJnF1b3Q7IGhhc2h0YWdzPSZx
dW90O3R4cCx0ZXh0cGF0dGVybiZxdW90OyBsaW1pdD0mcXVvdDsyNSZxdW90OyAvJmd0Ozwv
cD4KCgk8cD5Qcm9kdWNlcyBhIGxpc3Qgb2YgdHdlZXRzIGNvbnRhaW5pbmcgdGhlIHdvcmQg
JiM4MjE2O3BsdWdpbiYjODIxNzsgYW5kIHRoZSBoYXNodGFncyAmIzgyMTY7I3R4cCYjODIx
NzsgYW5kICYjODIxNjsjdGV4dHBhdHRlcm4mIzgyMTc7LiBUaGUgdGFnIHdpbGwgcmV0dXJu
IGEgbWF4aW11bSBvZiAyNSB0d2VldHMuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9
ImFyY190d2l0dGVyX3JldHdlZXRfdGFnIj5UaGUgYXJjX3R3aXR0ZXJfdHdlZXRfYnV0dG9u
IHRhZzwvaDI+CgoJPHA+T3V0cHV0cyB0aGUgVHdpdHRlciB0d2VldCBidXR0b24gKGZvcm1l
cmx5ICZsdDt0eHA6YXJjX3R3aXR0ZXJfcmV0d2VldCAvJmd0OykuPC9wPgoKCTxoMz5TeW50
YXg8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfdHdlZXRfYnV0dG9uIC8mZ3Q7PC9w
PgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwv
dGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRo
PkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+dXNlcjwvdGQ+CgkJCTx0ZD5U
d2l0dGVyIHVzZXIgbmFtZSB0byBxdW90ZTwvdGQ+CgkJCTx0ZD4gPGVtPmFyY190d2l0dGVy
IHVzZXJuYW1lPC9lbT48L3RkPgoJCQk8dGQ+dXNlcj0mcXVvdDtkcm1vbmtleW5pbmphJnF1
b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVybDwvdGQ+CgkJCTx0ZD48c3BhbiBj
bGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj48L3NwYW4+IHRvIHR3
ZWV0PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnRleHQ8L3RkPgoJCQk8dGQ+VHdlZXQg
dGV4dDwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5mb2xsb3cxPC90ZD4KCQkJPHRkPlN1
Z2dlc3RlZCBUd2l0dGVyIGFjY291bnQgdG8gZm9sbG93LCBmb3IgZXhhbXBsZSB5b3VyIG93
bjwvdGQ+CgkJCTx0ZD5BIFR3aXR0ZXIgdXNlciB0byByZWNvbW1lbmQ8L3RkPgoJCQk8dGQ+
Zm9sbG93MT0mcXVvdDtUZXh0cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJ
CTx0ZD5mb2xsb3cyPC90ZD4KCQkJPHRkPkFzIGZvbGxvdzE8L3RkPgoJCQk8dGQ+IDxlbT51
bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhbmc8L3RkPgoJCQk8dGQ+
TGFuZ3VhZ2U8L3RkPgoJCQk8dGQ+ZW48L3RkPgoJCQk8dGQ+bGFuZz0mcXVvdDtlcyZxdW90
OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jb3VudDwvdGQ+CgkJCTx0ZD5Db3VudCBi
b3ggcG9zaXRpb24sIG9wdGlvbnM6IG5vbmUsIGhvcml6b250YWwgb3IgdmVydGljYWw8L3Rk
PgoJCQk8dGQ+aG9yaXpvbnRhbDwvdGQ+CgkJCTx0ZD5jb3VudD0mcXVvdDtub25lJnF1b3Q7
PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmluY2x1ZGVfanM8L3RkPgoJCQk8dGQ+V2hl
dGhlciBvciBub3QgdG8gaW5jbHVkZSB0aGUgd2lkZ2V0IEphdmFTY3JpcHQ8L3RkPgoJCQk8
dGQ+MTwvdGQ+CgkJCTx0ZD5pbmNsdWRlX2pzPSZxdW90OzAmcXVvdDs8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+b3B0aW1pc2VfanM8L3RkPgoJCQk8dGQ+T3B0aW1pc2UgdGhlIEph
dmFTY3JpcHQgYnkgdXNpbmcgYSBsb2NhbCBzY3JpcHQgcmF0aGVyIHRoYW4gdGhhdCBob3N0
ZWQgb24gdGhlIFR3aXR0ZXIgc2l0ZTwvdGQ+CgkJCTx0ZD4wPC90ZD4KCQkJPHRkPm9wdGlt
aXNlX2pzPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8
L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8
L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byB0aGUgdHdlZXQgYnV0
dG9uPC90ZD4KCQkJPHRkPnR3aXR0ZXItc2hhcmUtYnV0dG9uPC90ZD4KCQk8L3RyPgoJPC90
YWJsZT4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9mb2xsb3dfYnV0
dG9uX3RhZyI+VGhlIGFyY190d2l0dGVyX2ZvbGxvd19idXR0b24gdGFnPC9oMj4KCgk8cD5P
dXRwdXRzIHRoZSBUd2l0dGVyIGZvbGxvdyBidXR0b24gKGFuIGFsdGVybmF0aXZlIHZlcnNp
b24gaXMgaW5jbHVkZWQgaW4gYXJjX3R3aXR0ZXJfaW50ZW50cykuPC9wPgoKCTxoMz5TeW50
YXg8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfZm9sbG93X2J1dHRvbiAvJmd0Ozwv
cD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8
L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0
aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVzZXI8L3RkPgoJCQk8dGQ+
VHdpdHRlciB1c2VyIG5hbWUgdG8gZm9sbG93PC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0
ZXIgdXNlcm5hbWU8L2VtPjwvdGQ+CgkJCTx0ZD51c2VyPSZxdW90O2RybW9ua2V5bmluamEm
cXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFuZzwvdGQ+CgkJCTx0ZD5MYW5n
dWFnZTwvdGQ+CgkJCTx0ZD5lbjwvdGQ+CgkJCTx0ZD5sYW5nPSZxdW90O2VzJnF1b3Q7PC90
ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNvdW50PC90ZD4KCQkJPHRkPldoZXRoZXIgb3Ig
bm90IHRoZSBmb2xsb3dlciBjb3VudCBpcyBzaG93bjwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQkJ
PHRkPmNvdW50PSZxdW90OzAmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aW5j
bHVkZV9qczwvdGQ+CgkJCTx0ZD5XaGV0aGVyIG9yIG5vdCB0byBpbmNsdWRlIHRoZSB3aWRn
ZXQgSmF2YVNjcmlwdDwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQkJPHRkPmluY2x1ZGVfanM9JnF1
b3Q7MCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5vcHRpbWlzZV9qczwvdGQ+
CgkJCTx0ZD5PcHRpbWlzZSB0aGUgSmF2YVNjcmlwdCBieSB1c2luZyBhIGxvY2FsIHNjcmlw
dCByYXRoZXIgdGhhbiB0aGF0IGhvc3RlZCBvbiB0aGUgVHdpdHRlciBzaXRlPC90ZD4KCQkJ
PHRkPjA8L3RkPgoJCQk8dGQ+b3B0aW1pc2VfanM9JnF1b3Q7MSZxdW90OzwvdGQ+CgkJPC90
cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+
PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBh
cHBsaWVkIHRvIHRoZSBmb2xsb3cgYnV0dG9uPC90ZD4KCQkJPHRkPnR3aXR0ZXItZm9sbG93
LWJ1dHRvbjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBp
ZD0iYXJjX3R3aXR0ZXJfdHdlZXRfdXJsIj5hcmNfdHdpdHRlcl90d2VldF91cmw8L2gyPgoK
CTxwPlJldHVybnMgdGhlIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+IG9mIHRoZSBU
d2l0dGVyIHN0YXR1cyBmb3IgYW4gYXJ0aWNsZS48L3A+CgoJPGgzPlN5bnRheDwvaDM+CgoJ
PHA+Jmx0O3R4cDphcmNfdHdpdHRlcl90d2VldF91cmwgLyZndDs8L3A+CgoJPHA+Jmx0O3R4
cDphcmNfdHdpdHRlcl90d2VldF91cmwmZ3Q7TGluayB0ZXh0Jmx0Oy90eHA6YXJjX3R3aXR0
ZXJfdHdlZXRfdXJsJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+
CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+
RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRk
PmlkPC90ZD4KCQkJPHRkPlRleHRwYXR0ZXJuIGFydGljbGUgSUQ8L3RkPgoJCQk8dGQ+IDxl
bT5jdXJyZW50IGFydGljbGU8L2VtPjwvdGQ+CgkJCTx0ZD5pZD0mcXVvdDsxJnF1b3Q7PC90
ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnRpdGxlPC90ZD4KCQkJPHRkPlRpdGxlIGF0dHJp
YnV0ZSBvZiB0aGUgbGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwv
dHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMi
PjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUg
YXBwbGllZCB0byB0aGUgbGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJ
CTwvdHI+Cgk8L3RhYmxlPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVy
X3Rpbnl1cmwiPmFyY190d2l0dGVyX3Rpbnl1cmw8L2gyPgoKCTxwPlJldHVybnMgdGhlIHNo
b3J0ZW5lZCA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPiBvZiB0aGUgYXJ0aWNsZSB1
c2VkIGZvciB0aGUgVHdpdHRlciB1cGRhdGUuPC9wPgoKCTxoMz5TeW50YXg8L2gzPgoKCTxw
PiZsdDt0eHA6YXJjX3R3aXR0ZXJfdGlueXVybCAvJmd0OzwvcD4KCgk8cD4mbHQ7dHhwOmFy
Y190d2l0dGVyX3Rpbnl1cmwmZ3Q7TGluayB0ZXh0Jmx0Oy90eHA6YXJjX3R3aXR0ZXJfdGlu
eXVybCZndDs8L3A+CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+
QXR0cmlidXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8
L3RoPgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5pZDwvdGQ+
CgkJCTx0ZD5UZXh0cGF0dGVybiBhcnRpY2xlIElEPC90ZD4KCQkJPHRkPiA8ZW0+Y3VycmVu
dCBhcnRpY2xlPC9lbT48L3RkPgoJCQk8dGQ+aWQ9JnF1b3Q7MSZxdW90OzwvdGQ+CgkJPC90
cj4KCQk8dHI+CgkJCTx0ZD50aXRsZTwvdGQ+CgkJCTx0ZD5UaXRsZSBhdHRyaWJ1dGUgb2Yg
dGhlIGxpbms8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0
cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBj
bGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQg
dG8gdGhlIGxpbms8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJ
PC90YWJsZT4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9jYWNoaW5n
Ij5DYWNoaW5nPC9oMj4KCgk8cD5JbiBvcmRlciB0byBwcmV2ZW50IGV4Y2Vzc2l2ZSByZXBl
YXRpdGl2ZSBjYWxscyB0byB0aGUgVHdpdHRlciB3ZWJzaXRlIGl0IGlzIHJlY29tbWVuZGVk
IHRvIGNhY2hlIHJlc3VsdHMuIFR3aXR0ZXIgbGltaXRzIHRoZSBudW1iZXIgb2YgY2FsbHMg
dGhyb3VnaCB0aGUgPHNwYW4gY2xhc3M9ImNhcHMiPkFQSTwvc3Bhbj4sIGFuZCBjb250aW51
b3VzIGNhbGxzIHdpbGwgcmVzdWx0IGluIFR3aXR0ZXIgY2xvc2luZyB0byBmdXJ0aGVyIHJl
cXVlc3RzLiBCeSBkZWZhdWx0LCBhcmNfdHdpdHRlciBjYWNoZXMgZm9yIDMwIG1pbnV0ZSBp
bnRlcnZhbHMuPC9wPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJ
CQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFt
cGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNhY2hpbmc8L3RkPgoJCQk8dGQ+JiM4
MjE2OzEmIzgyMTc7IHRvIGNhY2hlIGZlZWQsICYjODIxNjswJiM4MjE3OyB0byB0dXJuIGNh
Y2hpbmcgb2ZmIChub3QgcmVjb21tZW5kZWQpPC90ZD4KCQkJPHRkPjE8L3RkPgoJCQk8dGQ+
Y2FjaGluZz0mcXVvdDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNhY2hl
X2RpcjwvdGQ+CgkJCTx0ZD5BYnNvbHV0ZSBwYXRoIHRvIHRoZSBjYWNoZSBkaXJlY3Rvcnkg
KG11c3QgYmUgd3JpdGFibGUpPC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0ZXIgcHJlZmVy
ZW5jZXM8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jYWNoZV90aW1lPC90ZD4K
CQkJPHRkPlRpbWUgaW4gbWludXRlcyB0aGF0IHRoZSBjYWNoZSBmaWxlcyBhcmUgc3RvcmVk
IGJlZm9yZSBiZWluZyByZWZyZXNoZWQ8L3RkPgoJCQk8dGQ+NTwvdGQ+CgkJCTx0ZD5jYWNo
ZV90aW1lPSZxdW90OzMwJnF1b3Q7PC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8cD5UaGUg
YWRtaW4gc2lkZSBvZiB0aGlzIHBsdWdpbiBlbmZvcmNlcyBjYWNoaW5nLCBhcGFydCBmcm9t
IHdoZW4gaXQgaXMgcG9zdGluZyB0byBUd2l0dGVyICg8aT5lLmcuPC9pPiB3aGVuIHBvc3Rp
bmcgb3IgZGVsZXRpbmcgYW4gdXBkYXRlKS48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBp
ZD0iYXJjX3R3aXR0ZXJfcHJlZnMiPlByZWZlcmVuY2VzPC9oMj4KCgk8cD5Zb3UgY2FuIGFj
Y2VzcyB0aGUgcGx1Z2lucyBjb3JlIHByZWZlcmVuY2VzIGZyb20gZWl0aGVyIHRoZSBQcmVm
ZXJlbmNlcyBvciBQbHVnaW5zIHRhYnMgaW4gYWRtaW4uIFNldHVwIHlvdXIgVHdpdHRlciBh
Y2NvdW50ICh5b3Ugd2lsbCBiZSBhc2tlZCB0byBjb25uZWN0IHZpYSBUd2l0dGVyIGFuZCB0
aGlzIG5lZWRzIGRvaW5nIGJlZm9yZSB5b3UgY2FuIHVzZSB0aGUgcGx1Z2luKSBhbmQgY2hh
bmdlIHRoZSBjYWNoZSBkaXJlY3RvcnkgdXNpbmcgYXJjX3R3aXR0ZXImIzgyMTc7cyBwcmVm
ZXJlbmNlcy4gV2l0aG91dCBwcm92aWRpbmcgeW91ciBhY2NvdW50IGxvZ2luIGRldGFpbHMg
dGhlIGFkbWluIGFyZWEgZmVhdHVyZXMgb2YgdGhpcyBwbHVnaW4gd2lsbCBiZSBpbmFjdGl2
ZS48L3A+CgoJPHA+WW91IGNhbiBzZWxlY3QgdGhlIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8
L3NwYW4+IHNob3J0ZW5lciBtZXRob2QgeW91IHdhbnQgdG8gdXNlIHRvIGxpbmsgYmFjayB0
byB5b3VyIGFydGljbGUgb24gVHdpdHRlci4gUGxlYXNlIG5vdGUgdGhhdCBpZiB5b3Ugc2Vs
ZWN0IHNtZF9zaG9ydF91cmwgeW91IHdpbGwgbmVlZCB0byBoYXZlIGluc3RhbGxlZCBhbmQg
YWN0aXZhdGVkIHRoZSA8YSBocmVmPSJodHRwOi8vdGV4dHBhdHRlcm4ub3JnL3BsdWdpbnMv
MTA5OS9zbWRfc2hvcnRfdXJsIj48c3BhbiBjbGFzcz0idGFnIj5zbWRfc2hvcnRfdXJsPC9z
cGFuPiBwbHVnaW48L2E+IGRldmVsb3BlZCBieSBTdGVmIERhd3Nvbi48L3A+CgoJPGgyIGNs
YXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYXJ0aWNsZSI+VHdlZXRpbmcgYXJ0aWNs
ZXM8L2gyPgoKCTxwPkJ5IGRlZmF1bHQgYXJjX3R3aXR0ZXIgd2lsbCBwb3N0IGFuIHVwZGF0
ZSB0byBUd2l0dGVyIGluY2x1ZGluZyBhIHNob3J0ZW5lZCA8c3BhbiBjbGFzcz0iY2FwcyI+
VVJMPC9zcGFuPiB0byB5b3VyIGFydGljbGUuIE9ubHkgbGl2ZSBhbmQgYWN0aXZlIGFydGlj
bGVzIHdpbGwgYmUgc2VudCB0byBUd2l0dGVyLCA8aT5pLmUuPC9pPiBhcnRpY2xlcyBwb3N0
ZWQgaW4gdGhlIGZ1dHVyZSBvciBhcyBzdGlja3kgYXJ0aWNsZXMgd2lsbCBub3QgYmUgc2Vu
dC4gSWYgeW91ciBhcnRpY2xlIGlzIHN1Y2Nlc3NmdWxseSBzdWJtaXR0ZWQgdG8gVHdpdHRl
ciB0aGUgdXBkYXRlIHdpbGwgYXBwZWFyIGluIHBsYWNlIG9mIHRoZSBUd2l0dGVyIG9wdGlv
biBvbiB0aGUgcmlnaHQtaGFuZC1zaWRlIG9mIHRoZSBhcnRpY2xlIGVkaXQgc2NyZWVuLjwv
cD4KCgk8cD5Ud2VldHMgYXJlIHNlbnQgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6IDxlbT5U
d2VldCBwcmVmaXg8L2VtPiA8ZW0+QXJ0aWNsZSB0aXRsZTwvZW0+IDxlbT5TaG9ydGVuZWQg
PHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj48L2VtPiA8ZW0+VHdlZXQgc3VmZml4PC9l
bT4uIFlvdSBjYW4gY2hhbmdlIHRoZSBwcmVmaXggYW5kIHN1ZmZpeCBvbiBhbiBhcnRpY2xl
LWJ5LWFydGljbGUgYmFzaXMgYnkgY2hhbmdpbmcgdGhlIHR3ZWV0IG9wdGlvbnMgdW5kZXIg
JiM4MjE2O1VwZGF0ZSBUd2l0dGVyJiM4MjE3OyBvbiB0aGUgYXJ0aWNsZSBlZGl0b3Igc2Ny
ZWVuLiBUaGUgZGVmYXVsdCA8ZW0+VHdlZXQgcHJlZml4PC9lbT4gY2FuIGJlIHNldCB1bmRl
ciB0aGUgPHNwYW4gY2xhc3M9InRhZyI+YXJjX3R3aXR0ZXI8L3NwYW4+IHByZWZlcmVuY2Vz
IHNjcmVlbiAodGhlIGRlZmF1bHQgb24gaW5zdGFsbGF0aW9uIGlzICYjODIyMDtKdXN0IHBv
c3RlZDomIzgyMjE7KS48L3A+CgoJPHA+UGxlYXNlIG5vdGUgdGhhdCBvbmNlIGFuIGFydGlj
bGUgaGFzIGJlZW4gdHdlZXRlZCB0aGUgdHdlZXQgY2Fubm90IGJlIGVkaXRlZC48L3A+CgoJ
PGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYWRtaW4iPlRoZSBUd2l0dGVy
IHRhYjwvaDI+CgoJPHA+VW5kZXIgdGhlIEV4dGVuc2lvbnMgdGFiICh0aGlzIGNhbiBiZSBj
aGFuZ2VkIGZyb20gdGhlIHBsdWdpbiYjODIxNztzIHByZWZlcmVuY2UgcGFnZSkgYSBuZXcg
VHdpdHRlciB0YWIgc2hvdWxkIGFwcGVhciBvbmNlIHlvdSBoYXZlIGNvbm5lY3RlZCB5b3Vy
IHNpdGUgdG8geW91ciBUd2l0dGVyIGFjY291bnQuIEZyb20gaGVyZSB5b3Ugd2lsbCBiZSBh
YmxlIHRvIHN1Ym1pdCBuZXcgVHdpdHRlciB1cGRhdGVzLCB2aWV3IGJhc2ljIGFjY291bnQg
c3RhdGlzdGljcywgYW5kIGNoZWNrIG91dCB5b3VyIHJlY2VudCB1cGRhdGVzIChpbmNsdWRp
bmcgdGhlIG9wdGlvbiB0byBkZWxldGUgeW91ciB0d2VldHMpLjwvcD4iO3M6NDoiY29kZSI7
czo3Njg5MDoiZ2xvYmFsICRwcmVmcywkdHhwY2ZnLCRhcmNfdHdpdHRlcl9jb25zdW1lcktl
eSwkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgokYXJjX3R3aXR0ZXIgPSBhcnJheSgp
OwoKJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5ID0gJ25LY1hzbHd6WmhCZDBrZktNZXRuUEEn
OwokYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQgPSAnQzZuU1BDTDNlZUhHVEJoS0Nnd2Q5
b2NsY3VEMHNyQjhXVmtmWFFZQzU0JzsKCmFkZF9wcml2cygncGx1Z2luX3ByZWZzLmFyY190
d2l0dGVyJywnMSwyJyk7CnJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfdHdpdHRlcl9pbnN0YWxs
JywncGx1Z2luX2xpZmVjeWNsZS5hcmNfdHdpdHRlcicsICdpbnN0YWxsZWQnKTsKcmVnaXN0
ZXJfY2FsbGJhY2soJ2FyY190d2l0dGVyX3VuaW5zdGFsbCcsJ3BsdWdpbl9saWZlY3ljbGUu
YXJjX3R3aXR0ZXInLCAnZGVsZXRlZCcpOwpyZWdpc3Rlcl9jYWxsYmFjaygnYXJjX3R3aXR0
ZXJfcHJlZnMnLCdwbHVnaW5fcHJlZnMuYXJjX3R3aXR0ZXInKTsKCi8qCiAqIFNldHVwIGlu
aXRpYWwgcHJlZmVyZW5jZXMgaWYgbm90IGluIHRoZSB0eHBfcHJlZnMgdGFibGUuCiAqLwpp
ZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddKSkKICAgIHNldF9wcmVmKCdh
cmNfdHdpdHRlcl91c2VyJywgJycsICdhcmNfdHdpdHRlcicsIDEsICd0ZXh0X2lucHV0Jyk7
CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl9wcmVmaXgnXSkpCiAgc2V0X3ByZWYo
J2FyY190d2l0dGVyX3ByZWZpeCcsJ0p1c3QgcG9zdGVkOicsICdhcmNfdHdpdHRlcicsIDIs
ICd0ZXh0X2lucHV0Jyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl9zdWZmaXgn
XSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3N1ZmZpeCcsJycsICdhcmNfdHdpdHRlcics
IDIsICd0ZXh0X2lucHV0Jyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl9jYWNo
ZV9kaXInXSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX2NhY2hlX2RpcicsJHR4cGNmZ1sn
dHhwYXRoJ10uJHByZWZzWyd0ZW1wZGlyJ10sICdhcmNfdHdpdHRlcicsIDEsICd0ZXh0X2lu
cHV0Jyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0J10p
KQogIHNldF9wcmVmKCdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0JywgMSwgJ2FyY190d2l0
dGVyJywgMiwgJ3llc25vUmFkaW8nKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVy
X3VybF9tZXRob2QnXSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3VybF9tZXRob2QnLCAn
dGlueXVybCcsICdhcmNfdHdpdHRlcicsIDIsCiAgICAnYXJjX3R3aXR0ZXJfdXJsX21ldGhv
ZF9zZWxlY3QnKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY19zaG9ydF91cmwnXSkpCiAgc2V0
X3ByZWYoJ2FyY19zaG9ydF91cmwnLCAwLCAnYXJjX3R3aXR0ZXInLCAyLCAneWVzbm9SYWRp
bycpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3Nob3J0X3NpdGVfdXJsJ10pKQogIHNldF9w
cmVmKCdhcmNfc2hvcnRfc2l0ZV91cmwnLCAkcHJlZnNbJ3NpdGV1cmwnXSwgJ2FyY190d2l0
dGVyJywgMiwgJ3RleHRfaW5wdXQnKTsKLy8gTWFrZSBzdXJlIHRoYXQgdGhlIFR3aXR0ZXIg
dGFiIGhhcyBiZWVuIGRlZmluZWQKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX3Rh
YiddKSkgewogIHNldF9wcmVmKCdhcmNfdHdpdHRlcl90YWInLCAnZXh0ZW5zaW9ucycsICdh
cmNfdHdpdHRlcicsIDIsCiAgICAnYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCcpOwogICAgJHBy
ZWZzWydhcmNfdHdpdHRlcl90YWInXSA9ICdleHRlbnNpb25zJzsKfQoKLy8gQ2hlY2sgaWYg
YXJjX3Nob3J0X3VybCBpcyBlbmFibGVkCmlmICgoaXNzZXQoJHByZWZzWydhcmNfc2hvcnRf
dXJsJ10pJiYkcHJlZnNbJ2FyY19zaG9ydF91cmwnXSkKfHwgKGlzc2V0KCRwcmVmc1snYXJj
X3Nob3J0X3VybF9tZXRob2QnXSkmJiRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCdd
PT0nYXJjX3R3aXR0ZXInKSkgewogIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfc2hvcnRfdXJs
X3JlZGlyZWN0JywgJ3R4cF9kaWUnLCA0MDQpOwp9CgppZiAoQHR4cGludGVyZmFjZSA9PSAn
YWRtaW4nKSB7CiAgICByZWdpc3Rlcl9jYWxsYmFjaygnX2FyY190d2l0dGVyX2F1dG9fZW5h
YmxlJywgJ3BsdWdpbl9saWZlY3ljbGUuYXJjX3R3aXR0ZXInLCAnaW5zdGFsbGVkJyk7CiAg
ICBpZiAoIWVtcHR5KCRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddKQogICAgICAgICYmICFl
bXB0eSgkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10pCiAgICAgICAgJiYgIWVt
cHR5KCRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSkgKSB7CgogICAg
ICAgIGlmICgkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddKSB7CiAgICAgICAgICAgIGFkZF9w
cml2cygnYXJjX2FkbWluX3R3aXR0ZXInLCAnMSwyLDMsNCcpOwogICAgICAgICAgICByZWdp
c3Rlcl90YWIoJHByZWZzWydhcmNfdHdpdHRlcl90YWInXSwgJ2FyY19hZG1pbl90d2l0dGVy
JywgJ1R3aXR0ZXInKTsKICAgICAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hZG1p
bl90d2l0dGVyJywgJ2FyY19hZG1pbl90d2l0dGVyJyk7CiAgICAgICAgfQoKICAgICAgICBy
ZWdpc3Rlcl9jYWxsYmFjaygnYXJjX2FydGljbGVfdHdlZXQnLCAncGluZycpOwogICAgICAg
IHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYXJ0aWNsZV90d2VldCcsICdhcnRpY2xlX3NhdmVk
Jyk7CiAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hcnRpY2xlX3R3ZWV0JywgJ2Fy
dGljbGVfcG9zdGVkJyk7CiAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hcHBlbmRf
dHdpdHRlcicsICdhcnRpY2xlX3VpJywgJ3N0YXR1cycpOwogICAgfQp9CgovKgogICAgUHVi
bGljLXNpZGUgZnVuY3Rpb25zCiAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiovCgpmdW5jdGlvbiBhcmNfdHdp
dHRlcigkYXR0cykKewogIGdsb2JhbCAkcHJlZnMsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5
LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgogIGV4dHJhY3QobEF0dHMoYXJyYXko
CiAgICAndXNlcicgICAgICA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSwKICAgICdw
YXNzd29yZCcgID0+ICcnLAogICAgJ3RpbWVsaW5lJyAgPT4gJ3VzZXInLAogICAgJ2xpbWl0
JyAgICAgPT4gJzEwJywKICAgICdmZXRjaCcgICAgID0+IDAsCiAgICAncmV0d2VldHMnICA9
PiBmYWxzZSwKICAgICdyZXBsaWVzJyAgID0+IHRydWUsCiAgICAnZGF0ZWZvcm1hdCc9PiAk
cHJlZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCddLAogICAgJ2NhY2hpbmcnICAgPT4gJzEnLAog
ICAgJ2NhY2hlX2RpcicgPT4gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXSwKICAg
ICdjYWNoZV90aW1lJz0+ICc1JywKICAgICdsYWJlbCcgICAgID0+ICcnLAogICAgJ2xhYmVs
dGFnJyAgPT4gJycsCiAgICAnYnJlYWsnICAgICA9PiAnbGknLAogICAgJ3dyYXB0YWcnICAg
PT4gJycsCiAgICAnY2xhc3MnICAgICA9PiBfX0ZVTkNUSU9OX18sCiAgICAnY2xhc3NfcG9z
dGVkJyA9PiBfX0ZVTkNUSU9OX18uJy1wb3N0ZWQnCiAgICApLCRhdHRzKSk7CgogICR0d2l0
ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAg
ICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCwgJHByZWZzWydhcmNfdHdpdHRlcl9h
Y2Nlc3NUb2tlbiddCiAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NU
b2tlblNlY3JldCddKTsKCiAgaWYgKCRjYWNoaW5nKSB7ICAvLyB0dXJuIG9uIGNhY2hpbmcs
IHJlY29tbWVuZGVkIChkZWZhdWx0KQogICAgJHR3aXQtPnNldENhY2hpbmcodHJ1ZSk7CiAg
ICAkdHdpdC0+Y2FjaGVEaXIoJGNhY2hlX2Rpcik7CiAgICAkdHdpdC0+Y2FjaGVUaW1lKCRj
YWNoZV90aW1lKTsKICB9IGVsc2UgeyAgLy8gdHVybiBvZmYgY2FjaGluZywgbm90IHJlY29t
bWVuZGVkIG90aGVyIHRoYW4gZm9yIHRlc3RpbmcKICAgICR0d2l0LT5zZXRDYWNoaW5nKGZh
bHNlKTsKICB9CgogIHN3aXRjaCAoJHRpbWVsaW5lKSB7CiAgICBjYXNlICdob21lJzogY2Fz
ZSAnZnJpZW5kcyc6CiAgICAgICR0aW1lbGluZSA9ICdzdGF0dXNlcy9mcmllbmRzX3RpbWVs
aW5lJzsgYnJlYWs7CiAgICBjYXNlICdtZW50aW9ucyc6CiAgICAgICR0aW1lbGluZSA9ICdz
dGF0dXNlcy9tZW50aW9ucyc7IGJyZWFrOwogICAgY2FzZSAndXNlcic6IGRlZmF1bHQ6ICR0
aW1lbGluZSA9ICdzdGF0dXNlcy91c2VyX3RpbWVsaW5lJzsKICB9CgogIC8vIENoZWNrIHRo
YXQgdGhlIGZldGNoIChUd2l0dGVyJ3MgY291bnQgYXR0cmlidXRlKSBpcyBzZXQgY29ycmVj
dGx5CiAgJGZldGNoID0gKCEkZmV0Y2ggfHwgJGZldGNoPCRsaW1pdCkgPyAkbGltaXQgOiAk
ZmV0Y2g7CgogICRvdXQgPSBhcnJheSgpOwogICR4bWwgPSAkdHdpdC0+Z2V0KCR0aW1lbGlu
ZSwgYXJyYXkoCiAgICAgICdzY3JlZW5fbmFtZSc9PiR1c2VyLAogICAgICAnY291bnQnPT4k
ZmV0Y2gsCiAgICAgICdpbmNsdWRlX3J0cyc9PiRyZXR3ZWV0cywKICAgICAgJ2V4Y2x1ZGVf
cmVwbGllcyc9PiEkcmVwbGllcwogICAgKSk7CiAgaWYgKCR4bWwpIHsKICAgICR0d2VldHMg
PSBAJHhtbC0+eHBhdGgoJy9zdGF0dXNlcy9zdGF0dXMnKTsKICAgIGlmICgkdHdlZXRzKSB7
CiAgICAgIC8vIEFwcGx5IHRoZSBkaXNwbGF5IGxpbWl0IHRvIHRoZSByZXR1cm5lZCB0d2Vl
dHMKICAgICAgJHR3ZWV0cyA9IGFycmF5X3NsaWNlKCR0d2VldHMsIDAsICRsaW1pdCk7CiAg
ICAgIGZvcmVhY2ggKCR0d2VldHMgYXMgJHR3ZWV0KSB7CiAgICAgICAgJHRpbWUgPSBzdHJ0
b3RpbWUoaHRtbGVudGl0aWVzKCR0d2VldC0+Y3JlYXRlZF9hdCkpOwogICAgICAgICRkYXRl
ID0gc2FmZV9zdHJmdGltZSgkZGF0ZWZvcm1hdCwkdGltZSk7CiAgICAgICAgJG91dFtdID0g
YXJjX1R3aXR0ZXI6Om1ha2VMaW5rcyhodG1sZW50aXRpZXMoJHR3ZWV0LT50ZXh0LCBFTlRf
UVVPVEVTLCdVVEYtOCcpKQogICAgICAgICAgLicgJy50YWcoaHRtbGVudGl0aWVzKCRkYXRl
KSwnc3BhbicsJyBjbGFzcz0iJy4kY2xhc3NfcG9zdGVkLiciJyk7CiAgICAgIH0KICAgIH0K
CiAgICByZXR1cm4gZG9MYWJlbCgkbGFiZWwsICRsYWJlbHRhZykuZG9XcmFwKCRvdXQsICR3
cmFwdGFnLCAkYnJlYWssICRjbGFzcyk7CiAgfQoKfQoKZnVuY3Rpb24gYXJjX3R3aXR0ZXJf
c2VhcmNoKCRhdHRzKQp7CiAgICBnbG9iYWwgJHByZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1l
cktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgIGV4dHJhY3QobEF0dHMo
YXJyYXkoCiAgICAgICAgJ3VzZXInICAgICAgPT4gJHByZWZzWydhcmNfdHdpdHRlcl91c2Vy
J10sCiAgICAgICAgJ3NlYXJjaCcgICAgPT4gJycsCiAgICAgICAgJ2hhc2h0YWdzJyAgPT4g
JycsCiAgICAgICAgJ3VzZXInICAgICAgPT4gJycsCiAgICAgICAgJ3JlcGx5JyAgICAgPT4g
JycsCiAgICAgICAgJ21lbnRpb24nICAgPT4gJycsCiAgICAgICAgJ2xpbWl0JyAgICAgPT4g
JzEwJywKICAgICAgICAnbGFuZycgICAgICA9PiAnJywKICAgICAgICAnZGF0ZWZvcm1hdCc9
PiAkcHJlZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCddLAogICAgICAgICdjYWNoaW5nJyAgID0+
ICcxJywKICAgICAgICAnY2FjaGVfZGlyJyA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX2NhY2hl
X2RpciddLAogICAgICAgICdjYWNoZV90aW1lJz0+ICc1JywKICAgICAgICAnbGFiZWwnICAg
ICA9PiAnJywKICAgICAgICAnbGFiZWx0YWcnICA9PiAnJywKICAgICAgICAnYnJlYWsnICAg
ICA9PiAnbGknLAogICAgICAgICd3cmFwdGFnJyAgID0+ICcnLAogICAgICAgICdjbGFzcycg
ICAgID0+IF9fRlVOQ1RJT05fXywKICAgICAgICAnY2xhc3NfcG9zdGVkJyA9PiBfX0ZVTkNU
SU9OX18uJy1wb3N0ZWQnLAogICAgICAgICdjbGFzc191c2VyJyAgID0+IF9fRlVOQ1RJT05f
Xy4nLXVzZXInCiAgICApLCRhdHRzKSk7CgogICAgICAgICR0d2l0ID0gbmV3IGFyY19Ud2l0
dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAsICRhcmNfdHdpdHRl
cl9jb25zdW1lclNlY3JldCk7CgogICAgICAgIGlmICgkY2FjaGluZykgeyAgLy8gdHVybiBv
biBjYWNoaW5nLCByZWNvbW1lbmRlZCAoZGVmYXVsdCkKICAgICAgICAgICAgJHR3aXQtPnNl
dENhY2hpbmcodHJ1ZSk7CiAgICAgICAgICAgICR0d2l0LT5jYWNoZURpcigkY2FjaGVfZGly
KTsKICAgICAgICAgICAgJHR3aXQtPmNhY2hlVGltZSgkY2FjaGVfdGltZSk7CiAgICAgICAg
fSBlbHNlIHsgIC8vIHR1cm4gb2ZmIGNhY2hpbmcsIG5vdCByZWNvbW1lbmRlZCBvdGhlciB0
aGFuIGZvciB0ZXN0aW5nCiAgICAgICAgICAgICR0d2l0LT5zZXRDYWNoaW5nKGZhbHNlKTsK
ICAgICAgICB9CgogICAgICAgIC8vIGNvbnN0cnVjdCBzZWFyY2ggcXVlcnkKICAgICAgICBp
ZiAoIWVtcHR5KCRzZWFyY2gpKSB7CiAgICAgICAgICAgICR0ZXJtcyA9IGV4cGxvZGUoJywn
LCRzZWFyY2gpOyAkdGVybXMgPSBhcnJheV9tYXAoJ3RyaW0nLCR0ZXJtcyk7CiAgICAgICAg
ICAgICRzZWFyY2ggPSBpbXBsb2RlKCcgJywkdGVybXMpOwogICAgICAgIH0KICAgICAgICBp
ZiAoJGhhc2h0YWdzKSB7CiAgICAgICAgICAgICRoYXNoZXMgPSBleHBsb2RlKCcsJywkaGFz
aHRhZ3MpOyAkaGFzaGVzID0gYXJyYXlfbWFwKCd0cmltJywkaGFzaGVzKTsKICAgICAgICAg
ICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/JyAnOicnKS4nIycuaW1wbG9kZSgnICMnLCRoYXNo
ZXMpOwogICAgICAgIH0KICAgICAgICBpZiAoJHJlcGx5KSB7CiAgICAgICAgICAgICRzZWFy
Y2guPSAoKCRzZWFyY2gpPycgJzonJykuJ3RvOicudHJpbSgkcmVwbHkpOwogICAgICAgIH0K
ICAgICAgICBpZiAoJHVzZXIpIHsKICAgICAgICAgICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/
JyAnOicnKS4nZnJvbTonLnRyaW0oJHVzZXIpOwogICAgICAgIH0KICAgICAgICBpZiAoJG1l
bnRpb24pIHsKICAgICAgICAgICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/JyAnOicnKS4nQCcu
dHJpbSgkbWVudGlvbik7CiAgICAgICAgfQoKICAgICAgICBpZiAoZW1wdHkoJHNlYXJjaCkp
IHsKICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg
ICRzZWFyY2ggPSB1cmxlbmNvZGUoJHNlYXJjaCk7CiAgICAgICAgfQoKICAgICAgICAkb3V0
ID0gYXJyYXkoKTsKICAgICAgICAkdHdlZXRzID0gJHR3aXQtPmdldCgnaHR0cDovL3NlYXJj
aC50d2l0dGVyLmNvbS9zZWFyY2guYXRvbT9xPScuJHNlYXJjaAogICAgICAgICAgICAsIGFy
cmF5KCdycHAnPT4kbGltaXQsJ2xhbmcnPT4kbGFuZykpOwoKICAgICAgICBpZiAoJHR3ZWV0
cykgeyBmb3JlYWNoICgkdHdlZXRzLT5lbnRyeSBhcyAkdHdlZXQpIHsKICAgICAgICAgICAg
cHJlZ19tYXRjaCgiLyguKikgXCgoLiopXCkvIiwkdHdlZXQtPmF1dGhvci0+bmFtZSwkbWF0
Y2hlcyk7CiAgICAgICAgICAgIGxpc3QoJGF1dGhvciwkdW5hbWUsJG5hbWUpID0gJG1hdGNo
ZXM7CiAgICAgICAgICAgICR0aW1lID0gc3RydG90aW1lKGh0bWxlbnRpdGllcygkdHdlZXQt
PnB1Ymxpc2hlZCkpOwogICAgICAgICAgICAkZGF0ZSA9IHNhZmVfc3RyZnRpbWUoJGRhdGVm
b3JtYXQsJHRpbWUpOwogICAgICAgICAgICAkdGV4dCA9ICR0d2VldC0+dGl0bGU7CiAgICAg
ICAgICAgICRvdXRbXSA9IHRhZyhocmVmKGh0bWxlbnRpdGllcygkdW5hbWUpLCR0d2VldC0+
YXV0aG9yLT51cmksCiAgICAgICAgICAgICAgICAnIHRpdGxlPSInLmh0bWxlbnRpdGllcygk
bmFtZSkuJyInKS4nOiAnLCdzcGFuJwogICAgICAgICAgICAgICAgICAgICwnIGNsYXNzPSIn
LiRjbGFzc191c2VyLiciJykKICAgICAgICAgICAgICAgIC5hcmNfVHdpdHRlcjo6bWFrZUxp
bmtzKGh0bWxlbnRpdGllcygkdGV4dCwgRU5UX1FVT1RFUywnVVRGLTgnKSkKICAgICAgICAg
ICAgICAgIC4nICcudGFnKGh0bWxlbnRpdGllcygkZGF0ZSksJ3NwYW4nCiAgICAgICAgICAg
ICAgICAgICAgLCcgY2xhc3M9IicuJGNsYXNzX3Bvc3RlZC4nIicpOwogICAgICAgIH0gcmV0
dXJuIGRvTGFiZWwoJGxhYmVsLCAkbGFiZWx0YWcpCiAgICAgICAgICAgIC5kb1dyYXAoJG91
dCwgJHdyYXB0YWcsICRicmVhaywgJGNsYXNzKTsgfQoKfQoKZnVuY3Rpb24gYXJjX3R3aXR0
ZXJfdHdlZXQoJGF0dHMpIHsKICAgIGdsb2JhbCAkdGhpc2FydGljbGU7CgogICAgZXh0cmFj
dChsQXR0cyhhcnJheSgKICAgICAgJ2lkJyAgICAgICAgPT4gJHRoaXNhcnRpY2xlWyd0aGlz
aWQnXSwKICAgICAgJ2luY2x1ZGVfdXJsJyAgID0+IHRydWUKICAgICksJGF0dHMpKTsKCiAg
ICBpZiAoJGlkKSB7CiAgICAgIC8vIEZldGNoIGFyY190d2l0dGVyIHN0dWZmIHRvIGJ1aWxk
IHR3ZWV0IGZyb20KICAgICAgJHR3ZWV0ID0gKCRpbmNsdWRlX3VybCkgPyBzYWZlX3Jvdygi
dHdlZXQiLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlkfSIpCiAgICAgICAgOiBz
YWZlX3JvdygiUkVQTEFDRSh0d2VldCxDT05DQVQoJyAnLHRpbnl1cmwpLCcnKSBBUyB0d2Vl
dCIKICAgICAgICAgICwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKTsKICAg
IH0KCiAgICBpZiAoJHR3ZWV0Wyd0d2VldCddKSB7CiAgICAgIHJldHVybiBhcmNfVHdpdHRl
cjo6bWFrZUxpbmtzKAogICAgICAgIGh0bWxlbnRpdGllcygkdHdlZXRbJ3R3ZWV0J10sIEVO
VF9RVU9URVMsJ1VURi04JykpOwogICAgfQp9CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl90d2Vl
dF91cmwoJGF0dHMsICR0aGluZz1udWxsKSB7CiAgICBnbG9iYWwgJHRoaXNhcnRpY2xlLCRw
cmVmczsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAnaWQnICAgICAgPT4gJHRo
aXNhcnRpY2xlWyd0aGlzaWQnXSwKICAgICAgJ3RpdGxlJyAgID0+ICcnLAogICAgICAnY2xh
c3MnICAgPT4gJycKICAgICksJGF0dHMpKTsKCiAgICBpZiAoJGlkKSB7CiAgICAgIC8vIEZl
dGNoIGFyY190d2l0dGVyIHN0dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAgICAgJHR3ZWV0
ID0gc2FmZV9yb3coInR3ZWV0X2lkIgogICAgICAgICwgJ2FyY190d2l0dGVyJywgImFydGlj
bGVfaWQ9eyRpZH0iKTsKICAgIH0KCiAgICBpZiAoJHR3ZWV0Wyd0d2VldF9pZCddKSB7CiAg
ICAgICR1cmwgPSAiaHR0cDovL3R3aXR0ZXIuY29tLyIuJHByZWZzWydhcmNfdHdpdHRlcl91
c2VyJ10uIi9zdGF0dXMvIi4kdHdlZXRbJ3R3ZWV0X2lkJ107CiAgICAgIGlmICgkdGhpbmc9
PT1udWxsKSB7CiAgICAgICAgcmV0dXJuICR1cmw7CiAgICAgIH0KICAgICAgcmV0dXJuIGhy
ZWYocGFyc2UoJHRoaW5nKSwgJHVybCwKICAgICAgICAoJHRpdGxlID8gJyB0aXRsZT0iJy4k
dGl0bGUuJyInIDogJycpCiAgICAgICAgLigkY2xhc3MgPyAnIGNsYXNzPSInLiRjbGFzcy4n
IicgOiAnJykpOwogICAgfQp9CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl90aW55dXJsKCRhdHRz
LCAkdGhpbmc9bnVsbCkgewogICAgZ2xvYmFsICR0aGlzYXJ0aWNsZTsKCiAgICBleHRyYWN0
KGxBdHRzKGFycmF5KAogICAgICAnaWQnICAgICAgPT4gJHRoaXNhcnRpY2xlWyd0aGlzaWQn
XSwKICAgICAgJ3RpdGxlJyAgID0+ICcnLAogICAgICAnY2xhc3MnICAgPT4gJycKICAgICks
JGF0dHMpKTsKCiAgICBpZiAoJGlkKSB7CiAgICAgIC8vIEZldGNoIGFyY190d2l0dGVyIHN0
dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAgICAgJHR3ZWV0ID0gc2FmZV9yb3coInRpbnl1
cmwiCiAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlkfSIpOwogICAg
fQoKICAgIGlmICgkdHdlZXRbJ3Rpbnl1cmwnXSkgewogICAgICBpZiAoJHRoaW5nPT09bnVs
bCkgewogICAgICAgIHJldHVybiAkdHdlZXRbJ3Rpbnl1cmwnXTsKICAgICAgfQoKICAgICAg
cmV0dXJuIGhyZWYocGFyc2UoJHRoaW5nKSwgJHR3ZWV0Wyd0aW55dXJsJ10sCiAgICAgICAg
KCR0aXRsZSA/ICcgdGl0bGU9IicuJHRpdGxlLiciJyA6ICcnKQogICAgICAgIC4oJGNsYXNz
ID8gJyBjbGFzcz0iJy4kY2xhc3MuJyInIDogJycpKTsKICAgIH0KfQoKLyoKICogUHVibGlj
IHRhZyBmb3Igb3V0cHV0dGluZyB3aWRnZXQgSlMKICovCmZ1bmN0aW9uIGFyY190d2l0dGVy
X3dpZGdldF9qcygkYXR0cykKewogIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICAgJ29w
dGltaXNlJyA9PiBmYWxzZQogICAgKSwkYXR0cykpOwoKICByZXR1cm4gX2FyY190d2l0dGVy
X3dpZGdldF9qcygkb3B0aW1pc2UpOwp9CgpmdW5jdGlvbiBfYXJjX3R3aXR0ZXJfd2lkZ2V0
X2pzKCRvcHRpbWlzZT10cnVlKQp7CiAgZ2xvYmFsICRhcmNfdHdpdHRlcjsKCiAgLy8gQ2hl
Y2sgaWYgd2lkZ2V0IEpTIGhhcyBhbHJlYWR5IGJlZW4gb3V0cHV0CiAgaWYgKCRhcmNfdHdp
dHRlclsnd2lkZ2V0X2pzJ10pIHJldHVybjsKCiAgaWYgKCRvcHRpbWlzZT09ZmFsc2UpIHsK
ICAgIHJldHVybiAnPHNjcmlwdCBzcmM9Imh0dHA6Ly9wbGF0Zm9ybS50d2l0dGVyLmNvbS93
aWRnZXRzLmpzIiB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPjwvc2NyaXB0Pic7CiAgfQoKICAk
anMgPSA8PDxKUwo8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+CihmdW5jdGlvbigp
IHsKICBpZiAod2luZG93Ll9fdHdpdHRlckludGVudEhhbmRsZXIpIHJldHVybjsKICB2YXIg
aW50ZW50UmVnZXggPSAvdHdpdHRlclwuY29tKFw6XGR7Miw0fSk/XC9pbnRlbnRcLyhcdysp
LywKICAgICAgd2luZG93T3B0aW9ucyA9ICdzY3JvbGxiYXJzPXllcyxyZXNpemFibGU9eWVz
LHRvb2xiYXI9bm8sbG9jYXRpb249eWVzJywKICAgICAgd2lkdGggPSA1NTAsCiAgICAgIGhl
aWdodCA9IDQyMCwKICAgICAgd2luSGVpZ2h0ID0gc2NyZWVuLmhlaWdodCwKICAgICAgd2lu
V2lkdGggPSBzY3JlZW4ud2lkdGg7CgogIGZ1bmN0aW9uIGhhbmRsZUludGVudChlKSB7CiAg
ICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7CiAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQgfHwg
ZS5zcmNFbGVtZW50LAogICAgICAgIG0sIGxlZnQsIHRvcDsKCiAgICB3aGlsZSAodGFyZ2V0
ICYmIHRhcmdldC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpICE9PSAnYScpIHsKICAgICAgdGFy
Z2V0ID0gdGFyZ2V0LnBhcmVudE5vZGU7CiAgICB9CgogICAgaWYgKHRhcmdldCAmJiB0YXJn
ZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2EnICYmIHRhcmdldC5ocmVmKSB7CiAg
ICAgIG0gPSB0YXJnZXQuaHJlZi5tYXRjaChpbnRlbnRSZWdleCk7CiAgICAgIGlmIChtKSB7
CiAgICAgICAgbGVmdCA9IE1hdGgucm91bmQoKHdpbldpZHRoIC8gMikgLSAod2lkdGggLyAy
KSk7CiAgICAgICAgdG9wID0gMDsKCiAgICAgICAgaWYgKHdpbkhlaWdodCA+IGhlaWdodCkg
ewogICAgICAgICAgdG9wID0gTWF0aC5yb3VuZCgod2luSGVpZ2h0IC8gMikgLSAoaGVpZ2h0
IC8gMikpOwogICAgICAgIH0KCiAgICAgICAgd2luZG93Lm9wZW4odGFyZ2V0LmhyZWYsICdp
bnRlbnQnLCB3aW5kb3dPcHRpb25zICsgJyx3aWR0aD0nICsgd2lkdGggKwogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyxoZWlnaHQ9JyArIGhlaWdodCAr
ICcsbGVmdD0nICsgbGVmdCArICcsdG9wPScgKyB0b3ApOwogICAgICAgIGUucmV0dXJuVmFs
dWUgPSBmYWxzZTsKICAgICAgICBlLnByZXZlbnREZWZhdWx0ICYmIGUucHJldmVudERlZmF1
bHQoKTsKICAgICAgfQogICAgfQogIH0KCiAgaWYgKGRvY3VtZW50LmFkZEV2ZW50TGlzdGVu
ZXIpIHsKICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlSW50
ZW50LCBmYWxzZSk7CiAgfSBlbHNlIGlmIChkb2N1bWVudC5hdHRhY2hFdmVudCkgewogICAg
ZG9jdW1lbnQuYXR0YWNoRXZlbnQoJ29uY2xpY2snLCBoYW5kbGVJbnRlbnQpOwogIH0KICB3
aW5kb3cuX190d2l0dGVySW50ZW50SGFuZGxlciA9IHRydWU7Cn0oKSk7Cjwvc2NyaXB0PgpK
UzsKICAkYXJjX3R3aXR0ZXJbJ3dpZGdldF9qcyddID0gdHJ1ZTsKICByZXR1cm4gJGpzOwp9
CgovLyBEZXByZWNhdGVkIGFyY190d2l0dGVyX3JldHdlZXQgdGFnLCB1c2UgYXJjX3R3aXR0
ZXJfdHdlZXRfYnV0dG9uIGluc3RlYWQKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfcmV0d2VldCgk
YXR0cywgJHRoaW5nPW51bGwpCnsKICByZXR1cm4gYXJjX3R3aXR0ZXJfdHdlZXRfYnV0dG9u
KCRhdHRzLCAkdGhpbmc9bnVsbCk7Cn0KZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdHdlZXRfYnV0
dG9uKCRhdHRzLCAkdGhpbmc9bnVsbCkKewogICAgZ2xvYmFsICRwcmVmcywkYXJjX3R3aXR0
ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKICAgIGdsb2Jh
bCAkdGhpc2FydGljbGU7CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgICAndXNl
cicgICAgICAgID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLCAvLyB2aWEgdXNlciBh
Y2NvdW50CiAgICAgICAgJ3VybCcgICAgICAgICA9PiAnJywKICAgICAgICAndGV4dCcgICAg
ICAgID0+ICcnLAogICAgICAgICdmb2xsb3cxJyAgICAgPT4gJycsCiAgICAgICAgJ2ZvbGxv
dzInICAgICA9PiAnJywKICAgICAgICAnbGFuZycgICAgICAgID0+ICcnLAogICAgICAgICdj
b3VudCcgICAgICAgPT4gJ2hvcml6b250YWwnLAogICAgICAgICdpbmNsdWRlX2pzJyAgPT4g
dHJ1ZSwKICAgICAgICAnb3B0aW1pc2VfanMnID0+IGZhbHNlLAogICAgICAgICd3cmFwdGFn
JyAgICAgPT4gJycsCiAgICAgICAgJ2NsYXNzJyAgICAgICA9PiAndHdpdHRlci1zaGFyZS1i
dXR0b24nCiAgICApLCRhdHRzKSk7CgogICAgJHEgPSAnJzsgLy8gcXVlcnkgc3RyaW5nCgog
ICAgaWYgKCRpZD0kdGhpc2FydGljbGVbJ3RoaXNpZCddKSB7CiAgICAgIC8vIEZldGNoIGFy
Y190d2l0dGVyIHN0dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAgICAgJHJvdyA9IHNhZmVf
cm93KCJSRVBMQUNFKHR3ZWV0LENPTkNBVCgnICcsdGlueXVybCksJycpIEFTIHR3ZWV0LHRp
bnl1cmwiCiAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlkfSIpOwoK
ICAgICAgaWYgKCR1cmw9PScnKSB7CiAgICAgICAgJHVybCA9ICgkdXJsKSA/ICR1cmwgOiBw
ZXJtbGlua3VybCgkdGhpc2FydGljbGUpOwogICAgICAgICRxID0gJ3VybD0nLnVybGVuY29k
ZSgkdXJsKTsKICAgICAgfQogICAgICBpZiAoJHRleHQ9PScnKSB7CiAgICAgICAgJHRleHQg
PSAoJHJvd1sndHdlZXQnXSkgPyAkcm93Wyd0d2VldCddIDogJHRoaXNhcnRpY2xlWyd0aXRs
ZSddOwogICAgICB9CiAgICAgICRxIC49ICgkcSA/ICcmYW1wOycgOiAnJykuJ3RleHQ9Jy51
cmxlbmNvZGUoJHRleHQpOwogICAgfQogICAgaWYgKCR1c2VyKSB7CiAgICAgICRxIC49ICgk
cSA/ICcmYW1wOycgOiAnJykuJ3ZpYT0nLnVybGVuY29kZSgkdXNlcik7CiAgICB9CiAgICBp
ZiAoJGZvbGxvdzEmJiRmb2xsb3cyKSB7CiAgICAgICRxIC49ICgkcSA/ICcmYW1wOycgOiAn
JykuJ3JlbGF0ZWQ9Jy51cmxlbmNvZGUoJGZvbGxvdzEuJzonLiRmb2xsb3cyKTsKICAgIH0g
ZWxzZWlmICgkZm9sbG93MXx8JGZvbGxvdzIpIHsKICAgICAgJHEgLj0gKCRxID8gJyZhbXA7
JyA6ICcnKS4ncmVsYXRlZD0nLnVybGVuY29kZSgkZm9sbG93MS4kZm9sbG93Mik7CiAgICB9
CgogICAgc3dpdGNoICgkbGFuZykgewogICAgICBjYXNlICdmcic6IGJyZWFrOyBjYXNlICdk
ZSc6IGJyZWFrOyBjYXNlICdlcyc6IGJyZWFrOyBjYXNlICdqcCc6IGJyZWFrOwogICAgICBk
ZWZhdWx0OgogICAgICAgICRsYW5nID0gJ2VuJzsKICAgIH0KICAgICRxIC49ICgkcSA/ICcm
YW1wOycgOiAnJykuJ2xhbmc9Jy51cmxlbmNvZGUoJGxhbmcpOwoKICAgIHN3aXRjaCAoJGNv
dW50KSB7CiAgICAgIGNhc2UgJ25vbmUnOiBicmVhazsgY2FzZSAndmVydGljYWwnOiBicmVh
azsKICAgICAgZGVmYXVsdDoKICAgICAgICAkY291bnQgPSAnaG9yaXpvbnRhbCc7CiAgICB9
CiAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidjb3VudD0nLnVybGVuY29kZSgkY291
bnQpOwoKICAgICR0aGluZyA9ICgkdGhpbmc9PT1udWxsKSA/ICdUd2VldCcgOiBwYXJzZSgk
dGhpbmcpOwoKICAgICRodG1sID0gaHJlZigkdGhpbmcsJ2h0dHA6Ly90d2l0dGVyLmNvbS9z
aGFyZT8nLiRxCiAgICAgICwgJyBjbGFzcz0iJy4kY2xhc3MuJyInKTsKCiAgICAkanMgPSAo
JGluY2x1ZGVfanMpID8gX2FyY190d2l0dGVyX3dpZGdldF9qcygkb3B0aW1pc2VfanM/dHJ1
ZTpmYWxzZSkgOiAnJzsKCiAgICByZXR1cm4gJGpzLiRodG1sOwp9CgovKgogKiBUd2l0dGVy
IEZvbGxvdyBidXR0b24KICovCmZ1bmN0aW9uIGFyY190d2l0dGVyX2ZvbGxvd19idXR0b24o
JGF0dHMsICR0aGluZz1udWxsKQp7CiAgICBnbG9iYWwgJHByZWZzLCRhcmNfdHdpdHRlcl9j
b25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwogICAgZ2xvYmFsICR0
aGlzYXJ0aWNsZTsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAgICd1c2VyJyAg
ICAgICAgPT4gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sIC8vIHZpYSB1c2VyIGFjY291
bnQKICAgICAgICAnbGFuZycgICAgICAgID0+ICcnLAogICAgICAgICdjb3VudCcgICAgICAg
PT4gdHJ1ZSwKICAgICAgICAnaW5jbHVkZV9qcycgID0+IHRydWUsCiAgICAgICAgJ29wdGlt
aXNlX2pzJyA9PiBmYWxzZSwKICAgICAgICAnY2xhc3MnICAgICAgID0+ICd0d2l0dGVyLWZv
bGxvdy1idXR0b24nCiAgICApLCRhdHRzKSk7CgogICAgJGF0dHMgPSAnJzsgLy8gZGF0YSBh
dHRyaWJ1dGVzCgogICAgc3dpdGNoICgkbGFuZykgewogICAgICBjYXNlICdmcic6IGJyZWFr
OyBjYXNlICdkZSc6IGJyZWFrOyBjYXNlICdlcyc6IGJyZWFrOyBjYXNlICdqcCc6IGJyZWFr
OwogICAgICBkZWZhdWx0OgogICAgICAgICRsYW5nID0gJ2VuJzsKICAgIH0KICAgICRhdHRz
IC49ICcgZGF0YS1sYW5nPSInLnVybGVuY29kZSgkbGFuZykuJyInOwoKICAgICRhdHRzIC49
ICcgZGF0YS1zaG93LWNvdW50PSInLigkY291bnQ/J3RydWUnOidmYWxzZScpLiciJzsKCiAg
ICAkdGhpbmcgPSAoJHRoaW5nPT09bnVsbCkgPyAnRm9sbG93IEAnLiR1c2VyIDogcGFyc2Uo
JHRoaW5nKTsKCiAgICAkaHRtbCA9IGhyZWYoJHRoaW5nLCdodHRwOi8vdHdpdHRlci5jb20v
Jy51cmxlbmNvZGUoJHVzZXIpCiAgICAgICwgJyBjbGFzcz0iJy4kY2xhc3MuJyInLiRhdHRz
KTsKCiAgICAkanMgPSAoJGluY2x1ZGVfanMpID8gX2FyY190d2l0dGVyX3dpZGdldF9qcygk
b3B0aW1pc2VfanM/dHJ1ZTpmYWxzZSkgOiAnJzsKCiAgICByZXR1cm4gJGpzLiRodG1sOwp9
CgovKgogICAgQWRtaW4tc2lkZSBmdW5jdGlvbnMKICAgID09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KKi8KCi8vIElu
c3RhbGxhdGlvbiBmdW5jdGlvbiAtIGJ1aWxkcyBNeVNRTCB0YWJsZQpmdW5jdGlvbiBhcmNf
dHdpdHRlcl9pbnN0YWxsKCkKewoKICAgIC8vIEZvciBmaXJzdCBpbnN0YWxsLCBjcmVhdGUg
dGFibGUgZm9yIHR3ZWV0cwogICAgJHNxbCA9ICJDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNU
UyAiLlBGWC4iYXJjX3R3aXR0ZXIgIjsKICAgICRzcWwuPSAiKGFyY190d2l0dGVyaWQgSU5U
RUdFUiBBVVRPX0lOQ1JFTUVOVCBQUklNQVJZIEtFWSwKICAgICAgICBhcnRpY2xlX2lkIElO
VEVHRVIoMTEpLAogICAgICAgIHR3ZWV0X2lkIEJJR0lOVCgyMCksCiAgICAgICAgdHdlZXQg
VkFSQ0hBUigxNDApLAogICAgICAgIHRpbnl1cmwgVkFSQ0hBUigzMCkpOyI7CgogICAgaWYg
KCFzYWZlX3F1ZXJ5KCRzcWwpKSB7CiAgICAgICAgcmV0dXJuICdFcnJvciAtIHVuYWJsZSB0
byBjcmVhdGUgYXJjX3R3aXR0ZXIgdGFibGUnOwogICAgfQoKfQoKLy8gVW5pbnN0YWxsIGZ1
bmN0aW9uIC0gZGVsZXRlcyBNeVNRTCB0YWJsZSBhbmQgcmVsYXRlZCBwcmVmZXJlbmNlcwpm
dW5jdGlvbiBhcmNfdHdpdHRlcl91bmluc3RhbGwoKQp7CgogICAgJHNxbCA9ICJEUk9QIFRB
QkxFIElGIEVYSVNUUyAiLlBGWC4iYXJjX3R3aXR0ZXI7IjsKICAgIGlmICghc2FmZV9xdWVy
eSgkc3FsKSkgewogICAgICAgIHJldHVybiAnRXJyb3IgLSB1bmFibGUgdG8gZGVsZXRlIGFy
Y190d2l0dGVyIHRhYmxlJzsKICAgIH0KCiAgICAkc3FsID0gIkRFTEVURSBGUk9NICAiLlBG
WC4idHhwX3ByZWZzIFdIRVJFIGV2ZW50PSdhcmNfdHdpdHRlcic7IjsKICAgIGlmICghc2Fm
ZV9xdWVyeSgkc3FsKSkgewogICAgICAgIHJldHVybiAnRXJyb3IgLSB1bmFibGUgdG8gZGVs
ZXRlIGFyY190d2l0dGVyIHByZWZlcmVuY2VzJzsKICAgIH0KCn0KZnVuY3Rpb24gYXJjX3R3
aXR0ZXJfdXJsX21ldGhvZF9zZWxlY3QoJG5hbWUsICR2YWwpCnsKICAgICRtZXRob2RzID0g
YXJyYXkoJ3Rpbnl1cmwnID0+ICdUaW55dXJsJywKICAgICAgJ2lzZ2QnID0+ICdJcy5nZCcs
CiAgICAgICdhcmNfdHdpdHRlcicgPT4gJ1RYUCBUd2VldCcsCiAgICAgICdzbWQnID0+ICdz
bWRfc2hvcnRfdXJsJyk7CiAgICByZXR1cm4gc2VsZWN0SW5wdXQoJG5hbWUsICRtZXRob2Rz
LCAkdmFsKTsKfQpmdW5jdGlvbiBhcmNfdHdpdHRlcl90YWJfc2VsZWN0KCRuYW1lLCAkdmFs
KQp7CiAgICAkdGFicyA9IGFycmF5KCdjb250ZW50JyA9PiAnQ29udGVudCcsCiAgICAgICAg
J2V4dGVuc2lvbnMnID0+ICdFeHRlbnNpb25zJywKICAgICAgICAnJyA9PiAnSGlkZGVuJyk7
CiAgICByZXR1cm4gc2VsZWN0SW5wdXQoJG5hbWUsICR0YWJzLCAkdmFsKTsKfQovLyBQcm92
aWRlIGludGVyZmFjZSBmb3Igc2V0dGluZyBwcmVmZXJlbmNlcwpmdW5jdGlvbiBhcmNfdHdp
dHRlcl9wcmVmcygkZXZlbnQsJHN0ZXApCnsKCiAgICBnbG9iYWwgJHByZWZzLCRhcmNfdHdp
dHRlcl9jb25zdW1lcktleSwkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgogICAgJHVz
ZXIgICAgICAgICAgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXTsKICAgICRwcmVmaXgg
ICAgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl9wcmVmaXgnXTsKICAgICRzdWZmaXggICAg
ICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl9zdWZmaXgnXTsKICAgICR0d2VldF9kZWZhdWx0
ID0gJHByZWZzWydhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0J107CiAgICAkdXJsX21ldGhv
ZCAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddOwogICAgJHNob3J0X3Vy
bCAgICAgPSAkcHJlZnNbJ2FyY19zaG9ydF91cmwnXTsKICAgICRzaG9ydF9zaXRlX3VybD0g
JHByZWZzWydhcmNfc2hvcnRfc2l0ZV91cmwnXTsKICAgICRjYWNoZV9kaXIgICAgID0gJHBy
ZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXTsKICAgICR0YWIgICAgICAgICAgID0gJHBy
ZWZzWydhcmNfdHdpdHRlcl90YWInXTsKCiAgICBzd2l0Y2ggKCRzdGVwKSB7CiAgICAgICAg
Y2FzZSAncHJlZnNfc2F2ZSc6IHBhZ2V0b3AoJ1RYUCBUd2VldCcsICdQcmVmZXJlbmNlcyBz
YXZlZCcpOyBicmVhazsKICAgICAgICBjYXNlICdyZWdpc3Rlcic6IHBhZ2V0b3AoJ1RYUCBU
d2VldCcsJ0Nvbm5lY3QgdG8gVHdpdHRlcicpOyBicmVhazsKICAgICAgICBjYXNlICd2YWxp
ZGF0ZSc6CiAgICAgICAgZGVmYXVsdDogcGFnZXRvcCgnVFhQIFR3ZWV0Jyk7CiAgICB9Cgog
ICAgJGh0bWwgPSAnJzsKCiAgICBpZiAoJHN0ZXA9PSdyZWdpc3RlcicpIHsgLy8gT0F1dGgg
cmVnaXN0cmF0aW9uIHByb2Nlc3MKICAgICAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigk
YXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29u
c3VtZXJTZWNyZXQpOwoKICAgICAgICAvLyBCdWlsZCBhIGNhbGxiYWNrIFVSTCBmb3IgVHdp
dHRlciB0byByZXR1cm4gdG8gdGhlIG5leHQgc3RhZ2UKICAgICAgICAkY2FsbGJhY2tVUkwg
PSAkdHdpdC0+Y2FsbGJhY2tVUkwoJGV2ZW50LCd2YWxpZGF0ZScpOwoKICAgICAgICAkcmVx
dWVzdCA9ICR0d2l0LT5nZXRSZXF1ZXN0VG9rZW4oJGNhbGxiYWNrVVJMKTsKICAgICAgICAk
cmVxdWVzdF90b2tlbiA9ICRyZXF1ZXN0WyJvYXV0aF90b2tlbiJdOwogICAgICAgICRyZXF1
ZXN0X3Rva2VuX3NlY3JldCA9ICRyZXF1ZXN0WyJvYXV0aF90b2tlbl9zZWNyZXQiXTsKCiAg
ICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3JlcXVlc3RUb2tlbicsJHJlcXVlc3RfdG9r
ZW4KICAgICAgICAgICAgLCAnYXJjX3R3aXR0ZXInLDIpOwogICAgICAgIHNldF9wcmVmKCdh
cmNfdHdpdHRlcl9yZXF1ZXN0VG9rZW5TZWNyZXQnLCRyZXF1ZXN0X3Rva2VuX3NlY3JldAog
ICAgICAgICAgICAsICdhcmNfdHdpdHRlcicsMik7CgogICAgICAgICRodG1sLj0gc3RhcnRU
YWJsZSgnZWRpdCcpLgogICAgICAgICAgICAgICAgdHIodGQoCiAgICAgICAgICAgICAgICAg
ICAgKCc8cD4nLmhyZWYoJ1NpZ24taW4gdG8gVHdpdHRlcicKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICwkdHdpdC0+Z2V0QXV0aG9yaXplVVJMKCRyZXF1ZXN0KSkKICAgICAgICAg
ICAgICAgICAgICAgICAgLicgYW5kIGZvbGxvdyB0aGUgaW5zdHJ1Y3Rpb25zIHRvIGFsbG93
IFRYUCBUd2VldCB0byB1c2UgeW91ciBhY2NvdW50LiBJZiB5b3UgYXJlIGFscmVhZHkgc2ln
bmVkIGluIHRvIFR3aXR0ZXIgdGhlbiB0aGF0IGFjY291bnQgd2lsbCBiZSBhc3NvY2lhdGVk
IHdpdGggVFhQIFR3ZWV0IHNvIHlvdSBtYXkgbmVlZCB0byBzaWduIG91dCBmaXJzdCBpZiB5
b3Ugd2FudCB0byB1c2UgYSBkaWZmZXJlbnQgYWNjb3VudC48L3A+JykKICAgICAgICAgICAg
ICAgICkpLmVuZFRhYmxlKCk7CiAgICB9IGVsc2VpZiAoJHN0ZXA9PSd2YWxpZGF0ZScpIHsK
ICAgICAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJL
ZXkKICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQsICRwcmVmc1sn
YXJjX3R3aXR0ZXJfcmVxdWVzdFRva2VuJ10KICAgICAgICAgICAgLCAkcHJlZnNbJ2FyY190
d2l0dGVyX3JlcXVlc3RUb2tlblNlY3JldCddKTsKICAgICAgICAvLyBBc2sgVHdpdHRlciBm
b3IgYW4gYWNjZXNzIHRva2VuIChhbmQgYW4gYWNjZXNzIHRva2VuIHNlY3JldCkKICAgICAg
ICAkcmVxdWVzdCA9ICR0d2l0LT5nZXRBY2Nlc3NUb2tlbiggZ3BzKCdvYXV0aF92ZXJpZmll
cicpICk7CiAgICAgICAgJGFjY2Vzc190b2tlbiA9ICRyZXF1ZXN0WydvYXV0aF90b2tlbidd
OwogICAgICAgICRhY2Nlc3NfdG9rZW5fc2VjcmV0ID0gJHJlcXVlc3RbJ29hdXRoX3Rva2Vu
X3NlY3JldCddOwogICAgICAgICR1c2VyID0gJHJlcXVlc3RbJ3NjcmVlbl9uYW1lJ107CiAg
ICAgICAgLy8gU3RvcmUgdGhlIGFjY2VzcyB0b2tlbiBhbmQgc2VjcmV0CiAgICAgICAgc2V0
X3ByZWYoJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJywkYWNjZXNzX3Rva2VuLCAnYXJjX3R3
aXR0ZXInLDIpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNl
Y3JldCcsJGFjY2Vzc190b2tlbl9zZWNyZXQKICAgICAgICAgICAgLCAnYXJjX3R3aXR0ZXIn
LDIpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl91c2VyJywkdXNlcik7CiAgICAg
ICAgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddID0gJGFjY2Vzc190b2tlbjsK
ICAgICAgICAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0J10gPSAkYWNj
ZXNzX3Rva2VuX3NlY3JldDsKICAgICAgICB1bnNldCgkdHdpdCk7CiAgICB9CgogICAgaWYg
KCRzdGVwPT0icHJlZnNfc2F2ZSIpIHsKICAgICAgICAkcHJlZml4ID0gdHJpbShncHMoJ2Fy
Y190d2l0dGVyX3ByZWZpeCcpKTsKICAgICAgICAkc3VmZml4ID0gdHJpbShncHMoJ2FyY190
d2l0dGVyX3N1ZmZpeCcpKTsKICAgICAgICAkdHdlZXRfZGVmYXVsdCA9IGdwcygnYXJjX3R3
aXR0ZXJfdHdlZXRfZGVmYXVsdCcpOwogICAgICAgICR1cmxfbWV0aG9kID0gZ3BzKCdhcmNf
dHdpdHRlcl91cmxfbWV0aG9kJyk7CiAgICAgICAgJHNob3J0X3VybCA9IGdwcygnYXJjX3No
b3J0X3VybCcpOwogICAgICAgICRzaG9ydF9zaXRlX3VybCA9IGdwcygnYXJjX3Nob3J0X3Np
dGVfdXJsJyk7CiAgICAgICAgJGNhY2hlX2RpciA9IGdwcygnYXJjX3R3aXR0ZXJfY2FjaGVf
ZGlyJyk7CiAgICAgICAgJHRhYiA9IGdwcygnYXJjX3R3aXR0ZXJfdGFiJyk7CiAgICAgICAg
aWYgKHN0cmxlbigkcHJlZml4KTw9MjApIHsKICAgICAgICAgICAgc2V0X3ByZWYoJ2FyY190
d2l0dGVyX3ByZWZpeCcsJHByZWZpeCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg
JHByZWZpeCA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfcHJlZml4J107CiAgICAgICAgfQogICAg
ICAgIGlmIChzdHJsZW4oJHN1ZmZpeCk8PTIwKSB7CiAgICAgICAgICAgIHNldF9wcmVmKCdh
cmNfdHdpdHRlcl9zdWZmaXgnLCRzdWZmaXgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAg
ICAgICRzdWZmaXggPSAkcHJlZnNbJ2FyY190d2l0dGVyX3N1ZmZpeCddOwogICAgICAgIH0K
ICAgICAgICAkdHdlZXRfZGVmYXVsdCA9ICgkdHdlZXRfZGVmYXVsdCkgPyAxIDogMDsKICAg
ICAgICAkc2hvcnRfdXJsID0gKCRzaG9ydF91cmwpID8gMSA6IDA7CiAgICAgICAgaWYgKCEk
c2hvcnRfc2l0ZV91cmwpICRzaG9ydF9zaXRlX3VybCA9ICRwcmVmc1snc2l0ZXVybCddOwog
ICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0JywkdHdlZXRfZGVm
YXVsdCk7CiAgICAgICAgc2V0X3ByZWYoJ2FyY19zaG9ydF91cmwnLCRzaG9ydF91cmwpOwog
ICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJywkdXJsX21ldGhvZCk7
CiAgICAgICAgc2V0X3ByZWYoJ2FyY19zaG9ydF9zaXRlX3VybCcsJHNob3J0X3NpdGVfdXJs
KTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJywkY2FjaGVfZGly
KTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdGFiJywkdGFiKTsKICAgIH0KCiAg
ICBpZiAoICRzdGVwIT0ncmVnaXN0ZXInICkgewogICAgICAgIGlmICggaXNzZXQoJHByZWZz
WydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddKQogICAgICAgICYmIGlzc2V0KCRwcmVmc1sn
YXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSkgKSB7CiAgICAgICAgICAgICR0d2l0
ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAg
ICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0
ZXJfYWNjZXNzVG9rZW4nXQogICAgICAgICAgICAgICAgLCAkcHJlZnNbJ2FyY190d2l0dGVy
X2FjY2Vzc1Rva2VuU2VjcmV0J10pOwogICAgICAgICAgICAkcmVnaXN0ZXJVUkwgPSAkdHdp
dC0+Y2FsbGJhY2tVUkwoJGV2ZW50LCdyZWdpc3RlcicpOwogICAgICAgICAgICAkaHRtbC49
IHN0YXJ0VGFibGUoJ2xpc3QnKS5mb3JtKAogICAgICAgICAgICAgICAgdHIoCiAgICAgICAg
ICAgICAgICAgICAgdGRjcyhoZWQoJ1R3aXR0ZXIgYWNjb3VudCBkZXRhaWxzJywgMiksMikK
ICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAg
ICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX3VzZXIiPlR3aXR0ZXIgdXNlcm5h
bWU8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxp
Z246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAg
ICAgIC50ZCgKICAgICAgICAgICAgICAgICAgICAgICAgKCRwcmVmc1snYXJjX3R3aXR0ZXJf
dXNlciddKSA/CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdXNlci4nICgnLmhyZWYo
J1JlLWNvbm5lY3QnLCRyZWdpc3RlclVSTCkuJyknCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICA6ICc8ZW0+dW5rbm93bjwvZW0+JwogICAgICAgICAgICAgICAgICAgICAgICAgICAg
LmhyZWYoJ0Nvbm5lY3QgdG8gVHdpdHRlcicsJHJlZ2lzdGVyVVJMKSkKICAgICAgICAgICAg
ICAgICkKICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhl
ZCgnVHdlZXQgc2V0dGluZ3MnLCAyKSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAg
ICAgICAgLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3
aXR0ZXJfcHJlZml4Ij5Ud2VldCBwcmVmaXg8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAg
ICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlk
ZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50ZChmSW5wdXQoJ3RleHQnLCdhcmNfdHdp
dHRlcl9wcmVmaXgnLCRwcmVmaXgsJycsJycsJycsJycsJycsJ2FyY190d2l0dGVyX3ByZWZp
eCcpKQogICAgICAgICAgICAgICAgKS50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxs
YWJlbCBmb3I9ImFyY190d2l0dGVyX3N1ZmZpeCI+VHdlZXQgc3VmZml4PC9sYWJlbD4nLAog
ICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVy
dGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoZklucHV0
KCd0ZXh0JywnYXJjX3R3aXR0ZXJfc3VmZml4Jywkc3VmZml4LCcnLCcnLCcnLCcnLCcnLCdh
cmNfdHdpdHRlcl9zdWZmaXgnKSkKICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAg
ICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0Ij5U
d2VldCBhcnRpY2xlcyBieSBkZWZhdWx0PC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAg
ICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRs
ZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoeWVzbm9SYWRpbygnYXJjX3R3aXR0ZXJf
dHdlZXRfZGVmYXVsdCcsICR0d2VldF9kZWZhdWx0LCAnJywgJ2FyY190d2l0dGVyX3R3ZWV0
X2RlZmF1bHQnKSkKICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAgICAgICAgICAg
dGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl91cmxfbWV0aG9kIj5VUkwgc2hvcnRuZXI8
L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246
IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAg
IC50ZChhcmNfdHdpdHRlcl91cmxfbWV0aG9kX3NlbGVjdCgnYXJjX3R3aXR0ZXJfdXJsX21l
dGhvZCcsJHVybF9tZXRob2QpKQogICAgICAgICAgICAgICAgKS50cigKICAgICAgICAgICAg
ICAgICAgICB0ZGNzKGhlZCgnVFhQIFR3ZWV0IHNob3J0IFVSTCcsIDIpLDIpCiAgICAgICAg
ICAgICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAgICAgICAgdGRh
KCc8bGFiZWwgZm9yPSJhcmNfc2hvcnRfdXJsIj5FbmFibGUgVFhQIFR3ZWV0IHNob3J0IFVS
TCByZWRpcmVjdDwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0i
dGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAg
ICAgICAgICAgICAgLnRkKHllc25vUmFkaW8oJ2FyY19zaG9ydF91cmwnLCAkc2hvcnRfdXJs
LCAnJywgJ2FyY19zaG9ydF91cmwnKSksCiAgICAgICAgICAgICAgICAgICAgJyBpZD0iYXJj
X3Nob3J0X3VybC1vbl9vZmYiJwogICAgICAgICAgICAgICAgKS50cigKICAgICAgICAgICAg
ICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY19zaG9ydF9zaXRlX3VybCI+VFhQIFR3ZWV0
IHNob3J0IHNpdGUgVVJMPC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0
eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAg
ICAgICAgICAgICAgICAgICAudGQoZklucHV0KCd0ZXh0JywnYXJjX3Nob3J0X3NpdGVfdXJs
Jywkc2hvcnRfc2l0ZV91cmwsJycsJycsJycsJycsJycsJ2FyY19zaG9ydF9zaXRlX3VybCcp
KSwKICAgICAgICAgICAgICAgICAgICAnIGlkPSJhcmNfc2hvcnRfc2l0ZV91cmwtb3B0aW9u
IicKICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAgICAgICAgICAgdGRjcyhoZWQo
J1R3aXR0ZXIgdGFiJywgMiksMikKICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAg
ICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl90YWIiPkxvY2F0aW9uIG9m
IFR3aXR0ZXIgdGFiPC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxl
PSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAg
ICAgICAgICAgICAgICAudGQoYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCgnYXJjX3R3aXR0ZXJf
dGFiJywkdGFiKSkKICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAgICAgICAgICAg
dGRjcyhoZWQoJ0NhY2hlJywgMiksMikKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAg
ICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0
dGVyX2NhY2hlX2RpciI+Q2FjaGUgZGlyZWN0b3J5PC9sYWJlbD4nLAogICAgICAgICAgICAg
ICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246
IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoZklucHV0KCd0ZXh0JywnYXJj
X3R3aXR0ZXJfY2FjaGVfZGlyJywkY2FjaGVfZGlyLCcnLCcnLCcnLCcnLCcnLCdhcmNfdHdp
dHRlcl9jYWNoZV9kaXInKSkKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50
cigKICAgICAgICAgICAgICAgICAgICB0ZGEoCiAgICAgICAgICAgICAgICAgICAgICAgIGZJ
bnB1dCgnc3VibWl0JywgJ1N1Ym1pdCcsIGdUeHQoJ3NhdmVfYnV0dG9uJyksICdwdWJsaXNo
JykKICAgICAgICAgICAgICAgICAgICAgICAgLm4uc0lucHV0KCdwcmVmc19zYXZlJykKICAg
ICAgICAgICAgICAgICAgICAgICAgLm4uZUlucHV0KCdwbHVnaW5fcHJlZnMuYXJjX3R3aXR0
ZXInKQogICAgICAgICAgICAgICAgICAgICwgJyBjb2xzcGFuPSIyIiBjbGFzcz0ibm9saW5l
IicpKSkKICAgICAgICAgICAgICAgIC5lbmRUYWJsZSgpOwogICAgICAgIH0gZWxzZWlmICgg
JHN0ZXAhPSdyZWdpc3RlcicgKSB7CiAgICAgICAgICAgICRyZWdpc3RlclVSTCA9IGFyY190
d2l0dGVyOjpjYWxsYmFja1VSTCgkZXZlbnQsJ3JlZ2lzdGVyJyk7CiAgICAgICAgICAgICRo
dG1sLj0gc3RhcnRUYWJsZSgnbGlzdCcpLmZvcm0oCiAgICAgICAgICAgICAgICB0cigKICAg
ICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVHdpdHRlciBhY2NvdW50IGRldGFpbHMnLCAy
KSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAogICAgICAgICAg
ICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfdXNlciI+VHdpdHRlciB1
c2VybmFtZTwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4
dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAg
ICAgICAgICAgLnRkKAogICAgICAgICAgICAgICAgICAgICAgICAoJzxlbT51bmtub3duPC9l
bT4gKCcKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5ocmVmKCdDb25uZWN0IHRvIFR3
aXR0ZXInLCRyZWdpc3RlclVSTCkuJyknKQogICAgICAgICAgICAgICAgKSkpCiAgICAgICAg
ICAgICAgICAuZW5kVGFibGUoKTsKICAgICAgICB9CiAgICB9CgogICAgLy8gU2V0IGpRdWVy
eSBmb3Igc3dpdGNoaW5nIG9uL29mZiByZWxldmFudCBhcmNfc2hvcnRfdXJsIGZpZWxkcwog
ICAgJGpzID0gPDw8SlMKPHNjcmlwdCBsYW5ndWFnZT0iamF2YXNjcmlwdCIgdHlwZT0idGV4
dC9qYXZhc2NyaXB0Ij4KJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXsKICB2YXIgb25v
ZmYgPSAkKCcjYXJjX3Nob3J0X3VybC1vbl9vZmYnKTsKICB2YXIgYXJjX3Nob3J0X3VybF9v
ZmYgPSAkKCcjYXJjX3Nob3J0X3VybC1hcmNfc2hvcnRfdXJsLTAnKTsKICB2YXIgdXJsID0g
JCgnI2FyY19zaG9ydF9zaXRlX3VybC1vcHRpb24nKTsKICB2YXIgdXJsX21ldGhvZCA9ICQo
J3NlbGVjdFtuYW1lPSJhcmNfdHdpdHRlcl91cmxfbWV0aG9kIl0nKTsKCiAgaWYgKGFyY19z
aG9ydF91cmxfb2ZmLmF0dHIoJ2NoZWNrZWQnKT09dHJ1ZQogICYmICQoJ29wdGlvbjpzZWxl
Y3RlZCcsIHVybF9tZXRob2QpLnZhbCgpIT0nYXJjX3R3aXR0ZXInKSB7CiAgICB1cmwuaGlk
ZSgpOwogIH0KICAkKCdpbnB1dCcsIG9ub2ZmKS5jaGFuZ2UoZnVuY3Rpb24oKXsKICAgIGlm
ICgkKCdvcHRpb246c2VsZWN0ZWQnLCB1cmxfbWV0aG9kKS52YWwoKSE9J2FyY190d2l0dGVy
JykgewogICAgICBhcmNfc2hvcnRfdXJsX29mZi5hdHRyKCdjaGVja2VkJyk9PXRydWUgPyB1
cmwuaGlkZSgpIDogdXJsLnNob3coKTsKICAgIH0KICB9KTsKCiAgaWYgKCQoJ29wdGlvbjpz
ZWxlY3RlZCcsIHVybF9tZXRob2QpLnZhbCgpPT0nYXJjX3R3aXR0ZXInKSB7CiAgICBvbm9m
Zi5oaWRlKCk7IHVybC5zaG93KCk7CiAgfQogIHVybF9tZXRob2QuY2hhbmdlKGZ1bmN0aW9u
KCl7CiAgICBpZiAoJCgnb3B0aW9uOnNlbGVjdGVkJywgdXJsX21ldGhvZCkudmFsKCk9PSdh
cmNfdHdpdHRlcicpIHsKICAgICAgb25vZmYudG9nZ2xlKCk7IHVybC5zaG93KCk7CiAgICB9
IGVsc2UgewogICAgICBvbm9mZi50b2dnbGUoKTsKICAgICAgYXJjX3Nob3J0X3VybF9vZmYu
YXR0cignY2hlY2tlZCcpPT10cnVlID8gdXJsLmhpZGUoKSA6IHVybC5zaG93KCk7CiAgICB9
CiAgfSkKfSk7Cjwvc2NyaXB0PgpKUzsKCiAgICBlY2hvICRqcy4kaHRtbDsKfQoKLy8gQWRk
IFR3aXR0ZXIgdGFiIHRvIFRleHRwYXR0ZXJuCmZ1bmN0aW9uIGFyY19hZG1pbl90d2l0dGVy
KCRldmVudCwkc3RlcCkKewogICAgZ2xvYmFsICRwcmVmcywgJGFyY190d2l0dGVyX2NvbnN1
bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgogICAgJHR3aXQgPSBuZXcg
YXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgICAgICwgJGFy
Y190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rv
a2VuJ10KICAgICAgICAgICAgLCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2Vj
cmV0J10pOwoKICAgICR0d2l0LT5jYWNoZURpcigkcHJlZnNbJ2FyY190d2l0dGVyX2NhY2hl
X2RpciddKTsKCiAgICAkeG1sID0gJHR3aXQtPmdldCgndXNlcnMvc2hvdycKICAgICAgICAs
IGFycmF5KCdzY3JlZW5fbmFtZSc9PiRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddKSk7CiAg
ICAkdHdpdHRlclVzZXIgPSBAJHhtbC0+eHBhdGgoJy91c2VyJyk7CiAgICAkdHdpdHRlclVz
ZXIgPSAkdHdpdHRlclVzZXJbMF07CiAgICAkdHdpdHRlclVzZXJVUkwgPSAnaHR0cDovL3d3
dy50d2l0dGVyLmNvbS8nLiR0d2l0dGVyVXNlci0+c2NyZWVuX25hbWU7CgogICAgaWYgKCRz
dGVwPT0idHdlZXQiKSB7IC8vIHBvc3QgYW4gdXBkYXRlIHRvIFR3aXR0ZXIKCiAgICAgICAg
Ly8gZmV0Y2ggYW5kIGNsZWFuIG1lc3NhZ2UKICAgICAgICAkbWVzc2FnZSA9IHN0cmlwX3Rh
Z3MoZ3BzKCdtZXNzYWdlJykpOwogICAgICAgICRjb3VudCA9IHN0cmxlbigkbWVzc2FnZSk7
CgogICAgICAgIGlmICgkY291bnQ8PTE0MCAmJiAkY291bnQ+MCkgeyAvLyBwb3N0IHVwZGF0
ZQogICAgICAgICAgICAkcmVzdWx0ID0gJHR3aXQtPnBvc3QoJ3N0YXR1c2VzL3VwZGF0ZScs
IGFycmF5KCdzdGF0dXMnID0+ICRtZXNzYWdlKSk7CiAgICAgICAgfSBlbHNlIHsgLy8gbWVz
c2FnZSB0b28gbG9uZywgSmF2YVNjcmlwdCBpbnRlcmZhY2Ugc2hvdWxkIHByZXZlbnQgdGhp
cwogICAgICAgICAgICAkcmVzdWx0ID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBwYWdl
dG9wKCdUd2l0dGVyJywKICAgICAgICAgICAgKCgkcmVzdWx0IT1mYWxzZSk/J1R3aXR0ZXIg
dXBkYXRlZCc6J0Vycm9yIHVwZGF0aW5nIFR3aXR0ZXInKSk7CgogICAgfSBlbHNlaWYgKCRz
dGVwPT0iZGVsZXRlIikgeyAvLyBkZWxldGUgYW4gdXBkYXRlIGZyb20gVHdpdHRlcgoKICAg
ICAgICAkaWQgPSBzdHJpcF90YWdzKGdwcygnaWQnKSk7CiAgICAgICAgaWYgKCRpZCkgewog
ICAgICAgICAgICAkdHdpdC0+ZGVsZXRlKCdzdGF0dXNlcy9kZXN0cm95Jy4kaWQpOwogICAg
ICAgICAgICBzYWZlX2RlbGV0ZSgnYXJjX3R3aXR0ZXInLCJ0d2VldF9pZCA9ICRpZCIpOwog
ICAgICAgIH0KCiAgICAgICAgcGFnZXRvcCgnVHdpdHRlcicsJ1R3aXR0ZXIgdXBkYXRlZCcp
OwoKICAgIH0gZWxzZSB7CgogICAgICAgIHBhZ2V0b3AoJ1R3aXR0ZXInKTsKCiAgICB9Cgog
ICAgLy8gUHJlcGFyZSBKYXZhU2NyaXB0IHRvIGNyZWF0ZSBUd2l0dGVyIHVwZGF0ZSBpbnRl
cmZhY2UKCiAgICAkanMgPSAnPHNjcmlwdCBsYW5ndWFnZT0iamF2YXNjcmlwdCIgdHlwZT0i
dGV4dC9qYXZhc2NyaXB0Ij4nOwogICAgJGpzLj0gPDw8SlMKICAgICQoZG9jdW1lbnQpLnJl
YWR5KGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHZhciBjb3VudGVyU3R5bGUgPSAnZm9udC13
ZWlnaHQ6Ym9sZDtmbG9hdDpyaWdodDtmb250LXNpemU6MmVtO2xpbmUtaGVpZ2h0OjEuMmVt
Oyc7CiAgICAgICAgICAgICQoJyN0d2VldGNvdW50JykuYXR0cignc3R5bGUnLCBjb3VudGVy
U3R5bGUrJ2NvbG9yOiNjY2M7Jyk7CiAgICAgICAgICAgICQoJyNtZXNzYWdlJykua2V5dXAo
ZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB2YXIgY291bnQgPSAxNDAtJCgnI21lc3Nh
Z2UnKS52YWwoKS5sZW5ndGg7CiAgICAgICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmh0
bWwoY291bnQrJycpOyAvLyBoYWNrIHRvIGZvcmNlIG91dHB1dCBvZiAwCiAgICAgICAgICAg
ICAgICAvKmlmIChjb3VudDwwKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnaW5wdXQucHVi
bGlzaCcpLmF0dHIoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7CiAgICAgICAgICAgICAgICB9
IGVsc2UgewogICAgICAgICAgICAgICAgICAgICQoJ2lucHV0LnB1Ymxpc2gnKS5hdHRyKCdk
aXNhYmxlZCcsICcnKTsKICAgICAgICAgICAgICAgIH0qLwogICAgICAgICAgICAgICAgaWYg
KGNvdW50PDApIHsKICAgICAgICAgICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0dHIo
J3N0eWxlJywgY291bnRlclN0eWxlKydjb2xvcjojZjAwOycpOwogICAgICAgICAgICAgICAg
fSBlbHNlIGlmIChjb3VudDwxMCkgewogICAgICAgICAgICAgICAgICAgICQoJyN0d2VldGNv
dW50JykuYXR0cignc3R5bGUnLCBjb3VudGVyU3R5bGUrJ2NvbG9yOiMwMDA7Jyk7CiAgICAg
ICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICQoJyN0d2VldGNvdW50
JykuYXR0cignc3R5bGUnLCBjb3VudGVyU3R5bGUrJ2NvbG9yOiNjY2M7Jyk7CiAgICAgICAg
ICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgfSk7CkpTOwogICAgJGpzLj0gIjwv
c2NyaXB0PiI7CgogICAgJG91dCA9ICcnOwogICAgJHhtbCA9ICR0d2l0LT5nZXQoJ3N0YXR1
c2VzL3VzZXJfdGltZWxpbmUnCiAgICAgICAgLCBhcnJheSgnc2NyZWVuX25hbWUnPT4kcHJl
ZnNbJ2FyY190d2l0dGVyX3VzZXInXSwnY291bnQnPT4yNSkpOwogICAgJHR3ZWV0cyA9IEAk
eG1sLT54cGF0aCgnL3N0YXR1c2VzL3N0YXR1cycpOwogICAgaWYgKCR0d2VldHMpIGZvcmVh
Y2ggKCR0d2VldHMgYXMgJHR3ZWV0KSB7CiAgICAgICAgJHRpbWUgPSBzdHJ0b3RpbWUoaHRt
bGVudGl0aWVzKCR0d2VldC0+Y3JlYXRlZF9hdCkpOwogICAgICAgICRkYXRlID0gc2FmZV9z
dHJmdGltZSgkcHJlZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCddLCR0aW1lKTsKICAgICAgICAk
b3V0Lj0gdHIodGQoJGRhdGUsJ3NwYW4nKQogICAgICAgICAgICAudGQoYXJjX1R3aXR0ZXI6
Om1ha2VMaW5rcyhodG1sZW50aXRpZXMoJHR3ZWV0LT50ZXh0CiAgICAgICAgICAgICAgICAs
IEVOVF9RVU9URVMsJ1VURi04JykpKQogICAgICAgICAgICAudGQoZExpbmsoJ2FyY19hZG1p
bl90d2l0dGVyJywnZGVsZXRlJywnaWQnLCR0d2VldC0+aWQsJycpKQogICAgICAgICAgICAp
OwogICAgfQoKICAgICRodG1sID0gc3RhcnRUYWJsZSgnZWRpdCcpCiAgICAgICAgICAgIC50
cih0ZCgKICAgICAgICAgICAgZ3JhZignPGltZyBzcmM9IicuJHR3aXR0ZXJVc2VyLT5wcm9m
aWxlX2ltYWdlX3VybC4nIiBhbHQ9IlR3aXR0ZXIgYXZhdGFyIiAvPicKICAgICAgICAgICAg
LCcgc3R5bGU9ImZsb2F0OmxlZnQ7cGFkZGluZzoycHg7IicpCiAgICAgICAgICAgIC5ncmFm
KGhyZWYoJHR3aXR0ZXJVc2VyLT5uYW1lLCR0d2l0dGVyVXNlclVSTCksJyBzdHlsZT0iZm9u
dC1zaXplOjEuMmVtO2ZvbnQtd2VpZ2h0OmJvbGQ7IicpCiAgICAgICAgICAgIC5ncmFmKGhy
ZWYoJHR3aXR0ZXJVc2VyLT5mcmllbmRzX2NvdW50LicgZm9sbG93aW5nJywkdHdpdHRlclVz
ZXJVUkwuJy9mb2xsb3dpbmcnKQogICAgICAgICAgICAuJywgJy5ocmVmKCR0d2l0dGVyVXNl
ci0+Zm9sbG93ZXJzX2NvdW50LicgZm9sbG93ZXJzJywkdHdpdHRlclVzZXJVUkwuJy9mb2xs
b3dlcnMnKQogICAgICAgICAgICAuJywgJy5ocmVmKCR0d2l0dGVyVXNlci0+c3RhdHVzZXNf
Y291bnQuJyB1cGRhdGVzJywkdHdpdHRlclVzZXJVUkwpKSkpCiAgICAgICAgICAgIC50cih0
ZChmb3JtKAogICAgICAgICAgICBncmFmKCJVcGRhdGUgVHdpdHRlci4uLjxzcGFuIGlkPSd0
d2VldGNvdW50JyBzdHlsZT0nZm9udC13ZWlnaHQ6Ym9sZDtmbG9hdDpyaWdodDsnPjE0MDwv
c3Bhbj4iKQogICAgICAgICAgICAudGV4dF9hcmVhKCdtZXNzYWdlJywnNTAnLCc1NTAnLCcn
LCdtZXNzYWdlJykKICAgICAgICAgICAgLmVJbnB1dCgnYXJjX2FkbWluX3R3aXR0ZXInKQog
ICAgICAgICAgICAuc0lucHV0KCd0d2VldCcpLmJyCiAgICAgICAgICAgIC5mSW5wdXQoJ3N1
Ym1pdCcsJ3VwZGF0ZScsZ1R4dCgnVXBkYXRlJyksJ3B1Ymxpc2gnKQogICAgICAgICkpKQog
ICAgICAgIC5lbmRUYWJsZSgpOwoKICAgIC8vIEF0dGFjaCByZWNlbnQgVHdpdHRlciB1cGRh
dGVzCgogICAgJGh0bWwuPSBzdGFydFRhYmxlKCdsaXN0JywnJywnJywnJywnOTAlJykKICAg
ICAgICAuJG91dAogICAgICAgIC5lbmRUYWJsZSgpOwoKICAgIC8vIE91dHB1dCBKYXZhU2Ny
aXB0IGFuZCBIVE1MCgogICAgZWNobyAkanMuJGh0bWw7Cn0KCi8vIEFkZCBUd2l0dGVyIG9w
dGlvbnMgdG8gYXJ0aWNsZSBhcnRpY2xlIHNjcmVlbgpmdW5jdGlvbiBhcmNfYXBwZW5kX3R3
aXR0ZXIoJGV2ZW50LCAkc3RlcCwgJGRhdGEsICRyczEpCnsKICAgIGdsb2JhbCAkcHJlZnMs
ICRhcmNfdHdpdHRlciwgJGFwcF9tb2RlOwoKICAgICRwcmVmaXggPSB0cmltKGdwcygnYXJj
X3R3aXR0ZXJfcHJlZml4JykpOwogICAgJHByZWZpeCA9ICgkcHJlZml4KSA/ICRwcmVmaXgg
OiAkcHJlZnNbJ2FyY190d2l0dGVyX3ByZWZpeCddOwogICAgJHN1ZmZpeCA9IHRyaW0oZ3Bz
KCdhcmNfdHdpdHRlcl9zdWZmaXgnKSk7CiAgICAkc3VmZml4ID0gKCRzdWZmaXgpID8gJHN1
ZmZpeCA6ICRwcmVmc1snYXJjX3R3aXR0ZXJfc3VmZml4J107CgogICAgaWYgKCRyczFbJ0lE
J10pIHsKICAgICAgICAkc3FsID0gIlNFTEVDVCB0d2VldF9pZCx0d2VldCBGUk9NICIuUEZY
LiJhcmNfdHdpdHRlciBXSEVSRSBhcnRpY2xlX2lkPSIuJHJzMVsnSUQnXS4iOyI7CiAgICAg
ICAgJHJzMiA9IHNhZmVfcXVlcnkoJHNxbCk7ICRyczIgPSBuZXh0Um93KCRyczIpOwogICAg
fSBlbHNlIHsgLy8gbmV3IGFydGljbGUKICAgICAgICAkcnMyID0gJyc7CiAgICB9CgogICAg
aWYgKCRhcHBfbW9kZSA9PSAnYXN5bmMnKQogICAgewoJCSBzZW5kX3NjcmlwdF9yZXNwb25z
ZSgnJCgiI2FyY190d2l0dGVyIikucmVtb3ZlKCk7Jyk7CgkJfQoKICAgIGlmICgkcnMxWydJ
RCddICYmICRyczJbJ3R3ZWV0X2lkJ10pIHsKICAgICAgICAkY29udGVudCA9IHRhZyhhcmNf
VHdpdHRlcjo6bWFrZUxpbmtzKCRyczJbJ3R3ZWV0J10pLCdwJyk7CiAgICAgICAgcmV0dXJu
ICRkYXRhLmZpZWxkc2V0KCRjb250ZW50LCAnVHdpdHRlciB1cGRhdGUnLCAnYXJjX3R3aXR0
ZXInKTsKICAgIH0gZWxzZSB7CiAgICAgICAgJHZhciA9IGdwcygnYXJjX3R3ZWV0X3RoaXMn
KTsKICAgICAgICAkdmFyID0gKCRyczFbJ0lEJ10mJiEkdmFyKSA/IDAgOiAkcHJlZnNbJ2Fy
Y190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnXTsKICAgICAgICAkY29udGVudCAgPSB0YWcoeWVz
bm9SYWRpbygnYXJjX3R3ZWV0X3RoaXMnLCAkdmFyLCAnJywgJ2FyY190d2VldF90aGlzJyks
J3AnKTsKICAgICAgICAkY29udGVudCAuPSB0YWcoaHJlZignT3B0aW9ucycsJyNhcmNfdHdp
dHRlcl9vcHRpb25zJywgJyBvbmNsaWNrPSIkKFwnI2FyY190d2l0dGVyX29wdGlvbnNcJyku
dG9nZ2xlKCk7IHJldHVybiBmYWxzZTsiJyksJ3AnLCcgc3R5bGU9Im1hcmdpbi10b3A6NXB4
OyInKTsKICAgICAgICAkY29udGVudCAuPSB0YWcodGFnKHRhZygnVHdlZXQgcHJlZml4Jywn
bGFiZWwnLCAnIGZvcj0iYXJjX3R3aXR0ZXJfcHJlZml4IicpCiAgICAgICAgICAgIC5mSW5w
dXQoJ3RleHQnLCdhcmNfdHdpdHRlcl9wcmVmaXgnLCRwcmVmaXgsJ2VkaXQnLCcnLCcnLCcy
MicsJycsJ2FyY190d2l0dGVyX3ByZWZpeCcpLCdwJykKICAgICAgICAgICAgLnRhZyh0YWco
J1R3ZWV0IHN1ZmZpeCAoZWcgI2hhc2h0YWdzKScsJ2xhYmVsJywgJyBmb3I9ImFyY190d2l0
dGVyX3N1ZmZpeCInKQogICAgICAgICAgICAuZklucHV0KCd0ZXh0JywnYXJjX3R3aXR0ZXJf
c3VmZml4Jywkc3VmZml4LCdlZGl0JywnJywnJywnMjInLCcnLCdhcmNfdHdpdHRlcl9zdWZm
aXgnKSwncCcpCiAgICAgICAgICAgICwnZGl2JywnIGlkPSJhcmNfdHdpdHRlcl9vcHRpb25z
IiBjbGFzcz0idG9nZ2xlIiBzdHlsZT0iZGlzcGxheTpub25lIicpOwogICAgICAgIGlmIChp
c3NldCgkYXJjX3R3aXR0ZXJbJ2Vycm9yJ10pKSB7CiAgICAgICAgICAgICRjb250ZW50IC49
ICc8cD4nLiRhcmNfdHdpdHRlclsnZXJyb3InXS4nPC9wPic7CiAgICAgICAgfQogICAgICAg
IHJldHVybiAkZGF0YS5maWVsZHNldCgkY29udGVudCwgJ1VwZGF0ZSBUd2l0dGVyJywgJ2Fy
Y190d2l0dGVyJyk7CiAgICB9Cgp9CgovLyBVcGRhdGUgVHdpdHRlciB3aXRoIHBvc3RlZCBh
cnRpY2xlCmZ1bmN0aW9uIGFyY19hcnRpY2xlX3R3ZWV0KCRldmVudCwkc3RlcCkKewogICAg
Z2xvYmFsICRwcmVmcywgJGFyY190d2l0dGVyLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkK
ICAgICAgICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiAgICAkYXJ0aWNsZV9p
ZCA9IGVtcHR5KCRHTE9CQUxTWydJRCddKSA/IGdwcygnSUQnKSA6ICRHTE9CQUxTWydJRCdd
OwogICAgaWYgKCFlbXB0eSgkYXJ0aWNsZV9pZCkpIHsKCiAgICAgICAgaW5jbHVkZV9vbmNl
IHR4cGF0aC4nL3B1Ymxpc2gvdGFnaGFuZGxlcnMucGhwJzsKCiAgICAgICAgJGFydGljbGUg
PSBzYWZlX3JvdygiSUQsIFRpdGxlLCBTZWN0aW9uLCBQb3N0ZWQiLCAndGV4dHBhdHRlcm4n
LAogICAgICAgICAgICAiSUQ9eyRhcnRpY2xlX2lkfSBBTkQgU3RhdHVzPTQgQU5EIG5vdygp
Pj1Qb3N0ZWQiKTsKCiAgICAgICAgaWYgKCRhcnRpY2xlICYmIGdwcygnYXJjX3R3ZWV0X3Ro
aXMnKSkgeyAvLyB0d2VldCBhcnRpY2xlCgogICAgICAgICAgICAvLyBOZWVkIHRvIG1hbnVh
bGx5IHVwZGF0ZSB0aGUgJ1VSTCBvbmx5IHRpdGxlJyBiZWZvcmUgYnVpbGRpbmcgdGhlCiAg
ICAgICAgICAgIC8vIFVSTAogICAgICAgICAgICAkYXJ0aWNsZVsndXJsX3RpdGxlJ10gPSBn
cHMoJ3VybF90aXRsZScpOwogICAgICAgICAgICAvLyBNYWtlIHNob3J0IFVSTAogICAgICAg
ICAgICAkdXJsID0gcGVybWxpbmt1cmwoJGFydGljbGUpOwogICAgICAgICAgICAkc2hvcnRf
dXJsID0gYXJjX3Nob3J0ZW5fdXJsKCR1cmwsJHByZWZzWydhcmNfdHdpdHRlcl91cmxfbWV0
aG9kJ10sCiAgICAgICAgICAgICAgICBhcnJheSgnaWQnPT4kYXJ0aWNsZV9pZCkpOwoKICAg
ICAgICAgICAgaWYgKCEkc2hvcnRfdXJsKSB7IC8vIEZhaWxlZCB0byBvYnRhaW4gYSBzaG9y
dGVuZWQgVVJMLCBkbyBub3QgdHdlZXQhCiAgICAgICAgICAgICAgICAkYXJjX3R3aXR0ZXJb
J2Vycm9yJ10gPSAnVW5hYmxlIHRvIG9idGFpbiBhIHNob3J0IFVSTCBmb3IgdGhpcyBhcnRp
Y2xlLic7CgogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9Cgog
ICAgICAgICAgICAvLyBDb25zdHJ1Y3QgVHdpdHRlciB1cGRhdGUKICAgICAgICAgICAgJHBy
ZWZpeCAgPSB0cmltKGdwcygnYXJjX3R3aXR0ZXJfcHJlZml4JykpOwogICAgICAgICAgICAk
cHJlX2xlbiA9IHN0cmxlbigkcHJlZml4KTsKICAgICAgICAgICAgJHByZWZpeCAgPSAoJHBy
ZWZpeCAmJiAkcHJlX2xlbjw9MjApID8gJHByZWZpeC4nICcgOiAnJzsKICAgICAgICAgICAg
JHN1ZmZpeCAgPSB0cmltKGdwcygnYXJjX3R3aXR0ZXJfc3VmZml4JykpOwogICAgICAgICAg
ICAkc3VmX2xlbiA9IHN0cmxlbigkc3VmZml4KTsKICAgICAgICAgICAgJHN1ZmZpeCAgPSAo
JHN1ZmZpeCAmJiAkc3VmX2xlbjw9NDApID8gJyAnLiRzdWZmaXggOiAnJzsKICAgICAgICAg
ICAgJHVybF9sZW4gPSBzdHJsZW4oJHNob3J0X3VybCkrMTsgLy8gY291bnQgVVJMIGxlbmd0
aCArIDEgZm9yIHByZWZpeGVkIHNwYWNlCiAgICAgICAgICAgIGlmICgkcHJlZml4KSAkcHJl
X2xlbiArPSAxOwogICAgICAgICAgICBpZiAoJHN1ZmZpeCkgJHN1Zl9sZW4gKz0gMTsKICAg
ICAgICAgICAgaWYgKChzdHJsZW4oJGFydGljbGVbJ1RpdGxlJ10pKyR1cmxfbGVuKyRwcmVf
bGVuKyRzdWZfbGVuKT4xNDApIHsKICAgICAgICAgICAgICAgICRhcnRpY2xlWydUaXRsZSdd
ID0gc3Vic3RyKCRhcnRpY2xlWydUaXRsZSddLDAsMTM1LSR1cmxfbGVuLSRwcmVfbGVuLSRz
dWZfbGVuKS4nLi4uJzsKICAgICAgICAgICAgfQogICAgICAgICAgICAkdHdlZXQgPSAkcHJl
Zml4LiRhcnRpY2xlWydUaXRsZSddLiIgIi4kc2hvcnRfdXJsLiRzdWZmaXg7CgogICAgICAg
ICAgICAvLyBVcGRhdGUgVHdpdHRlcgogICAgICAgICAgICAkdHdpdCA9IG5ldyBhcmNfdHdp
dHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgICAgICwgJGFyY190
d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2Vu
J10KICAgICAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNl
Y3JldCddKTsKICAgICAgICAgICAgJHJlc3VsdCA9ICR0d2l0LT5wb3N0KCdzdGF0dXNlcy91
cGRhdGUnLCBhcnJheSgnc3RhdHVzJyA9PiAkdHdlZXQpKTsKCiAgICAgICAgICAgICR0d2Vl
dF9pZCA9IChpc19vYmplY3QoJHJlc3VsdCkpID8gJHJlc3VsdFswXS0+aWQgOiAwOwoKICAg
ICAgICAgICAgaWYgKCR0d2VldF9pZCkgewoKICAgICAgICAgICAgICAgICR0d2VldCA9IGFk
ZHNsYXNoZXMoJHR3ZWV0KTsKCiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgYXJjX3R3aXR0
ZXIgdGFibGUgd2l0aCB0d2VldAogICAgICAgICAgICAgICAgJHNxbCA9ICJJTlNFUlQgSU5U
TyAiLlBGWC4iYXJjX3R3aXR0ZXIgKGFydGljbGVfaWQsdHdlZXRfaWQsdHdlZXQsdGlueXVy
bCkgIjsKICAgICAgICAgICAgICAgICRzcWwuPSAiVkFMVUVTKCRhcnRpY2xlX2lkLCR0d2Vl
dF9pZCxcIiR0d2VldFwiLCckc2hvcnRfdXJsJyk7IjsKICAgICAgICAgICAgICAgIHNhZmVf
cXVlcnkoJHNxbCk7CgogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICAgICAg
ICB9IGVsc2UgewoKICAgICAgICAgICAgICAgICRhcmNfdHdpdHRlclsnZXJyb3InXSA9ICdU
d2l0dGVyIHJlc3BvbnNlOiAnCiAgICAgICAgICAgICAgICAgICAgLiR0d2l0LT5odHRwX2Nv
ZGU7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICB9CgogICAg
ICAgIH0KCiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwoKfQoKLyoKICogU2hvcnRlbiBVUkxz
IHVzaW5nIHZhcmlvdXMgbWV0aG9kcwogKi8KCmZ1bmN0aW9uIGFyY19zaG9ydGVuX3VybCgk
dXJsLCAkbWV0aG9kPScnLCAkYXR0cz1hcnJheSgpKQp7CiAgZ2xvYmFsICRwcmVmczsKCiAg
JGNoID0gY3VybF9pbml0KCk7CiAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX0hFQURFUiwg
MCk7CiAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCB0cnVlKTsK
ICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVElNRU9VVCwgMTApOwoKICBzd2l0Y2ggKCRt
ZXRob2QpIHsKICAgIGNhc2UgJ3NtZCc6IC8vIGNyZWF0ZSBhIHNob3J0ZW5lZCBVUkwgdXNp
bmcgU01EIFNob3J0IFVSTAogICAgICByZXR1cm4gKCRhdHRzWydpZCddKSA/IGh1LiRhdHRz
WydpZCddIDogZmFsc2U7IGJyZWFrOwogICAgY2FzZSAnYXJjX3R3aXR0ZXInOiAvLyBuYXRp
dmUgVVJMIHNob3J0ZW5pbmcKCiAgICAgIHJldHVybiAoJGF0dHNbJ2lkJ10pID8gUFJPVE9D
T0wuJHByZWZzWydhcmNfc2hvcnRfc2l0ZV91cmwnXS4nLycuJGF0dHNbJ2lkJ10gOiBmYWxz
ZTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAnaXNnZCc6CgogICAgICAkdSA9ICdodHRwOi8v
aXMuZ2QvYXBpLnBocD9sb25ndXJsPScudXJsZW5jb2RlKCR1cmwpOwogICAgICBjdXJsX3Nl
dG9wdCgkY2gsIENVUkxPUFRfVVJMLCAkdSk7CgogICAgICAkdGlueXVybCA9IGN1cmxfZXhl
YygkY2gpOwogICAgICBpZiAoJHRpbnl1cmwhPSdFcnJvcicgJiYgJHRpbnl1cmwhPScnKSB7
CiAgICAgICAgcmV0dXJuICR0aW55dXJsOwogICAgICB9IGVsc2UgewogICAgICAgIHRyaWdn
ZXJfZXJyb3IoJ2FyY190d2l0dGVyIGZhaWxlZCB0byBnZXQgYSBpcy5nZCBVUkwgZm9yICcK
ICAgICAgICAgICAgLiR1cmwsRV9VU0VSX1dBUk5JTkcpOwogICAgICB9CiAgICAgIGJyZWFr
OwoKICAgIGNhc2UgJ3Rpbnl1cmwnOiBkZWZhdWx0OiAvLyBjcmVhdGUgYSBzaG9ydGVuZWQg
VVJMIHVzaW5nIFRpbnlVUkwKCiAgICAgICR1ID0gJ2h0dHA6Ly90aW55dXJsLmNvbS9hcGkt
Y3JlYXRlLnBocD91cmw9Jy51cmxlbmNvZGUoJHVybCk7CiAgICAgIGN1cmxfc2V0b3B0KCRj
aCwgQ1VSTE9QVF9VUkwsICR1KTsKICAgICAgJHRpbnl1cmwgPSBjdXJsX2V4ZWMoJGNoKTsK
ICAgICAgaWYgKCR0aW55dXJsIT0nRXJyb3InICYmICR0aW55dXJsIT0nJykgewogICAgICAg
IHJldHVybiAkdGlueXVybDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0cmlnZ2VyX2Vycm9y
KCdhcmNfdHdpdHRlciBmYWlsZWQgdG8gZ2V0IGEgVGlueVVSTCBmb3IgJy4kdXJsLEVfVVNF
Ul9XQVJOSU5HKTsKICAgICAgfQoKICB9CgogIHJldHVybiBmYWxzZTsgLy8gZmFpbAoKfQoK
LyoKICogU2hvcnRlbmVkIFVSTCByZWRpcmVjdCBiYXNlZCBvbiBzbWRfc2hvcnRfdXJsCiAq
LwpmdW5jdGlvbiBhcmNfc2hvcnRfdXJsX3JlZGlyZWN0KCRldmVudCwgJHN0ZXApIHsKICBn
bG9iYWwgJHByZWZzOwoKICAkaGF2ZV9pZCA9IDA7CgogIC8vIENoZWNrIGlmIHRoZXJlIGlz
IGFuIGF2YWlsYWJsZSBzaG9ydCBzaXRlIHVybCBhbmQgaWYgaXQgaXMgYmVpbmcgdXNlZCBp
bgogIC8vIHRoaXMgaW5zdGFuY2UKICAkc2hvcnRfc2l0ZV91cmwgPSAkcHJlZnNbJ2FyY19z
aG9ydF9zaXRlX3VybCddOwogIGlmICgkc2hvcnRfc2l0ZV91cmwpIHsKICAgICRzaG9ydF9z
aXRlX3VybCA9IFBST1RPQ09MLiRzaG9ydF9zaXRlX3VybC4nLyc7CiAgICAkdXJsX3BhcnRz
ID0gcGFyc2VfdXJsKCRzaG9ydF9zaXRlX3VybCk7CiAgICAkcmUgPSAnI14nLiR1cmxfcGFy
dHNbJ3BhdGgnXS4nKFswLTldLiopIyc7CiAgICAkaGF2ZV9pZCA9IHByZWdfbWF0Y2goJHJl
LCAkX1NFUlZFUlsnUkVRVUVTVF9VUkknXSwgJG0pOwogIH0KCiAgLy8gRmFsbCBiYWNrIHRv
IHN0YW5kYXJkIHNpdGUgdXJsIChzbWRfc2hvcnRfdXJsIGJlaGF2aW91cikKICBpZiAoJGhh
dmVfaWQpIHsKICAgICR1cmxfcGFydHMgPSBwYXJzZV91cmwoaHUpOwogICAgJHJlID0gJyNe
Jy4kdXJsX3BhcnRzWydwYXRoJ10uJyhbMC05XS4qKSMnOwogICAgJGhhdmVfaWQgPSBwcmVn
X21hdGNoKCRyZSwgJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ10sICRtKTsKICB9CgogIC8vIERv
IHRoZSByZWRpcmVjdCBpZiB3ZSd2ZSBnb3QgYW4gYXJ0aWNsZSBpZAogIGlmICgkaGF2ZV9p
ZCkgewoJICAkaWQgPSAkbVsxXTsKCSAgJHBlcm1saW5rID0gcGVybWxpbmt1cmxfaWQoJGlk
KTsKCgkgIGlmICgkcGVybWxpbmspIHsKCQkgIG9iX2VuZF9jbGVhbigpOwoKCQkgIC8vIFN0
dXBpZCwgb3ZlciB0aGUgdG9wIGhlYWRlciBzZXR0aW5nIGZvciBJRQoJCSAgaGVhZGVyKCJT
dGF0dXM6IDMwMSIpOwoJCSAgaGVhZGVyKCJIVFRQLzEuMCAzMDEgTW92ZWQgUGVybWFuZW50
bHkiKTsKCQkgIGhlYWRlcigiTG9jYXRpb246ICIuJHBlcm1saW5rLCBUUlVFLCAzMDEpOwoK
CQkgIC8vIEluIGNhc2UgdGhlIGhlYWRlcigpIG1ldGhvZCBmYWlscywgZmFsbCBiYWNrIG9u
IGEgY2xhc3NpYyByZWRpcmVjdAoJCSAgZWNobyAnPGh0bWw+PGhlYWQ+PE1FVEEgSFRUUC1F
UVVJVj0iUmVmcmVzaCIgQ09OVEVOVD0iMDtVUkw9JwoJCSAgICAuJHBlcm1saW5rLiciPjwv
aGVhZD48Ym9keT48L2JvZHk+PC9odG1sPic7CgkJICBkaWUoKTsKCSAgfQogIH0KCn0KCi8v
IEF1dG8gZW5hYmxlIHBsdWdpbiBvbiBpbnN0YWxsIChvcmlnaW5hbCBpZGVhIGJ5IE1pY2hh
ZWwgTWFuZnJlKQpmdW5jdGlvbiBfYXJjX3R3aXR0ZXJfYXV0b19lbmFibGUoJGV2ZW50LCAk
c3RlcCwgJHByZWZpeD0nYXJjX3R3aXR0ZXInKQp7CiAgJHBsdWdpbiA9IHN1YnN0cigkZXZl
bnQsIHN0cmxlbigncGx1Z2luX2xpZmVjeWNsZS4nKSk7CiAgaWYgKHN0cm5jbXAoJHBsdWdp
biwgJHByZWZpeCwgc3RybGVuKCRwcmVmaXgpKSA9PSAwKQogIHsKICAgIHNhZmVfdXBkYXRl
KCd0eHBfcGx1Z2luJywgInN0YXR1cyA9IDEiLCAibmFtZSA9ICciIC4gZG9TbGFzaCgkcGx1
Z2luKSAuICInIik7CiAgfQp9CgovKgogKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgoqLwoK
Y2xhc3MgYXJjX3R3aXR0ZXIgZXh0ZW5kcyBUd2l0dGVyT0F1dGggewogICAgLy8gQ2FjaGlu
ZyB2YXJpYWJsZXMKICAgIHByaXZhdGUgJF9jYWNoZSA9IHRydWU7CiAgICBwcml2YXRlICRf
Y2FjaGVfZGlyID0gJy4vdG1wJzsKICAgIHByaXZhdGUgJF9jYWNoZV90aW1lID0gMTgwMDsg
Ly8gMzAgbWludXRlIGNhY2hlCgogICAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGNvbnN1bWVy
X2tleSwgJGNvbnN1bWVyX3NlY3JldCwgJG9hdXRoX3Rva2VuID0gTlVMTAogICAgICAgICwg
JG9hdXRoX3Rva2VuX3NlY3JldCA9IE5VTEwpCiAgICB7CiAgICAgICAgcGFyZW50OjpfX2Nv
bnN0cnVjdCgkY29uc3VtZXJfa2V5LCAkY29uc3VtZXJfc2VjcmV0LCAkb2F1dGhfdG9rZW4K
ICAgICAgICAgICAgLCAkb2F1dGhfdG9rZW5fc2VjcmV0KTsKICAgICAgICAkdGhpcy0+Zm9y
bWF0ID0gJ3htbCc7CiAgICAgICAgJHRoaXMtPnRpbWVvdXQgPSAxNTsKICAgICAgICAkdGhp
cy0+Y29ubmVjdHRpbWVvdXQgPSAxNTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gY2Fs
bGJhY2tVUkwoJGV2ZW50LCRzdGVwKQogICAgewogICAgICAgIHJldHVybiBwcmVnX3JlcGxh
Y2UoJy9cPy4qLycsICcnLFBST1RPQ09MLiRfU0VSVkVSWydTRVJWRVJfTkFNRSddLiRfU0VS
VkVSWydSRVFVRVNUX1VSSSddKQogICAgICAgICAgLic/ZXZlbnQ9Jy4kZXZlbnQuJyZhbXA7
c3RlcD0nLiRzdGVwOwogICAgfQoKICAgIC8vIGNyZWF0ZSBUd2l0dGVyIGFuZCBleHRlcm5h
bCBsaW5rcyBpbiB0ZXh0CiAgICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIG1ha2VMaW5rcygk
dGV4dCkKICAgIHsKICAgICAgICAkdXJsID0gJy9cYihodHRwfGh0dHBzfGZ0cCk6XC9cLyhb
QS1aMC05XVtBLVowLTlfLV0qKD86XC5bQS1aMC05XVtBLVowLTlfLV0qKSspOj8oXGQrKT9c
Lz8oW1wvXHcrXC5dKylcYi9pJzsKICAgICAgICAkdGV4dCA9IHByZWdfcmVwbGFjZSgkdXJs
LCAiPGEgaHJlZj0nJDAnIHJlbD0nZXh0ZXJuYWwnPiQwPC9hPiIsICR0ZXh0KTsKICAgICAg
ICAkdXJsID0gJy9cYihefFxzKXd3dy4oW2Etel9BLVowLTldKykoKFwuW2Etel0rKSspXGIv
aSc7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2UoJHVybCwgIjxhIGhyZWY9J2h0dHA6
Ly93d3cuJDIkMycgcmVsPSdleHRlcm5hbCc+d3d3LiQyJDM8L2E+IiwgJHRleHQpOwogICAg
ICAgICR0ZXh0ID0gcHJlZ19yZXBsYWNlKCIvKF58XHMpQChbYS16X0EtWjAtOV0rKS8iLAog
ICAgICAgICAgICAiJDFAPGEgaHJlZj0naHR0cDovL3R3aXR0ZXIuY29tLyQyJyByZWw9J2V4
dGVybmFsJz4kMjwvYT4iLCR0ZXh0KTsKICAgICAgICAkdGV4dCA9IHByZWdfcmVwbGFjZSgi
LyhefFxzKShcIyhbYS16X0EtWjAtOTpfLV0rKSkvIiwKICAgICAgICAgICAgIiQxPGEgaHJl
Zj0naHR0cDovL3R3aXR0ZXIuY29tL3NlYXJjaD9xPSUyMyQzJyByZWw9J2V4dGVybmFsJz4k
MjwvYT4iLCR0ZXh0KTsKICAgICAgICByZXR1cm4gJHRleHQ7CiAgfQoKICAgIHB1YmxpYyBm
dW5jdGlvbiBnZXQoJHVybCwgJHBhcmFtcyA9IGFycmF5KCkpCiAgICB7CiAgICAgICAgJGFw
aV91cmwgPSBtZDUoJHVybC51cmxlbmNvZGUoc2VyaWFsaXplKCRwYXJhbXMpKSk7CiAgICAg
ICAgJGRhdGEgPSAnJzsKCiAgICAgICAgaWYgKCR0aGlzLT5fY2FjaGUpIHsgLy8gY2hlY2sg
Zm9yIGNhY2hlZCB4bWwKCiAgICAgICAgICAgICRkYXRhID0gJHRoaXMtPl9yZXRyaWV2ZUNh
Y2hlKCRhcGlfdXJsKTsKCiAgICAgICAgfQogICAgICAgIGlmIChlbXB0eSgkZGF0YSkpIHsK
ICAgICAgICAgICAgJGRhdGEgPSBwYXJlbnQ6OmdldCgkdXJsLCAkcGFyYW1zKTsKICAgICAg
ICAgICAgaWYgKCR0aGlzLT5odHRwX2NvZGU9PT0yMDAgJiYgJHhtbD1zaW1wbGV4bWxfbG9h
ZF9zdHJpbmcoJGRhdGEpKSB7IC8vIHNhdmUgY2FjaGUKICAgICAgICAgICAgICAgICRmaWxl
ID0gJHRoaXMtPl9jYWNoZV9kaXIuJy8nLiRhcGlfdXJsOwogICAgICAgICAgICAgICAgZmls
ZV9wdXRfY29udGVudHMoJGZpbGUsJGRhdGEsTE9DS19FWCk7CiAgICAgICAgICAgICAgICBy
ZXR1cm4gJHhtbDsKICAgICAgICAgICAgfSBlbHNlIHsgLy8gZmFpbGVkIHRvIHJldHJpZXZl
IGRhdGEgZnJvbSBUd2l0dGVyCgogICAgICAgICAgICAgICAgaWYgKCR0aGlzLT5fY2FjaGUp
IHsgLy8gYXR0ZW1wdCB0byBmb3JjZSBjYWNoZWQgeG1sIHJldHVybgoKICAgICAgICAgICAg
ICAgICAgICAkZGF0YSA9ICR0aGlzLT5fcmV0cmlldmVDYWNoZSgkYXBpX3VybCx0cnVlKTsK
ICAgICAgICAgICAgICAgICAgICBpZiAoJGRhdGEpIHJldHVybiBAc2ltcGxleG1sX2xvYWRf
c3RyaW5nKCRkYXRhKTsKCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0
dXJuIGZhbHNlOwoKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7IC8vIHJldHVybiBj
YWNoZWQgeG1sCiAgICAgICAgICAgIHJldHVybiBAc2ltcGxleG1sX2xvYWRfc3RyaW5nKCRk
YXRhKTsKICAgICAgICB9CiAgICB9IC8vZW5kIGdldCgpCgogICAgZnVuY3Rpb24gcG9zdCgk
dXJsLCAkcGFyYW1zID0gYXJyYXkoKSkKICAgIHsKICAgICAgICAkZGF0YSA9IHBhcmVudDo6
cG9zdCgkdXJsLCRwYXJhbXMpOwogICAgICAgIHJldHVybiBzaW1wbGV4bWxfbG9hZF9zdHJp
bmcoJGRhdGEpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRlbGV0ZSgkdXJsLCAkcGFyYW1zID0g
YXJyYXkoKSkKICAgIHsKICAgICAgICAkZGF0YSA9IHBhcmVudDo6ZGVsZXRlKCR1cmwsJHBh
cmFtcyk7CiAgICAgICAgcmV0dXJuIHNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSk7CiAg
ICB9CgogICAgLy8gQ2FjaGUgbWV0aG9kcwoKICAgIHB1YmxpYyBmdW5jdGlvbiBzZXRDYWNo
aW5nKCRjYWNoZT10cnVlKQogICAgewogICAgICAgICR0aGlzLT5fY2FjaGUgPSAoJGNhY2hl
KSA/IHRydWUgOiBmYWxzZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJs
aWMgZnVuY3Rpb24gY2FjaGVEaXIoJGxvYykKICAgIHsKICAgICAgICAkdGhpcy0+X2NhY2hl
X2RpciA9ICRsb2M7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHVibGljIGZ1
bmN0aW9uIGNhY2hlVGltZSgkbWlucykKICAgIHsKICAgICAgICAkdGhpcy0+X2NhY2hlX3Rp
bWUgPSAkbWlucyo2MDsgLy8gY29udmVydCBtaW51dGVzIGludG8gc2Vjb25kcwogICAgICAg
IHJldHVybiB0cnVlOwogICAgfQoKICAgIHByaXZhdGUgZnVuY3Rpb24gX3JldHJpZXZlQ2Fj
aGUoJHVybCwkb3ZlcmlkZV90aW1lb3V0PWZhbHNlKQogICAgewogICAgICAgICRmaWxlID0g
JHRoaXMtPl9jYWNoZV9kaXIuJy8nLiR1cmw7CiAgICAgICAgaWYgKGZpbGVfZXhpc3RzKCRm
aWxlKSkgewoKICAgICAgICAgICAgJGRpZmYgPSB0aW1lKCkgLSBmaWxlbXRpbWUoJGZpbGUp
OwogICAgICAgICAgICBpZiAoJG92ZXJpZGVfdGltZW91dCB8fCAkZGlmZiA8ICR0aGlzLT5f
Y2FjaGVfdGltZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZpbGVfZ2V0X2NvbnRlbnRz
KCRmaWxlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiBm
YWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1
cm4gZmFsc2U7CiAgICAgICAgfQogICAgfQp9CgovKgogKiBBYnJhaGFtIFdpbGxpYW1zIChh
YnJhaGFtQGFicmFoLmFtKSBodHRwOi8vYWJyYWguYW0KICoKICogVGhlIGZpcnN0IFBIUCBM
aWJyYXJ5IHRvIHN1cHBvcnQgT0F1dGggZm9yIFR3aXR0ZXIncyBSRVNUIEFQSS4KICovCgov
KioKICogVHdpdHRlciBPQXV0aCBjbGFzcwogKi8KY2xhc3MgVHdpdHRlck9BdXRoIHsKICAv
KiBDb250YWlucyB0aGUgbGFzdCBIVFRQIHN0YXR1cyBjb2RlIHJldHVybmVkLiAqLwogIHB1
YmxpYyAkaHR0cF9jb2RlOwogIC8qIENvbnRhaW5zIHRoZSBsYXN0IEFQSSBjYWxsLiAqLwog
IHB1YmxpYyAkdXJsOwogIC8qIFNldCB1cCB0aGUgQVBJIHJvb3QgVVJMLiAqLwogIHB1Ymxp
YyAkaG9zdCA9ICJodHRwczovL2FwaS50d2l0dGVyLmNvbS8xLyI7CiAgLyogU2V0IHRpbWVv
dXQgZGVmYXVsdC4gKi8KICBwdWJsaWMgJHRpbWVvdXQgPSAzMDsKICAvKiBTZXQgY29ubmVj
dCB0aW1lb3V0LiAqLwogIHB1YmxpYyAkY29ubmVjdHRpbWVvdXQgPSAzMDsKICAvKiBWZXJp
ZnkgU1NMIENlcnQuICovCiAgcHVibGljICRzc2xfdmVyaWZ5cGVlciA9IEZBTFNFOwogIC8q
IFJlc3BvbnMgZm9ybWF0LiAqLwogIHB1YmxpYyAkZm9ybWF0ID0gJ2pzb24nOwogIC8qIERl
Y29kZSByZXR1cm5lZCBqc29uIGRhdGEuICovCiAgcHVibGljICRkZWNvZGVfanNvbiA9IFRS
VUU7CiAgLyogQ29udGFpbnMgdGhlIGxhc3QgSFRUUCBoZWFkZXJzIHJldHVybmVkLiAqLwog
IHB1YmxpYyAkaHR0cF9pbmZvOwogIC8qIFNldCB0aGUgdXNlcmFnbmV0LiAqLwogIHB1Ymxp
YyAkdXNlcmFnZW50ID0gJ1R3aXR0ZXJPQXV0aCB2MC4yLjAtYmV0YTInOwogIC8qIEltbWVk
aWF0ZWx5IHJldHJ5IHRoZSBBUEkgY2FsbCBpZiB0aGUgcmVzcG9uc2Ugd2FzIG5vdCBzdWNj
ZXNzZnVsLiAqLwogIC8vcHVibGljICRyZXRyeSA9IFRSVUU7CgoKCgogIC8qKgogICAqIFNl
dCBBUEkgVVJMUwogICAqLwogIGZ1bmN0aW9uIGFjY2Vzc1Rva2VuVVJMKCkgIHsgcmV0dXJu
ICdodHRwczovL2FwaS50d2l0dGVyLmNvbS9vYXV0aC9hY2Nlc3NfdG9rZW4nOyB9CiAgZnVu
Y3Rpb24gYXV0aGVudGljYXRlVVJMKCkgeyByZXR1cm4gJ2h0dHBzOi8vdHdpdHRlci5jb20v
b2F1dGgvYXV0aGVudGljYXRlJzsgfQogIGZ1bmN0aW9uIGF1dGhvcml6ZVVSTCgpICAgIHsg
cmV0dXJuICdodHRwczovL3R3aXR0ZXIuY29tL29hdXRoL2F1dGhvcml6ZSc7IH0KICBmdW5j
dGlvbiByZXF1ZXN0VG9rZW5VUkwoKSB7IHJldHVybiAnaHR0cHM6Ly9hcGkudHdpdHRlci5j
b20vb2F1dGgvcmVxdWVzdF90b2tlbic7IH0KCiAgLyoqCiAgICogRGVidWcgaGVscGVycwog
ICAqLwogIGZ1bmN0aW9uIGxhc3RTdGF0dXNDb2RlKCkgeyByZXR1cm4gJHRoaXMtPmh0dHBf
c3RhdHVzOyB9CiAgZnVuY3Rpb24gbGFzdEFQSUNhbGwoKSB7IHJldHVybiAkdGhpcy0+bGFz
dF9hcGlfY2FsbDsgfQoKICAvKioKICAgKiBjb25zdHJ1Y3QgVHdpdHRlck9BdXRoIG9iamVj
dAogICAqLwogIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRjb25zdW1lcl9rZXksICRjb25zdW1l
cl9zZWNyZXQsICRvYXV0aF90b2tlbiA9IE5VTEwsICRvYXV0aF90b2tlbl9zZWNyZXQgPSBO
VUxMKSB7CiAgICAkdGhpcy0+c2hhMV9tZXRob2QgPSBuZXcgT0F1dGhTaWduYXR1cmVNZXRo
b2RfSE1BQ19TSEExKCk7CiAgICAkdGhpcy0+Y29uc3VtZXIgPSBuZXcgT0F1dGhDb25zdW1l
cigkY29uc3VtZXJfa2V5LCAkY29uc3VtZXJfc2VjcmV0KTsKICAgIGlmICghZW1wdHkoJG9h
dXRoX3Rva2VuKSAmJiAhZW1wdHkoJG9hdXRoX3Rva2VuX3NlY3JldCkpIHsKICAgICAgJHRo
aXMtPnRva2VuID0gbmV3IE9BdXRoQ29uc3VtZXIoJG9hdXRoX3Rva2VuLCAkb2F1dGhfdG9r
ZW5fc2VjcmV0KTsKICAgIH0gZWxzZSB7CiAgICAgICR0aGlzLT50b2tlbiA9IE5VTEw7CiAg
ICB9CiAgfQoKCiAgLyoqCiAgICogR2V0IGEgcmVxdWVzdF90b2tlbiBmcm9tIFR3aXR0ZXIK
ICAgKgogICAqIEByZXR1cm5zIGEga2V5L3ZhbHVlIGFycmF5IGNvbnRhaW5pbmcgb2F1dGhf
dG9rZW4gYW5kIG9hdXRoX3Rva2VuX3NlY3JldAogICAqLwogIGZ1bmN0aW9uIGdldFJlcXVl
c3RUb2tlbigkb2F1dGhfY2FsbGJhY2sgPSBOVUxMKSB7CiAgICAkcGFyYW1ldGVycyA9IGFy
cmF5KCk7CiAgICBpZiAoIWVtcHR5KCRvYXV0aF9jYWxsYmFjaykpIHsKICAgICAgJHBhcmFt
ZXRlcnNbJ29hdXRoX2NhbGxiYWNrJ10gPSAkb2F1dGhfY2FsbGJhY2s7CiAgICB9CiAgICAk
cmVxdWVzdCA9ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHRoaXMtPnJlcXVlc3RUb2tlblVSTCgp
LCAnR0VUJywgJHBhcmFtZXRlcnMpOwogICAgJHRva2VuID0gT0F1dGhVdGlsOjpwYXJzZV9w
YXJhbWV0ZXJzKCRyZXF1ZXN0KTsKICAgICR0aGlzLT50b2tlbiA9IG5ldyBPQXV0aENvbnN1
bWVyKCR0b2tlblsnb2F1dGhfdG9rZW4nXSwgJHRva2VuWydvYXV0aF90b2tlbl9zZWNyZXQn
XSk7CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAgLyoqCiAgICogR2V0IHRoZSBhdXRob3Jp
emUgVVJMCiAgICoKICAgKiBAcmV0dXJucyBhIHN0cmluZwogICAqLwogIGZ1bmN0aW9uIGdl
dEF1dGhvcml6ZVVSTCgkdG9rZW4sICRzaWduX2luX3dpdGhfdHdpdHRlciA9IFRSVUUpIHsK
ICAgIGlmIChpc19hcnJheSgkdG9rZW4pKSB7CiAgICAgICR0b2tlbiA9ICR0b2tlblsnb2F1
dGhfdG9rZW4nXTsKICAgIH0KICAgIGlmIChlbXB0eSgkc2lnbl9pbl93aXRoX3R3aXR0ZXIp
KSB7CiAgICAgIHJldHVybiAkdGhpcy0+YXV0aG9yaXplVVJMKCkgLiAiP29hdXRoX3Rva2Vu
PXskdG9rZW59IjsKICAgIH0gZWxzZSB7CiAgICAgICByZXR1cm4gJHRoaXMtPmF1dGhlbnRp
Y2F0ZVVSTCgpIC4gIj9vYXV0aF90b2tlbj17JHRva2VufSI7CiAgICB9CiAgfQoKICAvKioK
ICAgKiBFeGNoYW5nZSByZXF1ZXN0IHRva2VuIGFuZCBzZWNyZXQgZm9yIGFuIGFjY2VzcyB0
b2tlbiBhbmQKICAgKiBzZWNyZXQsIHRvIHNpZ24gQVBJIGNhbGxzLgogICAqCiAgICogQHJl
dHVybnMgYXJyYXkoIm9hdXRoX3Rva2VuIiA9PiAidGhlLWFjY2Vzcy10b2tlbiIsCiAgICog
ICAgICAgICAgICAgICAgIm9hdXRoX3Rva2VuX3NlY3JldCIgPT4gInRoZS1hY2Nlc3Mtc2Vj
cmV0IiwKICAgKiAgICAgICAgICAgICAgICAidXNlcl9pZCIgPT4gIjk0MzY5OTIiLAogICAq
ICAgICAgICAgICAgICAgICJzY3JlZW5fbmFtZSIgPT4gImFicmFoYW0iKQogICAqLwogIGZ1
bmN0aW9uIGdldEFjY2Vzc1Rva2VuKCRvYXV0aF92ZXJpZmllciA9IEZBTFNFKSB7CiAgICAk
cGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICBpZiAoIWVtcHR5KCRvYXV0aF92ZXJpZmllcikp
IHsKICAgICAgJHBhcmFtZXRlcnNbJ29hdXRoX3ZlcmlmaWVyJ10gPSAkb2F1dGhfdmVyaWZp
ZXI7CiAgICB9CiAgICAkcmVxdWVzdCA9ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHRoaXMtPmFj
Y2Vzc1Rva2VuVVJMKCksICdHRVQnLCAkcGFyYW1ldGVycyk7CiAgICAkdG9rZW4gPSBPQXV0
aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMoJHJlcXVlc3QpOwogICAgJHRoaXMtPnRva2VuID0g
bmV3IE9BdXRoQ29uc3VtZXIoJHRva2VuWydvYXV0aF90b2tlbiddLCAkdG9rZW5bJ29hdXRo
X3Rva2VuX3NlY3JldCddKTsKICAgIHJldHVybiAkdG9rZW47CiAgfQoKICAvKioKICAgKiBP
bmUgdGltZSBleGNoYW5nZSBvZiB1c2VybmFtZSBhbmQgcGFzc3dvcmQgZm9yIGFjY2VzcyB0
b2tlbiBhbmQgc2VjcmV0LgogICAqCiAgICogQHJldHVybnMgYXJyYXkoIm9hdXRoX3Rva2Vu
IiA9PiAidGhlLWFjY2Vzcy10b2tlbiIsCiAgICogICAgICAgICAgICAgICAgIm9hdXRoX3Rv
a2VuX3NlY3JldCIgPT4gInRoZS1hY2Nlc3Mtc2VjcmV0IiwKICAgKiAgICAgICAgICAgICAg
ICAidXNlcl9pZCIgPT4gIjk0MzY5OTIiLAogICAqICAgICAgICAgICAgICAgICJzY3JlZW5f
bmFtZSIgPT4gImFicmFoYW0iLAogICAqICAgICAgICAgICAgICAgICJ4X2F1dGhfZXhwaXJl
cyIgPT4gIjAiKQogICAqLwogIGZ1bmN0aW9uIGdldFhBdXRoVG9rZW4oJHVzZXJuYW1lLCAk
cGFzc3dvcmQpIHsKICAgICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgICRwYXJhbWV0ZXJz
Wyd4X2F1dGhfdXNlcm5hbWUnXSA9ICR1c2VybmFtZTsKICAgICRwYXJhbWV0ZXJzWyd4X2F1
dGhfcGFzc3dvcmQnXSA9ICRwYXNzd29yZDsKICAgICRwYXJhbWV0ZXJzWyd4X2F1dGhfbW9k
ZSddID0gJ2NsaWVudF9hdXRoJzsKICAgICRyZXF1ZXN0ID0gJHRoaXMtPm9BdXRoUmVxdWVz
dCgkdGhpcy0+YWNjZXNzVG9rZW5VUkwoKSwgJ1BPU1QnLCAkcGFyYW1ldGVycyk7CiAgICAk
dG9rZW4gPSBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMoJHJlcXVlc3QpOwogICAgJHRo
aXMtPnRva2VuID0gbmV3IE9BdXRoQ29uc3VtZXIoJHRva2VuWydvYXV0aF90b2tlbiddLCAk
dG9rZW5bJ29hdXRoX3Rva2VuX3NlY3JldCddKTsKICAgIHJldHVybiAkdG9rZW47CiAgfQoK
ICAvKioKICAgKiBHRVQgd3JhcHBlciBmb3Igb0F1dGhSZXF1ZXN0LgogICAqLwogIGZ1bmN0
aW9uIGdldCgkdXJsLCAkcGFyYW1ldGVycyA9IGFycmF5KCkpIHsKICAgICRyZXNwb25zZSA9
ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHVybCwgJ0dFVCcsICRwYXJhbWV0ZXJzKTsKICAgIGlm
ICgkdGhpcy0+Zm9ybWF0ID09PSAnanNvbicgJiYgJHRoaXMtPmRlY29kZV9qc29uKSB7CiAg
ICAgIHJldHVybiBqc29uX2RlY29kZSgkcmVzcG9uc2UpOwogICAgfQogICAgcmV0dXJuICRy
ZXNwb25zZTsKICB9CgogIC8qKgogICAqIFBPU1Qgd3JhcHBlciBmb3Igb0F1dGhSZXF1ZXN0
LgogICAqLwogIGZ1bmN0aW9uIHBvc3QoJHVybCwgJHBhcmFtZXRlcnMgPSBhcnJheSgpKSB7
CiAgICAkcmVzcG9uc2UgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR1cmwsICdQT1NUJywgJHBh
cmFtZXRlcnMpOwogICAgaWYgKCR0aGlzLT5mb3JtYXQgPT09ICdqc29uJyAmJiAkdGhpcy0+
ZGVjb2RlX2pzb24pIHsKICAgICAgcmV0dXJuIGpzb25fZGVjb2RlKCRyZXNwb25zZSk7CiAg
ICB9CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoqCiAgICogREVMRVRFIHdyYXBw
ZXIgZm9yIG9BdXRoUmVxZXVzdC4KICAgKi8KICBmdW5jdGlvbiBkZWxldGUoJHVybCwgJHBh
cmFtZXRlcnMgPSBhcnJheSgpKSB7CiAgICAkcmVzcG9uc2UgPSAkdGhpcy0+b0F1dGhSZXF1
ZXN0KCR1cmwsICdERUxFVEUnLCAkcGFyYW1ldGVycyk7CiAgICBpZiAoJHRoaXMtPmZvcm1h
dCA9PT0gJ2pzb24nICYmICR0aGlzLT5kZWNvZGVfanNvbikgewogICAgICByZXR1cm4ganNv
bl9kZWNvZGUoJHJlc3BvbnNlKTsKICAgIH0KICAgIHJldHVybiAkcmVzcG9uc2U7CiAgfQoK
ICAvKioKICAgKiBGb3JtYXQgYW5kIHNpZ24gYW4gT0F1dGggLyBBUEkgcmVxdWVzdAogICAq
LwogIGZ1bmN0aW9uIG9BdXRoUmVxdWVzdCgkdXJsLCAkbWV0aG9kLCAkcGFyYW1ldGVycykg
ewogICAgaWYgKHN0cnJwb3MoJHVybCwgJ2h0dHBzOi8vJykgIT09IDAgJiYgc3RycnBvcygk
dXJsLCAnaHR0cDovLycpICE9PSAwKSB7CiAgICAgICR1cmwgPSAieyR0aGlzLT5ob3N0fXsk
dXJsfS57JHRoaXMtPmZvcm1hdH0iOwogICAgfQogICAgJHJlcXVlc3QgPSBPQXV0aFJlcXVl
c3Q6OmZyb21fY29uc3VtZXJfYW5kX3Rva2VuKCR0aGlzLT5jb25zdW1lciwgJHRoaXMtPnRv
a2VuLCAkbWV0aG9kLCAkdXJsLCAkcGFyYW1ldGVycyk7CiAgICAkcmVxdWVzdC0+c2lnbl9y
ZXF1ZXN0KCR0aGlzLT5zaGExX21ldGhvZCwgJHRoaXMtPmNvbnN1bWVyLCAkdGhpcy0+dG9r
ZW4pOwogICAgc3dpdGNoICgkbWV0aG9kKSB7CiAgICBjYXNlICdHRVQnOgogICAgICByZXR1
cm4gJHRoaXMtPmh0dHAoJHJlcXVlc3QtPnRvX3VybCgpLCAnR0VUJyk7CiAgICBkZWZhdWx0
OgogICAgICByZXR1cm4gJHRoaXMtPmh0dHAoJHJlcXVlc3QtPmdldF9ub3JtYWxpemVkX2h0
dHBfdXJsKCksICRtZXRob2QsICRyZXF1ZXN0LT50b19wb3N0ZGF0YSgpKTsKICAgIH0KICB9
CgogIC8qKgogICAqIE1ha2UgYW4gSFRUUCByZXF1ZXN0CiAgICoKICAgKiBAcmV0dXJuIEFQ
SSByZXN1bHRzCiAgICovCiAgZnVuY3Rpb24gaHR0cCgkdXJsLCAkbWV0aG9kLCAkcG9zdGZp
ZWxkcyA9IE5VTEwpIHsKICAgICR0aGlzLT5odHRwX2luZm8gPSBhcnJheSgpOwogICAgJGNp
ID0gY3VybF9pbml0KCk7CiAgICAvKiBDdXJsIHNldHRpbmdzICovCiAgICBjdXJsX3NldG9w
dCgkY2ksIENVUkxPUFRfVVNFUkFHRU5ULCAkdGhpcy0+dXNlcmFnZW50KTsKICAgIGN1cmxf
c2V0b3B0KCRjaSwgQ1VSTE9QVF9DT05ORUNUVElNRU9VVCwgJHRoaXMtPmNvbm5lY3R0aW1l
b3V0KTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9USU1FT1VULCAkdGhpcy0+dGlt
ZW91dCk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIsIFRS
VUUpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0hUVFBIRUFERVIsIGFycmF5KCdF
eHBlY3Q6JykpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1NTTF9WRVJJRllQRUVS
LCAkdGhpcy0+c3NsX3ZlcmlmeXBlZXIpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BU
X0hFQURFUkZVTkNUSU9OLCBhcnJheSgkdGhpcywgJ2dldEhlYWRlcicpKTsKICAgIGN1cmxf
c2V0b3B0KCRjaSwgQ1VSTE9QVF9IRUFERVIsIEZBTFNFKTsKCiAgICBzd2l0Y2ggKCRtZXRo
b2QpIHsKICAgICAgY2FzZSAnUE9TVCc6CiAgICAgICAgY3VybF9zZXRvcHQoJGNpLCBDVVJM
T1BUX1BPU1QsIFRSVUUpOwogICAgICAgIGlmICghZW1wdHkoJHBvc3RmaWVsZHMpKSB7CiAg
ICAgICAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfUE9TVEZJRUxEUywgJHBvc3RmaWVs
ZHMpOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgY2FzZSAnREVMRVRFJzoKICAg
ICAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfQ1VTVE9NUkVRVUVTVCwgJ0RFTEVURScp
OwogICAgICAgIGlmICghZW1wdHkoJHBvc3RmaWVsZHMpKSB7CiAgICAgICAgICAkdXJsID0g
InskdXJsfT97JHBvc3RmaWVsZHN9IjsKICAgICAgICB9CiAgICB9CgogICAgY3VybF9zZXRv
cHQoJGNpLCBDVVJMT1BUX1VSTCwgJHVybCk7CiAgICAkcmVzcG9uc2UgPSBjdXJsX2V4ZWMo
JGNpKTsKICAgICR0aGlzLT5odHRwX2NvZGUgPSBjdXJsX2dldGluZm8oJGNpLCBDVVJMSU5G
T19IVFRQX0NPREUpOwogICAgJHRoaXMtPmh0dHBfaW5mbyA9IGFycmF5X21lcmdlKCR0aGlz
LT5odHRwX2luZm8sIGN1cmxfZ2V0aW5mbygkY2kpKTsKICAgICR0aGlzLT51cmwgPSAkdXJs
OwogICAgY3VybF9jbG9zZSAoJGNpKTsKICAgIHJldHVybiAkcmVzcG9uc2U7CiAgfQoKICAv
KioKICAgKiBHZXQgdGhlIGhlYWRlciBpbmZvIHRvIHN0b3JlLgogICAqLwogIGZ1bmN0aW9u
IGdldEhlYWRlcigkY2gsICRoZWFkZXIpIHsKICAgICRpID0gc3RycG9zKCRoZWFkZXIsICc6
Jyk7CiAgICBpZiAoIWVtcHR5KCRpKSkgewogICAgICAka2V5ID0gc3RyX3JlcGxhY2UoJy0n
LCAnXycsIHN0cnRvbG93ZXIoc3Vic3RyKCRoZWFkZXIsIDAsICRpKSkpOwogICAgICAkdmFs
dWUgPSB0cmltKHN1YnN0cigkaGVhZGVyLCAkaSArIDIpKTsKICAgICAgJHRoaXMtPmh0dHBf
aGVhZGVyWyRrZXldID0gJHZhbHVlOwogICAgfQogICAgcmV0dXJuIHN0cmxlbigkaGVhZGVy
KTsKICB9Cn0KCmNsYXNzIE9BdXRoRXhjZXB0aW9uIGV4dGVuZHMgRXhjZXB0aW9uIHsKICAv
LyBwYXNzCn0KCmNsYXNzIE9BdXRoQ29uc3VtZXIgewogIHB1YmxpYyAka2V5OwogIHB1Ymxp
YyAkc2VjcmV0OwoKICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgka2V5LCAkc2VjcmV0LCAkY2Fs
bGJhY2tfdXJsPU5VTEwpIHsKICAgICR0aGlzLT5rZXkgPSAka2V5OwogICAgJHRoaXMtPnNl
Y3JldCA9ICRzZWNyZXQ7CiAgICAkdGhpcy0+Y2FsbGJhY2tfdXJsID0gJGNhbGxiYWNrX3Vy
bDsKICB9CgogIGZ1bmN0aW9uIF9fdG9TdHJpbmcoKSB7CiAgICByZXR1cm4gIk9BdXRoQ29u
c3VtZXJba2V5PSR0aGlzLT5rZXksc2VjcmV0PSR0aGlzLT5zZWNyZXRdIjsKICB9Cn0KCmNs
YXNzIE9BdXRoVG9rZW4gewogIC8vIGFjY2VzcyB0b2tlbnMgYW5kIHJlcXVlc3QgdG9rZW5z
CiAgcHVibGljICRrZXk7CiAgcHVibGljICRzZWNyZXQ7CgogIC8qKgogICAqIGtleSA9IHRo
ZSB0b2tlbgogICAqIHNlY3JldCA9IHRoZSB0b2tlbiBzZWNyZXQKICAgKi8KICBmdW5jdGlv
biBfX2NvbnN0cnVjdCgka2V5LCAkc2VjcmV0KSB7CiAgICAkdGhpcy0+a2V5ID0gJGtleTsK
ICAgICR0aGlzLT5zZWNyZXQgPSAkc2VjcmV0OwogIH0KCiAgLyoqCiAgICogZ2VuZXJhdGVz
IHRoZSBiYXNpYyBzdHJpbmcgc2VyaWFsaXphdGlvbiBvZiBhIHRva2VuIHRoYXQgYSBzZXJ2
ZXIKICAgKiB3b3VsZCByZXNwb25kIHRvIHJlcXVlc3RfdG9rZW4gYW5kIGFjY2Vzc190b2tl
biBjYWxscyB3aXRoCiAgICovCiAgZnVuY3Rpb24gdG9fc3RyaW5nKCkgewogICAgcmV0dXJu
ICJvYXV0aF90b2tlbj0iIC4KICAgICAgICAgICBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMz
OTg2KCR0aGlzLT5rZXkpIC4KICAgICAgICAgICAiJm9hdXRoX3Rva2VuX3NlY3JldD0iIC4K
ICAgICAgICAgICBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCR0aGlzLT5zZWNyZXQp
OwogIH0KCiAgZnVuY3Rpb24gX190b1N0cmluZygpIHsKICAgIHJldHVybiAkdGhpcy0+dG9f
c3RyaW5nKCk7CiAgfQp9CgovKioKICogQSBjbGFzcyBmb3IgaW1wbGVtZW50aW5nIGEgU2ln
bmF0dXJlIE1ldGhvZAogKiBTZWUgc2VjdGlvbiA5ICgiU2lnbmluZyBSZXF1ZXN0cyIpIGlu
IHRoZSBzcGVjCiAqLwphYnN0cmFjdCBjbGFzcyBPQXV0aFNpZ25hdHVyZU1ldGhvZCB7CiAg
LyoqCiAgICogTmVlZHMgdG8gcmV0dXJuIHRoZSBuYW1lIG9mIHRoZSBTaWduYXR1cmUgTWV0
aG9kIChpZSBITUFDLVNIQTEpCiAgICogQHJldHVybiBzdHJpbmcKICAgKi8KICBhYnN0cmFj
dCBwdWJsaWMgZnVuY3Rpb24gZ2V0X25hbWUoKTsKCiAgLyoqCiAgICogQnVpbGQgdXAgdGhl
IHNpZ25hdHVyZQogICAqIE5PVEU6IFRoZSBvdXRwdXQgb2YgdGhpcyBmdW5jdGlvbiBNVVNU
IE5PVCBiZSB1cmxlbmNvZGVkLgogICAqIHRoZSBlbmNvZGluZyBpcyBoYW5kbGVkIGluIE9B
dXRoUmVxdWVzdCB3aGVuIHRoZSBmaW5hbAogICAqIHJlcXVlc3QgaXMgc2VyaWFsaXplZAog
ICAqIEBwYXJhbSBPQXV0aFJlcXVlc3QgJHJlcXVlc3QKICAgKiBAcGFyYW0gT0F1dGhDb25z
dW1lciAkY29uc3VtZXIKICAgKiBAcGFyYW0gT0F1dGhUb2tlbiAkdG9rZW4KICAgKiBAcmV0
dXJuIHN0cmluZwogICAqLwogIGFic3RyYWN0IHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWdu
YXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKTsKCiAgLyoqCiAgICogVmVyaWZp
ZXMgdGhhdCBhIGdpdmVuIHNpZ25hdHVyZSBpcyBjb3JyZWN0CiAgICogQHBhcmFtIE9BdXRo
UmVxdWVzdCAkcmVxdWVzdAogICAqIEBwYXJhbSBPQXV0aENvbnN1bWVyICRjb25zdW1lcgog
ICAqIEBwYXJhbSBPQXV0aFRva2VuICR0b2tlbgogICAqIEBwYXJhbSBzdHJpbmcgJHNpZ25h
dHVyZQogICAqIEByZXR1cm4gYm9vbAogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBjaGVja19z
aWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuLCAkc2lnbmF0dXJlKSB7CiAg
ICAkYnVpbHQgPSAkdGhpcy0+YnVpbGRfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIs
ICR0b2tlbik7CiAgICByZXR1cm4gJGJ1aWx0ID09ICRzaWduYXR1cmU7CiAgfQp9CgovKioK
ICogVGhlIEhNQUMtU0hBMSBzaWduYXR1cmUgbWV0aG9kIHVzZXMgdGhlIEhNQUMtU0hBMSBz
aWduYXR1cmUgYWxnb3JpdGhtIGFzIGRlZmluZWQgaW4gW1JGQzIxMDRdCiAqIHdoZXJlIHRo
ZSBTaWduYXR1cmUgQmFzZSBTdHJpbmcgaXMgdGhlIHRleHQgYW5kIHRoZSBrZXkgaXMgdGhl
IGNvbmNhdGVuYXRlZCB2YWx1ZXMgKGVhY2ggZmlyc3QKICogZW5jb2RlZCBwZXIgUGFyYW1l
dGVyIEVuY29kaW5nKSBvZiB0aGUgQ29uc3VtZXIgU2VjcmV0IGFuZCBUb2tlbiBTZWNyZXQs
IHNlcGFyYXRlZCBieSBhbiAnJicKICogY2hhcmFjdGVyIChBU0NJSSBjb2RlIDM4KSBldmVu
IGlmIGVtcHR5LgogKiAgIC0gQ2hhcHRlciA5LjIgKCJITUFDLVNIQTEiKQogKi8KY2xhc3Mg
T0F1dGhTaWduYXR1cmVNZXRob2RfSE1BQ19TSEExIGV4dGVuZHMgT0F1dGhTaWduYXR1cmVN
ZXRob2QgewogIGZ1bmN0aW9uIGdldF9uYW1lKCkgewogICAgcmV0dXJuICJITUFDLVNIQTEi
OwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNv
bnN1bWVyLCAkdG9rZW4pIHsKICAgICRiYXNlX3N0cmluZyA9ICRyZXF1ZXN0LT5nZXRfc2ln
bmF0dXJlX2Jhc2Vfc3RyaW5nKCk7CiAgICAkcmVxdWVzdC0+YmFzZV9zdHJpbmcgPSAkYmFz
ZV9zdHJpbmc7CgogICAgJGtleV9wYXJ0cyA9IGFycmF5KAogICAgICAkY29uc3VtZXItPnNl
Y3JldCwKICAgICAgKCR0b2tlbikgPyAkdG9rZW4tPnNlY3JldCA6ICIiCiAgICApOwoKICAg
ICRrZXlfcGFydHMgPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCRrZXlfcGFydHMp
OwogICAgJGtleSA9IGltcGxvZGUoJyYnLCAka2V5X3BhcnRzKTsKCiAgICByZXR1cm4gYmFz
ZTY0X2VuY29kZShoYXNoX2htYWMoJ3NoYTEnLCAkYmFzZV9zdHJpbmcsICRrZXksIHRydWUp
KTsKICB9Cn0KCi8qKgogKiBUaGUgUExBSU5URVhUIG1ldGhvZCBkb2VzIG5vdCBwcm92aWRl
IGFueSBzZWN1cml0eSBwcm90ZWN0aW9uIGFuZCBTSE9VTEQgb25seSBiZSB1c2VkCiAqIG92
ZXIgYSBzZWN1cmUgY2hhbm5lbCBzdWNoIGFzIEhUVFBTLiBJdCBkb2VzIG5vdCB1c2UgdGhl
IFNpZ25hdHVyZSBCYXNlIFN0cmluZy4KICogICAtIENoYXB0ZXIgOS40ICgiUExBSU5URVhU
IikKICovCmNsYXNzIE9BdXRoU2lnbmF0dXJlTWV0aG9kX1BMQUlOVEVYVCBleHRlbmRzIE9B
dXRoU2lnbmF0dXJlTWV0aG9kIHsKICBwdWJsaWMgZnVuY3Rpb24gZ2V0X25hbWUoKSB7CiAg
ICByZXR1cm4gIlBMQUlOVEVYVCI7CiAgfQoKICAvKioKICAgKiBvYXV0aF9zaWduYXR1cmUg
aXMgc2V0IHRvIHRoZSBjb25jYXRlbmF0ZWQgZW5jb2RlZCB2YWx1ZXMgb2YgdGhlIENvbnN1
bWVyIFNlY3JldCBhbmQKICAgKiBUb2tlbiBTZWNyZXQsIHNlcGFyYXRlZCBieSBhICcmJyBj
aGFyYWN0ZXIgKEFTQ0lJIGNvZGUgMzgpLCBldmVuIGlmIGVpdGhlciBzZWNyZXQgaXMKICAg
KiBlbXB0eS4gVGhlIHJlc3VsdCBNVVNUIGJlIGVuY29kZWQgYWdhaW4uCiAgICogICAtIENo
YXB0ZXIgOS40LjEgKCJHZW5lcmF0aW5nIFNpZ25hdHVyZXMiKQogICAqCiAgICogUGxlYXNl
IG5vdGUgdGhhdCB0aGUgc2Vjb25kIGVuY29kaW5nIE1VU1QgTk9UIGhhcHBlbiBpbiB0aGUg
U2lnbmF0dXJlTWV0aG9kLCBhcwogICAqIE9BdXRoUmVxdWVzdCBoYW5kbGVzIHRoaXMhCiAg
ICovCiAgcHVibGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1
bWVyLCAkdG9rZW4pIHsKICAgICRrZXlfcGFydHMgPSBhcnJheSgKICAgICAgJGNvbnN1bWVy
LT5zZWNyZXQsCiAgICAgICgkdG9rZW4pID8gJHRva2VuLT5zZWNyZXQgOiAiIgogICAgKTsK
CiAgICAka2V5X3BhcnRzID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4Nigka2V5X3Bh
cnRzKTsKICAgICRrZXkgPSBpbXBsb2RlKCcmJywgJGtleV9wYXJ0cyk7CiAgICAkcmVxdWVz
dC0+YmFzZV9zdHJpbmcgPSAka2V5OwoKICAgIHJldHVybiAka2V5OwogIH0KfQoKLyoqCiAq
IFRoZSBSU0EtU0hBMSBzaWduYXR1cmUgbWV0aG9kIHVzZXMgdGhlIFJTQVNTQS1QS0NTMS12
MV81IHNpZ25hdHVyZSBhbGdvcml0aG0gYXMgZGVmaW5lZCBpbgogKiBbUkZDMzQ0N10gc2Vj
dGlvbiA4LjIgKG1vcmUgc2ltcGx5IGtub3duIGFzIFBLQ1MjMSksIHVzaW5nIFNIQS0xIGFz
IHRoZSBoYXNoIGZ1bmN0aW9uIGZvcgogKiBFTVNBLVBLQ1MxLXYxXzUuIEl0IGlzIGFzc3Vt
ZWQgdGhhdCB0aGUgQ29uc3VtZXIgaGFzIHByb3ZpZGVkIGl0cyBSU0EgcHVibGljIGtleSBp
biBhCiAqIHZlcmlmaWVkIHdheSB0byB0aGUgU2VydmljZSBQcm92aWRlciwgaW4gYSBtYW5u
ZXIgd2hpY2ggaXMgYmV5b25kIHRoZSBzY29wZSBvZiB0aGlzCiAqIHNwZWNpZmljYXRpb24u
CiAqICAgLSBDaGFwdGVyIDkuMyAoIlJTQS1TSEExIikKICovCmFic3RyYWN0IGNsYXNzIE9B
dXRoU2lnbmF0dXJlTWV0aG9kX1JTQV9TSEExIGV4dGVuZHMgT0F1dGhTaWduYXR1cmVNZXRo
b2QgewogIHB1YmxpYyBmdW5jdGlvbiBnZXRfbmFtZSgpIHsKICAgIHJldHVybiAiUlNBLVNI
QTEiOwogIH0KCiAgLy8gVXAgdG8gdGhlIFNQIHRvIGltcGxlbWVudCB0aGlzIGxvb2t1cCBv
ZiBrZXlzLiBQb3NzaWJsZSBpZGVhcyBhcmU6CiAgLy8gKDEpIGRvIGEgbG9va3VwIGluIGEg
dGFibGUgb2YgdHJ1c3RlZCBjZXJ0cyBrZXllZCBvZmYgb2YgY29uc3VtZXIKICAvLyAoMikg
ZmV0Y2ggdmlhIGh0dHAgdXNpbmcgYSB1cmwgcHJvdmlkZWQgYnkgdGhlIHJlcXVlc3Rlcgog
IC8vICgzKSBzb21lIHNvcnQgb2Ygc3BlY2lmaWMgZGlzY292ZXJ5IGNvZGUgYmFzZWQgb24g
cmVxdWVzdAogIC8vCiAgLy8gRWl0aGVyIHdheSBzaG91bGQgcmV0dXJuIGEgc3RyaW5nIHJl
cHJlc2VudGF0aW9uIG9mIHRoZSBjZXJ0aWZpY2F0ZQogIHByb3RlY3RlZCBhYnN0cmFjdCBm
dW5jdGlvbiBmZXRjaF9wdWJsaWNfY2VydCgmJHJlcXVlc3QpOwoKICAvLyBVcCB0byB0aGUg
U1AgdG8gaW1wbGVtZW50IHRoaXMgbG9va3VwIG9mIGtleXMuIFBvc3NpYmxlIGlkZWFzIGFy
ZToKICAvLyAoMSkgZG8gYSBsb29rdXAgaW4gYSB0YWJsZSBvZiB0cnVzdGVkIGNlcnRzIGtl
eWVkIG9mZiBvZiBjb25zdW1lcgogIC8vCiAgLy8gRWl0aGVyIHdheSBzaG91bGQgcmV0dXJu
IGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBjZXJ0aWZpY2F0ZQogIHByb3RlY3Rl
ZCBhYnN0cmFjdCBmdW5jdGlvbiBmZXRjaF9wcml2YXRlX2NlcnQoJiRyZXF1ZXN0KTsKCiAg
cHVibGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAk
dG9rZW4pIHsKICAgICRiYXNlX3N0cmluZyA9ICRyZXF1ZXN0LT5nZXRfc2lnbmF0dXJlX2Jh
c2Vfc3RyaW5nKCk7CiAgICAkcmVxdWVzdC0+YmFzZV9zdHJpbmcgPSAkYmFzZV9zdHJpbmc7
CgogICAgLy8gRmV0Y2ggdGhlIHByaXZhdGUga2V5IGNlcnQgYmFzZWQgb24gdGhlIHJlcXVl
c3QKICAgICRjZXJ0ID0gJHRoaXMtPmZldGNoX3ByaXZhdGVfY2VydCgkcmVxdWVzdCk7Cgog
ICAgLy8gUHVsbCB0aGUgcHJpdmF0ZSBrZXkgSUQgZnJvbSB0aGUgY2VydGlmaWNhdGUKICAg
ICRwcml2YXRla2V5aWQgPSBvcGVuc3NsX2dldF9wcml2YXRla2V5KCRjZXJ0KTsKCiAgICAv
LyBTaWduIHVzaW5nIHRoZSBrZXkKICAgICRvayA9IG9wZW5zc2xfc2lnbigkYmFzZV9zdHJp
bmcsICRzaWduYXR1cmUsICRwcml2YXRla2V5aWQpOwoKICAgIC8vIFJlbGVhc2UgdGhlIGtl
eSByZXNvdXJjZQogICAgb3BlbnNzbF9mcmVlX2tleSgkcHJpdmF0ZWtleWlkKTsKCiAgICBy
ZXR1cm4gYmFzZTY0X2VuY29kZSgkc2lnbmF0dXJlKTsKICB9CgogIHB1YmxpYyBmdW5jdGlv
biBjaGVja19zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuLCAkc2lnbmF0
dXJlKSB7CiAgICAkZGVjb2RlZF9zaWcgPSBiYXNlNjRfZGVjb2RlKCRzaWduYXR1cmUpOwoK
ICAgICRiYXNlX3N0cmluZyA9ICRyZXF1ZXN0LT5nZXRfc2lnbmF0dXJlX2Jhc2Vfc3RyaW5n
KCk7CgogICAgLy8gRmV0Y2ggdGhlIHB1YmxpYyBrZXkgY2VydCBiYXNlZCBvbiB0aGUgcmVx
dWVzdAogICAgJGNlcnQgPSAkdGhpcy0+ZmV0Y2hfcHVibGljX2NlcnQoJHJlcXVlc3QpOwoK
ICAgIC8vIFB1bGwgdGhlIHB1YmxpYyBrZXkgSUQgZnJvbSB0aGUgY2VydGlmaWNhdGUKICAg
ICRwdWJsaWNrZXlpZCA9IG9wZW5zc2xfZ2V0X3B1YmxpY2tleSgkY2VydCk7CgogICAgLy8g
Q2hlY2sgdGhlIGNvbXB1dGVkIHNpZ25hdHVyZSBhZ2FpbnN0IHRoZSBvbmUgcGFzc2VkIGlu
IHRoZSBxdWVyeQogICAgJG9rID0gb3BlbnNzbF92ZXJpZnkoJGJhc2Vfc3RyaW5nLCAkZGVj
b2RlZF9zaWcsICRwdWJsaWNrZXlpZCk7CgogICAgLy8gUmVsZWFzZSB0aGUga2V5IHJlc291
cmNlCiAgICBvcGVuc3NsX2ZyZWVfa2V5KCRwdWJsaWNrZXlpZCk7CgogICAgcmV0dXJuICRv
ayA9PSAxOwogIH0KfQoKY2xhc3MgT0F1dGhSZXF1ZXN0IHsKICBwcml2YXRlICRwYXJhbWV0
ZXJzOwogIHByaXZhdGUgJGh0dHBfbWV0aG9kOwogIHByaXZhdGUgJGh0dHBfdXJsOwogIC8v
IGZvciBkZWJ1ZyBwdXJwb3NlcwogIHB1YmxpYyAkYmFzZV9zdHJpbmc7CiAgcHVibGljIHN0
YXRpYyAkdmVyc2lvbiA9ICcxLjAnOwogIHB1YmxpYyBzdGF0aWMgJFBPU1RfSU5QVVQgPSAn
cGhwOi8vaW5wdXQnOwoKICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkaHR0cF9tZXRob2QsICRo
dHRwX3VybCwgJHBhcmFtZXRlcnM9TlVMTCkgewogICAgQCRwYXJhbWV0ZXJzIG9yICRwYXJh
bWV0ZXJzID0gYXJyYXkoKTsKICAgICRwYXJhbWV0ZXJzID0gYXJyYXlfbWVyZ2UoIE9BdXRo
VXRpbDo6cGFyc2VfcGFyYW1ldGVycyhwYXJzZV91cmwoJGh0dHBfdXJsLCBQSFBfVVJMX1FV
RVJZKSksICRwYXJhbWV0ZXJzKTsKICAgICR0aGlzLT5wYXJhbWV0ZXJzID0gJHBhcmFtZXRl
cnM7CiAgICAkdGhpcy0+aHR0cF9tZXRob2QgPSAkaHR0cF9tZXRob2Q7CiAgICAkdGhpcy0+
aHR0cF91cmwgPSAkaHR0cF91cmw7CiAgfQoKCiAgLyoqCiAgICogYXR0ZW1wdCB0byBidWls
ZCB1cCBhIHJlcXVlc3QgZnJvbSB3aGF0IHdhcyBwYXNzZWQgdG8gdGhlIHNlcnZlcgogICAq
LwogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZnJvbV9yZXF1ZXN0KCRodHRwX21ldGhvZD1O
VUxMLCAkaHR0cF91cmw9TlVMTCwgJHBhcmFtZXRlcnM9TlVMTCkgewogICAgJHNjaGVtZSA9
ICghaXNzZXQoJF9TRVJWRVJbJ0hUVFBTJ10pIHx8ICRfU0VSVkVSWydIVFRQUyddICE9ICJv
biIpCiAgICAgICAgICAgICAgPyAnaHR0cCcKICAgICAgICAgICAgICA6ICdodHRwcyc7CiAg
ICBAJGh0dHBfdXJsIG9yICRodHRwX3VybCA9ICRzY2hlbWUgLgogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAnOi8vJyAuICRfU0VSVkVSWydIVFRQX0hPU1QnXSAuCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICc6JyAuCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICRfU0VSVkVSWydTRVJWRVJfUE9SVCddIC4KICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ107CiAgICBAJGh0dHBfbWV0aG9kIG9yICRo
dHRwX21ldGhvZCA9ICRfU0VSVkVSWydSRVFVRVNUX01FVEhPRCddOwoKICAgIC8vIFdlIHdl
cmVuJ3QgaGFuZGVkIGFueSBwYXJhbWV0ZXJzLCBzbyBsZXQncyBmaW5kIHRoZSBvbmVzIHJl
bGV2YW50IHRvCiAgICAvLyB0aGlzIHJlcXVlc3QuCiAgICAvLyBJZiB5b3UgcnVuIFhNTC1S
UEMgb3Igc2ltaWxhciB5b3Ugc2hvdWxkIHVzZSB0aGlzIHRvIHByb3ZpZGUgeW91ciBvd24K
ICAgIC8vIHBhcnNlZCBwYXJhbWV0ZXItbGlzdAogICAgaWYgKCEkcGFyYW1ldGVycykgewog
ICAgICAvLyBGaW5kIHJlcXVlc3QgaGVhZGVycwogICAgICAkcmVxdWVzdF9oZWFkZXJzID0g
T0F1dGhVdGlsOjpnZXRfaGVhZGVycygpOwoKICAgICAgLy8gUGFyc2UgdGhlIHF1ZXJ5LXN0
cmluZyB0byBmaW5kIEdFVCBwYXJhbWV0ZXJzCiAgICAgICRwYXJhbWV0ZXJzID0gT0F1dGhV
dGlsOjpwYXJzZV9wYXJhbWV0ZXJzKCRfU0VSVkVSWydRVUVSWV9TVFJJTkcnXSk7CgogICAg
ICAvLyBJdCdzIGEgUE9TVCByZXF1ZXN0IG9mIHRoZSBwcm9wZXIgY29udGVudC10eXBlLCBz
byBwYXJzZSBQT1NUCiAgICAgIC8vIHBhcmFtZXRlcnMgYW5kIGFkZCB0aG9zZSBvdmVycmlk
aW5nIGFueSBkdXBsaWNhdGVzIGZyb20gR0VUCiAgICAgIGlmICgkaHR0cF9tZXRob2QgPT0g
IlBPU1QiCiAgICAgICAgICAmJiBAc3Ryc3RyKCRyZXF1ZXN0X2hlYWRlcnNbIkNvbnRlbnQt
VHlwZSJdLAogICAgICAgICAgICAgICAgICAgICAiYXBwbGljYXRpb24veC13d3ctZm9ybS11
cmxlbmNvZGVkIikKICAgICAgICAgICkgewogICAgICAgICRwb3N0X2RhdGEgPSBPQXV0aFV0
aWw6OnBhcnNlX3BhcmFtZXRlcnMoCiAgICAgICAgICBmaWxlX2dldF9jb250ZW50cyhzZWxm
OjokUE9TVF9JTlBVVCkKICAgICAgICApOwogICAgICAgICRwYXJhbWV0ZXJzID0gYXJyYXlf
bWVyZ2UoJHBhcmFtZXRlcnMsICRwb3N0X2RhdGEpOwogICAgICB9CgogICAgICAvLyBXZSBo
YXZlIGEgQXV0aG9yaXphdGlvbi1oZWFkZXIgd2l0aCBPQXV0aCBkYXRhLiBQYXJzZSB0aGUg
aGVhZGVyCiAgICAgIC8vIGFuZCBhZGQgdGhvc2Ugb3ZlcnJpZGluZyBhbnkgZHVwbGljYXRl
cyBmcm9tIEdFVCBvciBQT1NUCiAgICAgIGlmIChAc3Vic3RyKCRyZXF1ZXN0X2hlYWRlcnNb
J0F1dGhvcml6YXRpb24nXSwgMCwgNikgPT0gIk9BdXRoICIpIHsKICAgICAgICAkaGVhZGVy
X3BhcmFtZXRlcnMgPSBPQXV0aFV0aWw6OnNwbGl0X2hlYWRlcigKICAgICAgICAgICRyZXF1
ZXN0X2hlYWRlcnNbJ0F1dGhvcml6YXRpb24nXQogICAgICAgICk7CiAgICAgICAgJHBhcmFt
ZXRlcnMgPSBhcnJheV9tZXJnZSgkcGFyYW1ldGVycywgJGhlYWRlcl9wYXJhbWV0ZXJzKTsK
ICAgICAgfQoKICAgIH0KCiAgICByZXR1cm4gbmV3IE9BdXRoUmVxdWVzdCgkaHR0cF9tZXRo
b2QsICRodHRwX3VybCwgJHBhcmFtZXRlcnMpOwogIH0KCiAgLyoqCiAgICogcHJldHR5IG11
Y2ggYSBoZWxwZXIgZnVuY3Rpb24gdG8gc2V0IHVwIHRoZSByZXF1ZXN0CiAgICovCiAgcHVi
bGljIHN0YXRpYyBmdW5jdGlvbiBmcm9tX2NvbnN1bWVyX2FuZF90b2tlbigkY29uc3VtZXIs
ICR0b2tlbiwgJGh0dHBfbWV0aG9kLCAkaHR0cF91cmwsICRwYXJhbWV0ZXJzPU5VTEwpIHsK
ICAgIEAkcGFyYW1ldGVycyBvciAkcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICAkZGVmYXVs
dHMgPSBhcnJheSgib2F1dGhfdmVyc2lvbiIgPT4gT0F1dGhSZXF1ZXN0OjokdmVyc2lvbiwK
ICAgICAgICAgICAgICAgICAgICAgICJvYXV0aF9ub25jZSIgPT4gT0F1dGhSZXF1ZXN0Ojpn
ZW5lcmF0ZV9ub25jZSgpLAogICAgICAgICAgICAgICAgICAgICAgIm9hdXRoX3RpbWVzdGFt
cCIgPT4gT0F1dGhSZXF1ZXN0OjpnZW5lcmF0ZV90aW1lc3RhbXAoKSwKICAgICAgICAgICAg
ICAgICAgICAgICJvYXV0aF9jb25zdW1lcl9rZXkiID0+ICRjb25zdW1lci0+a2V5KTsKICAg
IGlmICgkdG9rZW4pCiAgICAgICRkZWZhdWx0c1snb2F1dGhfdG9rZW4nXSA9ICR0b2tlbi0+
a2V5OwoKICAgICRwYXJhbWV0ZXJzID0gYXJyYXlfbWVyZ2UoJGRlZmF1bHRzLCAkcGFyYW1l
dGVycyk7CgogICAgcmV0dXJuIG5ldyBPQXV0aFJlcXVlc3QoJGh0dHBfbWV0aG9kLCAkaHR0
cF91cmwsICRwYXJhbWV0ZXJzKTsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBzZXRfcGFyYW1l
dGVyKCRuYW1lLCAkdmFsdWUsICRhbGxvd19kdXBsaWNhdGVzID0gdHJ1ZSkgewogICAgaWYg
KCRhbGxvd19kdXBsaWNhdGVzICYmIGlzc2V0KCR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSkp
IHsKICAgICAgLy8gV2UgaGF2ZSBhbHJlYWR5IGFkZGVkIHBhcmFtZXRlcihzKSB3aXRoIHRo
aXMgbmFtZSwgc28gYWRkIHRvIHRoZSBsaXN0CiAgICAgIGlmIChpc19zY2FsYXIoJHRoaXMt
PnBhcmFtZXRlcnNbJG5hbWVdKSkgewogICAgICAgIC8vIFRoaXMgaXMgdGhlIGZpcnN0IGR1
cGxpY2F0ZSwgc28gdHJhbnNmb3JtIHNjYWxhciAoc3RyaW5nKQogICAgICAgIC8vIGludG8g
YW4gYXJyYXkgc28gd2UgY2FuIGFkZCB0aGUgZHVwbGljYXRlcwogICAgICAgICR0aGlzLT5w
YXJhbWV0ZXJzWyRuYW1lXSA9IGFycmF5KCR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSk7CiAg
ICAgIH0KCiAgICAgICR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXVtdID0gJHZhbHVlOwogICAg
fSBlbHNlIHsKICAgICAgJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdID0gJHZhbHVlOwogICAg
fQogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGdldF9wYXJhbWV0ZXIoJG5hbWUpIHsKICAgIHJl
dHVybiBpc3NldCgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pID8gJHRoaXMtPnBhcmFtZXRl
cnNbJG5hbWVdIDogbnVsbDsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBnZXRfcGFyYW1ldGVy
cygpIHsKICAgIHJldHVybiAkdGhpcy0+cGFyYW1ldGVyczsKICB9CgogIHB1YmxpYyBmdW5j
dGlvbiB1bnNldF9wYXJhbWV0ZXIoJG5hbWUpIHsKICAgIHVuc2V0KCR0aGlzLT5wYXJhbWV0
ZXJzWyRuYW1lXSk7CiAgfQoKICAvKioKICAgKiBUaGUgcmVxdWVzdCBwYXJhbWV0ZXJzLCBz
b3J0ZWQgYW5kIGNvbmNhdGVuYXRlZCBpbnRvIGEgbm9ybWFsaXplZCBzdHJpbmcuCiAgICog
QHJldHVybiBzdHJpbmcKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZ2V0X3NpZ25hYmxlX3Bh
cmFtZXRlcnMoKSB7CiAgICAvLyBHcmFiIGFsbCBwYXJhbWV0ZXJzCiAgICAkcGFyYW1zID0g
JHRoaXMtPnBhcmFtZXRlcnM7CgogICAgLy8gUmVtb3ZlIG9hdXRoX3NpZ25hdHVyZSBpZiBw
cmVzZW50CiAgICAvLyBSZWY6IFNwZWM6IDkuMS4xICgiVGhlIG9hdXRoX3NpZ25hdHVyZSBw
YXJhbWV0ZXIgTVVTVCBiZSBleGNsdWRlZC4iKQogICAgaWYgKGlzc2V0KCRwYXJhbXNbJ29h
dXRoX3NpZ25hdHVyZSddKSkgewogICAgICB1bnNldCgkcGFyYW1zWydvYXV0aF9zaWduYXR1
cmUnXSk7CiAgICB9CgogICAgcmV0dXJuIE9BdXRoVXRpbDo6YnVpbGRfaHR0cF9xdWVyeSgk
cGFyYW1zKTsKICB9CgogIC8qKgogICAqIFJldHVybnMgdGhlIGJhc2Ugc3RyaW5nIG9mIHRo
aXMgcmVxdWVzdAogICAqCiAgICogVGhlIGJhc2Ugc3RyaW5nIGRlZmluZWQgYXMgdGhlIG1l
dGhvZCwgdGhlIHVybAogICAqIGFuZCB0aGUgcGFyYW1ldGVycyAobm9ybWFsaXplZCksIGVh
Y2ggdXJsZW5jb2RlZAogICAqIGFuZCB0aGUgY29uY2F0ZWQgd2l0aCAmLgogICAqLwogIHB1
YmxpYyBmdW5jdGlvbiBnZXRfc2lnbmF0dXJlX2Jhc2Vfc3RyaW5nKCkgewogICAgJHBhcnRz
ID0gYXJyYXkoCiAgICAgICR0aGlzLT5nZXRfbm9ybWFsaXplZF9odHRwX21ldGhvZCgpLAog
ICAgICAkdGhpcy0+Z2V0X25vcm1hbGl6ZWRfaHR0cF91cmwoKSwKICAgICAgJHRoaXMtPmdl
dF9zaWduYWJsZV9wYXJhbWV0ZXJzKCkKICAgICk7CgogICAgJHBhcnRzID0gT0F1dGhVdGls
Ojp1cmxlbmNvZGVfcmZjMzk4NigkcGFydHMpOwoKICAgIHJldHVybiBpbXBsb2RlKCcmJywg
JHBhcnRzKTsKICB9CgogIC8qKgogICAqIGp1c3QgdXBwZXJjYXNlcyB0aGUgaHR0cCBtZXRo
b2QKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZ2V0X25vcm1hbGl6ZWRfaHR0cF9tZXRob2Qo
KSB7CiAgICByZXR1cm4gc3RydG91cHBlcigkdGhpcy0+aHR0cF9tZXRob2QpOwogIH0KCiAg
LyoqCiAgICogcGFyc2VzIHRoZSB1cmwgYW5kIHJlYnVpbGRzIGl0IHRvIGJlCiAgICogc2No
ZW1lOi8vaG9zdC9wYXRoCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGdldF9ub3JtYWxpemVk
X2h0dHBfdXJsKCkgewogICAgJHBhcnRzID0gcGFyc2VfdXJsKCR0aGlzLT5odHRwX3VybCk7
CgogICAgJHBvcnQgPSBAJHBhcnRzWydwb3J0J107CiAgICAkc2NoZW1lID0gJHBhcnRzWydz
Y2hlbWUnXTsKICAgICRob3N0ID0gJHBhcnRzWydob3N0J107CiAgICAkcGF0aCA9IEAkcGFy
dHNbJ3BhdGgnXTsKCiAgICAkcG9ydCBvciAkcG9ydCA9ICgkc2NoZW1lID09ICdodHRwcycp
ID8gJzQ0MycgOiAnODAnOwoKICAgIGlmICgoJHNjaGVtZSA9PSAnaHR0cHMnICYmICRwb3J0
ICE9ICc0NDMnKQogICAgICAgIHx8ICgkc2NoZW1lID09ICdodHRwJyAmJiAkcG9ydCAhPSAn
ODAnKSkgewogICAgICAkaG9zdCA9ICIkaG9zdDokcG9ydCI7CiAgICB9CiAgICByZXR1cm4g
IiRzY2hlbWU6Ly8kaG9zdCRwYXRoIjsKICB9CgogIC8qKgogICAqIGJ1aWxkcyBhIHVybCB1
c2FibGUgZm9yIGEgR0VUIHJlcXVlc3QKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gdG9fdXJs
KCkgewogICAgJHBvc3RfZGF0YSA9ICR0aGlzLT50b19wb3N0ZGF0YSgpOwogICAgJG91dCA9
ICR0aGlzLT5nZXRfbm9ybWFsaXplZF9odHRwX3VybCgpOwogICAgaWYgKCRwb3N0X2RhdGEp
IHsKICAgICAgJG91dCAuPSAnPycuJHBvc3RfZGF0YTsKICAgIH0KICAgIHJldHVybiAkb3V0
OwogIH0KCiAgLyoqCiAgICogYnVpbGRzIHRoZSBkYXRhIG9uZSB3b3VsZCBzZW5kIGluIGEg
UE9TVCByZXF1ZXN0CiAgICovCiAgcHVibGljIGZ1bmN0aW9uIHRvX3Bvc3RkYXRhKCkgewog
ICAgcmV0dXJuIE9BdXRoVXRpbDo6YnVpbGRfaHR0cF9xdWVyeSgkdGhpcy0+cGFyYW1ldGVy
cyk7CiAgfQoKICAvKioKICAgKiBidWlsZHMgdGhlIEF1dGhvcml6YXRpb246IGhlYWRlcgog
ICAqLwogIHB1YmxpYyBmdW5jdGlvbiB0b19oZWFkZXIoJHJlYWxtPW51bGwpIHsKICAgICRm
aXJzdCA9IHRydWU7CiAgaWYoJHJlYWxtKSB7CiAgICAgICRvdXQgPSAnQXV0aG9yaXphdGlv
bjogT0F1dGggcmVhbG09IicgLiBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCRyZWFs
bSkgLiAnIic7CiAgICAgICRmaXJzdCA9IGZhbHNlOwogICAgfSBlbHNlCiAgICAgICRvdXQg
PSAnQXV0aG9yaXphdGlvbjogT0F1dGgnOwoKICAgICR0b3RhbCA9IGFycmF5KCk7CiAgICBm
b3JlYWNoICgkdGhpcy0+cGFyYW1ldGVycyBhcyAkayA9PiAkdikgewogICAgICBpZiAoc3Vi
c3RyKCRrLCAwLCA1KSAhPSAib2F1dGgiKSBjb250aW51ZTsKICAgICAgaWYgKGlzX2FycmF5
KCR2KSkgewogICAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbignQXJyYXlzIG5vdCBz
dXBwb3J0ZWQgaW4gaGVhZGVycycpOwogICAgICB9CiAgICAgICRvdXQgLj0gKCRmaXJzdCkg
PyAnICcgOiAnLCc7CiAgICAgICRvdXQgLj0gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4
NigkaykgLgogICAgICAgICAgICAgICc9IicgLgogICAgICAgICAgICAgIE9BdXRoVXRpbDo6
dXJsZW5jb2RlX3JmYzM5ODYoJHYpIC4KICAgICAgICAgICAgICAnIic7CiAgICAgICRmaXJz
dCA9IGZhbHNlOwogICAgfQogICAgcmV0dXJuICRvdXQ7CiAgfQoKICBwdWJsaWMgZnVuY3Rp
b24gX190b1N0cmluZygpIHsKICAgIHJldHVybiAkdGhpcy0+dG9fdXJsKCk7CiAgfQoKCiAg
cHVibGljIGZ1bmN0aW9uIHNpZ25fcmVxdWVzdCgkc2lnbmF0dXJlX21ldGhvZCwgJGNvbnN1
bWVyLCAkdG9rZW4pIHsKICAgICR0aGlzLT5zZXRfcGFyYW1ldGVyKAogICAgICAib2F1dGhf
c2lnbmF0dXJlX21ldGhvZCIsCiAgICAgICRzaWduYXR1cmVfbWV0aG9kLT5nZXRfbmFtZSgp
LAogICAgICBmYWxzZQogICAgKTsKICAgICRzaWduYXR1cmUgPSAkdGhpcy0+YnVpbGRfc2ln
bmF0dXJlKCRzaWduYXR1cmVfbWV0aG9kLCAkY29uc3VtZXIsICR0b2tlbik7CiAgICAkdGhp
cy0+c2V0X3BhcmFtZXRlcigib2F1dGhfc2lnbmF0dXJlIiwgJHNpZ25hdHVyZSwgZmFsc2Up
OwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25hdHVyZSgkc2lnbmF0dXJlX21l
dGhvZCwgJGNvbnN1bWVyLCAkdG9rZW4pIHsKICAgICRzaWduYXR1cmUgPSAkc2lnbmF0dXJl
X21ldGhvZC0+YnVpbGRfc2lnbmF0dXJlKCR0aGlzLCAkY29uc3VtZXIsICR0b2tlbik7CiAg
ICByZXR1cm4gJHNpZ25hdHVyZTsKICB9CgogIC8qKgogICAqIHV0aWwgZnVuY3Rpb246IGN1
cnJlbnQgdGltZXN0YW1wCiAgICovCiAgcHJpdmF0ZSBzdGF0aWMgZnVuY3Rpb24gZ2VuZXJh
dGVfdGltZXN0YW1wKCkgewogICAgcmV0dXJuIHRpbWUoKTsKICB9CgogIC8qKgogICAqIHV0
aWwgZnVuY3Rpb246IGN1cnJlbnQgbm9uY2UKICAgKi8KICBwcml2YXRlIHN0YXRpYyBmdW5j
dGlvbiBnZW5lcmF0ZV9ub25jZSgpIHsKICAgICRtdCA9IG1pY3JvdGltZSgpOwogICAgJHJh
bmQgPSBtdF9yYW5kKCk7CgogICAgcmV0dXJuIG1kNSgkbXQgLiAkcmFuZCk7IC8vIG1kNXMg
bG9vayBuaWNlciB0aGFuIG51bWJlcnMKICB9Cn0KCmNsYXNzIE9BdXRoU2VydmVyIHsKICBw
cm90ZWN0ZWQgJHRpbWVzdGFtcF90aHJlc2hvbGQgPSAzMDA7IC8vIGluIHNlY29uZHMsIGZp
dmUgbWludXRlcwogIHByb3RlY3RlZCAkdmVyc2lvbiA9ICcxLjAnOyAgICAgICAgICAgICAv
LyBoaSBibGFpbmUKICBwcm90ZWN0ZWQgJHNpZ25hdHVyZV9tZXRob2RzID0gYXJyYXkoKTsK
CiAgcHJvdGVjdGVkICRkYXRhX3N0b3JlOwoKICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkZGF0
YV9zdG9yZSkgewogICAgJHRoaXMtPmRhdGFfc3RvcmUgPSAkZGF0YV9zdG9yZTsKICB9Cgog
IHB1YmxpYyBmdW5jdGlvbiBhZGRfc2lnbmF0dXJlX21ldGhvZCgkc2lnbmF0dXJlX21ldGhv
ZCkgewogICAgJHRoaXMtPnNpZ25hdHVyZV9tZXRob2RzWyRzaWduYXR1cmVfbWV0aG9kLT5n
ZXRfbmFtZSgpXSA9CiAgICAgICRzaWduYXR1cmVfbWV0aG9kOwogIH0KCiAgLy8gaGlnaCBs
ZXZlbCBmdW5jdGlvbnMKCiAgLyoqCiAgICogcHJvY2VzcyBhIHJlcXVlc3RfdG9rZW4gcmVx
dWVzdAogICAqIHJldHVybnMgdGhlIHJlcXVlc3QgdG9rZW4gb24gc3VjY2VzcwogICAqLwog
IHB1YmxpYyBmdW5jdGlvbiBmZXRjaF9yZXF1ZXN0X3Rva2VuKCYkcmVxdWVzdCkgewogICAg
JHRoaXMtPmdldF92ZXJzaW9uKCRyZXF1ZXN0KTsKCiAgICAkY29uc3VtZXIgPSAkdGhpcy0+
Z2V0X2NvbnN1bWVyKCRyZXF1ZXN0KTsKCiAgICAvLyBubyB0b2tlbiByZXF1aXJlZCBmb3Ig
dGhlIGluaXRpYWwgdG9rZW4gcmVxdWVzdAogICAgJHRva2VuID0gTlVMTDsKCiAgICAkdGhp
cy0+Y2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7CgogICAg
Ly8gUmV2IEEgY2hhbmdlCiAgICAkY2FsbGJhY2sgPSAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRl
cignb2F1dGhfY2FsbGJhY2snKTsKICAgICRuZXdfdG9rZW4gPSAkdGhpcy0+ZGF0YV9zdG9y
ZS0+bmV3X3JlcXVlc3RfdG9rZW4oJGNvbnN1bWVyLCAkY2FsbGJhY2spOwoKICAgIHJldHVy
biAkbmV3X3Rva2VuOwogIH0KCiAgLyoqCiAgICogcHJvY2VzcyBhbiBhY2Nlc3NfdG9rZW4g
cmVxdWVzdAogICAqIHJldHVybnMgdGhlIGFjY2VzcyB0b2tlbiBvbiBzdWNjZXNzCiAgICov
CiAgcHVibGljIGZ1bmN0aW9uIGZldGNoX2FjY2Vzc190b2tlbigmJHJlcXVlc3QpIHsKICAg
ICR0aGlzLT5nZXRfdmVyc2lvbigkcmVxdWVzdCk7CgogICAgJGNvbnN1bWVyID0gJHRoaXMt
PmdldF9jb25zdW1lcigkcmVxdWVzdCk7CgogICAgLy8gcmVxdWlyZXMgYXV0aG9yaXplZCBy
ZXF1ZXN0IHRva2VuCiAgICAkdG9rZW4gPSAkdGhpcy0+Z2V0X3Rva2VuKCRyZXF1ZXN0LCAk
Y29uc3VtZXIsICJyZXF1ZXN0Iik7CgogICAgJHRoaXMtPmNoZWNrX3NpZ25hdHVyZSgkcmVx
dWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwoKICAgIC8vIFJldiBBIGNoYW5nZQogICAgJHZl
cmlmaWVyID0gJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX3ZlcmlmaWVyJyk7CiAg
ICAkbmV3X3Rva2VuID0gJHRoaXMtPmRhdGFfc3RvcmUtPm5ld19hY2Nlc3NfdG9rZW4oJHRv
a2VuLCAkY29uc3VtZXIsICR2ZXJpZmllcik7CgogICAgcmV0dXJuICRuZXdfdG9rZW47CiAg
fQoKICAvKioKICAgKiB2ZXJpZnkgYW4gYXBpIGNhbGwsIGNoZWNrcyBhbGwgdGhlIHBhcmFt
ZXRlcnMKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gdmVyaWZ5X3JlcXVlc3QoJiRyZXF1ZXN0
KSB7CiAgICAkdGhpcy0+Z2V0X3ZlcnNpb24oJHJlcXVlc3QpOwogICAgJGNvbnN1bWVyID0g
JHRoaXMtPmdldF9jb25zdW1lcigkcmVxdWVzdCk7CiAgICAkdG9rZW4gPSAkdGhpcy0+Z2V0
X3Rva2VuKCRyZXF1ZXN0LCAkY29uc3VtZXIsICJhY2Nlc3MiKTsKICAgICR0aGlzLT5jaGVj
a19zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKTsKICAgIHJldHVybiBh
cnJheSgkY29uc3VtZXIsICR0b2tlbik7CiAgfQoKICAvLyBJbnRlcm5hbHMgZnJvbSBoZXJl
CiAgLyoqCiAgICogdmVyc2lvbiAxCiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBnZXRfdmVy
c2lvbigmJHJlcXVlc3QpIHsKICAgICR2ZXJzaW9uID0gJHJlcXVlc3QtPmdldF9wYXJhbWV0
ZXIoIm9hdXRoX3ZlcnNpb24iKTsKICAgIGlmICghJHZlcnNpb24pIHsKICAgICAgLy8gU2Vy
dmljZSBQcm92aWRlcnMgTVVTVCBhc3N1bWUgdGhlIHByb3RvY29sIHZlcnNpb24gdG8gYmUg
MS4wIGlmIHRoaXMgcGFyYW1ldGVyIGlzIG5vdCBwcmVzZW50LgogICAgICAvLyBDaGFwdGVy
IDcuMCAoIkFjY2Vzc2luZyBQcm90ZWN0ZWQgUmVzc291cmNlcyIpCiAgICAgICR2ZXJzaW9u
ID0gJzEuMCc7CiAgICB9CiAgICBpZiAoJHZlcnNpb24gIT09ICR0aGlzLT52ZXJzaW9uKSB7
CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiT0F1dGggdmVyc2lvbiAnJHZlcnNp
b24nIG5vdCBzdXBwb3J0ZWQiKTsKICAgIH0KICAgIHJldHVybiAkdmVyc2lvbjsKICB9Cgog
IC8qKgogICAqIGZpZ3VyZSBvdXQgdGhlIHNpZ25hdHVyZSB3aXRoIHNvbWUgZGVmYXVsdHMK
ICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGdldF9zaWduYXR1cmVfbWV0aG9kKCYkcmVxdWVz
dCkgewogICAgJHNpZ25hdHVyZV9tZXRob2QgPQogICAgICAgIEAkcmVxdWVzdC0+Z2V0X3Bh
cmFtZXRlcigib2F1dGhfc2lnbmF0dXJlX21ldGhvZCIpOwoKICAgIGlmICghJHNpZ25hdHVy
ZV9tZXRob2QpIHsKICAgICAgLy8gQWNjb3JkaW5nIHRvIGNoYXB0ZXIgNyAoIkFjY2Vzc2lu
ZyBQcm90ZWN0ZWQgUmVzc291cmNlcyIpIHRoZSBzaWduYXR1cmUtbWV0aG9kCiAgICAgIC8v
IHBhcmFtZXRlciBpcyByZXF1aXJlZCwgYW5kIHdlIGNhbid0IGp1c3QgZmFsbGJhY2sgdG8g
UExBSU5URVhUCiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbignTm8gc2lnbmF0dXJl
IG1ldGhvZCBwYXJhbWV0ZXIuIFRoaXMgcGFyYW1ldGVyIGlzIHJlcXVpcmVkJyk7CiAgICB9
CgogICAgaWYgKCFpbl9hcnJheSgkc2lnbmF0dXJlX21ldGhvZCwKICAgICAgICAgICAgICAg
ICAgYXJyYXlfa2V5cygkdGhpcy0+c2lnbmF0dXJlX21ldGhvZHMpKSkgewogICAgICB0aHJv
dyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAgICAgIlNpZ25hdHVyZSBtZXRob2QgJyRzaWdu
YXR1cmVfbWV0aG9kJyBub3Qgc3VwcG9ydGVkICIgLgogICAgICAgICJ0cnkgb25lIG9mIHRo
ZSBmb2xsb3dpbmc6ICIgLgogICAgICAgIGltcGxvZGUoIiwgIiwgYXJyYXlfa2V5cygkdGhp
cy0+c2lnbmF0dXJlX21ldGhvZHMpKQogICAgICApOwogICAgfQogICAgcmV0dXJuICR0aGlz
LT5zaWduYXR1cmVfbWV0aG9kc1skc2lnbmF0dXJlX21ldGhvZF07CiAgfQoKICAvKioKICAg
KiB0cnkgdG8gZmluZCB0aGUgY29uc3VtZXIgZm9yIHRoZSBwcm92aWRlZCByZXF1ZXN0J3Mg
Y29uc3VtZXIga2V5CiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBnZXRfY29uc3VtZXIoJiRy
ZXF1ZXN0KSB7CiAgICAkY29uc3VtZXJfa2V5ID0gQCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVy
KCJvYXV0aF9jb25zdW1lcl9rZXkiKTsKICAgIGlmICghJGNvbnN1bWVyX2tleSkgewogICAg
ICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIkludmFsaWQgY29uc3VtZXIga2V5Iik7CiAg
ICB9CgogICAgJGNvbnN1bWVyID0gJHRoaXMtPmRhdGFfc3RvcmUtPmxvb2t1cF9jb25zdW1l
cigkY29uc3VtZXJfa2V5KTsKICAgIGlmICghJGNvbnN1bWVyKSB7CiAgICAgIHRocm93IG5l
dyBPQXV0aEV4Y2VwdGlvbigiSW52YWxpZCBjb25zdW1lciIpOwogICAgfQoKICAgIHJldHVy
biAkY29uc3VtZXI7CiAgfQoKICAvKioKICAgKiB0cnkgdG8gZmluZCB0aGUgdG9rZW4gZm9y
IHRoZSBwcm92aWRlZCByZXF1ZXN0J3MgdG9rZW4ga2V5CiAgICovCiAgcHJpdmF0ZSBmdW5j
dGlvbiBnZXRfdG9rZW4oJiRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbl90eXBlPSJhY2Nl
c3MiKSB7CiAgICAkdG9rZW5fZmllbGQgPSBAJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29h
dXRoX3Rva2VuJyk7CiAgICAkdG9rZW4gPSAkdGhpcy0+ZGF0YV9zdG9yZS0+bG9va3VwX3Rv
a2VuKAogICAgICAkY29uc3VtZXIsICR0b2tlbl90eXBlLCAkdG9rZW5fZmllbGQKICAgICk7
CiAgICBpZiAoISR0b2tlbikgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIklu
dmFsaWQgJHRva2VuX3R5cGUgdG9rZW46ICR0b2tlbl9maWVsZCIpOwogICAgfQogICAgcmV0
dXJuICR0b2tlbjsKICB9CgogIC8qKgogICAqIGFsbC1pbi1vbmUgZnVuY3Rpb24gdG8gY2hl
Y2sgdGhlIHNpZ25hdHVyZSBvbiBhIHJlcXVlc3QKICAgKiBzaG91bGQgZ3Vlc3MgdGhlIHNp
Z25hdHVyZSBtZXRob2QgYXBwcm9wcmlhdGVseQogICAqLwogIHByaXZhdGUgZnVuY3Rpb24g
Y2hlY2tfc2lnbmF0dXJlKCYkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pIHsKICAgIC8v
IHRoaXMgc2hvdWxkIHByb2JhYmx5IGJlIGluIGEgZGlmZmVyZW50IG1ldGhvZAogICAgJHRp
bWVzdGFtcCA9IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfdGltZXN0YW1wJyk7
CiAgICAkbm9uY2UgPSBAJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX25vbmNlJyk7
CgogICAgJHRoaXMtPmNoZWNrX3RpbWVzdGFtcCgkdGltZXN0YW1wKTsKICAgICR0aGlzLT5j
aGVja19ub25jZSgkY29uc3VtZXIsICR0b2tlbiwgJG5vbmNlLCAkdGltZXN0YW1wKTsKCiAg
ICAkc2lnbmF0dXJlX21ldGhvZCA9ICR0aGlzLT5nZXRfc2lnbmF0dXJlX21ldGhvZCgkcmVx
dWVzdCk7CgogICAgJHNpZ25hdHVyZSA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0
aF9zaWduYXR1cmUnKTsKICAgICR2YWxpZF9zaWcgPSAkc2lnbmF0dXJlX21ldGhvZC0+Y2hl
Y2tfc2lnbmF0dXJlKAogICAgICAkcmVxdWVzdCwKICAgICAgJGNvbnN1bWVyLAogICAgICAk
dG9rZW4sCiAgICAgICRzaWduYXR1cmUKICAgICk7CgogICAgaWYgKCEkdmFsaWRfc2lnKSB7
CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiSW52YWxpZCBzaWduYXR1cmUiKTsK
ICAgIH0KICB9CgogIC8qKgogICAqIGNoZWNrIHRoYXQgdGhlIHRpbWVzdGFtcCBpcyBuZXcg
ZW5vdWdoCiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBjaGVja190aW1lc3RhbXAoJHRpbWVz
dGFtcCkgewogICAgaWYoICEgJHRpbWVzdGFtcCApCiAgICAgIHRocm93IG5ldyBPQXV0aEV4
Y2VwdGlvbigKICAgICAgICAnTWlzc2luZyB0aW1lc3RhbXAgcGFyYW1ldGVyLiBUaGUgcGFy
YW1ldGVyIGlzIHJlcXVpcmVkJwogICAgICApOwoKICAgIC8vIHZlcmlmeSB0aGF0IHRpbWVz
dGFtcCBpcyByZWNlbnRpc2gKICAgICRub3cgPSB0aW1lKCk7CiAgICBpZiAoYWJzKCRub3cg
LSAkdGltZXN0YW1wKSA+ICR0aGlzLT50aW1lc3RhbXBfdGhyZXNob2xkKSB7CiAgICAgIHRo
cm93IG5ldyBPQXV0aEV4Y2VwdGlvbigKICAgICAgICAiRXhwaXJlZCB0aW1lc3RhbXAsIHlv
dXJzICR0aW1lc3RhbXAsIG91cnMgJG5vdyIKICAgICAgKTsKICAgIH0KICB9CgogIC8qKgog
ICAqIGNoZWNrIHRoYXQgdGhlIG5vbmNlIGlzIG5vdCByZXBlYXRlZAogICAqLwogIHByaXZh
dGUgZnVuY3Rpb24gY2hlY2tfbm9uY2UoJGNvbnN1bWVyLCAkdG9rZW4sICRub25jZSwgJHRp
bWVzdGFtcCkgewogICAgaWYoICEgJG5vbmNlICkKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhj
ZXB0aW9uKAogICAgICAgICdNaXNzaW5nIG5vbmNlIHBhcmFtZXRlci4gVGhlIHBhcmFtZXRl
ciBpcyByZXF1aXJlZCcKICAgICAgKTsKCiAgICAvLyB2ZXJpZnkgdGhhdCB0aGUgbm9uY2Ug
aXMgdW5pcXVlaXNoCiAgICAkZm91bmQgPSAkdGhpcy0+ZGF0YV9zdG9yZS0+bG9va3VwX25v
bmNlKAogICAgICAkY29uc3VtZXIsCiAgICAgICR0b2tlbiwKICAgICAgJG5vbmNlLAogICAg
ICAkdGltZXN0YW1wCiAgICApOwogICAgaWYgKCRmb3VuZCkgewogICAgICB0aHJvdyBuZXcg
T0F1dGhFeGNlcHRpb24oIk5vbmNlIGFscmVhZHkgdXNlZDogJG5vbmNlIik7CiAgICB9CiAg
fQoKfQoKY2xhc3MgT0F1dGhEYXRhU3RvcmUgewogIGZ1bmN0aW9uIGxvb2t1cF9jb25zdW1l
cigkY29uc3VtZXJfa2V5KSB7CiAgICAvLyBpbXBsZW1lbnQgbWUKICB9CgogIGZ1bmN0aW9u
IGxvb2t1cF90b2tlbigkY29uc3VtZXIsICR0b2tlbl90eXBlLCAkdG9rZW4pIHsKICAgIC8v
IGltcGxlbWVudCBtZQogIH0KCiAgZnVuY3Rpb24gbG9va3VwX25vbmNlKCRjb25zdW1lciwg
JHRva2VuLCAkbm9uY2UsICR0aW1lc3RhbXApIHsKICAgIC8vIGltcGxlbWVudCBtZQogIH0K
CiAgZnVuY3Rpb24gbmV3X3JlcXVlc3RfdG9rZW4oJGNvbnN1bWVyLCAkY2FsbGJhY2sgPSBu
dWxsKSB7CiAgICAvLyByZXR1cm4gYSBuZXcgdG9rZW4gYXR0YWNoZWQgdG8gdGhpcyBjb25z
dW1lcgogIH0KCiAgZnVuY3Rpb24gbmV3X2FjY2Vzc190b2tlbigkdG9rZW4sICRjb25zdW1l
ciwgJHZlcmlmaWVyID0gbnVsbCkgewogICAgLy8gcmV0dXJuIGEgbmV3IGFjY2VzcyB0b2tl
biBhdHRhY2hlZCB0byB0aGlzIGNvbnN1bWVyCiAgICAvLyBmb3IgdGhlIHVzZXIgYXNzb2Np
YXRlZCB3aXRoIHRoaXMgdG9rZW4gaWYgdGhlIHJlcXVlc3QgdG9rZW4KICAgIC8vIGlzIGF1
dGhvcml6ZWQKICAgIC8vIHNob3VsZCBhbHNvIGludmFsaWRhdGUgdGhlIHJlcXVlc3QgdG9r
ZW4KICB9Cgp9CgpjbGFzcyBPQXV0aFV0aWwgewogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24g
dXJsZW5jb2RlX3JmYzM5ODYoJGlucHV0KSB7CiAgaWYgKGlzX2FycmF5KCRpbnB1dCkpIHsK
ICAgIHJldHVybiBhcnJheV9tYXAoYXJyYXkoJ09BdXRoVXRpbCcsICd1cmxlbmNvZGVfcmZj
Mzk4NicpLCAkaW5wdXQpOwogIH0gZWxzZSBpZiAoaXNfc2NhbGFyKCRpbnB1dCkpIHsKICAg
IHJldHVybiBzdHJfcmVwbGFjZSgKICAgICAgJysnLAogICAgICAnICcsCiAgICAgIHN0cl9y
ZXBsYWNlKCclN0UnLCAnficsIHJhd3VybGVuY29kZSgkaW5wdXQpKQogICAgKTsKICB9IGVs
c2UgewogICAgcmV0dXJuICcnOwogIH0KfQoKCiAgLy8gVGhpcyBkZWNvZGUgZnVuY3Rpb24g
aXNuJ3QgdGFraW5nIGludG8gY29uc2lkZXJhdGlvbiB0aGUgYWJvdmUKICAvLyBtb2RpZmlj
YXRpb25zIHRvIHRoZSBlbmNvZGluZyBwcm9jZXNzLiBIb3dldmVyLCB0aGlzIG1ldGhvZCBk
b2Vzbid0CiAgLy8gc2VlbSB0byBiZSB1c2VkIGFueXdoZXJlIHNvIGxlYXZpbmcgaXQgYXMg
aXMuCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiB1cmxkZWNvZGVfcmZjMzk4Nigkc3RyaW5n
KSB7CiAgICByZXR1cm4gdXJsZGVjb2RlKCRzdHJpbmcpOwogIH0KCiAgLy8gVXRpbGl0eSBm
dW5jdGlvbiBmb3IgdHVybmluZyB0aGUgQXV0aG9yaXphdGlvbjogaGVhZGVyIGludG8KICAv
LyBwYXJhbWV0ZXJzLCBoYXMgdG8gZG8gc29tZSB1bmVzY2FwaW5nCiAgLy8gQ2FuIGZpbHRl
ciBvdXQgYW55IG5vbi1vYXV0aCBwYXJhbWV0ZXJzIGlmIG5lZWRlZCAoZGVmYXVsdCBiZWhh
dmlvdXIpCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBzcGxpdF9oZWFkZXIoJGhlYWRlciwg
JG9ubHlfYWxsb3dfb2F1dGhfcGFyYW1ldGVycyA9IHRydWUpIHsKICAgICRwYXR0ZXJuID0g
Jy8oKFstX2Etel0qKT0oIihbXiJdKikifChbXixdKikpLD8pLyc7CiAgICAkb2Zmc2V0ID0g
MDsKICAgICRwYXJhbXMgPSBhcnJheSgpOwogICAgd2hpbGUgKHByZWdfbWF0Y2goJHBhdHRl
cm4sICRoZWFkZXIsICRtYXRjaGVzLCBQUkVHX09GRlNFVF9DQVBUVVJFLCAkb2Zmc2V0KSA+
IDApIHsKICAgICAgJG1hdGNoID0gJG1hdGNoZXNbMF07CiAgICAgICRoZWFkZXJfbmFtZSA9
ICRtYXRjaGVzWzJdWzBdOwogICAgICAkaGVhZGVyX2NvbnRlbnQgPSAoaXNzZXQoJG1hdGNo
ZXNbNV0pKSA/ICRtYXRjaGVzWzVdWzBdIDogJG1hdGNoZXNbNF1bMF07CiAgICAgIGlmIChw
cmVnX21hdGNoKCcvXm9hdXRoXy8nLCAkaGVhZGVyX25hbWUpIHx8ICEkb25seV9hbGxvd19v
YXV0aF9wYXJhbWV0ZXJzKSB7CiAgICAgICAgJHBhcmFtc1skaGVhZGVyX25hbWVdID0gT0F1
dGhVdGlsOjp1cmxkZWNvZGVfcmZjMzk4NigkaGVhZGVyX2NvbnRlbnQpOwogICAgICB9CiAg
ICAgICRvZmZzZXQgPSAkbWF0Y2hbMV0gKyBzdHJsZW4oJG1hdGNoWzBdKTsKICAgIH0KCiAg
ICBpZiAoaXNzZXQoJHBhcmFtc1sncmVhbG0nXSkpIHsKICAgICAgdW5zZXQoJHBhcmFtc1sn
cmVhbG0nXSk7CiAgICB9CgogICAgcmV0dXJuICRwYXJhbXM7CiAgfQoKICAvLyBoZWxwZXIg
dG8gdHJ5IHRvIHNvcnQgb3V0IGhlYWRlcnMgZm9yIHBlb3BsZSB3aG8gYXJlbid0IHJ1bm5p
bmcgYXBhY2hlCiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBnZXRfaGVhZGVycygpIHsKICAg
IGlmIChmdW5jdGlvbl9leGlzdHMoJ2FwYWNoZV9yZXF1ZXN0X2hlYWRlcnMnKSkgewogICAg
ICAvLyB3ZSBuZWVkIHRoaXMgdG8gZ2V0IHRoZSBhY3R1YWwgQXV0aG9yaXphdGlvbjogaGVh
ZGVyCiAgICAgIC8vIGJlY2F1c2UgYXBhY2hlIHRlbmRzIHRvIHRlbGwgdXMgaXQgZG9lc24n
dCBleGlzdAogICAgICAkaGVhZGVycyA9IGFwYWNoZV9yZXF1ZXN0X2hlYWRlcnMoKTsKCiAg
ICAgIC8vIHNhbml0aXplIHRoZSBvdXRwdXQgb2YgYXBhY2hlX3JlcXVlc3RfaGVhZGVycyBi
ZWNhdXNlCiAgICAgIC8vIHdlIGFsd2F5cyB3YW50IHRoZSBrZXlzIHRvIGJlIENhc2VkLUxp
a2UtVGhpcyBhbmQgYXJoKCkKICAgICAgLy8gcmV0dXJucyB0aGUgaGVhZGVycyBpbiB0aGUg
c2FtZSBjYXNlIGFzIHRoZXkgYXJlIGluIHRoZQogICAgICAvLyByZXF1ZXN0CiAgICAgICRv
dXQgPSBhcnJheSgpOwogICAgICBmb3JlYWNoKCAkaGVhZGVycyBBUyAka2V5ID0+ICR2YWx1
ZSApIHsKICAgICAgICAka2V5ID0gc3RyX3JlcGxhY2UoCiAgICAgICAgICAgICIgIiwKICAg
ICAgICAgICAgIi0iLAogICAgICAgICAgICB1Y3dvcmRzKHN0cnRvbG93ZXIoc3RyX3JlcGxh
Y2UoIi0iLCAiICIsICRrZXkpKSkKICAgICAgICAgICk7CiAgICAgICAgJG91dFska2V5XSA9
ICR2YWx1ZTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgLy8gb3RoZXJ3aXNlIHdlIGRv
bid0IGhhdmUgYXBhY2hlIGFuZCBhcmUganVzdCBnb2luZyB0byBoYXZlIHRvIGhvcGUKICAg
ICAgLy8gdGhhdCAkX1NFUlZFUiBhY3R1YWxseSBjb250YWlucyB3aGF0IHdlIG5lZWQKICAg
ICAgJG91dCA9IGFycmF5KCk7CiAgICAgIGlmKCBpc3NldCgkX1NFUlZFUlsnQ09OVEVOVF9U
WVBFJ10pICkKICAgICAgICAkb3V0WydDb250ZW50LVR5cGUnXSA9ICRfU0VSVkVSWydDT05U
RU5UX1RZUEUnXTsKICAgICAgaWYoIGlzc2V0KCRfRU5WWydDT05URU5UX1RZUEUnXSkgKQog
ICAgICAgICRvdXRbJ0NvbnRlbnQtVHlwZSddID0gJF9FTlZbJ0NPTlRFTlRfVFlQRSddOwoK
ICAgICAgZm9yZWFjaCAoJF9TRVJWRVIgYXMgJGtleSA9PiAkdmFsdWUpIHsKICAgICAgICBp
ZiAoc3Vic3RyKCRrZXksIDAsIDUpID09ICJIVFRQXyIpIHsKICAgICAgICAgIC8vIHRoaXMg
aXMgY2hhb3MsIGJhc2ljYWxseSBpdCBpcyBqdXN0IHRoZXJlIHRvIGNhcGl0YWxpemUgdGhl
IGZpcnN0CiAgICAgICAgICAvLyBsZXR0ZXIgb2YgZXZlcnkgd29yZCB0aGF0IGlzIG5vdCBh
biBpbml0aWFsIEhUVFAgYW5kIHN0cmlwIEhUVFAKICAgICAgICAgIC8vIGNvZGUgZnJvbSBw
cnplbWVrCiAgICAgICAgICAka2V5ID0gc3RyX3JlcGxhY2UoCiAgICAgICAgICAgICIgIiwK
ICAgICAgICAgICAgIi0iLAogICAgICAgICAgICB1Y3dvcmRzKHN0cnRvbG93ZXIoc3RyX3Jl
cGxhY2UoIl8iLCAiICIsIHN1YnN0cigka2V5LCA1KSkpKQogICAgICAgICAgKTsKICAgICAg
ICAgICRvdXRbJGtleV0gPSAkdmFsdWU7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICBy
ZXR1cm4gJG91dDsKICB9CgogIC8vIFRoaXMgZnVuY3Rpb24gdGFrZXMgYSBpbnB1dCBsaWtl
IGE9YiZhPWMmZD1lIGFuZCByZXR1cm5zIHRoZSBwYXJzZWQKICAvLyBwYXJhbWV0ZXJzIGxp
a2UgdGhpcwogIC8vIGFycmF5KCdhJyA9PiBhcnJheSgnYicsJ2MnKSwgJ2QnID0+ICdlJykK
ICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHBhcnNlX3BhcmFtZXRlcnMoICRpbnB1dCApIHsK
ICAgIGlmICghaXNzZXQoJGlucHV0KSB8fCAhJGlucHV0KSByZXR1cm4gYXJyYXkoKTsKCiAg
ICAkcGFpcnMgPSBleHBsb2RlKCcmJywgJGlucHV0KTsKCiAgICAkcGFyc2VkX3BhcmFtZXRl
cnMgPSBhcnJheSgpOwogICAgZm9yZWFjaCAoJHBhaXJzIGFzICRwYWlyKSB7CiAgICAgICRz
cGxpdCA9IGV4cGxvZGUoJz0nLCAkcGFpciwgMik7CiAgICAgICRwYXJhbWV0ZXIgPSBPQXV0
aFV0aWw6OnVybGRlY29kZV9yZmMzOTg2KCRzcGxpdFswXSk7CiAgICAgICR2YWx1ZSA9IGlz
c2V0KCRzcGxpdFsxXSkgPyBPQXV0aFV0aWw6OnVybGRlY29kZV9yZmMzOTg2KCRzcGxpdFsx
XSkgOiAnJzsKCiAgICAgIGlmIChpc3NldCgkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRl
cl0pKSB7CiAgICAgICAgLy8gV2UgaGF2ZSBhbHJlYWR5IHJlY2lldmVkIHBhcmFtZXRlcihz
KSB3aXRoIHRoaXMgbmFtZSwgc28gYWRkIHRvIHRoZSBsaXN0CiAgICAgICAgLy8gb2YgcGFy
YW1ldGVycyB3aXRoIHRoaXMgbmFtZQoKICAgICAgICBpZiAoaXNfc2NhbGFyKCRwYXJzZWRf
cGFyYW1ldGVyc1skcGFyYW1ldGVyXSkpIHsKICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGZp
cnN0IGR1cGxpY2F0ZSwgc28gdHJhbnNmb3JtIHNjYWxhciAoc3RyaW5nKSBpbnRvIGFuIGFy
cmF5CiAgICAgICAgICAvLyBzbyB3ZSBjYW4gYWRkIHRoZSBkdXBsaWNhdGVzCiAgICAgICAg
ICAkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl0gPSBhcnJheSgkcGFyc2VkX3BhcmFt
ZXRlcnNbJHBhcmFtZXRlcl0pOwogICAgICAgIH0KCiAgICAgICAgJHBhcnNlZF9wYXJhbWV0
ZXJzWyRwYXJhbWV0ZXJdW10gPSAkdmFsdWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgJHBh
cnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdID0gJHZhbHVlOwogICAgICB9CiAgICB9CiAg
ICByZXR1cm4gJHBhcnNlZF9wYXJhbWV0ZXJzOwogIH0KCiAgcHVibGljIHN0YXRpYyBmdW5j
dGlvbiBidWlsZF9odHRwX3F1ZXJ5KCRwYXJhbXMpIHsKICAgIGlmICghJHBhcmFtcykgcmV0
dXJuICcnOwoKICAgIC8vIFVybGVuY29kZSBib3RoIGtleXMgYW5kIHZhbHVlcwogICAgJGtl
eXMgPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KGFycmF5X2tleXMoJHBhcmFtcykp
OwogICAgJHZhbHVlcyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoYXJyYXlfdmFs
dWVzKCRwYXJhbXMpKTsKICAgICRwYXJhbXMgPSBhcnJheV9jb21iaW5lKCRrZXlzLCAkdmFs
dWVzKTsKCiAgICAvLyBQYXJhbWV0ZXJzIGFyZSBzb3J0ZWQgYnkgbmFtZSwgdXNpbmcgbGV4
aWNvZ3JhcGhpY2FsIGJ5dGUgdmFsdWUgb3JkZXJpbmcuCiAgICAvLyBSZWY6IFNwZWM6IDku
MS4xICgxKQogICAgdWtzb3J0KCRwYXJhbXMsICdzdHJjbXAnKTsKCiAgICAkcGFpcnMgPSBh
cnJheSgpOwogICAgZm9yZWFjaCAoJHBhcmFtcyBhcyAkcGFyYW1ldGVyID0+ICR2YWx1ZSkg
ewogICAgICBpZiAoaXNfYXJyYXkoJHZhbHVlKSkgewogICAgICAgIC8vIElmIHR3byBvciBt
b3JlIHBhcmFtZXRlcnMgc2hhcmUgdGhlIHNhbWUgbmFtZSwgdGhleSBhcmUgc29ydGVkIGJ5
IHRoZWlyIHZhbHVlCiAgICAgICAgLy8gUmVmOiBTcGVjOiA5LjEuMSAoMSkKICAgICAgICBu
YXRzb3J0KCR2YWx1ZSk7CiAgICAgICAgZm9yZWFjaCAoJHZhbHVlIGFzICRkdXBsaWNhdGVf
dmFsdWUpIHsKICAgICAgICAgICRwYWlyc1tdID0gJHBhcmFtZXRlciAuICc9JyAuICRkdXBs
aWNhdGVfdmFsdWU7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgICRwYWlyc1td
ID0gJHBhcmFtZXRlciAuICc9JyAuICR2YWx1ZTsKICAgICAgfQogICAgfQogICAgLy8gRm9y
IGVhY2ggcGFyYW1ldGVyLCB0aGUgbmFtZSBpcyBzZXBhcmF0ZWQgZnJvbSB0aGUgY29ycmVz
cG9uZGluZyB2YWx1ZSBieSBhbiAnPScgY2hhcmFjdGVyIChBU0NJSSBjb2RlIDYxKQogICAg
Ly8gRWFjaCBuYW1lLXZhbHVlIHBhaXIgaXMgc2VwYXJhdGVkIGJ5IGFuICcmJyBjaGFyYWN0
ZXIgKEFTQ0lJIGNvZGUgMzgpCiAgICByZXR1cm4gaW1wbG9kZSgnJicsICRwYWlycyk7CiAg
fQp9IjtzOjM6Im1kNSI7czozMjoiM2MyZjAzNDJjZjI1ZTUzYzQ3ZjYxN2Q4YjU3MzJkNWQi
O30=
