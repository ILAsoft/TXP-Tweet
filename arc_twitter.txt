# arc_twitter v3.0-dev
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjc6
IjMuMC1kZXYiO3M6NjoiYXV0aG9yIjtzOjExOiJBbmR5IENhcnRlciI7czoxMDoiYXV0aG9y
X3VyaSI7czozMToiaHR0cDovL3JlZGhvdGNoaWxsaXByb2plY3QuY29tLyI7czoxMToiZGVz
Y3JpcHRpb24iO3M6NjA6IjxhIGhyZWY9Imh0dHA6Ly93d3cudHdpdHRlci5jb20iPlR3aXR0
ZXI8L2E+IGZvciBUZXh0cGF0dGVybiI7czo1OiJvcmRlciI7czoxOiI1IjtzOjQ6InR5cGUi
O3M6MToiMSI7czo1OiJmbGFncyI7czoxOiIzIjtzOjQ6ImhlbHAiO3M6MTU0NTY6Igk8aDEg
Y2xhc3M9InRpdGxlIj48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCAoYXJj
X3R3aXR0ZXIgZm9yIFRleHRwYXR0ZXJuKTwvaDE+CgoJPG9sPgoJCTxsaT48YSBocmVmPSIj
YXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2Fy
Y190d2l0dGVyX2luc3RhbGxhdGlvbiI+SW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxsYXRpb248
L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3RhZyI+VGhlIGFyY190d2l0
dGVyIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfc2VhcmNoX3Rh
ZyI+VGhlIGFyY190d2l0dGVyX3NlYXJjaCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0i
I2FyY190d2l0dGVyX3JldHdlZXRfdGFnIj5UaGUgYXJjX3R3aXR0ZXJfcmV0d2VldCB0YWc8
L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3R3ZWV0X3VybCI+VGhlIGFy
Y190d2l0dGVyX3R3ZWV0X3VybCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190
d2l0dGVyX3Rpbnl1cmwiPlRoZSBhcmNfdHdpdHRlcl90aW55dXJsIHRhZzwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfY2FjaGluZyI+Q2FjaGluZzwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfcHJlZnMiPlByZWZlcmVuY2VzPC9hPjwvbGk+
CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl9hcnRpY2xlIj5Ud2VldGluZyBhcnRpY2xl
czwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfYWRtaW4iPlRoZSBUd2l0
dGVyIHRhYjwvYT48L2xpPgoJPC9vbD4KCgk8cD48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9z
cGFuPiBUd2VldCBwcm92aWRlcyBhY2Nlc3MgdG8geW91ciBUd2l0dGVyIGFjY291bnQgdGhy
b3VnaCBib3RoIHRoZSBhZG1pbiBpbnRlcmZhY2UgYW5kIHRoZSBwdWJsaWMgc2lkZSBvZiB5
b3VyIHNpdGUuIFVwZGF0ZSBUd2l0dGVyIHdoZW4geW91IHBvc3QgYSBuZXcgYXJ0aWNsZSAo
d2l0aCBhcnRpY2xlLWJ5LWFydGljbGUgb3B0IG91dCBvcHRpb24pLCB1cGRhdGUgYW5kIHZp
ZXcgeW91ciBUd2l0dGVyIGZlZWQgdGhyb3VnaCB0aGUgYWRtaW4gVHdpdHRlciB0YWIsIGFu
ZCBkaXNwbGF5IFR3aXR0ZXIgZmVlZHMgb24geW91ciBzaXRlLjwvcD4KCgk8cD5SZXF1aXJl
bWVudHM6LTwvcD4KCgk8dWw+CgkJPGxpPlRleHRwYXR0ZXJuIDQuMis8L2xpPgoJCTxsaT48
c3BhbiBjbGFzcz0iY2FwcyI+UEhQPC9zcGFuPiA1IGFuZCBjVVJMPC9saT4KCTwvdWw+CgoJ
PGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2gy
PgoKCTxwPjxhIGhyZWY9Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbSI+QW5keSBD
YXJ0ZXI8L2E+LiBGb3Igb3RoZXIgVGV4dHBhdHRlcm4gcGx1Z2lucyBieSBtZSB2aXNpdCBt
eSA8YSBocmVmPSJodHRwOi8vcmVkaG90Y2hpbGxpcHJvamVjdC5jb20vdHhwIj5QbHVnaW5z
IHBhZ2U8L2E+LjwvcD4KCgk8cD5UaGFua3MgdG8gPGEgaHJlZj0iaHR0cDovL21hbmZyZS5u
ZXQvIj5NaWNoYWVsIE1hbmZyZTwvYT4gZm9yIGluc3BpcmF0aW9uIGZvciB0aGUgYXJ0aWNs
ZSB0d2VldCBwYXJ0IG9mIHRoaXMgcGx1Z2luIGJhc2VkIG9uIGhpcyA8c3BhbiBjbGFzcz0i
dGFnIj5tZW1fdHdpdHRlcjwvc3Bhbj4gcGx1Z2luLiAgQWRkaXRpb25hbCB0aGFua3MgdG8g
dGhlIGdyZWF0IFRleHRwYXR0ZXJuIGNvbW11bml0eSBmb3IgaGVscGluZyB0byB0ZXN0IHRo
aXMgcGx1Z2luIGFuZCBmb3Igc3VnZ2VzdGluZyBuZXcgZmVhdHVyZXMuIFRoZSBPQXV0aCBw
YXJ0IG9mIHRoZSBwbHVnaW4gaXMgdGhhbmtzIHRvIDxhIGhyZWY9Imh0dHA6Ly90d2l0dGVy
LmNvbS9hYnJhaGFtIj5BYnJhaGFtIFdpbGxpYW1zPC9hPi48L3A+CgoJPGgyIGNsYXNzPSJz
ZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfaW5zdGFsbGF0aW9uIj5JbnN0YWxsYXRpb24gLyBV
bmluc3RhbGxhdGlvbjwvaDI+CgoJPHA+VG8gaW5zdGFsbCBnbyB0byB0aGUgJiM4MjE2O3Bs
dWdpbnMmIzgyMTc7IHRhYiB1bmRlciAmIzgyMTY7YWRtaW4mIzgyMTc7IGFuZCBwYXN0ZSB0
aGUgcGx1Z2luIGNvZGUgaW50byB0aGUgJiM4MjE2O0luc3RhbGwgcGx1Z2luJiM4MjE3OyBi
b3gsICYjODIxNjt1cGxvYWQmIzgyMTc7IGFuZCB0aGVuICYjODIxNjtpbnN0YWxsJiM4MjE3
Oy4gRmluYWxseSBhY3RpdmF0ZSB0aGUgcGx1Z2luLjwvcD4KCgk8cD5CZWZvcmUgeW91IHN0
YXJ0IHVzaW5nIDxzcGFuIGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiB5b3Ugd2ls
bCBuZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IHRoZSBjYWNoZSBkaXJlY3RvcnkgaXMgd3JpdGFi
bGUuIFNlZSB0aGUgJiM4MjE2O0NhY2hpbmcmIzgyMTc7IHN1YnNlY3Rpb24gYmVsb3cgZm9y
IGZ1cnRoZXIgaW5mb3JtYXRpb24uPC9wPgoKCTxwPjxzcGFuIGNsYXNzPSJ0YWciPmFyY190
d2l0dGVyPC9zcGFuPiBzaG91bGQgbm93IGJlIHJlYWR5IGZvciB1c2Ugb24gdGhlIHB1Ymxp
Yy1zaWRlIG9mIHlvdXIgc2l0ZS48L3A+CgoJPHA+VG8gdW5sb2NrIHRoZSBhZG1pbiBmZWF0
dXJlcyBvZiB0aGlzIHBsdWdpbiB5b3Ugd2lsbCBuZWVkIHRvIGFzc29jaWF0ZSB5b3VyIHNp
dGUgd2l0aCBhIFR3aXR0ZXIgYWNjb3VudCBieSBjb25uZWN0aW5nIHRvIFR3aXR0ZXIgZnJv
bSB0aGUgcGx1Z2luJiM4MjE3O3Mgb3B0aW9ucyBzY3JlZW4uIENsaWNrIG9uIHRoZSBsaW5r
IHRvIGNvbm5lY3QgdG8gVHdpdHRlciwgeW91IHdpbGwgYmUgYXNrZWQgdG8gbG9naW4gdG8g
VHdpdHRlciwgY2xpY2tpbmcgdGhpcyBsaW5rIHdpbGwgdGVtcG9yYXJpbHkgdGFrZSB5b3Ug
dG8gdGhlIFR3aXR0ZXIgc2l0ZSB3aGVyZSB5b3Ugd2lsbCBiZSBhc2tlZCB0byBsb2dpbiBh
bmQgYXBwcm92ZSBhY2Nlc3MgZm9yIDxzcGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3
ZWV0IHRvIHJlYWQgYW5kIHdyaXRlIHRvIHlvdXIgVHdpdHRlciBhY2NvdW50LiBJZiBhbGwg
aXMgc3VjY2Vzc2Z1bCB5b3Ugd2lsbCBiZSByZXR1cm5lZCB0byB0aGUgb3B0aW9ucyBzY3Jl
ZW4gYW5kIHlvdXIgdXNlciBuYW1lIHdpbGwgYXBwZWFyLjwvcD4KCgk8cD5BdCBhbnkgdGlt
ZSB5b3UgY2FuIGRpc2Fzc29jaWF0ZSB5b3VyIFR3aXR0ZXIgYWNjb3VudCB3aXRoIDxzcGFu
IGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0IHZpYSB5b3VyIFR3aXR0ZXIgYWNjb3Vu
dCBwcmVmZXJlbmNlcyBvbiB0aGUgPGEgaHJlZj0iaHR0cDovL3d3dy50d2l0dGVyLmNvbSI+
VHdpdHRlciB3ZWJzaXRlPC9hPi48L3A+CgoJPHA+VG8gdW5pbnN0YWxsIDxzcGFuIGNsYXNz
PSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiBzaW1wbHkgZGVsZXRlIHRoZSBwbHVnaW4gZnJv
bSB0aGUgJiM4MjE2O1BsdWdpbnMmIzgyMTc7IHRhYi4gIFRoaXMgd2lsbCByZW1vdmUgdGhl
IHBsdWdpbiBjb2RlLCBkZWxldGUgcmVsYXRlZCBwcmVmZXJlbmNlcyBhbmQgZHJvcCB0aGUg
PHNwYW4gY2xhc3M9InRhZyI+YXJjX3R3aXR0ZXI8L3NwYW4+IHRhYmxlIGZyb20geW91ciBU
ZXh0cGF0dGVybiBkYXRhYmFzZS48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJj
X3R3aXR0ZXJfdGFnIj5UaGUgYXJjX3R3aXR0ZXIgdGFnPC9oMj4KCgk8aDM+U3ludGF4PC9o
Mz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyIHVzZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZx
dW90OyAvJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0
aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVs
dDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVzZXI8
L3RkPgoJCQk8dGQ+VHdpdHRlciB1c2VyIG5hbWU8L3RkPgoJCQk8dGQ+IDxlbT5hcmNfdHdp
dHRlciB1c2VybmFtZTwvZW0+PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXluaW5q
YSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5saW1pdDwvdGQ+CgkJCTx0ZD5N
YXhpbXVtIG51bWJlciBvZiB0d2VldHMgdG8gZGlzcGxheSAobWF4LiAyMDApPC90ZD4KCQkJ
PHRkPjEwPC90ZD4KCQkJPHRkPmxpbWl0PSZxdW90OzI1JnF1b3Q7PC90ZD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmRhdGVmb3JtYXQ8L3RkPgoJCQk8dGQ+Rm9ybWF0IHRoYXQgdXBkYXRl
IGRhdGVzIHdpbGwgYXBwZWFyIGFzPC90ZD4KCQkJPHRkPiA8ZW0+QXJjaGl2ZSBkYXRlIGZv
cm1hdDwvZW0+PC90ZD4KCQkJPHRkPmRhdGVmb3JtYXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAl
cCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbDwvdGQ+CgkJCTx0ZD5M
YWJlbCBmb3IgdGhlIHRvcCBvZiB0aGUgbGlzdDwvdGQ+CgkJCTx0ZD4gPGVtPm5vIGxhYmVs
PC9lbT48L3RkPgoJCQk8dGQ+bGFiZWw9JnF1b3Q7TXkgVHdpdHRlciB0aW1lbGluZSZxdW90
OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbHRhZzwvdGQ+CgkJCTx0ZD5JbmRl
cGVuZGVudCB3cmFwdGFnIGZvciBsYWJlbDwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48
L3RkPgoJCQk8dGQ+bGFiZWx0YWc9JnF1b3Q7aDMmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRy
PgoJCQk8dGQ+YnJlYWs8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNs
YXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnICh3aXRob3V0IGJyYWNrZXRzKSwg
b3Igc3RyaW5nLCB1c2VkIHRvIHNlcGFyYXRlIHRoZSB1cGRhdGVzPC90ZD4KCQkJPHRkPmxp
PC90ZD4KCQkJPHRkPmJyZWFrPSZxdW90O2JyJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4K
CQkJPHRkPndyYXB0YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNs
YXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVzZWQgYXMgdGhlIHdy
YXB0YWcsIHdpdGhvdXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90
ZD4KCQkJPHRkPndyYXB0YWc9JnF1b3Q7dWwmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJ
CQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNz
PSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgZm9yIHdyYXB0YWc8
L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXI8L3RkPgoJCQk8dGQ+Y2xhc3M9JnF1b3Q7dHdpdHRl
ciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzc19wb3N0ZWQ8L3RkPgoJ
CQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+
PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byBzcGFuIHRhZyBhcm91bmQgcG9z
dGVkIGRhdGU8L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXItcG9zdGVkPC90ZD4KCQk8L3RyPgoJ
PC90YWJsZT4KCgk8aDM+RXhhbXBsZSB1c2FnZTwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdp
dHRlciB1c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDsgbGltaXQ9JnF1b3Q7NSZxdW90
OyB3cmFwdGFnPSZxdW90O3VsJnF1b3Q7IGJyZWFrPSZxdW90O2xpJnF1b3Q7IGRhdGVmb3Jt
YXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAlcCZxdW90OyAvJmd0OzwvcD4KCgk8cD5Qcm9kdWNl
cyBhIGJ1bGxldCBwb2ludCBsaXN0IG9mIHRoZSBsYXN0IDUgVHdpdHRlciB1cGRhdGVzIGZy
b20gZHJtb25rZXluaW5qYSYjODIxNztzIFR3aXR0ZXIgZmVlZCB3aXRoIGEgZGVmaW5lZCBk
YXRlIGZvcm1hdCB0byBvdmVycmlkZSB0aGUgZGVmYXVsdCBhcmNoaXZlIGRhdGUgZm9ybWF0
LjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9zZWFyY2hfdGFn
Ij5UaGUgYXJjX3R3aXR0ZXJfc2VhcmNoIHRhZzwvaDI+CgoJPGgzPlN5bnRheDwvaDM+CgoJ
PHA+Jmx0O3R4cDphcmNfdHdpdHRlcl9zZWFyY2ggaGFzaHRhZ3M9JnF1b3Q7dHhwJnF1b3Q7
IC8mZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0
dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90
aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+c2VhcmNoPC90
ZD4KCQkJPHRkPkNvbW1hIHNlcGFyYXRlZCBsaXN0IG9mIHNlYXJjaCB3b3JkczwvdGQ+CgkJ
CTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+c2VhcmNoPSZxdW90O3R4cCx0ZXh0
cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5oYXNodGFnczwvdGQ+
CgkJCTx0ZD5Db21tYSBzZXBhcmF0ZWQgbGlzdCBvZiBoYXNodGFncyB0byBzZWFyY2ggZm9y
IChub3QgaW5jbHVkaW5nIHRoZSBoYXNoKTwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48
L3RkPgoJCQk8dGQ+aGFzaHRhZ3M9JnF1b3Q7dHhwLHRleHRwYXR0ZXJuJnF1b3Q7PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPnJlcGx5PC90ZD4KCQkJPHRkPlVzZXJuYW1lIG9mIHR3
ZWV0cyBpbiByZXBseSB0bzwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8
dGQ+cmVwbHk9JnF1b3Q7dHdpdHRlciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5tZW50aW9uPC90ZD4KCQkJPHRkPlVzZXJuYW1lIG9mIHVzZXIgbWVudGlvbmVkIGluIHR3
ZWV0cyAoPGk+aS5lLjwvaT4gdHdlZXRzIGNvbnRhaW5pbmcgQHVzZXJuYW1lKTwvdGQ+CgkJ
CTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+bWVudGlvbj0mcXVvdDt0d2l0dGVy
JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxpbWl0PC90ZD4KCQkJPHRkPk1h
eGltdW0gbnVtYmVyIG9mIHR3ZWV0cyB0byBkaXNwbGF5IChtYXguIDIwMCk8L3RkPgoJCQk8
dGQ+MTA8L3RkPgoJCQk8dGQ+bGltaXQ9JnF1b3Q7MjUmcXVvdDs8L3RkPgoJCTwvdHI+CgkJ
PHRyPgoJCQk8dGQ+ZGF0ZWZvcm1hdDwvdGQ+CgkJCTx0ZD5Gb3JtYXQgdGhhdCB1cGRhdGUg
ZGF0ZXMgd2lsbCBhcHBlYXIgYXM8L3RkPgoJCQk8dGQ+IDxlbT5BcmNoaXZlIGRhdGUgZm9y
bWF0PC9lbT48L3RkPgoJCQk8dGQ+ZGF0ZWZvcm1hdD0mcXVvdDslYiAlT2UsICVJOiVNICVw
JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsPC90ZD4KCQkJPHRkPkxh
YmVsIGZvciB0aGUgdG9wIG9mIHRoZSBsaXN0PC90ZD4KCQkJPHRkPiA8ZW0+bm8gbGFiZWw8
L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbHRhZzwvdGQ+CgkJCTx0ZD5J
bmRlcGVuZGVudCB3cmFwdGFnIGZvciBsYWJlbDwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9l
bT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+YnJlYWs8L3RkPgoJCQk8dGQ+PHNwYW4g
Y2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFn
ICh3aXRob3V0IGJyYWNrZXRzKSwgb3Igc3RyaW5nLCB1c2VkIHRvIHNlcGFyYXRlIHRoZSB1
cGRhdGVzPC90ZD4KCQkJPHRkPmxpPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPndyYXB0
YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5I
VE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVzZWQgYXMgdGhlIHdyYXB0YWcsIHdpdGhv
dXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3Bh
biBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGZvciB3
cmFwdGFnPC90ZD4KCQkJPHRkPmFyY190d2l0dGVyX3NlYXJjaDwvdGQ+CgkJPC90cj4KCQk8
dHI+CgkJCTx0ZD5jbGFzc191c2VyPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48
c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFw
cGxpZWQgdG8gc3BhbiB0YWcgYXJvdW5kIHVzZXIgbmFtZTwvdGQ+CgkJCTx0ZD5hcmNfdHdp
dHRlci11c2VyPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzX3Bvc3RlZDwvdGQ+
CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bh
bj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHNwYW4gdGFnIGFyb3VuZCBw
b3N0ZWQgZGF0ZTwvdGQ+CgkJCTx0ZD5hcmNfdHdpdHRlci1wb3N0ZWQ8L3RkPgoJCTwvdHI+
Cgk8L3RhYmxlPgoKCTxoMz5FeGFtcGxlIHVzYWdlPC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190
d2l0dGVyX3NlYXJjaCBzZWFyY2g9JnF1b3Q7cGx1Z2luJnF1b3Q7IGhhc2h0YWdzPSZxdW90
O3R4cCx0ZXh0cGF0dGVybiZxdW90OyBsaW1pdD0mcXVvdDsyNSZxdW90OyAvJmd0OzwvcD4K
Cgk8cD5Qcm9kdWNlcyBhIGxpc3Qgb2YgdHdlZXRzIGNvbnRhaW5pbmcgdGhlIHdvcmQgJiM4
MjE2O3BsdWdpbiYjODIxNzsgYW5kIHRoZSBoYXNodGFncyAmIzgyMTY7I3R4cCYjODIxNzsg
YW5kICYjODIxNjsjdGV4dHBhdHRlcm4mIzgyMTc7LiBUaGUgdGFnIHdpbGwgcmV0dXJuIGEg
bWF4aW11bSBvZiAyNSB0d2VldHMuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFy
Y190d2l0dGVyX3JldHdlZXRfdGFnIj5UaGUgYXJjX3R3aXR0ZXJfcmV0d2VldCB0YWc8L2gy
PgoKCTxoMz5TeW50YXg8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfcmV0d2VldCAv
Jmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRy
aWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+
CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVzZXI8L3RkPgoJ
CQk8dGQ+VHdpdHRlciB1c2VyIG5hbWUgdG8gcXVvdGU8L3RkPgoJCQk8dGQ+IDxlbT5hcmNf
dHdpdHRlciB1c2VybmFtZTwvZW0+PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXlu
aW5qYSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD51cmw8L3RkPgoJCQk8dGQ+
PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+PC9zcGFu
PiB0byByZXR3ZWV0PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnRleHQ8L3RkPgoJCQk8
dGQ+UmV0d2VldCB0ZXh0PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmZvbGxvdzE8L3Rk
PgoJCQk8dGQ+U3VnZ2VzdGVkIFR3aXR0ZXIgYWNjb3VudCB0byBmb2xsb3csIGZvciBleGFt
cGxlIHlvdXIgb3duPC90ZD4KCQkJPHRkPkEgVHdpdHRlciB1c2VyIHRvIHJlY29tbWVuZDwv
dGQ+CgkJCTx0ZD5mb2xsb3cxPSZxdW90O1RleHRwYXR0ZXJuJnF1b3Q7PC90ZD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPmZvbGxvdzI8L3RkPgoJCQk8dGQ+QXMgZm9sbG93MTwvdGQ+CgkJ
CTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFuZzwv
dGQ+CgkJCTx0ZD5MYW5ndWFnZTwvdGQ+CgkJCTx0ZD5lbjwvdGQ+CgkJCTx0ZD5sYW5nPSZx
dW90O2VzJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNvdW50PC90ZD4KCQkJ
PHRkPkNvdW50IGJveCBwb3NpdGlvbiwgb3B0aW9uczogbm9uZSwgaG9yaXpvbnRhbCBvciB2
ZXJ0aWNhbDwvdGQ+CgkJCTx0ZD5ob3Jpem9udGFsPC90ZD4KCQkJPHRkPmNvdW50PSZxdW90
O25vbmUmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aW5jbHVkZV9qczwvdGQ+
CgkJCTx0ZD5XaGV0aGVyIG9yIG5vdCB0byBpbmNsdWRlIHRoZSBKYXZhU2NyaXB0PC90ZD4K
CQkJPHRkPjE8L3RkPgoJCQk8dGQ+aW5jbHVkZV9qcz0mcXVvdDswJnF1b3Q7PC90ZD4KCQk8
L3RyPgoJCTx0cj4KCQkJPHRkPndyYXB0YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNh
cHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVz
ZWQgYXMgdGhlIHdyYXB0YWcsIHdpdGhvdXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51
bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRk
PjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bh
bj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gdGhlIHJldHdlZXQgYnV0dG9uPC90ZD4K
CQkJPHRkPnR3aXR0ZXItc2hhcmUtYnV0dG9uPC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8
aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl90d2VldF91cmwiPmFyY190d2l0
dGVyX3R3ZWV0X3VybDwvaDI+CgoJPHA+UmV0dXJucyB0aGUgPHNwYW4gY2xhc3M9ImNhcHMi
PlVSTDwvc3Bhbj4gb2YgdGhlIFR3aXR0ZXIgc3RhdHVzIGZvciBhbiBhcnRpY2xlLjwvcD4K
Cgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyX3R3ZWV0X3VybCAv
Jmd0OzwvcD4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyX3R3ZWV0X3VybCZndDtMaW5rIHRl
eHQmbHQ7L3R4cDphcmNfdHdpdHRlcl90d2VldF91cmwmZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwv
aDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNj
cmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+aWQ8L3RkPgoJCQk8dGQ+VGV4dHBhdHRlcm4gYXJ0aWNs
ZSBJRDwvdGQ+CgkJCTx0ZD4gPGVtPmN1cnJlbnQgYXJ0aWNsZTwvZW0+PC90ZD4KCQkJPHRk
PmlkPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+dGl0bGU8L3Rk
PgoJCQk8dGQ+VGl0bGUgYXR0cmlidXRlIG9mIHRoZSBsaW5rPC90ZD4KCQkJPHRkPiA8ZW0+
dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0
ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3Nw
YW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHRoZSBsaW5rPC90ZD4KCQkJPHRkPiA8
ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPGgyIGNsYXNzPSJzZWN0
aW9uIiBpZD0iYXJjX3R3aXR0ZXJfdGlueXVybCI+YXJjX3R3aXR0ZXJfdGlueXVybDwvaDI+
CgoJPHA+UmV0dXJucyB0aGUgc2hvcnRlbmVkIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3Nw
YW4+IG9mIHRoZSBhcnRpY2xlIHVzZWQgZm9yIHRoZSBUd2l0dGVyIHVwZGF0ZS48L3A+CgoJ
PGgzPlN5bnRheDwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl90aW55dXJsIC8mZ3Q7
PC9wPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfdGlueXVybCZndDtMaW5rIHRleHQmbHQ7
L3R4cDphcmNfdHdpdHRlcl90aW55dXJsJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0
YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248
L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmlkPC90ZD4KCQkJPHRkPlRleHRwYXR0ZXJuIGFydGljbGUgSUQ8L3Rk
PgoJCQk8dGQ+IDxlbT5jdXJyZW50IGFydGljbGU8L2VtPjwvdGQ+CgkJCTx0ZD5pZD0mcXVv
dDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnRpdGxlPC90ZD4KCQkJPHRk
PlRpdGxlIGF0dHJpYnV0ZSBvZiB0aGUgbGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9l
bT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4g
Y2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFz
cyBhdHRyaWJ1dGUgYXBwbGllZCB0byB0aGUgbGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0
PC9lbT48L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9
ImFyY190d2l0dGVyX2NhY2hpbmciPkNhY2hpbmc8L2gyPgoKCTxwPkluIG9yZGVyIHRvIHBy
ZXZlbnQgZXhjZXNzaXZlIHJlcGVhdGl0aXZlIGNhbGxzIHRvIHRoZSBUd2l0dGVyIHdlYnNp
dGUgaXQgaXMgcmVjb21tZW5kZWQgdG8gY2FjaGUgcmVzdWx0cy4gVHdpdHRlciBsaW1pdHMg
dGhlIG51bWJlciBvZiBjYWxscyB0aHJvdWdoIHRoZSA8c3BhbiBjbGFzcz0iY2FwcyI+QVBJ
PC9zcGFuPiwgYW5kIGNvbnRpbnVvdXMgY2FsbHMgd2lsbCByZXN1bHQgaW4gVHdpdHRlciBj
bG9zaW5nIHRvIGZ1cnRoZXIgcmVxdWVzdHMuIEJ5IGRlZmF1bHQsIGFyY190d2l0dGVyIGNh
Y2hlcyBmb3IgMzAgbWludXRlIGludGVydmFscy48L3A+CgoJPHRhYmxlPgoJCTx0cj4KCQkJ
PHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZh
dWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2Fj
aGluZzwvdGQ+CgkJCTx0ZD4mIzgyMTY7MSYjODIxNzsgdG8gY2FjaGUgZmVlZCwgJiM4MjE2
OzAmIzgyMTc7IHRvIHR1cm4gY2FjaGluZyBvZmYgKG5vdCByZWNvbW1lbmRlZCk8L3RkPgoJ
CQk8dGQ+MTwvdGQ+CgkJCTx0ZD5jYWNoaW5nPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+Y2FjaGVfZGlyPC90ZD4KCQkJPHRkPkFic29sdXRlIHBhdGggdG8g
dGhlIGNhY2hlIGRpcmVjdG9yeSAobXVzdCBiZSB3cml0YWJsZSk8L3RkPgoJCQk8dGQ+IDxl
bT5hcmNfdHdpdHRlciBwcmVmZXJlbmNlczwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJ
PHRkPmNhY2hlX3RpbWU8L3RkPgoJCQk8dGQ+VGltZSBpbiBtaW51dGVzIHRoYXQgdGhlIGNh
Y2hlIGZpbGVzIGFyZSBzdG9yZWQgYmVmb3JlIGJlaW5nIHJlZnJlc2hlZDwvdGQ+CgkJCTx0
ZD41PC90ZD4KCQkJPHRkPmNhY2hlX3RpbWU9JnF1b3Q7MzAmcXVvdDs8L3RkPgoJCTwvdHI+
Cgk8L3RhYmxlPgoKCTxwPlRoZSBhZG1pbiBzaWRlIG9mIHRoaXMgcGx1Z2luIGVuZm9yY2Vz
IGNhY2hpbmcsIGFwYXJ0IGZyb20gd2hlbiBpdCBpcyBwb3N0aW5nIHRvIFR3aXR0ZXIgKDxp
PmUuZy48L2k+IHdoZW4gcG9zdGluZyBvciBkZWxldGluZyBhbiB1cGRhdGUpLjwvcD4KCgk8
aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9wcmVmcyI+UHJlZmVyZW5jZXM8
L2gyPgoKCTxwPllvdSBjYW4gYWNjZXNzIHRoZSBwbHVnaW5zIGNvcmUgcHJlZmVyZW5jZXMg
ZnJvbSBlaXRoZXIgdGhlIFByZWZlcmVuY2VzIG9yIFBsdWdpbnMgdGFicyBpbiBhZG1pbi4g
U2V0dXAgeW91ciBUd2l0dGVyIGFjY291bnQgKHlvdSB3aWxsIGJlIGFza2VkIHRvIGNvbm5l
Y3QgdmlhIFR3aXR0ZXIgYW5kIHRoaXMgbmVlZHMgZG9pbmcgYmVmb3JlIHlvdSBjYW4gdXNl
IHRoZSBwbHVnaW4pIGFuZCBjaGFuZ2UgdGhlIGNhY2hlIGRpcmVjdG9yeSB1c2luZyBhcmNf
dHdpdHRlciYjODIxNztzIHByZWZlcmVuY2VzLiBXaXRob3V0IHByb3ZpZGluZyB5b3VyIGFj
Y291bnQgbG9naW4gZGV0YWlscyB0aGUgYWRtaW4gYXJlYSBmZWF0dXJlcyBvZiB0aGlzIHBs
dWdpbiB3aWxsIGJlIGluYWN0aXZlLjwvcD4KCgk8cD5Zb3UgY2FuIHNlbGVjdCB0aGUgPHNw
YW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4gc2hvcnRlbmVyIG1ldGhvZCB5b3Ugd2FudCB0
byB1c2UgdG8gbGluayBiYWNrIHRvIHlvdXIgYXJ0aWNsZSBvbiBUd2l0dGVyLiBQbGVhc2Ug
bm90ZSB0aGF0IGlmIHlvdSBzZWxlY3Qgc21kX3Nob3J0X3VybCB5b3Ugd2lsbCBuZWVkIHRv
IGhhdmUgaW5zdGFsbGVkIGFuZCBhY3RpdmF0ZWQgdGhlIDxhIGhyZWY9Imh0dHA6Ly90ZXh0
cGF0dGVybi5vcmcvcGx1Z2lucy8xMDk5L3NtZF9zaG9ydF91cmwiPjxzcGFuIGNsYXNzPSJ0
YWciPnNtZF9zaG9ydF91cmw8L3NwYW4+IHBsdWdpbjwvYT4gZGV2ZWxvcGVkIGJ5IFN0ZWYg
RGF3c29uLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9hcnRp
Y2xlIj5Ud2VldGluZyBhcnRpY2xlczwvaDI+CgoJPHA+QnkgZGVmYXVsdCBhcmNfdHdpdHRl
ciB3aWxsIHBvc3QgYW4gdXBkYXRlIHRvIFR3aXR0ZXIgaW5jbHVkaW5nIGEgc2hvcnRlbmVk
IDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+IHRvIHlvdXIgYXJ0aWNsZS4gT25seSBs
aXZlIGFuZCBhY3RpdmUgYXJ0aWNsZXMgd2lsbCBiZSBzZW50IHRvIFR3aXR0ZXIsIDxpPmku
ZS48L2k+IGFydGljbGVzIHBvc3RlZCBpbiB0aGUgZnV0dXJlIG9yIGFzIHN0aWNreSBhcnRp
Y2xlcyB3aWxsIG5vdCBiZSBzZW50LiBJZiB5b3VyIGFydGljbGUgaXMgc3VjY2Vzc2Z1bGx5
IHN1Ym1pdHRlZCB0byBUd2l0dGVyIHRoZSB1cGRhdGUgd2lsbCBhcHBlYXIgaW4gcGxhY2Ug
b2YgdGhlIFR3aXR0ZXIgb3B0aW9uIG9uIHRoZSByaWdodC1oYW5kLXNpZGUgb2YgdGhlIGFy
dGljbGUgZWRpdCBzY3JlZW4uPC9wPgoKCTxwPlR3ZWV0cyBhcmUgc2VudCBpbiB0aGUgZm9s
bG93aW5nIGZvcm1hdDogPGVtPlR3ZWV0IHByZWZpeDwvZW0+IDxlbT5BcnRpY2xlIHRpdGxl
PC9lbT4gPGVtPlNob3J0ZW5lZCA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPjwvZW0+
IDxlbT5Ud2VldCBzdWZmaXg8L2VtPi4gWW91IGNhbiBjaGFuZ2UgdGhlIHByZWZpeCBhbmQg
c3VmZml4IG9uIGFuIGFydGljbGUtYnktYXJ0aWNsZSBiYXNpcyBieSBjaGFuZ2luZyB0aGUg
dHdlZXQgb3B0aW9ucyB1bmRlciAmIzgyMTY7VXBkYXRlIFR3aXR0ZXImIzgyMTc7IG9uIHRo
ZSBhcnRpY2xlIGVkaXRvciBzY3JlZW4uIFRoZSBkZWZhdWx0IDxlbT5Ud2VldCBwcmVmaXg8
L2VtPiBjYW4gYmUgc2V0IHVuZGVyIHRoZSA8c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRl
cjwvc3Bhbj4gcHJlZmVyZW5jZXMgc2NyZWVuICh0aGUgZGVmYXVsdCBvbiBpbnN0YWxsYXRp
b24gaXMgJiM4MjIwO0p1c3QgcG9zdGVkOiYjODIyMTspLjwvcD4KCgk8cD5QbGVhc2Ugbm90
ZSB0aGF0IG9uY2UgYW4gYXJ0aWNsZSBoYXMgYmVlbiB0d2VldGVkIHRoZSB0d2VldCBjYW5u
b3QgYmUgZWRpdGVkLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRl
cl9hZG1pbiI+VGhlIFR3aXR0ZXIgdGFiPC9oMj4KCgk8cD5VbmRlciB0aGUgRXh0ZW5zaW9u
cyB0YWIgKHRoaXMgY2FuIGJlIGNoYW5nZWQgZnJvbSB0aGUgcGx1Z2luJiM4MjE3O3MgcHJl
ZmVyZW5jZSBwYWdlKSBhIG5ldyBUd2l0dGVyIHRhYiBzaG91bGQgYXBwZWFyIG9uY2UgeW91
IGhhdmUgY29ubmVjdGVkIHlvdXIgc2l0ZSB0byB5b3VyIFR3aXR0ZXIgYWNjb3VudC4gRnJv
bSBoZXJlIHlvdSB3aWxsIGJlIGFibGUgdG8gc3VibWl0IG5ldyBUd2l0dGVyIHVwZGF0ZXMs
IHZpZXcgYmFzaWMgYWNjb3VudCBzdGF0aXN0aWNzLCBhbmQgY2hlY2sgb3V0IHlvdXIgcmVj
ZW50IHVwZGF0ZXMgKGluY2x1ZGluZyB0aGUgb3B0aW9uIHRvIGRlbGV0ZSB5b3VyIHR3ZWV0
cykuPC9wPiI7czo0OiJjb2RlIjtzOjcxNTc3OiJnbG9iYWwgJHByZWZzLCR0eHBjZmcsJGFy
Y190d2l0dGVyX2NvbnN1bWVyS2V5LCRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiRh
cmNfdHdpdHRlciA9IGFycmF5KCk7CgokYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkgPSAnbktj
WHNsd3paaEJkMGtmS01ldG5QQSc7CiRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCA9ICdD
Nm5TUENMM2VlSEdUQmhLQ2d3ZDlvY2xjdUQwc3JCOFdWa2ZYUVlDNTQnOwoKYWRkX3ByaXZz
KCdwbHVnaW5fcHJlZnMuYXJjX3R3aXR0ZXInLCcxLDInKTsKcmVnaXN0ZXJfY2FsbGJhY2so
J2FyY190d2l0dGVyX2luc3RhbGwnLCdwbHVnaW5fbGlmZWN5Y2xlLmFyY190d2l0dGVyJywg
J2luc3RhbGxlZCcpOwpyZWdpc3Rlcl9jYWxsYmFjaygnYXJjX3R3aXR0ZXJfdW5pbnN0YWxs
JywncGx1Z2luX2xpZmVjeWNsZS5hcmNfdHdpdHRlcicsICdkZWxldGVkJyk7CnJlZ2lzdGVy
X2NhbGxiYWNrKCdhcmNfdHdpdHRlcl9wcmVmcycsJ3BsdWdpbl9wcmVmcy5hcmNfdHdpdHRl
cicpOwoKLyoKICogU2V0dXAgaW5pdGlhbCBwcmVmZXJlbmNlcyBpZiBub3QgaW4gdGhlIHR4
cF9wcmVmcyB0YWJsZS4KICovCmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl91c2Vy
J10pKQogICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3VzZXInLCAnJywgJ2FyY190d2l0dGVy
JywgMSwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX3By
ZWZpeCddKSkKICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfcHJlZml4JywnSnVzdCBwb3N0ZWQ6
JywgJ2FyY190d2l0dGVyJywgMiwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3NldCgkcHJlZnNb
J2FyY190d2l0dGVyX2NhY2hlX2RpciddKSkKICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfY2Fj
aGVfZGlyJywkdHhwY2ZnWyd0eHBhdGgnXS4kcHJlZnNbJ3RlbXBkaXInXSwgJ2FyY190d2l0
dGVyJywgMSwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVy
X3R3ZWV0X2RlZmF1bHQnXSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1
bHQnLCAxLCAnYXJjX3R3aXR0ZXInLCAyLCAneWVzbm9SYWRpbycpOwppZiAoIWlzc2V0KCRw
cmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddKSkKICBzZXRfcHJlZignYXJjX3R3aXR0
ZXJfdXJsX21ldGhvZCcsICd0aW55dXJsJywgJ2FyY190d2l0dGVyJywgMiwKICAgICdhcmNf
dHdpdHRlcl91cmxfbWV0aG9kX3NlbGVjdCcpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3No
b3J0X3VybCddKSkKICBzZXRfcHJlZignYXJjX3Nob3J0X3VybCcsIDAsICdhcmNfdHdpdHRl
cicsIDIsICd5ZXNub1JhZGlvJyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfc2hvcnRfc2l0
ZV91cmwnXSkpCiAgc2V0X3ByZWYoJ2FyY19zaG9ydF9zaXRlX3VybCcsICRwcmVmc1snc2l0
ZXVybCddLCAnYXJjX3R3aXR0ZXInLCAyLCAndGV4dF9pbnB1dCcpOwovLyBNYWtlIHN1cmUg
dGhhdCB0aGUgVHdpdHRlciB0YWIgaGFzIGJlZW4gZGVmaW5lZAppZiAoIWlzc2V0KCRwcmVm
c1snYXJjX3R3aXR0ZXJfdGFiJ10pKSB7CiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3RhYics
ICdleHRlbnNpb25zJywgJ2FyY190d2l0dGVyJywgMiwKICAgICdhcmNfdHdpdHRlcl90YWJf
c2VsZWN0Jyk7CiAgICAkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddID0gJ2V4dGVuc2lvbnMn
Owp9CgovLyBDaGVjayBpZiBhcmNfc2hvcnRfdXJsIGlzIGVuYWJsZWQKaWYgKCRwcmVmc1sn
YXJjX3Nob3J0X3VybCddIHx8ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddPT0n
YXJjX3R3aXR0ZXInKSB7CiAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19zaG9ydF91cmxfcmVk
aXJlY3QnLCAndHhwX2RpZScsIDQwNCk7Cn0KCmlmIChAdHhwaW50ZXJmYWNlID09ICdhZG1p
bicpIHsKICAgIGlmICghZW1wdHkoJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10pCiAgICAg
ICAgJiYgIWVtcHR5KCRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXSkKICAgICAg
ICAmJiAhZW1wdHkoJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKSAp
IHsKCiAgICAgICAgaWYgKCRwcmVmc1snYXJjX3R3aXR0ZXJfdGFiJ10pIHsKICAgICAgICAg
ICAgYWRkX3ByaXZzKCdhcmNfYWRtaW5fdHdpdHRlcicsICcxLDIsMyw0Jyk7CiAgICAgICAg
ICAgIHJlZ2lzdGVyX3RhYigkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddLCAnYXJjX2FkbWlu
X3R3aXR0ZXInLCAnVHdpdHRlcicpOwogICAgICAgICAgICByZWdpc3Rlcl9jYWxsYmFjaygn
YXJjX2FkbWluX3R3aXR0ZXInLCAnYXJjX2FkbWluX3R3aXR0ZXInKTsKICAgICAgICB9Cgog
ICAgICAgIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYXJ0aWNsZV90d2VldCcsICdwaW5nJyk7
CiAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hcnRpY2xlX3R3ZWV0JywgJ2FydGlj
bGUnLCAnZWRpdCcsIDEpOwogICAgICAgIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYXBwZW5k
X3R3aXR0ZXInLCAnYXJ0aWNsZV91aScsICdzdGF0dXMnKTsKICAgIH0KfQoKLyoKICAgIFB1
YmxpYy1zaWRlIGZ1bmN0aW9ucwogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoqLwoKZnVuY3Rpb24gYXJjX3R3
aXR0ZXIoJGF0dHMpCnsKICBnbG9iYWwgJHByZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1lcktl
eSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICBleHRyYWN0KGxBdHRzKGFycmF5
KAogICAgJ3VzZXInICAgICAgPT4gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sCiAgICAn
cGFzc3dvcmQnICA9PiAnJywKICAgICd0aW1lbGluZScgID0+ICd1c2VyJywKICAgICdsaW1p
dCcgICAgID0+ICcxMCcsCiAgICAncmV0d2VldHMnICA9PiBmYWxzZSwKICAgICdkYXRlZm9y
bWF0Jz0+ICRwcmVmc1snYXJjaGl2ZV9kYXRlZm9ybWF0J10sCiAgICAnY2FjaGluZycgICA9
PiAnMScsCiAgICAnY2FjaGVfZGlyJyA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX2NhY2hlX2Rp
ciddLAogICAgJ2NhY2hlX3RpbWUnPT4gJzUnLAogICAgJ2xhYmVsJyAgICAgPT4gJycsCiAg
ICAnbGFiZWx0YWcnICA9PiAnJywKICAgICdicmVhaycgICAgID0+ICdsaScsCiAgICAnd3Jh
cHRhZycgICA9PiAnJywKICAgICdjbGFzcycgICAgID0+IF9fRlVOQ1RJT05fXywKICAgICdj
bGFzc19wb3N0ZWQnID0+IF9fRlVOQ1RJT05fXy4nLXBvc3RlZCcKICAgICksJGF0dHMpKTsK
CiAgJHR3aXQgPSBuZXcgYXJjX1R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAk
YXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQpOwoKICBpZiAoJGNhY2hpbmcpIHsgIC8vIHR1
cm4gb24gY2FjaGluZywgcmVjb21tZW5kZWQgKGRlZmF1bHQpCiAgICAkdHdpdC0+c2V0Q2Fj
aGluZyh0cnVlKTsKICAgICR0d2l0LT5jYWNoZURpcigkY2FjaGVfZGlyKTsKICAgICR0d2l0
LT5jYWNoZVRpbWUoJGNhY2hlX3RpbWUpOwogIH0gZWxzZSB7ICAvLyB0dXJuIG9mZiBjYWNo
aW5nLCBub3QgcmVjb21tZW5kZWQgb3RoZXIgdGhhbiBmb3IgdGVzdGluZwogICAgJHR3aXQt
PnNldENhY2hpbmcoZmFsc2UpOwogIH0KCiAgc3dpdGNoICgkdGltZWxpbmUpIHsKICAgIGNh
c2UgJ2hvbWUnOiBjYXNlICdmcmllbmRzJzoKICAgICAgJHRpbWVsaW5lID0gJ3N0YXR1c2Vz
L2ZyaWVuZHNfdGltZWxpbmUnOyBicmVhazsKICAgIGNhc2UgJ21lbnRpb25zJzoKICAgICAg
JHRpbWVsaW5lID0gJ3N0YXR1c2VzL21lbnRpb25zJzsgYnJlYWs7CiAgICBjYXNlICd1c2Vy
JzogZGVmYXVsdDogJHRpbWVsaW5lID0gJ3N0YXR1c2VzL3VzZXJfdGltZWxpbmUnOwogIH0K
CiAgJG91dCA9IGFycmF5KCk7CiAgJHhtbCA9ICR0d2l0LT5nZXQoJHRpbWVsaW5lCiAgICAs
IGFycmF5KCdzY3JlZW5fbmFtZSc9PiR1c2VyLCdjb3VudCc9PiRsaW1pdCwnaW5jbHVkZV9y
dHMnPT4kcmV0d2VldHMpKTsKICBpZiAoJHhtbCkgewogICAgJHR3ZWV0cyA9IEAkeG1sLT54
cGF0aCgnL3N0YXR1c2VzL3N0YXR1cycpOwogICAgaWYgKCR0d2VldHMpIGZvcmVhY2ggKCR0
d2VldHMgYXMgJHR3ZWV0KSB7CiAgICAgICR0aW1lID0gc3RydG90aW1lKGh0bWxlbnRpdGll
cygkdHdlZXQtPmNyZWF0ZWRfYXQpKTsKICAgICAgJGRhdGUgPSBzYWZlX3N0cmZ0aW1lKCRk
YXRlZm9ybWF0LCR0aW1lKTsKICAgICAgJG91dFtdID0gYXJjX1R3aXR0ZXI6Om1ha2VMaW5r
cyhodG1sZW50aXRpZXMoJHR3ZWV0LT50ZXh0LCBFTlRfUVVPVEVTLCdVVEYtOCcpKQogICAg
ICAgIC4nICcudGFnKGh0bWxlbnRpdGllcygkZGF0ZSksJ3NwYW4nLCcgY2xhc3M9IicuJGNs
YXNzX3Bvc3RlZC4nIicpOwogICAgfQoKICAgIHJldHVybiBkb0xhYmVsKCRsYWJlbCwgJGxh
YmVsdGFnKS5kb1dyYXAoJG91dCwgJHdyYXB0YWcsICRicmVhaywgJGNsYXNzKTsKICB9Cgp9
CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl9zZWFyY2goJGF0dHMpCnsKICAgIGdsb2JhbCAkcHJl
ZnMsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNy
ZXQ7CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgICAndXNlcicgICAgICA9PiAk
cHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSwKICAgICAgICAnc2VhcmNoJyAgICA9PiAnJywK
ICAgICAgICAnaGFzaHRhZ3MnICA9PiAnJywKICAgICAgICAndXNlcicgICAgICA9PiAnJywK
ICAgICAgICAncmVwbHknICAgICA9PiAnJywKICAgICAgICAnbWVudGlvbicgICA9PiAnJywK
ICAgICAgICAnbGltaXQnICAgICA9PiAnMTAnLAogICAgICAgICdsYW5nJyAgICAgID0+ICcn
LAogICAgICAgICdkYXRlZm9ybWF0Jz0+ICRwcmVmc1snYXJjaGl2ZV9kYXRlZm9ybWF0J10s
CiAgICAgICAgJ2NhY2hpbmcnICAgPT4gJzEnLAogICAgICAgICdjYWNoZV9kaXInID0+ICRw
cmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10sCiAgICAgICAgJ2NhY2hlX3RpbWUnPT4g
JzUnLAogICAgICAgICdsYWJlbCcgICAgID0+ICcnLAogICAgICAgICdsYWJlbHRhZycgID0+
ICcnLAogICAgICAgICdicmVhaycgICAgID0+ICdsaScsCiAgICAgICAgJ3dyYXB0YWcnICAg
PT4gJycsCiAgICAgICAgJ2NsYXNzJyAgICAgPT4gX19GVU5DVElPTl9fLAogICAgICAgICdj
bGFzc19wb3N0ZWQnID0+IF9fRlVOQ1RJT05fXy4nLXBvc3RlZCcsCiAgICAgICAgJ2NsYXNz
X3VzZXInICAgPT4gX19GVU5DVElPTl9fLictdXNlcicKICAgICksJGF0dHMpKTsKCiAgICAg
ICAgJHR3aXQgPSBuZXcgYXJjX1R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAg
ICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0KTsKCiAgICAgICAgaWYg
KCRjYWNoaW5nKSB7ICAvLyB0dXJuIG9uIGNhY2hpbmcsIHJlY29tbWVuZGVkIChkZWZhdWx0
KQogICAgICAgICAgICAkdHdpdC0+c2V0Q2FjaGluZyh0cnVlKTsKICAgICAgICAgICAgJHR3
aXQtPmNhY2hlRGlyKCRjYWNoZV9kaXIpOwogICAgICAgICAgICAkdHdpdC0+Y2FjaGVUaW1l
KCRjYWNoZV90aW1lKTsKICAgICAgICB9IGVsc2UgeyAgLy8gdHVybiBvZmYgY2FjaGluZywg
bm90IHJlY29tbWVuZGVkIG90aGVyIHRoYW4gZm9yIHRlc3RpbmcKICAgICAgICAgICAgJHR3
aXQtPnNldENhY2hpbmcoZmFsc2UpOwogICAgICAgIH0KCiAgICAgICAgLy8gY29uc3RydWN0
IHNlYXJjaCBxdWVyeQogICAgICAgIGlmICghZW1wdHkoJHNlYXJjaCkpIHsKICAgICAgICAg
ICAgJHRlcm1zID0gZXhwbG9kZSgnLCcsJHNlYXJjaCk7ICR0ZXJtcyA9IGFycmF5X21hcCgn
dHJpbScsJHRlcm1zKTsKICAgICAgICAgICAgJHNlYXJjaCA9IGltcGxvZGUoJyAnLCR0ZXJt
cyk7CiAgICAgICAgfQogICAgICAgIGlmICgkaGFzaHRhZ3MpIHsKICAgICAgICAgICAgJGhh
c2hlcyA9IGV4cGxvZGUoJywnLCRoYXNodGFncyk7ICRoYXNoZXMgPSBhcnJheV9tYXAoJ3Ry
aW0nLCRoYXNoZXMpOwogICAgICAgICAgICAkc2VhcmNoLj0gKCgkc2VhcmNoKT8nICc6Jycp
LicjJy5pbXBsb2RlKCcgIycsJGhhc2hlcyk7CiAgICAgICAgfQogICAgICAgIGlmICgkcmVw
bHkpIHsKICAgICAgICAgICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/JyAnOicnKS4ndG86Jy50
cmltKCRyZXBseSk7CiAgICAgICAgfQogICAgICAgIGlmICgkdXNlcikgewogICAgICAgICAg
ICAkc2VhcmNoLj0gKCgkc2VhcmNoKT8nICc6JycpLidmcm9tOicudHJpbSgkdXNlcik7CiAg
ICAgICAgfQogICAgICAgIGlmICgkbWVudGlvbikgewogICAgICAgICAgICAkc2VhcmNoLj0g
KCgkc2VhcmNoKT8nICc6JycpLidAJy50cmltKCRtZW50aW9uKTsKICAgICAgICB9CgogICAg
ICAgIGlmIChlbXB0eSgkc2VhcmNoKSkgewogICAgICAgICAgICByZXR1cm4gJyc7CiAgICAg
ICAgfSBlbHNlIHsKICAgICAgICAgICAgJHNlYXJjaCA9IHVybGVuY29kZSgkc2VhcmNoKTsK
ICAgICAgICB9CgogICAgICAgICRvdXQgPSBhcnJheSgpOwogICAgICAgICR0d2VldHMgPSAk
dHdpdC0+Z2V0KCdodHRwOi8vc2VhcmNoLnR3aXR0ZXIuY29tL3NlYXJjaC5hdG9tP3E9Jy4k
c2VhcmNoCiAgICAgICAgICAgICwgYXJyYXkoJ3JwcCc9PiRsaW1pdCwnbGFuZyc9PiRsYW5n
KSk7CgogICAgICAgIGlmICgkdHdlZXRzKSB7IGZvcmVhY2ggKCR0d2VldHMtPmVudHJ5IGFz
ICR0d2VldCkgewogICAgICAgICAgICBwcmVnX21hdGNoKCIvKC4qKSBcKCguKilcKS8iLCR0
d2VldC0+YXV0aG9yLT5uYW1lLCRtYXRjaGVzKTsKICAgICAgICAgICAgbGlzdCgkYXV0aG9y
LCR1bmFtZSwkbmFtZSkgPSAkbWF0Y2hlczsKICAgICAgICAgICAgJHRpbWUgPSBzdHJ0b3Rp
bWUoaHRtbGVudGl0aWVzKCR0d2VldC0+cHVibGlzaGVkKSk7CiAgICAgICAgICAgICRkYXRl
ID0gc2FmZV9zdHJmdGltZSgkZGF0ZWZvcm1hdCwkdGltZSk7CiAgICAgICAgICAgICR0ZXh0
ID0gJHR3ZWV0LT50aXRsZTsKICAgICAgICAgICAgJG91dFtdID0gdGFnKGhyZWYoaHRtbGVu
dGl0aWVzKCR1bmFtZSksJHR3ZWV0LT5hdXRob3ItPnVyaSwKICAgICAgICAgICAgICAgICcg
dGl0bGU9IicuaHRtbGVudGl0aWVzKCRuYW1lKS4nIicpLic6ICcsJ3NwYW4nCiAgICAgICAg
ICAgICAgICAgICAgLCcgY2xhc3M9IicuJGNsYXNzX3VzZXIuJyInKQogICAgICAgICAgICAg
ICAgLmFyY19Ud2l0dGVyOjptYWtlTGlua3MoaHRtbGVudGl0aWVzKCR0ZXh0LCBFTlRfUVVP
VEVTLCdVVEYtOCcpKQogICAgICAgICAgICAgICAgLicgJy50YWcoaHRtbGVudGl0aWVzKCRk
YXRlKSwnc3BhbicKICAgICAgICAgICAgICAgICAgICAsJyBjbGFzcz0iJy4kY2xhc3NfcG9z
dGVkLiciJyk7CiAgICAgICAgfSByZXR1cm4gZG9MYWJlbCgkbGFiZWwsICRsYWJlbHRhZykK
ICAgICAgICAgICAgLmRvV3JhcCgkb3V0LCAkd3JhcHRhZywgJGJyZWFrLCAkY2xhc3MpOyB9
Cgp9CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl90d2VldCgkYXR0cykgewogICAgZ2xvYmFsICR0
aGlzYXJ0aWNsZTsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAnaWQnICAgICAg
ICA9PiAkdGhpc2FydGljbGVbJ3RoaXNpZCddLAogICAgICAnaW5jbHVkZV91cmwnICAgPT4g
dHJ1ZQogICAgKSwkYXR0cykpOwoKICAgIGlmICgkaWQpIHsKICAgICAgLy8gRmV0Y2ggYXJj
X3R3aXR0ZXIgc3R1ZmYgdG8gYnVpbGQgdHdlZXQgZnJvbQogICAgICAkdHdlZXQgPSAoJGlu
Y2x1ZGVfdXJsKSA/IHNhZmVfcm93KCJ0d2VldCIsICdhcmNfdHdpdHRlcicsICJhcnRpY2xl
X2lkPXskaWR9IikKICAgICAgICA6IHNhZmVfcm93KCJSRVBMQUNFKHR3ZWV0LENPTkNBVCgn
ICcsdGlueXVybCksJycpIEFTIHR3ZWV0IgogICAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAi
YXJ0aWNsZV9pZD17JGlkfSIpOwogICAgfQoKICAgIGlmICgkdHdlZXRbJ3R3ZWV0J10pIHsK
ICAgICAgcmV0dXJuIGFyY19Ud2l0dGVyOjptYWtlTGlua3MoCiAgICAgICAgaHRtbGVudGl0
aWVzKCR0d2VldFsndHdlZXQnXSwgRU5UX1FVT1RFUywnVVRGLTgnKSk7CiAgICB9Cn0KCmZ1
bmN0aW9uIGFyY190d2l0dGVyX3R3ZWV0X3VybCgkYXR0cywgJHRoaW5nPW51bGwpIHsKICAg
IGdsb2JhbCAkdGhpc2FydGljbGUsJHByZWZzOwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXko
CiAgICAgICdpZCcgICAgICA9PiAkdGhpc2FydGljbGVbJ3RoaXNpZCddLAogICAgICAndGl0
bGUnICAgPT4gJycsCiAgICAgICdjbGFzcycgICA9PiAnJwogICAgKSwkYXR0cykpOwoKICAg
IGlmICgkaWQpIHsKICAgICAgLy8gRmV0Y2ggYXJjX3R3aXR0ZXIgc3R1ZmYgdG8gYnVpbGQg
dHdlZXQgZnJvbQogICAgICAkdHdlZXQgPSBzYWZlX3JvdygidHdlZXRfaWQiCiAgICAgICAg
LCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlkfSIpOwogICAgfQoKICAgIGlmICgk
dHdlZXRbJ3R3ZWV0X2lkJ10pIHsKICAgICAgJHVybCA9ICJodHRwOi8vdHdpdHRlci5jb20v
Ii4kcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXS4iL3N0YXR1cy8iLiR0d2VldFsndHdlZXRf
aWQnXTsKICAgICAgaWYgKCR0aGluZz09PW51bGwpIHsKICAgICAgICByZXR1cm4gJHVybDsK
ICAgICAgfQogICAgICByZXR1cm4gaHJlZihwYXJzZSgkdGhpbmcpLCAkdXJsLAogICAgICAg
ICgkdGl0bGUgPyAnIHRpdGxlPSInLiR0aXRsZS4nIicgOiAnJykKICAgICAgICAuKCRjbGFz
cyA/ICcgY2xhc3M9IicuJGNsYXNzLiciJyA6ICcnKSk7CiAgICB9Cn0KCmZ1bmN0aW9uIGFy
Y190d2l0dGVyX3Rpbnl1cmwoJGF0dHMsICR0aGluZz1udWxsKSB7CiAgICBnbG9iYWwgJHRo
aXNhcnRpY2xlOwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICdpZCcgICAgICA9
PiAkdGhpc2FydGljbGVbJ3RoaXNpZCddLAogICAgICAndGl0bGUnICAgPT4gJycsCiAgICAg
ICdjbGFzcycgICA9PiAnJwogICAgKSwkYXR0cykpOwoKICAgIGlmICgkaWQpIHsKICAgICAg
Ly8gRmV0Y2ggYXJjX3R3aXR0ZXIgc3R1ZmYgdG8gYnVpbGQgdHdlZXQgZnJvbQogICAgICAk
dHdlZXQgPSBzYWZlX3JvdygidGlueXVybCIKICAgICAgICAsICdhcmNfdHdpdHRlcicsICJh
cnRpY2xlX2lkPXskaWR9Iik7CiAgICB9CgogICAgaWYgKCR0d2VldFsndGlueXVybCddKSB7
CiAgICAgIGlmICgkdGhpbmc9PT1udWxsKSB7CiAgICAgICAgcmV0dXJuICR0d2VldFsndGlu
eXVybCddOwogICAgICB9CgogICAgICByZXR1cm4gaHJlZihwYXJzZSgkdGhpbmcpLCAkdHdl
ZXRbJ3Rpbnl1cmwnXSwKICAgICAgICAoJHRpdGxlID8gJyB0aXRsZT0iJy4kdGl0bGUuJyIn
IDogJycpCiAgICAgICAgLigkY2xhc3MgPyAnIGNsYXNzPSInLiRjbGFzcy4nIicgOiAnJykp
OwogICAgfQp9CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl9yZXR3ZWV0KCRhdHRzLCAkdGhpbmc9
bnVsbCkKewogICAgZ2xvYmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRh
cmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKICAgIGdsb2JhbCAkdGhpc2FydGljbGU7Cgog
ICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgICAndXNlcicgICAgICA9PiAkcHJlZnNb
J2FyY190d2l0dGVyX3VzZXInXSwgLy8gdmlhIHVzZXIgYWNjb3VudAogICAgICAgICd1cmwn
ICAgICAgID0+ICcnLAogICAgICAgICd0ZXh0JyAgICAgID0+ICcnLAogICAgICAgICdmb2xs
b3cxJyAgID0+ICcnLAogICAgICAgICdmb2xsb3cyJyAgID0+ICcnLAogICAgICAgICdsYW5n
JyAgICAgID0+ICcnLAogICAgICAgICdjb3VudCcgICAgID0+ICdob3Jpem9udGFsJywKICAg
ICAgICAnaW5jbHVkZV9qcyc9PiB0cnVlLAogICAgICAgICd3cmFwdGFnJyAgID0+ICcnLAog
ICAgICAgICdjbGFzcycgICAgID0+ICd0d2l0dGVyLXNoYXJlLWJ1dHRvbicKICAgICksJGF0
dHMpKTsKCiAgICAkcSA9ICcnOyAvLyBxdWVyeSBzdHJpbmcKCiAgICBpZiAoJGlkPSR0aGlz
YXJ0aWNsZVsndGhpc2lkJ10pIHsKICAgICAgLy8gRmV0Y2ggYXJjX3R3aXR0ZXIgc3R1ZmYg
dG8gYnVpbGQgdHdlZXQgZnJvbQogICAgICAkcm93ID0gc2FmZV9yb3coIlJFUExBQ0UodHdl
ZXQsQ09OQ0FUKCcgJyx0aW55dXJsKSwnJykgQVMgdHdlZXQsdGlueXVybCIKICAgICAgICAs
ICdhcmNfdHdpdHRlcicsICJhcnRpY2xlX2lkPXskaWR9Iik7CgogICAgICBpZiAoJHVybD09
JycpIHsKICAgICAgICAkdXJsID0gKCR1cmwpID8gJHVybCA6IHBlcm1saW5rdXJsKCR0aGlz
YXJ0aWNsZSk7CiAgICAgICAgJHEgPSAndXJsPScudXJsZW5jb2RlKCR1cmwpOwogICAgICB9
CiAgICAgIGlmICgkdGV4dD09JycpIHsKICAgICAgICAkdGV4dCA9ICgkcm93Wyd0d2VldCdd
KSA/ICRyb3dbJ3R3ZWV0J10gOiAkdGhpc2FydGljbGVbJ3RpdGxlJ107CiAgICAgIH0KICAg
ICAgJHEgLj0gKCRxID8gJyZhbXA7JyA6ICcnKS4ndGV4dD0nLnVybGVuY29kZSgkdGV4dCk7
CiAgICB9CiAgICBpZiAoJHVzZXIpIHsKICAgICAgJHEgLj0gKCRxID8gJyZhbXA7JyA6ICcn
KS4ndmlhPScudXJsZW5jb2RlKCR1c2VyKTsKICAgIH0KICAgIGlmICgkZm9sbG93MSYmJGZv
bGxvdzIpIHsKICAgICAgJHEgLj0gKCRxID8gJyZhbXA7JyA6ICcnKS4ncmVsYXRlZD0nLnVy
bGVuY29kZSgkZm9sbG93MS4nOicuJGZvbGxvdzIpOwogICAgfSBlbHNlaWYgKCRmb2xsb3cx
fHwkZm9sbG93MikgewogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidyZWxhdGVk
PScudXJsZW5jb2RlKCRmb2xsb3cxLiRmb2xsb3cyKTsKICAgIH0KCiAgICBzd2l0Y2ggKCRs
YW5nKSB7CiAgICAgIGNhc2UgJ2ZyJzogYnJlYWs7IGNhc2UgJ2RlJzogYnJlYWs7IGNhc2Ug
J2VzJzogYnJlYWs7IGNhc2UgJ2pwJzogYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAg
JGxhbmcgPSAnZW4nOwogICAgfQogICAgJHEgLj0gKCRxID8gJyZhbXA7JyA6ICcnKS4nbGFu
Zz0nLnVybGVuY29kZSgkbGFuZyk7CgogICAgc3dpdGNoICgkY291bnQpIHsKICAgICAgY2Fz
ZSAnbm9uZSc6IGJyZWFrOyBjYXNlICd2ZXJ0aWNhbCc6IGJyZWFrOwogICAgICBkZWZhdWx0
OgogICAgICAgICRjb3VudCA9ICdob3Jpem9udGFsJzsKICAgIH0KICAgICRxIC49ICgkcSA/
ICcmYW1wOycgOiAnJykuJ2NvdW50PScudXJsZW5jb2RlKCRjb3VudCk7CgogICAgJHRoaW5n
ID0gKCR0aGluZz09PW51bGwpID8gJ1R3ZWV0JyA6IHBhcnNlKCR0aGluZyk7CgogICAgJGh0
bWwgPSBocmVmKCR0aGluZywnaHR0cDovL3R3aXR0ZXIuY29tL3NoYXJlPycuJHEKICAgICAg
LCAnIGNsYXNzPSInLiRjbGFzcy4nIicpOwoKICAgICRqcyA9ICgkaW5jbHVkZV9qcykgPwog
ICAgICAnPHNjcmlwdCBzcmM9Imh0dHA6Ly9wbGF0Zm9ybS50d2l0dGVyLmNvbS93aWRnZXRz
LmpzIiB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPjwvc2NyaXB0PicKICAgICAgOiAnJzsKCiAg
ICByZXR1cm4gJGpzLiRodG1sOwp9CgovKgogICAgQWRtaW4tc2lkZSBmdW5jdGlvbnMKICAg
ID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0KKi8KCi8vIEluc3RhbGxhdGlvbiBmdW5jdGlvbiAtIGJ1aWxkcyBNeVNR
TCB0YWJsZQpmdW5jdGlvbiBhcmNfdHdpdHRlcl9pbnN0YWxsKCkKewoKICAgIC8vIEZvciBm
aXJzdCBpbnN0YWxsLCBjcmVhdGUgdGFibGUgZm9yIHR3ZWV0cwogICAgJHNxbCA9ICJDUkVB
VEUgVEFCTEUgSUYgTk9UIEVYSVNUUyAiLlBGWC4iYXJjX3R3aXR0ZXIgIjsKICAgICRzcWwu
PSAiKGFyY190d2l0dGVyaWQgSU5URUdFUiBBVVRPX0lOQ1JFTUVOVCBQUklNQVJZIEtFWSwK
ICAgICAgICBhcnRpY2xlX2lkIElOVEVHRVIoMTEpLAogICAgICAgIHR3ZWV0X2lkIEJJR0lO
VCgyMCksCiAgICAgICAgdHdlZXQgVkFSQ0hBUigxNDApLAogICAgICAgIHRpbnl1cmwgVkFS
Q0hBUigzMCkpOyI7CgogICAgaWYgKCFzYWZlX3F1ZXJ5KCRzcWwpKSB7CiAgICAgICAgcmV0
dXJuICdFcnJvciAtIHVuYWJsZSB0byBjcmVhdGUgYXJjX3R3aXR0ZXIgdGFibGUnOwogICAg
fQoKfQoKLy8gVW5pbnN0YWxsIGZ1bmN0aW9uIC0gZGVsZXRlcyBNeVNRTCB0YWJsZSBhbmQg
cmVsYXRlZCBwcmVmZXJlbmNlcwpmdW5jdGlvbiBhcmNfdHdpdHRlcl91bmluc3RhbGwoKQp7
CgogICAgJHNxbCA9ICJEUk9QIFRBQkxFIElGIEVYSVNUUyAiLlBGWC4iYXJjX3R3aXR0ZXI7
IjsKICAgIGlmICghc2FmZV9xdWVyeSgkc3FsKSkgewogICAgICAgIHJldHVybiAnRXJyb3Ig
LSB1bmFibGUgdG8gZGVsZXRlIGFyY190d2l0dGVyIHRhYmxlJzsKICAgIH0KCiAgICAkc3Fs
ID0gIkRFTEVURSBGUk9NICAiLlBGWC4idHhwX3ByZWZzIFdIRVJFIGV2ZW50PSdhcmNfdHdp
dHRlcic7IjsKICAgIGlmICghc2FmZV9xdWVyeSgkc3FsKSkgewogICAgICAgIHJldHVybiAn
RXJyb3IgLSB1bmFibGUgdG8gZGVsZXRlIGFyY190d2l0dGVyIHByZWZlcmVuY2VzJzsKICAg
IH0KCn0KZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdXJsX21ldGhvZF9zZWxlY3QoJG5hbWUsICR2
YWwpCnsKICAgICRtZXRob2RzID0gYXJyYXkoJ3Rpbnl1cmwnID0+ICdUaW55dXJsJywKICAg
ICAgJ2lzZ2QnID0+ICdJcy5nZCcsCiAgICAgICdhcmNfdHdpdHRlcicgPT4gJ1RYUCBUd2Vl
dCcsCiAgICAgICdzbWQnID0+ICdzbWRfc2hvcnRfdXJsJyk7CiAgICByZXR1cm4gc2VsZWN0
SW5wdXQoJG5hbWUsICRtZXRob2RzLCAkdmFsKTsKfQpmdW5jdGlvbiBhcmNfdHdpdHRlcl90
YWJfc2VsZWN0KCRuYW1lLCAkdmFsKQp7CiAgICAkdGFicyA9IGFycmF5KCdjb250ZW50JyA9
PiAnQ29udGVudCcsCiAgICAgICAgJ2V4dGVuc2lvbnMnID0+ICdFeHRlbnNpb25zJywKICAg
ICAgICAnJyA9PiAnSGlkZGVuJyk7CiAgICByZXR1cm4gc2VsZWN0SW5wdXQoJG5hbWUsICR0
YWJzLCAkdmFsKTsKfQovLyBQcm92aWRlIGludGVyZmFjZSBmb3Igc2V0dGluZyBwcmVmZXJl
bmNlcwpmdW5jdGlvbiBhcmNfdHdpdHRlcl9wcmVmcygkZXZlbnQsJHN0ZXApCnsKCiAgICBn
bG9iYWwgJHByZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwkYXJjX3R3aXR0ZXJfY29u
c3VtZXJTZWNyZXQ7CgogICAgJHVzZXIgICAgICAgICAgPSAkcHJlZnNbJ2FyY190d2l0dGVy
X3VzZXInXTsKICAgICRwcmVmaXggICAgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl9wcmVm
aXgnXTsKICAgICR0d2VldF9kZWZhdWx0ID0gJHByZWZzWydhcmNfdHdpdHRlcl90d2VldF9k
ZWZhdWx0J107CiAgICAkdXJsX21ldGhvZCAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXJs
X21ldGhvZCddOwogICAgJHNob3J0X3VybCAgICAgPSAkcHJlZnNbJ2FyY19zaG9ydF91cmwn
XTsKICAgICRzaG9ydF9zaXRlX3VybD0gJHByZWZzWydhcmNfc2hvcnRfc2l0ZV91cmwnXTsK
ICAgICRjYWNoZV9kaXIgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXTsK
ICAgICR0YWIgICAgICAgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl90YWInXTsKCiAgICBz
d2l0Y2ggKCRzdGVwKSB7CiAgICAgICAgY2FzZSAncHJlZnNfc2F2ZSc6IHBhZ2V0b3AoJ1RY
UCBUd2VldCcsICdQcmVmZXJlbmNlcyBzYXZlZCcpOyBicmVhazsKICAgICAgICBjYXNlICdy
ZWdpc3Rlcic6IHBhZ2V0b3AoJ1RYUCBUd2VldCcsJ0Nvbm5lY3QgdG8gVHdpdHRlcicpOyBi
cmVhazsKICAgICAgICBjYXNlICd2YWxpZGF0ZSc6CiAgICAgICAgZGVmYXVsdDogcGFnZXRv
cCgnVFhQIFR3ZWV0Jyk7CiAgICB9CgogICAgJGh0bWwgPSAnJzsKCiAgICBpZiAoJHN0ZXA9
PSdyZWdpc3RlcicpIHsgLy8gT0F1dGggcmVnaXN0cmF0aW9uIHByb2Nlc3MKICAgICAgICAk
dHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAg
ICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQpOwoKICAgICAgICAvLyBCdWls
ZCBhIGNhbGxiYWNrIFVSTCBmb3IgVHdpdHRlciB0byByZXR1cm4gdG8gdGhlIG5leHQgc3Rh
Z2UKICAgICAgICAkY2FsbGJhY2tVUkwgPSAkdHdpdC0+Y2FsbGJhY2tVUkwoJGV2ZW50LCd2
YWxpZGF0ZScpOwoKICAgICAgICAkcmVxdWVzdCA9ICR0d2l0LT5nZXRSZXF1ZXN0VG9rZW4o
JGNhbGxiYWNrVVJMKTsKICAgICAgICAkcmVxdWVzdF90b2tlbiA9ICRyZXF1ZXN0WyJvYXV0
aF90b2tlbiJdOwogICAgICAgICRyZXF1ZXN0X3Rva2VuX3NlY3JldCA9ICRyZXF1ZXN0WyJv
YXV0aF90b2tlbl9zZWNyZXQiXTsKCiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3Jl
cXVlc3RUb2tlbicsJHJlcXVlc3RfdG9rZW4KICAgICAgICAgICAgLCAnYXJjX3R3aXR0ZXIn
LDIpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9yZXF1ZXN0VG9rZW5TZWNyZXQn
LCRyZXF1ZXN0X3Rva2VuX3NlY3JldAogICAgICAgICAgICAsICdhcmNfdHdpdHRlcicsMik7
CgogICAgICAgICRodG1sLj0gc3RhcnRUYWJsZSgnZWRpdCcpLgogICAgICAgICAgICAgICAg
dHIodGQoCiAgICAgICAgICAgICAgICAgICAgKCc8cD4nLmhyZWYoJ1NpZ24taW4gdG8gVHdp
dHRlcicKICAgICAgICAgICAgICAgICAgICAgICAgICAgICwkdHdpdC0+Z2V0QXV0aG9yaXpl
VVJMKCRyZXF1ZXN0KSkKICAgICAgICAgICAgICAgICAgICAgICAgLicgYW5kIGZvbGxvdyB0
aGUgaW5zdHJ1Y3Rpb25zIHRvIGFsbG93IFRYUCBUd2VldCB0byB1c2UgeW91ciBhY2NvdW50
LiBJZiB5b3UgYXJlIGFscmVhZHkgc2lnbmVkIGluIHRvIFR3aXR0ZXIgdGhlbiB0aGF0IGFj
Y291bnQgd2lsbCBiZSBhc3NvY2lhdGVkIHdpdGggVFhQIFR3ZWV0IHNvIHlvdSBtYXkgbmVl
ZCB0byBzaWduIG91dCBmaXJzdCBpZiB5b3Ugd2FudCB0byB1c2UgYSBkaWZmZXJlbnQgYWNj
b3VudC48L3A+JykKICAgICAgICAgICAgICAgICkpLmVuZFRhYmxlKCk7CiAgICB9IGVsc2Vp
ZiAoJHN0ZXA9PSd2YWxpZGF0ZScpIHsKICAgICAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRl
cigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJf
Y29uc3VtZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfcmVxdWVzdFRva2VuJ10KICAg
ICAgICAgICAgLCAkcHJlZnNbJ2FyY190d2l0dGVyX3JlcXVlc3RUb2tlblNlY3JldCddKTsK
ICAgICAgICAvLyBBc2sgVHdpdHRlciBmb3IgYW4gYWNjZXNzIHRva2VuIChhbmQgYW4gYWNj
ZXNzIHRva2VuIHNlY3JldCkKICAgICAgICAkcmVxdWVzdCA9ICR0d2l0LT5nZXRBY2Nlc3NU
b2tlbiggZ3BzKCdvYXV0aF92ZXJpZmllcicpICk7CiAgICAgICAgJGFjY2Vzc190b2tlbiA9
ICRyZXF1ZXN0WydvYXV0aF90b2tlbiddOwogICAgICAgICRhY2Nlc3NfdG9rZW5fc2VjcmV0
ID0gJHJlcXVlc3RbJ29hdXRoX3Rva2VuX3NlY3JldCddOwogICAgICAgICR1c2VyID0gJHJl
cXVlc3RbJ3NjcmVlbl9uYW1lJ107CiAgICAgICAgLy8gU3RvcmUgdGhlIGFjY2VzcyB0b2tl
biBhbmQgc2VjcmV0CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2Vu
JywkYWNjZXNzX3Rva2VuLCAnYXJjX3R3aXR0ZXInLDIpOwogICAgICAgIHNldF9wcmVmKCdh
cmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCcsJGFjY2Vzc190b2tlbl9zZWNyZXQKICAg
ICAgICAgICAgLCAnYXJjX3R3aXR0ZXInLDIpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdp
dHRlcl91c2VyJywkdXNlcik7CiAgICAgICAgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NU
b2tlbiddID0gJGFjY2Vzc190b2tlbjsKICAgICAgICAkcHJlZnNbJ2FyY190d2l0dGVyX2Fj
Y2Vzc1Rva2VuU2VjcmV0J10gPSAkYWNjZXNzX3Rva2VuX3NlY3JldDsKICAgICAgICB1bnNl
dCgkdHdpdCk7CiAgICB9CgogICAgaWYgKCRzdGVwPT0icHJlZnNfc2F2ZSIpIHsKICAgICAg
ICAkcHJlZml4ID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3ByZWZpeCcpKTsKICAgICAgICAk
dHdlZXRfZGVmYXVsdCA9IGdwcygnYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcpOwogICAg
ICAgICR1cmxfbWV0aG9kID0gZ3BzKCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJyk7CiAgICAg
ICAgJHNob3J0X3VybCA9IGdwcygnYXJjX3Nob3J0X3VybCcpOwogICAgICAgICRzaG9ydF9z
aXRlX3VybCA9IGdwcygnYXJjX3Nob3J0X3NpdGVfdXJsJyk7CiAgICAgICAgJGNhY2hlX2Rp
ciA9IGdwcygnYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJyk7CiAgICAgICAgJHRhYiA9IGdwcygn
YXJjX3R3aXR0ZXJfdGFiJyk7CiAgICAgICAgaWYgKHN0cmxlbigkcHJlZml4KTw9MjApIHsK
ICAgICAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3ByZWZpeCcsJHByZWZpeCk7CiAg
ICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJHByZWZpeCA9ICRwcmVmc1snYXJjX3R3aXR0
ZXJfcHJlZml4J107CiAgICAgICAgfQogICAgICAgICR0d2VldF9kZWZhdWx0ID0gKCR0d2Vl
dF9kZWZhdWx0KSA/IDEgOiAwOwogICAgICAgICRzaG9ydF91cmwgPSAoJHNob3J0X3VybCkg
PyAxIDogMDsKICAgICAgICBpZiAoISRzaG9ydF9zaXRlX3VybCkgJHNob3J0X3NpdGVfdXJs
ID0gJHByZWZzWydzaXRldXJsJ107CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3R3
ZWV0X2RlZmF1bHQnLCR0d2VldF9kZWZhdWx0KTsKICAgICAgICBzZXRfcHJlZignYXJjX3No
b3J0X3VybCcsJHNob3J0X3VybCk7CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3Vy
bF9tZXRob2QnLCR1cmxfbWV0aG9kKTsKICAgICAgICBzZXRfcHJlZignYXJjX3Nob3J0X3Np
dGVfdXJsJywkc2hvcnRfc2l0ZV91cmwpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRl
cl9jYWNoZV9kaXInLCRjYWNoZV9kaXIpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRl
cl90YWInLCR0YWIpOwogICAgfQoKICAgIGlmICggJHN0ZXAhPSdyZWdpc3RlcicgKSB7CiAg
ICAgICAgaWYgKCBpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10pCiAg
ICAgICAgJiYgaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCdd
KSApIHsKICAgICAgICAgICAgJHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVy
X2NvbnN1bWVyS2V5CiAgICAgICAgICAgICAgICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNl
Y3JldCwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddCiAgICAgICAgICAgICAg
ICAsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSk7CiAgICAgICAg
ICAgICRyZWdpc3RlclVSTCA9ICR0d2l0LT5jYWxsYmFja1VSTCgkZXZlbnQsJ3JlZ2lzdGVy
Jyk7CiAgICAgICAgICAgICRodG1sLj0gc3RhcnRUYWJsZSgnbGlzdCcpLmZvcm0oCiAgICAg
ICAgICAgICAgICB0cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVHdpdHRlciBh
Y2NvdW50IGRldGFpbHMnLCAyKSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAg
ICAgLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0
ZXJfdXNlciI+VHdpdHRlciB1c2VybmFtZTwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAg
ICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRk
bGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKAogICAgICAgICAgICAgICAgICAgICAg
ICAoJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10pID8KICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICR1c2VyLicgKCcuaHJlZignUmUtY29ubmVjdCcsJHJlZ2lzdGVyVVJMKS4nKScK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogJzxlbT51bmtub3duPC9lbT4nCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAuaHJlZignQ29ubmVjdCB0byBUd2l0dGVyJywkcmVn
aXN0ZXJVUkwpKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAogICAg
ICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdUd2VldCBzZXR0aW5ncycsIDIpLDIpCiAgICAg
ICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAgICAgICAg
dGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl9jYWNoZV9kaXIiPlR3ZWV0IHByZWZpeDwv
bGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjog
cmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAg
LnRkKGZJbnB1dCgndGV4dCcsJ2FyY190d2l0dGVyX3ByZWZpeCcsJHByZWZpeCwnJywnJywn
JywnJywnJywnYXJjX3R3aXR0ZXJfcHJlZml4JykpCiAgICAgICAgICAgICAgICApLnRyKAog
ICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfdHdlZXRf
ZGVmYXVsdCI+VHdlZXQgYXJ0aWNsZXMgYnkgZGVmYXVsdDwvbGFiZWw+JywKICAgICAgICAg
ICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFs
aWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKHllc25vUmFkaW8oJ2Fy
Y190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnLCAkdHdlZXRfZGVmYXVsdCwgJycsICdhcmNfdHdp
dHRlcl90d2VldF9kZWZhdWx0JykpCiAgICAgICAgICAgICAgICApLnRyKAogICAgICAgICAg
ICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCI+VVJM
IHNob3J0bmVyPC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0
ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAg
ICAgICAgICAgICAudGQoYXJjX3R3aXR0ZXJfdXJsX21ldGhvZF9zZWxlY3QoJ2FyY190d2l0
dGVyX3VybF9tZXRob2QnLCR1cmxfbWV0aG9kKSkKICAgICAgICAgICAgICAgICkudHIoCiAg
ICAgICAgICAgICAgICAgICAgdGRjcyhoZWQoJ1RYUCBUd2VldCBzaG9ydCBVUkwnLCAyKSwy
KQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAogICAgICAgICAgICAg
ICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3Nob3J0X3VybCI+RW5hYmxlIFRYUCBUd2Vl
dCBzaG9ydCBVUkwgcmVkaXJlY3Q8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAg
ICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyIn
KQogICAgICAgICAgICAgICAgICAgIC50ZCh5ZXNub1JhZGlvKCdhcmNfc2hvcnRfdXJsJywg
JHNob3J0X3VybCwgJycsICdhcmNfc2hvcnRfdXJsJykpLAogICAgICAgICAgICAgICAgICAg
ICcgaWQ9ImFyY19zaG9ydF91cmwtb25fb2ZmIicKICAgICAgICAgICAgICAgICkudHIoCiAg
ICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfc2hvcnRfc2l0ZV91cmwi
PlRYUCBUd2VldCBzaG9ydCBzaXRlIFVSTDwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAg
ICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRk
bGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKGZJbnB1dCgndGV4dCcsJ2FyY19zaG9y
dF9zaXRlX3VybCcsJHNob3J0X3NpdGVfdXJsLCcnLCcnLCcnLCcnLCcnLCdhcmNfc2hvcnRf
c2l0ZV91cmwnKSksCiAgICAgICAgICAgICAgICAgICAgJyBpZD0iYXJjX3Nob3J0X3NpdGVf
dXJsLW9wdGlvbiInCiAgICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAgICAgICAg
IHRkY3MoaGVkKCdUd2l0dGVyIHRhYicsIDIpLDIpCiAgICAgICAgICAgICAgICApLnRyKAog
ICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfdGFiIj5M
b2NhdGlvbiBvZiBUd2l0dGVyIHRhYjwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAg
ICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7
IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKGFyY190d2l0dGVyX3RhYl9zZWxlY3QoJ2Fy
Y190d2l0dGVyX3RhYicsJHRhYikpCiAgICAgICAgICAgICAgICApLnRyKAogICAgICAgICAg
ICAgICAgICAgIHRkY3MoaGVkKCdDYWNoZScsIDIpLDIpCiAgICAgICAgICAgICAgICApCiAg
ICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9y
PSJhcmNfdHdpdHRlcl9jYWNoZV9kaXIiPkNhY2hlIGRpcmVjdG9yeTwvbGFiZWw+JywKICAg
ICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRp
Y2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKGZJbnB1dCgn
dGV4dCcsJ2FyY190d2l0dGVyX2NhY2hlX2RpcicsJGNhY2hlX2RpciwnJywnJywnJywnJywn
JywnYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJykpCiAgICAgICAgICAgICAgICApCiAgICAgICAg
ICAgICAgICAudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKAogICAgICAgICAgICAgICAg
ICAgICAgICBmSW5wdXQoJ3N1Ym1pdCcsICdTdWJtaXQnLCBnVHh0KCdzYXZlX2J1dHRvbicp
LCAncHVibGlzaCcpCiAgICAgICAgICAgICAgICAgICAgICAgIC5uLnNJbnB1dCgncHJlZnNf
c2F2ZScpCiAgICAgICAgICAgICAgICAgICAgICAgIC5uLmVJbnB1dCgncGx1Z2luX3ByZWZz
LmFyY190d2l0dGVyJykKICAgICAgICAgICAgICAgICAgICAsICcgY29sc3Bhbj0iMiIgY2xh
c3M9Im5vbGluZSInKSkpCiAgICAgICAgICAgICAgICAuZW5kVGFibGUoKTsKICAgICAgICB9
IGVsc2VpZiAoICRzdGVwIT0ncmVnaXN0ZXInICkgewogICAgICAgICAgICAkcmVnaXN0ZXJV
UkwgPSBhcmNfdHdpdHRlcjo6Y2FsbGJhY2tVUkwoJGV2ZW50LCdyZWdpc3RlcicpOwogICAg
ICAgICAgICAkaHRtbC49IHN0YXJ0VGFibGUoJ2xpc3QnKS5mb3JtKAogICAgICAgICAgICAg
ICAgdHIoCiAgICAgICAgICAgICAgICAgICAgdGRjcyhoZWQoJ1R3aXR0ZXIgYWNjb3VudCBk
ZXRhaWxzJywgMiksMikKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50cigK
ICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX3VzZXIi
PlR3aXR0ZXIgdXNlcm5hbWU8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcg
c3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQog
ICAgICAgICAgICAgICAgICAgIC50ZCgKICAgICAgICAgICAgICAgICAgICAgICAgKCc8ZW0+
dW5rbm93bjwvZW0+ICgnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaHJlZignQ29u
bmVjdCB0byBUd2l0dGVyJywkcmVnaXN0ZXJVUkwpLicpJykKICAgICAgICAgICAgICAgICkp
KQogICAgICAgICAgICAgICAgLmVuZFRhYmxlKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8v
IFNldCBqUXVlcnkgZm9yIHN3aXRjaGluZyBvbi9vZmYgcmVsZXZhbnQgYXJjX3Nob3J0X3Vy
bCBmaWVsZHMKICAgICRqcyA9IDw8PEpTCjxzY3JpcHQgbGFuZ3VhZ2U9ImphdmFzY3JpcHQi
IHR5cGU9InRleHQvamF2YXNjcmlwdCI+CiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCl7
CiAgdmFyIG9ub2ZmID0gJCgnI2FyY19zaG9ydF91cmwtb25fb2ZmJyk7CiAgdmFyIGFyY19z
aG9ydF91cmxfb2ZmID0gJCgnI2FyY19zaG9ydF91cmwtYXJjX3Nob3J0X3VybC0wJyk7CiAg
dmFyIHVybCA9ICQoJyNhcmNfc2hvcnRfc2l0ZV91cmwtb3B0aW9uJyk7CiAgdmFyIHVybF9t
ZXRob2QgPSAkKCdzZWxlY3RbbmFtZT0iYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCJdJyk7Cgog
IGlmIChhcmNfc2hvcnRfdXJsX29mZi5hdHRyKCdjaGVja2VkJyk9PXRydWUKICAmJiAkKCdv
cHRpb246c2VsZWN0ZWQnLCB1cmxfbWV0aG9kKS52YWwoKSE9J2FyY190d2l0dGVyJykgewog
ICAgdXJsLmhpZGUoKTsKICB9CiAgJCgnaW5wdXQnLCBvbm9mZikuY2hhbmdlKGZ1bmN0aW9u
KCl7CiAgICBpZiAoJCgnb3B0aW9uOnNlbGVjdGVkJywgdXJsX21ldGhvZCkudmFsKCkhPSdh
cmNfdHdpdHRlcicpIHsKICAgICAgYXJjX3Nob3J0X3VybF9vZmYuYXR0cignY2hlY2tlZCcp
PT10cnVlID8gdXJsLmhpZGUoKSA6IHVybC5zaG93KCk7CiAgICB9CiAgfSk7CgogIGlmICgk
KCdvcHRpb246c2VsZWN0ZWQnLCB1cmxfbWV0aG9kKS52YWwoKT09J2FyY190d2l0dGVyJykg
ewogICAgb25vZmYuaGlkZSgpOyB1cmwuc2hvdygpOwogIH0KICB1cmxfbWV0aG9kLmNoYW5n
ZShmdW5jdGlvbigpewogICAgaWYgKCQoJ29wdGlvbjpzZWxlY3RlZCcsIHVybF9tZXRob2Qp
LnZhbCgpPT0nYXJjX3R3aXR0ZXInKSB7CiAgICAgIG9ub2ZmLnRvZ2dsZSgpOyB1cmwuc2hv
dygpOwogICAgfSBlbHNlIHsKICAgICAgb25vZmYudG9nZ2xlKCk7CiAgICAgIGFyY19zaG9y
dF91cmxfb2ZmLmF0dHIoJ2NoZWNrZWQnKT09dHJ1ZSA/IHVybC5oaWRlKCkgOiB1cmwuc2hv
dygpOwogICAgfQogIH0pCn0pOwo8L3NjcmlwdD4KSlM7CgogICAgZWNobyAkanMuJGh0bWw7
Cn0KCi8vIEFkZCBUd2l0dGVyIHRhYiB0byBUZXh0cGF0dGVybgpmdW5jdGlvbiBhcmNfYWRt
aW5fdHdpdHRlcigkZXZlbnQsJHN0ZXApCnsKICAgIGdsb2JhbCAkcHJlZnMsICRhcmNfdHdp
dHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgICR0
d2l0ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAg
ICAgICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCwgJHByZWZzWydhcmNfdHdpdHRl
cl9hY2Nlc3NUb2tlbiddCiAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nl
c3NUb2tlblNlY3JldCddKTsKCiAgICAkdHdpdC0+Y2FjaGVEaXIoJHByZWZzWydhcmNfdHdp
dHRlcl9jYWNoZV9kaXInXSk7CgogICAgJHhtbCA9ICR0d2l0LT5nZXQoJ3VzZXJzL3Nob3cn
CiAgICAgICAgLCBhcnJheSgnc2NyZWVuX25hbWUnPT4kcHJlZnNbJ2FyY190d2l0dGVyX3Vz
ZXInXSkpOwogICAgJHR3aXR0ZXJVc2VyID0gQCR4bWwtPnhwYXRoKCcvdXNlcicpOwogICAg
JHR3aXR0ZXJVc2VyID0gJHR3aXR0ZXJVc2VyWzBdOwogICAgJHR3aXR0ZXJVc2VyVVJMID0g
J2h0dHA6Ly93d3cudHdpdHRlci5jb20vJy4kdHdpdHRlclVzZXItPnNjcmVlbl9uYW1lOwoK
ICAgIGlmICgkc3RlcD09InR3ZWV0IikgeyAvLyBwb3N0IGFuIHVwZGF0ZSB0byBUd2l0dGVy
CgogICAgICAgIC8vIGZldGNoIGFuZCBjbGVhbiBtZXNzYWdlCiAgICAgICAgJG1lc3NhZ2Ug
PSBzdHJpcF90YWdzKGdwcygnbWVzc2FnZScpKTsKICAgICAgICAkY291bnQgPSBzdHJsZW4o
JG1lc3NhZ2UpOwoKICAgICAgICBpZiAoJGNvdW50PD0xNDAgJiYgJGNvdW50PjApIHsgLy8g
cG9zdCB1cGRhdGUKICAgICAgICAgICAgJHJlc3VsdCA9ICR0d2l0LT5wb3N0KCdzdGF0dXNl
cy91cGRhdGUnLCBhcnJheSgnc3RhdHVzJyA9PiAkbWVzc2FnZSkpOwogICAgICAgIH0gZWxz
ZSB7IC8vIG1lc3NhZ2UgdG9vIGxvbmcsIEphdmFTY3JpcHQgaW50ZXJmYWNlIHNob3VsZCBw
cmV2ZW50IHRoaXMKICAgICAgICAgICAgJHJlc3VsdCA9IGZhbHNlOwogICAgICAgIH0KCiAg
ICAgICAgcGFnZXRvcCgnVHdpdHRlcicsCiAgICAgICAgICAgICgoJHJlc3VsdCE9ZmFsc2Up
PydUd2l0dGVyIHVwZGF0ZWQnOidFcnJvciB1cGRhdGluZyBUd2l0dGVyJykpOwoKICAgIH0g
ZWxzZWlmICgkc3RlcD09ImRlbGV0ZSIpIHsgLy8gZGVsZXRlIGFuIHVwZGF0ZSBmcm9tIFR3
aXR0ZXIKCiAgICAgICAgJGlkID0gc3RyaXBfdGFncyhncHMoJ2lkJykpOwogICAgICAgIGlm
ICgkaWQpIHsKICAgICAgICAgICAgJHR3aXQtPmRlbGV0ZSgnc3RhdHVzZXMvZGVzdHJveScu
JGlkKTsKICAgICAgICAgICAgc2FmZV9kZWxldGUoJ2FyY190d2l0dGVyJywidHdlZXRfaWQg
PSAkaWQiKTsKICAgICAgICB9CgogICAgICAgIHBhZ2V0b3AoJ1R3aXR0ZXInLCdUd2l0dGVy
IHVwZGF0ZWQnKTsKCiAgICB9IGVsc2UgewoKICAgICAgICBwYWdldG9wKCdUd2l0dGVyJyk7
CgogICAgfQoKICAgIC8vIFByZXBhcmUgSmF2YVNjcmlwdCB0byBjcmVhdGUgVHdpdHRlciB1
cGRhdGUgaW50ZXJmYWNlCgogICAgJGpzID0gJzxzY3JpcHQgbGFuZ3VhZ2U9ImphdmFzY3Jp
cHQiIHR5cGU9InRleHQvamF2YXNjcmlwdCI+JzsKICAgICRqcy49ICIkKGRvY3VtZW50KS5y
ZWFkeShmdW5jdGlvbigpewogICAgICAgICAgICB2YXIgY291bnRlclN0eWxlID0gJ2ZvbnQt
d2VpZ2h0OmJvbGQ7ZmxvYXQ6cmlnaHQ7Zm9udC1zaXplOjJlbTtsaW5lLWhlaWdodDoxLjJl
bTsnOwogICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0eWxlJywgY291bnRl
clN0eWxlKydjb2xvcjojY2NjOycpOwogICAgICAgICAgICAkKCcjbWVzc2FnZScpLmtleXVw
KGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gMTQwLSQoJyNtZXNz
YWdlJykudmFsKCkubGVuZ3RoOwogICAgICAgICAgICAgICAgJCgnI3R3ZWV0Y291bnQnKS5o
dG1sKGNvdW50KycnKTsgLy8gaGFjayB0byBmb3JjZSBvdXRwdXQgb2YgMAogICAgICAgICAg
ICAgICAgaWYgKGNvdW50PDApIHsKICAgICAgICAgICAgICAgICAgICAkKCdpbnB1dC5wdWJs
aXNoJykuYXR0cignZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTsKICAgICAgICAgICAgICAgIH0g
ZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJCgnaW5wdXQucHVibGlzaCcpLmF0dHIoJ2Rp
c2FibGVkJywgJycpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGNv
dW50PDApIHsKICAgICAgICAgICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0
eWxlJywgY291bnRlclN0eWxlKydjb2xvcjojZjAwOycpOwogICAgICAgICAgICAgICAgfSBl
bHNlIGlmIChjb3VudDwxMCkgewogICAgICAgICAgICAgICAgICAgICQoJyN0d2VldGNvdW50
JykuYXR0cignc3R5bGUnLCBjb3VudGVyU3R5bGUrJ2NvbG9yOiMwMDA7Jyk7CiAgICAgICAg
ICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICQoJyN0d2VldGNvdW50Jyku
YXR0cignc3R5bGUnLCBjb3VudGVyU3R5bGUrJ2NvbG9yOiNjY2M7Jyk7CiAgICAgICAgICAg
ICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgfSk7IjsKICAgICRqcy49ICI8L3Njcmlw
dD4iOwoKICAgICRvdXQgPSAnJzsKICAgICR4bWwgPSAkdHdpdC0+Z2V0KCdzdGF0dXNlcy91
c2VyX3RpbWVsaW5lJwogICAgICAgICwgYXJyYXkoJ3NjcmVlbl9uYW1lJz0+JHByZWZzWydh
cmNfdHdpdHRlcl91c2VyJ10sJ2NvdW50Jz0+MjUpKTsKICAgICR0d2VldHMgPSBAJHhtbC0+
eHBhdGgoJy9zdGF0dXNlcy9zdGF0dXMnKTsKICAgIGlmICgkdHdlZXRzKSBmb3JlYWNoICgk
dHdlZXRzIGFzICR0d2VldCkgewogICAgICAgICR0aW1lID0gc3RydG90aW1lKGh0bWxlbnRp
dGllcygkdHdlZXQtPmNyZWF0ZWRfYXQpKTsKICAgICAgICAkZGF0ZSA9IHNhZmVfc3RyZnRp
bWUoJHByZWZzWydhcmNoaXZlX2RhdGVmb3JtYXQnXSwkdGltZSk7CiAgICAgICAgJG91dC49
IHRyKHRkKCRkYXRlLCdzcGFuJykKICAgICAgICAgICAgLnRkKGFyY19Ud2l0dGVyOjptYWtl
TGlua3MoaHRtbGVudGl0aWVzKCR0d2VldC0+dGV4dAogICAgICAgICAgICAgICAgLCBFTlRf
UVVPVEVTLCdVVEYtOCcpKSkKICAgICAgICAgICAgLnRkKGRMaW5rKCdhcmNfYWRtaW5fdHdp
dHRlcicsJ2RlbGV0ZScsJ2lkJywkdHdlZXQtPmlkLCcnKSkKICAgICAgICAgICAgKTsKICAg
IH0KCiAgICAkaHRtbCA9IHN0YXJ0VGFibGUoJ2VkaXQnKQogICAgICAgICAgICAudHIodGQo
CiAgICAgICAgICAgIGdyYWYoJzxpbWcgc3JjPSInLiR0d2l0dGVyVXNlci0+cHJvZmlsZV9p
bWFnZV91cmwuJyIgYWx0PSJUd2l0dGVyIGF2YXRhciIgLz4nCiAgICAgICAgICAgICwnIHN0
eWxlPSJmbG9hdDpsZWZ0O3BhZGRpbmc6MnB4OyInKQogICAgICAgICAgICAuZ3JhZihocmVm
KCR0d2l0dGVyVXNlci0+bmFtZSwkdHdpdHRlclVzZXJVUkwpLCcgc3R5bGU9ImZvbnQtc2l6
ZToxLjJlbTtmb250LXdlaWdodDpib2xkOyInKQogICAgICAgICAgICAuZ3JhZihocmVmKCR0
d2l0dGVyVXNlci0+ZnJpZW5kc19jb3VudC4nIGZvbGxvd2luZycsJHR3aXR0ZXJVc2VyVVJM
LicvZm9sbG93aW5nJykKICAgICAgICAgICAgLicsICcuaHJlZigkdHdpdHRlclVzZXItPmZv
bGxvd2Vyc19jb3VudC4nIGZvbGxvd2VycycsJHR3aXR0ZXJVc2VyVVJMLicvZm9sbG93ZXJz
JykKICAgICAgICAgICAgLicsICcuaHJlZigkdHdpdHRlclVzZXItPnN0YXR1c2VzX2NvdW50
LicgdXBkYXRlcycsJHR3aXR0ZXJVc2VyVVJMKSkpKQogICAgICAgICAgICAudHIodGQoZm9y
bSgKICAgICAgICAgICAgZ3JhZigiVXBkYXRlIFR3aXR0ZXIuLi48c3BhbiBpZD0ndHdlZXRj
b3VudCcgc3R5bGU9J2ZvbnQtd2VpZ2h0OmJvbGQ7ZmxvYXQ6cmlnaHQ7Jz4xNDA8L3NwYW4+
IikKICAgICAgICAgICAgLnRleHRfYXJlYSgnbWVzc2FnZScsJzUwJywnNTUwJywnJywnbWVz
c2FnZScpCiAgICAgICAgICAgIC5lSW5wdXQoJ2FyY19hZG1pbl90d2l0dGVyJykKICAgICAg
ICAgICAgLnNJbnB1dCgndHdlZXQnKS5icgogICAgICAgICAgICAuZklucHV0KCdzdWJtaXQn
LCd1cGRhdGUnLGdUeHQoJ1VwZGF0ZScpLCdwdWJsaXNoJykKICAgICAgICApKSkKICAgICAg
ICAuZW5kVGFibGUoKTsKCiAgICAvLyBBdHRhY2ggcmVjZW50IFR3aXR0ZXIgdXBkYXRlcwoK
ICAgICRodG1sLj0gc3RhcnRUYWJsZSgnbGlzdCcsJycsJycsJycsJzkwJScpCiAgICAgICAg
LiRvdXQKICAgICAgICAuZW5kVGFibGUoKTsKCiAgICAvLyBPdXRwdXQgSmF2YVNjcmlwdCBh
bmQgSFRNTAoKICAgIGVjaG8gJGpzLiRodG1sOwp9CgovLyBBZGQgVHdpdHRlciBvcHRpb25z
IHRvIGFydGljbGUgYXJ0aWNsZSBzY3JlZW4KZnVuY3Rpb24gYXJjX2FwcGVuZF90d2l0dGVy
KCRldmVudCwgJHN0ZXAsICRkYXRhLCAkcnMxKQp7CiAgICBnbG9iYWwgJHByZWZzLCAkYXJj
X3R3aXR0ZXI7CiAgICAkcHJlZml4ID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3ByZWZpeCcp
KTsKICAgICRwcmVmaXggPSAoJHByZWZpeCkgPyAkcHJlZml4IDogJHByZWZzWydhcmNfdHdp
dHRlcl9wcmVmaXgnXTsKICAgICRzdWZmaXggPSB0cmltKGdwcygnYXJjX3R3aXR0ZXJfc3Vm
Zml4JykpOwoKICAgIGlmICgkcnMxWydJRCddKSB7CiAgICAgICAgJHNxbCA9ICJTRUxFQ1Qg
dHdlZXRfaWQsdHdlZXQgRlJPTSAiLlBGWC4iYXJjX3R3aXR0ZXIgV0hFUkUgYXJ0aWNsZV9p
ZD0iLiRyczFbJ0lEJ10uIjsiOwogICAgICAgICRyczIgPSBzYWZlX3F1ZXJ5KCRzcWwpOyAk
cnMyID0gbmV4dFJvdygkcnMyKTsKICAgIH0gZWxzZSB7IC8vIG5ldyBhcnRpY2xlCiAgICAg
ICAgJHJzMiA9ICcnOwogICAgfQoKICAgIGlmICgkcnMxWydJRCddICYmICRyczJbJ3R3ZWV0
X2lkJ10pIHsKICAgICAgICAkY29udGVudCA9IGFyY19Ud2l0dGVyOjptYWtlTGlua3MoJHJz
MlsndHdlZXQnXSk7CiAgICAgICAgcmV0dXJuICRkYXRhLmZpZWxkc2V0KCRjb250ZW50LCAn
VHdpdHRlciB1cGRhdGUnLCAnYXJjX3R3aXR0ZXInKTsKICAgIH0gZWxzZSB7CiAgICAgICAg
JHZhciA9ICgkcnMxWydJRCddKSA/IDAgOiAkcHJlZnNbJ2FyY190d2l0dGVyX3R3ZWV0X2Rl
ZmF1bHQnXTsKICAgICAgICAkY29udGVudCAgPSB0YWcoeWVzbm9SYWRpbygnYXJjX3R3ZWV0
X3RoaXMnLCAkdmFyLCAnJywgJ2FyY190d2VldF90aGlzJyksJ3AnKTsKICAgICAgICAkY29u
dGVudCAuPSB0YWcoaHJlZignT3B0aW9ucycsJyNhcmNfdHdpdHRlcl9vcHRpb25zJyksJ3An
LCcgY2xhc3M9InBsYWluIGxldmVyIiBzdHlsZT0ibWFyZ2luLXRvcDo1cHg7IicpOwogICAg
ICAgICRjb250ZW50IC49IHRhZyh0YWcodGFnKCdUd2VldCBwcmVmaXgnLCdsYWJlbCcsICcg
Zm9yPSJhcmNfdHdpdHRlcl9wcmVmaXgiJykKICAgICAgICAgICAgLmZJbnB1dCgndGV4dCcs
J2FyY190d2l0dGVyX3ByZWZpeCcsJHByZWZpeCwnZWRpdCcsJycsJycsJzIyJywnJywnYXJj
X3R3aXR0ZXJfcHJlZml4JyksJ3AnKQogICAgICAgICAgICAudGFnKHRhZygnVHdlZXQgc3Vm
Zml4IChlZyAjaGFzaHRhZ3MpJywnbGFiZWwnLCAnIGZvcj0iYXJjX3R3aXR0ZXJfc3VmZml4
IicpCiAgICAgICAgICAgIC5mSW5wdXQoJ3RleHQnLCdhcmNfdHdpdHRlcl9zdWZmaXgnLCRz
dWZmaXgsJ2VkaXQnLCcnLCcnLCcyMicsJycsJ2FyY190d2l0dGVyX3N1ZmZpeCcpLCdwJykK
ICAgICAgICAgICAgLCdkaXYnLCcgaWQ9ImFyY190d2l0dGVyX29wdGlvbnMiIGNsYXNzPSJ0
b2dnbGUiIHN0eWxlPSJkaXNwbGF5Om5vbmUiJyk7CiAgICAgICAgaWYgKGlzc2V0KCRhcmNf
dHdpdHRlclsnZXJyb3InXSkpIHsKICAgICAgICAgICAgJGNvbnRlbnQgLj0gJzxwPicuJGFy
Y190d2l0dGVyWydlcnJvciddLic8L3A+JzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICRk
YXRhLmZpZWxkc2V0KCRjb250ZW50LCAnVXBkYXRlIFR3aXR0ZXInLCAnYXJjX3R3aXR0ZXIn
KTsKICAgIH0KCn0KCi8vIFVwZGF0ZSBUd2l0dGVyIHdpdGggcG9zdGVkIGFydGljbGUKZnVu
Y3Rpb24gYXJjX2FydGljbGVfdHdlZXQoJGV2ZW50LCRzdGVwKQp7CiAgICBnbG9iYWwgJHBy
ZWZzLCAkYXJjX3R3aXR0ZXIsICRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICwg
JGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgICRhcnRpY2xlX2lkID0gZW1wdHko
JEdMT0JBTFNbJ0lEJ10pID8gZ3BzKCdJRCcpIDogJEdMT0JBTFNbJ0lEJ107CiAgICBpZiAo
IWVtcHR5KCRhcnRpY2xlX2lkKSkgewoKICAgICAgICBpbmNsdWRlX29uY2UgdHhwYXRoLicv
cHVibGlzaC90YWdoYW5kbGVycy5waHAnOwoKICAgICAgICAkYXJ0aWNsZSA9IHNhZmVfcm93
KCJJRCwgVGl0bGUsIFNlY3Rpb24sIFBvc3RlZCIsICd0ZXh0cGF0dGVybicsCiAgICAgICAg
ICAgICJJRD17JGFydGljbGVfaWR9IEFORCBTdGF0dXM9NCBBTkQgbm93KCk+PVBvc3RlZCIp
OwoKICAgICAgICBpZiAoJGFydGljbGUgJiYgZ3BzKCdhcmNfdHdlZXRfdGhpcycpKSB7IC8v
IHR3ZWV0IGFydGljbGUKCiAgICAgICAgICAgIC8vIE5lZWQgdG8gbWFudWFsbHkgdXBkYXRl
IHRoZSAnVVJMIG9ubHkgdGl0bGUnIGJlZm9yZSBidWlsZGluZyB0aGUKICAgICAgICAgICAg
Ly8gVVJMCiAgICAgICAgICAgICRhcnRpY2xlWyd1cmxfdGl0bGUnXSA9IGdwcygndXJsX3Rp
dGxlJyk7CiAgICAgICAgICAgIC8vIE1ha2Ugc2hvcnQgVVJMCiAgICAgICAgICAgICR1cmwg
PSBwZXJtbGlua3VybCgkYXJ0aWNsZSk7CiAgICAgICAgICAgICRzaG9ydF91cmwgPSBhcmNf
c2hvcnRlbl91cmwoJHVybCwkcHJlZnNbJ2FyY190d2l0dGVyX3VybF9tZXRob2QnXSwKICAg
ICAgICAgICAgICAgIGFycmF5KCdpZCc9PiRhcnRpY2xlX2lkKSk7CgogICAgICAgICAgICBp
ZiAoISRzaG9ydF91cmwpIHsgLy8gRmFpbGVkIHRvIG9idGFpbiBhIHNob3J0ZW5lZCBVUkws
IGRvIG5vdCB0d2VldCEKICAgICAgICAgICAgICAgICRhcmNfdHdpdHRlclsnZXJyb3InXSA9
ICdVbmFibGUgdG8gb2J0YWluIGEgc2hvcnQgVVJMIGZvciB0aGlzIGFydGljbGUuJzsKCiAg
ICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg
IC8vIENvbnN0cnVjdCBUd2l0dGVyIHVwZGF0ZQogICAgICAgICAgICAkcHJlZml4ICA9IHRy
aW0oZ3BzKCdhcmNfdHdpdHRlcl9wcmVmaXgnKSk7CiAgICAgICAgICAgICRwcmVfbGVuID0g
c3RybGVuKCRwcmVmaXgpOwogICAgICAgICAgICAkcHJlZml4ICA9ICgkcHJlZml4ICYmICRw
cmVfbGVuPD0yMCkgPyAkcHJlZml4LicgJyA6ICcnOwogICAgICAgICAgICAkc3VmZml4ICA9
IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9zdWZmaXgnKSk7CiAgICAgICAgICAgICRzdWZfbGVu
ID0gc3RybGVuKCRzdWZmaXgpOwogICAgICAgICAgICAkc3VmZml4ICA9ICgkc3VmZml4ICYm
ICRzdWZfbGVuPD00MCkgPyAnICcuJHN1ZmZpeCA6ICcnOwogICAgICAgICAgICAkdXJsX2xl
biA9IHN0cmxlbigkc2hvcnRfdXJsKSsxOyAvLyBjb3VudCBVUkwgbGVuZ3RoICsgMSBmb3Ig
cHJlZml4ZWQgc3BhY2UKICAgICAgICAgICAgaWYgKCRwcmVmaXgpICRwcmVfbGVuICs9IDE7
CiAgICAgICAgICAgIGlmICgkc3VmZml4KSAkc3VmX2xlbiArPSAxOwogICAgICAgICAgICBp
ZiAoKHN0cmxlbigkYXJ0aWNsZVsnVGl0bGUnXSkrJHVybF9sZW4rJHByZV9sZW4rJHN1Zl9s
ZW4pPjE0MCkgewogICAgICAgICAgICAgICAgJGFydGljbGVbJ1RpdGxlJ10gPSBzdWJzdHIo
JGFydGljbGVbJ1RpdGxlJ10sMCwxMzUtJHVybF9sZW4tJHByZV9sZW4tJHN1Zl9sZW4pLicu
Li4nOwogICAgICAgICAgICB9CiAgICAgICAgICAgICR0d2VldCA9ICRwcmVmaXguJGFydGlj
bGVbJ1RpdGxlJ10uIiAiLiRzaG9ydF91cmwuJHN1ZmZpeDsKCiAgICAgICAgICAgIC8vIFVw
ZGF0ZSBUd2l0dGVyCiAgICAgICAgICAgICR0d2l0ID0gbmV3IGFyY190d2l0dGVyKCRhcmNf
dHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29u
c3VtZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXQogICAgICAg
ICAgICAgICAgLCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0J10pOwog
ICAgICAgICAgICAkcmVzdWx0ID0gJHR3aXQtPnBvc3QoJ3N0YXR1c2VzL3VwZGF0ZScsIGFy
cmF5KCdzdGF0dXMnID0+ICR0d2VldCkpOwoKICAgICAgICAgICAgJHR3ZWV0X2lkID0gKGlz
X29iamVjdCgkcmVzdWx0KSkgPyAkcmVzdWx0WzBdLT5pZCA6IDA7CgogICAgICAgICAgICBp
ZiAoJHR3ZWV0X2lkKSB7CgogICAgICAgICAgICAgICAgJHR3ZWV0ID0gYWRkc2xhc2hlcygk
dHdlZXQpOwoKICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBhcmNfdHdpdHRlciB0YWJsZSB3
aXRoIHR3ZWV0CiAgICAgICAgICAgICAgICAkc3FsID0gIklOU0VSVCBJTlRPICIuUEZYLiJh
cmNfdHdpdHRlciAoYXJ0aWNsZV9pZCx0d2VldF9pZCx0d2VldCx0aW55dXJsKSAiOwogICAg
ICAgICAgICAgICAgJHNxbC49ICJWQUxVRVMoJGFydGljbGVfaWQsJHR3ZWV0X2lkLFwiJHR3
ZWV0XCIsJyRzaG9ydF91cmwnKTsiOwogICAgICAgICAgICAgICAgc2FmZV9xdWVyeSgkc3Fs
KTsKCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgICAgICAgIH0gZWxzZSB7
CgogICAgICAgICAgICAgICAgJGFyY190d2l0dGVyWydlcnJvciddID0gJ1R3aXR0ZXIgcmVz
cG9uc2U6ICcKICAgICAgICAgICAgICAgICAgICAuJHR3aXQtPmh0dHBfY29kZTsKICAgICAg
ICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgICAgIH0KCiAgICAgICAgfQoKICAg
IH0KCiAgICByZXR1cm4gZmFsc2U7Cgp9CgovKgogKiBTaG9ydGVuIFVSTHMgdXNpbmcgdmFy
aW91cyBtZXRob2RzCiAqLwoKZnVuY3Rpb24gYXJjX3Nob3J0ZW5fdXJsKCR1cmwsICRtZXRo
b2Q9JycsICRhdHRzPWFycmF5KCkpCnsKICBnbG9iYWwgJHByZWZzOwoKICAkY2ggPSBjdXJs
X2luaXQoKTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfSEVBREVSLCAwKTsKICBjdXJs
X3NldG9wdCgkY2gsIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIsIHRydWUpOwogIGN1cmxfc2V0
b3B0KCRjaCwgQ1VSTE9QVF9USU1FT1VULCAxMCk7CgogIHN3aXRjaCAoJG1ldGhvZCkgewog
ICAgY2FzZSAnc21kJzogLy8gY3JlYXRlIGEgc2hvcnRlbmVkIFVSTCB1c2luZyBTTUQgU2hv
cnQgVVJMCiAgICAgIHJldHVybiAoJGF0dHNbJ2lkJ10pID8gaHUuJGF0dHNbJ2lkJ10gOiBm
YWxzZTsgYnJlYWs7CiAgICBjYXNlICdhcmNfdHdpdHRlcic6IC8vIG5hdGl2ZSBVUkwgc2hv
cnRlbmluZwoKICAgICAgcmV0dXJuICgkYXR0c1snaWQnXSkgPyBQUk9UT0NPTC4kcHJlZnNb
J2FyY19zaG9ydF9zaXRlX3VybCddLicvJy4kYXR0c1snaWQnXSA6IGZhbHNlOwogICAgICBi
cmVhazsKCiAgICBjYXNlICdpc2dkJzoKCiAgICAgICR1ID0gJ2h0dHA6Ly9pcy5nZC9hcGku
cGhwP2xvbmd1cmw9Jy51cmxlbmNvZGUoJHVybCk7CiAgICAgIGN1cmxfc2V0b3B0KCRjaCwg
Q1VSTE9QVF9VUkwsICR1KTsKCiAgICAgICR0aW55dXJsID0gY3VybF9leGVjKCRjaCk7CiAg
ICAgIGlmICgkdGlueXVybCE9J0Vycm9yJyAmJiAkdGlueXVybCE9JycpIHsKICAgICAgICBy
ZXR1cm4gJHRpbnl1cmw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdHJpZ2dlcl9lcnJvcign
YXJjX3R3aXR0ZXIgZmFpbGVkIHRvIGdldCBhIGlzLmdkIFVSTCBmb3IgJwogICAgICAgICAg
ICAuJHVybCxFX1VTRVJfV0FSTklORyk7CiAgICAgIH0KICAgICAgYnJlYWs7CgogICAgY2Fz
ZSAndGlueXVybCc6IGRlZmF1bHQ6IC8vIGNyZWF0ZSBhIHNob3J0ZW5lZCBVUkwgdXNpbmcg
VGlueVVSTAoKICAgICAgJHUgPSAnaHR0cDovL3Rpbnl1cmwuY29tL2FwaS1jcmVhdGUucGhw
P3VybD0nLnVybGVuY29kZSgkdXJsKTsKICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BU
X1VSTCwgJHUpOwogICAgICAkdGlueXVybCA9IGN1cmxfZXhlYygkY2gpOwogICAgICBpZiAo
JHRpbnl1cmwhPSdFcnJvcicgJiYgJHRpbnl1cmwhPScnKSB7CiAgICAgICAgcmV0dXJuICR0
aW55dXJsOwogICAgICB9IGVsc2UgewogICAgICAgIHRyaWdnZXJfZXJyb3IoJ2FyY190d2l0
dGVyIGZhaWxlZCB0byBnZXQgYSBUaW55VVJMIGZvciAnLiR1cmwsRV9VU0VSX1dBUk5JTkcp
OwogICAgICB9CgogIH0KCiAgcmV0dXJuIGZhbHNlOyAvLyBmYWlsCgp9CgovKgogKiBTaG9y
dGVuZWQgVVJMIHJlZGlyZWN0IGJhc2VkIG9uIHNtZF9zaG9ydF91cmwKICovCmZ1bmN0aW9u
IGFyY19zaG9ydF91cmxfcmVkaXJlY3QoJGV2ZW50LCAkc3RlcCkgewogIGdsb2JhbCAkcHJl
ZnM7CgogICRoYXZlX2lkID0gMDsKCiAgLy8gQ2hlY2sgaWYgdGhlcmUgaXMgYW4gYXZhaWxh
YmxlIHNob3J0IHNpdGUgdXJsIGFuZCBpZiBpdCBpcyBiZWluZyB1c2VkIGluCiAgLy8gdGhp
cyBpbnN0YW5jZQogICRzaG9ydF9zaXRlX3VybCA9ICRwcmVmc1snYXJjX3Nob3J0X3NpdGVf
dXJsJ107CiAgaWYgKCRzaG9ydF9zaXRlX3VybCkgewogICAgJHNob3J0X3NpdGVfdXJsID0g
UFJPVE9DT0wuJHNob3J0X3NpdGVfdXJsLicvJzsKICAgICR1cmxfcGFydHMgPSBwYXJzZV91
cmwoJHNob3J0X3NpdGVfdXJsKTsKICAgICRyZSA9ICcjXicuJHVybF9wYXJ0c1sncGF0aCdd
LicoWzAtOV0uKikjJzsKICAgICRoYXZlX2lkID0gcHJlZ19tYXRjaCgkcmUsICRfU0VSVkVS
WydSRVFVRVNUX1VSSSddLCAkbSk7CiAgfQoKICAvLyBGYWxsIGJhY2sgdG8gc3RhbmRhcmQg
c2l0ZSB1cmwgKHNtZF9zaG9ydF91cmwgYmVoYXZpb3VyKQogIGlmICgkaGF2ZV9pZCkgewog
ICAgJHVybF9wYXJ0cyA9IHBhcnNlX3VybChodSk7CiAgICAkcmUgPSAnI14nLiR1cmxfcGFy
dHNbJ3BhdGgnXS4nKFswLTldLiopIyc7CiAgICAkaGF2ZV9pZCA9IHByZWdfbWF0Y2goJHJl
LCAkX1NFUlZFUlsnUkVRVUVTVF9VUkknXSwgJG0pOwogIH0KCiAgLy8gRG8gdGhlIHJlZGly
ZWN0IGlmIHdlJ3ZlIGdvdCBhbiBhcnRpY2xlIGlkCiAgaWYgKCRoYXZlX2lkKSB7CgkgICRp
ZCA9ICRtWzFdOwoJICAkcGVybWxpbmsgPSBwZXJtbGlua3VybF9pZCgkaWQpOwoKCSAgaWYg
KCRwZXJtbGluaykgewoJCSAgb2JfZW5kX2NsZWFuKCk7CgoJCSAgLy8gU3R1cGlkLCBvdmVy
IHRoZSB0b3AgaGVhZGVyIHNldHRpbmcgZm9yIElFCgkJICBoZWFkZXIoIlN0YXR1czogMzAx
Iik7CgkJICBoZWFkZXIoIkhUVFAvMS4wIDMwMSBNb3ZlZCBQZXJtYW5lbnRseSIpOwoJCSAg
aGVhZGVyKCJMb2NhdGlvbjogIi4kcGVybWxpbmssIFRSVUUsIDMwMSk7CgoJCSAgLy8gSW4g
Y2FzZSB0aGUgaGVhZGVyKCkgbWV0aG9kIGZhaWxzLCBmYWxsIGJhY2sgb24gYSBjbGFzc2lj
IHJlZGlyZWN0CgkJICBlY2hvICc8aHRtbD48aGVhZD48TUVUQSBIVFRQLUVRVUlWPSJSZWZy
ZXNoIiBDT05URU5UPSIwO1VSTD0nCgkJICAgIC4kcGVybWxpbmsuJyI+PC9oZWFkPjxib2R5
PjwvYm9keT48L2h0bWw+JzsKCQkgIGRpZSgpOwoJICB9CiAgfQoKfQoKLyoKICoqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioKKi8KCmNsYXNzIGFyY190d2l0dGVyIGV4dGVuZHMgVHdpdHRl
ck9BdXRoIHsKICAgIC8vIENhY2hpbmcgdmFyaWFibGVzCiAgICBwcml2YXRlICRfY2FjaGUg
PSB0cnVlOwogICAgcHJpdmF0ZSAkX2NhY2hlX2RpciA9ICcuL3RtcCc7CiAgICBwcml2YXRl
ICRfY2FjaGVfdGltZSA9IDE4MDA7IC8vIDMwIG1pbnV0ZSBjYWNoZQoKICAgIGZ1bmN0aW9u
IF9fY29uc3RydWN0KCRjb25zdW1lcl9rZXksICRjb25zdW1lcl9zZWNyZXQsICRvYXV0aF90
b2tlbiA9IE5VTEwKICAgICAgICAsICRvYXV0aF90b2tlbl9zZWNyZXQgPSBOVUxMKQogICAg
ewogICAgICAgIHBhcmVudDo6X19jb25zdHJ1Y3QoJGNvbnN1bWVyX2tleSwgJGNvbnN1bWVy
X3NlY3JldCwgJG9hdXRoX3Rva2VuCiAgICAgICAgICAgICwgJG9hdXRoX3Rva2VuX3NlY3Jl
dCk7CiAgICAgICAgJHRoaXMtPmZvcm1hdCA9ICd4bWwnOwogICAgICAgICR0aGlzLT50aW1l
b3V0ID0gMTU7CiAgICAgICAgJHRoaXMtPmNvbm5lY3R0aW1lb3V0ID0gMTU7CiAgICB9Cgog
ICAgcHVibGljIGZ1bmN0aW9uIGNhbGxiYWNrVVJMKCRldmVudCwkc3RlcCkKICAgIHsKICAg
ICAgICByZXR1cm4gaHUuJ3RleHRwYXR0ZXJuL2luZGV4LnBocD9ldmVudD0nLiRldmVudC4n
JmFtcDtzdGVwPScuJHN0ZXA7CiAgICB9CgogICAgLy8gY3JlYXRlIFR3aXR0ZXIgYW5kIGV4
dGVybmFsIGxpbmtzIGluIHRleHQKICAgIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gbWFrZUxp
bmtzKCR0ZXh0KQogICAgewogICAgICAgICR1cmwgPSAnL1xiKGh0dHB8aHR0cHN8ZnRwKTpc
L1wvKFtBLVowLTldW0EtWjAtOV8tXSooPzpcLltBLVowLTldW0EtWjAtOV8tXSopKyk6Pyhc
ZCspP1wvPyhbXC9cdytcLl0rKVxiL2knOwogICAgICAgICR0ZXh0ID0gcHJlZ19yZXBsYWNl
KCR1cmwsICI8YSBocmVmPSckMCc+JDA8L2E+IiwgJHRleHQpOwogICAgICAgICR1cmwgPSAn
L1xiKF58XHMpd3d3LihbYS16X0EtWjAtOV0rKSgoXC5bYS16XSspKylcYi9pJzsKICAgICAg
ICAkdGV4dCA9IHByZWdfcmVwbGFjZSgkdXJsLCAiPGEgaHJlZj0naHR0cDovL3d3dy4kMiQz
Jz53d3cuJDIkMzwvYT4iLCAkdGV4dCk7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2Uo
Ii8oXnxccylAKFthLXpfQS1aMC05XSspLyIsCiAgICAgICAgICAgICIkMUA8YSBocmVmPSdo
dHRwOi8vdHdpdHRlci5jb20vJDInPiQyPC9hPiIsJHRleHQpOwogICAgICAgICR0ZXh0ID0g
cHJlZ19yZXBsYWNlKCIvKF58XHMpKFwjKFthLXpfQS1aMC05Ol8tXSspKS8iLAogICAgICAg
ICAgICAiJDE8YSBocmVmPSdodHRwOi8vdHdpdHRlci5jb20vc2VhcmNoP3E9JTIzJDMnPiQy
PC9hPiIsJHRleHQpOwogICAgICAgIHJldHVybiAkdGV4dDsKICB9CgogICAgcHVibGljIGZ1
bmN0aW9uIGdldCgkdXJsLCAkcGFyYW1zID0gYXJyYXkoKSkKICAgIHsKICAgICAgICAkYXBp
X3VybCA9IG1kNSgkdXJsLnVybGVuY29kZShzZXJpYWxpemUoJHBhcmFtcykpKTsKICAgICAg
ICAkZGF0YSA9ICcnOwoKICAgICAgICBpZiAoJHRoaXMtPl9jYWNoZSkgeyAvLyBjaGVjayBm
b3IgY2FjaGVkIHhtbAoKICAgICAgICAgICAgJGRhdGEgPSAkdGhpcy0+X3JldHJpZXZlQ2Fj
aGUoJGFwaV91cmwpOwoKICAgICAgICB9CiAgICAgICAgaWYgKGVtcHR5KCRkYXRhKSkgewog
ICAgICAgICAgICAkZGF0YSA9IHBhcmVudDo6Z2V0KCR1cmwsICRwYXJhbXMpOwogICAgICAg
ICAgICBpZiAoJHRoaXMtPmh0dHBfY29kZT09PTIwMCAmJiAkeG1sPXNpbXBsZXhtbF9sb2Fk
X3N0cmluZygkZGF0YSkpIHsgLy8gc2F2ZSBjYWNoZQogICAgICAgICAgICAgICAgJGZpbGUg
PSAkdGhpcy0+X2NhY2hlX2Rpci4nLycuJGFwaV91cmw7CiAgICAgICAgICAgICAgICBmaWxl
X3B1dF9jb250ZW50cygkZmlsZSwkZGF0YSxMT0NLX0VYKTsKICAgICAgICAgICAgICAgIHJl
dHVybiAkeG1sOwogICAgICAgICAgICB9IGVsc2UgeyAvLyBmYWlsZWQgdG8gcmV0cmlldmUg
ZGF0YSBmcm9tIFR3aXR0ZXIKCiAgICAgICAgICAgICAgICBpZiAoJHRoaXMtPl9jYWNoZSkg
eyAvLyBhdHRlbXB0IHRvIGZvcmNlIGNhY2hlZCB4bWwgcmV0dXJuCgogICAgICAgICAgICAg
ICAgICAgICRkYXRhID0gJHRoaXMtPl9yZXRyaWV2ZUNhY2hlKCRhcGlfdXJsLHRydWUpOwog
ICAgICAgICAgICAgICAgICAgIGlmICgkZGF0YSkgcmV0dXJuIEBzaW1wbGV4bWxfbG9hZF9z
dHJpbmcoJGRhdGEpOwoKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1
cm4gZmFsc2U7CgogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsgLy8gcmV0dXJuIGNh
Y2hlZCB4bWwKICAgICAgICAgICAgcmV0dXJuIEBzaW1wbGV4bWxfbG9hZF9zdHJpbmcoJGRh
dGEpOwogICAgICAgIH0KICAgIH0gLy9lbmQgZ2V0KCkKCiAgICBmdW5jdGlvbiBwb3N0KCR1
cmwsICRwYXJhbXMgPSBhcnJheSgpKQogICAgewogICAgICAgICRkYXRhID0gcGFyZW50Ojpw
b3N0KCR1cmwsJHBhcmFtcyk7CiAgICAgICAgcmV0dXJuIHNpbXBsZXhtbF9sb2FkX3N0cmlu
ZygkZGF0YSk7CiAgICB9CgogICAgZnVuY3Rpb24gZGVsZXRlKCR1cmwsICRwYXJhbXMgPSBh
cnJheSgpKQogICAgewogICAgICAgICRkYXRhID0gcGFyZW50OjpkZWxldGUoJHVybCwkcGFy
YW1zKTsKICAgICAgICByZXR1cm4gc2ltcGxleG1sX2xvYWRfc3RyaW5nKCRkYXRhKTsKICAg
IH0KCiAgICAvLyBDYWNoZSBtZXRob2RzCgogICAgcHVibGljIGZ1bmN0aW9uIHNldENhY2hp
bmcoJGNhY2hlPXRydWUpCiAgICB7CiAgICAgICAgJHRoaXMtPl9jYWNoZSA9ICgkY2FjaGUp
ID8gdHJ1ZSA6IGZhbHNlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHB1Ymxp
YyBmdW5jdGlvbiBjYWNoZURpcigkbG9jKQogICAgewogICAgICAgICR0aGlzLT5fY2FjaGVf
ZGlyID0gJGxvYzsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMgZnVu
Y3Rpb24gY2FjaGVUaW1lKCRtaW5zKQogICAgewogICAgICAgICR0aGlzLT5fY2FjaGVfdGlt
ZSA9ICRtaW5zKjYwOyAvLyBjb252ZXJ0IG1pbnV0ZXMgaW50byBzZWNvbmRzCiAgICAgICAg
cmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJpdmF0ZSBmdW5jdGlvbiBfcmV0cmlldmVDYWNo
ZSgkdXJsLCRvdmVyaWRlX3RpbWVvdXQ9ZmFsc2UpCiAgICB7CiAgICAgICAgJGZpbGUgPSAk
dGhpcy0+X2NhY2hlX2Rpci4nLycuJHVybDsKICAgICAgICBpZiAoZmlsZV9leGlzdHMoJGZp
bGUpKSB7CgogICAgICAgICAgICAkZGlmZiA9IHRpbWUoKSAtIGZpbGVtdGltZSgkZmlsZSk7
CiAgICAgICAgICAgIGlmICgkb3ZlcmlkZV90aW1lb3V0IHx8ICRkaWZmIDwgJHRoaXMtPl9j
YWNoZV90aW1lKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmlsZV9nZXRfY29udGVudHMo
JGZpbGUpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIGZh
bHNlOwogICAgICAgICAgICB9CgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVy
biBmYWxzZTsKICAgICAgICB9CiAgICB9Cn0KCi8qCiAqIEFicmFoYW0gV2lsbGlhbXMgKGFi
cmFoYW1AYWJyYWguYW0pIGh0dHA6Ly9hYnJhaC5hbQogKgogKiBUaGUgZmlyc3QgUEhQIExp
YnJhcnkgdG8gc3VwcG9ydCBPQXV0aCBmb3IgVHdpdHRlcidzIFJFU1QgQVBJLgogKi8KCi8q
KgogKiBUd2l0dGVyIE9BdXRoIGNsYXNzCiAqLwpjbGFzcyBUd2l0dGVyT0F1dGggewogIC8q
IENvbnRhaW5zIHRoZSBsYXN0IEhUVFAgc3RhdHVzIGNvZGUgcmV0dXJuZWQuICovCiAgcHVi
bGljICRodHRwX2NvZGU7CiAgLyogQ29udGFpbnMgdGhlIGxhc3QgQVBJIGNhbGwuICovCiAg
cHVibGljICR1cmw7CiAgLyogU2V0IHVwIHRoZSBBUEkgcm9vdCBVUkwuICovCiAgcHVibGlj
ICRob3N0ID0gImh0dHBzOi8vYXBpLnR3aXR0ZXIuY29tLzEvIjsKICAvKiBTZXQgdGltZW91
dCBkZWZhdWx0LiAqLwogIHB1YmxpYyAkdGltZW91dCA9IDMwOwogIC8qIFNldCBjb25uZWN0
IHRpbWVvdXQuICovCiAgcHVibGljICRjb25uZWN0dGltZW91dCA9IDMwOwogIC8qIFZlcmlm
eSBTU0wgQ2VydC4gKi8KICBwdWJsaWMgJHNzbF92ZXJpZnlwZWVyID0gRkFMU0U7CiAgLyog
UmVzcG9ucyBmb3JtYXQuICovCiAgcHVibGljICRmb3JtYXQgPSAnanNvbic7CiAgLyogRGVj
b2RlIHJldHVybmVkIGpzb24gZGF0YS4gKi8KICBwdWJsaWMgJGRlY29kZV9qc29uID0gVFJV
RTsKICAvKiBDb250YWlucyB0aGUgbGFzdCBIVFRQIGhlYWRlcnMgcmV0dXJuZWQuICovCiAg
cHVibGljICRodHRwX2luZm87CiAgLyogU2V0IHRoZSB1c2VyYWduZXQuICovCiAgcHVibGlj
ICR1c2VyYWdlbnQgPSAnVHdpdHRlck9BdXRoIHYwLjIuMC1iZXRhMic7CiAgLyogSW1tZWRp
YXRlbHkgcmV0cnkgdGhlIEFQSSBjYWxsIGlmIHRoZSByZXNwb25zZSB3YXMgbm90IHN1Y2Nl
c3NmdWwuICovCiAgLy9wdWJsaWMgJHJldHJ5ID0gVFJVRTsKCgoKCiAgLyoqCiAgICogU2V0
IEFQSSBVUkxTCiAgICovCiAgZnVuY3Rpb24gYWNjZXNzVG9rZW5VUkwoKSAgeyByZXR1cm4g
J2h0dHBzOi8vYXBpLnR3aXR0ZXIuY29tL29hdXRoL2FjY2Vzc190b2tlbic7IH0KICBmdW5j
dGlvbiBhdXRoZW50aWNhdGVVUkwoKSB7IHJldHVybiAnaHR0cHM6Ly90d2l0dGVyLmNvbS9v
YXV0aC9hdXRoZW50aWNhdGUnOyB9CiAgZnVuY3Rpb24gYXV0aG9yaXplVVJMKCkgICAgeyBy
ZXR1cm4gJ2h0dHBzOi8vdHdpdHRlci5jb20vb2F1dGgvYXV0aG9yaXplJzsgfQogIGZ1bmN0
aW9uIHJlcXVlc3RUb2tlblVSTCgpIHsgcmV0dXJuICdodHRwczovL2FwaS50d2l0dGVyLmNv
bS9vYXV0aC9yZXF1ZXN0X3Rva2VuJzsgfQoKICAvKioKICAgKiBEZWJ1ZyBoZWxwZXJzCiAg
ICovCiAgZnVuY3Rpb24gbGFzdFN0YXR1c0NvZGUoKSB7IHJldHVybiAkdGhpcy0+aHR0cF9z
dGF0dXM7IH0KICBmdW5jdGlvbiBsYXN0QVBJQ2FsbCgpIHsgcmV0dXJuICR0aGlzLT5sYXN0
X2FwaV9jYWxsOyB9CgogIC8qKgogICAqIGNvbnN0cnVjdCBUd2l0dGVyT0F1dGggb2JqZWN0
CiAgICovCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGNvbnN1bWVyX2tleSwgJGNvbnN1bWVy
X3NlY3JldCwgJG9hdXRoX3Rva2VuID0gTlVMTCwgJG9hdXRoX3Rva2VuX3NlY3JldCA9IE5V
TEwpIHsKICAgICR0aGlzLT5zaGExX21ldGhvZCA9IG5ldyBPQXV0aFNpZ25hdHVyZU1ldGhv
ZF9ITUFDX1NIQTEoKTsKICAgICR0aGlzLT5jb25zdW1lciA9IG5ldyBPQXV0aENvbnN1bWVy
KCRjb25zdW1lcl9rZXksICRjb25zdW1lcl9zZWNyZXQpOwogICAgaWYgKCFlbXB0eSgkb2F1
dGhfdG9rZW4pICYmICFlbXB0eSgkb2F1dGhfdG9rZW5fc2VjcmV0KSkgewogICAgICAkdGhp
cy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigkb2F1dGhfdG9rZW4sICRvYXV0aF90b2tl
bl9zZWNyZXQpOwogICAgfSBlbHNlIHsKICAgICAgJHRoaXMtPnRva2VuID0gTlVMTDsKICAg
IH0KICB9CgoKICAvKioKICAgKiBHZXQgYSByZXF1ZXN0X3Rva2VuIGZyb20gVHdpdHRlcgog
ICAqCiAgICogQHJldHVybnMgYSBrZXkvdmFsdWUgYXJyYXkgY29udGFpbmluZyBvYXV0aF90
b2tlbiBhbmQgb2F1dGhfdG9rZW5fc2VjcmV0CiAgICovCiAgZnVuY3Rpb24gZ2V0UmVxdWVz
dFRva2VuKCRvYXV0aF9jYWxsYmFjayA9IE5VTEwpIHsKICAgICRwYXJhbWV0ZXJzID0gYXJy
YXkoKTsKICAgIGlmICghZW1wdHkoJG9hdXRoX2NhbGxiYWNrKSkgewogICAgICAkcGFyYW1l
dGVyc1snb2F1dGhfY2FsbGJhY2snXSA9ICRvYXV0aF9jYWxsYmFjazsKICAgIH0KICAgICRy
ZXF1ZXN0ID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdGhpcy0+cmVxdWVzdFRva2VuVVJMKCks
ICdHRVQnLCAkcGFyYW1ldGVycyk7CiAgICAkdG9rZW4gPSBPQXV0aFV0aWw6OnBhcnNlX3Bh
cmFtZXRlcnMoJHJlcXVlc3QpOwogICAgJHRoaXMtPnRva2VuID0gbmV3IE9BdXRoQ29uc3Vt
ZXIoJHRva2VuWydvYXV0aF90b2tlbiddLCAkdG9rZW5bJ29hdXRoX3Rva2VuX3NlY3JldCdd
KTsKICAgIHJldHVybiAkdG9rZW47CiAgfQoKICAvKioKICAgKiBHZXQgdGhlIGF1dGhvcml6
ZSBVUkwKICAgKgogICAqIEByZXR1cm5zIGEgc3RyaW5nCiAgICovCiAgZnVuY3Rpb24gZ2V0
QXV0aG9yaXplVVJMKCR0b2tlbiwgJHNpZ25faW5fd2l0aF90d2l0dGVyID0gVFJVRSkgewog
ICAgaWYgKGlzX2FycmF5KCR0b2tlbikpIHsKICAgICAgJHRva2VuID0gJHRva2VuWydvYXV0
aF90b2tlbiddOwogICAgfQogICAgaWYgKGVtcHR5KCRzaWduX2luX3dpdGhfdHdpdHRlcikp
IHsKICAgICAgcmV0dXJuICR0aGlzLT5hdXRob3JpemVVUkwoKSAuICI/b2F1dGhfdG9rZW49
eyR0b2tlbn0iOwogICAgfSBlbHNlIHsKICAgICAgIHJldHVybiAkdGhpcy0+YXV0aGVudGlj
YXRlVVJMKCkgLiAiP29hdXRoX3Rva2VuPXskdG9rZW59IjsKICAgIH0KICB9CgogIC8qKgog
ICAqIEV4Y2hhbmdlIHJlcXVlc3QgdG9rZW4gYW5kIHNlY3JldCBmb3IgYW4gYWNjZXNzIHRv
a2VuIGFuZAogICAqIHNlY3JldCwgdG8gc2lnbiBBUEkgY2FsbHMuCiAgICoKICAgKiBAcmV0
dXJucyBhcnJheSgib2F1dGhfdG9rZW4iID0+ICJ0aGUtYWNjZXNzLXRva2VuIiwKICAgKiAg
ICAgICAgICAgICAgICAib2F1dGhfdG9rZW5fc2VjcmV0IiA9PiAidGhlLWFjY2Vzcy1zZWNy
ZXQiLAogICAqICAgICAgICAgICAgICAgICJ1c2VyX2lkIiA9PiAiOTQzNjk5MiIsCiAgICog
ICAgICAgICAgICAgICAgInNjcmVlbl9uYW1lIiA9PiAiYWJyYWhhbSIpCiAgICovCiAgZnVu
Y3Rpb24gZ2V0QWNjZXNzVG9rZW4oJG9hdXRoX3ZlcmlmaWVyID0gRkFMU0UpIHsKICAgICRw
YXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgIGlmICghZW1wdHkoJG9hdXRoX3ZlcmlmaWVyKSkg
ewogICAgICAkcGFyYW1ldGVyc1snb2F1dGhfdmVyaWZpZXInXSA9ICRvYXV0aF92ZXJpZmll
cjsKICAgIH0KICAgICRyZXF1ZXN0ID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdGhpcy0+YWNj
ZXNzVG9rZW5VUkwoKSwgJ0dFVCcsICRwYXJhbWV0ZXJzKTsKICAgICR0b2tlbiA9IE9BdXRo
VXRpbDo6cGFyc2VfcGFyYW1ldGVycygkcmVxdWVzdCk7CiAgICAkdGhpcy0+dG9rZW4gPSBu
ZXcgT0F1dGhDb25zdW1lcigkdG9rZW5bJ29hdXRoX3Rva2VuJ10sICR0b2tlblsnb2F1dGhf
dG9rZW5fc2VjcmV0J10pOwogICAgcmV0dXJuICR0b2tlbjsKICB9CgogIC8qKgogICAqIE9u
ZSB0aW1lIGV4Y2hhbmdlIG9mIHVzZXJuYW1lIGFuZCBwYXNzd29yZCBmb3IgYWNjZXNzIHRv
a2VuIGFuZCBzZWNyZXQuCiAgICoKICAgKiBAcmV0dXJucyBhcnJheSgib2F1dGhfdG9rZW4i
ID0+ICJ0aGUtYWNjZXNzLXRva2VuIiwKICAgKiAgICAgICAgICAgICAgICAib2F1dGhfdG9r
ZW5fc2VjcmV0IiA9PiAidGhlLWFjY2Vzcy1zZWNyZXQiLAogICAqICAgICAgICAgICAgICAg
ICJ1c2VyX2lkIiA9PiAiOTQzNjk5MiIsCiAgICogICAgICAgICAgICAgICAgInNjcmVlbl9u
YW1lIiA9PiAiYWJyYWhhbSIsCiAgICogICAgICAgICAgICAgICAgInhfYXV0aF9leHBpcmVz
IiA9PiAiMCIpCiAgICovCiAgZnVuY3Rpb24gZ2V0WEF1dGhUb2tlbigkdXNlcm5hbWUsICRw
YXNzd29yZCkgewogICAgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgJHBhcmFtZXRlcnNb
J3hfYXV0aF91c2VybmFtZSddID0gJHVzZXJuYW1lOwogICAgJHBhcmFtZXRlcnNbJ3hfYXV0
aF9wYXNzd29yZCddID0gJHBhc3N3b3JkOwogICAgJHBhcmFtZXRlcnNbJ3hfYXV0aF9tb2Rl
J10gPSAnY2xpZW50X2F1dGgnOwogICAgJHJlcXVlc3QgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0
KCR0aGlzLT5hY2Nlc3NUb2tlblVSTCgpLCAnUE9TVCcsICRwYXJhbWV0ZXJzKTsKICAgICR0
b2tlbiA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygkcmVxdWVzdCk7CiAgICAkdGhp
cy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigkdG9rZW5bJ29hdXRoX3Rva2VuJ10sICR0
b2tlblsnb2F1dGhfdG9rZW5fc2VjcmV0J10pOwogICAgcmV0dXJuICR0b2tlbjsKICB9Cgog
IC8qKgogICAqIEdFVCB3cmFwcGVyIGZvciBvQXV0aFJlcXVlc3QuCiAgICovCiAgZnVuY3Rp
b24gZ2V0KCR1cmwsICRwYXJhbWV0ZXJzID0gYXJyYXkoKSkgewogICAgJHJlc3BvbnNlID0g
JHRoaXMtPm9BdXRoUmVxdWVzdCgkdXJsLCAnR0VUJywgJHBhcmFtZXRlcnMpOwogICAgaWYg
KCR0aGlzLT5mb3JtYXQgPT09ICdqc29uJyAmJiAkdGhpcy0+ZGVjb2RlX2pzb24pIHsKICAg
ICAgcmV0dXJuIGpzb25fZGVjb2RlKCRyZXNwb25zZSk7CiAgICB9CiAgICByZXR1cm4gJHJl
c3BvbnNlOwogIH0KCiAgLyoqCiAgICogUE9TVCB3cmFwcGVyIGZvciBvQXV0aFJlcXVlc3Qu
CiAgICovCiAgZnVuY3Rpb24gcG9zdCgkdXJsLCAkcGFyYW1ldGVycyA9IGFycmF5KCkpIHsK
ICAgICRyZXNwb25zZSA9ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHVybCwgJ1BPU1QnLCAkcGFy
YW1ldGVycyk7CiAgICBpZiAoJHRoaXMtPmZvcm1hdCA9PT0gJ2pzb24nICYmICR0aGlzLT5k
ZWNvZGVfanNvbikgewogICAgICByZXR1cm4ganNvbl9kZWNvZGUoJHJlc3BvbnNlKTsKICAg
IH0KICAgIHJldHVybiAkcmVzcG9uc2U7CiAgfQoKICAvKioKICAgKiBERUxFVEUgd3JhcHBl
ciBmb3Igb0F1dGhSZXFldXN0LgogICAqLwogIGZ1bmN0aW9uIGRlbGV0ZSgkdXJsLCAkcGFy
YW1ldGVycyA9IGFycmF5KCkpIHsKICAgICRyZXNwb25zZSA9ICR0aGlzLT5vQXV0aFJlcXVl
c3QoJHVybCwgJ0RFTEVURScsICRwYXJhbWV0ZXJzKTsKICAgIGlmICgkdGhpcy0+Zm9ybWF0
ID09PSAnanNvbicgJiYgJHRoaXMtPmRlY29kZV9qc29uKSB7CiAgICAgIHJldHVybiBqc29u
X2RlY29kZSgkcmVzcG9uc2UpOwogICAgfQogICAgcmV0dXJuICRyZXNwb25zZTsKICB9Cgog
IC8qKgogICAqIEZvcm1hdCBhbmQgc2lnbiBhbiBPQXV0aCAvIEFQSSByZXF1ZXN0CiAgICov
CiAgZnVuY3Rpb24gb0F1dGhSZXF1ZXN0KCR1cmwsICRtZXRob2QsICRwYXJhbWV0ZXJzKSB7
CiAgICBpZiAoc3RycnBvcygkdXJsLCAnaHR0cHM6Ly8nKSAhPT0gMCAmJiBzdHJycG9zKCR1
cmwsICdodHRwOi8vJykgIT09IDApIHsKICAgICAgJHVybCA9ICJ7JHRoaXMtPmhvc3R9eyR1
cmx9LnskdGhpcy0+Zm9ybWF0fSI7CiAgICB9CiAgICAkcmVxdWVzdCA9IE9BdXRoUmVxdWVz
dDo6ZnJvbV9jb25zdW1lcl9hbmRfdG9rZW4oJHRoaXMtPmNvbnN1bWVyLCAkdGhpcy0+dG9r
ZW4sICRtZXRob2QsICR1cmwsICRwYXJhbWV0ZXJzKTsKICAgICRyZXF1ZXN0LT5zaWduX3Jl
cXVlc3QoJHRoaXMtPnNoYTFfbWV0aG9kLCAkdGhpcy0+Y29uc3VtZXIsICR0aGlzLT50b2tl
bik7CiAgICBzd2l0Y2ggKCRtZXRob2QpIHsKICAgIGNhc2UgJ0dFVCc6CiAgICAgIHJldHVy
biAkdGhpcy0+aHR0cCgkcmVxdWVzdC0+dG9fdXJsKCksICdHRVQnKTsKICAgIGRlZmF1bHQ6
CiAgICAgIHJldHVybiAkdGhpcy0+aHR0cCgkcmVxdWVzdC0+Z2V0X25vcm1hbGl6ZWRfaHR0
cF91cmwoKSwgJG1ldGhvZCwgJHJlcXVlc3QtPnRvX3Bvc3RkYXRhKCkpOwogICAgfQogIH0K
CiAgLyoqCiAgICogTWFrZSBhbiBIVFRQIHJlcXVlc3QKICAgKgogICAqIEByZXR1cm4gQVBJ
IHJlc3VsdHMKICAgKi8KICBmdW5jdGlvbiBodHRwKCR1cmwsICRtZXRob2QsICRwb3N0Zmll
bGRzID0gTlVMTCkgewogICAgJHRoaXMtPmh0dHBfaW5mbyA9IGFycmF5KCk7CiAgICAkY2kg
PSBjdXJsX2luaXQoKTsKICAgIC8qIEN1cmwgc2V0dGluZ3MgKi8KICAgIGN1cmxfc2V0b3B0
KCRjaSwgQ1VSTE9QVF9VU0VSQUdFTlQsICR0aGlzLT51c2VyYWdlbnQpOwogICAgY3VybF9z
ZXRvcHQoJGNpLCBDVVJMT1BUX0NPTk5FQ1RUSU1FT1VULCAkdGhpcy0+Y29ubmVjdHRpbWVv
dXQpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1RJTUVPVVQsICR0aGlzLT50aW1l
b3V0KTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgVFJV
RSk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfSFRUUEhFQURFUiwgYXJyYXkoJ0V4
cGVjdDonKSk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfU1NMX1ZFUklGWVBFRVIs
ICR0aGlzLT5zc2xfdmVyaWZ5cGVlcik7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRf
SEVBREVSRlVOQ1RJT04sIGFycmF5KCR0aGlzLCAnZ2V0SGVhZGVyJykpOwogICAgY3VybF9z
ZXRvcHQoJGNpLCBDVVJMT1BUX0hFQURFUiwgRkFMU0UpOwoKICAgIHN3aXRjaCAoJG1ldGhv
ZCkgewogICAgICBjYXNlICdQT1NUJzoKICAgICAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxP
UFRfUE9TVCwgVFJVRSk7CiAgICAgICAgaWYgKCFlbXB0eSgkcG9zdGZpZWxkcykpIHsKICAg
ICAgICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9QT1NURklFTERTLCAkcG9zdGZpZWxk
cyk7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdERUxFVEUnOgogICAg
ICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9DVVNUT01SRVFVRVNULCAnREVMRVRFJyk7
CiAgICAgICAgaWYgKCFlbXB0eSgkcG9zdGZpZWxkcykpIHsKICAgICAgICAgICR1cmwgPSAi
eyR1cmx9P3skcG9zdGZpZWxkc30iOwogICAgICAgIH0KICAgIH0KCiAgICBjdXJsX3NldG9w
dCgkY2ksIENVUkxPUFRfVVJMLCAkdXJsKTsKICAgICRyZXNwb25zZSA9IGN1cmxfZXhlYygk
Y2kpOwogICAgJHRoaXMtPmh0dHBfY29kZSA9IGN1cmxfZ2V0aW5mbygkY2ksIENVUkxJTkZP
X0hUVFBfQ09ERSk7CiAgICAkdGhpcy0+aHR0cF9pbmZvID0gYXJyYXlfbWVyZ2UoJHRoaXMt
Pmh0dHBfaW5mbywgY3VybF9nZXRpbmZvKCRjaSkpOwogICAgJHRoaXMtPnVybCA9ICR1cmw7
CiAgICBjdXJsX2Nsb3NlICgkY2kpOwogICAgcmV0dXJuICRyZXNwb25zZTsKICB9CgogIC8q
KgogICAqIEdldCB0aGUgaGVhZGVyIGluZm8gdG8gc3RvcmUuCiAgICovCiAgZnVuY3Rpb24g
Z2V0SGVhZGVyKCRjaCwgJGhlYWRlcikgewogICAgJGkgPSBzdHJwb3MoJGhlYWRlciwgJzon
KTsKICAgIGlmICghZW1wdHkoJGkpKSB7CiAgICAgICRrZXkgPSBzdHJfcmVwbGFjZSgnLScs
ICdfJywgc3RydG9sb3dlcihzdWJzdHIoJGhlYWRlciwgMCwgJGkpKSk7CiAgICAgICR2YWx1
ZSA9IHRyaW0oc3Vic3RyKCRoZWFkZXIsICRpICsgMikpOwogICAgICAkdGhpcy0+aHR0cF9o
ZWFkZXJbJGtleV0gPSAkdmFsdWU7CiAgICB9CiAgICByZXR1cm4gc3RybGVuKCRoZWFkZXIp
OwogIH0KfQoKY2xhc3MgT0F1dGhFeGNlcHRpb24gZXh0ZW5kcyBFeGNlcHRpb24gewogIC8v
IHBhc3MKfQoKY2xhc3MgT0F1dGhDb25zdW1lciB7CiAgcHVibGljICRrZXk7CiAgcHVibGlj
ICRzZWNyZXQ7CgogIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRrZXksICRzZWNyZXQsICRjYWxs
YmFja191cmw9TlVMTCkgewogICAgJHRoaXMtPmtleSA9ICRrZXk7CiAgICAkdGhpcy0+c2Vj
cmV0ID0gJHNlY3JldDsKICAgICR0aGlzLT5jYWxsYmFja191cmwgPSAkY2FsbGJhY2tfdXJs
OwogIH0KCiAgZnVuY3Rpb24gX190b1N0cmluZygpIHsKICAgIHJldHVybiAiT0F1dGhDb25z
dW1lcltrZXk9JHRoaXMtPmtleSxzZWNyZXQ9JHRoaXMtPnNlY3JldF0iOwogIH0KfQoKY2xh
c3MgT0F1dGhUb2tlbiB7CiAgLy8gYWNjZXNzIHRva2VucyBhbmQgcmVxdWVzdCB0b2tlbnMK
ICBwdWJsaWMgJGtleTsKICBwdWJsaWMgJHNlY3JldDsKCiAgLyoqCiAgICoga2V5ID0gdGhl
IHRva2VuCiAgICogc2VjcmV0ID0gdGhlIHRva2VuIHNlY3JldAogICAqLwogIGZ1bmN0aW9u
IF9fY29uc3RydWN0KCRrZXksICRzZWNyZXQpIHsKICAgICR0aGlzLT5rZXkgPSAka2V5Owog
ICAgJHRoaXMtPnNlY3JldCA9ICRzZWNyZXQ7CiAgfQoKICAvKioKICAgKiBnZW5lcmF0ZXMg
dGhlIGJhc2ljIHN0cmluZyBzZXJpYWxpemF0aW9uIG9mIGEgdG9rZW4gdGhhdCBhIHNlcnZl
cgogICAqIHdvdWxkIHJlc3BvbmQgdG8gcmVxdWVzdF90b2tlbiBhbmQgYWNjZXNzX3Rva2Vu
IGNhbGxzIHdpdGgKICAgKi8KICBmdW5jdGlvbiB0b19zdHJpbmcoKSB7CiAgICByZXR1cm4g
Im9hdXRoX3Rva2VuPSIgLgogICAgICAgICAgIE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5
ODYoJHRoaXMtPmtleSkgLgogICAgICAgICAgICImb2F1dGhfdG9rZW5fc2VjcmV0PSIgLgog
ICAgICAgICAgIE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJHRoaXMtPnNlY3JldCk7
CiAgfQoKICBmdW5jdGlvbiBfX3RvU3RyaW5nKCkgewogICAgcmV0dXJuICR0aGlzLT50b19z
dHJpbmcoKTsKICB9Cn0KCi8qKgogKiBBIGNsYXNzIGZvciBpbXBsZW1lbnRpbmcgYSBTaWdu
YXR1cmUgTWV0aG9kCiAqIFNlZSBzZWN0aW9uIDkgKCJTaWduaW5nIFJlcXVlc3RzIikgaW4g
dGhlIHNwZWMKICovCmFic3RyYWN0IGNsYXNzIE9BdXRoU2lnbmF0dXJlTWV0aG9kIHsKICAv
KioKICAgKiBOZWVkcyB0byByZXR1cm4gdGhlIG5hbWUgb2YgdGhlIFNpZ25hdHVyZSBNZXRo
b2QgKGllIEhNQUMtU0hBMSkKICAgKiBAcmV0dXJuIHN0cmluZwogICAqLwogIGFic3RyYWN0
IHB1YmxpYyBmdW5jdGlvbiBnZXRfbmFtZSgpOwoKICAvKioKICAgKiBCdWlsZCB1cCB0aGUg
c2lnbmF0dXJlCiAgICogTk9URTogVGhlIG91dHB1dCBvZiB0aGlzIGZ1bmN0aW9uIE1VU1Qg
Tk9UIGJlIHVybGVuY29kZWQuCiAgICogdGhlIGVuY29kaW5nIGlzIGhhbmRsZWQgaW4gT0F1
dGhSZXF1ZXN0IHdoZW4gdGhlIGZpbmFsCiAgICogcmVxdWVzdCBpcyBzZXJpYWxpemVkCiAg
ICogQHBhcmFtIE9BdXRoUmVxdWVzdCAkcmVxdWVzdAogICAqIEBwYXJhbSBPQXV0aENvbnN1
bWVyICRjb25zdW1lcgogICAqIEBwYXJhbSBPQXV0aFRva2VuICR0b2tlbgogICAqIEByZXR1
cm4gc3RyaW5nCiAgICovCiAgYWJzdHJhY3QgcHVibGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25h
dHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwoKICAvKioKICAgKiBWZXJpZmll
cyB0aGF0IGEgZ2l2ZW4gc2lnbmF0dXJlIGlzIGNvcnJlY3QKICAgKiBAcGFyYW0gT0F1dGhS
ZXF1ZXN0ICRyZXF1ZXN0CiAgICogQHBhcmFtIE9BdXRoQ29uc3VtZXIgJGNvbnN1bWVyCiAg
ICogQHBhcmFtIE9BdXRoVG9rZW4gJHRva2VuCiAgICogQHBhcmFtIHN0cmluZyAkc2lnbmF0
dXJlCiAgICogQHJldHVybiBib29sCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGNoZWNrX3Np
Z25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4sICRzaWduYXR1cmUpIHsKICAg
ICRidWlsdCA9ICR0aGlzLT5idWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwg
JHRva2VuKTsKICAgIHJldHVybiAkYnVpbHQgPT0gJHNpZ25hdHVyZTsKICB9Cn0KCi8qKgog
KiBUaGUgSE1BQy1TSEExIHNpZ25hdHVyZSBtZXRob2QgdXNlcyB0aGUgSE1BQy1TSEExIHNp
Z25hdHVyZSBhbGdvcml0aG0gYXMgZGVmaW5lZCBpbiBbUkZDMjEwNF0KICogd2hlcmUgdGhl
IFNpZ25hdHVyZSBCYXNlIFN0cmluZyBpcyB0aGUgdGV4dCBhbmQgdGhlIGtleSBpcyB0aGUg
Y29uY2F0ZW5hdGVkIHZhbHVlcyAoZWFjaCBmaXJzdAogKiBlbmNvZGVkIHBlciBQYXJhbWV0
ZXIgRW5jb2RpbmcpIG9mIHRoZSBDb25zdW1lciBTZWNyZXQgYW5kIFRva2VuIFNlY3JldCwg
c2VwYXJhdGVkIGJ5IGFuICcmJwogKiBjaGFyYWN0ZXIgKEFTQ0lJIGNvZGUgMzgpIGV2ZW4g
aWYgZW1wdHkuCiAqICAgLSBDaGFwdGVyIDkuMiAoIkhNQUMtU0hBMSIpCiAqLwpjbGFzcyBP
QXV0aFNpZ25hdHVyZU1ldGhvZF9ITUFDX1NIQTEgZXh0ZW5kcyBPQXV0aFNpZ25hdHVyZU1l
dGhvZCB7CiAgZnVuY3Rpb24gZ2V0X25hbWUoKSB7CiAgICByZXR1cm4gIkhNQUMtU0hBMSI7
CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29u
c3VtZXIsICR0b2tlbikgewogICAgJGJhc2Vfc3RyaW5nID0gJHJlcXVlc3QtPmdldF9zaWdu
YXR1cmVfYmFzZV9zdHJpbmcoKTsKICAgICRyZXF1ZXN0LT5iYXNlX3N0cmluZyA9ICRiYXNl
X3N0cmluZzsKCiAgICAka2V5X3BhcnRzID0gYXJyYXkoCiAgICAgICRjb25zdW1lci0+c2Vj
cmV0LAogICAgICAoJHRva2VuKSA/ICR0b2tlbi0+c2VjcmV0IDogIiIKICAgICk7CgogICAg
JGtleV9wYXJ0cyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJGtleV9wYXJ0cyk7
CiAgICAka2V5ID0gaW1wbG9kZSgnJicsICRrZXlfcGFydHMpOwoKICAgIHJldHVybiBiYXNl
NjRfZW5jb2RlKGhhc2hfaG1hYygnc2hhMScsICRiYXNlX3N0cmluZywgJGtleSwgdHJ1ZSkp
OwogIH0KfQoKLyoqCiAqIFRoZSBQTEFJTlRFWFQgbWV0aG9kIGRvZXMgbm90IHByb3ZpZGUg
YW55IHNlY3VyaXR5IHByb3RlY3Rpb24gYW5kIFNIT1VMRCBvbmx5IGJlIHVzZWQKICogb3Zl
ciBhIHNlY3VyZSBjaGFubmVsIHN1Y2ggYXMgSFRUUFMuIEl0IGRvZXMgbm90IHVzZSB0aGUg
U2lnbmF0dXJlIEJhc2UgU3RyaW5nLgogKiAgIC0gQ2hhcHRlciA5LjQgKCJQTEFJTlRFWFQi
KQogKi8KY2xhc3MgT0F1dGhTaWduYXR1cmVNZXRob2RfUExBSU5URVhUIGV4dGVuZHMgT0F1
dGhTaWduYXR1cmVNZXRob2QgewogIHB1YmxpYyBmdW5jdGlvbiBnZXRfbmFtZSgpIHsKICAg
IHJldHVybiAiUExBSU5URVhUIjsKICB9CgogIC8qKgogICAqIG9hdXRoX3NpZ25hdHVyZSBp
cyBzZXQgdG8gdGhlIGNvbmNhdGVuYXRlZCBlbmNvZGVkIHZhbHVlcyBvZiB0aGUgQ29uc3Vt
ZXIgU2VjcmV0IGFuZAogICAqIFRva2VuIFNlY3JldCwgc2VwYXJhdGVkIGJ5IGEgJyYnIGNo
YXJhY3RlciAoQVNDSUkgY29kZSAzOCksIGV2ZW4gaWYgZWl0aGVyIHNlY3JldCBpcwogICAq
IGVtcHR5LiBUaGUgcmVzdWx0IE1VU1QgYmUgZW5jb2RlZCBhZ2Fpbi4KICAgKiAgIC0gQ2hh
cHRlciA5LjQuMSAoIkdlbmVyYXRpbmcgU2lnbmF0dXJlcyIpCiAgICoKICAgKiBQbGVhc2Ug
bm90ZSB0aGF0IHRoZSBzZWNvbmQgZW5jb2RpbmcgTVVTVCBOT1QgaGFwcGVuIGluIHRoZSBT
aWduYXR1cmVNZXRob2QsIGFzCiAgICogT0F1dGhSZXF1ZXN0IGhhbmRsZXMgdGhpcyEKICAg
Ki8KICBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3Vt
ZXIsICR0b2tlbikgewogICAgJGtleV9wYXJ0cyA9IGFycmF5KAogICAgICAkY29uc3VtZXIt
PnNlY3JldCwKICAgICAgKCR0b2tlbikgPyAkdG9rZW4tPnNlY3JldCA6ICIiCiAgICApOwoK
ICAgICRrZXlfcGFydHMgPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCRrZXlfcGFy
dHMpOwogICAgJGtleSA9IGltcGxvZGUoJyYnLCAka2V5X3BhcnRzKTsKICAgICRyZXF1ZXN0
LT5iYXNlX3N0cmluZyA9ICRrZXk7CgogICAgcmV0dXJuICRrZXk7CiAgfQp9CgovKioKICog
VGhlIFJTQS1TSEExIHNpZ25hdHVyZSBtZXRob2QgdXNlcyB0aGUgUlNBU1NBLVBLQ1MxLXYx
XzUgc2lnbmF0dXJlIGFsZ29yaXRobSBhcyBkZWZpbmVkIGluCiAqIFtSRkMzNDQ3XSBzZWN0
aW9uIDguMiAobW9yZSBzaW1wbHkga25vd24gYXMgUEtDUyMxKSwgdXNpbmcgU0hBLTEgYXMg
dGhlIGhhc2ggZnVuY3Rpb24gZm9yCiAqIEVNU0EtUEtDUzEtdjFfNS4gSXQgaXMgYXNzdW1l
ZCB0aGF0IHRoZSBDb25zdW1lciBoYXMgcHJvdmlkZWQgaXRzIFJTQSBwdWJsaWMga2V5IGlu
IGEKICogdmVyaWZpZWQgd2F5IHRvIHRoZSBTZXJ2aWNlIFByb3ZpZGVyLCBpbiBhIG1hbm5l
ciB3aGljaCBpcyBiZXlvbmQgdGhlIHNjb3BlIG9mIHRoaXMKICogc3BlY2lmaWNhdGlvbi4K
ICogICAtIENoYXB0ZXIgOS4zICgiUlNBLVNIQTEiKQogKi8KYWJzdHJhY3QgY2xhc3MgT0F1
dGhTaWduYXR1cmVNZXRob2RfUlNBX1NIQTEgZXh0ZW5kcyBPQXV0aFNpZ25hdHVyZU1ldGhv
ZCB7CiAgcHVibGljIGZ1bmN0aW9uIGdldF9uYW1lKCkgewogICAgcmV0dXJuICJSU0EtU0hB
MSI7CiAgfQoKICAvLyBVcCB0byB0aGUgU1AgdG8gaW1wbGVtZW50IHRoaXMgbG9va3VwIG9m
IGtleXMuIFBvc3NpYmxlIGlkZWFzIGFyZToKICAvLyAoMSkgZG8gYSBsb29rdXAgaW4gYSB0
YWJsZSBvZiB0cnVzdGVkIGNlcnRzIGtleWVkIG9mZiBvZiBjb25zdW1lcgogIC8vICgyKSBm
ZXRjaCB2aWEgaHR0cCB1c2luZyBhIHVybCBwcm92aWRlZCBieSB0aGUgcmVxdWVzdGVyCiAg
Ly8gKDMpIHNvbWUgc29ydCBvZiBzcGVjaWZpYyBkaXNjb3ZlcnkgY29kZSBiYXNlZCBvbiBy
ZXF1ZXN0CiAgLy8KICAvLyBFaXRoZXIgd2F5IHNob3VsZCByZXR1cm4gYSBzdHJpbmcgcmVw
cmVzZW50YXRpb24gb2YgdGhlIGNlcnRpZmljYXRlCiAgcHJvdGVjdGVkIGFic3RyYWN0IGZ1
bmN0aW9uIGZldGNoX3B1YmxpY19jZXJ0KCYkcmVxdWVzdCk7CgogIC8vIFVwIHRvIHRoZSBT
UCB0byBpbXBsZW1lbnQgdGhpcyBsb29rdXAgb2Yga2V5cy4gUG9zc2libGUgaWRlYXMgYXJl
OgogIC8vICgxKSBkbyBhIGxvb2t1cCBpbiBhIHRhYmxlIG9mIHRydXN0ZWQgY2VydHMga2V5
ZWQgb2ZmIG9mIGNvbnN1bWVyCiAgLy8KICAvLyBFaXRoZXIgd2F5IHNob3VsZCByZXR1cm4g
YSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIGNlcnRpZmljYXRlCiAgcHJvdGVjdGVk
IGFic3RyYWN0IGZ1bmN0aW9uIGZldGNoX3ByaXZhdGVfY2VydCgmJHJlcXVlc3QpOwoKICBw
dWJsaWMgZnVuY3Rpb24gYnVpbGRfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0
b2tlbikgewogICAgJGJhc2Vfc3RyaW5nID0gJHJlcXVlc3QtPmdldF9zaWduYXR1cmVfYmFz
ZV9zdHJpbmcoKTsKICAgICRyZXF1ZXN0LT5iYXNlX3N0cmluZyA9ICRiYXNlX3N0cmluZzsK
CiAgICAvLyBGZXRjaCB0aGUgcHJpdmF0ZSBrZXkgY2VydCBiYXNlZCBvbiB0aGUgcmVxdWVz
dAogICAgJGNlcnQgPSAkdGhpcy0+ZmV0Y2hfcHJpdmF0ZV9jZXJ0KCRyZXF1ZXN0KTsKCiAg
ICAvLyBQdWxsIHRoZSBwcml2YXRlIGtleSBJRCBmcm9tIHRoZSBjZXJ0aWZpY2F0ZQogICAg
JHByaXZhdGVrZXlpZCA9IG9wZW5zc2xfZ2V0X3ByaXZhdGVrZXkoJGNlcnQpOwoKICAgIC8v
IFNpZ24gdXNpbmcgdGhlIGtleQogICAgJG9rID0gb3BlbnNzbF9zaWduKCRiYXNlX3N0cmlu
ZywgJHNpZ25hdHVyZSwgJHByaXZhdGVrZXlpZCk7CgogICAgLy8gUmVsZWFzZSB0aGUga2V5
IHJlc291cmNlCiAgICBvcGVuc3NsX2ZyZWVfa2V5KCRwcml2YXRla2V5aWQpOwoKICAgIHJl
dHVybiBiYXNlNjRfZW5jb2RlKCRzaWduYXR1cmUpOwogIH0KCiAgcHVibGljIGZ1bmN0aW9u
IGNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4sICRzaWduYXR1
cmUpIHsKICAgICRkZWNvZGVkX3NpZyA9IGJhc2U2NF9kZWNvZGUoJHNpZ25hdHVyZSk7Cgog
ICAgJGJhc2Vfc3RyaW5nID0gJHJlcXVlc3QtPmdldF9zaWduYXR1cmVfYmFzZV9zdHJpbmco
KTsKCiAgICAvLyBGZXRjaCB0aGUgcHVibGljIGtleSBjZXJ0IGJhc2VkIG9uIHRoZSByZXF1
ZXN0CiAgICAkY2VydCA9ICR0aGlzLT5mZXRjaF9wdWJsaWNfY2VydCgkcmVxdWVzdCk7Cgog
ICAgLy8gUHVsbCB0aGUgcHVibGljIGtleSBJRCBmcm9tIHRoZSBjZXJ0aWZpY2F0ZQogICAg
JHB1YmxpY2tleWlkID0gb3BlbnNzbF9nZXRfcHVibGlja2V5KCRjZXJ0KTsKCiAgICAvLyBD
aGVjayB0aGUgY29tcHV0ZWQgc2lnbmF0dXJlIGFnYWluc3QgdGhlIG9uZSBwYXNzZWQgaW4g
dGhlIHF1ZXJ5CiAgICAkb2sgPSBvcGVuc3NsX3ZlcmlmeSgkYmFzZV9zdHJpbmcsICRkZWNv
ZGVkX3NpZywgJHB1YmxpY2tleWlkKTsKCiAgICAvLyBSZWxlYXNlIHRoZSBrZXkgcmVzb3Vy
Y2UKICAgIG9wZW5zc2xfZnJlZV9rZXkoJHB1YmxpY2tleWlkKTsKCiAgICByZXR1cm4gJG9r
ID09IDE7CiAgfQp9CgpjbGFzcyBPQXV0aFJlcXVlc3QgewogIHByaXZhdGUgJHBhcmFtZXRl
cnM7CiAgcHJpdmF0ZSAkaHR0cF9tZXRob2Q7CiAgcHJpdmF0ZSAkaHR0cF91cmw7CiAgLy8g
Zm9yIGRlYnVnIHB1cnBvc2VzCiAgcHVibGljICRiYXNlX3N0cmluZzsKICBwdWJsaWMgc3Rh
dGljICR2ZXJzaW9uID0gJzEuMCc7CiAgcHVibGljIHN0YXRpYyAkUE9TVF9JTlBVVCA9ICdw
aHA6Ly9pbnB1dCc7CgogIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRodHRwX21ldGhvZCwgJGh0
dHBfdXJsLCAkcGFyYW1ldGVycz1OVUxMKSB7CiAgICBAJHBhcmFtZXRlcnMgb3IgJHBhcmFt
ZXRlcnMgPSBhcnJheSgpOwogICAgJHBhcmFtZXRlcnMgPSBhcnJheV9tZXJnZSggT0F1dGhV
dGlsOjpwYXJzZV9wYXJhbWV0ZXJzKHBhcnNlX3VybCgkaHR0cF91cmwsIFBIUF9VUkxfUVVF
UlkpKSwgJHBhcmFtZXRlcnMpOwogICAgJHRoaXMtPnBhcmFtZXRlcnMgPSAkcGFyYW1ldGVy
czsKICAgICR0aGlzLT5odHRwX21ldGhvZCA9ICRodHRwX21ldGhvZDsKICAgICR0aGlzLT5o
dHRwX3VybCA9ICRodHRwX3VybDsKICB9CgoKICAvKioKICAgKiBhdHRlbXB0IHRvIGJ1aWxk
IHVwIGEgcmVxdWVzdCBmcm9tIHdoYXQgd2FzIHBhc3NlZCB0byB0aGUgc2VydmVyCiAgICov
CiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBmcm9tX3JlcXVlc3QoJGh0dHBfbWV0aG9kPU5V
TEwsICRodHRwX3VybD1OVUxMLCAkcGFyYW1ldGVycz1OVUxMKSB7CiAgICAkc2NoZW1lID0g
KCFpc3NldCgkX1NFUlZFUlsnSFRUUFMnXSkgfHwgJF9TRVJWRVJbJ0hUVFBTJ10gIT0gIm9u
IikKICAgICAgICAgICAgICA/ICdodHRwJwogICAgICAgICAgICAgIDogJ2h0dHBzJzsKICAg
IEAkaHR0cF91cmwgb3IgJGh0dHBfdXJsID0gJHNjaGVtZSAuCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICc6Ly8nIC4gJF9TRVJWRVJbJ0hUVFBfSE9TVCddIC4KICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgJzonIC4KICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgJF9TRVJWRVJbJ1NFUlZFUl9QT1JUJ10gLgogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAkX1NFUlZFUlsnUkVRVUVTVF9VUkknXTsKICAgIEAkaHR0cF9tZXRob2Qgb3IgJGh0
dHBfbWV0aG9kID0gJF9TRVJWRVJbJ1JFUVVFU1RfTUVUSE9EJ107CgogICAgLy8gV2Ugd2Vy
ZW4ndCBoYW5kZWQgYW55IHBhcmFtZXRlcnMsIHNvIGxldCdzIGZpbmQgdGhlIG9uZXMgcmVs
ZXZhbnQgdG8KICAgIC8vIHRoaXMgcmVxdWVzdC4KICAgIC8vIElmIHlvdSBydW4gWE1MLVJQ
QyBvciBzaW1pbGFyIHlvdSBzaG91bGQgdXNlIHRoaXMgdG8gcHJvdmlkZSB5b3VyIG93bgog
ICAgLy8gcGFyc2VkIHBhcmFtZXRlci1saXN0CiAgICBpZiAoISRwYXJhbWV0ZXJzKSB7CiAg
ICAgIC8vIEZpbmQgcmVxdWVzdCBoZWFkZXJzCiAgICAgICRyZXF1ZXN0X2hlYWRlcnMgPSBP
QXV0aFV0aWw6OmdldF9oZWFkZXJzKCk7CgogICAgICAvLyBQYXJzZSB0aGUgcXVlcnktc3Ry
aW5nIHRvIGZpbmQgR0VUIHBhcmFtZXRlcnMKICAgICAgJHBhcmFtZXRlcnMgPSBPQXV0aFV0
aWw6OnBhcnNlX3BhcmFtZXRlcnMoJF9TRVJWRVJbJ1FVRVJZX1NUUklORyddKTsKCiAgICAg
IC8vIEl0J3MgYSBQT1NUIHJlcXVlc3Qgb2YgdGhlIHByb3BlciBjb250ZW50LXR5cGUsIHNv
IHBhcnNlIFBPU1QKICAgICAgLy8gcGFyYW1ldGVycyBhbmQgYWRkIHRob3NlIG92ZXJyaWRp
bmcgYW55IGR1cGxpY2F0ZXMgZnJvbSBHRVQKICAgICAgaWYgKCRodHRwX21ldGhvZCA9PSAi
UE9TVCIKICAgICAgICAgICYmIEBzdHJzdHIoJHJlcXVlc3RfaGVhZGVyc1siQ29udGVudC1U
eXBlIl0sCiAgICAgICAgICAgICAgICAgICAgICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVy
bGVuY29kZWQiKQogICAgICAgICAgKSB7CiAgICAgICAgJHBvc3RfZGF0YSA9IE9BdXRoVXRp
bDo6cGFyc2VfcGFyYW1ldGVycygKICAgICAgICAgIGZpbGVfZ2V0X2NvbnRlbnRzKHNlbGY6
OiRQT1NUX0lOUFVUKQogICAgICAgICk7CiAgICAgICAgJHBhcmFtZXRlcnMgPSBhcnJheV9t
ZXJnZSgkcGFyYW1ldGVycywgJHBvc3RfZGF0YSk7CiAgICAgIH0KCiAgICAgIC8vIFdlIGhh
dmUgYSBBdXRob3JpemF0aW9uLWhlYWRlciB3aXRoIE9BdXRoIGRhdGEuIFBhcnNlIHRoZSBo
ZWFkZXIKICAgICAgLy8gYW5kIGFkZCB0aG9zZSBvdmVycmlkaW5nIGFueSBkdXBsaWNhdGVz
IGZyb20gR0VUIG9yIFBPU1QKICAgICAgaWYgKEBzdWJzdHIoJHJlcXVlc3RfaGVhZGVyc1sn
QXV0aG9yaXphdGlvbiddLCAwLCA2KSA9PSAiT0F1dGggIikgewogICAgICAgICRoZWFkZXJf
cGFyYW1ldGVycyA9IE9BdXRoVXRpbDo6c3BsaXRfaGVhZGVyKAogICAgICAgICAgJHJlcXVl
c3RfaGVhZGVyc1snQXV0aG9yaXphdGlvbiddCiAgICAgICAgKTsKICAgICAgICAkcGFyYW1l
dGVycyA9IGFycmF5X21lcmdlKCRwYXJhbWV0ZXJzLCAkaGVhZGVyX3BhcmFtZXRlcnMpOwog
ICAgICB9CgogICAgfQoKICAgIHJldHVybiBuZXcgT0F1dGhSZXF1ZXN0KCRodHRwX21ldGhv
ZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVycyk7CiAgfQoKICAvKioKICAgKiBwcmV0dHkgbXVj
aCBhIGhlbHBlciBmdW5jdGlvbiB0byBzZXQgdXAgdGhlIHJlcXVlc3QKICAgKi8KICBwdWJs
aWMgc3RhdGljIGZ1bmN0aW9uIGZyb21fY29uc3VtZXJfYW5kX3Rva2VuKCRjb25zdW1lciwg
JHRva2VuLCAkaHR0cF9tZXRob2QsICRodHRwX3VybCwgJHBhcmFtZXRlcnM9TlVMTCkgewog
ICAgQCRwYXJhbWV0ZXJzIG9yICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgICRkZWZhdWx0
cyA9IGFycmF5KCJvYXV0aF92ZXJzaW9uIiA9PiBPQXV0aFJlcXVlc3Q6OiR2ZXJzaW9uLAog
ICAgICAgICAgICAgICAgICAgICAgIm9hdXRoX25vbmNlIiA9PiBPQXV0aFJlcXVlc3Q6Omdl
bmVyYXRlX25vbmNlKCksCiAgICAgICAgICAgICAgICAgICAgICAib2F1dGhfdGltZXN0YW1w
IiA9PiBPQXV0aFJlcXVlc3Q6OmdlbmVyYXRlX3RpbWVzdGFtcCgpLAogICAgICAgICAgICAg
ICAgICAgICAgIm9hdXRoX2NvbnN1bWVyX2tleSIgPT4gJGNvbnN1bWVyLT5rZXkpOwogICAg
aWYgKCR0b2tlbikKICAgICAgJGRlZmF1bHRzWydvYXV0aF90b2tlbiddID0gJHRva2VuLT5r
ZXk7CgogICAgJHBhcmFtZXRlcnMgPSBhcnJheV9tZXJnZSgkZGVmYXVsdHMsICRwYXJhbWV0
ZXJzKTsKCiAgICByZXR1cm4gbmV3IE9BdXRoUmVxdWVzdCgkaHR0cF9tZXRob2QsICRodHRw
X3VybCwgJHBhcmFtZXRlcnMpOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIHNldF9wYXJhbWV0
ZXIoJG5hbWUsICR2YWx1ZSwgJGFsbG93X2R1cGxpY2F0ZXMgPSB0cnVlKSB7CiAgICBpZiAo
JGFsbG93X2R1cGxpY2F0ZXMgJiYgaXNzZXQoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdKSkg
ewogICAgICAvLyBXZSBoYXZlIGFscmVhZHkgYWRkZWQgcGFyYW1ldGVyKHMpIHdpdGggdGhp
cyBuYW1lLCBzbyBhZGQgdG8gdGhlIGxpc3QKICAgICAgaWYgKGlzX3NjYWxhcigkdGhpcy0+
cGFyYW1ldGVyc1skbmFtZV0pKSB7CiAgICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3QgZHVw
bGljYXRlLCBzbyB0cmFuc2Zvcm0gc2NhbGFyIChzdHJpbmcpCiAgICAgICAgLy8gaW50byBh
biBhcnJheSBzbyB3ZSBjYW4gYWRkIHRoZSBkdXBsaWNhdGVzCiAgICAgICAgJHRoaXMtPnBh
cmFtZXRlcnNbJG5hbWVdID0gYXJyYXkoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdKTsKICAg
ICAgfQoKICAgICAgJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdW10gPSAkdmFsdWU7CiAgICB9
IGVsc2UgewogICAgICAkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0gPSAkdmFsdWU7CiAgICB9
CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gZ2V0X3BhcmFtZXRlcigkbmFtZSkgewogICAgcmV0
dXJuIGlzc2V0KCR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSkgPyAkdGhpcy0+cGFyYW1ldGVy
c1skbmFtZV0gOiBudWxsOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGdldF9wYXJhbWV0ZXJz
KCkgewogICAgcmV0dXJuICR0aGlzLT5wYXJhbWV0ZXJzOwogIH0KCiAgcHVibGljIGZ1bmN0
aW9uIHVuc2V0X3BhcmFtZXRlcigkbmFtZSkgewogICAgdW5zZXQoJHRoaXMtPnBhcmFtZXRl
cnNbJG5hbWVdKTsKICB9CgogIC8qKgogICAqIFRoZSByZXF1ZXN0IHBhcmFtZXRlcnMsIHNv
cnRlZCBhbmQgY29uY2F0ZW5hdGVkIGludG8gYSBub3JtYWxpemVkIHN0cmluZy4KICAgKiBA
cmV0dXJuIHN0cmluZwogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBnZXRfc2lnbmFibGVfcGFy
YW1ldGVycygpIHsKICAgIC8vIEdyYWIgYWxsIHBhcmFtZXRlcnMKICAgICRwYXJhbXMgPSAk
dGhpcy0+cGFyYW1ldGVyczsKCiAgICAvLyBSZW1vdmUgb2F1dGhfc2lnbmF0dXJlIGlmIHBy
ZXNlbnQKICAgIC8vIFJlZjogU3BlYzogOS4xLjEgKCJUaGUgb2F1dGhfc2lnbmF0dXJlIHBh
cmFtZXRlciBNVVNUIGJlIGV4Y2x1ZGVkLiIpCiAgICBpZiAoaXNzZXQoJHBhcmFtc1snb2F1
dGhfc2lnbmF0dXJlJ10pKSB7CiAgICAgIHVuc2V0KCRwYXJhbXNbJ29hdXRoX3NpZ25hdHVy
ZSddKTsKICAgIH0KCiAgICByZXR1cm4gT0F1dGhVdGlsOjpidWlsZF9odHRwX3F1ZXJ5KCRw
YXJhbXMpOwogIH0KCiAgLyoqCiAgICogUmV0dXJucyB0aGUgYmFzZSBzdHJpbmcgb2YgdGhp
cyByZXF1ZXN0CiAgICoKICAgKiBUaGUgYmFzZSBzdHJpbmcgZGVmaW5lZCBhcyB0aGUgbWV0
aG9kLCB0aGUgdXJsCiAgICogYW5kIHRoZSBwYXJhbWV0ZXJzIChub3JtYWxpemVkKSwgZWFj
aCB1cmxlbmNvZGVkCiAgICogYW5kIHRoZSBjb25jYXRlZCB3aXRoICYuCiAgICovCiAgcHVi
bGljIGZ1bmN0aW9uIGdldF9zaWduYXR1cmVfYmFzZV9zdHJpbmcoKSB7CiAgICAkcGFydHMg
PSBhcnJheSgKICAgICAgJHRoaXMtPmdldF9ub3JtYWxpemVkX2h0dHBfbWV0aG9kKCksCiAg
ICAgICR0aGlzLT5nZXRfbm9ybWFsaXplZF9odHRwX3VybCgpLAogICAgICAkdGhpcy0+Z2V0
X3NpZ25hYmxlX3BhcmFtZXRlcnMoKQogICAgKTsKCiAgICAkcGFydHMgPSBPQXV0aFV0aWw6
OnVybGVuY29kZV9yZmMzOTg2KCRwYXJ0cyk7CgogICAgcmV0dXJuIGltcGxvZGUoJyYnLCAk
cGFydHMpOwogIH0KCiAgLyoqCiAgICoganVzdCB1cHBlcmNhc2VzIHRoZSBodHRwIG1ldGhv
ZAogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBnZXRfbm9ybWFsaXplZF9odHRwX21ldGhvZCgp
IHsKICAgIHJldHVybiBzdHJ0b3VwcGVyKCR0aGlzLT5odHRwX21ldGhvZCk7CiAgfQoKICAv
KioKICAgKiBwYXJzZXMgdGhlIHVybCBhbmQgcmVidWlsZHMgaXQgdG8gYmUKICAgKiBzY2hl
bWU6Ly9ob3N0L3BhdGgKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZ2V0X25vcm1hbGl6ZWRf
aHR0cF91cmwoKSB7CiAgICAkcGFydHMgPSBwYXJzZV91cmwoJHRoaXMtPmh0dHBfdXJsKTsK
CiAgICAkcG9ydCA9IEAkcGFydHNbJ3BvcnQnXTsKICAgICRzY2hlbWUgPSAkcGFydHNbJ3Nj
aGVtZSddOwogICAgJGhvc3QgPSAkcGFydHNbJ2hvc3QnXTsKICAgICRwYXRoID0gQCRwYXJ0
c1sncGF0aCddOwoKICAgICRwb3J0IG9yICRwb3J0ID0gKCRzY2hlbWUgPT0gJ2h0dHBzJykg
PyAnNDQzJyA6ICc4MCc7CgogICAgaWYgKCgkc2NoZW1lID09ICdodHRwcycgJiYgJHBvcnQg
IT0gJzQ0MycpCiAgICAgICAgfHwgKCRzY2hlbWUgPT0gJ2h0dHAnICYmICRwb3J0ICE9ICc4
MCcpKSB7CiAgICAgICRob3N0ID0gIiRob3N0OiRwb3J0IjsKICAgIH0KICAgIHJldHVybiAi
JHNjaGVtZTovLyRob3N0JHBhdGgiOwogIH0KCiAgLyoqCiAgICogYnVpbGRzIGEgdXJsIHVz
YWJsZSBmb3IgYSBHRVQgcmVxdWVzdAogICAqLwogIHB1YmxpYyBmdW5jdGlvbiB0b191cmwo
KSB7CiAgICAkcG9zdF9kYXRhID0gJHRoaXMtPnRvX3Bvc3RkYXRhKCk7CiAgICAkb3V0ID0g
JHRoaXMtPmdldF9ub3JtYWxpemVkX2h0dHBfdXJsKCk7CiAgICBpZiAoJHBvc3RfZGF0YSkg
ewogICAgICAkb3V0IC49ICc/Jy4kcG9zdF9kYXRhOwogICAgfQogICAgcmV0dXJuICRvdXQ7
CiAgfQoKICAvKioKICAgKiBidWlsZHMgdGhlIGRhdGEgb25lIHdvdWxkIHNlbmQgaW4gYSBQ
T1NUIHJlcXVlc3QKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gdG9fcG9zdGRhdGEoKSB7CiAg
ICByZXR1cm4gT0F1dGhVdGlsOjpidWlsZF9odHRwX3F1ZXJ5KCR0aGlzLT5wYXJhbWV0ZXJz
KTsKICB9CgogIC8qKgogICAqIGJ1aWxkcyB0aGUgQXV0aG9yaXphdGlvbjogaGVhZGVyCiAg
ICovCiAgcHVibGljIGZ1bmN0aW9uIHRvX2hlYWRlcigkcmVhbG09bnVsbCkgewogICAgJGZp
cnN0ID0gdHJ1ZTsKICBpZigkcmVhbG0pIHsKICAgICAgJG91dCA9ICdBdXRob3JpemF0aW9u
OiBPQXV0aCByZWFsbT0iJyAuIE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJHJlYWxt
KSAuICciJzsKICAgICAgJGZpcnN0ID0gZmFsc2U7CiAgICB9IGVsc2UKICAgICAgJG91dCA9
ICdBdXRob3JpemF0aW9uOiBPQXV0aCc7CgogICAgJHRvdGFsID0gYXJyYXkoKTsKICAgIGZv
cmVhY2ggKCR0aGlzLT5wYXJhbWV0ZXJzIGFzICRrID0+ICR2KSB7CiAgICAgIGlmIChzdWJz
dHIoJGssIDAsIDUpICE9ICJvYXV0aCIpIGNvbnRpbnVlOwogICAgICBpZiAoaXNfYXJyYXko
JHYpKSB7CiAgICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCdBcnJheXMgbm90IHN1
cHBvcnRlZCBpbiBoZWFkZXJzJyk7CiAgICAgIH0KICAgICAgJG91dCAuPSAoJGZpcnN0KSA/
ICcgJyA6ICcsJzsKICAgICAgJG91dCAuPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2
KCRrKSAuCiAgICAgICAgICAgICAgJz0iJyAuCiAgICAgICAgICAgICAgT0F1dGhVdGlsOjp1
cmxlbmNvZGVfcmZjMzk4NigkdikgLgogICAgICAgICAgICAgICciJzsKICAgICAgJGZpcnN0
ID0gZmFsc2U7CiAgICB9CiAgICByZXR1cm4gJG91dDsKICB9CgogIHB1YmxpYyBmdW5jdGlv
biBfX3RvU3RyaW5nKCkgewogICAgcmV0dXJuICR0aGlzLT50b191cmwoKTsKICB9CgoKICBw
dWJsaWMgZnVuY3Rpb24gc2lnbl9yZXF1ZXN0KCRzaWduYXR1cmVfbWV0aG9kLCAkY29uc3Vt
ZXIsICR0b2tlbikgewogICAgJHRoaXMtPnNldF9wYXJhbWV0ZXIoCiAgICAgICJvYXV0aF9z
aWduYXR1cmVfbWV0aG9kIiwKICAgICAgJHNpZ25hdHVyZV9tZXRob2QtPmdldF9uYW1lKCks
CiAgICAgIGZhbHNlCiAgICApOwogICAgJHNpZ25hdHVyZSA9ICR0aGlzLT5idWlsZF9zaWdu
YXR1cmUoJHNpZ25hdHVyZV9tZXRob2QsICRjb25zdW1lciwgJHRva2VuKTsKICAgICR0aGlz
LT5zZXRfcGFyYW1ldGVyKCJvYXV0aF9zaWduYXR1cmUiLCAkc2lnbmF0dXJlLCBmYWxzZSk7
CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2lnbmF0dXJlKCRzaWduYXR1cmVfbWV0
aG9kLCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJHNpZ25hdHVyZSA9ICRzaWduYXR1cmVf
bWV0aG9kLT5idWlsZF9zaWduYXR1cmUoJHRoaXMsICRjb25zdW1lciwgJHRva2VuKTsKICAg
IHJldHVybiAkc2lnbmF0dXJlOwogIH0KCiAgLyoqCiAgICogdXRpbCBmdW5jdGlvbjogY3Vy
cmVudCB0aW1lc3RhbXAKICAgKi8KICBwcml2YXRlIHN0YXRpYyBmdW5jdGlvbiBnZW5lcmF0
ZV90aW1lc3RhbXAoKSB7CiAgICByZXR1cm4gdGltZSgpOwogIH0KCiAgLyoqCiAgICogdXRp
bCBmdW5jdGlvbjogY3VycmVudCBub25jZQogICAqLwogIHByaXZhdGUgc3RhdGljIGZ1bmN0
aW9uIGdlbmVyYXRlX25vbmNlKCkgewogICAgJG10ID0gbWljcm90aW1lKCk7CiAgICAkcmFu
ZCA9IG10X3JhbmQoKTsKCiAgICByZXR1cm4gbWQ1KCRtdCAuICRyYW5kKTsgLy8gbWQ1cyBs
b29rIG5pY2VyIHRoYW4gbnVtYmVycwogIH0KfQoKY2xhc3MgT0F1dGhTZXJ2ZXIgewogIHBy
b3RlY3RlZCAkdGltZXN0YW1wX3RocmVzaG9sZCA9IDMwMDsgLy8gaW4gc2Vjb25kcywgZml2
ZSBtaW51dGVzCiAgcHJvdGVjdGVkICR2ZXJzaW9uID0gJzEuMCc7ICAgICAgICAgICAgIC8v
IGhpIGJsYWluZQogIHByb3RlY3RlZCAkc2lnbmF0dXJlX21ldGhvZHMgPSBhcnJheSgpOwoK
ICBwcm90ZWN0ZWQgJGRhdGFfc3RvcmU7CgogIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRkYXRh
X3N0b3JlKSB7CiAgICAkdGhpcy0+ZGF0YV9zdG9yZSA9ICRkYXRhX3N0b3JlOwogIH0KCiAg
cHVibGljIGZ1bmN0aW9uIGFkZF9zaWduYXR1cmVfbWV0aG9kKCRzaWduYXR1cmVfbWV0aG9k
KSB7CiAgICAkdGhpcy0+c2lnbmF0dXJlX21ldGhvZHNbJHNpZ25hdHVyZV9tZXRob2QtPmdl
dF9uYW1lKCldID0KICAgICAgJHNpZ25hdHVyZV9tZXRob2Q7CiAgfQoKICAvLyBoaWdoIGxl
dmVsIGZ1bmN0aW9ucwoKICAvKioKICAgKiBwcm9jZXNzIGEgcmVxdWVzdF90b2tlbiByZXF1
ZXN0CiAgICogcmV0dXJucyB0aGUgcmVxdWVzdCB0b2tlbiBvbiBzdWNjZXNzCiAgICovCiAg
cHVibGljIGZ1bmN0aW9uIGZldGNoX3JlcXVlc3RfdG9rZW4oJiRyZXF1ZXN0KSB7CiAgICAk
dGhpcy0+Z2V0X3ZlcnNpb24oJHJlcXVlc3QpOwoKICAgICRjb25zdW1lciA9ICR0aGlzLT5n
ZXRfY29uc3VtZXIoJHJlcXVlc3QpOwoKICAgIC8vIG5vIHRva2VuIHJlcXVpcmVkIGZvciB0
aGUgaW5pdGlhbCB0b2tlbiByZXF1ZXN0CiAgICAkdG9rZW4gPSBOVUxMOwoKICAgICR0aGlz
LT5jaGVja19zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKTsKCiAgICAv
LyBSZXYgQSBjaGFuZ2UKICAgICRjYWxsYmFjayA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVy
KCdvYXV0aF9jYWxsYmFjaycpOwogICAgJG5ld190b2tlbiA9ICR0aGlzLT5kYXRhX3N0b3Jl
LT5uZXdfcmVxdWVzdF90b2tlbigkY29uc3VtZXIsICRjYWxsYmFjayk7CgogICAgcmV0dXJu
ICRuZXdfdG9rZW47CiAgfQoKICAvKioKICAgKiBwcm9jZXNzIGFuIGFjY2Vzc190b2tlbiBy
ZXF1ZXN0CiAgICogcmV0dXJucyB0aGUgYWNjZXNzIHRva2VuIG9uIHN1Y2Nlc3MKICAgKi8K
ICBwdWJsaWMgZnVuY3Rpb24gZmV0Y2hfYWNjZXNzX3Rva2VuKCYkcmVxdWVzdCkgewogICAg
JHRoaXMtPmdldF92ZXJzaW9uKCRyZXF1ZXN0KTsKCiAgICAkY29uc3VtZXIgPSAkdGhpcy0+
Z2V0X2NvbnN1bWVyKCRyZXF1ZXN0KTsKCiAgICAvLyByZXF1aXJlcyBhdXRob3JpemVkIHJl
cXVlc3QgdG9rZW4KICAgICR0b2tlbiA9ICR0aGlzLT5nZXRfdG9rZW4oJHJlcXVlc3QsICRj
b25zdW1lciwgInJlcXVlc3QiKTsKCiAgICAkdGhpcy0+Y2hlY2tfc2lnbmF0dXJlKCRyZXF1
ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7CgogICAgLy8gUmV2IEEgY2hhbmdlCiAgICAkdmVy
aWZpZXIgPSAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfdmVyaWZpZXInKTsKICAg
ICRuZXdfdG9rZW4gPSAkdGhpcy0+ZGF0YV9zdG9yZS0+bmV3X2FjY2Vzc190b2tlbigkdG9r
ZW4sICRjb25zdW1lciwgJHZlcmlmaWVyKTsKCiAgICByZXR1cm4gJG5ld190b2tlbjsKICB9
CgogIC8qKgogICAqIHZlcmlmeSBhbiBhcGkgY2FsbCwgY2hlY2tzIGFsbCB0aGUgcGFyYW1l
dGVycwogICAqLwogIHB1YmxpYyBmdW5jdGlvbiB2ZXJpZnlfcmVxdWVzdCgmJHJlcXVlc3Qp
IHsKICAgICR0aGlzLT5nZXRfdmVyc2lvbigkcmVxdWVzdCk7CiAgICAkY29uc3VtZXIgPSAk
dGhpcy0+Z2V0X2NvbnN1bWVyKCRyZXF1ZXN0KTsKICAgICR0b2tlbiA9ICR0aGlzLT5nZXRf
dG9rZW4oJHJlcXVlc3QsICRjb25zdW1lciwgImFjY2VzcyIpOwogICAgJHRoaXMtPmNoZWNr
X3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAgcmV0dXJuIGFy
cmF5KCRjb25zdW1lciwgJHRva2VuKTsKICB9CgogIC8vIEludGVybmFscyBmcm9tIGhlcmUK
ICAvKioKICAgKiB2ZXJzaW9uIDEKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGdldF92ZXJz
aW9uKCYkcmVxdWVzdCkgewogICAgJHZlcnNpb24gPSAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRl
cigib2F1dGhfdmVyc2lvbiIpOwogICAgaWYgKCEkdmVyc2lvbikgewogICAgICAvLyBTZXJ2
aWNlIFByb3ZpZGVycyBNVVNUIGFzc3VtZSB0aGUgcHJvdG9jb2wgdmVyc2lvbiB0byBiZSAx
LjAgaWYgdGhpcyBwYXJhbWV0ZXIgaXMgbm90IHByZXNlbnQuCiAgICAgIC8vIENoYXB0ZXIg
Ny4wICgiQWNjZXNzaW5nIFByb3RlY3RlZCBSZXNzb3VyY2VzIikKICAgICAgJHZlcnNpb24g
PSAnMS4wJzsKICAgIH0KICAgIGlmICgkdmVyc2lvbiAhPT0gJHRoaXMtPnZlcnNpb24pIHsK
ICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJPQXV0aCB2ZXJzaW9uICckdmVyc2lv
bicgbm90IHN1cHBvcnRlZCIpOwogICAgfQogICAgcmV0dXJuICR2ZXJzaW9uOwogIH0KCiAg
LyoqCiAgICogZmlndXJlIG91dCB0aGUgc2lnbmF0dXJlIHdpdGggc29tZSBkZWZhdWx0cwog
ICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X3NpZ25hdHVyZV9tZXRob2QoJiRyZXF1ZXN0
KSB7CiAgICAkc2lnbmF0dXJlX21ldGhvZCA9CiAgICAgICAgQCRyZXF1ZXN0LT5nZXRfcGFy
YW1ldGVyKCJvYXV0aF9zaWduYXR1cmVfbWV0aG9kIik7CgogICAgaWYgKCEkc2lnbmF0dXJl
X21ldGhvZCkgewogICAgICAvLyBBY2NvcmRpbmcgdG8gY2hhcHRlciA3ICgiQWNjZXNzaW5n
IFByb3RlY3RlZCBSZXNzb3VyY2VzIikgdGhlIHNpZ25hdHVyZS1tZXRob2QKICAgICAgLy8g
cGFyYW1ldGVyIGlzIHJlcXVpcmVkLCBhbmQgd2UgY2FuJ3QganVzdCBmYWxsYmFjayB0byBQ
TEFJTlRFWFQKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCdObyBzaWduYXR1cmUg
bWV0aG9kIHBhcmFtZXRlci4gVGhpcyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQnKTsKICAgIH0K
CiAgICBpZiAoIWluX2FycmF5KCRzaWduYXR1cmVfbWV0aG9kLAogICAgICAgICAgICAgICAg
ICBhcnJheV9rZXlzKCR0aGlzLT5zaWduYXR1cmVfbWV0aG9kcykpKSB7CiAgICAgIHRocm93
IG5ldyBPQXV0aEV4Y2VwdGlvbigKICAgICAgICAiU2lnbmF0dXJlIG1ldGhvZCAnJHNpZ25h
dHVyZV9tZXRob2QnIG5vdCBzdXBwb3J0ZWQgIiAuCiAgICAgICAgInRyeSBvbmUgb2YgdGhl
IGZvbGxvd2luZzogIiAuCiAgICAgICAgaW1wbG9kZSgiLCAiLCBhcnJheV9rZXlzKCR0aGlz
LT5zaWduYXR1cmVfbWV0aG9kcykpCiAgICAgICk7CiAgICB9CiAgICByZXR1cm4gJHRoaXMt
PnNpZ25hdHVyZV9tZXRob2RzWyRzaWduYXR1cmVfbWV0aG9kXTsKICB9CgogIC8qKgogICAq
IHRyeSB0byBmaW5kIHRoZSBjb25zdW1lciBmb3IgdGhlIHByb3ZpZGVkIHJlcXVlc3QncyBj
b25zdW1lciBrZXkKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGdldF9jb25zdW1lcigmJHJl
cXVlc3QpIHsKICAgICRjb25zdW1lcl9rZXkgPSBAJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIo
Im9hdXRoX2NvbnN1bWVyX2tleSIpOwogICAgaWYgKCEkY29uc3VtZXJfa2V5KSB7CiAgICAg
IHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiSW52YWxpZCBjb25zdW1lciBrZXkiKTsKICAg
IH0KCiAgICAkY29uc3VtZXIgPSAkdGhpcy0+ZGF0YV9zdG9yZS0+bG9va3VwX2NvbnN1bWVy
KCRjb25zdW1lcl9rZXkpOwogICAgaWYgKCEkY29uc3VtZXIpIHsKICAgICAgdGhyb3cgbmV3
IE9BdXRoRXhjZXB0aW9uKCJJbnZhbGlkIGNvbnN1bWVyIik7CiAgICB9CgogICAgcmV0dXJu
ICRjb25zdW1lcjsKICB9CgogIC8qKgogICAqIHRyeSB0byBmaW5kIHRoZSB0b2tlbiBmb3Ig
dGhlIHByb3ZpZGVkIHJlcXVlc3QncyB0b2tlbiBrZXkKICAgKi8KICBwcml2YXRlIGZ1bmN0
aW9uIGdldF90b2tlbigmJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuX3R5cGU9ImFjY2Vz
cyIpIHsKICAgICR0b2tlbl9maWVsZCA9IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1
dGhfdG9rZW4nKTsKICAgICR0b2tlbiA9ICR0aGlzLT5kYXRhX3N0b3JlLT5sb29rdXBfdG9r
ZW4oCiAgICAgICRjb25zdW1lciwgJHRva2VuX3R5cGUsICR0b2tlbl9maWVsZAogICAgKTsK
ICAgIGlmICghJHRva2VuKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiSW52
YWxpZCAkdG9rZW5fdHlwZSB0b2tlbjogJHRva2VuX2ZpZWxkIik7CiAgICB9CiAgICByZXR1
cm4gJHRva2VuOwogIH0KCiAgLyoqCiAgICogYWxsLWluLW9uZSBmdW5jdGlvbiB0byBjaGVj
ayB0aGUgc2lnbmF0dXJlIG9uIGEgcmVxdWVzdAogICAqIHNob3VsZCBndWVzcyB0aGUgc2ln
bmF0dXJlIG1ldGhvZCBhcHByb3ByaWF0ZWx5CiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBj
aGVja19zaWduYXR1cmUoJiRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbikgewogICAgLy8g
dGhpcyBzaG91bGQgcHJvYmFibHkgYmUgaW4gYSBkaWZmZXJlbnQgbWV0aG9kCiAgICAkdGlt
ZXN0YW1wID0gQCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF90aW1lc3RhbXAnKTsK
ICAgICRub25jZSA9IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfbm9uY2UnKTsK
CiAgICAkdGhpcy0+Y2hlY2tfdGltZXN0YW1wKCR0aW1lc3RhbXApOwogICAgJHRoaXMtPmNo
ZWNrX25vbmNlKCRjb25zdW1lciwgJHRva2VuLCAkbm9uY2UsICR0aW1lc3RhbXApOwoKICAg
ICRzaWduYXR1cmVfbWV0aG9kID0gJHRoaXMtPmdldF9zaWduYXR1cmVfbWV0aG9kKCRyZXF1
ZXN0KTsKCiAgICAkc2lnbmF0dXJlID0gJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRo
X3NpZ25hdHVyZScpOwogICAgJHZhbGlkX3NpZyA9ICRzaWduYXR1cmVfbWV0aG9kLT5jaGVj
a19zaWduYXR1cmUoCiAgICAgICRyZXF1ZXN0LAogICAgICAkY29uc3VtZXIsCiAgICAgICR0
b2tlbiwKICAgICAgJHNpZ25hdHVyZQogICAgKTsKCiAgICBpZiAoISR2YWxpZF9zaWcpIHsK
ICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJbnZhbGlkIHNpZ25hdHVyZSIpOwog
ICAgfQogIH0KCiAgLyoqCiAgICogY2hlY2sgdGhhdCB0aGUgdGltZXN0YW1wIGlzIG5ldyBl
bm91Z2gKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGNoZWNrX3RpbWVzdGFtcCgkdGltZXN0
YW1wKSB7CiAgICBpZiggISAkdGltZXN0YW1wICkKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhj
ZXB0aW9uKAogICAgICAgICdNaXNzaW5nIHRpbWVzdGFtcCBwYXJhbWV0ZXIuIFRoZSBwYXJh
bWV0ZXIgaXMgcmVxdWlyZWQnCiAgICAgICk7CgogICAgLy8gdmVyaWZ5IHRoYXQgdGltZXN0
YW1wIGlzIHJlY2VudGlzaAogICAgJG5vdyA9IHRpbWUoKTsKICAgIGlmIChhYnMoJG5vdyAt
ICR0aW1lc3RhbXApID4gJHRoaXMtPnRpbWVzdGFtcF90aHJlc2hvbGQpIHsKICAgICAgdGhy
b3cgbmV3IE9BdXRoRXhjZXB0aW9uKAogICAgICAgICJFeHBpcmVkIHRpbWVzdGFtcCwgeW91
cnMgJHRpbWVzdGFtcCwgb3VycyAkbm93IgogICAgICApOwogICAgfQogIH0KCiAgLyoqCiAg
ICogY2hlY2sgdGhhdCB0aGUgbm9uY2UgaXMgbm90IHJlcGVhdGVkCiAgICovCiAgcHJpdmF0
ZSBmdW5jdGlvbiBjaGVja19ub25jZSgkY29uc3VtZXIsICR0b2tlbiwgJG5vbmNlLCAkdGlt
ZXN0YW1wKSB7CiAgICBpZiggISAkbm9uY2UgKQogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNl
cHRpb24oCiAgICAgICAgJ01pc3Npbmcgbm9uY2UgcGFyYW1ldGVyLiBUaGUgcGFyYW1ldGVy
IGlzIHJlcXVpcmVkJwogICAgICApOwoKICAgIC8vIHZlcmlmeSB0aGF0IHRoZSBub25jZSBp
cyB1bmlxdWVpc2gKICAgICRmb3VuZCA9ICR0aGlzLT5kYXRhX3N0b3JlLT5sb29rdXBfbm9u
Y2UoCiAgICAgICRjb25zdW1lciwKICAgICAgJHRva2VuLAogICAgICAkbm9uY2UsCiAgICAg
ICR0aW1lc3RhbXAKICAgICk7CiAgICBpZiAoJGZvdW5kKSB7CiAgICAgIHRocm93IG5ldyBP
QXV0aEV4Y2VwdGlvbigiTm9uY2UgYWxyZWFkeSB1c2VkOiAkbm9uY2UiKTsKICAgIH0KICB9
Cgp9CgpjbGFzcyBPQXV0aERhdGFTdG9yZSB7CiAgZnVuY3Rpb24gbG9va3VwX2NvbnN1bWVy
KCRjb25zdW1lcl9rZXkpIHsKICAgIC8vIGltcGxlbWVudCBtZQogIH0KCiAgZnVuY3Rpb24g
bG9va3VwX3Rva2VuKCRjb25zdW1lciwgJHRva2VuX3R5cGUsICR0b2tlbikgewogICAgLy8g
aW1wbGVtZW50IG1lCiAgfQoKICBmdW5jdGlvbiBsb29rdXBfbm9uY2UoJGNvbnN1bWVyLCAk
dG9rZW4sICRub25jZSwgJHRpbWVzdGFtcCkgewogICAgLy8gaW1wbGVtZW50IG1lCiAgfQoK
ICBmdW5jdGlvbiBuZXdfcmVxdWVzdF90b2tlbigkY29uc3VtZXIsICRjYWxsYmFjayA9IG51
bGwpIHsKICAgIC8vIHJldHVybiBhIG5ldyB0b2tlbiBhdHRhY2hlZCB0byB0aGlzIGNvbnN1
bWVyCiAgfQoKICBmdW5jdGlvbiBuZXdfYWNjZXNzX3Rva2VuKCR0b2tlbiwgJGNvbnN1bWVy
LCAkdmVyaWZpZXIgPSBudWxsKSB7CiAgICAvLyByZXR1cm4gYSBuZXcgYWNjZXNzIHRva2Vu
IGF0dGFjaGVkIHRvIHRoaXMgY29uc3VtZXIKICAgIC8vIGZvciB0aGUgdXNlciBhc3NvY2lh
dGVkIHdpdGggdGhpcyB0b2tlbiBpZiB0aGUgcmVxdWVzdCB0b2tlbgogICAgLy8gaXMgYXV0
aG9yaXplZAogICAgLy8gc2hvdWxkIGFsc28gaW52YWxpZGF0ZSB0aGUgcmVxdWVzdCB0b2tl
bgogIH0KCn0KCmNsYXNzIE9BdXRoVXRpbCB7CiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiB1
cmxlbmNvZGVfcmZjMzk4NigkaW5wdXQpIHsKICBpZiAoaXNfYXJyYXkoJGlucHV0KSkgewog
ICAgcmV0dXJuIGFycmF5X21hcChhcnJheSgnT0F1dGhVdGlsJywgJ3VybGVuY29kZV9yZmMz
OTg2JyksICRpbnB1dCk7CiAgfSBlbHNlIGlmIChpc19zY2FsYXIoJGlucHV0KSkgewogICAg
cmV0dXJuIHN0cl9yZXBsYWNlKAogICAgICAnKycsCiAgICAgICcgJywKICAgICAgc3RyX3Jl
cGxhY2UoJyU3RScsICd+JywgcmF3dXJsZW5jb2RlKCRpbnB1dCkpCiAgICApOwogIH0gZWxz
ZSB7CiAgICByZXR1cm4gJyc7CiAgfQp9CgoKICAvLyBUaGlzIGRlY29kZSBmdW5jdGlvbiBp
c24ndCB0YWtpbmcgaW50byBjb25zaWRlcmF0aW9uIHRoZSBhYm92ZQogIC8vIG1vZGlmaWNh
dGlvbnMgdG8gdGhlIGVuY29kaW5nIHByb2Nlc3MuIEhvd2V2ZXIsIHRoaXMgbWV0aG9kIGRv
ZXNuJ3QKICAvLyBzZWVtIHRvIGJlIHVzZWQgYW55d2hlcmUgc28gbGVhdmluZyBpdCBhcyBp
cy4KICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHVybGRlY29kZV9yZmMzOTg2KCRzdHJpbmcp
IHsKICAgIHJldHVybiB1cmxkZWNvZGUoJHN0cmluZyk7CiAgfQoKICAvLyBVdGlsaXR5IGZ1
bmN0aW9uIGZvciB0dXJuaW5nIHRoZSBBdXRob3JpemF0aW9uOiBoZWFkZXIgaW50bwogIC8v
IHBhcmFtZXRlcnMsIGhhcyB0byBkbyBzb21lIHVuZXNjYXBpbmcKICAvLyBDYW4gZmlsdGVy
IG91dCBhbnkgbm9uLW9hdXRoIHBhcmFtZXRlcnMgaWYgbmVlZGVkIChkZWZhdWx0IGJlaGF2
aW91cikKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHNwbGl0X2hlYWRlcigkaGVhZGVyLCAk
b25seV9hbGxvd19vYXV0aF9wYXJhbWV0ZXJzID0gdHJ1ZSkgewogICAgJHBhdHRlcm4gPSAn
LygoWy1fYS16XSopPSgiKFteIl0qKSJ8KFteLF0qKSksPykvJzsKICAgICRvZmZzZXQgPSAw
OwogICAgJHBhcmFtcyA9IGFycmF5KCk7CiAgICB3aGlsZSAocHJlZ19tYXRjaCgkcGF0dGVy
biwgJGhlYWRlciwgJG1hdGNoZXMsIFBSRUdfT0ZGU0VUX0NBUFRVUkUsICRvZmZzZXQpID4g
MCkgewogICAgICAkbWF0Y2ggPSAkbWF0Y2hlc1swXTsKICAgICAgJGhlYWRlcl9uYW1lID0g
JG1hdGNoZXNbMl1bMF07CiAgICAgICRoZWFkZXJfY29udGVudCA9IChpc3NldCgkbWF0Y2hl
c1s1XSkpID8gJG1hdGNoZXNbNV1bMF0gOiAkbWF0Y2hlc1s0XVswXTsKICAgICAgaWYgKHBy
ZWdfbWF0Y2goJy9eb2F1dGhfLycsICRoZWFkZXJfbmFtZSkgfHwgISRvbmx5X2FsbG93X29h
dXRoX3BhcmFtZXRlcnMpIHsKICAgICAgICAkcGFyYW1zWyRoZWFkZXJfbmFtZV0gPSBPQXV0
aFV0aWw6OnVybGRlY29kZV9yZmMzOTg2KCRoZWFkZXJfY29udGVudCk7CiAgICAgIH0KICAg
ICAgJG9mZnNldCA9ICRtYXRjaFsxXSArIHN0cmxlbigkbWF0Y2hbMF0pOwogICAgfQoKICAg
IGlmIChpc3NldCgkcGFyYW1zWydyZWFsbSddKSkgewogICAgICB1bnNldCgkcGFyYW1zWydy
ZWFsbSddKTsKICAgIH0KCiAgICByZXR1cm4gJHBhcmFtczsKICB9CgogIC8vIGhlbHBlciB0
byB0cnkgdG8gc29ydCBvdXQgaGVhZGVycyBmb3IgcGVvcGxlIHdobyBhcmVuJ3QgcnVubmlu
ZyBhcGFjaGUKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGdldF9oZWFkZXJzKCkgewogICAg
aWYgKGZ1bmN0aW9uX2V4aXN0cygnYXBhY2hlX3JlcXVlc3RfaGVhZGVycycpKSB7CiAgICAg
IC8vIHdlIG5lZWQgdGhpcyB0byBnZXQgdGhlIGFjdHVhbCBBdXRob3JpemF0aW9uOiBoZWFk
ZXIKICAgICAgLy8gYmVjYXVzZSBhcGFjaGUgdGVuZHMgdG8gdGVsbCB1cyBpdCBkb2Vzbid0
IGV4aXN0CiAgICAgICRoZWFkZXJzID0gYXBhY2hlX3JlcXVlc3RfaGVhZGVycygpOwoKICAg
ICAgLy8gc2FuaXRpemUgdGhlIG91dHB1dCBvZiBhcGFjaGVfcmVxdWVzdF9oZWFkZXJzIGJl
Y2F1c2UKICAgICAgLy8gd2UgYWx3YXlzIHdhbnQgdGhlIGtleXMgdG8gYmUgQ2FzZWQtTGlr
ZS1UaGlzIGFuZCBhcmgoKQogICAgICAvLyByZXR1cm5zIHRoZSBoZWFkZXJzIGluIHRoZSBz
YW1lIGNhc2UgYXMgdGhleSBhcmUgaW4gdGhlCiAgICAgIC8vIHJlcXVlc3QKICAgICAgJG91
dCA9IGFycmF5KCk7CiAgICAgIGZvcmVhY2goICRoZWFkZXJzIEFTICRrZXkgPT4gJHZhbHVl
ICkgewogICAgICAgICRrZXkgPSBzdHJfcmVwbGFjZSgKICAgICAgICAgICAgIiAiLAogICAg
ICAgICAgICAiLSIsCiAgICAgICAgICAgIHVjd29yZHMoc3RydG9sb3dlcihzdHJfcmVwbGFj
ZSgiLSIsICIgIiwgJGtleSkpKQogICAgICAgICAgKTsKICAgICAgICAkb3V0WyRrZXldID0g
JHZhbHVlOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICAvLyBvdGhlcndpc2Ugd2UgZG9u
J3QgaGF2ZSBhcGFjaGUgYW5kIGFyZSBqdXN0IGdvaW5nIHRvIGhhdmUgdG8gaG9wZQogICAg
ICAvLyB0aGF0ICRfU0VSVkVSIGFjdHVhbGx5IGNvbnRhaW5zIHdoYXQgd2UgbmVlZAogICAg
ICAkb3V0ID0gYXJyYXkoKTsKICAgICAgaWYoIGlzc2V0KCRfU0VSVkVSWydDT05URU5UX1RZ
UEUnXSkgKQogICAgICAgICRvdXRbJ0NvbnRlbnQtVHlwZSddID0gJF9TRVJWRVJbJ0NPTlRF
TlRfVFlQRSddOwogICAgICBpZiggaXNzZXQoJF9FTlZbJ0NPTlRFTlRfVFlQRSddKSApCiAg
ICAgICAgJG91dFsnQ29udGVudC1UeXBlJ10gPSAkX0VOVlsnQ09OVEVOVF9UWVBFJ107Cgog
ICAgICBmb3JlYWNoICgkX1NFUlZFUiBhcyAka2V5ID0+ICR2YWx1ZSkgewogICAgICAgIGlm
IChzdWJzdHIoJGtleSwgMCwgNSkgPT0gIkhUVFBfIikgewogICAgICAgICAgLy8gdGhpcyBp
cyBjaGFvcywgYmFzaWNhbGx5IGl0IGlzIGp1c3QgdGhlcmUgdG8gY2FwaXRhbGl6ZSB0aGUg
Zmlyc3QKICAgICAgICAgIC8vIGxldHRlciBvZiBldmVyeSB3b3JkIHRoYXQgaXMgbm90IGFu
IGluaXRpYWwgSFRUUCBhbmQgc3RyaXAgSFRUUAogICAgICAgICAgLy8gY29kZSBmcm9tIHBy
emVtZWsKICAgICAgICAgICRrZXkgPSBzdHJfcmVwbGFjZSgKICAgICAgICAgICAgIiAiLAog
ICAgICAgICAgICAiLSIsCiAgICAgICAgICAgIHVjd29yZHMoc3RydG9sb3dlcihzdHJfcmVw
bGFjZSgiXyIsICIgIiwgc3Vic3RyKCRrZXksIDUpKSkpCiAgICAgICAgICApOwogICAgICAg
ICAgJG91dFska2V5XSA9ICR2YWx1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHJl
dHVybiAkb3V0OwogIH0KCiAgLy8gVGhpcyBmdW5jdGlvbiB0YWtlcyBhIGlucHV0IGxpa2Ug
YT1iJmE9YyZkPWUgYW5kIHJldHVybnMgdGhlIHBhcnNlZAogIC8vIHBhcmFtZXRlcnMgbGlr
ZSB0aGlzCiAgLy8gYXJyYXkoJ2EnID0+IGFycmF5KCdiJywnYycpLCAnZCcgPT4gJ2UnKQog
IHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gcGFyc2VfcGFyYW1ldGVycyggJGlucHV0ICkgewog
ICAgaWYgKCFpc3NldCgkaW5wdXQpIHx8ICEkaW5wdXQpIHJldHVybiBhcnJheSgpOwoKICAg
ICRwYWlycyA9IGV4cGxvZGUoJyYnLCAkaW5wdXQpOwoKICAgICRwYXJzZWRfcGFyYW1ldGVy
cyA9IGFycmF5KCk7CiAgICBmb3JlYWNoICgkcGFpcnMgYXMgJHBhaXIpIHsKICAgICAgJHNw
bGl0ID0gZXhwbG9kZSgnPScsICRwYWlyLCAyKTsKICAgICAgJHBhcmFtZXRlciA9IE9BdXRo
VXRpbDo6dXJsZGVjb2RlX3JmYzM5ODYoJHNwbGl0WzBdKTsKICAgICAgJHZhbHVlID0gaXNz
ZXQoJHNwbGl0WzFdKSA/IE9BdXRoVXRpbDo6dXJsZGVjb2RlX3JmYzM5ODYoJHNwbGl0WzFd
KSA6ICcnOwoKICAgICAgaWYgKGlzc2V0KCRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVy
XSkpIHsKICAgICAgICAvLyBXZSBoYXZlIGFscmVhZHkgcmVjaWV2ZWQgcGFyYW1ldGVyKHMp
IHdpdGggdGhpcyBuYW1lLCBzbyBhZGQgdG8gdGhlIGxpc3QKICAgICAgICAvLyBvZiBwYXJh
bWV0ZXJzIHdpdGggdGhpcyBuYW1lCgogICAgICAgIGlmIChpc19zY2FsYXIoJHBhcnNlZF9w
YXJhbWV0ZXJzWyRwYXJhbWV0ZXJdKSkgewogICAgICAgICAgLy8gVGhpcyBpcyB0aGUgZmly
c3QgZHVwbGljYXRlLCBzbyB0cmFuc2Zvcm0gc2NhbGFyIChzdHJpbmcpIGludG8gYW4gYXJy
YXkKICAgICAgICAgIC8vIHNvIHdlIGNhbiBhZGQgdGhlIGR1cGxpY2F0ZXMKICAgICAgICAg
ICRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSA9IGFycmF5KCRwYXJzZWRfcGFyYW1l
dGVyc1skcGFyYW1ldGVyXSk7CiAgICAgICAgfQoKICAgICAgICAkcGFyc2VkX3BhcmFtZXRl
cnNbJHBhcmFtZXRlcl1bXSA9ICR2YWx1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICAkcGFy
c2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl0gPSAkdmFsdWU7CiAgICAgIH0KICAgIH0KICAg
IHJldHVybiAkcGFyc2VkX3BhcmFtZXRlcnM7CiAgfQoKICBwdWJsaWMgc3RhdGljIGZ1bmN0
aW9uIGJ1aWxkX2h0dHBfcXVlcnkoJHBhcmFtcykgewogICAgaWYgKCEkcGFyYW1zKSByZXR1
cm4gJyc7CgogICAgLy8gVXJsZW5jb2RlIGJvdGgga2V5cyBhbmQgdmFsdWVzCiAgICAka2V5
cyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoYXJyYXlfa2V5cygkcGFyYW1zKSk7
CiAgICAkdmFsdWVzID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NihhcnJheV92YWx1
ZXMoJHBhcmFtcykpOwogICAgJHBhcmFtcyA9IGFycmF5X2NvbWJpbmUoJGtleXMsICR2YWx1
ZXMpOwoKICAgIC8vIFBhcmFtZXRlcnMgYXJlIHNvcnRlZCBieSBuYW1lLCB1c2luZyBsZXhp
Y29ncmFwaGljYWwgYnl0ZSB2YWx1ZSBvcmRlcmluZy4KICAgIC8vIFJlZjogU3BlYzogOS4x
LjEgKDEpCiAgICB1a3NvcnQoJHBhcmFtcywgJ3N0cmNtcCcpOwoKICAgICRwYWlycyA9IGFy
cmF5KCk7CiAgICBmb3JlYWNoICgkcGFyYW1zIGFzICRwYXJhbWV0ZXIgPT4gJHZhbHVlKSB7
CiAgICAgIGlmIChpc19hcnJheSgkdmFsdWUpKSB7CiAgICAgICAgLy8gSWYgdHdvIG9yIG1v
cmUgcGFyYW1ldGVycyBzaGFyZSB0aGUgc2FtZSBuYW1lLCB0aGV5IGFyZSBzb3J0ZWQgYnkg
dGhlaXIgdmFsdWUKICAgICAgICAvLyBSZWY6IFNwZWM6IDkuMS4xICgxKQogICAgICAgIG5h
dHNvcnQoJHZhbHVlKTsKICAgICAgICBmb3JlYWNoICgkdmFsdWUgYXMgJGR1cGxpY2F0ZV92
YWx1ZSkgewogICAgICAgICAgJHBhaXJzW10gPSAkcGFyYW1ldGVyIC4gJz0nIC4gJGR1cGxp
Y2F0ZV92YWx1ZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgJHBhaXJzW10g
PSAkcGFyYW1ldGVyIC4gJz0nIC4gJHZhbHVlOwogICAgICB9CiAgICB9CiAgICAvLyBGb3Ig
ZWFjaCBwYXJhbWV0ZXIsIHRoZSBuYW1lIGlzIHNlcGFyYXRlZCBmcm9tIHRoZSBjb3JyZXNw
b25kaW5nIHZhbHVlIGJ5IGFuICc9JyBjaGFyYWN0ZXIgKEFTQ0lJIGNvZGUgNjEpCiAgICAv
LyBFYWNoIG5hbWUtdmFsdWUgcGFpciBpcyBzZXBhcmF0ZWQgYnkgYW4gJyYnIGNoYXJhY3Rl
ciAoQVNDSUkgY29kZSAzOCkKICAgIHJldHVybiBpbXBsb2RlKCcmJywgJHBhaXJzKTsKICB9
Cn0iO3M6MzoibWQ1IjtzOjMyOiI5NDIzOWRiMDNmNjY0MmQyY2UxMDI1NGZhZmYzYTBhNiI7
fQ==
