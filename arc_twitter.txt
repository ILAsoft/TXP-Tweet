# arc_twitter v3.0-dev
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjc6
IjMuMC1kZXYiO3M6NjoiYXV0aG9yIjtzOjExOiJBbmR5IENhcnRlciI7czoxMDoiYXV0aG9y
X3VyaSI7czozMToiaHR0cDovL3JlZGhvdGNoaWxsaXByb2plY3QuY29tLyI7czoxMToiZGVz
Y3JpcHRpb24iO3M6NjA6IjxhIGhyZWY9Imh0dHA6Ly93d3cudHdpdHRlci5jb20iPlR3aXR0
ZXI8L2E+IGZvciBUZXh0cGF0dGVybiI7czo1OiJvcmRlciI7czoxOiI1IjtzOjQ6InR5cGUi
O3M6MToiMSI7czo1OiJmbGFncyI7czoxOiIzIjtzOjQ6ImhlbHAiO3M6MTY5OTE6Igk8aDEg
Y2xhc3M9InRpdGxlIj48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCAoYXJj
X3R3aXR0ZXIgZm9yIFRleHRwYXR0ZXJuKTwvaDE+CgoJPG9sPgoJCTxsaT48YSBocmVmPSIj
YXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2Fy
Y190d2l0dGVyX2luc3RhbGxhdGlvbiI+SW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxsYXRpb248
L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3RhZyI+VGhlIGFyY190d2l0
dGVyIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfc2VhcmNoX3Rh
ZyI+VGhlIGFyY190d2l0dGVyX3NlYXJjaCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0i
I2FyY190d2l0dGVyX3R3ZWV0X2J1dHRvbl90YWciPlRoZSBhcmNfdHdpdHRlcl90d2VldF9i
dXR0b24gdGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl9mb2xsb3df
YnV0dG9uX3RhZyI+VGhlIGFyY190d2l0dGVyX2ZvbGxvd19idXR0b24gdGFnPC9hPjwvbGk+
CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl90d2VldF91cmwiPlRoZSBhcmNfdHdpdHRl
cl90d2VldF91cmwgdGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl90
aW55dXJsIj5UaGUgYXJjX3R3aXR0ZXJfdGlueXVybCB0YWc8L2E+PC9saT4KCQk8bGk+PGEg
aHJlZj0iI2FyY190d2l0dGVyX2NhY2hpbmciPkNhY2hpbmc8L2E+PC9saT4KCQk8bGk+PGEg
aHJlZj0iI2FyY190d2l0dGVyX3ByZWZzIj5QcmVmZXJlbmNlczwvYT48L2xpPgoJCTxsaT48
YSBocmVmPSIjYXJjX3R3aXR0ZXJfYXJ0aWNsZSI+VHdlZXRpbmcgYXJ0aWNsZXM8L2E+PC9s
aT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX2FkbWluIj5UaGUgVHdpdHRlciB0YWI8
L2E+PC9saT4KCTwvb2w+CgoJPHA+PHNwYW4gY2xhc3M9ImNhcHMiPlRYUDwvc3Bhbj4gVHdl
ZXQgcHJvdmlkZXMgYWNjZXNzIHRvIHlvdXIgVHdpdHRlciBhY2NvdW50IHRocm91Z2ggYm90
aCB0aGUgYWRtaW4gaW50ZXJmYWNlIGFuZCB0aGUgcHVibGljIHNpZGUgb2YgeW91ciBzaXRl
LiBVcGRhdGUgVHdpdHRlciB3aGVuIHlvdSBwb3N0IGEgbmV3IGFydGljbGUgKHdpdGggYXJ0
aWNsZS1ieS1hcnRpY2xlIG9wdCBvdXQgb3B0aW9uKSwgdXBkYXRlIGFuZCB2aWV3IHlvdXIg
VHdpdHRlciBmZWVkIHRocm91Z2ggdGhlIGFkbWluIFR3aXR0ZXIgdGFiLCBhbmQgZGlzcGxh
eSBUd2l0dGVyIGZlZWRzIG9uIHlvdXIgc2l0ZS48L3A+CgoJPHA+UmVxdWlyZW1lbnRzOi08
L3A+CgoJPHVsPgoJCTxsaT5UZXh0cGF0dGVybiA0LjIrPC9saT4KCQk8bGk+PHNwYW4gY2xh
c3M9ImNhcHMiPlBIUDwvc3Bhbj4gNSBhbmQgY1VSTDwvbGk+Cgk8L3VsPgoKCTxoMiBjbGFz
cz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX2F1dGhvciI+QXV0aG9yPC9oMj4KCgk8cD48
YSBocmVmPSJodHRwOi8vcmVkaG90Y2hpbGxpcHJvamVjdC5jb20iPkFuZHkgQ2FydGVyPC9h
Pi4gRm9yIG90aGVyIFRleHRwYXR0ZXJuIHBsdWdpbnMgYnkgbWUgdmlzaXQgbXkgPGEgaHJl
Zj0iaHR0cDovL3JlZGhvdGNoaWxsaXByb2plY3QuY29tL3R4cCI+UGx1Z2lucyBwYWdlPC9h
Pi48L3A+CgoJPHA+VGhhbmtzIHRvIDxhIGhyZWY9Imh0dHA6Ly9tYW5mcmUubmV0LyI+TWlj
aGFlbCBNYW5mcmU8L2E+IGZvciBpbnNwaXJhdGlvbiBmb3IgdGhlIGFydGljbGUgdHdlZXQg
cGFydCBvZiB0aGlzIHBsdWdpbiBiYXNlZCBvbiBoaXMgPHNwYW4gY2xhc3M9InRhZyI+bWVt
X3R3aXR0ZXI8L3NwYW4+IHBsdWdpbi4gIEFkZGl0aW9uYWwgdGhhbmtzIHRvIHRoZSBncmVh
dCBUZXh0cGF0dGVybiBjb21tdW5pdHkgZm9yIGhlbHBpbmcgdG8gdGVzdCB0aGlzIHBsdWdp
biBhbmQgZm9yIHN1Z2dlc3RpbmcgbmV3IGZlYXR1cmVzLiBUaGUgT0F1dGggcGFydCBvZiB0
aGUgcGx1Z2luIGlzIHRoYW5rcyB0byA8YSBocmVmPSJodHRwOi8vdHdpdHRlci5jb20vYWJy
YWhhbSI+QWJyYWhhbSBXaWxsaWFtczwvYT4uPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIg
aWQ9ImFyY190d2l0dGVyX2luc3RhbGxhdGlvbiI+SW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxs
YXRpb248L2gyPgoKCTxwPlRvIGluc3RhbGwgZ28gdG8gdGhlICYjODIxNjtwbHVnaW5zJiM4
MjE3OyB0YWIgdW5kZXIgJiM4MjE2O2FkbWluJiM4MjE3OyBhbmQgcGFzdGUgdGhlIHBsdWdp
biBjb2RlIGludG8gdGhlICYjODIxNjtJbnN0YWxsIHBsdWdpbiYjODIxNzsgYm94LCAmIzgy
MTY7dXBsb2FkJiM4MjE3OyBhbmQgdGhlbiAmIzgyMTY7aW5zdGFsbCYjODIxNzsuIEZpbmFs
bHkgYWN0aXZhdGUgdGhlIHBsdWdpbi48L3A+CgoJPHA+QmVmb3JlIHlvdSBzdGFydCB1c2lu
ZyA8c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRlcjwvc3Bhbj4geW91IHdpbGwgbmVlZCB0
byBtYWtlIHN1cmUgdGhhdCB0aGUgY2FjaGUgZGlyZWN0b3J5IGlzIHdyaXRhYmxlLiBTZWUg
dGhlICYjODIxNjtDYWNoaW5nJiM4MjE3OyBzdWJzZWN0aW9uIGJlbG93IGZvciBmdXJ0aGVy
IGluZm9ybWF0aW9uLjwvcD4KCgk8cD48c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRlcjwv
c3Bhbj4gc2hvdWxkIG5vdyBiZSByZWFkeSBmb3IgdXNlIG9uIHRoZSBwdWJsaWMtc2lkZSBv
ZiB5b3VyIHNpdGUuPC9wPgoKCTxwPlRvIHVubG9jayB0aGUgYWRtaW4gZmVhdHVyZXMgb2Yg
dGhpcyBwbHVnaW4geW91IHdpbGwgbmVlZCB0byBhc3NvY2lhdGUgeW91ciBzaXRlIHdpdGgg
YSBUd2l0dGVyIGFjY291bnQgYnkgY29ubmVjdGluZyB0byBUd2l0dGVyIGZyb20gdGhlIHBs
dWdpbiYjODIxNztzIG9wdGlvbnMgc2NyZWVuLiBDbGljayBvbiB0aGUgbGluayB0byBjb25u
ZWN0IHRvIFR3aXR0ZXIsIHlvdSB3aWxsIGJlIGFza2VkIHRvIGxvZ2luIHRvIFR3aXR0ZXIs
IGNsaWNraW5nIHRoaXMgbGluayB3aWxsIHRlbXBvcmFyaWx5IHRha2UgeW91IHRvIHRoZSBU
d2l0dGVyIHNpdGUgd2hlcmUgeW91IHdpbGwgYmUgYXNrZWQgdG8gbG9naW4gYW5kIGFwcHJv
dmUgYWNjZXNzIGZvciA8c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCB0byBy
ZWFkIGFuZCB3cml0ZSB0byB5b3VyIFR3aXR0ZXIgYWNjb3VudC4gSWYgYWxsIGlzIHN1Y2Nl
c3NmdWwgeW91IHdpbGwgYmUgcmV0dXJuZWQgdG8gdGhlIG9wdGlvbnMgc2NyZWVuIGFuZCB5
b3VyIHVzZXIgbmFtZSB3aWxsIGFwcGVhci48L3A+CgoJPHA+QXQgYW55IHRpbWUgeW91IGNh
biBkaXNhc3NvY2lhdGUgeW91ciBUd2l0dGVyIGFjY291bnQgd2l0aCA8c3BhbiBjbGFzcz0i
Y2FwcyI+VFhQPC9zcGFuPiBUd2VldCB2aWEgeW91ciBUd2l0dGVyIGFjY291bnQgcHJlZmVy
ZW5jZXMgb24gdGhlIDxhIGhyZWY9Imh0dHA6Ly93d3cudHdpdHRlci5jb20iPlR3aXR0ZXIg
d2Vic2l0ZTwvYT4uPC9wPgoKCTxwPlRvIHVuaW5zdGFsbCA8c3BhbiBjbGFzcz0idGFnIj5h
cmNfdHdpdHRlcjwvc3Bhbj4gc2ltcGx5IGRlbGV0ZSB0aGUgcGx1Z2luIGZyb20gdGhlICYj
ODIxNjtQbHVnaW5zJiM4MjE3OyB0YWIuICBUaGlzIHdpbGwgcmVtb3ZlIHRoZSBwbHVnaW4g
Y29kZSwgZGVsZXRlIHJlbGF0ZWQgcHJlZmVyZW5jZXMgYW5kIGRyb3AgdGhlIDxzcGFuIGNs
YXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiB0YWJsZSBmcm9tIHlvdXIgVGV4dHBhdHRl
cm4gZGF0YWJhc2UuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVy
X3RhZyI+VGhlIGFyY190d2l0dGVyIHRhZzwvaDI+CgoJPGgzPlN5bnRheDwvaDM+CgoJPHA+
Jmx0O3R4cDphcmNfdHdpdHRlciB1c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDsgLyZn
dDs8L3A+CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmli
dXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJ
CQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD51c2VyPC90ZD4KCQkJ
PHRkPlR3aXR0ZXIgdXNlciBuYW1lPC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0ZXIgdXNl
cm5hbWU8L2VtPjwvdGQ+CgkJCTx0ZD51c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDs8
L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGltaXQ8L3RkPgoJCQk8dGQ+TWF4aW11bSBu
dW1iZXIgb2YgdHdlZXRzIHRvIGRpc3BsYXkgKG1heC4gMjAwKTwvdGQ+CgkJCTx0ZD4xMDwv
dGQ+CgkJCTx0ZD5saW1pdD0mcXVvdDsyNSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJ
CTx0ZD5kYXRlZm9ybWF0PC90ZD4KCQkJPHRkPkZvcm1hdCB0aGF0IHVwZGF0ZSBkYXRlcyB3
aWxsIGFwcGVhciBhczwvdGQ+CgkJCTx0ZD4gPGVtPkFyY2hpdmUgZGF0ZSBmb3JtYXQ8L2Vt
PjwvdGQ+CgkJCTx0ZD5kYXRlZm9ybWF0PSZxdW90OyViICVPZSwgJUk6JU0gJXAmcXVvdDs8
L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFiZWw8L3RkPgoJCQk8dGQ+TGFiZWwgZm9y
IHRoZSB0b3Agb2YgdGhlIGxpc3Q8L3RkPgoJCQk8dGQ+IDxlbT5ubyBsYWJlbDwvZW0+PC90
ZD4KCQkJPHRkPmxhYmVsPSZxdW90O015IFR3aXR0ZXIgdGltZWxpbmUmcXVvdDs8L3RkPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFiZWx0YWc8L3RkPgoJCQk8dGQ+SW5kZXBlbmRlbnQg
d3JhcHRhZyBmb3IgbGFiZWw8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJ
PHRkPmxhYmVsdGFnPSZxdW90O2gzJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRk
PmJyZWFrPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2Fw
cyI+SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyAod2l0aG91dCBicmFja2V0cyksIG9yIHN0cmlu
ZywgdXNlZCB0byBzZXBhcmF0ZSB0aGUgdXBkYXRlczwvdGQ+CgkJCTx0ZD5saTwvdGQ+CgkJ
CTx0ZD5icmVhaz0mcXVvdDticiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD53
cmFwdGFnPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2Fw
cyI+SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyB0byBiZSB1c2VkIGFzIHRoZSB3cmFwdGFnLCB3
aXRob3V0IGJyYWNrZXRzPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0
ZD53cmFwdGFnPSZxdW90O3VsJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNs
YXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+
Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGZvciB3cmFwdGFnPC90ZD4KCQkJ
PHRkPmFyY190d2l0dGVyPC90ZD4KCQkJPHRkPmNsYXNzPSZxdW90O3R3aXR0ZXImcXVvdDs8
L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3NfcG9zdGVkPC90ZD4KCQkJPHRkPjxz
cGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4g
Y2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gc3BhbiB0YWcgYXJvdW5kIHBvc3RlZCBkYXRl
PC90ZD4KCQkJPHRkPmFyY190d2l0dGVyLXBvc3RlZDwvdGQ+CgkJPC90cj4KCTwvdGFibGU+
CgoJPGgzPkV4YW1wbGUgdXNhZ2U8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXIgdXNl
cj0mcXVvdDtkcm1vbmtleW5pbmphJnF1b3Q7IGxpbWl0PSZxdW90OzUmcXVvdDsgd3JhcHRh
Zz0mcXVvdDt1bCZxdW90OyBicmVhaz0mcXVvdDtsaSZxdW90OyBkYXRlZm9ybWF0PSZxdW90
OyViICVPZSwgJUk6JU0gJXAmcXVvdDsgLyZndDs8L3A+CgoJPHA+UHJvZHVjZXMgYSBidWxs
ZXQgcG9pbnQgbGlzdCBvZiB0aGUgbGFzdCA1IFR3aXR0ZXIgdXBkYXRlcyBmcm9tIGRybW9u
a2V5bmluamEmIzgyMTc7cyBUd2l0dGVyIGZlZWQgd2l0aCBhIGRlZmluZWQgZGF0ZSBmb3Jt
YXQgdG8gb3ZlcnJpZGUgdGhlIGRlZmF1bHQgYXJjaGl2ZSBkYXRlIGZvcm1hdC48L3A+CgoJ
PGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfc2VhcmNoX3RhZyI+VGhlIGFy
Y190d2l0dGVyX3NlYXJjaCB0YWc8L2gyPgoKCTxoMz5TeW50YXg8L2gzPgoKCTxwPiZsdDt0
eHA6YXJjX3R3aXR0ZXJfc2VhcmNoIGhhc2h0YWdzPSZxdW90O3R4cCZxdW90OyAvJmd0Ozwv
cD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8
L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0
aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnNlYXJjaDwvdGQ+CgkJCTx0
ZD5Db21tYSBzZXBhcmF0ZWQgbGlzdCBvZiBzZWFyY2ggd29yZHM8L3RkPgoJCQk8dGQ+IDxl
bT51bnNldDwvZW0+PC90ZD4KCQkJPHRkPnNlYXJjaD0mcXVvdDt0eHAsdGV4dHBhdHRlcm4m
cXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aGFzaHRhZ3M8L3RkPgoJCQk8dGQ+
Q29tbWEgc2VwYXJhdGVkIGxpc3Qgb2YgaGFzaHRhZ3MgdG8gc2VhcmNoIGZvciAobm90IGlu
Y2x1ZGluZyB0aGUgaGFzaCk8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJ
PHRkPmhhc2h0YWdzPSZxdW90O3R4cCx0ZXh0cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4K
CQk8dHI+CgkJCTx0ZD5yZXBseTwvdGQ+CgkJCTx0ZD5Vc2VybmFtZSBvZiB0d2VldHMgaW4g
cmVwbHkgdG88L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJPHRkPnJlcGx5
PSZxdW90O3R3aXR0ZXImcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bWVudGlv
bjwvdGQ+CgkJCTx0ZD5Vc2VybmFtZSBvZiB1c2VyIG1lbnRpb25lZCBpbiB0d2VldHMgKDxp
PmkuZS48L2k+IHR3ZWV0cyBjb250YWluaW5nIEB1c2VybmFtZSk8L3RkPgoJCQk8dGQ+IDxl
bT51bnNldDwvZW0+PC90ZD4KCQkJPHRkPm1lbnRpb249JnF1b3Q7dHdpdHRlciZxdW90Ozwv
dGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5saW1pdDwvdGQ+CgkJCTx0ZD5NYXhpbXVtIG51
bWJlciBvZiB0d2VldHMgdG8gZGlzcGxheSAobWF4LiAyMDApPC90ZD4KCQkJPHRkPjEwPC90
ZD4KCQkJPHRkPmxpbWl0PSZxdW90OzI1JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJ
PHRkPmRhdGVmb3JtYXQ8L3RkPgoJCQk8dGQ+Rm9ybWF0IHRoYXQgdXBkYXRlIGRhdGVzIHdp
bGwgYXBwZWFyIGFzPC90ZD4KCQkJPHRkPiA8ZW0+QXJjaGl2ZSBkYXRlIGZvcm1hdDwvZW0+
PC90ZD4KCQkJPHRkPmRhdGVmb3JtYXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAlcCZxdW90Ozwv
dGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbDwvdGQ+CgkJCTx0ZD5MYWJlbCBmb3Ig
dGhlIHRvcCBvZiB0aGUgbGlzdDwvdGQ+CgkJCTx0ZD4gPGVtPm5vIGxhYmVsPC9lbT48L3Rk
PgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFiZWx0YWc8L3RkPgoJCQk8dGQ+SW5kZXBlbmRl
bnQgd3JhcHRhZyBmb3IgbGFiZWw8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPmJyZWFrPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJj
YXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyAod2l0aG91
dCBicmFja2V0cyksIG9yIHN0cmluZywgdXNlZCB0byBzZXBhcmF0ZSB0aGUgdXBkYXRlczwv
dGQ+CgkJCTx0ZD5saTwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD53cmFwdGFnPC90ZD4K
CQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+SFRNTDwvc3Bh
bj48L3NwYW4+IHRhZyB0byBiZSB1c2VkIGFzIHRoZSB3cmFwdGFnLCB3aXRob3V0IGJyYWNr
ZXRzPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJ
CTx0ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9
ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBmb3Igd3JhcHRhZzwv
dGQ+CgkJCTx0ZD5hcmNfdHdpdHRlcl9zZWFyY2g8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8
dGQ+Y2xhc3NfdXNlcjwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xh
c3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRv
IHNwYW4gdGFnIGFyb3VuZCB1c2VyIG5hbWU8L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXItdXNl
cjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzc19wb3N0ZWQ8L3RkPgoJCQk8dGQ+
PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFu
PiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byBzcGFuIHRhZyBhcm91bmQgcG9zdGVkIGRh
dGU8L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXItcG9zdGVkPC90ZD4KCQk8L3RyPgoJPC90YWJs
ZT4KCgk8aDM+RXhhbXBsZSB1c2FnZTwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl9z
ZWFyY2ggc2VhcmNoPSZxdW90O3BsdWdpbiZxdW90OyBoYXNodGFncz0mcXVvdDt0eHAsdGV4
dHBhdHRlcm4mcXVvdDsgbGltaXQ9JnF1b3Q7MjUmcXVvdDsgLyZndDs8L3A+CgoJPHA+UHJv
ZHVjZXMgYSBsaXN0IG9mIHR3ZWV0cyBjb250YWluaW5nIHRoZSB3b3JkICYjODIxNjtwbHVn
aW4mIzgyMTc7IGFuZCB0aGUgaGFzaHRhZ3MgJiM4MjE2OyN0eHAmIzgyMTc7IGFuZCAmIzgy
MTY7I3RleHRwYXR0ZXJuJiM4MjE3Oy4gVGhlIHRhZyB3aWxsIHJldHVybiBhIG1heGltdW0g
b2YgMjUgdHdlZXRzLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRl
cl9yZXR3ZWV0X3RhZyI+VGhlIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbiB0YWc8L2gyPgoK
CTxwPk91dHB1dHMgdGhlIFR3aXR0ZXIgdHdlZXQgYnV0dG9uIChmb3JtZXJseSAmbHQ7dHhw
OmFyY190d2l0dGVyX3JldHdlZXQgLyZndDspLjwvcD4KCgk8aDM+U3ludGF4PC9oMz4KCgk8
cD4mbHQ7dHhwOmFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbiAvJmd0OzwvcD4KCgk8aDM+VXNh
Z2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+
RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90
aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVzZXI8L3RkPgoJCQk8dGQ+VHdpdHRlciB1c2Vy
IG5hbWUgdG8gcXVvdGU8L3RkPgoJCQk8dGQ+IDxlbT5hcmNfdHdpdHRlciB1c2VybmFtZTwv
ZW0+PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZxdW90OzwvdGQ+CgkJ
PC90cj4KCQk8dHI+CgkJCTx0ZD51cmw8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMi
PjxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+PC9zcGFuPiB0byB0d2VldDwvdGQ+CgkJ
PC90cj4KCQk8dHI+CgkJCTx0ZD50ZXh0PC90ZD4KCQkJPHRkPlR3ZWV0IHRleHQ8L3RkPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+Zm9sbG93MTwvdGQ+CgkJCTx0ZD5TdWdnZXN0ZWQgVHdp
dHRlciBhY2NvdW50IHRvIGZvbGxvdywgZm9yIGV4YW1wbGUgeW91ciBvd248L3RkPgoJCQk8
dGQ+QSBUd2l0dGVyIHVzZXIgdG8gcmVjb21tZW5kPC90ZD4KCQkJPHRkPmZvbGxvdzE9JnF1
b3Q7VGV4dHBhdHRlcm4mcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Zm9sbG93
MjwvdGQ+CgkJCTx0ZD5BcyBmb2xsb3cxPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwv
dGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYW5nPC90ZD4KCQkJPHRkPkxhbmd1YWdlPC90
ZD4KCQkJPHRkPmVuPC90ZD4KCQkJPHRkPmxhbmc9JnF1b3Q7ZXMmcXVvdDs8L3RkPgoJCTwv
dHI+CgkJPHRyPgoJCQk8dGQ+Y291bnQ8L3RkPgoJCQk8dGQ+Q291bnQgYm94IHBvc2l0aW9u
LCBvcHRpb25zOiBub25lLCBob3Jpem9udGFsIG9yIHZlcnRpY2FsPC90ZD4KCQkJPHRkPmhv
cml6b250YWw8L3RkPgoJCQk8dGQ+Y291bnQ9JnF1b3Q7bm9uZSZxdW90OzwvdGQ+CgkJPC90
cj4KCQk8dHI+CgkJCTx0ZD5pbmNsdWRlX2pzPC90ZD4KCQkJPHRkPldoZXRoZXIgb3Igbm90
IHRvIGluY2x1ZGUgdGhlIHdpZGdldCBKYXZhU2NyaXB0PC90ZD4KCQkJPHRkPjE8L3RkPgoJ
CQk8dGQ+aW5jbHVkZV9qcz0mcXVvdDswJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJ
PHRkPm9wdGltaXNlX2pzPC90ZD4KCQkJPHRkPk9wdGltaXNlIHRoZSBKYXZhU2NyaXB0IGJ5
IHVzaW5nIGEgbG9jYWwgc2NyaXB0IHJhdGhlciB0aGFuIHRoYXQgaG9zdGVkIG9uIHRoZSBU
d2l0dGVyIHNpdGU8L3RkPgoJCQk8dGQ+MDwvdGQ+CgkJCTx0ZD5vcHRpbWlzZV9qcz0mcXVv
dDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRk
PjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bh
bj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gdGhlIHR3ZWV0IGJ1dHRvbjwvdGQ+CgkJ
CTx0ZD50d2l0dGVyLXNoYXJlLWJ1dHRvbjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPGgy
IGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfZm9sbG93X2J1dHRvbl90YWciPlRo
ZSBhcmNfdHdpdHRlcl9mb2xsb3dfYnV0dG9uIHRhZzwvaDI+CgoJPHA+T3V0cHV0cyB0aGUg
VHdpdHRlciBmb2xsb3cgYnV0dG9uIChhbiBhbHRlcm5hdGl2ZSB2ZXJzaW9uIGlzIGluY2x1
ZGVkIGluIGFyY190d2l0dGVyX2ludGVudHMpLjwvcD4KCgk8aDM+U3ludGF4PC9oMz4KCgk8
cD4mbHQ7dHhwOmFyY190d2l0dGVyX2ZvbGxvd19idXR0b24gLyZndDs8L3A+CgoJPGgzPlVz
YWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJPHRo
PkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBsZTwv
dGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD51c2VyPC90ZD4KCQkJPHRkPlR3aXR0ZXIgdXNl
ciBuYW1lIHRvIGZvbGxvdzwvdGQ+CgkJCTx0ZD4gPGVtPmFyY190d2l0dGVyIHVzZXJuYW1l
PC9lbT48L3RkPgoJCQk8dGQ+dXNlcj0mcXVvdDtkcm1vbmtleW5pbmphJnF1b3Q7PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhbmc8L3RkPgoJCQk8dGQ+TGFuZ3VhZ2U8L3RkPgoJ
CQk8dGQ+ZW48L3RkPgoJCQk8dGQ+bGFuZz0mcXVvdDtlcyZxdW90OzwvdGQ+CgkJPC90cj4K
CQk8dHI+CgkJCTx0ZD5jb3VudDwvdGQ+CgkJCTx0ZD5XaGV0aGVyIG9yIG5vdCB0aGUgZm9s
bG93ZXIgY291bnQgaXMgc2hvd248L3RkPgoJCQk8dGQ+MTwvdGQ+CgkJCTx0ZD5jb3VudD0m
cXVvdDswJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmluY2x1ZGVfanM8L3Rk
PgoJCQk8dGQ+V2hldGhlciBvciBub3QgdG8gaW5jbHVkZSB0aGUgd2lkZ2V0IEphdmFTY3Jp
cHQ8L3RkPgoJCQk8dGQ+MTwvdGQ+CgkJCTx0ZD5pbmNsdWRlX2pzPSZxdW90OzAmcXVvdDs8
L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+b3B0aW1pc2VfanM8L3RkPgoJCQk8dGQ+T3B0
aW1pc2UgdGhlIEphdmFTY3JpcHQgYnkgdXNpbmcgYSBsb2NhbCBzY3JpcHQgcmF0aGVyIHRo
YW4gdGhhdCBob3N0ZWQgb24gdGhlIFR3aXR0ZXIgc2l0ZTwvdGQ+CgkJCTx0ZD4wPC90ZD4K
CQkJPHRkPm9wdGltaXNlX2pzPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJ
CQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNz
PSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byB0
aGUgZm9sbG93IGJ1dHRvbjwvdGQ+CgkJCTx0ZD50d2l0dGVyLWZvbGxvdy1idXR0b248L3Rk
PgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0
dGVyX3R3ZWV0X3VybCI+YXJjX3R3aXR0ZXJfdHdlZXRfdXJsPC9oMj4KCgk8cD5SZXR1cm5z
IHRoZSA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPiBvZiB0aGUgVHdpdHRlciBzdGF0
dXMgZm9yIGFuIGFydGljbGUuPC9wPgoKCTxoMz5TeW50YXg8L2gzPgoKCTxwPiZsdDt0eHA6
YXJjX3R3aXR0ZXJfdHdlZXRfdXJsIC8mZ3Q7PC9wPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0
ZXJfdHdlZXRfdXJsJmd0O0xpbmsgdGV4dCZsdDsvdHhwOmFyY190d2l0dGVyX3R3ZWV0X3Vy
bCZndDs8L3A+CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0
cmlidXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3Ro
PgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5pZDwvdGQ+CgkJ
CTx0ZD5UZXh0cGF0dGVybiBhcnRpY2xlIElEPC90ZD4KCQkJPHRkPiA8ZW0+Y3VycmVudCBh
cnRpY2xlPC9lbT48L3RkPgoJCQk8dGQ+aWQ9JnF1b3Q7MSZxdW90OzwvdGQ+CgkJPC90cj4K
CQk8dHI+CgkJCTx0ZD50aXRsZTwvdGQ+CgkJCTx0ZD5UaXRsZSBhdHRyaWJ1dGUgb2YgdGhl
IGxpbms8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4K
CQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFz
cz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8g
dGhlIGxpbms8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJPC90
YWJsZT4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl90aW55dXJsIj5h
cmNfdHdpdHRlcl90aW55dXJsPC9oMj4KCgk8cD5SZXR1cm5zIHRoZSBzaG9ydGVuZWQgPHNw
YW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4gb2YgdGhlIGFydGljbGUgdXNlZCBmb3IgdGhl
IFR3aXR0ZXIgdXBkYXRlLjwvcD4KCgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFy
Y190d2l0dGVyX3Rpbnl1cmwgLyZndDs8L3A+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl90
aW55dXJsJmd0O0xpbmsgdGV4dCZsdDsvdHhwOmFyY190d2l0dGVyX3Rpbnl1cmwmZ3Q7PC9w
PgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwv
dGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRo
PkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aWQ8L3RkPgoJCQk8dGQ+VGV4
dHBhdHRlcm4gYXJ0aWNsZSBJRDwvdGQ+CgkJCTx0ZD4gPGVtPmN1cnJlbnQgYXJ0aWNsZTwv
ZW0+PC90ZD4KCQkJPHRkPmlkPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJ
CQk8dGQ+dGl0bGU8L3RkPgoJCQk8dGQ+VGl0bGUgYXR0cmlidXRlIG9mIHRoZSBsaW5rPC90
ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5j
bGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMi
PkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHRoZSBsaW5r
PC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJ
PGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfY2FjaGluZyI+Q2FjaGluZzwv
aDI+CgoJPHA+SW4gb3JkZXIgdG8gcHJldmVudCBleGNlc3NpdmUgcmVwZWF0aXRpdmUgY2Fs
bHMgdG8gdGhlIFR3aXR0ZXIgd2Vic2l0ZSBpdCBpcyByZWNvbW1lbmRlZCB0byBjYWNoZSBy
ZXN1bHRzLiBUd2l0dGVyIGxpbWl0cyB0aGUgbnVtYmVyIG9mIGNhbGxzIHRocm91Z2ggdGhl
IDxzcGFuIGNsYXNzPSJjYXBzIj5BUEk8L3NwYW4+LCBhbmQgY29udGludW91cyBjYWxscyB3
aWxsIHJlc3VsdCBpbiBUd2l0dGVyIGNsb3NpbmcgdG8gZnVydGhlciByZXF1ZXN0cy4gQnkg
ZGVmYXVsdCwgYXJjX3R3aXR0ZXIgY2FjaGVzIGZvciAzMCBtaW51dGUgaW50ZXJ2YWxzLjwv
cD4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJPHRoPkRlc2Ny
aXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJ
PC90cj4KCQk8dHI+CgkJCTx0ZD5jYWNoaW5nPC90ZD4KCQkJPHRkPiYjODIxNjsxJiM4MjE3
OyB0byBjYWNoZSBmZWVkLCAmIzgyMTY7MCYjODIxNzsgdG8gdHVybiBjYWNoaW5nIG9mZiAo
bm90IHJlY29tbWVuZGVkKTwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQkJPHRkPmNhY2hpbmc9JnF1
b3Q7MSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jYWNoZV9kaXI8L3RkPgoJ
CQk8dGQ+QWJzb2x1dGUgcGF0aCB0byB0aGUgY2FjaGUgZGlyZWN0b3J5IChtdXN0IGJlIHdy
aXRhYmxlKTwvdGQ+CgkJCTx0ZD4gPGVtPmFyY190d2l0dGVyIHByZWZlcmVuY2VzPC9lbT48
L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2FjaGVfdGltZTwvdGQ+CgkJCTx0ZD5UaW1l
IGluIG1pbnV0ZXMgdGhhdCB0aGUgY2FjaGUgZmlsZXMgYXJlIHN0b3JlZCBiZWZvcmUgYmVp
bmcgcmVmcmVzaGVkPC90ZD4KCQkJPHRkPjU8L3RkPgoJCQk8dGQ+Y2FjaGVfdGltZT0mcXVv
dDszMCZxdW90OzwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPHA+VGhlIGFkbWluIHNpZGUg
b2YgdGhpcyBwbHVnaW4gZW5mb3JjZXMgY2FjaGluZywgYXBhcnQgZnJvbSB3aGVuIGl0IGlz
IHBvc3RpbmcgdG8gVHdpdHRlciAoPGk+ZS5nLjwvaT4gd2hlbiBwb3N0aW5nIG9yIGRlbGV0
aW5nIGFuIHVwZGF0ZSkuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0
dGVyX3ByZWZzIj5QcmVmZXJlbmNlczwvaDI+CgoJPHA+WW91IGNhbiBhY2Nlc3MgdGhlIHBs
dWdpbnMgY29yZSBwcmVmZXJlbmNlcyBmcm9tIGVpdGhlciB0aGUgUHJlZmVyZW5jZXMgb3Ig
UGx1Z2lucyB0YWJzIGluIGFkbWluLiBTZXR1cCB5b3VyIFR3aXR0ZXIgYWNjb3VudCAoeW91
IHdpbGwgYmUgYXNrZWQgdG8gY29ubmVjdCB2aWEgVHdpdHRlciBhbmQgdGhpcyBuZWVkcyBk
b2luZyBiZWZvcmUgeW91IGNhbiB1c2UgdGhlIHBsdWdpbikgYW5kIGNoYW5nZSB0aGUgY2Fj
aGUgZGlyZWN0b3J5IHVzaW5nIGFyY190d2l0dGVyJiM4MjE3O3MgcHJlZmVyZW5jZXMuIFdp
dGhvdXQgcHJvdmlkaW5nIHlvdXIgYWNjb3VudCBsb2dpbiBkZXRhaWxzIHRoZSBhZG1pbiBh
cmVhIGZlYXR1cmVzIG9mIHRoaXMgcGx1Z2luIHdpbGwgYmUgaW5hY3RpdmUuPC9wPgoKCTxw
PllvdSBjYW4gc2VsZWN0IHRoZSA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPiBzaG9y
dGVuZXIgbWV0aG9kIHlvdSB3YW50IHRvIHVzZSB0byBsaW5rIGJhY2sgdG8geW91ciBhcnRp
Y2xlIG9uIFR3aXR0ZXIuIFBsZWFzZSBub3RlIHRoYXQgaWYgeW91IHNlbGVjdCBzbWRfc2hv
cnRfdXJsIHlvdSB3aWxsIG5lZWQgdG8gaGF2ZSBpbnN0YWxsZWQgYW5kIGFjdGl2YXRlZCB0
aGUgPGEgaHJlZj0iaHR0cDovL3RleHRwYXR0ZXJuLm9yZy9wbHVnaW5zLzEwOTkvc21kX3No
b3J0X3VybCI+PHNwYW4gY2xhc3M9InRhZyI+c21kX3Nob3J0X3VybDwvc3Bhbj4gcGx1Z2lu
PC9hPiBkZXZlbG9wZWQgYnkgU3RlZiBEYXdzb24uPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlv
biIgaWQ9ImFyY190d2l0dGVyX2FydGljbGUiPlR3ZWV0aW5nIGFydGljbGVzPC9oMj4KCgk8
cD5CeSBkZWZhdWx0IGFyY190d2l0dGVyIHdpbGwgcG9zdCBhbiB1cGRhdGUgdG8gVHdpdHRl
ciBpbmNsdWRpbmcgYSBzaG9ydGVuZWQgPHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4g
dG8geW91ciBhcnRpY2xlLiBPbmx5IGxpdmUgYW5kIGFjdGl2ZSBhcnRpY2xlcyB3aWxsIGJl
IHNlbnQgdG8gVHdpdHRlciwgPGk+aS5lLjwvaT4gYXJ0aWNsZXMgcG9zdGVkIGluIHRoZSBm
dXR1cmUgb3IgYXMgc3RpY2t5IGFydGljbGVzIHdpbGwgbm90IGJlIHNlbnQuIElmIHlvdXIg
YXJ0aWNsZSBpcyBzdWNjZXNzZnVsbHkgc3VibWl0dGVkIHRvIFR3aXR0ZXIgdGhlIHVwZGF0
ZSB3aWxsIGFwcGVhciBpbiBwbGFjZSBvZiB0aGUgVHdpdHRlciBvcHRpb24gb24gdGhlIHJp
Z2h0LWhhbmQtc2lkZSBvZiB0aGUgYXJ0aWNsZSBlZGl0IHNjcmVlbi48L3A+CgoJPHA+VHdl
ZXRzIGFyZSBzZW50IGluIHRoZSBmb2xsb3dpbmcgZm9ybWF0OiA8ZW0+VHdlZXQgcHJlZml4
PC9lbT4gPGVtPkFydGljbGUgdGl0bGU8L2VtPiA8ZW0+U2hvcnRlbmVkIDxzcGFuIGNsYXNz
PSJjYXBzIj5VUkw8L3NwYW4+PC9lbT4gPGVtPlR3ZWV0IHN1ZmZpeDwvZW0+LiBZb3UgY2Fu
IGNoYW5nZSB0aGUgcHJlZml4IGFuZCBzdWZmaXggb24gYW4gYXJ0aWNsZS1ieS1hcnRpY2xl
IGJhc2lzIGJ5IGNoYW5naW5nIHRoZSB0d2VldCBvcHRpb25zIHVuZGVyICYjODIxNjtVcGRh
dGUgVHdpdHRlciYjODIxNzsgb24gdGhlIGFydGljbGUgZWRpdG9yIHNjcmVlbi4gVGhlIGRl
ZmF1bHQgPGVtPlR3ZWV0IHByZWZpeDwvZW0+IGNhbiBiZSBzZXQgdW5kZXIgdGhlIDxzcGFu
IGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiBwcmVmZXJlbmNlcyBzY3JlZW4gKHRo
ZSBkZWZhdWx0IG9uIGluc3RhbGxhdGlvbiBpcyAmIzgyMjA7SnVzdCBwb3N0ZWQ6JiM4MjIx
OykuPC9wPgoKCTxwPlBsZWFzZSBub3RlIHRoYXQgb25jZSBhbiBhcnRpY2xlIGhhcyBiZWVu
IHR3ZWV0ZWQgdGhlIHR3ZWV0IGNhbm5vdCBiZSBlZGl0ZWQuPC9wPgoKCTxoMiBjbGFzcz0i
c2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX2FkbWluIj5UaGUgVHdpdHRlciB0YWI8L2gyPgoK
CTxwPlVuZGVyIHRoZSBFeHRlbnNpb25zIHRhYiAodGhpcyBjYW4gYmUgY2hhbmdlZCBmcm9t
IHRoZSBwbHVnaW4mIzgyMTc7cyBwcmVmZXJlbmNlIHBhZ2UpIGEgbmV3IFR3aXR0ZXIgdGFi
IHNob3VsZCBhcHBlYXIgb25jZSB5b3UgaGF2ZSBjb25uZWN0ZWQgeW91ciBzaXRlIHRvIHlv
dXIgVHdpdHRlciBhY2NvdW50LiBGcm9tIGhlcmUgeW91IHdpbGwgYmUgYWJsZSB0byBzdWJt
aXQgbmV3IFR3aXR0ZXIgdXBkYXRlcywgdmlldyBiYXNpYyBhY2NvdW50IHN0YXRpc3RpY3Ms
IGFuZCBjaGVjayBvdXQgeW91ciByZWNlbnQgdXBkYXRlcyAoaW5jbHVkaW5nIHRoZSBvcHRp
b24gdG8gZGVsZXRlIHlvdXIgdHdlZXRzKS48L3A+IjtzOjQ6ImNvZGUiO3M6NzQ4ODE6Imds
b2JhbCAkcHJlZnMsJHR4cGNmZywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksJGFyY190d2l0
dGVyX2NvbnN1bWVyU2VjcmV0OwoKJGFyY190d2l0dGVyID0gYXJyYXkoKTsKCiRhcmNfdHdp
dHRlcl9jb25zdW1lcktleSA9ICduS2NYc2x3elpoQmQwa2ZLTWV0blBBJzsKJGFyY190d2l0
dGVyX2NvbnN1bWVyU2VjcmV0ID0gJ0M2blNQQ0wzZWVIR1RCaEtDZ3dkOW9jbGN1RDBzckI4
V1ZrZlhRWUM1NCc7CgphZGRfcHJpdnMoJ3BsdWdpbl9wcmVmcy5hcmNfdHdpdHRlcicsJzEs
MicpOwpyZWdpc3Rlcl9jYWxsYmFjaygnYXJjX3R3aXR0ZXJfaW5zdGFsbCcsJ3BsdWdpbl9s
aWZlY3ljbGUuYXJjX3R3aXR0ZXInLCAnaW5zdGFsbGVkJyk7CnJlZ2lzdGVyX2NhbGxiYWNr
KCdhcmNfdHdpdHRlcl91bmluc3RhbGwnLCdwbHVnaW5fbGlmZWN5Y2xlLmFyY190d2l0dGVy
JywgJ2RlbGV0ZWQnKTsKcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY190d2l0dGVyX3ByZWZzJywn
cGx1Z2luX3ByZWZzLmFyY190d2l0dGVyJyk7CgovKgogKiBTZXR1cCBpbml0aWFsIHByZWZl
cmVuY2VzIGlmIG5vdCBpbiB0aGUgdHhwX3ByZWZzIHRhYmxlLgogKi8KaWYgKCFpc3NldCgk
cHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSkpCiAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJf
dXNlcicsICcnLCAnYXJjX3R3aXR0ZXInLCAxLCAndGV4dF9pbnB1dCcpOwppZiAoIWlzc2V0
KCRwcmVmc1snYXJjX3R3aXR0ZXJfcHJlZml4J10pKQogIHNldF9wcmVmKCdhcmNfdHdpdHRl
cl9wcmVmaXgnLCdKdXN0IHBvc3RlZDonLCAnYXJjX3R3aXR0ZXInLCAyLCAndGV4dF9pbnB1
dCcpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10pKQogIHNl
dF9wcmVmKCdhcmNfdHdpdHRlcl9jYWNoZV9kaXInLCR0eHBjZmdbJ3R4cGF0aCddLiRwcmVm
c1sndGVtcGRpciddLCAnYXJjX3R3aXR0ZXInLCAxLCAndGV4dF9pbnB1dCcpOwppZiAoIWlz
c2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCddKSkKICBzZXRfcHJlZign
YXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcsIDEsICdhcmNfdHdpdHRlcicsIDIsICd5ZXNu
b1JhZGlvJyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl91cmxfbWV0aG9kJ10p
KQogIHNldF9wcmVmKCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJywgJ3Rpbnl1cmwnLCAnYXJj
X3R3aXR0ZXInLCAyLAogICAgJ2FyY190d2l0dGVyX3VybF9tZXRob2Rfc2VsZWN0Jyk7Cmlm
ICghaXNzZXQoJHByZWZzWydhcmNfc2hvcnRfdXJsJ10pKQogIHNldF9wcmVmKCdhcmNfc2hv
cnRfdXJsJywgMCwgJ2FyY190d2l0dGVyJywgMiwgJ3llc25vUmFkaW8nKTsKaWYgKCFpc3Nl
dCgkcHJlZnNbJ2FyY19zaG9ydF9zaXRlX3VybCddKSkKICBzZXRfcHJlZignYXJjX3Nob3J0
X3NpdGVfdXJsJywgJHByZWZzWydzaXRldXJsJ10sICdhcmNfdHdpdHRlcicsIDIsICd0ZXh0
X2lucHV0Jyk7Ci8vIE1ha2Ugc3VyZSB0aGF0IHRoZSBUd2l0dGVyIHRhYiBoYXMgYmVlbiBk
ZWZpbmVkCmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl90YWInXSkpIHsKICBzZXRf
cHJlZignYXJjX3R3aXR0ZXJfdGFiJywgJ2V4dGVuc2lvbnMnLCAnYXJjX3R3aXR0ZXInLCAy
LAogICAgJ2FyY190d2l0dGVyX3RhYl9zZWxlY3QnKTsKICAgICRwcmVmc1snYXJjX3R3aXR0
ZXJfdGFiJ10gPSAnZXh0ZW5zaW9ucyc7Cn0KCi8vIENoZWNrIGlmIGFyY19zaG9ydF91cmwg
aXMgZW5hYmxlZAppZiAoJHByZWZzWydhcmNfc2hvcnRfdXJsJ10gfHwgJHByZWZzWydhcmNf
dHdpdHRlcl91cmxfbWV0aG9kJ109PSdhcmNfdHdpdHRlcicpIHsKICByZWdpc3Rlcl9jYWxs
YmFjaygnYXJjX3Nob3J0X3VybF9yZWRpcmVjdCcsICd0eHBfZGllJywgNDA0KTsKfQoKaWYg
KEB0eHBpbnRlcmZhY2UgPT0gJ2FkbWluJykgewogICAgaWYgKCFlbXB0eSgkcHJlZnNbJ2Fy
Y190d2l0dGVyX3VzZXInXSkKICAgICAgICAmJiAhZW1wdHkoJHByZWZzWydhcmNfdHdpdHRl
cl9hY2Nlc3NUb2tlbiddKQogICAgICAgICYmICFlbXB0eSgkcHJlZnNbJ2FyY190d2l0dGVy
X2FjY2Vzc1Rva2VuU2VjcmV0J10pICkgewoKICAgICAgICBpZiAoJHByZWZzWydhcmNfdHdp
dHRlcl90YWInXSkgewogICAgICAgICAgICBhZGRfcHJpdnMoJ2FyY19hZG1pbl90d2l0dGVy
JywgJzEsMiwzLDQnKTsKICAgICAgICAgICAgcmVnaXN0ZXJfdGFiKCRwcmVmc1snYXJjX3R3
aXR0ZXJfdGFiJ10sICdhcmNfYWRtaW5fdHdpdHRlcicsICdUd2l0dGVyJyk7CiAgICAgICAg
ICAgIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYWRtaW5fdHdpdHRlcicsICdhcmNfYWRtaW5f
dHdpdHRlcicpOwogICAgICAgIH0KCiAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19h
cnRpY2xlX3R3ZWV0JywgJ3BpbmcnKTsKICAgICAgICByZWdpc3Rlcl9jYWxsYmFjaygnYXJj
X2FydGljbGVfdHdlZXQnLCAnYXJ0aWNsZScsICdlZGl0JywgMSk7CiAgICAgICAgcmVnaXN0
ZXJfY2FsbGJhY2soJ2FyY19hcHBlbmRfdHdpdHRlcicsICdhcnRpY2xlX3VpJywgJ3N0YXR1
cycpOwogICAgfQp9CgovKgogICAgUHVibGljLXNpZGUgZnVuY3Rpb25zCiAgICA9PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09CiovCgpmdW5jdGlvbiBhcmNfdHdpdHRlcigkYXR0cykKewogIGdsb2JhbCAkcHJlZnMs
JGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7
CgogIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAndXNlcicgICAgICA9PiAkcHJlZnNbJ2Fy
Y190d2l0dGVyX3VzZXInXSwKICAgICdwYXNzd29yZCcgID0+ICcnLAogICAgJ3RpbWVsaW5l
JyAgPT4gJ3VzZXInLAogICAgJ2xpbWl0JyAgICAgPT4gJzEwJywKICAgICdyZXR3ZWV0cycg
ID0+IGZhbHNlLAogICAgJ2RhdGVmb3JtYXQnPT4gJHByZWZzWydhcmNoaXZlX2RhdGVmb3Jt
YXQnXSwKICAgICdjYWNoaW5nJyAgID0+ICcxJywKICAgICdjYWNoZV9kaXInID0+ICRwcmVm
c1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10sCiAgICAnY2FjaGVfdGltZSc9PiAnNScsCiAg
ICAnbGFiZWwnICAgICA9PiAnJywKICAgICdsYWJlbHRhZycgID0+ICcnLAogICAgJ2JyZWFr
JyAgICAgPT4gJ2xpJywKICAgICd3cmFwdGFnJyAgID0+ICcnLAogICAgJ2NsYXNzJyAgICAg
PT4gX19GVU5DVElPTl9fLAogICAgJ2NsYXNzX3Bvc3RlZCcgPT4gX19GVU5DVElPTl9fLict
cG9zdGVkJwogICAgKSwkYXR0cykpOwoKICAkdHdpdCA9IG5ldyBhcmNfVHdpdHRlcigkYXJj
X3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCk7Cgog
IGlmICgkY2FjaGluZykgeyAgLy8gdHVybiBvbiBjYWNoaW5nLCByZWNvbW1lbmRlZCAoZGVm
YXVsdCkKICAgICR0d2l0LT5zZXRDYWNoaW5nKHRydWUpOwogICAgJHR3aXQtPmNhY2hlRGly
KCRjYWNoZV9kaXIpOwogICAgJHR3aXQtPmNhY2hlVGltZSgkY2FjaGVfdGltZSk7CiAgfSBl
bHNlIHsgIC8vIHR1cm4gb2ZmIGNhY2hpbmcsIG5vdCByZWNvbW1lbmRlZCBvdGhlciB0aGFu
IGZvciB0ZXN0aW5nCiAgICAkdHdpdC0+c2V0Q2FjaGluZyhmYWxzZSk7CiAgfQoKICBzd2l0
Y2ggKCR0aW1lbGluZSkgewogICAgY2FzZSAnaG9tZSc6IGNhc2UgJ2ZyaWVuZHMnOgogICAg
ICAkdGltZWxpbmUgPSAnc3RhdHVzZXMvZnJpZW5kc190aW1lbGluZSc7IGJyZWFrOwogICAg
Y2FzZSAnbWVudGlvbnMnOgogICAgICAkdGltZWxpbmUgPSAnc3RhdHVzZXMvbWVudGlvbnMn
OyBicmVhazsKICAgIGNhc2UgJ3VzZXInOiBkZWZhdWx0OiAkdGltZWxpbmUgPSAnc3RhdHVz
ZXMvdXNlcl90aW1lbGluZSc7CiAgfQoKICAkb3V0ID0gYXJyYXkoKTsKICAkeG1sID0gJHR3
aXQtPmdldCgkdGltZWxpbmUKICAgICwgYXJyYXkoJ3NjcmVlbl9uYW1lJz0+JHVzZXIsJ2Nv
dW50Jz0+JGxpbWl0LCdpbmNsdWRlX3J0cyc9PiRyZXR3ZWV0cykpOwogIGlmICgkeG1sKSB7
CiAgICAkdHdlZXRzID0gQCR4bWwtPnhwYXRoKCcvc3RhdHVzZXMvc3RhdHVzJyk7CiAgICBp
ZiAoJHR3ZWV0cykgZm9yZWFjaCAoJHR3ZWV0cyBhcyAkdHdlZXQpIHsKICAgICAgJHRpbWUg
PSBzdHJ0b3RpbWUoaHRtbGVudGl0aWVzKCR0d2VldC0+Y3JlYXRlZF9hdCkpOwogICAgICAk
ZGF0ZSA9IHNhZmVfc3RyZnRpbWUoJGRhdGVmb3JtYXQsJHRpbWUpOwogICAgICAkb3V0W10g
PSBhcmNfVHdpdHRlcjo6bWFrZUxpbmtzKGh0bWxlbnRpdGllcygkdHdlZXQtPnRleHQsIEVO
VF9RVU9URVMsJ1VURi04JykpCiAgICAgICAgLicgJy50YWcoaHRtbGVudGl0aWVzKCRkYXRl
KSwnc3BhbicsJyBjbGFzcz0iJy4kY2xhc3NfcG9zdGVkLiciJyk7CiAgICB9CgogICAgcmV0
dXJuIGRvTGFiZWwoJGxhYmVsLCAkbGFiZWx0YWcpLmRvV3JhcCgkb3V0LCAkd3JhcHRhZywg
JGJyZWFrLCAkY2xhc3MpOwogIH0KCn0KCmZ1bmN0aW9uIGFyY190d2l0dGVyX3NlYXJjaCgk
YXR0cykKewogICAgZ2xvYmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRh
cmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAog
ICAgICAgICd1c2VyJyAgICAgID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLAogICAg
ICAgICdzZWFyY2gnICAgID0+ICcnLAogICAgICAgICdoYXNodGFncycgID0+ICcnLAogICAg
ICAgICd1c2VyJyAgICAgID0+ICcnLAogICAgICAgICdyZXBseScgICAgID0+ICcnLAogICAg
ICAgICdtZW50aW9uJyAgID0+ICcnLAogICAgICAgICdsaW1pdCcgICAgID0+ICcxMCcsCiAg
ICAgICAgJ2xhbmcnICAgICAgPT4gJycsCiAgICAgICAgJ2RhdGVmb3JtYXQnPT4gJHByZWZz
WydhcmNoaXZlX2RhdGVmb3JtYXQnXSwKICAgICAgICAnY2FjaGluZycgICA9PiAnMScsCiAg
ICAgICAgJ2NhY2hlX2RpcicgPT4gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXSwK
ICAgICAgICAnY2FjaGVfdGltZSc9PiAnNScsCiAgICAgICAgJ2xhYmVsJyAgICAgPT4gJycs
CiAgICAgICAgJ2xhYmVsdGFnJyAgPT4gJycsCiAgICAgICAgJ2JyZWFrJyAgICAgPT4gJ2xp
JywKICAgICAgICAnd3JhcHRhZycgICA9PiAnJywKICAgICAgICAnY2xhc3MnICAgICA9PiBf
X0ZVTkNUSU9OX18sCiAgICAgICAgJ2NsYXNzX3Bvc3RlZCcgPT4gX19GVU5DVElPTl9fLict
cG9zdGVkJywKICAgICAgICAnY2xhc3NfdXNlcicgICA9PiBfX0ZVTkNUSU9OX18uJy11c2Vy
JwogICAgKSwkYXR0cykpOwoKICAgICAgICAkdHdpdCA9IG5ldyBhcmNfVHdpdHRlcigkYXJj
X3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3Vt
ZXJTZWNyZXQpOwoKICAgICAgICBpZiAoJGNhY2hpbmcpIHsgIC8vIHR1cm4gb24gY2FjaGlu
ZywgcmVjb21tZW5kZWQgKGRlZmF1bHQpCiAgICAgICAgICAgICR0d2l0LT5zZXRDYWNoaW5n
KHRydWUpOwogICAgICAgICAgICAkdHdpdC0+Y2FjaGVEaXIoJGNhY2hlX2Rpcik7CiAgICAg
ICAgICAgICR0d2l0LT5jYWNoZVRpbWUoJGNhY2hlX3RpbWUpOwogICAgICAgIH0gZWxzZSB7
ICAvLyB0dXJuIG9mZiBjYWNoaW5nLCBub3QgcmVjb21tZW5kZWQgb3RoZXIgdGhhbiBmb3Ig
dGVzdGluZwogICAgICAgICAgICAkdHdpdC0+c2V0Q2FjaGluZyhmYWxzZSk7CiAgICAgICAg
fQoKICAgICAgICAvLyBjb25zdHJ1Y3Qgc2VhcmNoIHF1ZXJ5CiAgICAgICAgaWYgKCFlbXB0
eSgkc2VhcmNoKSkgewogICAgICAgICAgICAkdGVybXMgPSBleHBsb2RlKCcsJywkc2VhcmNo
KTsgJHRlcm1zID0gYXJyYXlfbWFwKCd0cmltJywkdGVybXMpOwogICAgICAgICAgICAkc2Vh
cmNoID0gaW1wbG9kZSgnICcsJHRlcm1zKTsKICAgICAgICB9CiAgICAgICAgaWYgKCRoYXNo
dGFncykgewogICAgICAgICAgICAkaGFzaGVzID0gZXhwbG9kZSgnLCcsJGhhc2h0YWdzKTsg
JGhhc2hlcyA9IGFycmF5X21hcCgndHJpbScsJGhhc2hlcyk7CiAgICAgICAgICAgICRzZWFy
Y2guPSAoKCRzZWFyY2gpPycgJzonJykuJyMnLmltcGxvZGUoJyAjJywkaGFzaGVzKTsKICAg
ICAgICB9CiAgICAgICAgaWYgKCRyZXBseSkgewogICAgICAgICAgICAkc2VhcmNoLj0gKCgk
c2VhcmNoKT8nICc6JycpLid0bzonLnRyaW0oJHJlcGx5KTsKICAgICAgICB9CiAgICAgICAg
aWYgKCR1c2VyKSB7CiAgICAgICAgICAgICRzZWFyY2guPSAoKCRzZWFyY2gpPycgJzonJyku
J2Zyb206Jy50cmltKCR1c2VyKTsKICAgICAgICB9CiAgICAgICAgaWYgKCRtZW50aW9uKSB7
CiAgICAgICAgICAgICRzZWFyY2guPSAoKCRzZWFyY2gpPycgJzonJykuJ0AnLnRyaW0oJG1l
bnRpb24pOwogICAgICAgIH0KCiAgICAgICAgaWYgKGVtcHR5KCRzZWFyY2gpKSB7CiAgICAg
ICAgICAgIHJldHVybiAnJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkc2VhcmNo
ID0gdXJsZW5jb2RlKCRzZWFyY2gpOwogICAgICAgIH0KCiAgICAgICAgJG91dCA9IGFycmF5
KCk7CiAgICAgICAgJHR3ZWV0cyA9ICR0d2l0LT5nZXQoJ2h0dHA6Ly9zZWFyY2gudHdpdHRl
ci5jb20vc2VhcmNoLmF0b20/cT0nLiRzZWFyY2gKICAgICAgICAgICAgLCBhcnJheSgncnBw
Jz0+JGxpbWl0LCdsYW5nJz0+JGxhbmcpKTsKCiAgICAgICAgaWYgKCR0d2VldHMpIHsgZm9y
ZWFjaCAoJHR3ZWV0cy0+ZW50cnkgYXMgJHR3ZWV0KSB7CiAgICAgICAgICAgIHByZWdfbWF0
Y2goIi8oLiopIFwoKC4qKVwpLyIsJHR3ZWV0LT5hdXRob3ItPm5hbWUsJG1hdGNoZXMpOwog
ICAgICAgICAgICBsaXN0KCRhdXRob3IsJHVuYW1lLCRuYW1lKSA9ICRtYXRjaGVzOwogICAg
ICAgICAgICAkdGltZSA9IHN0cnRvdGltZShodG1sZW50aXRpZXMoJHR3ZWV0LT5wdWJsaXNo
ZWQpKTsKICAgICAgICAgICAgJGRhdGUgPSBzYWZlX3N0cmZ0aW1lKCRkYXRlZm9ybWF0LCR0
aW1lKTsKICAgICAgICAgICAgJHRleHQgPSAkdHdlZXQtPnRpdGxlOwogICAgICAgICAgICAk
b3V0W10gPSB0YWcoaHJlZihodG1sZW50aXRpZXMoJHVuYW1lKSwkdHdlZXQtPmF1dGhvci0+
dXJpLAogICAgICAgICAgICAgICAgJyB0aXRsZT0iJy5odG1sZW50aXRpZXMoJG5hbWUpLici
JykuJzogJywnc3BhbicKICAgICAgICAgICAgICAgICAgICAsJyBjbGFzcz0iJy4kY2xhc3Nf
dXNlci4nIicpCiAgICAgICAgICAgICAgICAuYXJjX1R3aXR0ZXI6Om1ha2VMaW5rcyhodG1s
ZW50aXRpZXMoJHRleHQsIEVOVF9RVU9URVMsJ1VURi04JykpCiAgICAgICAgICAgICAgICAu
JyAnLnRhZyhodG1sZW50aXRpZXMoJGRhdGUpLCdzcGFuJwogICAgICAgICAgICAgICAgICAg
ICwnIGNsYXNzPSInLiRjbGFzc19wb3N0ZWQuJyInKTsKICAgICAgICB9IHJldHVybiBkb0xh
YmVsKCRsYWJlbCwgJGxhYmVsdGFnKQogICAgICAgICAgICAuZG9XcmFwKCRvdXQsICR3cmFw
dGFnLCAkYnJlYWssICRjbGFzcyk7IH0KCn0KCmZ1bmN0aW9uIGFyY190d2l0dGVyX3R3ZWV0
KCRhdHRzKSB7CiAgICBnbG9iYWwgJHRoaXNhcnRpY2xlOwoKICAgIGV4dHJhY3QobEF0dHMo
YXJyYXkoCiAgICAgICdpZCcgICAgICAgID0+ICR0aGlzYXJ0aWNsZVsndGhpc2lkJ10sCiAg
ICAgICdpbmNsdWRlX3VybCcgICA9PiB0cnVlCiAgICApLCRhdHRzKSk7CgogICAgaWYgKCRp
ZCkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBm
cm9tCiAgICAgICR0d2VldCA9ICgkaW5jbHVkZV91cmwpID8gc2FmZV9yb3coInR3ZWV0Iiwg
J2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKQogICAgICAgIDogc2FmZV9yb3co
IlJFUExBQ0UodHdlZXQsQ09OQ0FUKCcgJyx0aW55dXJsKSwnJykgQVMgdHdlZXQiCiAgICAg
ICAgICAsICdhcmNfdHdpdHRlcicsICJhcnRpY2xlX2lkPXskaWR9Iik7CiAgICB9CgogICAg
aWYgKCR0d2VldFsndHdlZXQnXSkgewogICAgICByZXR1cm4gYXJjX1R3aXR0ZXI6Om1ha2VM
aW5rcygKICAgICAgICBodG1sZW50aXRpZXMoJHR3ZWV0Wyd0d2VldCddLCBFTlRfUVVPVEVT
LCdVVEYtOCcpKTsKICAgIH0KfQoKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdHdlZXRfdXJsKCRh
dHRzLCAkdGhpbmc9bnVsbCkgewogICAgZ2xvYmFsICR0aGlzYXJ0aWNsZSwkcHJlZnM7Cgog
ICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgJ2lkJyAgICAgID0+ICR0aGlzYXJ0aWNs
ZVsndGhpc2lkJ10sCiAgICAgICd0aXRsZScgICA9PiAnJywKICAgICAgJ2NsYXNzJyAgID0+
ICcnCiAgICApLCRhdHRzKSk7CgogICAgaWYgKCRpZCkgewogICAgICAvLyBGZXRjaCBhcmNf
dHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBmcm9tCiAgICAgICR0d2VldCA9IHNhZmVf
cm93KCJ0d2VldF9pZCIKICAgICAgICAsICdhcmNfdHdpdHRlcicsICJhcnRpY2xlX2lkPXsk
aWR9Iik7CiAgICB9CgogICAgaWYgKCR0d2VldFsndHdlZXRfaWQnXSkgewogICAgICAkdXJs
ID0gImh0dHA6Ly90d2l0dGVyLmNvbS8iLiRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLiIv
c3RhdHVzLyIuJHR3ZWV0Wyd0d2VldF9pZCddOwogICAgICBpZiAoJHRoaW5nPT09bnVsbCkg
ewogICAgICAgIHJldHVybiAkdXJsOwogICAgICB9CiAgICAgIHJldHVybiBocmVmKHBhcnNl
KCR0aGluZyksICR1cmwsCiAgICAgICAgKCR0aXRsZSA/ICcgdGl0bGU9IicuJHRpdGxlLici
JyA6ICcnKQogICAgICAgIC4oJGNsYXNzID8gJyBjbGFzcz0iJy4kY2xhc3MuJyInIDogJycp
KTsKICAgIH0KfQoKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdGlueXVybCgkYXR0cywgJHRoaW5n
PW51bGwpIHsKICAgIGdsb2JhbCAkdGhpc2FydGljbGU7CgogICAgZXh0cmFjdChsQXR0cyhh
cnJheSgKICAgICAgJ2lkJyAgICAgID0+ICR0aGlzYXJ0aWNsZVsndGhpc2lkJ10sCiAgICAg
ICd0aXRsZScgICA9PiAnJywKICAgICAgJ2NsYXNzJyAgID0+ICcnCiAgICApLCRhdHRzKSk7
CgogICAgaWYgKCRpZCkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBi
dWlsZCB0d2VldCBmcm9tCiAgICAgICR0d2VldCA9IHNhZmVfcm93KCJ0aW55dXJsIgogICAg
ICAgICwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKTsKICAgIH0KCiAgICBp
ZiAoJHR3ZWV0Wyd0aW55dXJsJ10pIHsKICAgICAgaWYgKCR0aGluZz09PW51bGwpIHsKICAg
ICAgICByZXR1cm4gJHR3ZWV0Wyd0aW55dXJsJ107CiAgICAgIH0KCiAgICAgIHJldHVybiBo
cmVmKHBhcnNlKCR0aGluZyksICR0d2VldFsndGlueXVybCddLAogICAgICAgICgkdGl0bGUg
PyAnIHRpdGxlPSInLiR0aXRsZS4nIicgOiAnJykKICAgICAgICAuKCRjbGFzcyA/ICcgY2xh
c3M9IicuJGNsYXNzLiciJyA6ICcnKSk7CiAgICB9Cn0KCi8qCiAqIFB1YmxpYyB0YWcgZm9y
IG91dHB1dHRpbmcgd2lkZ2V0IEpTCiAqLwpmdW5jdGlvbiBhcmNfdHdpdHRlcl93aWRnZXRf
anMoJGF0dHMpCnsKICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAgICdvcHRpbWlzZScg
PT4gZmFsc2UKICAgICksJGF0dHMpKTsKCiAgcmV0dXJuIF9hcmNfdHdpdHRlcl93aWRnZXRf
anMoJG9wdGltaXNlKTsKfQoKZnVuY3Rpb24gX2FyY190d2l0dGVyX3dpZGdldF9qcygkb3B0
aW1pc2U9dHJ1ZSkKewogIGdsb2JhbCAkYXJjX3R3aXR0ZXI7CgogIC8vIENoZWNrIGlmIHdp
ZGdldCBKUyBoYXMgYWxyZWFkeSBiZWVuIG91dHB1dAogIGlmICgkYXJjX3R3aXR0ZXJbJ3dp
ZGdldF9qcyddKSByZXR1cm47CgogIGlmICgkb3B0aW1pc2U9PWZhbHNlKSB7CiAgICByZXR1
cm4gJzxzY3JpcHQgc3JjPSJodHRwOi8vcGxhdGZvcm0udHdpdHRlci5jb20vd2lkZ2V0cy5q
cyIgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij48L3NjcmlwdD4nOwogIH0KCiAgJGpzID0gPDw8
SlMKPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPgooZnVuY3Rpb24oKSB7CiAgaWYg
KHdpbmRvdy5fX3R3aXR0ZXJJbnRlbnRIYW5kbGVyKSByZXR1cm47CiAgdmFyIGludGVudFJl
Z2V4ID0gL3R3aXR0ZXJcLmNvbShcOlxkezIsNH0pP1wvaW50ZW50XC8oXHcrKS8sCiAgICAg
IHdpbmRvd09wdGlvbnMgPSAnc2Nyb2xsYmFycz15ZXMscmVzaXphYmxlPXllcyx0b29sYmFy
PW5vLGxvY2F0aW9uPXllcycsCiAgICAgIHdpZHRoID0gNTUwLAogICAgICBoZWlnaHQgPSA0
MjAsCiAgICAgIHdpbkhlaWdodCA9IHNjcmVlbi5oZWlnaHQsCiAgICAgIHdpbldpZHRoID0g
c2NyZWVuLndpZHRoOwoKICBmdW5jdGlvbiBoYW5kbGVJbnRlbnQoZSkgewogICAgZSA9IGUg
fHwgd2luZG93LmV2ZW50OwogICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxl
bWVudCwKICAgICAgICBtLCBsZWZ0LCB0b3A7CgogICAgd2hpbGUgKHRhcmdldCAmJiB0YXJn
ZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPT0gJ2EnKSB7CiAgICAgIHRhcmdldCA9IHRh
cmdldC5wYXJlbnROb2RlOwogICAgfQoKICAgIGlmICh0YXJnZXQgJiYgdGFyZ2V0Lm5vZGVO
YW1lLnRvTG93ZXJDYXNlKCkgPT09ICdhJyAmJiB0YXJnZXQuaHJlZikgewogICAgICBtID0g
dGFyZ2V0LmhyZWYubWF0Y2goaW50ZW50UmVnZXgpOwogICAgICBpZiAobSkgewogICAgICAg
IGxlZnQgPSBNYXRoLnJvdW5kKCh3aW5XaWR0aCAvIDIpIC0gKHdpZHRoIC8gMikpOwogICAg
ICAgIHRvcCA9IDA7CgogICAgICAgIGlmICh3aW5IZWlnaHQgPiBoZWlnaHQpIHsKICAgICAg
ICAgIHRvcCA9IE1hdGgucm91bmQoKHdpbkhlaWdodCAvIDIpIC0gKGhlaWdodCAvIDIpKTsK
ICAgICAgICB9CgogICAgICAgIHdpbmRvdy5vcGVuKHRhcmdldC5ocmVmLCAnaW50ZW50Jywg
d2luZG93T3B0aW9ucyArICcsd2lkdGg9JyArIHdpZHRoICsKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICcsaGVpZ2h0PScgKyBoZWlnaHQgKyAnLGxlZnQ9
JyArIGxlZnQgKyAnLHRvcD0nICsgdG9wKTsKICAgICAgICBlLnJldHVyblZhbHVlID0gZmFs
c2U7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCAmJiBlLnByZXZlbnREZWZhdWx0KCk7CiAg
ICAgIH0KICAgIH0KICB9CgogIGlmIChkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKSB7CiAg
ICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUludGVudCwgZmFs
c2UpOwogIH0gZWxzZSBpZiAoZG9jdW1lbnQuYXR0YWNoRXZlbnQpIHsKICAgIGRvY3VtZW50
LmF0dGFjaEV2ZW50KCdvbmNsaWNrJywgaGFuZGxlSW50ZW50KTsKICB9CiAgd2luZG93Ll9f
dHdpdHRlckludGVudEhhbmRsZXIgPSB0cnVlOwp9KCkpOwo8L3NjcmlwdD4KSlM7CiAgJGFy
Y190d2l0dGVyWyd3aWRnZXRfanMnXSA9IHRydWU7CiAgcmV0dXJuICRqczsKfQoKLy8gRGVw
cmVjYXRlZCBhcmNfdHdpdHRlcl9yZXR3ZWV0IHRhZywgdXNlIGFyY190d2l0dGVyX3R3ZWV0
X2J1dHRvbiBpbnN0ZWFkCmZ1bmN0aW9uIGFyY190d2l0dGVyX3JldHdlZXQoJGF0dHMsICR0
aGluZz1udWxsKQp7CiAgcmV0dXJuIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbigkYXR0cywg
JHRoaW5nPW51bGwpOwp9CmZ1bmN0aW9uIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRvbigkYXR0
cywgJHRoaW5nPW51bGwpCnsKICAgIGdsb2JhbCAkcHJlZnMsJGFyY190d2l0dGVyX2NvbnN1
bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CiAgICBnbG9iYWwgJHRoaXNh
cnRpY2xlOwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICAgJ3VzZXInICAgICAg
ICA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSwgLy8gdmlhIHVzZXIgYWNjb3VudAog
ICAgICAgICd1cmwnICAgICAgICAgPT4gJycsCiAgICAgICAgJ3RleHQnICAgICAgICA9PiAn
JywKICAgICAgICAnZm9sbG93MScgICAgID0+ICcnLAogICAgICAgICdmb2xsb3cyJyAgICAg
PT4gJycsCiAgICAgICAgJ2xhbmcnICAgICAgICA9PiAnJywKICAgICAgICAnY291bnQnICAg
ICAgID0+ICdob3Jpem9udGFsJywKICAgICAgICAnaW5jbHVkZV9qcycgID0+IHRydWUsCiAg
ICAgICAgJ29wdGltaXNlX2pzJyA9PiBmYWxzZSwKICAgICAgICAnd3JhcHRhZycgICAgID0+
ICcnLAogICAgICAgICdjbGFzcycgICAgICAgPT4gJ3R3aXR0ZXItc2hhcmUtYnV0dG9uJwog
ICAgKSwkYXR0cykpOwoKICAgICRxID0gJyc7IC8vIHF1ZXJ5IHN0cmluZwoKICAgIGlmICgk
aWQ9JHRoaXNhcnRpY2xlWyd0aGlzaWQnXSkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRl
ciBzdHVmZiB0byBidWlsZCB0d2VldCBmcm9tCiAgICAgICRyb3cgPSBzYWZlX3JvdygiUkVQ
TEFDRSh0d2VldCxDT05DQVQoJyAnLHRpbnl1cmwpLCcnKSBBUyB0d2VldCx0aW55dXJsIgog
ICAgICAgICwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKTsKCiAgICAgIGlm
ICgkdXJsPT0nJykgewogICAgICAgICR1cmwgPSAoJHVybCkgPyAkdXJsIDogcGVybWxpbmt1
cmwoJHRoaXNhcnRpY2xlKTsKICAgICAgICAkcSA9ICd1cmw9Jy51cmxlbmNvZGUoJHVybCk7
CiAgICAgIH0KICAgICAgaWYgKCR0ZXh0PT0nJykgewogICAgICAgICR0ZXh0ID0gKCRyb3db
J3R3ZWV0J10pID8gJHJvd1sndHdlZXQnXSA6ICR0aGlzYXJ0aWNsZVsndGl0bGUnXTsKICAg
ICAgfQogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLid0ZXh0PScudXJsZW5jb2Rl
KCR0ZXh0KTsKICAgIH0KICAgIGlmICgkdXNlcikgewogICAgICAkcSAuPSAoJHEgPyAnJmFt
cDsnIDogJycpLid2aWE9Jy51cmxlbmNvZGUoJHVzZXIpOwogICAgfQogICAgaWYgKCRmb2xs
b3cxJiYkZm9sbG93MikgewogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidyZWxh
dGVkPScudXJsZW5jb2RlKCRmb2xsb3cxLic6Jy4kZm9sbG93Mik7CiAgICB9IGVsc2VpZiAo
JGZvbGxvdzF8fCRmb2xsb3cyKSB7CiAgICAgICRxIC49ICgkcSA/ICcmYW1wOycgOiAnJyku
J3JlbGF0ZWQ9Jy51cmxlbmNvZGUoJGZvbGxvdzEuJGZvbGxvdzIpOwogICAgfQoKICAgIHN3
aXRjaCAoJGxhbmcpIHsKICAgICAgY2FzZSAnZnInOiBicmVhazsgY2FzZSAnZGUnOiBicmVh
azsgY2FzZSAnZXMnOiBicmVhazsgY2FzZSAnanAnOiBicmVhazsKICAgICAgZGVmYXVsdDoK
ICAgICAgICAkbGFuZyA9ICdlbic7CiAgICB9CiAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDog
JycpLidsYW5nPScudXJsZW5jb2RlKCRsYW5nKTsKCiAgICBzd2l0Y2ggKCRjb3VudCkgewog
ICAgICBjYXNlICdub25lJzogYnJlYWs7IGNhc2UgJ3ZlcnRpY2FsJzogYnJlYWs7CiAgICAg
IGRlZmF1bHQ6CiAgICAgICAgJGNvdW50ID0gJ2hvcml6b250YWwnOwogICAgfQogICAgJHEg
Lj0gKCRxID8gJyZhbXA7JyA6ICcnKS4nY291bnQ9Jy51cmxlbmNvZGUoJGNvdW50KTsKCiAg
ICAkdGhpbmcgPSAoJHRoaW5nPT09bnVsbCkgPyAnVHdlZXQnIDogcGFyc2UoJHRoaW5nKTsK
CiAgICAkaHRtbCA9IGhyZWYoJHRoaW5nLCdodHRwOi8vdHdpdHRlci5jb20vc2hhcmU/Jy4k
cQogICAgICAsICcgY2xhc3M9IicuJGNsYXNzLiciJyk7CgogICAgJGpzID0gKCRpbmNsdWRl
X2pzKSA/IF9hcmNfdHdpdHRlcl93aWRnZXRfanMoJG9wdGltaXNlX2pzP3RydWU6ZmFsc2Up
IDogJyc7CgogICAgcmV0dXJuICRqcy4kaHRtbDsKfQoKLyoKICogVHdpdHRlciBGb2xsb3cg
YnV0dG9uCiAqLwpmdW5jdGlvbiBhcmNfdHdpdHRlcl9mb2xsb3dfYnV0dG9uKCRhdHRzLCAk
dGhpbmc9bnVsbCkKewogICAgZ2xvYmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJL
ZXksICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKICAgIGdsb2JhbCAkdGhpc2FydGlj
bGU7CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgICAndXNlcicgICAgICAgID0+
ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLCAvLyB2aWEgdXNlciBhY2NvdW50CiAgICAg
ICAgJ2xhbmcnICAgICAgICA9PiAnJywKICAgICAgICAnY291bnQnICAgICAgID0+IHRydWUs
CiAgICAgICAgJ2luY2x1ZGVfanMnICA9PiB0cnVlLAogICAgICAgICdvcHRpbWlzZV9qcycg
PT4gZmFsc2UsCiAgICAgICAgJ2NsYXNzJyAgICAgICA9PiAndHdpdHRlci1mb2xsb3ctYnV0
dG9uJwogICAgKSwkYXR0cykpOwoKICAgICRhdHRzID0gJyc7IC8vIGRhdGEgYXR0cmlidXRl
cwoKICAgIHN3aXRjaCAoJGxhbmcpIHsKICAgICAgY2FzZSAnZnInOiBicmVhazsgY2FzZSAn
ZGUnOiBicmVhazsgY2FzZSAnZXMnOiBicmVhazsgY2FzZSAnanAnOiBicmVhazsKICAgICAg
ZGVmYXVsdDoKICAgICAgICAkbGFuZyA9ICdlbic7CiAgICB9CiAgICAkYXR0cyAuPSAnIGRh
dGEtbGFuZz0iJy51cmxlbmNvZGUoJGxhbmcpLiciJzsKCiAgICAkYXR0cyAuPSAnIGRhdGEt
c2hvdy1jb3VudD0iJy4oJGNvdW50Pyd0cnVlJzonZmFsc2UnKS4nIic7CgogICAgJHRoaW5n
ID0gKCR0aGluZz09PW51bGwpID8gJ0ZvbGxvdyBAJy4kdXNlciA6IHBhcnNlKCR0aGluZyk7
CgogICAgJGh0bWwgPSBocmVmKCR0aGluZywnaHR0cDovL3R3aXR0ZXIuY29tLycudXJsZW5j
b2RlKCR1c2VyKQogICAgICAsICcgY2xhc3M9IicuJGNsYXNzLiciJy4kYXR0cyk7CgogICAg
JGpzID0gKCRpbmNsdWRlX2pzKSA/IF9hcmNfdHdpdHRlcl93aWRnZXRfanMoJG9wdGltaXNl
X2pzP3RydWU6ZmFsc2UpIDogJyc7CgogICAgcmV0dXJuICRqcy4kaHRtbDsKfQoKLyoKICAg
IEFkbWluLXNpZGUgZnVuY3Rpb25zCiAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiovCgovLyBJbnN0YWxsYXRp
b24gZnVuY3Rpb24gLSBidWlsZHMgTXlTUUwgdGFibGUKZnVuY3Rpb24gYXJjX3R3aXR0ZXJf
aW5zdGFsbCgpCnsKCiAgICAvLyBGb3IgZmlyc3QgaW5zdGFsbCwgY3JlYXRlIHRhYmxlIGZv
ciB0d2VldHMKICAgICRzcWwgPSAiQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgIi5QRlgu
ImFyY190d2l0dGVyICI7CiAgICAkc3FsLj0gIihhcmNfdHdpdHRlcmlkIElOVEVHRVIgQVVU
T19JTkNSRU1FTlQgUFJJTUFSWSBLRVksCiAgICAgICAgYXJ0aWNsZV9pZCBJTlRFR0VSKDEx
KSwKICAgICAgICB0d2VldF9pZCBCSUdJTlQoMjApLAogICAgICAgIHR3ZWV0IFZBUkNIQVIo
MTQwKSwKICAgICAgICB0aW55dXJsIFZBUkNIQVIoMzApKTsiOwoKICAgIGlmICghc2FmZV9x
dWVyeSgkc3FsKSkgewogICAgICAgIHJldHVybiAnRXJyb3IgLSB1bmFibGUgdG8gY3JlYXRl
IGFyY190d2l0dGVyIHRhYmxlJzsKICAgIH0KCn0KCi8vIFVuaW5zdGFsbCBmdW5jdGlvbiAt
IGRlbGV0ZXMgTXlTUUwgdGFibGUgYW5kIHJlbGF0ZWQgcHJlZmVyZW5jZXMKZnVuY3Rpb24g
YXJjX3R3aXR0ZXJfdW5pbnN0YWxsKCkKewoKICAgICRzcWwgPSAiRFJPUCBUQUJMRSBJRiBF
WElTVFMgIi5QRlguImFyY190d2l0dGVyOyI7CiAgICBpZiAoIXNhZmVfcXVlcnkoJHNxbCkp
IHsKICAgICAgICByZXR1cm4gJ0Vycm9yIC0gdW5hYmxlIHRvIGRlbGV0ZSBhcmNfdHdpdHRl
ciB0YWJsZSc7CiAgICB9CgogICAgJHNxbCA9ICJERUxFVEUgRlJPTSAgIi5QRlguInR4cF9w
cmVmcyBXSEVSRSBldmVudD0nYXJjX3R3aXR0ZXInOyI7CiAgICBpZiAoIXNhZmVfcXVlcnko
JHNxbCkpIHsKICAgICAgICByZXR1cm4gJ0Vycm9yIC0gdW5hYmxlIHRvIGRlbGV0ZSBhcmNf
dHdpdHRlciBwcmVmZXJlbmNlcyc7CiAgICB9Cgp9CmZ1bmN0aW9uIGFyY190d2l0dGVyX3Vy
bF9tZXRob2Rfc2VsZWN0KCRuYW1lLCAkdmFsKQp7CiAgICAkbWV0aG9kcyA9IGFycmF5KCd0
aW55dXJsJyA9PiAnVGlueXVybCcsCiAgICAgICdpc2dkJyA9PiAnSXMuZ2QnLAogICAgICAn
YXJjX3R3aXR0ZXInID0+ICdUWFAgVHdlZXQnLAogICAgICAnc21kJyA9PiAnc21kX3Nob3J0
X3VybCcpOwogICAgcmV0dXJuIHNlbGVjdElucHV0KCRuYW1lLCAkbWV0aG9kcywgJHZhbCk7
Cn0KZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCgkbmFtZSwgJHZhbCkKewogICAg
JHRhYnMgPSBhcnJheSgnY29udGVudCcgPT4gJ0NvbnRlbnQnLAogICAgICAgICdleHRlbnNp
b25zJyA9PiAnRXh0ZW5zaW9ucycsCiAgICAgICAgJycgPT4gJ0hpZGRlbicpOwogICAgcmV0
dXJuIHNlbGVjdElucHV0KCRuYW1lLCAkdGFicywgJHZhbCk7Cn0KLy8gUHJvdmlkZSBpbnRl
cmZhY2UgZm9yIHNldHRpbmcgcHJlZmVyZW5jZXMKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfcHJl
ZnMoJGV2ZW50LCRzdGVwKQp7CgogICAgZ2xvYmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29u
c3VtZXJLZXksJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgICR1c2VyICAgICAg
ICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ107CiAgICAkcHJlZml4ICAgICAgICA9
ICRwcmVmc1snYXJjX3R3aXR0ZXJfcHJlZml4J107CiAgICAkdHdlZXRfZGVmYXVsdCA9ICRw
cmVmc1snYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCddOwogICAgJHVybF9tZXRob2QgICAg
PSAkcHJlZnNbJ2FyY190d2l0dGVyX3VybF9tZXRob2QnXTsKICAgICRzaG9ydF91cmwgICAg
ID0gJHByZWZzWydhcmNfc2hvcnRfdXJsJ107CiAgICAkc2hvcnRfc2l0ZV91cmw9ICRwcmVm
c1snYXJjX3Nob3J0X3NpdGVfdXJsJ107CiAgICAkY2FjaGVfZGlyICAgICA9ICRwcmVmc1sn
YXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ107CiAgICAkdGFiICAgICAgICAgICA9ICRwcmVmc1sn
YXJjX3R3aXR0ZXJfdGFiJ107CgogICAgc3dpdGNoICgkc3RlcCkgewogICAgICAgIGNhc2Ug
J3ByZWZzX3NhdmUnOiBwYWdldG9wKCdUWFAgVHdlZXQnLCAnUHJlZmVyZW5jZXMgc2F2ZWQn
KTsgYnJlYWs7CiAgICAgICAgY2FzZSAncmVnaXN0ZXInOiBwYWdldG9wKCdUWFAgVHdlZXQn
LCdDb25uZWN0IHRvIFR3aXR0ZXInKTsgYnJlYWs7CiAgICAgICAgY2FzZSAndmFsaWRhdGUn
OgogICAgICAgIGRlZmF1bHQ6IHBhZ2V0b3AoJ1RYUCBUd2VldCcpOwogICAgfQoKICAgICRo
dG1sID0gJyc7CgogICAgaWYgKCRzdGVwPT0ncmVnaXN0ZXInKSB7IC8vIE9BdXRoIHJlZ2lz
dHJhdGlvbiBwcm9jZXNzCiAgICAgICAgJHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190
d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVy
U2VjcmV0KTsKCiAgICAgICAgLy8gQnVpbGQgYSBjYWxsYmFjayBVUkwgZm9yIFR3aXR0ZXIg
dG8gcmV0dXJuIHRvIHRoZSBuZXh0IHN0YWdlCiAgICAgICAgJGNhbGxiYWNrVVJMID0gJHR3
aXQtPmNhbGxiYWNrVVJMKCRldmVudCwndmFsaWRhdGUnKTsKCiAgICAgICAgJHJlcXVlc3Qg
PSAkdHdpdC0+Z2V0UmVxdWVzdFRva2VuKCRjYWxsYmFja1VSTCk7CiAgICAgICAgJHJlcXVl
c3RfdG9rZW4gPSAkcmVxdWVzdFsib2F1dGhfdG9rZW4iXTsKICAgICAgICAkcmVxdWVzdF90
b2tlbl9zZWNyZXQgPSAkcmVxdWVzdFsib2F1dGhfdG9rZW5fc2VjcmV0Il07CgogICAgICAg
IHNldF9wcmVmKCdhcmNfdHdpdHRlcl9yZXF1ZXN0VG9rZW4nLCRyZXF1ZXN0X3Rva2VuCiAg
ICAgICAgICAgICwgJ2FyY190d2l0dGVyJywyKTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3
aXR0ZXJfcmVxdWVzdFRva2VuU2VjcmV0JywkcmVxdWVzdF90b2tlbl9zZWNyZXQKICAgICAg
ICAgICAgLCAnYXJjX3R3aXR0ZXInLDIpOwoKICAgICAgICAkaHRtbC49IHN0YXJ0VGFibGUo
J2VkaXQnKS4KICAgICAgICAgICAgICAgIHRyKHRkKAogICAgICAgICAgICAgICAgICAgICgn
PHA+Jy5ocmVmKCdTaWduLWluIHRvIFR3aXR0ZXInCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAsJHR3aXQtPmdldEF1dGhvcml6ZVVSTCgkcmVxdWVzdCkpCiAgICAgICAgICAgICAg
ICAgICAgICAgIC4nIGFuZCBmb2xsb3cgdGhlIGluc3RydWN0aW9ucyB0byBhbGxvdyBUWFAg
VHdlZXQgdG8gdXNlIHlvdXIgYWNjb3VudC4gSWYgeW91IGFyZSBhbHJlYWR5IHNpZ25lZCBp
biB0byBUd2l0dGVyIHRoZW4gdGhhdCBhY2NvdW50IHdpbGwgYmUgYXNzb2NpYXRlZCB3aXRo
IFRYUCBUd2VldCBzbyB5b3UgbWF5IG5lZWQgdG8gc2lnbiBvdXQgZmlyc3QgaWYgeW91IHdh
bnQgdG8gdXNlIGEgZGlmZmVyZW50IGFjY291bnQuPC9wPicpCiAgICAgICAgICAgICAgICAp
KS5lbmRUYWJsZSgpOwogICAgfSBlbHNlaWYgKCRzdGVwPT0ndmFsaWRhdGUnKSB7CiAgICAg
ICAgJHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAg
ICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190
d2l0dGVyX3JlcXVlc3RUb2tlbiddCiAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRl
cl9yZXF1ZXN0VG9rZW5TZWNyZXQnXSk7CiAgICAgICAgLy8gQXNrIFR3aXR0ZXIgZm9yIGFu
IGFjY2VzcyB0b2tlbiAoYW5kIGFuIGFjY2VzcyB0b2tlbiBzZWNyZXQpCiAgICAgICAgJHJl
cXVlc3QgPSAkdHdpdC0+Z2V0QWNjZXNzVG9rZW4oIGdwcygnb2F1dGhfdmVyaWZpZXInKSAp
OwogICAgICAgICRhY2Nlc3NfdG9rZW4gPSAkcmVxdWVzdFsnb2F1dGhfdG9rZW4nXTsKICAg
ICAgICAkYWNjZXNzX3Rva2VuX3NlY3JldCA9ICRyZXF1ZXN0WydvYXV0aF90b2tlbl9zZWNy
ZXQnXTsKICAgICAgICAkdXNlciA9ICRyZXF1ZXN0WydzY3JlZW5fbmFtZSddOwogICAgICAg
IC8vIFN0b3JlIHRoZSBhY2Nlc3MgdG9rZW4gYW5kIHNlY3JldAogICAgICAgIHNldF9wcmVm
KCdhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbicsJGFjY2Vzc190b2tlbiwgJ2FyY190d2l0dGVy
JywyKTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQn
LCRhY2Nlc3NfdG9rZW5fc2VjcmV0CiAgICAgICAgICAgICwgJ2FyY190d2l0dGVyJywyKTsK
ICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdXNlcicsJHVzZXIpOwogICAgICAgICRw
cmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXSA9ICRhY2Nlc3NfdG9rZW47CiAgICAg
ICAgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddID0gJGFjY2Vzc190
b2tlbl9zZWNyZXQ7CiAgICAgICAgdW5zZXQoJHR3aXQpOwogICAgfQoKICAgIGlmICgkc3Rl
cD09InByZWZzX3NhdmUiKSB7CiAgICAgICAgJHByZWZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdp
dHRlcl9wcmVmaXgnKSk7CiAgICAgICAgJHR3ZWV0X2RlZmF1bHQgPSBncHMoJ2FyY190d2l0
dGVyX3R3ZWV0X2RlZmF1bHQnKTsKICAgICAgICAkdXJsX21ldGhvZCA9IGdwcygnYXJjX3R3
aXR0ZXJfdXJsX21ldGhvZCcpOwogICAgICAgICRzaG9ydF91cmwgPSBncHMoJ2FyY19zaG9y
dF91cmwnKTsKICAgICAgICAkc2hvcnRfc2l0ZV91cmwgPSBncHMoJ2FyY19zaG9ydF9zaXRl
X3VybCcpOwogICAgICAgICRjYWNoZV9kaXIgPSBncHMoJ2FyY190d2l0dGVyX2NhY2hlX2Rp
cicpOwogICAgICAgICR0YWIgPSBncHMoJ2FyY190d2l0dGVyX3RhYicpOwogICAgICAgIGlm
IChzdHJsZW4oJHByZWZpeCk8PTIwKSB7CiAgICAgICAgICAgIHNldF9wcmVmKCdhcmNfdHdp
dHRlcl9wcmVmaXgnLCRwcmVmaXgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICRw
cmVmaXggPSAkcHJlZnNbJ2FyY190d2l0dGVyX3ByZWZpeCddOwogICAgICAgIH0KICAgICAg
ICAkdHdlZXRfZGVmYXVsdCA9ICgkdHdlZXRfZGVmYXVsdCkgPyAxIDogMDsKICAgICAgICAk
c2hvcnRfdXJsID0gKCRzaG9ydF91cmwpID8gMSA6IDA7CiAgICAgICAgaWYgKCEkc2hvcnRf
c2l0ZV91cmwpICRzaG9ydF9zaXRlX3VybCA9ICRwcmVmc1snc2l0ZXVybCddOwogICAgICAg
IHNldF9wcmVmKCdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0JywkdHdlZXRfZGVmYXVsdCk7
CiAgICAgICAgc2V0X3ByZWYoJ2FyY19zaG9ydF91cmwnLCRzaG9ydF91cmwpOwogICAgICAg
IHNldF9wcmVmKCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJywkdXJsX21ldGhvZCk7CiAgICAg
ICAgc2V0X3ByZWYoJ2FyY19zaG9ydF9zaXRlX3VybCcsJHNob3J0X3NpdGVfdXJsKTsKICAg
ICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJywkY2FjaGVfZGlyKTsKICAg
ICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdGFiJywkdGFiKTsKICAgIH0KCiAgICBpZiAo
ICRzdGVwIT0ncmVnaXN0ZXInICkgewogICAgICAgIGlmICggaXNzZXQoJHByZWZzWydhcmNf
dHdpdHRlcl9hY2Nlc3NUb2tlbiddKQogICAgICAgICYmIGlzc2V0KCRwcmVmc1snYXJjX3R3
aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSkgKSB7CiAgICAgICAgICAgICR0d2l0ID0gbmV3
IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAgICAg
LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNj
ZXNzVG9rZW4nXQogICAgICAgICAgICAgICAgLCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vz
c1Rva2VuU2VjcmV0J10pOwogICAgICAgICAgICAkcmVnaXN0ZXJVUkwgPSAkdHdpdC0+Y2Fs
bGJhY2tVUkwoJGV2ZW50LCdyZWdpc3RlcicpOwogICAgICAgICAgICAkaHRtbC49IHN0YXJ0
VGFibGUoJ2xpc3QnKS5mb3JtKAogICAgICAgICAgICAgICAgdHIoCiAgICAgICAgICAgICAg
ICAgICAgdGRjcyhoZWQoJ1R3aXR0ZXIgYWNjb3VudCBkZXRhaWxzJywgMiksMikKICAgICAg
ICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0
ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX3VzZXIiPlR3aXR0ZXIgdXNlcm5hbWU8L2xh
YmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJp
Z2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50
ZCgKICAgICAgICAgICAgICAgICAgICAgICAgKCRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlcidd
KSA/CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdXNlci4nICgnLmhyZWYoJ1JlLWNv
bm5lY3QnLCRyZWdpc3RlclVSTCkuJyknCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6
ICc8ZW0+dW5rbm93bjwvZW0+JwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmhyZWYo
J0Nvbm5lY3QgdG8gVHdpdHRlcicsJHJlZ2lzdGVyVVJMKSkKICAgICAgICAgICAgICAgICkK
ICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVHdl
ZXQgc2V0dGluZ3MnLCAyKSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAg
LnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJf
Y2FjaGVfZGlyIj5Ud2VldCBwcmVmaXg8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAg
ICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxl
OyInKQogICAgICAgICAgICAgICAgICAgIC50ZChmSW5wdXQoJ3RleHQnLCdhcmNfdHdpdHRl
cl9wcmVmaXgnLCRwcmVmaXgsJycsJycsJycsJycsJycsJ2FyY190d2l0dGVyX3ByZWZpeCcp
KQogICAgICAgICAgICAgICAgKS50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJl
bCBmb3I9ImFyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQiPlR3ZWV0IGFydGljbGVzIGJ5IGRl
ZmF1bHQ8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQt
YWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAg
ICAgICAgIC50ZCh5ZXNub1JhZGlvKCdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0JywgJHR3
ZWV0X2RlZmF1bHQsICcnLCAnYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcpKQogICAgICAg
ICAgICAgICAgKS50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFy
Y190d2l0dGVyX3VybF9tZXRob2QiPlVSTCBzaG9ydG5lcjwvbGFiZWw+JywKICAgICAgICAg
ICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFs
aWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKGFyY190d2l0dGVyX3Vy
bF9tZXRob2Rfc2VsZWN0KCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJywkdXJsX21ldGhvZCkp
CiAgICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdU
WFAgVHdlZXQgc2hvcnQgVVJMJywgMiksMikKICAgICAgICAgICAgICAgICkKICAgICAgICAg
ICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY19z
aG9ydF91cmwiPkVuYWJsZSBUWFAgVHdlZXQgc2hvcnQgVVJMIHJlZGlyZWN0PC9sYWJlbD4n
LAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsg
dmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoeWVz
bm9SYWRpbygnYXJjX3Nob3J0X3VybCcsICRzaG9ydF91cmwsICcnLCAnYXJjX3Nob3J0X3Vy
bCcpKSwKICAgICAgICAgICAgICAgICAgICAnIGlkPSJhcmNfc2hvcnRfdXJsLW9uX29mZiIn
CiAgICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVs
IGZvcj0iYXJjX3Nob3J0X3NpdGVfdXJsIj5UWFAgVHdlZXQgc2hvcnQgc2l0ZSBVUkw8L2xh
YmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJp
Z2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50
ZChmSW5wdXQoJ3RleHQnLCdhcmNfc2hvcnRfc2l0ZV91cmwnLCRzaG9ydF9zaXRlX3VybCwn
JywnJywnJywnJywnJywnYXJjX3Nob3J0X3NpdGVfdXJsJykpLAogICAgICAgICAgICAgICAg
ICAgICcgaWQ9ImFyY19zaG9ydF9zaXRlX3VybC1vcHRpb24iJwogICAgICAgICAgICAgICAg
KS50cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVHdpdHRlciB0YWInLCAyKSwy
KQogICAgICAgICAgICAgICAgKS50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJl
bCBmb3I9ImFyY190d2l0dGVyX3RhYiI+TG9jYXRpb24gb2YgVHdpdHRlciB0YWI8L2xhYmVs
PicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0
OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50ZChh
cmNfdHdpdHRlcl90YWJfc2VsZWN0KCdhcmNfdHdpdHRlcl90YWInLCR0YWIpKQogICAgICAg
ICAgICAgICAgKS50cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnQ2FjaGUnLCAy
KSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAogICAgICAgICAg
ICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfY2FjaGVfZGlyIj5DYWNo
ZSBkaXJlY3Rvcnk8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9
InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAg
ICAgICAgICAgICAgIC50ZChmSW5wdXQoJ3RleHQnLCdhcmNfdHdpdHRlcl9jYWNoZV9kaXIn
LCRjYWNoZV9kaXIsJycsJycsJycsJycsJycsJ2FyY190d2l0dGVyX2NhY2hlX2RpcicpKQog
ICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAogICAgICAgICAgICAgICAg
ICAgIHRkYSgKICAgICAgICAgICAgICAgICAgICAgICAgZklucHV0KCdzdWJtaXQnLCAnU3Vi
bWl0JywgZ1R4dCgnc2F2ZV9idXR0b24nKSwgJ3B1Ymxpc2gnKQogICAgICAgICAgICAgICAg
ICAgICAgICAubi5zSW5wdXQoJ3ByZWZzX3NhdmUnKQogICAgICAgICAgICAgICAgICAgICAg
ICAubi5lSW5wdXQoJ3BsdWdpbl9wcmVmcy5hcmNfdHdpdHRlcicpCiAgICAgICAgICAgICAg
ICAgICAgLCAnIGNvbHNwYW49IjIiIGNsYXNzPSJub2xpbmUiJykpKQogICAgICAgICAgICAg
ICAgLmVuZFRhYmxlKCk7CiAgICAgICAgfSBlbHNlaWYgKCAkc3RlcCE9J3JlZ2lzdGVyJyAp
IHsKICAgICAgICAgICAgJHJlZ2lzdGVyVVJMID0gYXJjX3R3aXR0ZXI6OmNhbGxiYWNrVVJM
KCRldmVudCwncmVnaXN0ZXInKTsKICAgICAgICAgICAgJGh0bWwuPSBzdGFydFRhYmxlKCds
aXN0JykuZm9ybSgKICAgICAgICAgICAgICAgIHRyKAogICAgICAgICAgICAgICAgICAgIHRk
Y3MoaGVkKCdUd2l0dGVyIGFjY291bnQgZGV0YWlscycsIDIpLDIpCiAgICAgICAgICAgICAg
ICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFi
ZWwgZm9yPSJhcmNfdHdpdHRlcl91c2VyIj5Ud2l0dGVyIHVzZXJuYW1lPC9sYWJlbD4nLAog
ICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVy
dGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoCiAgICAg
ICAgICAgICAgICAgICAgICAgICgnPGVtPnVua25vd248L2VtPiAoJwogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgLmhyZWYoJ0Nvbm5lY3QgdG8gVHdpdHRlcicsJHJlZ2lzdGVyVVJM
KS4nKScpCiAgICAgICAgICAgICAgICApKSkKICAgICAgICAgICAgICAgIC5lbmRUYWJsZSgp
OwogICAgICAgIH0KICAgIH0KCiAgICAvLyBTZXQgalF1ZXJ5IGZvciBzd2l0Y2hpbmcgb24v
b2ZmIHJlbGV2YW50IGFyY19zaG9ydF91cmwgZmllbGRzCiAgICAkanMgPSA8PDxKUwo8c2Ny
aXB0IGxhbmd1YWdlPSJqYXZhc2NyaXB0IiB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPgokKGRv
Y3VtZW50KS5yZWFkeShmdW5jdGlvbigpewogIHZhciBvbm9mZiA9ICQoJyNhcmNfc2hvcnRf
dXJsLW9uX29mZicpOwogIHZhciBhcmNfc2hvcnRfdXJsX29mZiA9ICQoJyNhcmNfc2hvcnRf
dXJsLWFyY19zaG9ydF91cmwtMCcpOwogIHZhciB1cmwgPSAkKCcjYXJjX3Nob3J0X3NpdGVf
dXJsLW9wdGlvbicpOwogIHZhciB1cmxfbWV0aG9kID0gJCgnc2VsZWN0W25hbWU9ImFyY190
d2l0dGVyX3VybF9tZXRob2QiXScpOwoKICBpZiAoYXJjX3Nob3J0X3VybF9vZmYuYXR0cign
Y2hlY2tlZCcpPT10cnVlCiAgJiYgJCgnb3B0aW9uOnNlbGVjdGVkJywgdXJsX21ldGhvZCku
dmFsKCkhPSdhcmNfdHdpdHRlcicpIHsKICAgIHVybC5oaWRlKCk7CiAgfQogICQoJ2lucHV0
Jywgb25vZmYpLmNoYW5nZShmdW5jdGlvbigpewogICAgaWYgKCQoJ29wdGlvbjpzZWxlY3Rl
ZCcsIHVybF9tZXRob2QpLnZhbCgpIT0nYXJjX3R3aXR0ZXInKSB7CiAgICAgIGFyY19zaG9y
dF91cmxfb2ZmLmF0dHIoJ2NoZWNrZWQnKT09dHJ1ZSA/IHVybC5oaWRlKCkgOiB1cmwuc2hv
dygpOwogICAgfQogIH0pOwoKICBpZiAoJCgnb3B0aW9uOnNlbGVjdGVkJywgdXJsX21ldGhv
ZCkudmFsKCk9PSdhcmNfdHdpdHRlcicpIHsKICAgIG9ub2ZmLmhpZGUoKTsgdXJsLnNob3co
KTsKICB9CiAgdXJsX21ldGhvZC5jaGFuZ2UoZnVuY3Rpb24oKXsKICAgIGlmICgkKCdvcHRp
b246c2VsZWN0ZWQnLCB1cmxfbWV0aG9kKS52YWwoKT09J2FyY190d2l0dGVyJykgewogICAg
ICBvbm9mZi50b2dnbGUoKTsgdXJsLnNob3coKTsKICAgIH0gZWxzZSB7CiAgICAgIG9ub2Zm
LnRvZ2dsZSgpOwogICAgICBhcmNfc2hvcnRfdXJsX29mZi5hdHRyKCdjaGVja2VkJyk9PXRy
dWUgPyB1cmwuaGlkZSgpIDogdXJsLnNob3coKTsKICAgIH0KICB9KQp9KTsKPC9zY3JpcHQ+
CkpTOwoKICAgIGVjaG8gJGpzLiRodG1sOwp9CgovLyBBZGQgVHdpdHRlciB0YWIgdG8gVGV4
dHBhdHRlcm4KZnVuY3Rpb24gYXJjX2FkbWluX3R3aXR0ZXIoJGV2ZW50LCRzdGVwKQp7CiAg
ICBnbG9iYWwgJHByZWZzLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRl
cl9jb25zdW1lclNlY3JldDsKCiAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJjX3R3
aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJT
ZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXQogICAgICAgICAgICAs
ICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSk7CgogICAgJHR3aXQt
PmNhY2hlRGlyKCRwcmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10pOwoKICAgICR4bWwg
PSAkdHdpdC0+Z2V0KCd1c2Vycy9zaG93JwogICAgICAgICwgYXJyYXkoJ3NjcmVlbl9uYW1l
Jz0+JHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10pKTsKICAgICR0d2l0dGVyVXNlciA9IEAk
eG1sLT54cGF0aCgnL3VzZXInKTsKICAgICR0d2l0dGVyVXNlciA9ICR0d2l0dGVyVXNlclsw
XTsKICAgICR0d2l0dGVyVXNlclVSTCA9ICdodHRwOi8vd3d3LnR3aXR0ZXIuY29tLycuJHR3
aXR0ZXJVc2VyLT5zY3JlZW5fbmFtZTsKCiAgICBpZiAoJHN0ZXA9PSJ0d2VldCIpIHsgLy8g
cG9zdCBhbiB1cGRhdGUgdG8gVHdpdHRlcgoKICAgICAgICAvLyBmZXRjaCBhbmQgY2xlYW4g
bWVzc2FnZQogICAgICAgICRtZXNzYWdlID0gc3RyaXBfdGFncyhncHMoJ21lc3NhZ2UnKSk7
CiAgICAgICAgJGNvdW50ID0gc3RybGVuKCRtZXNzYWdlKTsKCiAgICAgICAgaWYgKCRjb3Vu
dDw9MTQwICYmICRjb3VudD4wKSB7IC8vIHBvc3QgdXBkYXRlCiAgICAgICAgICAgICRyZXN1
bHQgPSAkdHdpdC0+cG9zdCgnc3RhdHVzZXMvdXBkYXRlJywgYXJyYXkoJ3N0YXR1cycgPT4g
JG1lc3NhZ2UpKTsKICAgICAgICB9IGVsc2UgeyAvLyBtZXNzYWdlIHRvbyBsb25nLCBKYXZh
U2NyaXB0IGludGVyZmFjZSBzaG91bGQgcHJldmVudCB0aGlzCiAgICAgICAgICAgICRyZXN1
bHQgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHBhZ2V0b3AoJ1R3aXR0ZXInLAogICAg
ICAgICAgICAoKCRyZXN1bHQhPWZhbHNlKT8nVHdpdHRlciB1cGRhdGVkJzonRXJyb3IgdXBk
YXRpbmcgVHdpdHRlcicpKTsKCiAgICB9IGVsc2VpZiAoJHN0ZXA9PSJkZWxldGUiKSB7IC8v
IGRlbGV0ZSBhbiB1cGRhdGUgZnJvbSBUd2l0dGVyCgogICAgICAgICRpZCA9IHN0cmlwX3Rh
Z3MoZ3BzKCdpZCcpKTsKICAgICAgICBpZiAoJGlkKSB7CiAgICAgICAgICAgICR0d2l0LT5k
ZWxldGUoJ3N0YXR1c2VzL2Rlc3Ryb3knLiRpZCk7CiAgICAgICAgICAgIHNhZmVfZGVsZXRl
KCdhcmNfdHdpdHRlcicsInR3ZWV0X2lkID0gJGlkIik7CiAgICAgICAgfQoKICAgICAgICBw
YWdldG9wKCdUd2l0dGVyJywnVHdpdHRlciB1cGRhdGVkJyk7CgogICAgfSBlbHNlIHsKCiAg
ICAgICAgcGFnZXRvcCgnVHdpdHRlcicpOwoKICAgIH0KCiAgICAvLyBQcmVwYXJlIEphdmFT
Y3JpcHQgdG8gY3JlYXRlIFR3aXR0ZXIgdXBkYXRlIGludGVyZmFjZQoKICAgICRqcyA9ICc8
c2NyaXB0IGxhbmd1YWdlPSJqYXZhc2NyaXB0IiB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPic7
CiAgICAkanMuPSAiJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXsKICAgICAgICAgICAg
dmFyIGNvdW50ZXJTdHlsZSA9ICdmb250LXdlaWdodDpib2xkO2Zsb2F0OnJpZ2h0O2ZvbnQt
c2l6ZToyZW07bGluZS1oZWlnaHQ6MS4yZW07JzsKICAgICAgICAgICAgJCgnI3R3ZWV0Y291
bnQnKS5hdHRyKCdzdHlsZScsIGNvdW50ZXJTdHlsZSsnY29sb3I6I2NjYzsnKTsKICAgICAg
ICAgICAgJCgnI21lc3NhZ2UnKS5rZXl1cChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAg
IHZhciBjb3VudCA9IDE0MC0kKCcjbWVzc2FnZScpLnZhbCgpLmxlbmd0aDsKICAgICAgICAg
ICAgICAgICQoJyN0d2VldGNvdW50JykuaHRtbChjb3VudCsnJyk7IC8vIGhhY2sgdG8gZm9y
Y2Ugb3V0cHV0IG9mIDAKICAgICAgICAgICAgICAgIGlmIChjb3VudDwwKSB7CiAgICAgICAg
ICAgICAgICAgICAgJCgnaW5wdXQucHVibGlzaCcpLmF0dHIoJ2Rpc2FibGVkJywgJ2Rpc2Fi
bGVkJyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICQo
J2lucHV0LnB1Ymxpc2gnKS5hdHRyKCdkaXNhYmxlZCcsICcnKTsKICAgICAgICAgICAgICAg
IH0KICAgICAgICAgICAgICAgIGlmIChjb3VudDwwKSB7CiAgICAgICAgICAgICAgICAgICAg
JCgnI3R3ZWV0Y291bnQnKS5hdHRyKCdzdHlsZScsIGNvdW50ZXJTdHlsZSsnY29sb3I6I2Yw
MDsnKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY291bnQ8MTApIHsKICAgICAgICAg
ICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0eWxlJywgY291bnRlclN0eWxl
Kydjb2xvcjojMDAwOycpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg
ICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0eWxlJywgY291bnRlclN0eWxlKydj
b2xvcjojY2NjOycpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAg
IH0pOyI7CiAgICAkanMuPSAiPC9zY3JpcHQ+IjsKCiAgICAkb3V0ID0gJyc7CiAgICAkeG1s
ID0gJHR3aXQtPmdldCgnc3RhdHVzZXMvdXNlcl90aW1lbGluZScKICAgICAgICAsIGFycmF5
KCdzY3JlZW5fbmFtZSc9PiRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLCdjb3VudCc9PjI1
KSk7CiAgICAkdHdlZXRzID0gQCR4bWwtPnhwYXRoKCcvc3RhdHVzZXMvc3RhdHVzJyk7CiAg
ICBpZiAoJHR3ZWV0cykgZm9yZWFjaCAoJHR3ZWV0cyBhcyAkdHdlZXQpIHsKICAgICAgICAk
dGltZSA9IHN0cnRvdGltZShodG1sZW50aXRpZXMoJHR3ZWV0LT5jcmVhdGVkX2F0KSk7CiAg
ICAgICAgJGRhdGUgPSBzYWZlX3N0cmZ0aW1lKCRwcmVmc1snYXJjaGl2ZV9kYXRlZm9ybWF0
J10sJHRpbWUpOwogICAgICAgICRvdXQuPSB0cih0ZCgkZGF0ZSwnc3BhbicpCiAgICAgICAg
ICAgIC50ZChhcmNfVHdpdHRlcjo6bWFrZUxpbmtzKGh0bWxlbnRpdGllcygkdHdlZXQtPnRl
eHQKICAgICAgICAgICAgICAgICwgRU5UX1FVT1RFUywnVVRGLTgnKSkpCiAgICAgICAgICAg
IC50ZChkTGluaygnYXJjX2FkbWluX3R3aXR0ZXInLCdkZWxldGUnLCdpZCcsJHR3ZWV0LT5p
ZCwnJykpCiAgICAgICAgICAgICk7CiAgICB9CgogICAgJGh0bWwgPSBzdGFydFRhYmxlKCdl
ZGl0JykKICAgICAgICAgICAgLnRyKHRkKAogICAgICAgICAgICBncmFmKCc8aW1nIHNyYz0i
Jy4kdHdpdHRlclVzZXItPnByb2ZpbGVfaW1hZ2VfdXJsLiciIGFsdD0iVHdpdHRlciBhdmF0
YXIiIC8+JwogICAgICAgICAgICAsJyBzdHlsZT0iZmxvYXQ6bGVmdDtwYWRkaW5nOjJweDsi
JykKICAgICAgICAgICAgLmdyYWYoaHJlZigkdHdpdHRlclVzZXItPm5hbWUsJHR3aXR0ZXJV
c2VyVVJMKSwnIHN0eWxlPSJmb250LXNpemU6MS4yZW07Zm9udC13ZWlnaHQ6Ym9sZDsiJykK
ICAgICAgICAgICAgLmdyYWYoaHJlZigkdHdpdHRlclVzZXItPmZyaWVuZHNfY291bnQuJyBm
b2xsb3dpbmcnLCR0d2l0dGVyVXNlclVSTC4nL2ZvbGxvd2luZycpCiAgICAgICAgICAgIC4n
LCAnLmhyZWYoJHR3aXR0ZXJVc2VyLT5mb2xsb3dlcnNfY291bnQuJyBmb2xsb3dlcnMnLCR0
d2l0dGVyVXNlclVSTC4nL2ZvbGxvd2VycycpCiAgICAgICAgICAgIC4nLCAnLmhyZWYoJHR3
aXR0ZXJVc2VyLT5zdGF0dXNlc19jb3VudC4nIHVwZGF0ZXMnLCR0d2l0dGVyVXNlclVSTCkp
KSkKICAgICAgICAgICAgLnRyKHRkKGZvcm0oCiAgICAgICAgICAgIGdyYWYoIlVwZGF0ZSBU
d2l0dGVyLi4uPHNwYW4gaWQ9J3R3ZWV0Y291bnQnIHN0eWxlPSdmb250LXdlaWdodDpib2xk
O2Zsb2F0OnJpZ2h0Oyc+MTQwPC9zcGFuPiIpCiAgICAgICAgICAgIC50ZXh0X2FyZWEoJ21l
c3NhZ2UnLCc1MCcsJzU1MCcsJycsJ21lc3NhZ2UnKQogICAgICAgICAgICAuZUlucHV0KCdh
cmNfYWRtaW5fdHdpdHRlcicpCiAgICAgICAgICAgIC5zSW5wdXQoJ3R3ZWV0JykuYnIKICAg
ICAgICAgICAgLmZJbnB1dCgnc3VibWl0JywndXBkYXRlJyxnVHh0KCdVcGRhdGUnKSwncHVi
bGlzaCcpCiAgICAgICAgKSkpCiAgICAgICAgLmVuZFRhYmxlKCk7CgogICAgLy8gQXR0YWNo
IHJlY2VudCBUd2l0dGVyIHVwZGF0ZXMKCiAgICAkaHRtbC49IHN0YXJ0VGFibGUoJ2xpc3Qn
LCcnLCcnLCcnLCc5MCUnKQogICAgICAgIC4kb3V0CiAgICAgICAgLmVuZFRhYmxlKCk7Cgog
ICAgLy8gT3V0cHV0IEphdmFTY3JpcHQgYW5kIEhUTUwKCiAgICBlY2hvICRqcy4kaHRtbDsK
fQoKLy8gQWRkIFR3aXR0ZXIgb3B0aW9ucyB0byBhcnRpY2xlIGFydGljbGUgc2NyZWVuCmZ1
bmN0aW9uIGFyY19hcHBlbmRfdHdpdHRlcigkZXZlbnQsICRzdGVwLCAkZGF0YSwgJHJzMSkK
ewogICAgZ2xvYmFsICRwcmVmcywgJGFyY190d2l0dGVyOwogICAgJHByZWZpeCA9IHRyaW0o
Z3BzKCdhcmNfdHdpdHRlcl9wcmVmaXgnKSk7CiAgICAkcHJlZml4ID0gKCRwcmVmaXgpID8g
JHByZWZpeCA6ICRwcmVmc1snYXJjX3R3aXR0ZXJfcHJlZml4J107CiAgICAkc3VmZml4ID0g
dHJpbShncHMoJ2FyY190d2l0dGVyX3N1ZmZpeCcpKTsKCiAgICBpZiAoJHJzMVsnSUQnXSkg
ewogICAgICAgICRzcWwgPSAiU0VMRUNUIHR3ZWV0X2lkLHR3ZWV0IEZST00gIi5QRlguImFy
Y190d2l0dGVyIFdIRVJFIGFydGljbGVfaWQ9Ii4kcnMxWydJRCddLiI7IjsKICAgICAgICAk
cnMyID0gc2FmZV9xdWVyeSgkc3FsKTsgJHJzMiA9IG5leHRSb3coJHJzMik7CiAgICB9IGVs
c2UgeyAvLyBuZXcgYXJ0aWNsZQogICAgICAgICRyczIgPSAnJzsKICAgIH0KCiAgICBpZiAo
JHJzMVsnSUQnXSAmJiAkcnMyWyd0d2VldF9pZCddKSB7CiAgICAgICAgJGNvbnRlbnQgPSBh
cmNfVHdpdHRlcjo6bWFrZUxpbmtzKCRyczJbJ3R3ZWV0J10pOwogICAgICAgIHJldHVybiAk
ZGF0YS5maWVsZHNldCgkY29udGVudCwgJ1R3aXR0ZXIgdXBkYXRlJywgJ2FyY190d2l0dGVy
Jyk7CiAgICB9IGVsc2UgewogICAgICAgICR2YXIgPSBncHMoJ2FyY190d2VldF90aGlzJyk7
CiAgICAgICAgJHZhciA9ICgkcnMxWydJRCddJiYhJHZhcikgPyAwIDogJHByZWZzWydhcmNf
dHdpdHRlcl90d2VldF9kZWZhdWx0J107CiAgICAgICAgJGNvbnRlbnQgID0gdGFnKHllc25v
UmFkaW8oJ2FyY190d2VldF90aGlzJywgJHZhciwgJycsICdhcmNfdHdlZXRfdGhpcycpLCdw
Jyk7CiAgICAgICAgJGNvbnRlbnQgLj0gdGFnKGhyZWYoJ09wdGlvbnMnLCcjYXJjX3R3aXR0
ZXJfb3B0aW9ucycpLCdwJywnIGNsYXNzPSJwbGFpbiBsZXZlciIgc3R5bGU9Im1hcmdpbi10
b3A6NXB4OyInKTsKICAgICAgICAkY29udGVudCAuPSB0YWcodGFnKHRhZygnVHdlZXQgcHJl
Zml4JywnbGFiZWwnLCAnIGZvcj0iYXJjX3R3aXR0ZXJfcHJlZml4IicpCiAgICAgICAgICAg
IC5mSW5wdXQoJ3RleHQnLCdhcmNfdHdpdHRlcl9wcmVmaXgnLCRwcmVmaXgsJ2VkaXQnLCcn
LCcnLCcyMicsJycsJ2FyY190d2l0dGVyX3ByZWZpeCcpLCdwJykKICAgICAgICAgICAgLnRh
Zyh0YWcoJ1R3ZWV0IHN1ZmZpeCAoZWcgI2hhc2h0YWdzKScsJ2xhYmVsJywgJyBmb3I9ImFy
Y190d2l0dGVyX3N1ZmZpeCInKQogICAgICAgICAgICAuZklucHV0KCd0ZXh0JywnYXJjX3R3
aXR0ZXJfc3VmZml4Jywkc3VmZml4LCdlZGl0JywnJywnJywnMjInLCcnLCdhcmNfdHdpdHRl
cl9zdWZmaXgnKSwncCcpCiAgICAgICAgICAgICwnZGl2JywnIGlkPSJhcmNfdHdpdHRlcl9v
cHRpb25zIiBjbGFzcz0idG9nZ2xlIiBzdHlsZT0iZGlzcGxheTpub25lIicpOwogICAgICAg
IGlmIChpc3NldCgkYXJjX3R3aXR0ZXJbJ2Vycm9yJ10pKSB7CiAgICAgICAgICAgICRjb250
ZW50IC49ICc8cD4nLiRhcmNfdHdpdHRlclsnZXJyb3InXS4nPC9wPic7CiAgICAgICAgfQog
ICAgICAgIHJldHVybiAkZGF0YS5maWVsZHNldCgkY29udGVudCwgJ1VwZGF0ZSBUd2l0dGVy
JywgJ2FyY190d2l0dGVyJyk7CiAgICB9Cgp9CgovLyBVcGRhdGUgVHdpdHRlciB3aXRoIHBv
c3RlZCBhcnRpY2xlCmZ1bmN0aW9uIGFyY19hcnRpY2xlX3R3ZWV0KCRldmVudCwkc3RlcCkK
ewogICAgZ2xvYmFsICRwcmVmcywgJGFyY190d2l0dGVyLCAkYXJjX3R3aXR0ZXJfY29uc3Vt
ZXJLZXkKICAgICAgICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiAgICAkYXJ0
aWNsZV9pZCA9IGVtcHR5KCRHTE9CQUxTWydJRCddKSA/IGdwcygnSUQnKSA6ICRHTE9CQUxT
WydJRCddOwogICAgaWYgKCFlbXB0eSgkYXJ0aWNsZV9pZCkpIHsKCiAgICAgICAgaW5jbHVk
ZV9vbmNlIHR4cGF0aC4nL3B1Ymxpc2gvdGFnaGFuZGxlcnMucGhwJzsKCiAgICAgICAgJGFy
dGljbGUgPSBzYWZlX3JvdygiSUQsIFRpdGxlLCBTZWN0aW9uLCBQb3N0ZWQiLCAndGV4dHBh
dHRlcm4nLAogICAgICAgICAgICAiSUQ9eyRhcnRpY2xlX2lkfSBBTkQgU3RhdHVzPTQgQU5E
IG5vdygpPj1Qb3N0ZWQiKTsKCiAgICAgICAgaWYgKCRhcnRpY2xlICYmIGdwcygnYXJjX3R3
ZWV0X3RoaXMnKSkgeyAvLyB0d2VldCBhcnRpY2xlCgogICAgICAgICAgICAvLyBOZWVkIHRv
IG1hbnVhbGx5IHVwZGF0ZSB0aGUgJ1VSTCBvbmx5IHRpdGxlJyBiZWZvcmUgYnVpbGRpbmcg
dGhlCiAgICAgICAgICAgIC8vIFVSTAogICAgICAgICAgICAkYXJ0aWNsZVsndXJsX3RpdGxl
J10gPSBncHMoJ3VybF90aXRsZScpOwogICAgICAgICAgICAvLyBNYWtlIHNob3J0IFVSTAog
ICAgICAgICAgICAkdXJsID0gcGVybWxpbmt1cmwoJGFydGljbGUpOwogICAgICAgICAgICAk
c2hvcnRfdXJsID0gYXJjX3Nob3J0ZW5fdXJsKCR1cmwsJHByZWZzWydhcmNfdHdpdHRlcl91
cmxfbWV0aG9kJ10sCiAgICAgICAgICAgICAgICBhcnJheSgnaWQnPT4kYXJ0aWNsZV9pZCkp
OwoKICAgICAgICAgICAgaWYgKCEkc2hvcnRfdXJsKSB7IC8vIEZhaWxlZCB0byBvYnRhaW4g
YSBzaG9ydGVuZWQgVVJMLCBkbyBub3QgdHdlZXQhCiAgICAgICAgICAgICAgICAkYXJjX3R3
aXR0ZXJbJ2Vycm9yJ10gPSAnVW5hYmxlIHRvIG9idGFpbiBhIHNob3J0IFVSTCBmb3IgdGhp
cyBhcnRpY2xlLic7CgogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAg
ICB9CgogICAgICAgICAgICAvLyBDb25zdHJ1Y3QgVHdpdHRlciB1cGRhdGUKICAgICAgICAg
ICAgJHByZWZpeCAgPSB0cmltKGdwcygnYXJjX3R3aXR0ZXJfcHJlZml4JykpOwogICAgICAg
ICAgICAkcHJlX2xlbiA9IHN0cmxlbigkcHJlZml4KTsKICAgICAgICAgICAgJHByZWZpeCAg
PSAoJHByZWZpeCAmJiAkcHJlX2xlbjw9MjApID8gJHByZWZpeC4nICcgOiAnJzsKICAgICAg
ICAgICAgJHN1ZmZpeCAgPSB0cmltKGdwcygnYXJjX3R3aXR0ZXJfc3VmZml4JykpOwogICAg
ICAgICAgICAkc3VmX2xlbiA9IHN0cmxlbigkc3VmZml4KTsKICAgICAgICAgICAgJHN1ZmZp
eCAgPSAoJHN1ZmZpeCAmJiAkc3VmX2xlbjw9NDApID8gJyAnLiRzdWZmaXggOiAnJzsKICAg
ICAgICAgICAgJHVybF9sZW4gPSBzdHJsZW4oJHNob3J0X3VybCkrMTsgLy8gY291bnQgVVJM
IGxlbmd0aCArIDEgZm9yIHByZWZpeGVkIHNwYWNlCiAgICAgICAgICAgIGlmICgkcHJlZml4
KSAkcHJlX2xlbiArPSAxOwogICAgICAgICAgICBpZiAoJHN1ZmZpeCkgJHN1Zl9sZW4gKz0g
MTsKICAgICAgICAgICAgaWYgKChzdHJsZW4oJGFydGljbGVbJ1RpdGxlJ10pKyR1cmxfbGVu
KyRwcmVfbGVuKyRzdWZfbGVuKT4xNDApIHsKICAgICAgICAgICAgICAgICRhcnRpY2xlWydU
aXRsZSddID0gc3Vic3RyKCRhcnRpY2xlWydUaXRsZSddLDAsMTM1LSR1cmxfbGVuLSRwcmVf
bGVuLSRzdWZfbGVuKS4nLi4uJzsKICAgICAgICAgICAgfQogICAgICAgICAgICAkdHdlZXQg
PSAkcHJlZml4LiRhcnRpY2xlWydUaXRsZSddLiIgIi4kc2hvcnRfdXJsLiRzdWZmaXg7Cgog
ICAgICAgICAgICAvLyBVcGRhdGUgVHdpdHRlcgogICAgICAgICAgICAkdHdpdCA9IG5ldyBh
cmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgICAgICwg
JGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vz
c1Rva2VuJ10KICAgICAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NU
b2tlblNlY3JldCddKTsKICAgICAgICAgICAgJHJlc3VsdCA9ICR0d2l0LT5wb3N0KCdzdGF0
dXNlcy91cGRhdGUnLCBhcnJheSgnc3RhdHVzJyA9PiAkdHdlZXQpKTsKCiAgICAgICAgICAg
ICR0d2VldF9pZCA9IChpc19vYmplY3QoJHJlc3VsdCkpID8gJHJlc3VsdFswXS0+aWQgOiAw
OwoKICAgICAgICAgICAgaWYgKCR0d2VldF9pZCkgewoKICAgICAgICAgICAgICAgICR0d2Vl
dCA9IGFkZHNsYXNoZXMoJHR3ZWV0KTsKCiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgYXJj
X3R3aXR0ZXIgdGFibGUgd2l0aCB0d2VldAogICAgICAgICAgICAgICAgJHNxbCA9ICJJTlNF
UlQgSU5UTyAiLlBGWC4iYXJjX3R3aXR0ZXIgKGFydGljbGVfaWQsdHdlZXRfaWQsdHdlZXQs
dGlueXVybCkgIjsKICAgICAgICAgICAgICAgICRzcWwuPSAiVkFMVUVTKCRhcnRpY2xlX2lk
LCR0d2VldF9pZCxcIiR0d2VldFwiLCckc2hvcnRfdXJsJyk7IjsKICAgICAgICAgICAgICAg
IHNhZmVfcXVlcnkoJHNxbCk7CgogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CgogICAg
ICAgICAgICB9IGVsc2UgewoKICAgICAgICAgICAgICAgICRhcmNfdHdpdHRlclsnZXJyb3In
XSA9ICdUd2l0dGVyIHJlc3BvbnNlOiAnCiAgICAgICAgICAgICAgICAgICAgLiR0d2l0LT5o
dHRwX2NvZGU7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICB9
CgogICAgICAgIH0KCiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwoKfQoKLyoKICogU2hvcnRl
biBVUkxzIHVzaW5nIHZhcmlvdXMgbWV0aG9kcwogKi8KCmZ1bmN0aW9uIGFyY19zaG9ydGVu
X3VybCgkdXJsLCAkbWV0aG9kPScnLCAkYXR0cz1hcnJheSgpKQp7CiAgZ2xvYmFsICRwcmVm
czsKCiAgJGNoID0gY3VybF9pbml0KCk7CiAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX0hF
QURFUiwgMCk7CiAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCB0
cnVlKTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVElNRU9VVCwgMTApOwoKICBzd2l0
Y2ggKCRtZXRob2QpIHsKICAgIGNhc2UgJ3NtZCc6IC8vIGNyZWF0ZSBhIHNob3J0ZW5lZCBV
UkwgdXNpbmcgU01EIFNob3J0IFVSTAogICAgICByZXR1cm4gKCRhdHRzWydpZCddKSA/IGh1
LiRhdHRzWydpZCddIDogZmFsc2U7IGJyZWFrOwogICAgY2FzZSAnYXJjX3R3aXR0ZXInOiAv
LyBuYXRpdmUgVVJMIHNob3J0ZW5pbmcKCiAgICAgIHJldHVybiAoJGF0dHNbJ2lkJ10pID8g
UFJPVE9DT0wuJHByZWZzWydhcmNfc2hvcnRfc2l0ZV91cmwnXS4nLycuJGF0dHNbJ2lkJ10g
OiBmYWxzZTsKICAgICAgYnJlYWs7CgogICAgY2FzZSAnaXNnZCc6CgogICAgICAkdSA9ICdo
dHRwOi8vaXMuZ2QvYXBpLnBocD9sb25ndXJsPScudXJsZW5jb2RlKCR1cmwpOwogICAgICBj
dXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVVJMLCAkdSk7CgogICAgICAkdGlueXVybCA9IGN1
cmxfZXhlYygkY2gpOwogICAgICBpZiAoJHRpbnl1cmwhPSdFcnJvcicgJiYgJHRpbnl1cmwh
PScnKSB7CiAgICAgICAgcmV0dXJuICR0aW55dXJsOwogICAgICB9IGVsc2UgewogICAgICAg
IHRyaWdnZXJfZXJyb3IoJ2FyY190d2l0dGVyIGZhaWxlZCB0byBnZXQgYSBpcy5nZCBVUkwg
Zm9yICcKICAgICAgICAgICAgLiR1cmwsRV9VU0VSX1dBUk5JTkcpOwogICAgICB9CiAgICAg
IGJyZWFrOwoKICAgIGNhc2UgJ3Rpbnl1cmwnOiBkZWZhdWx0OiAvLyBjcmVhdGUgYSBzaG9y
dGVuZWQgVVJMIHVzaW5nIFRpbnlVUkwKCiAgICAgICR1ID0gJ2h0dHA6Ly90aW55dXJsLmNv
bS9hcGktY3JlYXRlLnBocD91cmw9Jy51cmxlbmNvZGUoJHVybCk7CiAgICAgIGN1cmxfc2V0
b3B0KCRjaCwgQ1VSTE9QVF9VUkwsICR1KTsKICAgICAgJHRpbnl1cmwgPSBjdXJsX2V4ZWMo
JGNoKTsKICAgICAgaWYgKCR0aW55dXJsIT0nRXJyb3InICYmICR0aW55dXJsIT0nJykgewog
ICAgICAgIHJldHVybiAkdGlueXVybDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0cmlnZ2Vy
X2Vycm9yKCdhcmNfdHdpdHRlciBmYWlsZWQgdG8gZ2V0IGEgVGlueVVSTCBmb3IgJy4kdXJs
LEVfVVNFUl9XQVJOSU5HKTsKICAgICAgfQoKICB9CgogIHJldHVybiBmYWxzZTsgLy8gZmFp
bAoKfQoKLyoKICogU2hvcnRlbmVkIFVSTCByZWRpcmVjdCBiYXNlZCBvbiBzbWRfc2hvcnRf
dXJsCiAqLwpmdW5jdGlvbiBhcmNfc2hvcnRfdXJsX3JlZGlyZWN0KCRldmVudCwgJHN0ZXAp
IHsKICBnbG9iYWwgJHByZWZzOwoKICAkaGF2ZV9pZCA9IDA7CgogIC8vIENoZWNrIGlmIHRo
ZXJlIGlzIGFuIGF2YWlsYWJsZSBzaG9ydCBzaXRlIHVybCBhbmQgaWYgaXQgaXMgYmVpbmcg
dXNlZCBpbgogIC8vIHRoaXMgaW5zdGFuY2UKICAkc2hvcnRfc2l0ZV91cmwgPSAkcHJlZnNb
J2FyY19zaG9ydF9zaXRlX3VybCddOwogIGlmICgkc2hvcnRfc2l0ZV91cmwpIHsKICAgICRz
aG9ydF9zaXRlX3VybCA9IFBST1RPQ09MLiRzaG9ydF9zaXRlX3VybC4nLyc7CiAgICAkdXJs
X3BhcnRzID0gcGFyc2VfdXJsKCRzaG9ydF9zaXRlX3VybCk7CiAgICAkcmUgPSAnI14nLiR1
cmxfcGFydHNbJ3BhdGgnXS4nKFswLTldLiopIyc7CiAgICAkaGF2ZV9pZCA9IHByZWdfbWF0
Y2goJHJlLCAkX1NFUlZFUlsnUkVRVUVTVF9VUkknXSwgJG0pOwogIH0KCiAgLy8gRmFsbCBi
YWNrIHRvIHN0YW5kYXJkIHNpdGUgdXJsIChzbWRfc2hvcnRfdXJsIGJlaGF2aW91cikKICBp
ZiAoJGhhdmVfaWQpIHsKICAgICR1cmxfcGFydHMgPSBwYXJzZV91cmwoaHUpOwogICAgJHJl
ID0gJyNeJy4kdXJsX3BhcnRzWydwYXRoJ10uJyhbMC05XS4qKSMnOwogICAgJGhhdmVfaWQg
PSBwcmVnX21hdGNoKCRyZSwgJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ10sICRtKTsKICB9Cgog
IC8vIERvIHRoZSByZWRpcmVjdCBpZiB3ZSd2ZSBnb3QgYW4gYXJ0aWNsZSBpZAogIGlmICgk
aGF2ZV9pZCkgewoJICAkaWQgPSAkbVsxXTsKCSAgJHBlcm1saW5rID0gcGVybWxpbmt1cmxf
aWQoJGlkKTsKCgkgIGlmICgkcGVybWxpbmspIHsKCQkgIG9iX2VuZF9jbGVhbigpOwoKCQkg
IC8vIFN0dXBpZCwgb3ZlciB0aGUgdG9wIGhlYWRlciBzZXR0aW5nIGZvciBJRQoJCSAgaGVh
ZGVyKCJTdGF0dXM6IDMwMSIpOwoJCSAgaGVhZGVyKCJIVFRQLzEuMCAzMDEgTW92ZWQgUGVy
bWFuZW50bHkiKTsKCQkgIGhlYWRlcigiTG9jYXRpb246ICIuJHBlcm1saW5rLCBUUlVFLCAz
MDEpOwoKCQkgIC8vIEluIGNhc2UgdGhlIGhlYWRlcigpIG1ldGhvZCBmYWlscywgZmFsbCBi
YWNrIG9uIGEgY2xhc3NpYyByZWRpcmVjdAoJCSAgZWNobyAnPGh0bWw+PGhlYWQ+PE1FVEEg
SFRUUC1FUVVJVj0iUmVmcmVzaCIgQ09OVEVOVD0iMDtVUkw9JwoJCSAgICAuJHBlcm1saW5r
LiciPjwvaGVhZD48Ym9keT48L2JvZHk+PC9odG1sPic7CgkJICBkaWUoKTsKCSAgfQogIH0K
Cn0KCi8qCiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiovCgpjbGFzcyBhcmNfdHdpdHRl
ciBleHRlbmRzIFR3aXR0ZXJPQXV0aCB7CiAgICAvLyBDYWNoaW5nIHZhcmlhYmxlcwogICAg
cHJpdmF0ZSAkX2NhY2hlID0gdHJ1ZTsKICAgIHByaXZhdGUgJF9jYWNoZV9kaXIgPSAnLi90
bXAnOwogICAgcHJpdmF0ZSAkX2NhY2hlX3RpbWUgPSAxODAwOyAvLyAzMCBtaW51dGUgY2Fj
aGUKCiAgICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkY29uc3VtZXJfa2V5LCAkY29uc3VtZXJf
c2VjcmV0LCAkb2F1dGhfdG9rZW4gPSBOVUxMCiAgICAgICAgLCAkb2F1dGhfdG9rZW5fc2Vj
cmV0ID0gTlVMTCkKICAgIHsKICAgICAgICBwYXJlbnQ6Ol9fY29uc3RydWN0KCRjb25zdW1l
cl9rZXksICRjb25zdW1lcl9zZWNyZXQsICRvYXV0aF90b2tlbgogICAgICAgICAgICAsICRv
YXV0aF90b2tlbl9zZWNyZXQpOwogICAgICAgICR0aGlzLT5mb3JtYXQgPSAneG1sJzsKICAg
ICAgICAkdGhpcy0+dGltZW91dCA9IDE1OwogICAgICAgICR0aGlzLT5jb25uZWN0dGltZW91
dCA9IDE1OwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjYWxsYmFja1VSTCgkZXZlbnQs
JHN0ZXApCiAgICB7CiAgICAgICAgcmV0dXJuIHByZWdfcmVwbGFjZSgnL1w/LiovJywgJycs
UFJPVE9DT0wuJF9TRVJWRVJbJ1NFUlZFUl9OQU1FJ10uJF9TRVJWRVJbJ1JFUVVFU1RfVVJJ
J10pCiAgICAgICAgICAuJz9ldmVudD0nLiRldmVudC4nJmFtcDtzdGVwPScuJHN0ZXA7CiAg
ICB9CgogICAgLy8gY3JlYXRlIFR3aXR0ZXIgYW5kIGV4dGVybmFsIGxpbmtzIGluIHRleHQK
ICAgIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gbWFrZUxpbmtzKCR0ZXh0KQogICAgewogICAg
ICAgICR1cmwgPSAnL1xiKGh0dHB8aHR0cHN8ZnRwKTpcL1wvKFtBLVowLTldW0EtWjAtOV8t
XSooPzpcLltBLVowLTldW0EtWjAtOV8tXSopKyk6PyhcZCspP1wvPyhbXC9cdytcLl0rKVxi
L2knOwogICAgICAgICR0ZXh0ID0gcHJlZ19yZXBsYWNlKCR1cmwsICI8YSBocmVmPSckMCc+
JDA8L2E+IiwgJHRleHQpOwogICAgICAgICR1cmwgPSAnL1xiKF58XHMpd3d3LihbYS16X0Et
WjAtOV0rKSgoXC5bYS16XSspKylcYi9pJzsKICAgICAgICAkdGV4dCA9IHByZWdfcmVwbGFj
ZSgkdXJsLCAiPGEgaHJlZj0naHR0cDovL3d3dy4kMiQzJz53d3cuJDIkMzwvYT4iLCAkdGV4
dCk7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2UoIi8oXnxccylAKFthLXpfQS1aMC05
XSspLyIsCiAgICAgICAgICAgICIkMUA8YSBocmVmPSdodHRwOi8vdHdpdHRlci5jb20vJDIn
PiQyPC9hPiIsJHRleHQpOwogICAgICAgICR0ZXh0ID0gcHJlZ19yZXBsYWNlKCIvKF58XHMp
KFwjKFthLXpfQS1aMC05Ol8tXSspKS8iLAogICAgICAgICAgICAiJDE8YSBocmVmPSdodHRw
Oi8vdHdpdHRlci5jb20vc2VhcmNoP3E9JTIzJDMnPiQyPC9hPiIsJHRleHQpOwogICAgICAg
IHJldHVybiAkdGV4dDsKICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGdldCgkdXJsLCAkcGFy
YW1zID0gYXJyYXkoKSkKICAgIHsKICAgICAgICAkYXBpX3VybCA9IG1kNSgkdXJsLnVybGVu
Y29kZShzZXJpYWxpemUoJHBhcmFtcykpKTsKICAgICAgICAkZGF0YSA9ICcnOwoKICAgICAg
ICBpZiAoJHRoaXMtPl9jYWNoZSkgeyAvLyBjaGVjayBmb3IgY2FjaGVkIHhtbAoKICAgICAg
ICAgICAgJGRhdGEgPSAkdGhpcy0+X3JldHJpZXZlQ2FjaGUoJGFwaV91cmwpOwoKICAgICAg
ICB9CiAgICAgICAgaWYgKGVtcHR5KCRkYXRhKSkgewogICAgICAgICAgICAkZGF0YSA9IHBh
cmVudDo6Z2V0KCR1cmwsICRwYXJhbXMpOwogICAgICAgICAgICBpZiAoJHRoaXMtPmh0dHBf
Y29kZT09PTIwMCAmJiAkeG1sPXNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSkpIHsgLy8g
c2F2ZSBjYWNoZQogICAgICAgICAgICAgICAgJGZpbGUgPSAkdGhpcy0+X2NhY2hlX2Rpci4n
LycuJGFwaV91cmw7CiAgICAgICAgICAgICAgICBmaWxlX3B1dF9jb250ZW50cygkZmlsZSwk
ZGF0YSxMT0NLX0VYKTsKICAgICAgICAgICAgICAgIHJldHVybiAkeG1sOwogICAgICAgICAg
ICB9IGVsc2UgeyAvLyBmYWlsZWQgdG8gcmV0cmlldmUgZGF0YSBmcm9tIFR3aXR0ZXIKCiAg
ICAgICAgICAgICAgICBpZiAoJHRoaXMtPl9jYWNoZSkgeyAvLyBhdHRlbXB0IHRvIGZvcmNl
IGNhY2hlZCB4bWwgcmV0dXJuCgogICAgICAgICAgICAgICAgICAgICRkYXRhID0gJHRoaXMt
Pl9yZXRyaWV2ZUNhY2hlKCRhcGlfdXJsLHRydWUpOwogICAgICAgICAgICAgICAgICAgIGlm
ICgkZGF0YSkgcmV0dXJuIEBzaW1wbGV4bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwoKICAgICAg
ICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAg
ICB9CiAgICAgICAgfSBlbHNlIHsgLy8gcmV0dXJuIGNhY2hlZCB4bWwKICAgICAgICAgICAg
cmV0dXJuIEBzaW1wbGV4bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwogICAgICAgIH0KICAgIH0g
Ly9lbmQgZ2V0KCkKCiAgICBmdW5jdGlvbiBwb3N0KCR1cmwsICRwYXJhbXMgPSBhcnJheSgp
KQogICAgewogICAgICAgICRkYXRhID0gcGFyZW50Ojpwb3N0KCR1cmwsJHBhcmFtcyk7CiAg
ICAgICAgcmV0dXJuIHNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSk7CiAgICB9CgogICAg
ZnVuY3Rpb24gZGVsZXRlKCR1cmwsICRwYXJhbXMgPSBhcnJheSgpKQogICAgewogICAgICAg
ICRkYXRhID0gcGFyZW50OjpkZWxldGUoJHVybCwkcGFyYW1zKTsKICAgICAgICByZXR1cm4g
c2ltcGxleG1sX2xvYWRfc3RyaW5nKCRkYXRhKTsKICAgIH0KCiAgICAvLyBDYWNoZSBtZXRo
b2RzCgogICAgcHVibGljIGZ1bmN0aW9uIHNldENhY2hpbmcoJGNhY2hlPXRydWUpCiAgICB7
CiAgICAgICAgJHRoaXMtPl9jYWNoZSA9ICgkY2FjaGUpID8gdHJ1ZSA6IGZhbHNlOwogICAg
ICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjYWNoZURpcigk
bG9jKQogICAgewogICAgICAgICR0aGlzLT5fY2FjaGVfZGlyID0gJGxvYzsKICAgICAgICBy
ZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gY2FjaGVUaW1lKCRtaW5z
KQogICAgewogICAgICAgICR0aGlzLT5fY2FjaGVfdGltZSA9ICRtaW5zKjYwOyAvLyBjb252
ZXJ0IG1pbnV0ZXMgaW50byBzZWNvbmRzCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cgog
ICAgcHJpdmF0ZSBmdW5jdGlvbiBfcmV0cmlldmVDYWNoZSgkdXJsLCRvdmVyaWRlX3RpbWVv
dXQ9ZmFsc2UpCiAgICB7CiAgICAgICAgJGZpbGUgPSAkdGhpcy0+X2NhY2hlX2Rpci4nLycu
JHVybDsKICAgICAgICBpZiAoZmlsZV9leGlzdHMoJGZpbGUpKSB7CgogICAgICAgICAgICAk
ZGlmZiA9IHRpbWUoKSAtIGZpbGVtdGltZSgkZmlsZSk7CiAgICAgICAgICAgIGlmICgkb3Zl
cmlkZV90aW1lb3V0IHx8ICRkaWZmIDwgJHRoaXMtPl9jYWNoZV90aW1lKSB7CiAgICAgICAg
ICAgICAgICByZXR1cm4gZmlsZV9nZXRfY29udGVudHMoJGZpbGUpOwogICAgICAgICAgICB9
IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9Cgog
ICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAg
ICB9Cn0KCi8qCiAqIEFicmFoYW0gV2lsbGlhbXMgKGFicmFoYW1AYWJyYWguYW0pIGh0dHA6
Ly9hYnJhaC5hbQogKgogKiBUaGUgZmlyc3QgUEhQIExpYnJhcnkgdG8gc3VwcG9ydCBPQXV0
aCBmb3IgVHdpdHRlcidzIFJFU1QgQVBJLgogKi8KCi8qKgogKiBUd2l0dGVyIE9BdXRoIGNs
YXNzCiAqLwpjbGFzcyBUd2l0dGVyT0F1dGggewogIC8qIENvbnRhaW5zIHRoZSBsYXN0IEhU
VFAgc3RhdHVzIGNvZGUgcmV0dXJuZWQuICovCiAgcHVibGljICRodHRwX2NvZGU7CiAgLyog
Q29udGFpbnMgdGhlIGxhc3QgQVBJIGNhbGwuICovCiAgcHVibGljICR1cmw7CiAgLyogU2V0
IHVwIHRoZSBBUEkgcm9vdCBVUkwuICovCiAgcHVibGljICRob3N0ID0gImh0dHBzOi8vYXBp
LnR3aXR0ZXIuY29tLzEvIjsKICAvKiBTZXQgdGltZW91dCBkZWZhdWx0LiAqLwogIHB1Ymxp
YyAkdGltZW91dCA9IDMwOwogIC8qIFNldCBjb25uZWN0IHRpbWVvdXQuICovCiAgcHVibGlj
ICRjb25uZWN0dGltZW91dCA9IDMwOwogIC8qIFZlcmlmeSBTU0wgQ2VydC4gKi8KICBwdWJs
aWMgJHNzbF92ZXJpZnlwZWVyID0gRkFMU0U7CiAgLyogUmVzcG9ucyBmb3JtYXQuICovCiAg
cHVibGljICRmb3JtYXQgPSAnanNvbic7CiAgLyogRGVjb2RlIHJldHVybmVkIGpzb24gZGF0
YS4gKi8KICBwdWJsaWMgJGRlY29kZV9qc29uID0gVFJVRTsKICAvKiBDb250YWlucyB0aGUg
bGFzdCBIVFRQIGhlYWRlcnMgcmV0dXJuZWQuICovCiAgcHVibGljICRodHRwX2luZm87CiAg
LyogU2V0IHRoZSB1c2VyYWduZXQuICovCiAgcHVibGljICR1c2VyYWdlbnQgPSAnVHdpdHRl
ck9BdXRoIHYwLjIuMC1iZXRhMic7CiAgLyogSW1tZWRpYXRlbHkgcmV0cnkgdGhlIEFQSSBj
YWxsIGlmIHRoZSByZXNwb25zZSB3YXMgbm90IHN1Y2Nlc3NmdWwuICovCiAgLy9wdWJsaWMg
JHJldHJ5ID0gVFJVRTsKCgoKCiAgLyoqCiAgICogU2V0IEFQSSBVUkxTCiAgICovCiAgZnVu
Y3Rpb24gYWNjZXNzVG9rZW5VUkwoKSAgeyByZXR1cm4gJ2h0dHBzOi8vYXBpLnR3aXR0ZXIu
Y29tL29hdXRoL2FjY2Vzc190b2tlbic7IH0KICBmdW5jdGlvbiBhdXRoZW50aWNhdGVVUkwo
KSB7IHJldHVybiAnaHR0cHM6Ly90d2l0dGVyLmNvbS9vYXV0aC9hdXRoZW50aWNhdGUnOyB9
CiAgZnVuY3Rpb24gYXV0aG9yaXplVVJMKCkgICAgeyByZXR1cm4gJ2h0dHBzOi8vdHdpdHRl
ci5jb20vb2F1dGgvYXV0aG9yaXplJzsgfQogIGZ1bmN0aW9uIHJlcXVlc3RUb2tlblVSTCgp
IHsgcmV0dXJuICdodHRwczovL2FwaS50d2l0dGVyLmNvbS9vYXV0aC9yZXF1ZXN0X3Rva2Vu
JzsgfQoKICAvKioKICAgKiBEZWJ1ZyBoZWxwZXJzCiAgICovCiAgZnVuY3Rpb24gbGFzdFN0
YXR1c0NvZGUoKSB7IHJldHVybiAkdGhpcy0+aHR0cF9zdGF0dXM7IH0KICBmdW5jdGlvbiBs
YXN0QVBJQ2FsbCgpIHsgcmV0dXJuICR0aGlzLT5sYXN0X2FwaV9jYWxsOyB9CgogIC8qKgog
ICAqIGNvbnN0cnVjdCBUd2l0dGVyT0F1dGggb2JqZWN0CiAgICovCiAgZnVuY3Rpb24gX19j
b25zdHJ1Y3QoJGNvbnN1bWVyX2tleSwgJGNvbnN1bWVyX3NlY3JldCwgJG9hdXRoX3Rva2Vu
ID0gTlVMTCwgJG9hdXRoX3Rva2VuX3NlY3JldCA9IE5VTEwpIHsKICAgICR0aGlzLT5zaGEx
X21ldGhvZCA9IG5ldyBPQXV0aFNpZ25hdHVyZU1ldGhvZF9ITUFDX1NIQTEoKTsKICAgICR0
aGlzLT5jb25zdW1lciA9IG5ldyBPQXV0aENvbnN1bWVyKCRjb25zdW1lcl9rZXksICRjb25z
dW1lcl9zZWNyZXQpOwogICAgaWYgKCFlbXB0eSgkb2F1dGhfdG9rZW4pICYmICFlbXB0eSgk
b2F1dGhfdG9rZW5fc2VjcmV0KSkgewogICAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhD
b25zdW1lcigkb2F1dGhfdG9rZW4sICRvYXV0aF90b2tlbl9zZWNyZXQpOwogICAgfSBlbHNl
IHsKICAgICAgJHRoaXMtPnRva2VuID0gTlVMTDsKICAgIH0KICB9CgoKICAvKioKICAgKiBH
ZXQgYSByZXF1ZXN0X3Rva2VuIGZyb20gVHdpdHRlcgogICAqCiAgICogQHJldHVybnMgYSBr
ZXkvdmFsdWUgYXJyYXkgY29udGFpbmluZyBvYXV0aF90b2tlbiBhbmQgb2F1dGhfdG9rZW5f
c2VjcmV0CiAgICovCiAgZnVuY3Rpb24gZ2V0UmVxdWVzdFRva2VuKCRvYXV0aF9jYWxsYmFj
ayA9IE5VTEwpIHsKICAgICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgIGlmICghZW1wdHko
JG9hdXRoX2NhbGxiYWNrKSkgewogICAgICAkcGFyYW1ldGVyc1snb2F1dGhfY2FsbGJhY2sn
XSA9ICRvYXV0aF9jYWxsYmFjazsKICAgIH0KICAgICRyZXF1ZXN0ID0gJHRoaXMtPm9BdXRo
UmVxdWVzdCgkdGhpcy0+cmVxdWVzdFRva2VuVVJMKCksICdHRVQnLCAkcGFyYW1ldGVycyk7
CiAgICAkdG9rZW4gPSBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMoJHJlcXVlc3QpOwog
ICAgJHRoaXMtPnRva2VuID0gbmV3IE9BdXRoQ29uc3VtZXIoJHRva2VuWydvYXV0aF90b2tl
biddLCAkdG9rZW5bJ29hdXRoX3Rva2VuX3NlY3JldCddKTsKICAgIHJldHVybiAkdG9rZW47
CiAgfQoKICAvKioKICAgKiBHZXQgdGhlIGF1dGhvcml6ZSBVUkwKICAgKgogICAqIEByZXR1
cm5zIGEgc3RyaW5nCiAgICovCiAgZnVuY3Rpb24gZ2V0QXV0aG9yaXplVVJMKCR0b2tlbiwg
JHNpZ25faW5fd2l0aF90d2l0dGVyID0gVFJVRSkgewogICAgaWYgKGlzX2FycmF5KCR0b2tl
bikpIHsKICAgICAgJHRva2VuID0gJHRva2VuWydvYXV0aF90b2tlbiddOwogICAgfQogICAg
aWYgKGVtcHR5KCRzaWduX2luX3dpdGhfdHdpdHRlcikpIHsKICAgICAgcmV0dXJuICR0aGlz
LT5hdXRob3JpemVVUkwoKSAuICI/b2F1dGhfdG9rZW49eyR0b2tlbn0iOwogICAgfSBlbHNl
IHsKICAgICAgIHJldHVybiAkdGhpcy0+YXV0aGVudGljYXRlVVJMKCkgLiAiP29hdXRoX3Rv
a2VuPXskdG9rZW59IjsKICAgIH0KICB9CgogIC8qKgogICAqIEV4Y2hhbmdlIHJlcXVlc3Qg
dG9rZW4gYW5kIHNlY3JldCBmb3IgYW4gYWNjZXNzIHRva2VuIGFuZAogICAqIHNlY3JldCwg
dG8gc2lnbiBBUEkgY2FsbHMuCiAgICoKICAgKiBAcmV0dXJucyBhcnJheSgib2F1dGhfdG9r
ZW4iID0+ICJ0aGUtYWNjZXNzLXRva2VuIiwKICAgKiAgICAgICAgICAgICAgICAib2F1dGhf
dG9rZW5fc2VjcmV0IiA9PiAidGhlLWFjY2Vzcy1zZWNyZXQiLAogICAqICAgICAgICAgICAg
ICAgICJ1c2VyX2lkIiA9PiAiOTQzNjk5MiIsCiAgICogICAgICAgICAgICAgICAgInNjcmVl
bl9uYW1lIiA9PiAiYWJyYWhhbSIpCiAgICovCiAgZnVuY3Rpb24gZ2V0QWNjZXNzVG9rZW4o
JG9hdXRoX3ZlcmlmaWVyID0gRkFMU0UpIHsKICAgICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsK
ICAgIGlmICghZW1wdHkoJG9hdXRoX3ZlcmlmaWVyKSkgewogICAgICAkcGFyYW1ldGVyc1sn
b2F1dGhfdmVyaWZpZXInXSA9ICRvYXV0aF92ZXJpZmllcjsKICAgIH0KICAgICRyZXF1ZXN0
ID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdGhpcy0+YWNjZXNzVG9rZW5VUkwoKSwgJ0dFVCcs
ICRwYXJhbWV0ZXJzKTsKICAgICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVy
cygkcmVxdWVzdCk7CiAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigkdG9r
ZW5bJ29hdXRoX3Rva2VuJ10sICR0b2tlblsnb2F1dGhfdG9rZW5fc2VjcmV0J10pOwogICAg
cmV0dXJuICR0b2tlbjsKICB9CgogIC8qKgogICAqIE9uZSB0aW1lIGV4Y2hhbmdlIG9mIHVz
ZXJuYW1lIGFuZCBwYXNzd29yZCBmb3IgYWNjZXNzIHRva2VuIGFuZCBzZWNyZXQuCiAgICoK
ICAgKiBAcmV0dXJucyBhcnJheSgib2F1dGhfdG9rZW4iID0+ICJ0aGUtYWNjZXNzLXRva2Vu
IiwKICAgKiAgICAgICAgICAgICAgICAib2F1dGhfdG9rZW5fc2VjcmV0IiA9PiAidGhlLWFj
Y2Vzcy1zZWNyZXQiLAogICAqICAgICAgICAgICAgICAgICJ1c2VyX2lkIiA9PiAiOTQzNjk5
MiIsCiAgICogICAgICAgICAgICAgICAgInNjcmVlbl9uYW1lIiA9PiAiYWJyYWhhbSIsCiAg
ICogICAgICAgICAgICAgICAgInhfYXV0aF9leHBpcmVzIiA9PiAiMCIpCiAgICovCiAgZnVu
Y3Rpb24gZ2V0WEF1dGhUb2tlbigkdXNlcm5hbWUsICRwYXNzd29yZCkgewogICAgJHBhcmFt
ZXRlcnMgPSBhcnJheSgpOwogICAgJHBhcmFtZXRlcnNbJ3hfYXV0aF91c2VybmFtZSddID0g
JHVzZXJuYW1lOwogICAgJHBhcmFtZXRlcnNbJ3hfYXV0aF9wYXNzd29yZCddID0gJHBhc3N3
b3JkOwogICAgJHBhcmFtZXRlcnNbJ3hfYXV0aF9tb2RlJ10gPSAnY2xpZW50X2F1dGgnOwog
ICAgJHJlcXVlc3QgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR0aGlzLT5hY2Nlc3NUb2tlblVS
TCgpLCAnUE9TVCcsICRwYXJhbWV0ZXJzKTsKICAgICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFy
c2VfcGFyYW1ldGVycygkcmVxdWVzdCk7CiAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhD
b25zdW1lcigkdG9rZW5bJ29hdXRoX3Rva2VuJ10sICR0b2tlblsnb2F1dGhfdG9rZW5fc2Vj
cmV0J10pOwogICAgcmV0dXJuICR0b2tlbjsKICB9CgogIC8qKgogICAqIEdFVCB3cmFwcGVy
IGZvciBvQXV0aFJlcXVlc3QuCiAgICovCiAgZnVuY3Rpb24gZ2V0KCR1cmwsICRwYXJhbWV0
ZXJzID0gYXJyYXkoKSkgewogICAgJHJlc3BvbnNlID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgk
dXJsLCAnR0VUJywgJHBhcmFtZXRlcnMpOwogICAgaWYgKCR0aGlzLT5mb3JtYXQgPT09ICdq
c29uJyAmJiAkdGhpcy0+ZGVjb2RlX2pzb24pIHsKICAgICAgcmV0dXJuIGpzb25fZGVjb2Rl
KCRyZXNwb25zZSk7CiAgICB9CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoqCiAg
ICogUE9TVCB3cmFwcGVyIGZvciBvQXV0aFJlcXVlc3QuCiAgICovCiAgZnVuY3Rpb24gcG9z
dCgkdXJsLCAkcGFyYW1ldGVycyA9IGFycmF5KCkpIHsKICAgICRyZXNwb25zZSA9ICR0aGlz
LT5vQXV0aFJlcXVlc3QoJHVybCwgJ1BPU1QnLCAkcGFyYW1ldGVycyk7CiAgICBpZiAoJHRo
aXMtPmZvcm1hdCA9PT0gJ2pzb24nICYmICR0aGlzLT5kZWNvZGVfanNvbikgewogICAgICBy
ZXR1cm4ganNvbl9kZWNvZGUoJHJlc3BvbnNlKTsKICAgIH0KICAgIHJldHVybiAkcmVzcG9u
c2U7CiAgfQoKICAvKioKICAgKiBERUxFVEUgd3JhcHBlciBmb3Igb0F1dGhSZXFldXN0Lgog
ICAqLwogIGZ1bmN0aW9uIGRlbGV0ZSgkdXJsLCAkcGFyYW1ldGVycyA9IGFycmF5KCkpIHsK
ICAgICRyZXNwb25zZSA9ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHVybCwgJ0RFTEVURScsICRw
YXJhbWV0ZXJzKTsKICAgIGlmICgkdGhpcy0+Zm9ybWF0ID09PSAnanNvbicgJiYgJHRoaXMt
PmRlY29kZV9qc29uKSB7CiAgICAgIHJldHVybiBqc29uX2RlY29kZSgkcmVzcG9uc2UpOwog
ICAgfQogICAgcmV0dXJuICRyZXNwb25zZTsKICB9CgogIC8qKgogICAqIEZvcm1hdCBhbmQg
c2lnbiBhbiBPQXV0aCAvIEFQSSByZXF1ZXN0CiAgICovCiAgZnVuY3Rpb24gb0F1dGhSZXF1
ZXN0KCR1cmwsICRtZXRob2QsICRwYXJhbWV0ZXJzKSB7CiAgICBpZiAoc3RycnBvcygkdXJs
LCAnaHR0cHM6Ly8nKSAhPT0gMCAmJiBzdHJycG9zKCR1cmwsICdodHRwOi8vJykgIT09IDAp
IHsKICAgICAgJHVybCA9ICJ7JHRoaXMtPmhvc3R9eyR1cmx9LnskdGhpcy0+Zm9ybWF0fSI7
CiAgICB9CiAgICAkcmVxdWVzdCA9IE9BdXRoUmVxdWVzdDo6ZnJvbV9jb25zdW1lcl9hbmRf
dG9rZW4oJHRoaXMtPmNvbnN1bWVyLCAkdGhpcy0+dG9rZW4sICRtZXRob2QsICR1cmwsICRw
YXJhbWV0ZXJzKTsKICAgICRyZXF1ZXN0LT5zaWduX3JlcXVlc3QoJHRoaXMtPnNoYTFfbWV0
aG9kLCAkdGhpcy0+Y29uc3VtZXIsICR0aGlzLT50b2tlbik7CiAgICBzd2l0Y2ggKCRtZXRo
b2QpIHsKICAgIGNhc2UgJ0dFVCc6CiAgICAgIHJldHVybiAkdGhpcy0+aHR0cCgkcmVxdWVz
dC0+dG9fdXJsKCksICdHRVQnKTsKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiAkdGhpcy0+
aHR0cCgkcmVxdWVzdC0+Z2V0X25vcm1hbGl6ZWRfaHR0cF91cmwoKSwgJG1ldGhvZCwgJHJl
cXVlc3QtPnRvX3Bvc3RkYXRhKCkpOwogICAgfQogIH0KCiAgLyoqCiAgICogTWFrZSBhbiBI
VFRQIHJlcXVlc3QKICAgKgogICAqIEByZXR1cm4gQVBJIHJlc3VsdHMKICAgKi8KICBmdW5j
dGlvbiBodHRwKCR1cmwsICRtZXRob2QsICRwb3N0ZmllbGRzID0gTlVMTCkgewogICAgJHRo
aXMtPmh0dHBfaW5mbyA9IGFycmF5KCk7CiAgICAkY2kgPSBjdXJsX2luaXQoKTsKICAgIC8q
IEN1cmwgc2V0dGluZ3MgKi8KICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9VU0VSQUdF
TlQsICR0aGlzLT51c2VyYWdlbnQpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0NP
Tk5FQ1RUSU1FT1VULCAkdGhpcy0+Y29ubmVjdHRpbWVvdXQpOwogICAgY3VybF9zZXRvcHQo
JGNpLCBDVVJMT1BUX1RJTUVPVVQsICR0aGlzLT50aW1lb3V0KTsKICAgIGN1cmxfc2V0b3B0
KCRjaSwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgVFJVRSk7CiAgICBjdXJsX3NldG9wdCgk
Y2ksIENVUkxPUFRfSFRUUEhFQURFUiwgYXJyYXkoJ0V4cGVjdDonKSk7CiAgICBjdXJsX3Nl
dG9wdCgkY2ksIENVUkxPUFRfU1NMX1ZFUklGWVBFRVIsICR0aGlzLT5zc2xfdmVyaWZ5cGVl
cik7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfSEVBREVSRlVOQ1RJT04sIGFycmF5
KCR0aGlzLCAnZ2V0SGVhZGVyJykpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0hF
QURFUiwgRkFMU0UpOwoKICAgIHN3aXRjaCAoJG1ldGhvZCkgewogICAgICBjYXNlICdQT1NU
JzoKICAgICAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfUE9TVCwgVFJVRSk7CiAgICAg
ICAgaWYgKCFlbXB0eSgkcG9zdGZpZWxkcykpIHsKICAgICAgICAgIGN1cmxfc2V0b3B0KCRj
aSwgQ1VSTE9QVF9QT1NURklFTERTLCAkcG9zdGZpZWxkcyk7CiAgICAgICAgfQogICAgICAg
IGJyZWFrOwogICAgICBjYXNlICdERUxFVEUnOgogICAgICAgIGN1cmxfc2V0b3B0KCRjaSwg
Q1VSTE9QVF9DVVNUT01SRVFVRVNULCAnREVMRVRFJyk7CiAgICAgICAgaWYgKCFlbXB0eSgk
cG9zdGZpZWxkcykpIHsKICAgICAgICAgICR1cmwgPSAieyR1cmx9P3skcG9zdGZpZWxkc30i
OwogICAgICAgIH0KICAgIH0KCiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfVVJMLCAk
dXJsKTsKICAgICRyZXNwb25zZSA9IGN1cmxfZXhlYygkY2kpOwogICAgJHRoaXMtPmh0dHBf
Y29kZSA9IGN1cmxfZ2V0aW5mbygkY2ksIENVUkxJTkZPX0hUVFBfQ09ERSk7CiAgICAkdGhp
cy0+aHR0cF9pbmZvID0gYXJyYXlfbWVyZ2UoJHRoaXMtPmh0dHBfaW5mbywgY3VybF9nZXRp
bmZvKCRjaSkpOwogICAgJHRoaXMtPnVybCA9ICR1cmw7CiAgICBjdXJsX2Nsb3NlICgkY2kp
OwogICAgcmV0dXJuICRyZXNwb25zZTsKICB9CgogIC8qKgogICAqIEdldCB0aGUgaGVhZGVy
IGluZm8gdG8gc3RvcmUuCiAgICovCiAgZnVuY3Rpb24gZ2V0SGVhZGVyKCRjaCwgJGhlYWRl
cikgewogICAgJGkgPSBzdHJwb3MoJGhlYWRlciwgJzonKTsKICAgIGlmICghZW1wdHkoJGkp
KSB7CiAgICAgICRrZXkgPSBzdHJfcmVwbGFjZSgnLScsICdfJywgc3RydG9sb3dlcihzdWJz
dHIoJGhlYWRlciwgMCwgJGkpKSk7CiAgICAgICR2YWx1ZSA9IHRyaW0oc3Vic3RyKCRoZWFk
ZXIsICRpICsgMikpOwogICAgICAkdGhpcy0+aHR0cF9oZWFkZXJbJGtleV0gPSAkdmFsdWU7
CiAgICB9CiAgICByZXR1cm4gc3RybGVuKCRoZWFkZXIpOwogIH0KfQoKY2xhc3MgT0F1dGhF
eGNlcHRpb24gZXh0ZW5kcyBFeGNlcHRpb24gewogIC8vIHBhc3MKfQoKY2xhc3MgT0F1dGhD
b25zdW1lciB7CiAgcHVibGljICRrZXk7CiAgcHVibGljICRzZWNyZXQ7CgogIGZ1bmN0aW9u
IF9fY29uc3RydWN0KCRrZXksICRzZWNyZXQsICRjYWxsYmFja191cmw9TlVMTCkgewogICAg
JHRoaXMtPmtleSA9ICRrZXk7CiAgICAkdGhpcy0+c2VjcmV0ID0gJHNlY3JldDsKICAgICR0
aGlzLT5jYWxsYmFja191cmwgPSAkY2FsbGJhY2tfdXJsOwogIH0KCiAgZnVuY3Rpb24gX190
b1N0cmluZygpIHsKICAgIHJldHVybiAiT0F1dGhDb25zdW1lcltrZXk9JHRoaXMtPmtleSxz
ZWNyZXQ9JHRoaXMtPnNlY3JldF0iOwogIH0KfQoKY2xhc3MgT0F1dGhUb2tlbiB7CiAgLy8g
YWNjZXNzIHRva2VucyBhbmQgcmVxdWVzdCB0b2tlbnMKICBwdWJsaWMgJGtleTsKICBwdWJs
aWMgJHNlY3JldDsKCiAgLyoqCiAgICoga2V5ID0gdGhlIHRva2VuCiAgICogc2VjcmV0ID0g
dGhlIHRva2VuIHNlY3JldAogICAqLwogIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRrZXksICRz
ZWNyZXQpIHsKICAgICR0aGlzLT5rZXkgPSAka2V5OwogICAgJHRoaXMtPnNlY3JldCA9ICRz
ZWNyZXQ7CiAgfQoKICAvKioKICAgKiBnZW5lcmF0ZXMgdGhlIGJhc2ljIHN0cmluZyBzZXJp
YWxpemF0aW9uIG9mIGEgdG9rZW4gdGhhdCBhIHNlcnZlcgogICAqIHdvdWxkIHJlc3BvbmQg
dG8gcmVxdWVzdF90b2tlbiBhbmQgYWNjZXNzX3Rva2VuIGNhbGxzIHdpdGgKICAgKi8KICBm
dW5jdGlvbiB0b19zdHJpbmcoKSB7CiAgICByZXR1cm4gIm9hdXRoX3Rva2VuPSIgLgogICAg
ICAgICAgIE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJHRoaXMtPmtleSkgLgogICAg
ICAgICAgICImb2F1dGhfdG9rZW5fc2VjcmV0PSIgLgogICAgICAgICAgIE9BdXRoVXRpbDo6
dXJsZW5jb2RlX3JmYzM5ODYoJHRoaXMtPnNlY3JldCk7CiAgfQoKICBmdW5jdGlvbiBfX3Rv
U3RyaW5nKCkgewogICAgcmV0dXJuICR0aGlzLT50b19zdHJpbmcoKTsKICB9Cn0KCi8qKgog
KiBBIGNsYXNzIGZvciBpbXBsZW1lbnRpbmcgYSBTaWduYXR1cmUgTWV0aG9kCiAqIFNlZSBz
ZWN0aW9uIDkgKCJTaWduaW5nIFJlcXVlc3RzIikgaW4gdGhlIHNwZWMKICovCmFic3RyYWN0
IGNsYXNzIE9BdXRoU2lnbmF0dXJlTWV0aG9kIHsKICAvKioKICAgKiBOZWVkcyB0byByZXR1
cm4gdGhlIG5hbWUgb2YgdGhlIFNpZ25hdHVyZSBNZXRob2QgKGllIEhNQUMtU0hBMSkKICAg
KiBAcmV0dXJuIHN0cmluZwogICAqLwogIGFic3RyYWN0IHB1YmxpYyBmdW5jdGlvbiBnZXRf
bmFtZSgpOwoKICAvKioKICAgKiBCdWlsZCB1cCB0aGUgc2lnbmF0dXJlCiAgICogTk9URTog
VGhlIG91dHB1dCBvZiB0aGlzIGZ1bmN0aW9uIE1VU1QgTk9UIGJlIHVybGVuY29kZWQuCiAg
ICogdGhlIGVuY29kaW5nIGlzIGhhbmRsZWQgaW4gT0F1dGhSZXF1ZXN0IHdoZW4gdGhlIGZp
bmFsCiAgICogcmVxdWVzdCBpcyBzZXJpYWxpemVkCiAgICogQHBhcmFtIE9BdXRoUmVxdWVz
dCAkcmVxdWVzdAogICAqIEBwYXJhbSBPQXV0aENvbnN1bWVyICRjb25zdW1lcgogICAqIEBw
YXJhbSBPQXV0aFRva2VuICR0b2tlbgogICAqIEByZXR1cm4gc3RyaW5nCiAgICovCiAgYWJz
dHJhY3QgcHVibGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1
bWVyLCAkdG9rZW4pOwoKICAvKioKICAgKiBWZXJpZmllcyB0aGF0IGEgZ2l2ZW4gc2lnbmF0
dXJlIGlzIGNvcnJlY3QKICAgKiBAcGFyYW0gT0F1dGhSZXF1ZXN0ICRyZXF1ZXN0CiAgICog
QHBhcmFtIE9BdXRoQ29uc3VtZXIgJGNvbnN1bWVyCiAgICogQHBhcmFtIE9BdXRoVG9rZW4g
JHRva2VuCiAgICogQHBhcmFtIHN0cmluZyAkc2lnbmF0dXJlCiAgICogQHJldHVybiBib29s
CiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNv
bnN1bWVyLCAkdG9rZW4sICRzaWduYXR1cmUpIHsKICAgICRidWlsdCA9ICR0aGlzLT5idWls
ZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKTsKICAgIHJldHVybiAk
YnVpbHQgPT0gJHNpZ25hdHVyZTsKICB9Cn0KCi8qKgogKiBUaGUgSE1BQy1TSEExIHNpZ25h
dHVyZSBtZXRob2QgdXNlcyB0aGUgSE1BQy1TSEExIHNpZ25hdHVyZSBhbGdvcml0aG0gYXMg
ZGVmaW5lZCBpbiBbUkZDMjEwNF0KICogd2hlcmUgdGhlIFNpZ25hdHVyZSBCYXNlIFN0cmlu
ZyBpcyB0aGUgdGV4dCBhbmQgdGhlIGtleSBpcyB0aGUgY29uY2F0ZW5hdGVkIHZhbHVlcyAo
ZWFjaCBmaXJzdAogKiBlbmNvZGVkIHBlciBQYXJhbWV0ZXIgRW5jb2RpbmcpIG9mIHRoZSBD
b25zdW1lciBTZWNyZXQgYW5kIFRva2VuIFNlY3JldCwgc2VwYXJhdGVkIGJ5IGFuICcmJwog
KiBjaGFyYWN0ZXIgKEFTQ0lJIGNvZGUgMzgpIGV2ZW4gaWYgZW1wdHkuCiAqICAgLSBDaGFw
dGVyIDkuMiAoIkhNQUMtU0hBMSIpCiAqLwpjbGFzcyBPQXV0aFNpZ25hdHVyZU1ldGhvZF9I
TUFDX1NIQTEgZXh0ZW5kcyBPQXV0aFNpZ25hdHVyZU1ldGhvZCB7CiAgZnVuY3Rpb24gZ2V0
X25hbWUoKSB7CiAgICByZXR1cm4gIkhNQUMtU0hBMSI7CiAgfQoKICBwdWJsaWMgZnVuY3Rp
b24gYnVpbGRfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbikgewogICAg
JGJhc2Vfc3RyaW5nID0gJHJlcXVlc3QtPmdldF9zaWduYXR1cmVfYmFzZV9zdHJpbmcoKTsK
ICAgICRyZXF1ZXN0LT5iYXNlX3N0cmluZyA9ICRiYXNlX3N0cmluZzsKCiAgICAka2V5X3Bh
cnRzID0gYXJyYXkoCiAgICAgICRjb25zdW1lci0+c2VjcmV0LAogICAgICAoJHRva2VuKSA/
ICR0b2tlbi0+c2VjcmV0IDogIiIKICAgICk7CgogICAgJGtleV9wYXJ0cyA9IE9BdXRoVXRp
bDo6dXJsZW5jb2RlX3JmYzM5ODYoJGtleV9wYXJ0cyk7CiAgICAka2V5ID0gaW1wbG9kZSgn
JicsICRrZXlfcGFydHMpOwoKICAgIHJldHVybiBiYXNlNjRfZW5jb2RlKGhhc2hfaG1hYygn
c2hhMScsICRiYXNlX3N0cmluZywgJGtleSwgdHJ1ZSkpOwogIH0KfQoKLyoqCiAqIFRoZSBQ
TEFJTlRFWFQgbWV0aG9kIGRvZXMgbm90IHByb3ZpZGUgYW55IHNlY3VyaXR5IHByb3RlY3Rp
b24gYW5kIFNIT1VMRCBvbmx5IGJlIHVzZWQKICogb3ZlciBhIHNlY3VyZSBjaGFubmVsIHN1
Y2ggYXMgSFRUUFMuIEl0IGRvZXMgbm90IHVzZSB0aGUgU2lnbmF0dXJlIEJhc2UgU3RyaW5n
LgogKiAgIC0gQ2hhcHRlciA5LjQgKCJQTEFJTlRFWFQiKQogKi8KY2xhc3MgT0F1dGhTaWdu
YXR1cmVNZXRob2RfUExBSU5URVhUIGV4dGVuZHMgT0F1dGhTaWduYXR1cmVNZXRob2Qgewog
IHB1YmxpYyBmdW5jdGlvbiBnZXRfbmFtZSgpIHsKICAgIHJldHVybiAiUExBSU5URVhUIjsK
ICB9CgogIC8qKgogICAqIG9hdXRoX3NpZ25hdHVyZSBpcyBzZXQgdG8gdGhlIGNvbmNhdGVu
YXRlZCBlbmNvZGVkIHZhbHVlcyBvZiB0aGUgQ29uc3VtZXIgU2VjcmV0IGFuZAogICAqIFRv
a2VuIFNlY3JldCwgc2VwYXJhdGVkIGJ5IGEgJyYnIGNoYXJhY3RlciAoQVNDSUkgY29kZSAz
OCksIGV2ZW4gaWYgZWl0aGVyIHNlY3JldCBpcwogICAqIGVtcHR5LiBUaGUgcmVzdWx0IE1V
U1QgYmUgZW5jb2RlZCBhZ2Fpbi4KICAgKiAgIC0gQ2hhcHRlciA5LjQuMSAoIkdlbmVyYXRp
bmcgU2lnbmF0dXJlcyIpCiAgICoKICAgKiBQbGVhc2Ugbm90ZSB0aGF0IHRoZSBzZWNvbmQg
ZW5jb2RpbmcgTVVTVCBOT1QgaGFwcGVuIGluIHRoZSBTaWduYXR1cmVNZXRob2QsIGFzCiAg
ICogT0F1dGhSZXF1ZXN0IGhhbmRsZXMgdGhpcyEKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24g
YnVpbGRfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJGtl
eV9wYXJ0cyA9IGFycmF5KAogICAgICAkY29uc3VtZXItPnNlY3JldCwKICAgICAgKCR0b2tl
bikgPyAkdG9rZW4tPnNlY3JldCA6ICIiCiAgICApOwoKICAgICRrZXlfcGFydHMgPSBPQXV0
aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCRrZXlfcGFydHMpOwogICAgJGtleSA9IGltcGxv
ZGUoJyYnLCAka2V5X3BhcnRzKTsKICAgICRyZXF1ZXN0LT5iYXNlX3N0cmluZyA9ICRrZXk7
CgogICAgcmV0dXJuICRrZXk7CiAgfQp9CgovKioKICogVGhlIFJTQS1TSEExIHNpZ25hdHVy
ZSBtZXRob2QgdXNlcyB0aGUgUlNBU1NBLVBLQ1MxLXYxXzUgc2lnbmF0dXJlIGFsZ29yaXRo
bSBhcyBkZWZpbmVkIGluCiAqIFtSRkMzNDQ3XSBzZWN0aW9uIDguMiAobW9yZSBzaW1wbHkg
a25vd24gYXMgUEtDUyMxKSwgdXNpbmcgU0hBLTEgYXMgdGhlIGhhc2ggZnVuY3Rpb24gZm9y
CiAqIEVNU0EtUEtDUzEtdjFfNS4gSXQgaXMgYXNzdW1lZCB0aGF0IHRoZSBDb25zdW1lciBo
YXMgcHJvdmlkZWQgaXRzIFJTQSBwdWJsaWMga2V5IGluIGEKICogdmVyaWZpZWQgd2F5IHRv
IHRoZSBTZXJ2aWNlIFByb3ZpZGVyLCBpbiBhIG1hbm5lciB3aGljaCBpcyBiZXlvbmQgdGhl
IHNjb3BlIG9mIHRoaXMKICogc3BlY2lmaWNhdGlvbi4KICogICAtIENoYXB0ZXIgOS4zICgi
UlNBLVNIQTEiKQogKi8KYWJzdHJhY3QgY2xhc3MgT0F1dGhTaWduYXR1cmVNZXRob2RfUlNB
X1NIQTEgZXh0ZW5kcyBPQXV0aFNpZ25hdHVyZU1ldGhvZCB7CiAgcHVibGljIGZ1bmN0aW9u
IGdldF9uYW1lKCkgewogICAgcmV0dXJuICJSU0EtU0hBMSI7CiAgfQoKICAvLyBVcCB0byB0
aGUgU1AgdG8gaW1wbGVtZW50IHRoaXMgbG9va3VwIG9mIGtleXMuIFBvc3NpYmxlIGlkZWFz
IGFyZToKICAvLyAoMSkgZG8gYSBsb29rdXAgaW4gYSB0YWJsZSBvZiB0cnVzdGVkIGNlcnRz
IGtleWVkIG9mZiBvZiBjb25zdW1lcgogIC8vICgyKSBmZXRjaCB2aWEgaHR0cCB1c2luZyBh
IHVybCBwcm92aWRlZCBieSB0aGUgcmVxdWVzdGVyCiAgLy8gKDMpIHNvbWUgc29ydCBvZiBz
cGVjaWZpYyBkaXNjb3ZlcnkgY29kZSBiYXNlZCBvbiByZXF1ZXN0CiAgLy8KICAvLyBFaXRo
ZXIgd2F5IHNob3VsZCByZXR1cm4gYSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIGNl
cnRpZmljYXRlCiAgcHJvdGVjdGVkIGFic3RyYWN0IGZ1bmN0aW9uIGZldGNoX3B1YmxpY19j
ZXJ0KCYkcmVxdWVzdCk7CgogIC8vIFVwIHRvIHRoZSBTUCB0byBpbXBsZW1lbnQgdGhpcyBs
b29rdXAgb2Yga2V5cy4gUG9zc2libGUgaWRlYXMgYXJlOgogIC8vICgxKSBkbyBhIGxvb2t1
cCBpbiBhIHRhYmxlIG9mIHRydXN0ZWQgY2VydHMga2V5ZWQgb2ZmIG9mIGNvbnN1bWVyCiAg
Ly8KICAvLyBFaXRoZXIgd2F5IHNob3VsZCByZXR1cm4gYSBzdHJpbmcgcmVwcmVzZW50YXRp
b24gb2YgdGhlIGNlcnRpZmljYXRlCiAgcHJvdGVjdGVkIGFic3RyYWN0IGZ1bmN0aW9uIGZl
dGNoX3ByaXZhdGVfY2VydCgmJHJlcXVlc3QpOwoKICBwdWJsaWMgZnVuY3Rpb24gYnVpbGRf
c2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJGJhc2Vfc3Ry
aW5nID0gJHJlcXVlc3QtPmdldF9zaWduYXR1cmVfYmFzZV9zdHJpbmcoKTsKICAgICRyZXF1
ZXN0LT5iYXNlX3N0cmluZyA9ICRiYXNlX3N0cmluZzsKCiAgICAvLyBGZXRjaCB0aGUgcHJp
dmF0ZSBrZXkgY2VydCBiYXNlZCBvbiB0aGUgcmVxdWVzdAogICAgJGNlcnQgPSAkdGhpcy0+
ZmV0Y2hfcHJpdmF0ZV9jZXJ0KCRyZXF1ZXN0KTsKCiAgICAvLyBQdWxsIHRoZSBwcml2YXRl
IGtleSBJRCBmcm9tIHRoZSBjZXJ0aWZpY2F0ZQogICAgJHByaXZhdGVrZXlpZCA9IG9wZW5z
c2xfZ2V0X3ByaXZhdGVrZXkoJGNlcnQpOwoKICAgIC8vIFNpZ24gdXNpbmcgdGhlIGtleQog
ICAgJG9rID0gb3BlbnNzbF9zaWduKCRiYXNlX3N0cmluZywgJHNpZ25hdHVyZSwgJHByaXZh
dGVrZXlpZCk7CgogICAgLy8gUmVsZWFzZSB0aGUga2V5IHJlc291cmNlCiAgICBvcGVuc3Ns
X2ZyZWVfa2V5KCRwcml2YXRla2V5aWQpOwoKICAgIHJldHVybiBiYXNlNjRfZW5jb2RlKCRz
aWduYXR1cmUpOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGNoZWNrX3NpZ25hdHVyZSgkcmVx
dWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4sICRzaWduYXR1cmUpIHsKICAgICRkZWNvZGVkX3Np
ZyA9IGJhc2U2NF9kZWNvZGUoJHNpZ25hdHVyZSk7CgogICAgJGJhc2Vfc3RyaW5nID0gJHJl
cXVlc3QtPmdldF9zaWduYXR1cmVfYmFzZV9zdHJpbmcoKTsKCiAgICAvLyBGZXRjaCB0aGUg
cHVibGljIGtleSBjZXJ0IGJhc2VkIG9uIHRoZSByZXF1ZXN0CiAgICAkY2VydCA9ICR0aGlz
LT5mZXRjaF9wdWJsaWNfY2VydCgkcmVxdWVzdCk7CgogICAgLy8gUHVsbCB0aGUgcHVibGlj
IGtleSBJRCBmcm9tIHRoZSBjZXJ0aWZpY2F0ZQogICAgJHB1YmxpY2tleWlkID0gb3BlbnNz
bF9nZXRfcHVibGlja2V5KCRjZXJ0KTsKCiAgICAvLyBDaGVjayB0aGUgY29tcHV0ZWQgc2ln
bmF0dXJlIGFnYWluc3QgdGhlIG9uZSBwYXNzZWQgaW4gdGhlIHF1ZXJ5CiAgICAkb2sgPSBv
cGVuc3NsX3ZlcmlmeSgkYmFzZV9zdHJpbmcsICRkZWNvZGVkX3NpZywgJHB1YmxpY2tleWlk
KTsKCiAgICAvLyBSZWxlYXNlIHRoZSBrZXkgcmVzb3VyY2UKICAgIG9wZW5zc2xfZnJlZV9r
ZXkoJHB1YmxpY2tleWlkKTsKCiAgICByZXR1cm4gJG9rID09IDE7CiAgfQp9CgpjbGFzcyBP
QXV0aFJlcXVlc3QgewogIHByaXZhdGUgJHBhcmFtZXRlcnM7CiAgcHJpdmF0ZSAkaHR0cF9t
ZXRob2Q7CiAgcHJpdmF0ZSAkaHR0cF91cmw7CiAgLy8gZm9yIGRlYnVnIHB1cnBvc2VzCiAg
cHVibGljICRiYXNlX3N0cmluZzsKICBwdWJsaWMgc3RhdGljICR2ZXJzaW9uID0gJzEuMCc7
CiAgcHVibGljIHN0YXRpYyAkUE9TVF9JTlBVVCA9ICdwaHA6Ly9pbnB1dCc7CgogIGZ1bmN0
aW9uIF9fY29uc3RydWN0KCRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVycz1O
VUxMKSB7CiAgICBAJHBhcmFtZXRlcnMgb3IgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAg
JHBhcmFtZXRlcnMgPSBhcnJheV9tZXJnZSggT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJz
KHBhcnNlX3VybCgkaHR0cF91cmwsIFBIUF9VUkxfUVVFUlkpKSwgJHBhcmFtZXRlcnMpOwog
ICAgJHRoaXMtPnBhcmFtZXRlcnMgPSAkcGFyYW1ldGVyczsKICAgICR0aGlzLT5odHRwX21l
dGhvZCA9ICRodHRwX21ldGhvZDsKICAgICR0aGlzLT5odHRwX3VybCA9ICRodHRwX3VybDsK
ICB9CgoKICAvKioKICAgKiBhdHRlbXB0IHRvIGJ1aWxkIHVwIGEgcmVxdWVzdCBmcm9tIHdo
YXQgd2FzIHBhc3NlZCB0byB0aGUgc2VydmVyCiAgICovCiAgcHVibGljIHN0YXRpYyBmdW5j
dGlvbiBmcm9tX3JlcXVlc3QoJGh0dHBfbWV0aG9kPU5VTEwsICRodHRwX3VybD1OVUxMLCAk
cGFyYW1ldGVycz1OVUxMKSB7CiAgICAkc2NoZW1lID0gKCFpc3NldCgkX1NFUlZFUlsnSFRU
UFMnXSkgfHwgJF9TRVJWRVJbJ0hUVFBTJ10gIT0gIm9uIikKICAgICAgICAgICAgICA/ICdo
dHRwJwogICAgICAgICAgICAgIDogJ2h0dHBzJzsKICAgIEAkaHR0cF91cmwgb3IgJGh0dHBf
dXJsID0gJHNjaGVtZSAuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc6Ly8nIC4g
JF9TRVJWRVJbJ0hUVFBfSE9TVCddIC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
JzonIC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJF9TRVJWRVJbJ1NFUlZFUl9Q
T1JUJ10gLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkX1NFUlZFUlsnUkVRVUVT
VF9VUkknXTsKICAgIEAkaHR0cF9tZXRob2Qgb3IgJGh0dHBfbWV0aG9kID0gJF9TRVJWRVJb
J1JFUVVFU1RfTUVUSE9EJ107CgogICAgLy8gV2Ugd2VyZW4ndCBoYW5kZWQgYW55IHBhcmFt
ZXRlcnMsIHNvIGxldCdzIGZpbmQgdGhlIG9uZXMgcmVsZXZhbnQgdG8KICAgIC8vIHRoaXMg
cmVxdWVzdC4KICAgIC8vIElmIHlvdSBydW4gWE1MLVJQQyBvciBzaW1pbGFyIHlvdSBzaG91
bGQgdXNlIHRoaXMgdG8gcHJvdmlkZSB5b3VyIG93bgogICAgLy8gcGFyc2VkIHBhcmFtZXRl
ci1saXN0CiAgICBpZiAoISRwYXJhbWV0ZXJzKSB7CiAgICAgIC8vIEZpbmQgcmVxdWVzdCBo
ZWFkZXJzCiAgICAgICRyZXF1ZXN0X2hlYWRlcnMgPSBPQXV0aFV0aWw6OmdldF9oZWFkZXJz
KCk7CgogICAgICAvLyBQYXJzZSB0aGUgcXVlcnktc3RyaW5nIHRvIGZpbmQgR0VUIHBhcmFt
ZXRlcnMKICAgICAgJHBhcmFtZXRlcnMgPSBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMo
JF9TRVJWRVJbJ1FVRVJZX1NUUklORyddKTsKCiAgICAgIC8vIEl0J3MgYSBQT1NUIHJlcXVl
c3Qgb2YgdGhlIHByb3BlciBjb250ZW50LXR5cGUsIHNvIHBhcnNlIFBPU1QKICAgICAgLy8g
cGFyYW1ldGVycyBhbmQgYWRkIHRob3NlIG92ZXJyaWRpbmcgYW55IGR1cGxpY2F0ZXMgZnJv
bSBHRVQKICAgICAgaWYgKCRodHRwX21ldGhvZCA9PSAiUE9TVCIKICAgICAgICAgICYmIEBz
dHJzdHIoJHJlcXVlc3RfaGVhZGVyc1siQ29udGVudC1UeXBlIl0sCiAgICAgICAgICAgICAg
ICAgICAgICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKQogICAgICAgICAg
KSB7CiAgICAgICAgJHBvc3RfZGF0YSA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygK
ICAgICAgICAgIGZpbGVfZ2V0X2NvbnRlbnRzKHNlbGY6OiRQT1NUX0lOUFVUKQogICAgICAg
ICk7CiAgICAgICAgJHBhcmFtZXRlcnMgPSBhcnJheV9tZXJnZSgkcGFyYW1ldGVycywgJHBv
c3RfZGF0YSk7CiAgICAgIH0KCiAgICAgIC8vIFdlIGhhdmUgYSBBdXRob3JpemF0aW9uLWhl
YWRlciB3aXRoIE9BdXRoIGRhdGEuIFBhcnNlIHRoZSBoZWFkZXIKICAgICAgLy8gYW5kIGFk
ZCB0aG9zZSBvdmVycmlkaW5nIGFueSBkdXBsaWNhdGVzIGZyb20gR0VUIG9yIFBPU1QKICAg
ICAgaWYgKEBzdWJzdHIoJHJlcXVlc3RfaGVhZGVyc1snQXV0aG9yaXphdGlvbiddLCAwLCA2
KSA9PSAiT0F1dGggIikgewogICAgICAgICRoZWFkZXJfcGFyYW1ldGVycyA9IE9BdXRoVXRp
bDo6c3BsaXRfaGVhZGVyKAogICAgICAgICAgJHJlcXVlc3RfaGVhZGVyc1snQXV0aG9yaXph
dGlvbiddCiAgICAgICAgKTsKICAgICAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCRw
YXJhbWV0ZXJzLCAkaGVhZGVyX3BhcmFtZXRlcnMpOwogICAgICB9CgogICAgfQoKICAgIHJl
dHVybiBuZXcgT0F1dGhSZXF1ZXN0KCRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1l
dGVycyk7CiAgfQoKICAvKioKICAgKiBwcmV0dHkgbXVjaCBhIGhlbHBlciBmdW5jdGlvbiB0
byBzZXQgdXAgdGhlIHJlcXVlc3QKICAgKi8KICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGZy
b21fY29uc3VtZXJfYW5kX3Rva2VuKCRjb25zdW1lciwgJHRva2VuLCAkaHR0cF9tZXRob2Qs
ICRodHRwX3VybCwgJHBhcmFtZXRlcnM9TlVMTCkgewogICAgQCRwYXJhbWV0ZXJzIG9yICRw
YXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgICRkZWZhdWx0cyA9IGFycmF5KCJvYXV0aF92ZXJz
aW9uIiA9PiBPQXV0aFJlcXVlc3Q6OiR2ZXJzaW9uLAogICAgICAgICAgICAgICAgICAgICAg
Im9hdXRoX25vbmNlIiA9PiBPQXV0aFJlcXVlc3Q6OmdlbmVyYXRlX25vbmNlKCksCiAgICAg
ICAgICAgICAgICAgICAgICAib2F1dGhfdGltZXN0YW1wIiA9PiBPQXV0aFJlcXVlc3Q6Omdl
bmVyYXRlX3RpbWVzdGFtcCgpLAogICAgICAgICAgICAgICAgICAgICAgIm9hdXRoX2NvbnN1
bWVyX2tleSIgPT4gJGNvbnN1bWVyLT5rZXkpOwogICAgaWYgKCR0b2tlbikKICAgICAgJGRl
ZmF1bHRzWydvYXV0aF90b2tlbiddID0gJHRva2VuLT5rZXk7CgogICAgJHBhcmFtZXRlcnMg
PSBhcnJheV9tZXJnZSgkZGVmYXVsdHMsICRwYXJhbWV0ZXJzKTsKCiAgICByZXR1cm4gbmV3
IE9BdXRoUmVxdWVzdCgkaHR0cF9tZXRob2QsICRodHRwX3VybCwgJHBhcmFtZXRlcnMpOwog
IH0KCiAgcHVibGljIGZ1bmN0aW9uIHNldF9wYXJhbWV0ZXIoJG5hbWUsICR2YWx1ZSwgJGFs
bG93X2R1cGxpY2F0ZXMgPSB0cnVlKSB7CiAgICBpZiAoJGFsbG93X2R1cGxpY2F0ZXMgJiYg
aXNzZXQoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdKSkgewogICAgICAvLyBXZSBoYXZlIGFs
cmVhZHkgYWRkZWQgcGFyYW1ldGVyKHMpIHdpdGggdGhpcyBuYW1lLCBzbyBhZGQgdG8gdGhl
IGxpc3QKICAgICAgaWYgKGlzX3NjYWxhcigkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pKSB7
CiAgICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3QgZHVwbGljYXRlLCBzbyB0cmFuc2Zvcm0g
c2NhbGFyIChzdHJpbmcpCiAgICAgICAgLy8gaW50byBhbiBhcnJheSBzbyB3ZSBjYW4gYWRk
IHRoZSBkdXBsaWNhdGVzCiAgICAgICAgJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdID0gYXJy
YXkoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdKTsKICAgICAgfQoKICAgICAgJHRoaXMtPnBh
cmFtZXRlcnNbJG5hbWVdW10gPSAkdmFsdWU7CiAgICB9IGVsc2UgewogICAgICAkdGhpcy0+
cGFyYW1ldGVyc1skbmFtZV0gPSAkdmFsdWU7CiAgICB9CiAgfQoKICBwdWJsaWMgZnVuY3Rp
b24gZ2V0X3BhcmFtZXRlcigkbmFtZSkgewogICAgcmV0dXJuIGlzc2V0KCR0aGlzLT5wYXJh
bWV0ZXJzWyRuYW1lXSkgPyAkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0gOiBudWxsOwogIH0K
CiAgcHVibGljIGZ1bmN0aW9uIGdldF9wYXJhbWV0ZXJzKCkgewogICAgcmV0dXJuICR0aGlz
LT5wYXJhbWV0ZXJzOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIHVuc2V0X3BhcmFtZXRlcigk
bmFtZSkgewogICAgdW5zZXQoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdKTsKICB9CgogIC8q
KgogICAqIFRoZSByZXF1ZXN0IHBhcmFtZXRlcnMsIHNvcnRlZCBhbmQgY29uY2F0ZW5hdGVk
IGludG8gYSBub3JtYWxpemVkIHN0cmluZy4KICAgKiBAcmV0dXJuIHN0cmluZwogICAqLwog
IHB1YmxpYyBmdW5jdGlvbiBnZXRfc2lnbmFibGVfcGFyYW1ldGVycygpIHsKICAgIC8vIEdy
YWIgYWxsIHBhcmFtZXRlcnMKICAgICRwYXJhbXMgPSAkdGhpcy0+cGFyYW1ldGVyczsKCiAg
ICAvLyBSZW1vdmUgb2F1dGhfc2lnbmF0dXJlIGlmIHByZXNlbnQKICAgIC8vIFJlZjogU3Bl
YzogOS4xLjEgKCJUaGUgb2F1dGhfc2lnbmF0dXJlIHBhcmFtZXRlciBNVVNUIGJlIGV4Y2x1
ZGVkLiIpCiAgICBpZiAoaXNzZXQoJHBhcmFtc1snb2F1dGhfc2lnbmF0dXJlJ10pKSB7CiAg
ICAgIHVuc2V0KCRwYXJhbXNbJ29hdXRoX3NpZ25hdHVyZSddKTsKICAgIH0KCiAgICByZXR1
cm4gT0F1dGhVdGlsOjpidWlsZF9odHRwX3F1ZXJ5KCRwYXJhbXMpOwogIH0KCiAgLyoqCiAg
ICogUmV0dXJucyB0aGUgYmFzZSBzdHJpbmcgb2YgdGhpcyByZXF1ZXN0CiAgICoKICAgKiBU
aGUgYmFzZSBzdHJpbmcgZGVmaW5lZCBhcyB0aGUgbWV0aG9kLCB0aGUgdXJsCiAgICogYW5k
IHRoZSBwYXJhbWV0ZXJzIChub3JtYWxpemVkKSwgZWFjaCB1cmxlbmNvZGVkCiAgICogYW5k
IHRoZSBjb25jYXRlZCB3aXRoICYuCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGdldF9zaWdu
YXR1cmVfYmFzZV9zdHJpbmcoKSB7CiAgICAkcGFydHMgPSBhcnJheSgKICAgICAgJHRoaXMt
PmdldF9ub3JtYWxpemVkX2h0dHBfbWV0aG9kKCksCiAgICAgICR0aGlzLT5nZXRfbm9ybWFs
aXplZF9odHRwX3VybCgpLAogICAgICAkdGhpcy0+Z2V0X3NpZ25hYmxlX3BhcmFtZXRlcnMo
KQogICAgKTsKCiAgICAkcGFydHMgPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCRw
YXJ0cyk7CgogICAgcmV0dXJuIGltcGxvZGUoJyYnLCAkcGFydHMpOwogIH0KCiAgLyoqCiAg
ICoganVzdCB1cHBlcmNhc2VzIHRoZSBodHRwIG1ldGhvZAogICAqLwogIHB1YmxpYyBmdW5j
dGlvbiBnZXRfbm9ybWFsaXplZF9odHRwX21ldGhvZCgpIHsKICAgIHJldHVybiBzdHJ0b3Vw
cGVyKCR0aGlzLT5odHRwX21ldGhvZCk7CiAgfQoKICAvKioKICAgKiBwYXJzZXMgdGhlIHVy
bCBhbmQgcmVidWlsZHMgaXQgdG8gYmUKICAgKiBzY2hlbWU6Ly9ob3N0L3BhdGgKICAgKi8K
ICBwdWJsaWMgZnVuY3Rpb24gZ2V0X25vcm1hbGl6ZWRfaHR0cF91cmwoKSB7CiAgICAkcGFy
dHMgPSBwYXJzZV91cmwoJHRoaXMtPmh0dHBfdXJsKTsKCiAgICAkcG9ydCA9IEAkcGFydHNb
J3BvcnQnXTsKICAgICRzY2hlbWUgPSAkcGFydHNbJ3NjaGVtZSddOwogICAgJGhvc3QgPSAk
cGFydHNbJ2hvc3QnXTsKICAgICRwYXRoID0gQCRwYXJ0c1sncGF0aCddOwoKICAgICRwb3J0
IG9yICRwb3J0ID0gKCRzY2hlbWUgPT0gJ2h0dHBzJykgPyAnNDQzJyA6ICc4MCc7CgogICAg
aWYgKCgkc2NoZW1lID09ICdodHRwcycgJiYgJHBvcnQgIT0gJzQ0MycpCiAgICAgICAgfHwg
KCRzY2hlbWUgPT0gJ2h0dHAnICYmICRwb3J0ICE9ICc4MCcpKSB7CiAgICAgICRob3N0ID0g
IiRob3N0OiRwb3J0IjsKICAgIH0KICAgIHJldHVybiAiJHNjaGVtZTovLyRob3N0JHBhdGgi
OwogIH0KCiAgLyoqCiAgICogYnVpbGRzIGEgdXJsIHVzYWJsZSBmb3IgYSBHRVQgcmVxdWVz
dAogICAqLwogIHB1YmxpYyBmdW5jdGlvbiB0b191cmwoKSB7CiAgICAkcG9zdF9kYXRhID0g
JHRoaXMtPnRvX3Bvc3RkYXRhKCk7CiAgICAkb3V0ID0gJHRoaXMtPmdldF9ub3JtYWxpemVk
X2h0dHBfdXJsKCk7CiAgICBpZiAoJHBvc3RfZGF0YSkgewogICAgICAkb3V0IC49ICc/Jy4k
cG9zdF9kYXRhOwogICAgfQogICAgcmV0dXJuICRvdXQ7CiAgfQoKICAvKioKICAgKiBidWls
ZHMgdGhlIGRhdGEgb25lIHdvdWxkIHNlbmQgaW4gYSBQT1NUIHJlcXVlc3QKICAgKi8KICBw
dWJsaWMgZnVuY3Rpb24gdG9fcG9zdGRhdGEoKSB7CiAgICByZXR1cm4gT0F1dGhVdGlsOjpi
dWlsZF9odHRwX3F1ZXJ5KCR0aGlzLT5wYXJhbWV0ZXJzKTsKICB9CgogIC8qKgogICAqIGJ1
aWxkcyB0aGUgQXV0aG9yaXphdGlvbjogaGVhZGVyCiAgICovCiAgcHVibGljIGZ1bmN0aW9u
IHRvX2hlYWRlcigkcmVhbG09bnVsbCkgewogICAgJGZpcnN0ID0gdHJ1ZTsKICBpZigkcmVh
bG0pIHsKICAgICAgJG91dCA9ICdBdXRob3JpemF0aW9uOiBPQXV0aCByZWFsbT0iJyAuIE9B
dXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJHJlYWxtKSAuICciJzsKICAgICAgJGZpcnN0
ID0gZmFsc2U7CiAgICB9IGVsc2UKICAgICAgJG91dCA9ICdBdXRob3JpemF0aW9uOiBPQXV0
aCc7CgogICAgJHRvdGFsID0gYXJyYXkoKTsKICAgIGZvcmVhY2ggKCR0aGlzLT5wYXJhbWV0
ZXJzIGFzICRrID0+ICR2KSB7CiAgICAgIGlmIChzdWJzdHIoJGssIDAsIDUpICE9ICJvYXV0
aCIpIGNvbnRpbnVlOwogICAgICBpZiAoaXNfYXJyYXkoJHYpKSB7CiAgICAgICAgdGhyb3cg
bmV3IE9BdXRoRXhjZXB0aW9uKCdBcnJheXMgbm90IHN1cHBvcnRlZCBpbiBoZWFkZXJzJyk7
CiAgICAgIH0KICAgICAgJG91dCAuPSAoJGZpcnN0KSA/ICcgJyA6ICcsJzsKICAgICAgJG91
dCAuPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCRrKSAuCiAgICAgICAgICAgICAg
Jz0iJyAuCiAgICAgICAgICAgICAgT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4Nigkdikg
LgogICAgICAgICAgICAgICciJzsKICAgICAgJGZpcnN0ID0gZmFsc2U7CiAgICB9CiAgICBy
ZXR1cm4gJG91dDsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBfX3RvU3RyaW5nKCkgewogICAg
cmV0dXJuICR0aGlzLT50b191cmwoKTsKICB9CgoKICBwdWJsaWMgZnVuY3Rpb24gc2lnbl9y
ZXF1ZXN0KCRzaWduYXR1cmVfbWV0aG9kLCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJHRo
aXMtPnNldF9wYXJhbWV0ZXIoCiAgICAgICJvYXV0aF9zaWduYXR1cmVfbWV0aG9kIiwKICAg
ICAgJHNpZ25hdHVyZV9tZXRob2QtPmdldF9uYW1lKCksCiAgICAgIGZhbHNlCiAgICApOwog
ICAgJHNpZ25hdHVyZSA9ICR0aGlzLT5idWlsZF9zaWduYXR1cmUoJHNpZ25hdHVyZV9tZXRo
b2QsICRjb25zdW1lciwgJHRva2VuKTsKICAgICR0aGlzLT5zZXRfcGFyYW1ldGVyKCJvYXV0
aF9zaWduYXR1cmUiLCAkc2lnbmF0dXJlLCBmYWxzZSk7CiAgfQoKICBwdWJsaWMgZnVuY3Rp
b24gYnVpbGRfc2lnbmF0dXJlKCRzaWduYXR1cmVfbWV0aG9kLCAkY29uc3VtZXIsICR0b2tl
bikgewogICAgJHNpZ25hdHVyZSA9ICRzaWduYXR1cmVfbWV0aG9kLT5idWlsZF9zaWduYXR1
cmUoJHRoaXMsICRjb25zdW1lciwgJHRva2VuKTsKICAgIHJldHVybiAkc2lnbmF0dXJlOwog
IH0KCiAgLyoqCiAgICogdXRpbCBmdW5jdGlvbjogY3VycmVudCB0aW1lc3RhbXAKICAgKi8K
ICBwcml2YXRlIHN0YXRpYyBmdW5jdGlvbiBnZW5lcmF0ZV90aW1lc3RhbXAoKSB7CiAgICBy
ZXR1cm4gdGltZSgpOwogIH0KCiAgLyoqCiAgICogdXRpbCBmdW5jdGlvbjogY3VycmVudCBu
b25jZQogICAqLwogIHByaXZhdGUgc3RhdGljIGZ1bmN0aW9uIGdlbmVyYXRlX25vbmNlKCkg
ewogICAgJG10ID0gbWljcm90aW1lKCk7CiAgICAkcmFuZCA9IG10X3JhbmQoKTsKCiAgICBy
ZXR1cm4gbWQ1KCRtdCAuICRyYW5kKTsgLy8gbWQ1cyBsb29rIG5pY2VyIHRoYW4gbnVtYmVy
cwogIH0KfQoKY2xhc3MgT0F1dGhTZXJ2ZXIgewogIHByb3RlY3RlZCAkdGltZXN0YW1wX3Ro
cmVzaG9sZCA9IDMwMDsgLy8gaW4gc2Vjb25kcywgZml2ZSBtaW51dGVzCiAgcHJvdGVjdGVk
ICR2ZXJzaW9uID0gJzEuMCc7ICAgICAgICAgICAgIC8vIGhpIGJsYWluZQogIHByb3RlY3Rl
ZCAkc2lnbmF0dXJlX21ldGhvZHMgPSBhcnJheSgpOwoKICBwcm90ZWN0ZWQgJGRhdGFfc3Rv
cmU7CgogIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRkYXRhX3N0b3JlKSB7CiAgICAkdGhpcy0+
ZGF0YV9zdG9yZSA9ICRkYXRhX3N0b3JlOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGFkZF9z
aWduYXR1cmVfbWV0aG9kKCRzaWduYXR1cmVfbWV0aG9kKSB7CiAgICAkdGhpcy0+c2lnbmF0
dXJlX21ldGhvZHNbJHNpZ25hdHVyZV9tZXRob2QtPmdldF9uYW1lKCldID0KICAgICAgJHNp
Z25hdHVyZV9tZXRob2Q7CiAgfQoKICAvLyBoaWdoIGxldmVsIGZ1bmN0aW9ucwoKICAvKioK
ICAgKiBwcm9jZXNzIGEgcmVxdWVzdF90b2tlbiByZXF1ZXN0CiAgICogcmV0dXJucyB0aGUg
cmVxdWVzdCB0b2tlbiBvbiBzdWNjZXNzCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGZldGNo
X3JlcXVlc3RfdG9rZW4oJiRyZXF1ZXN0KSB7CiAgICAkdGhpcy0+Z2V0X3ZlcnNpb24oJHJl
cXVlc3QpOwoKICAgICRjb25zdW1lciA9ICR0aGlzLT5nZXRfY29uc3VtZXIoJHJlcXVlc3Qp
OwoKICAgIC8vIG5vIHRva2VuIHJlcXVpcmVkIGZvciB0aGUgaW5pdGlhbCB0b2tlbiByZXF1
ZXN0CiAgICAkdG9rZW4gPSBOVUxMOwoKICAgICR0aGlzLT5jaGVja19zaWduYXR1cmUoJHJl
cXVlc3QsICRjb25zdW1lciwgJHRva2VuKTsKCiAgICAvLyBSZXYgQSBjaGFuZ2UKICAgICRj
YWxsYmFjayA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF9jYWxsYmFjaycpOwog
ICAgJG5ld190b2tlbiA9ICR0aGlzLT5kYXRhX3N0b3JlLT5uZXdfcmVxdWVzdF90b2tlbigk
Y29uc3VtZXIsICRjYWxsYmFjayk7CgogICAgcmV0dXJuICRuZXdfdG9rZW47CiAgfQoKICAv
KioKICAgKiBwcm9jZXNzIGFuIGFjY2Vzc190b2tlbiByZXF1ZXN0CiAgICogcmV0dXJucyB0
aGUgYWNjZXNzIHRva2VuIG9uIHN1Y2Nlc3MKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZmV0
Y2hfYWNjZXNzX3Rva2VuKCYkcmVxdWVzdCkgewogICAgJHRoaXMtPmdldF92ZXJzaW9uKCRy
ZXF1ZXN0KTsKCiAgICAkY29uc3VtZXIgPSAkdGhpcy0+Z2V0X2NvbnN1bWVyKCRyZXF1ZXN0
KTsKCiAgICAvLyByZXF1aXJlcyBhdXRob3JpemVkIHJlcXVlc3QgdG9rZW4KICAgICR0b2tl
biA9ICR0aGlzLT5nZXRfdG9rZW4oJHJlcXVlc3QsICRjb25zdW1lciwgInJlcXVlc3QiKTsK
CiAgICAkdGhpcy0+Y2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tl
bik7CgogICAgLy8gUmV2IEEgY2hhbmdlCiAgICAkdmVyaWZpZXIgPSAkcmVxdWVzdC0+Z2V0
X3BhcmFtZXRlcignb2F1dGhfdmVyaWZpZXInKTsKICAgICRuZXdfdG9rZW4gPSAkdGhpcy0+
ZGF0YV9zdG9yZS0+bmV3X2FjY2Vzc190b2tlbigkdG9rZW4sICRjb25zdW1lciwgJHZlcmlm
aWVyKTsKCiAgICByZXR1cm4gJG5ld190b2tlbjsKICB9CgogIC8qKgogICAqIHZlcmlmeSBh
biBhcGkgY2FsbCwgY2hlY2tzIGFsbCB0aGUgcGFyYW1ldGVycwogICAqLwogIHB1YmxpYyBm
dW5jdGlvbiB2ZXJpZnlfcmVxdWVzdCgmJHJlcXVlc3QpIHsKICAgICR0aGlzLT5nZXRfdmVy
c2lvbigkcmVxdWVzdCk7CiAgICAkY29uc3VtZXIgPSAkdGhpcy0+Z2V0X2NvbnN1bWVyKCRy
ZXF1ZXN0KTsKICAgICR0b2tlbiA9ICR0aGlzLT5nZXRfdG9rZW4oJHJlcXVlc3QsICRjb25z
dW1lciwgImFjY2VzcyIpOwogICAgJHRoaXMtPmNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwg
JGNvbnN1bWVyLCAkdG9rZW4pOwogICAgcmV0dXJuIGFycmF5KCRjb25zdW1lciwgJHRva2Vu
KTsKICB9CgogIC8vIEludGVybmFscyBmcm9tIGhlcmUKICAvKioKICAgKiB2ZXJzaW9uIDEK
ICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGdldF92ZXJzaW9uKCYkcmVxdWVzdCkgewogICAg
JHZlcnNpb24gPSAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcigib2F1dGhfdmVyc2lvbiIpOwog
ICAgaWYgKCEkdmVyc2lvbikgewogICAgICAvLyBTZXJ2aWNlIFByb3ZpZGVycyBNVVNUIGFz
c3VtZSB0aGUgcHJvdG9jb2wgdmVyc2lvbiB0byBiZSAxLjAgaWYgdGhpcyBwYXJhbWV0ZXIg
aXMgbm90IHByZXNlbnQuCiAgICAgIC8vIENoYXB0ZXIgNy4wICgiQWNjZXNzaW5nIFByb3Rl
Y3RlZCBSZXNzb3VyY2VzIikKICAgICAgJHZlcnNpb24gPSAnMS4wJzsKICAgIH0KICAgIGlm
ICgkdmVyc2lvbiAhPT0gJHRoaXMtPnZlcnNpb24pIHsKICAgICAgdGhyb3cgbmV3IE9BdXRo
RXhjZXB0aW9uKCJPQXV0aCB2ZXJzaW9uICckdmVyc2lvbicgbm90IHN1cHBvcnRlZCIpOwog
ICAgfQogICAgcmV0dXJuICR2ZXJzaW9uOwogIH0KCiAgLyoqCiAgICogZmlndXJlIG91dCB0
aGUgc2lnbmF0dXJlIHdpdGggc29tZSBkZWZhdWx0cwogICAqLwogIHByaXZhdGUgZnVuY3Rp
b24gZ2V0X3NpZ25hdHVyZV9tZXRob2QoJiRyZXF1ZXN0KSB7CiAgICAkc2lnbmF0dXJlX21l
dGhvZCA9CiAgICAgICAgQCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCJvYXV0aF9zaWduYXR1
cmVfbWV0aG9kIik7CgogICAgaWYgKCEkc2lnbmF0dXJlX21ldGhvZCkgewogICAgICAvLyBB
Y2NvcmRpbmcgdG8gY2hhcHRlciA3ICgiQWNjZXNzaW5nIFByb3RlY3RlZCBSZXNzb3VyY2Vz
IikgdGhlIHNpZ25hdHVyZS1tZXRob2QKICAgICAgLy8gcGFyYW1ldGVyIGlzIHJlcXVpcmVk
LCBhbmQgd2UgY2FuJ3QganVzdCBmYWxsYmFjayB0byBQTEFJTlRFWFQKICAgICAgdGhyb3cg
bmV3IE9BdXRoRXhjZXB0aW9uKCdObyBzaWduYXR1cmUgbWV0aG9kIHBhcmFtZXRlci4gVGhp
cyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQnKTsKICAgIH0KCiAgICBpZiAoIWluX2FycmF5KCRz
aWduYXR1cmVfbWV0aG9kLAogICAgICAgICAgICAgICAgICBhcnJheV9rZXlzKCR0aGlzLT5z
aWduYXR1cmVfbWV0aG9kcykpKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigK
ICAgICAgICAiU2lnbmF0dXJlIG1ldGhvZCAnJHNpZ25hdHVyZV9tZXRob2QnIG5vdCBzdXBw
b3J0ZWQgIiAuCiAgICAgICAgInRyeSBvbmUgb2YgdGhlIGZvbGxvd2luZzogIiAuCiAgICAg
ICAgaW1wbG9kZSgiLCAiLCBhcnJheV9rZXlzKCR0aGlzLT5zaWduYXR1cmVfbWV0aG9kcykp
CiAgICAgICk7CiAgICB9CiAgICByZXR1cm4gJHRoaXMtPnNpZ25hdHVyZV9tZXRob2RzWyRz
aWduYXR1cmVfbWV0aG9kXTsKICB9CgogIC8qKgogICAqIHRyeSB0byBmaW5kIHRoZSBjb25z
dW1lciBmb3IgdGhlIHByb3ZpZGVkIHJlcXVlc3QncyBjb25zdW1lciBrZXkKICAgKi8KICBw
cml2YXRlIGZ1bmN0aW9uIGdldF9jb25zdW1lcigmJHJlcXVlc3QpIHsKICAgICRjb25zdW1l
cl9rZXkgPSBAJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoIm9hdXRoX2NvbnN1bWVyX2tleSIp
OwogICAgaWYgKCEkY29uc3VtZXJfa2V5KSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2Vw
dGlvbigiSW52YWxpZCBjb25zdW1lciBrZXkiKTsKICAgIH0KCiAgICAkY29uc3VtZXIgPSAk
dGhpcy0+ZGF0YV9zdG9yZS0+bG9va3VwX2NvbnN1bWVyKCRjb25zdW1lcl9rZXkpOwogICAg
aWYgKCEkY29uc3VtZXIpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJbnZh
bGlkIGNvbnN1bWVyIik7CiAgICB9CgogICAgcmV0dXJuICRjb25zdW1lcjsKICB9CgogIC8q
KgogICAqIHRyeSB0byBmaW5kIHRoZSB0b2tlbiBmb3IgdGhlIHByb3ZpZGVkIHJlcXVlc3Qn
cyB0b2tlbiBrZXkKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGdldF90b2tlbigmJHJlcXVl
c3QsICRjb25zdW1lciwgJHRva2VuX3R5cGU9ImFjY2VzcyIpIHsKICAgICR0b2tlbl9maWVs
ZCA9IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfdG9rZW4nKTsKICAgICR0b2tl
biA9ICR0aGlzLT5kYXRhX3N0b3JlLT5sb29rdXBfdG9rZW4oCiAgICAgICRjb25zdW1lciwg
JHRva2VuX3R5cGUsICR0b2tlbl9maWVsZAogICAgKTsKICAgIGlmICghJHRva2VuKSB7CiAg
ICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiSW52YWxpZCAkdG9rZW5fdHlwZSB0b2tl
bjogJHRva2VuX2ZpZWxkIik7CiAgICB9CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAgLyoq
CiAgICogYWxsLWluLW9uZSBmdW5jdGlvbiB0byBjaGVjayB0aGUgc2lnbmF0dXJlIG9uIGEg
cmVxdWVzdAogICAqIHNob3VsZCBndWVzcyB0aGUgc2lnbmF0dXJlIG1ldGhvZCBhcHByb3By
aWF0ZWx5CiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBjaGVja19zaWduYXR1cmUoJiRyZXF1
ZXN0LCAkY29uc3VtZXIsICR0b2tlbikgewogICAgLy8gdGhpcyBzaG91bGQgcHJvYmFibHkg
YmUgaW4gYSBkaWZmZXJlbnQgbWV0aG9kCiAgICAkdGltZXN0YW1wID0gQCRyZXF1ZXN0LT5n
ZXRfcGFyYW1ldGVyKCdvYXV0aF90aW1lc3RhbXAnKTsKICAgICRub25jZSA9IEAkcmVxdWVz
dC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfbm9uY2UnKTsKCiAgICAkdGhpcy0+Y2hlY2tfdGlt
ZXN0YW1wKCR0aW1lc3RhbXApOwogICAgJHRoaXMtPmNoZWNrX25vbmNlKCRjb25zdW1lciwg
JHRva2VuLCAkbm9uY2UsICR0aW1lc3RhbXApOwoKICAgICRzaWduYXR1cmVfbWV0aG9kID0g
JHRoaXMtPmdldF9zaWduYXR1cmVfbWV0aG9kKCRyZXF1ZXN0KTsKCiAgICAkc2lnbmF0dXJl
ID0gJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX3NpZ25hdHVyZScpOwogICAgJHZh
bGlkX3NpZyA9ICRzaWduYXR1cmVfbWV0aG9kLT5jaGVja19zaWduYXR1cmUoCiAgICAgICRy
ZXF1ZXN0LAogICAgICAkY29uc3VtZXIsCiAgICAgICR0b2tlbiwKICAgICAgJHNpZ25hdHVy
ZQogICAgKTsKCiAgICBpZiAoISR2YWxpZF9zaWcpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRo
RXhjZXB0aW9uKCJJbnZhbGlkIHNpZ25hdHVyZSIpOwogICAgfQogIH0KCiAgLyoqCiAgICog
Y2hlY2sgdGhhdCB0aGUgdGltZXN0YW1wIGlzIG5ldyBlbm91Z2gKICAgKi8KICBwcml2YXRl
IGZ1bmN0aW9uIGNoZWNrX3RpbWVzdGFtcCgkdGltZXN0YW1wKSB7CiAgICBpZiggISAkdGlt
ZXN0YW1wICkKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKAogICAgICAgICdNaXNz
aW5nIHRpbWVzdGFtcCBwYXJhbWV0ZXIuIFRoZSBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQnCiAg
ICAgICk7CgogICAgLy8gdmVyaWZ5IHRoYXQgdGltZXN0YW1wIGlzIHJlY2VudGlzaAogICAg
JG5vdyA9IHRpbWUoKTsKICAgIGlmIChhYnMoJG5vdyAtICR0aW1lc3RhbXApID4gJHRoaXMt
PnRpbWVzdGFtcF90aHJlc2hvbGQpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9u
KAogICAgICAgICJFeHBpcmVkIHRpbWVzdGFtcCwgeW91cnMgJHRpbWVzdGFtcCwgb3VycyAk
bm93IgogICAgICApOwogICAgfQogIH0KCiAgLyoqCiAgICogY2hlY2sgdGhhdCB0aGUgbm9u
Y2UgaXMgbm90IHJlcGVhdGVkCiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBjaGVja19ub25j
ZSgkY29uc3VtZXIsICR0b2tlbiwgJG5vbmNlLCAkdGltZXN0YW1wKSB7CiAgICBpZiggISAk
bm9uY2UgKQogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAgICAgJ01pc3Np
bmcgbm9uY2UgcGFyYW1ldGVyLiBUaGUgcGFyYW1ldGVyIGlzIHJlcXVpcmVkJwogICAgICAp
OwoKICAgIC8vIHZlcmlmeSB0aGF0IHRoZSBub25jZSBpcyB1bmlxdWVpc2gKICAgICRmb3Vu
ZCA9ICR0aGlzLT5kYXRhX3N0b3JlLT5sb29rdXBfbm9uY2UoCiAgICAgICRjb25zdW1lciwK
ICAgICAgJHRva2VuLAogICAgICAkbm9uY2UsCiAgICAgICR0aW1lc3RhbXAKICAgICk7CiAg
ICBpZiAoJGZvdW5kKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiTm9uY2Ug
YWxyZWFkeSB1c2VkOiAkbm9uY2UiKTsKICAgIH0KICB9Cgp9CgpjbGFzcyBPQXV0aERhdGFT
dG9yZSB7CiAgZnVuY3Rpb24gbG9va3VwX2NvbnN1bWVyKCRjb25zdW1lcl9rZXkpIHsKICAg
IC8vIGltcGxlbWVudCBtZQogIH0KCiAgZnVuY3Rpb24gbG9va3VwX3Rva2VuKCRjb25zdW1l
ciwgJHRva2VuX3R5cGUsICR0b2tlbikgewogICAgLy8gaW1wbGVtZW50IG1lCiAgfQoKICBm
dW5jdGlvbiBsb29rdXBfbm9uY2UoJGNvbnN1bWVyLCAkdG9rZW4sICRub25jZSwgJHRpbWVz
dGFtcCkgewogICAgLy8gaW1wbGVtZW50IG1lCiAgfQoKICBmdW5jdGlvbiBuZXdfcmVxdWVz
dF90b2tlbigkY29uc3VtZXIsICRjYWxsYmFjayA9IG51bGwpIHsKICAgIC8vIHJldHVybiBh
IG5ldyB0b2tlbiBhdHRhY2hlZCB0byB0aGlzIGNvbnN1bWVyCiAgfQoKICBmdW5jdGlvbiBu
ZXdfYWNjZXNzX3Rva2VuKCR0b2tlbiwgJGNvbnN1bWVyLCAkdmVyaWZpZXIgPSBudWxsKSB7
CiAgICAvLyByZXR1cm4gYSBuZXcgYWNjZXNzIHRva2VuIGF0dGFjaGVkIHRvIHRoaXMgY29u
c3VtZXIKICAgIC8vIGZvciB0aGUgdXNlciBhc3NvY2lhdGVkIHdpdGggdGhpcyB0b2tlbiBp
ZiB0aGUgcmVxdWVzdCB0b2tlbgogICAgLy8gaXMgYXV0aG9yaXplZAogICAgLy8gc2hvdWxk
IGFsc28gaW52YWxpZGF0ZSB0aGUgcmVxdWVzdCB0b2tlbgogIH0KCn0KCmNsYXNzIE9BdXRo
VXRpbCB7CiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiB1cmxlbmNvZGVfcmZjMzk4NigkaW5w
dXQpIHsKICBpZiAoaXNfYXJyYXkoJGlucHV0KSkgewogICAgcmV0dXJuIGFycmF5X21hcChh
cnJheSgnT0F1dGhVdGlsJywgJ3VybGVuY29kZV9yZmMzOTg2JyksICRpbnB1dCk7CiAgfSBl
bHNlIGlmIChpc19zY2FsYXIoJGlucHV0KSkgewogICAgcmV0dXJuIHN0cl9yZXBsYWNlKAog
ICAgICAnKycsCiAgICAgICcgJywKICAgICAgc3RyX3JlcGxhY2UoJyU3RScsICd+JywgcmF3
dXJsZW5jb2RlKCRpbnB1dCkpCiAgICApOwogIH0gZWxzZSB7CiAgICByZXR1cm4gJyc7CiAg
fQp9CgoKICAvLyBUaGlzIGRlY29kZSBmdW5jdGlvbiBpc24ndCB0YWtpbmcgaW50byBjb25z
aWRlcmF0aW9uIHRoZSBhYm92ZQogIC8vIG1vZGlmaWNhdGlvbnMgdG8gdGhlIGVuY29kaW5n
IHByb2Nlc3MuIEhvd2V2ZXIsIHRoaXMgbWV0aG9kIGRvZXNuJ3QKICAvLyBzZWVtIHRvIGJl
IHVzZWQgYW55d2hlcmUgc28gbGVhdmluZyBpdCBhcyBpcy4KICBwdWJsaWMgc3RhdGljIGZ1
bmN0aW9uIHVybGRlY29kZV9yZmMzOTg2KCRzdHJpbmcpIHsKICAgIHJldHVybiB1cmxkZWNv
ZGUoJHN0cmluZyk7CiAgfQoKICAvLyBVdGlsaXR5IGZ1bmN0aW9uIGZvciB0dXJuaW5nIHRo
ZSBBdXRob3JpemF0aW9uOiBoZWFkZXIgaW50bwogIC8vIHBhcmFtZXRlcnMsIGhhcyB0byBk
byBzb21lIHVuZXNjYXBpbmcKICAvLyBDYW4gZmlsdGVyIG91dCBhbnkgbm9uLW9hdXRoIHBh
cmFtZXRlcnMgaWYgbmVlZGVkIChkZWZhdWx0IGJlaGF2aW91cikKICBwdWJsaWMgc3RhdGlj
IGZ1bmN0aW9uIHNwbGl0X2hlYWRlcigkaGVhZGVyLCAkb25seV9hbGxvd19vYXV0aF9wYXJh
bWV0ZXJzID0gdHJ1ZSkgewogICAgJHBhdHRlcm4gPSAnLygoWy1fYS16XSopPSgiKFteIl0q
KSJ8KFteLF0qKSksPykvJzsKICAgICRvZmZzZXQgPSAwOwogICAgJHBhcmFtcyA9IGFycmF5
KCk7CiAgICB3aGlsZSAocHJlZ19tYXRjaCgkcGF0dGVybiwgJGhlYWRlciwgJG1hdGNoZXMs
IFBSRUdfT0ZGU0VUX0NBUFRVUkUsICRvZmZzZXQpID4gMCkgewogICAgICAkbWF0Y2ggPSAk
bWF0Y2hlc1swXTsKICAgICAgJGhlYWRlcl9uYW1lID0gJG1hdGNoZXNbMl1bMF07CiAgICAg
ICRoZWFkZXJfY29udGVudCA9IChpc3NldCgkbWF0Y2hlc1s1XSkpID8gJG1hdGNoZXNbNV1b
MF0gOiAkbWF0Y2hlc1s0XVswXTsKICAgICAgaWYgKHByZWdfbWF0Y2goJy9eb2F1dGhfLycs
ICRoZWFkZXJfbmFtZSkgfHwgISRvbmx5X2FsbG93X29hdXRoX3BhcmFtZXRlcnMpIHsKICAg
ICAgICAkcGFyYW1zWyRoZWFkZXJfbmFtZV0gPSBPQXV0aFV0aWw6OnVybGRlY29kZV9yZmMz
OTg2KCRoZWFkZXJfY29udGVudCk7CiAgICAgIH0KICAgICAgJG9mZnNldCA9ICRtYXRjaFsx
XSArIHN0cmxlbigkbWF0Y2hbMF0pOwogICAgfQoKICAgIGlmIChpc3NldCgkcGFyYW1zWydy
ZWFsbSddKSkgewogICAgICB1bnNldCgkcGFyYW1zWydyZWFsbSddKTsKICAgIH0KCiAgICBy
ZXR1cm4gJHBhcmFtczsKICB9CgogIC8vIGhlbHBlciB0byB0cnkgdG8gc29ydCBvdXQgaGVh
ZGVycyBmb3IgcGVvcGxlIHdobyBhcmVuJ3QgcnVubmluZyBhcGFjaGUKICBwdWJsaWMgc3Rh
dGljIGZ1bmN0aW9uIGdldF9oZWFkZXJzKCkgewogICAgaWYgKGZ1bmN0aW9uX2V4aXN0cygn
YXBhY2hlX3JlcXVlc3RfaGVhZGVycycpKSB7CiAgICAgIC8vIHdlIG5lZWQgdGhpcyB0byBn
ZXQgdGhlIGFjdHVhbCBBdXRob3JpemF0aW9uOiBoZWFkZXIKICAgICAgLy8gYmVjYXVzZSBh
cGFjaGUgdGVuZHMgdG8gdGVsbCB1cyBpdCBkb2Vzbid0IGV4aXN0CiAgICAgICRoZWFkZXJz
ID0gYXBhY2hlX3JlcXVlc3RfaGVhZGVycygpOwoKICAgICAgLy8gc2FuaXRpemUgdGhlIG91
dHB1dCBvZiBhcGFjaGVfcmVxdWVzdF9oZWFkZXJzIGJlY2F1c2UKICAgICAgLy8gd2UgYWx3
YXlzIHdhbnQgdGhlIGtleXMgdG8gYmUgQ2FzZWQtTGlrZS1UaGlzIGFuZCBhcmgoKQogICAg
ICAvLyByZXR1cm5zIHRoZSBoZWFkZXJzIGluIHRoZSBzYW1lIGNhc2UgYXMgdGhleSBhcmUg
aW4gdGhlCiAgICAgIC8vIHJlcXVlc3QKICAgICAgJG91dCA9IGFycmF5KCk7CiAgICAgIGZv
cmVhY2goICRoZWFkZXJzIEFTICRrZXkgPT4gJHZhbHVlICkgewogICAgICAgICRrZXkgPSBz
dHJfcmVwbGFjZSgKICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAiLSIsCiAgICAgICAg
ICAgIHVjd29yZHMoc3RydG9sb3dlcihzdHJfcmVwbGFjZSgiLSIsICIgIiwgJGtleSkpKQog
ICAgICAgICAgKTsKICAgICAgICAkb3V0WyRrZXldID0gJHZhbHVlOwogICAgICB9CiAgICB9
IGVsc2UgewogICAgICAvLyBvdGhlcndpc2Ugd2UgZG9uJ3QgaGF2ZSBhcGFjaGUgYW5kIGFy
ZSBqdXN0IGdvaW5nIHRvIGhhdmUgdG8gaG9wZQogICAgICAvLyB0aGF0ICRfU0VSVkVSIGFj
dHVhbGx5IGNvbnRhaW5zIHdoYXQgd2UgbmVlZAogICAgICAkb3V0ID0gYXJyYXkoKTsKICAg
ICAgaWYoIGlzc2V0KCRfU0VSVkVSWydDT05URU5UX1RZUEUnXSkgKQogICAgICAgICRvdXRb
J0NvbnRlbnQtVHlwZSddID0gJF9TRVJWRVJbJ0NPTlRFTlRfVFlQRSddOwogICAgICBpZigg
aXNzZXQoJF9FTlZbJ0NPTlRFTlRfVFlQRSddKSApCiAgICAgICAgJG91dFsnQ29udGVudC1U
eXBlJ10gPSAkX0VOVlsnQ09OVEVOVF9UWVBFJ107CgogICAgICBmb3JlYWNoICgkX1NFUlZF
UiBhcyAka2V5ID0+ICR2YWx1ZSkgewogICAgICAgIGlmIChzdWJzdHIoJGtleSwgMCwgNSkg
PT0gIkhUVFBfIikgewogICAgICAgICAgLy8gdGhpcyBpcyBjaGFvcywgYmFzaWNhbGx5IGl0
IGlzIGp1c3QgdGhlcmUgdG8gY2FwaXRhbGl6ZSB0aGUgZmlyc3QKICAgICAgICAgIC8vIGxl
dHRlciBvZiBldmVyeSB3b3JkIHRoYXQgaXMgbm90IGFuIGluaXRpYWwgSFRUUCBhbmQgc3Ry
aXAgSFRUUAogICAgICAgICAgLy8gY29kZSBmcm9tIHByemVtZWsKICAgICAgICAgICRrZXkg
PSBzdHJfcmVwbGFjZSgKICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAiLSIsCiAgICAg
ICAgICAgIHVjd29yZHMoc3RydG9sb3dlcihzdHJfcmVwbGFjZSgiXyIsICIgIiwgc3Vic3Ry
KCRrZXksIDUpKSkpCiAgICAgICAgICApOwogICAgICAgICAgJG91dFska2V5XSA9ICR2YWx1
ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHJldHVybiAkb3V0OwogIH0KCiAgLy8g
VGhpcyBmdW5jdGlvbiB0YWtlcyBhIGlucHV0IGxpa2UgYT1iJmE9YyZkPWUgYW5kIHJldHVy
bnMgdGhlIHBhcnNlZAogIC8vIHBhcmFtZXRlcnMgbGlrZSB0aGlzCiAgLy8gYXJyYXkoJ2En
ID0+IGFycmF5KCdiJywnYycpLCAnZCcgPT4gJ2UnKQogIHB1YmxpYyBzdGF0aWMgZnVuY3Rp
b24gcGFyc2VfcGFyYW1ldGVycyggJGlucHV0ICkgewogICAgaWYgKCFpc3NldCgkaW5wdXQp
IHx8ICEkaW5wdXQpIHJldHVybiBhcnJheSgpOwoKICAgICRwYWlycyA9IGV4cGxvZGUoJyYn
LCAkaW5wdXQpOwoKICAgICRwYXJzZWRfcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICBmb3Jl
YWNoICgkcGFpcnMgYXMgJHBhaXIpIHsKICAgICAgJHNwbGl0ID0gZXhwbG9kZSgnPScsICRw
YWlyLCAyKTsKICAgICAgJHBhcmFtZXRlciA9IE9BdXRoVXRpbDo6dXJsZGVjb2RlX3JmYzM5
ODYoJHNwbGl0WzBdKTsKICAgICAgJHZhbHVlID0gaXNzZXQoJHNwbGl0WzFdKSA/IE9BdXRo
VXRpbDo6dXJsZGVjb2RlX3JmYzM5ODYoJHNwbGl0WzFdKSA6ICcnOwoKICAgICAgaWYgKGlz
c2V0KCRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSkpIHsKICAgICAgICAvLyBXZSBo
YXZlIGFscmVhZHkgcmVjaWV2ZWQgcGFyYW1ldGVyKHMpIHdpdGggdGhpcyBuYW1lLCBzbyBh
ZGQgdG8gdGhlIGxpc3QKICAgICAgICAvLyBvZiBwYXJhbWV0ZXJzIHdpdGggdGhpcyBuYW1l
CgogICAgICAgIGlmIChpc19zY2FsYXIoJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJd
KSkgewogICAgICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3QgZHVwbGljYXRlLCBzbyB0cmFu
c2Zvcm0gc2NhbGFyIChzdHJpbmcpIGludG8gYW4gYXJyYXkKICAgICAgICAgIC8vIHNvIHdl
IGNhbiBhZGQgdGhlIGR1cGxpY2F0ZXMKICAgICAgICAgICRwYXJzZWRfcGFyYW1ldGVyc1sk
cGFyYW1ldGVyXSA9IGFycmF5KCRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSk7CiAg
ICAgICAgfQoKICAgICAgICAkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl1bXSA9ICR2
YWx1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICAkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFt
ZXRlcl0gPSAkdmFsdWU7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiAkcGFyc2VkX3BhcmFt
ZXRlcnM7CiAgfQoKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGJ1aWxkX2h0dHBfcXVlcnko
JHBhcmFtcykgewogICAgaWYgKCEkcGFyYW1zKSByZXR1cm4gJyc7CgogICAgLy8gVXJsZW5j
b2RlIGJvdGgga2V5cyBhbmQgdmFsdWVzCiAgICAka2V5cyA9IE9BdXRoVXRpbDo6dXJsZW5j
b2RlX3JmYzM5ODYoYXJyYXlfa2V5cygkcGFyYW1zKSk7CiAgICAkdmFsdWVzID0gT0F1dGhV
dGlsOjp1cmxlbmNvZGVfcmZjMzk4NihhcnJheV92YWx1ZXMoJHBhcmFtcykpOwogICAgJHBh
cmFtcyA9IGFycmF5X2NvbWJpbmUoJGtleXMsICR2YWx1ZXMpOwoKICAgIC8vIFBhcmFtZXRl
cnMgYXJlIHNvcnRlZCBieSBuYW1lLCB1c2luZyBsZXhpY29ncmFwaGljYWwgYnl0ZSB2YWx1
ZSBvcmRlcmluZy4KICAgIC8vIFJlZjogU3BlYzogOS4xLjEgKDEpCiAgICB1a3NvcnQoJHBh
cmFtcywgJ3N0cmNtcCcpOwoKICAgICRwYWlycyA9IGFycmF5KCk7CiAgICBmb3JlYWNoICgk
cGFyYW1zIGFzICRwYXJhbWV0ZXIgPT4gJHZhbHVlKSB7CiAgICAgIGlmIChpc19hcnJheSgk
dmFsdWUpKSB7CiAgICAgICAgLy8gSWYgdHdvIG9yIG1vcmUgcGFyYW1ldGVycyBzaGFyZSB0
aGUgc2FtZSBuYW1lLCB0aGV5IGFyZSBzb3J0ZWQgYnkgdGhlaXIgdmFsdWUKICAgICAgICAv
LyBSZWY6IFNwZWM6IDkuMS4xICgxKQogICAgICAgIG5hdHNvcnQoJHZhbHVlKTsKICAgICAg
ICBmb3JlYWNoICgkdmFsdWUgYXMgJGR1cGxpY2F0ZV92YWx1ZSkgewogICAgICAgICAgJHBh
aXJzW10gPSAkcGFyYW1ldGVyIC4gJz0nIC4gJGR1cGxpY2F0ZV92YWx1ZTsKICAgICAgICB9
CiAgICAgIH0gZWxzZSB7CiAgICAgICAgJHBhaXJzW10gPSAkcGFyYW1ldGVyIC4gJz0nIC4g
JHZhbHVlOwogICAgICB9CiAgICB9CiAgICAvLyBGb3IgZWFjaCBwYXJhbWV0ZXIsIHRoZSBu
YW1lIGlzIHNlcGFyYXRlZCBmcm9tIHRoZSBjb3JyZXNwb25kaW5nIHZhbHVlIGJ5IGFuICc9
JyBjaGFyYWN0ZXIgKEFTQ0lJIGNvZGUgNjEpCiAgICAvLyBFYWNoIG5hbWUtdmFsdWUgcGFp
ciBpcyBzZXBhcmF0ZWQgYnkgYW4gJyYnIGNoYXJhY3RlciAoQVNDSUkgY29kZSAzOCkKICAg
IHJldHVybiBpbXBsb2RlKCcmJywgJHBhaXJzKTsKICB9Cn0iO3M6MzoibWQ1IjtzOjMyOiJj
OGEyODdkZDk4Y2RmM2JiOWNmZmNkMjg5ODQ4NjkxZSI7fQ==
