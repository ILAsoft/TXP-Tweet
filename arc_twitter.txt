# arc_twitter v3.0-dev
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjc6
IjMuMC1kZXYiO3M6NjoiYXV0aG9yIjtzOjExOiJBbmR5IENhcnRlciI7czoxMDoiYXV0aG9y
X3VyaSI7czozMToiaHR0cDovL3JlZGhvdGNoaWxsaXByb2plY3QuY29tLyI7czoxMToiZGVz
Y3JpcHRpb24iO3M6NjA6IjxhIGhyZWY9Imh0dHA6Ly93d3cudHdpdHRlci5jb20iPlR3aXR0
ZXI8L2E+IGZvciBUZXh0cGF0dGVybiI7czo1OiJvcmRlciI7czoxOiI1IjtzOjQ6InR5cGUi
O3M6MToiMSI7czo1OiJmbGFncyI7czoxOiIzIjtzOjQ6ImhlbHAiO3M6MTU1NTA6Igk8aDEg
Y2xhc3M9InRpdGxlIj48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCAoYXJj
X3R3aXR0ZXIgZm9yIFRleHRwYXR0ZXJuKTwvaDE+CgoJPG9sPgoJCTxsaT48YSBocmVmPSIj
YXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2Fy
Y190d2l0dGVyX2luc3RhbGxhdGlvbiI+SW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxsYXRpb248
L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3RhZyI+VGhlIGFyY190d2l0
dGVyIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfc2VhcmNoX3Rh
ZyI+VGhlIGFyY190d2l0dGVyX3NlYXJjaCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0i
I2FyY190d2l0dGVyX3JldHdlZXRfdGFnIj5UaGUgYXJjX3R3aXR0ZXJfcmV0d2VldCB0YWc8
L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3R3ZWV0X3VybCI+VGhlIGFy
Y190d2l0dGVyX3R3ZWV0X3VybCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190
d2l0dGVyX3Rpbnl1cmwiPlRoZSBhcmNfdHdpdHRlcl90aW55dXJsIHRhZzwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfY2FjaGluZyI+Q2FjaGluZzwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfcHJlZnMiPlByZWZlcmVuY2VzPC9hPjwvbGk+
CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl9hcnRpY2xlIj5Ud2VldGluZyBhcnRpY2xl
czwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfYWRtaW4iPlRoZSBUd2l0
dGVyIHRhYjwvYT48L2xpPgoJPC9vbD4KCgk8cD48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9z
cGFuPiBUd2VldCBwcm92aWRlcyBhY2Nlc3MgdG8geW91ciBUd2l0dGVyIGFjY291bnQgdGhy
b3VnaCBib3RoIHRoZSBhZG1pbiBpbnRlcmZhY2UgYW5kIHRoZSBwdWJsaWMgc2lkZSBvZiB5
b3VyIHNpdGUuIFVwZGF0ZSBUd2l0dGVyIHdoZW4geW91IHBvc3QgYSBuZXcgYXJ0aWNsZSAo
d2l0aCBhcnRpY2xlLWJ5LWFydGljbGUgb3B0IG91dCBvcHRpb24pLCB1cGRhdGUgYW5kIHZp
ZXcgeW91ciBUd2l0dGVyIGZlZWQgdGhyb3VnaCB0aGUgYWRtaW4gVHdpdHRlciB0YWIsIGFu
ZCBkaXNwbGF5IFR3aXR0ZXIgZmVlZHMgb24geW91ciBzaXRlLjwvcD4KCgk8cD5SZXF1aXJl
bWVudHM6LTwvcD4KCgk8dWw+CgkJPGxpPlRleHRwYXR0ZXJuIDQuMis8L2xpPgoJCTxsaT48
c3BhbiBjbGFzcz0iY2FwcyI+UEhQPC9zcGFuPiA1IGFuZCBjVVJMPC9saT4KCTwvdWw+CgoJ
PGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2gy
PgoKCTxwPjxhIGhyZWY9Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbSI+QW5keSBD
YXJ0ZXI8L2E+LiBGb3Igb3RoZXIgVGV4dHBhdHRlcm4gcGx1Z2lucyBieSBtZSB2aXNpdCBt
eSA8YSBocmVmPSJodHRwOi8vcmVkaG90Y2hpbGxpcHJvamVjdC5jb20vdHhwIj5QbHVnaW5z
IHBhZ2U8L2E+LjwvcD4KCgk8cD5UaGFua3MgdG8gPGEgaHJlZj0iaHR0cDovL21hbmZyZS5u
ZXQvIj5NaWNoYWVsIE1hbmZyZTwvYT4gZm9yIGluc3BpcmF0aW9uIGZvciB0aGUgYXJ0aWNs
ZSB0d2VldCBwYXJ0IG9mIHRoaXMgcGx1Z2luIGJhc2VkIG9uIGhpcyA8c3BhbiBjbGFzcz0i
dGFnIj5tZW1fdHdpdHRlcjwvc3Bhbj4gcGx1Z2luLiAgQWRkaXRpb25hbCB0aGFua3MgdG8g
dGhlIGdyZWF0IFRleHRwYXR0ZXJuIGNvbW11bml0eSBmb3IgaGVscGluZyB0byB0ZXN0IHRo
aXMgcGx1Z2luIGFuZCBmb3Igc3VnZ2VzdGluZyBuZXcgZmVhdHVyZXMuIFRoZSBPQXV0aCBw
YXJ0IG9mIHRoZSBwbHVnaW4gaXMgdGhhbmtzIHRvIDxhIGhyZWY9Imh0dHA6Ly90d2l0dGVy
LmNvbS9hYnJhaGFtIj5BYnJhaGFtIFdpbGxpYW1zPC9hPi48L3A+CgoJPGgyIGNsYXNzPSJz
ZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfaW5zdGFsbGF0aW9uIj5JbnN0YWxsYXRpb24gLyBV
bmluc3RhbGxhdGlvbjwvaDI+CgoJPHA+VG8gaW5zdGFsbCBnbyB0byB0aGUgJiM4MjE2O3Bs
dWdpbnMmIzgyMTc7IHRhYiB1bmRlciAmIzgyMTY7YWRtaW4mIzgyMTc7IGFuZCBwYXN0ZSB0
aGUgcGx1Z2luIGNvZGUgaW50byB0aGUgJiM4MjE2O0luc3RhbGwgcGx1Z2luJiM4MjE3OyBi
b3gsICYjODIxNjt1cGxvYWQmIzgyMTc7IGFuZCB0aGVuICYjODIxNjtpbnN0YWxsJiM4MjE3
Oy4gRmluYWxseSBhY3RpdmF0ZSB0aGUgcGx1Z2luLjwvcD4KCgk8cD5CZWZvcmUgeW91IHN0
YXJ0IHVzaW5nIDxzcGFuIGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiB5b3Ugd2ls
bCBuZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IHRoZSBjYWNoZSBkaXJlY3RvcnkgaXMgd3JpdGFi
bGUuIFNlZSB0aGUgJiM4MjE2O0NhY2hpbmcmIzgyMTc7IHN1YnNlY3Rpb24gYmVsb3cgZm9y
IGZ1cnRoZXIgaW5mb3JtYXRpb24uPC9wPgoKCTxwPjxzcGFuIGNsYXNzPSJ0YWciPmFyY190
d2l0dGVyPC9zcGFuPiBzaG91bGQgbm93IGJlIHJlYWR5IGZvciB1c2Ugb24gdGhlIHB1Ymxp
Yy1zaWRlIG9mIHlvdXIgc2l0ZS48L3A+CgoJPHA+VG8gdW5sb2NrIHRoZSBhZG1pbiBmZWF0
dXJlcyBvZiB0aGlzIHBsdWdpbiB5b3Ugd2lsbCBuZWVkIHRvIGFzc29jaWF0ZSB5b3VyIHNp
dGUgd2l0aCBhIFR3aXR0ZXIgYWNjb3VudCBieSBjb25uZWN0aW5nIHRvIFR3aXR0ZXIgZnJv
bSB0aGUgcGx1Z2luJiM4MjE3O3Mgb3B0aW9ucyBzY3JlZW4uIENsaWNrIG9uIHRoZSBsaW5r
IHRvIGNvbm5lY3QgdG8gVHdpdHRlciwgeW91IHdpbGwgYmUgYXNrZWQgdG8gbG9naW4gdG8g
VHdpdHRlciwgY2xpY2tpbmcgdGhpcyBsaW5rIHdpbGwgdGVtcG9yYXJpbHkgdGFrZSB5b3Ug
dG8gdGhlIFR3aXR0ZXIgc2l0ZSB3aGVyZSB5b3Ugd2lsbCBiZSBhc2tlZCB0byBsb2dpbiBh
bmQgYXBwcm92ZSBhY2Nlc3MgZm9yIDxzcGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3
ZWV0IHRvIHJlYWQgYW5kIHdyaXRlIHRvIHlvdXIgVHdpdHRlciBhY2NvdW50LiBJZiBhbGwg
aXMgc3VjY2Vzc2Z1bCB5b3Ugd2lsbCBiZSByZXR1cm5lZCB0byB0aGUgb3B0aW9ucyBzY3Jl
ZW4gYW5kIHlvdXIgdXNlciBuYW1lIHdpbGwgYXBwZWFyLjwvcD4KCgk8cD5BdCBhbnkgdGlt
ZSB5b3UgY2FuIGRpc2Fzc29jaWF0ZSB5b3VyIFR3aXR0ZXIgYWNjb3VudCB3aXRoIDxzcGFu
IGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0IHZpYSB5b3VyIFR3aXR0ZXIgYWNjb3Vu
dCBwcmVmZXJlbmNlcyBvbiB0aGUgPGEgaHJlZj0iaHR0cDovL3d3dy50d2l0dGVyLmNvbSI+
VHdpdHRlciB3ZWJzaXRlPC9hPi48L3A+CgoJPHA+VG8gdW5pbnN0YWxsIDxzcGFuIGNsYXNz
PSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiBzaW1wbHkgZGVsZXRlIHRoZSBwbHVnaW4gZnJv
bSB0aGUgJiM4MjE2O1BsdWdpbnMmIzgyMTc7IHRhYi4gIFRoaXMgd2lsbCByZW1vdmUgdGhl
IHBsdWdpbiBjb2RlLCBkZWxldGUgcmVsYXRlZCBwcmVmZXJlbmNlcyBhbmQgZHJvcCB0aGUg
PHNwYW4gY2xhc3M9InRhZyI+YXJjX3R3aXR0ZXI8L3NwYW4+IHRhYmxlIGZyb20geW91ciBU
ZXh0cGF0dGVybiBkYXRhYmFzZS48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJj
X3R3aXR0ZXJfdGFnIj5UaGUgYXJjX3R3aXR0ZXIgdGFnPC9oMj4KCgk8aDM+U3ludGF4PC9o
Mz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyIHVzZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZx
dW90OyAvJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0
aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVs
dDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVzZXI8
L3RkPgoJCQk8dGQ+VHdpdHRlciB1c2VyIG5hbWU8L3RkPgoJCQk8dGQ+IDxlbT5hcmNfdHdp
dHRlciB1c2VybmFtZTwvZW0+PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXluaW5q
YSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5saW1pdDwvdGQ+CgkJCTx0ZD5N
YXhpbXVtIG51bWJlciBvZiB0d2VldHMgdG8gZGlzcGxheSAobWF4LiAyMDApPC90ZD4KCQkJ
PHRkPjEwPC90ZD4KCQkJPHRkPmxpbWl0PSZxdW90OzI1JnF1b3Q7PC90ZD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmRhdGVmb3JtYXQ8L3RkPgoJCQk8dGQ+Rm9ybWF0IHRoYXQgdXBkYXRl
IGRhdGVzIHdpbGwgYXBwZWFyIGFzPC90ZD4KCQkJPHRkPiA8ZW0+QXJjaGl2ZSBkYXRlIGZv
cm1hdDwvZW0+PC90ZD4KCQkJPHRkPmRhdGVmb3JtYXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAl
cCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbDwvdGQ+CgkJCTx0ZD5M
YWJlbCBmb3IgdGhlIHRvcCBvZiB0aGUgbGlzdDwvdGQ+CgkJCTx0ZD4gPGVtPm5vIGxhYmVs
PC9lbT48L3RkPgoJCQk8dGQ+bGFiZWw9JnF1b3Q7TXkgVHdpdHRlciB0aW1lbGluZSZxdW90
OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbHRhZzwvdGQ+CgkJCTx0ZD5JbmRl
cGVuZGVudCB3cmFwdGFnIGZvciBsYWJlbDwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48
L3RkPgoJCQk8dGQ+bGFiZWx0YWc9JnF1b3Q7aDMmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRy
PgoJCQk8dGQ+YnJlYWs8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNs
YXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnICh3aXRob3V0IGJyYWNrZXRzKSwg
b3Igc3RyaW5nLCB1c2VkIHRvIHNlcGFyYXRlIHRoZSB1cGRhdGVzPC90ZD4KCQkJPHRkPmxp
PC90ZD4KCQkJPHRkPmJyZWFrPSZxdW90O2JyJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4K
CQkJPHRkPndyYXB0YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNs
YXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVzZWQgYXMgdGhlIHdy
YXB0YWcsIHdpdGhvdXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90
ZD4KCQkJPHRkPndyYXB0YWc9JnF1b3Q7dWwmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJ
CQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNz
PSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgZm9yIHdyYXB0YWc8
L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXI8L3RkPgoJCQk8dGQ+Y2xhc3M9JnF1b3Q7dHdpdHRl
ciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzc19wb3N0ZWQ8L3RkPgoJ
CQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+
PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byBzcGFuIHRhZyBhcm91bmQgcG9z
dGVkIGRhdGU8L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXItcG9zdGVkPC90ZD4KCQk8L3RyPgoJ
PC90YWJsZT4KCgk8aDM+RXhhbXBsZSB1c2FnZTwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdp
dHRlciB1c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDsgbGltaXQ9JnF1b3Q7NSZxdW90
OyB3cmFwdGFnPSZxdW90O3VsJnF1b3Q7IGJyZWFrPSZxdW90O2xpJnF1b3Q7IGRhdGVmb3Jt
YXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAlcCZxdW90OyAvJmd0OzwvcD4KCgk8cD5Qcm9kdWNl
cyBhIGJ1bGxldCBwb2ludCBsaXN0IG9mIHRoZSBsYXN0IDUgVHdpdHRlciB1cGRhdGVzIGZy
b20gZHJtb25rZXluaW5qYSYjODIxNztzIFR3aXR0ZXIgZmVlZCB3aXRoIGEgZGVmaW5lZCBk
YXRlIGZvcm1hdCB0byBvdmVycmlkZSB0aGUgZGVmYXVsdCBhcmNoaXZlIGRhdGUgZm9ybWF0
LjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9zZWFyY2hfdGFn
Ij5UaGUgYXJjX3R3aXR0ZXJfc2VhcmNoIHRhZzwvaDI+CgoJPGgzPlN5bnRheDwvaDM+CgoJ
PHA+Jmx0O3R4cDphcmNfdHdpdHRlcl9zZWFyY2ggaGFzaHRhZ3M9JnF1b3Q7dHhwJnF1b3Q7
IC8mZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0
dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90
aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+c2VhcmNoPC90
ZD4KCQkJPHRkPkNvbW1hIHNlcGFyYXRlZCBsaXN0IG9mIHNlYXJjaCB3b3JkczwvdGQ+CgkJ
CTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+c2VhcmNoPSZxdW90O3R4cCx0ZXh0
cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5oYXNodGFnczwvdGQ+
CgkJCTx0ZD5Db21tYSBzZXBhcmF0ZWQgbGlzdCBvZiBoYXNodGFncyB0byBzZWFyY2ggZm9y
IChub3QgaW5jbHVkaW5nIHRoZSBoYXNoKTwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48
L3RkPgoJCQk8dGQ+aGFzaHRhZ3M9JnF1b3Q7dHhwLHRleHRwYXR0ZXJuJnF1b3Q7PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPnJlcGx5PC90ZD4KCQkJPHRkPlVzZXJuYW1lIG9mIHR3
ZWV0cyBpbiByZXBseSB0bzwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8
dGQ+cmVwbHk9JnF1b3Q7dHdpdHRlciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5tZW50aW9uPC90ZD4KCQkJPHRkPlVzZXJuYW1lIG9mIHVzZXIgbWVudGlvbmVkIGluIHR3
ZWV0cyAoPGk+aS5lLjwvaT4gdHdlZXRzIGNvbnRhaW5pbmcgQHVzZXJuYW1lKTwvdGQ+CgkJ
CTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+bWVudGlvbj0mcXVvdDt0d2l0dGVy
JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxpbWl0PC90ZD4KCQkJPHRkPk1h
eGltdW0gbnVtYmVyIG9mIHR3ZWV0cyB0byBkaXNwbGF5IChtYXguIDIwMCk8L3RkPgoJCQk8
dGQ+MTA8L3RkPgoJCQk8dGQ+bGltaXQ9JnF1b3Q7MjUmcXVvdDs8L3RkPgoJCTwvdHI+CgkJ
PHRyPgoJCQk8dGQ+ZGF0ZWZvcm1hdDwvdGQ+CgkJCTx0ZD5Gb3JtYXQgdGhhdCB1cGRhdGUg
ZGF0ZXMgd2lsbCBhcHBlYXIgYXM8L3RkPgoJCQk8dGQ+IDxlbT5BcmNoaXZlIGRhdGUgZm9y
bWF0PC9lbT48L3RkPgoJCQk8dGQ+ZGF0ZWZvcm1hdD0mcXVvdDslYiAlT2UsICVJOiVNICVw
JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsPC90ZD4KCQkJPHRkPkxh
YmVsIGZvciB0aGUgdG9wIG9mIHRoZSBsaXN0PC90ZD4KCQkJPHRkPiA8ZW0+bm8gbGFiZWw8
L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbHRhZzwvdGQ+CgkJCTx0ZD5J
bmRlcGVuZGVudCB3cmFwdGFnIGZvciBsYWJlbDwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9l
bT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+YnJlYWs8L3RkPgoJCQk8dGQ+PHNwYW4g
Y2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFn
ICh3aXRob3V0IGJyYWNrZXRzKSwgb3Igc3RyaW5nLCB1c2VkIHRvIHNlcGFyYXRlIHRoZSB1
cGRhdGVzPC90ZD4KCQkJPHRkPmxpPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPndyYXB0
YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5I
VE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVzZWQgYXMgdGhlIHdyYXB0YWcsIHdpdGhv
dXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3Bh
biBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGZvciB3
cmFwdGFnPC90ZD4KCQkJPHRkPmFyY190d2l0dGVyX3NlYXJjaDwvdGQ+CgkJPC90cj4KCQk8
dHI+CgkJCTx0ZD5jbGFzc191c2VyPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48
c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFw
cGxpZWQgdG8gc3BhbiB0YWcgYXJvdW5kIHVzZXIgbmFtZTwvdGQ+CgkJCTx0ZD5hcmNfdHdp
dHRlci11c2VyPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzX3Bvc3RlZDwvdGQ+
CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bh
bj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHNwYW4gdGFnIGFyb3VuZCBw
b3N0ZWQgZGF0ZTwvdGQ+CgkJCTx0ZD5hcmNfdHdpdHRlci1wb3N0ZWQ8L3RkPgoJCTwvdHI+
Cgk8L3RhYmxlPgoKCTxoMz5FeGFtcGxlIHVzYWdlPC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190
d2l0dGVyX3NlYXJjaCBzZWFyY2g9JnF1b3Q7cGx1Z2luJnF1b3Q7IGhhc2h0YWdzPSZxdW90
O3R4cCx0ZXh0cGF0dGVybiZxdW90OyBsaW1pdD0mcXVvdDsyNSZxdW90OyAvJmd0OzwvcD4K
Cgk8cD5Qcm9kdWNlcyBhIGxpc3Qgb2YgdHdlZXRzIGNvbnRhaW5pbmcgdGhlIHdvcmQgJiM4
MjE2O3BsdWdpbiYjODIxNzsgYW5kIHRoZSBoYXNodGFncyAmIzgyMTY7I3R4cCYjODIxNzsg
YW5kICYjODIxNjsjdGV4dHBhdHRlcm4mIzgyMTc7LiBUaGUgdGFnIHdpbGwgcmV0dXJuIGEg
bWF4aW11bSBvZiAyNSB0d2VldHMuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFy
Y190d2l0dGVyX3JldHdlZXRfdGFnIj5UaGUgYXJjX3R3aXR0ZXJfdHdlZXRfYnV0dG9uIHRh
ZzwvaDI+CgoJPHA+T3V0cHV0cyB0aGUgVHdpdHRlciB0d2VldCBidXR0b24gKGZvcm1lcmx5
ICZsdDt0eHA6YXJjX3R3aXR0ZXJfcmV0d2VldCAvJmd0OykuPC9wPgoKCTxoMz5TeW50YXg8
L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfdHdlZXRfYnV0dG9uIC8mZ3Q7PC9wPgoK
CTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwvdGg+
CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRoPkV4
YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+dXNlcjwvdGQ+CgkJCTx0ZD5Ud2l0
dGVyIHVzZXIgbmFtZSB0byBxdW90ZTwvdGQ+CgkJCTx0ZD4gPGVtPmFyY190d2l0dGVyIHVz
ZXJuYW1lPC9lbT48L3RkPgoJCQk8dGQ+dXNlcj0mcXVvdDtkcm1vbmtleW5pbmphJnF1b3Q7
PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVybDwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFz
cz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj48L3NwYW4+IHRvIHR3ZWV0
PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnRleHQ8L3RkPgoJCQk8dGQ+VHdlZXQgdGV4
dDwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5mb2xsb3cxPC90ZD4KCQkJPHRkPlN1Z2dl
c3RlZCBUd2l0dGVyIGFjY291bnQgdG8gZm9sbG93LCBmb3IgZXhhbXBsZSB5b3VyIG93bjwv
dGQ+CgkJCTx0ZD5BIFR3aXR0ZXIgdXNlciB0byByZWNvbW1lbmQ8L3RkPgoJCQk8dGQ+Zm9s
bG93MT0mcXVvdDtUZXh0cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5mb2xsb3cyPC90ZD4KCQkJPHRkPkFzIGZvbGxvdzE8L3RkPgoJCQk8dGQ+IDxlbT51bnNl
dDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhbmc8L3RkPgoJCQk8dGQ+TGFu
Z3VhZ2U8L3RkPgoJCQk8dGQ+ZW48L3RkPgoJCQk8dGQ+bGFuZz0mcXVvdDtlcyZxdW90Ozwv
dGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jb3VudDwvdGQ+CgkJCTx0ZD5Db3VudCBib3gg
cG9zaXRpb24sIG9wdGlvbnM6IG5vbmUsIGhvcml6b250YWwgb3IgdmVydGljYWw8L3RkPgoJ
CQk8dGQ+aG9yaXpvbnRhbDwvdGQ+CgkJCTx0ZD5jb3VudD0mcXVvdDtub25lJnF1b3Q7PC90
ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmluY2x1ZGVfanM8L3RkPgoJCQk8dGQ+V2hldGhl
ciBvciBub3QgdG8gaW5jbHVkZSB0aGUgSmF2YVNjcmlwdDwvdGQ+CgkJCTx0ZD4xPC90ZD4K
CQkJPHRkPmluY2x1ZGVfanM9JnF1b3Q7MCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJ
CTx0ZD53cmFwdGFnPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFz
cz0iY2FwcyI+SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyB0byBiZSB1c2VkIGFzIHRoZSB3cmFw
dGFnLCB3aXRob3V0IGJyYWNrZXRzPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+
CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0i
Y2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJp
YnV0ZSBhcHBsaWVkIHRvIHRoZSByZXR3ZWV0IGJ1dHRvbjwvdGQ+CgkJCTx0ZD50d2l0dGVy
LXNoYXJlLWJ1dHRvbjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPGgyIGNsYXNzPSJzZWN0
aW9uIiBpZD0iYXJjX3R3aXR0ZXJfdHdlZXRfdXJsIj5hcmNfdHdpdHRlcl90d2VldF91cmw8
L2gyPgoKCTxwPlJldHVybnMgdGhlIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+IG9m
IHRoZSBUd2l0dGVyIHN0YXR1cyBmb3IgYW4gYXJ0aWNsZS48L3A+CgoJPGgzPlN5bnRheDwv
aDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl90d2VldF91cmwgLyZndDs8L3A+CgoJPHA+
Jmx0O3R4cDphcmNfdHdpdHRlcl90d2VldF91cmwmZ3Q7TGluayB0ZXh0Jmx0Oy90eHA6YXJj
X3R3aXR0ZXJfdHdlZXRfdXJsJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4K
CQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJ
CQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4K
CQkJPHRkPmlkPC90ZD4KCQkJPHRkPlRleHRwYXR0ZXJuIGFydGljbGUgSUQ8L3RkPgoJCQk8
dGQ+IDxlbT5jdXJyZW50IGFydGljbGU8L2VtPjwvdGQ+CgkJCTx0ZD5pZD0mcXVvdDsxJnF1
b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnRpdGxlPC90ZD4KCQkJPHRkPlRpdGxl
IGF0dHJpYnV0ZSBvZiB0aGUgbGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3Rk
PgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9
ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRy
aWJ1dGUgYXBwbGllZCB0byB0aGUgbGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48
L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190
d2l0dGVyX3Rpbnl1cmwiPmFyY190d2l0dGVyX3Rpbnl1cmw8L2gyPgoKCTxwPlJldHVybnMg
dGhlIHNob3J0ZW5lZCA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPiBvZiB0aGUgYXJ0
aWNsZSB1c2VkIGZvciB0aGUgVHdpdHRlciB1cGRhdGUuPC9wPgoKCTxoMz5TeW50YXg8L2gz
PgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfdGlueXVybCAvJmd0OzwvcD4KCgk8cD4mbHQ7
dHhwOmFyY190d2l0dGVyX3Rpbnl1cmwmZ3Q7TGluayB0ZXh0Jmx0Oy90eHA6YXJjX3R3aXR0
ZXJfdGlueXVybCZndDs8L3A+CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJ
CQk8dGg+QXR0cmlidXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRl
ZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5p
ZDwvdGQ+CgkJCTx0ZD5UZXh0cGF0dGVybiBhcnRpY2xlIElEPC90ZD4KCQkJPHRkPiA8ZW0+
Y3VycmVudCBhcnRpY2xlPC9lbT48L3RkPgoJCQk8dGQ+aWQ9JnF1b3Q7MSZxdW90OzwvdGQ+
CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD50aXRsZTwvdGQ+CgkJCTx0ZD5UaXRsZSBhdHRyaWJ1
dGUgb2YgdGhlIGxpbms8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48
c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFw
cGxpZWQgdG8gdGhlIGxpbms8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8
L3RyPgoJPC90YWJsZT4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9j
YWNoaW5nIj5DYWNoaW5nPC9oMj4KCgk8cD5JbiBvcmRlciB0byBwcmV2ZW50IGV4Y2Vzc2l2
ZSByZXBlYXRpdGl2ZSBjYWxscyB0byB0aGUgVHdpdHRlciB3ZWJzaXRlIGl0IGlzIHJlY29t
bWVuZGVkIHRvIGNhY2hlIHJlc3VsdHMuIFR3aXR0ZXIgbGltaXRzIHRoZSBudW1iZXIgb2Yg
Y2FsbHMgdGhyb3VnaCB0aGUgPHNwYW4gY2xhc3M9ImNhcHMiPkFQSTwvc3Bhbj4sIGFuZCBj
b250aW51b3VzIGNhbGxzIHdpbGwgcmVzdWx0IGluIFR3aXR0ZXIgY2xvc2luZyB0byBmdXJ0
aGVyIHJlcXVlc3RzLiBCeSBkZWZhdWx0LCBhcmNfdHdpdHRlciBjYWNoZXMgZm9yIDMwIG1p
bnV0ZSBpbnRlcnZhbHMuPC9wPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8
L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0
aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNhY2hpbmc8L3RkPgoJCQk8
dGQ+JiM4MjE2OzEmIzgyMTc7IHRvIGNhY2hlIGZlZWQsICYjODIxNjswJiM4MjE3OyB0byB0
dXJuIGNhY2hpbmcgb2ZmIChub3QgcmVjb21tZW5kZWQpPC90ZD4KCQkJPHRkPjE8L3RkPgoJ
CQk8dGQ+Y2FjaGluZz0mcXVvdDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRk
PmNhY2hlX2RpcjwvdGQ+CgkJCTx0ZD5BYnNvbHV0ZSBwYXRoIHRvIHRoZSBjYWNoZSBkaXJl
Y3RvcnkgKG11c3QgYmUgd3JpdGFibGUpPC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0ZXIg
cHJlZmVyZW5jZXM8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jYWNoZV90aW1l
PC90ZD4KCQkJPHRkPlRpbWUgaW4gbWludXRlcyB0aGF0IHRoZSBjYWNoZSBmaWxlcyBhcmUg
c3RvcmVkIGJlZm9yZSBiZWluZyByZWZyZXNoZWQ8L3RkPgoJCQk8dGQ+NTwvdGQ+CgkJCTx0
ZD5jYWNoZV90aW1lPSZxdW90OzMwJnF1b3Q7PC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8
cD5UaGUgYWRtaW4gc2lkZSBvZiB0aGlzIHBsdWdpbiBlbmZvcmNlcyBjYWNoaW5nLCBhcGFy
dCBmcm9tIHdoZW4gaXQgaXMgcG9zdGluZyB0byBUd2l0dGVyICg8aT5lLmcuPC9pPiB3aGVu
IHBvc3Rpbmcgb3IgZGVsZXRpbmcgYW4gdXBkYXRlKS48L3A+CgoJPGgyIGNsYXNzPSJzZWN0
aW9uIiBpZD0iYXJjX3R3aXR0ZXJfcHJlZnMiPlByZWZlcmVuY2VzPC9oMj4KCgk8cD5Zb3Ug
Y2FuIGFjY2VzcyB0aGUgcGx1Z2lucyBjb3JlIHByZWZlcmVuY2VzIGZyb20gZWl0aGVyIHRo
ZSBQcmVmZXJlbmNlcyBvciBQbHVnaW5zIHRhYnMgaW4gYWRtaW4uIFNldHVwIHlvdXIgVHdp
dHRlciBhY2NvdW50ICh5b3Ugd2lsbCBiZSBhc2tlZCB0byBjb25uZWN0IHZpYSBUd2l0dGVy
IGFuZCB0aGlzIG5lZWRzIGRvaW5nIGJlZm9yZSB5b3UgY2FuIHVzZSB0aGUgcGx1Z2luKSBh
bmQgY2hhbmdlIHRoZSBjYWNoZSBkaXJlY3RvcnkgdXNpbmcgYXJjX3R3aXR0ZXImIzgyMTc7
cyBwcmVmZXJlbmNlcy4gV2l0aG91dCBwcm92aWRpbmcgeW91ciBhY2NvdW50IGxvZ2luIGRl
dGFpbHMgdGhlIGFkbWluIGFyZWEgZmVhdHVyZXMgb2YgdGhpcyBwbHVnaW4gd2lsbCBiZSBp
bmFjdGl2ZS48L3A+CgoJPHA+WW91IGNhbiBzZWxlY3QgdGhlIDxzcGFuIGNsYXNzPSJjYXBz
Ij5VUkw8L3NwYW4+IHNob3J0ZW5lciBtZXRob2QgeW91IHdhbnQgdG8gdXNlIHRvIGxpbmsg
YmFjayB0byB5b3VyIGFydGljbGUgb24gVHdpdHRlci4gUGxlYXNlIG5vdGUgdGhhdCBpZiB5
b3Ugc2VsZWN0IHNtZF9zaG9ydF91cmwgeW91IHdpbGwgbmVlZCB0byBoYXZlIGluc3RhbGxl
ZCBhbmQgYWN0aXZhdGVkIHRoZSA8YSBocmVmPSJodHRwOi8vdGV4dHBhdHRlcm4ub3JnL3Bs
dWdpbnMvMTA5OS9zbWRfc2hvcnRfdXJsIj48c3BhbiBjbGFzcz0idGFnIj5zbWRfc2hvcnRf
dXJsPC9zcGFuPiBwbHVnaW48L2E+IGRldmVsb3BlZCBieSBTdGVmIERhd3Nvbi48L3A+CgoJ
PGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYXJ0aWNsZSI+VHdlZXRpbmcg
YXJ0aWNsZXM8L2gyPgoKCTxwPkJ5IGRlZmF1bHQgYXJjX3R3aXR0ZXIgd2lsbCBwb3N0IGFu
IHVwZGF0ZSB0byBUd2l0dGVyIGluY2x1ZGluZyBhIHNob3J0ZW5lZCA8c3BhbiBjbGFzcz0i
Y2FwcyI+VVJMPC9zcGFuPiB0byB5b3VyIGFydGljbGUuIE9ubHkgbGl2ZSBhbmQgYWN0aXZl
IGFydGljbGVzIHdpbGwgYmUgc2VudCB0byBUd2l0dGVyLCA8aT5pLmUuPC9pPiBhcnRpY2xl
cyBwb3N0ZWQgaW4gdGhlIGZ1dHVyZSBvciBhcyBzdGlja3kgYXJ0aWNsZXMgd2lsbCBub3Qg
YmUgc2VudC4gSWYgeW91ciBhcnRpY2xlIGlzIHN1Y2Nlc3NmdWxseSBzdWJtaXR0ZWQgdG8g
VHdpdHRlciB0aGUgdXBkYXRlIHdpbGwgYXBwZWFyIGluIHBsYWNlIG9mIHRoZSBUd2l0dGVy
IG9wdGlvbiBvbiB0aGUgcmlnaHQtaGFuZC1zaWRlIG9mIHRoZSBhcnRpY2xlIGVkaXQgc2Ny
ZWVuLjwvcD4KCgk8cD5Ud2VldHMgYXJlIHNlbnQgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6
IDxlbT5Ud2VldCBwcmVmaXg8L2VtPiA8ZW0+QXJ0aWNsZSB0aXRsZTwvZW0+IDxlbT5TaG9y
dGVuZWQgPHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj48L2VtPiA8ZW0+VHdlZXQgc3Vm
Zml4PC9lbT4uIFlvdSBjYW4gY2hhbmdlIHRoZSBwcmVmaXggYW5kIHN1ZmZpeCBvbiBhbiBh
cnRpY2xlLWJ5LWFydGljbGUgYmFzaXMgYnkgY2hhbmdpbmcgdGhlIHR3ZWV0IG9wdGlvbnMg
dW5kZXIgJiM4MjE2O1VwZGF0ZSBUd2l0dGVyJiM4MjE3OyBvbiB0aGUgYXJ0aWNsZSBlZGl0
b3Igc2NyZWVuLiBUaGUgZGVmYXVsdCA8ZW0+VHdlZXQgcHJlZml4PC9lbT4gY2FuIGJlIHNl
dCB1bmRlciB0aGUgPHNwYW4gY2xhc3M9InRhZyI+YXJjX3R3aXR0ZXI8L3NwYW4+IHByZWZl
cmVuY2VzIHNjcmVlbiAodGhlIGRlZmF1bHQgb24gaW5zdGFsbGF0aW9uIGlzICYjODIyMDtK
dXN0IHBvc3RlZDomIzgyMjE7KS48L3A+CgoJPHA+UGxlYXNlIG5vdGUgdGhhdCBvbmNlIGFu
IGFydGljbGUgaGFzIGJlZW4gdHdlZXRlZCB0aGUgdHdlZXQgY2Fubm90IGJlIGVkaXRlZC48
L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYWRtaW4iPlRoZSBU
d2l0dGVyIHRhYjwvaDI+CgoJPHA+VW5kZXIgdGhlIEV4dGVuc2lvbnMgdGFiICh0aGlzIGNh
biBiZSBjaGFuZ2VkIGZyb20gdGhlIHBsdWdpbiYjODIxNztzIHByZWZlcmVuY2UgcGFnZSkg
YSBuZXcgVHdpdHRlciB0YWIgc2hvdWxkIGFwcGVhciBvbmNlIHlvdSBoYXZlIGNvbm5lY3Rl
ZCB5b3VyIHNpdGUgdG8geW91ciBUd2l0dGVyIGFjY291bnQuIEZyb20gaGVyZSB5b3Ugd2ls
bCBiZSBhYmxlIHRvIHN1Ym1pdCBuZXcgVHdpdHRlciB1cGRhdGVzLCB2aWV3IGJhc2ljIGFj
Y291bnQgc3RhdGlzdGljcywgYW5kIGNoZWNrIG91dCB5b3VyIHJlY2VudCB1cGRhdGVzIChp
bmNsdWRpbmcgdGhlIG9wdGlvbiB0byBkZWxldGUgeW91ciB0d2VldHMpLjwvcD4iO3M6NDoi
Y29kZSI7czo3NDgxMDoiZ2xvYmFsICRwcmVmcywkdHhwY2ZnLCRhcmNfdHdpdHRlcl9jb25z
dW1lcktleSwkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgokYXJjX3R3aXR0ZXIgPSBh
cnJheSgpOwoKJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5ID0gJ25LY1hzbHd6WmhCZDBrZktN
ZXRuUEEnOwokYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQgPSAnQzZuU1BDTDNlZUhHVEJo
S0Nnd2Q5b2NsY3VEMHNyQjhXVmtmWFFZQzU0JzsKCmFkZF9wcml2cygncGx1Z2luX3ByZWZz
LmFyY190d2l0dGVyJywnMSwyJyk7CnJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfdHdpdHRlcl9p
bnN0YWxsJywncGx1Z2luX2xpZmVjeWNsZS5hcmNfdHdpdHRlcicsICdpbnN0YWxsZWQnKTsK
cmVnaXN0ZXJfY2FsbGJhY2soJ2FyY190d2l0dGVyX3VuaW5zdGFsbCcsJ3BsdWdpbl9saWZl
Y3ljbGUuYXJjX3R3aXR0ZXInLCAnZGVsZXRlZCcpOwpyZWdpc3Rlcl9jYWxsYmFjaygnYXJj
X3R3aXR0ZXJfcHJlZnMnLCdwbHVnaW5fcHJlZnMuYXJjX3R3aXR0ZXInKTsKCi8qCiAqIFNl
dHVwIGluaXRpYWwgcHJlZmVyZW5jZXMgaWYgbm90IGluIHRoZSB0eHBfcHJlZnMgdGFibGUu
CiAqLwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddKSkKICAgIHNldF9w
cmVmKCdhcmNfdHdpdHRlcl91c2VyJywgJycsICdhcmNfdHdpdHRlcicsIDEsICd0ZXh0X2lu
cHV0Jyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl9wcmVmaXgnXSkpCiAgc2V0
X3ByZWYoJ2FyY190d2l0dGVyX3ByZWZpeCcsJ0p1c3QgcG9zdGVkOicsICdhcmNfdHdpdHRl
cicsIDIsICd0ZXh0X2lucHV0Jyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl9j
YWNoZV9kaXInXSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX2NhY2hlX2RpcicsJHR4cGNm
Z1sndHhwYXRoJ10uJHByZWZzWyd0ZW1wZGlyJ10sICdhcmNfdHdpdHRlcicsIDEsICd0ZXh0
X2lucHV0Jyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0
J10pKQogIHNldF9wcmVmKCdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0JywgMSwgJ2FyY190
d2l0dGVyJywgMiwgJ3llc25vUmFkaW8nKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0
dGVyX3VybF9tZXRob2QnXSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3VybF9tZXRob2Qn
LCAndGlueXVybCcsICdhcmNfdHdpdHRlcicsIDIsCiAgICAnYXJjX3R3aXR0ZXJfdXJsX21l
dGhvZF9zZWxlY3QnKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY19zaG9ydF91cmwnXSkpCiAg
c2V0X3ByZWYoJ2FyY19zaG9ydF91cmwnLCAwLCAnYXJjX3R3aXR0ZXInLCAyLCAneWVzbm9S
YWRpbycpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3Nob3J0X3NpdGVfdXJsJ10pKQogIHNl
dF9wcmVmKCdhcmNfc2hvcnRfc2l0ZV91cmwnLCAkcHJlZnNbJ3NpdGV1cmwnXSwgJ2FyY190
d2l0dGVyJywgMiwgJ3RleHRfaW5wdXQnKTsKLy8gTWFrZSBzdXJlIHRoYXQgdGhlIFR3aXR0
ZXIgdGFiIGhhcyBiZWVuIGRlZmluZWQKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVy
X3RhYiddKSkgewogIHNldF9wcmVmKCdhcmNfdHdpdHRlcl90YWInLCAnZXh0ZW5zaW9ucycs
ICdhcmNfdHdpdHRlcicsIDIsCiAgICAnYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCcpOwogICAg
JHByZWZzWydhcmNfdHdpdHRlcl90YWInXSA9ICdleHRlbnNpb25zJzsKfQoKLy8gQ2hlY2sg
aWYgYXJjX3Nob3J0X3VybCBpcyBlbmFibGVkCmlmICgkcHJlZnNbJ2FyY19zaG9ydF91cmwn
XSB8fCAkcHJlZnNbJ2FyY190d2l0dGVyX3VybF9tZXRob2QnXT09J2FyY190d2l0dGVyJykg
ewogIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfc2hvcnRfdXJsX3JlZGlyZWN0JywgJ3R4cF9k
aWUnLCA0MDQpOwp9CgppZiAoQHR4cGludGVyZmFjZSA9PSAnYWRtaW4nKSB7CiAgICBpZiAo
IWVtcHR5KCRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddKQogICAgICAgICYmICFlbXB0eSgk
cHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10pCiAgICAgICAgJiYgIWVtcHR5KCRw
cmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSkgKSB7CgogICAgICAgIGlm
ICgkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddKSB7CiAgICAgICAgICAgIGFkZF9wcml2cygn
YXJjX2FkbWluX3R3aXR0ZXInLCAnMSwyLDMsNCcpOwogICAgICAgICAgICByZWdpc3Rlcl90
YWIoJHByZWZzWydhcmNfdHdpdHRlcl90YWInXSwgJ2FyY19hZG1pbl90d2l0dGVyJywgJ1R3
aXR0ZXInKTsKICAgICAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hZG1pbl90d2l0
dGVyJywgJ2FyY19hZG1pbl90d2l0dGVyJyk7CiAgICAgICAgfQoKICAgICAgICByZWdpc3Rl
cl9jYWxsYmFjaygnYXJjX2FydGljbGVfdHdlZXQnLCAncGluZycpOwogICAgICAgIHJlZ2lz
dGVyX2NhbGxiYWNrKCdhcmNfYXJ0aWNsZV90d2VldCcsICdhcnRpY2xlJywgJ2VkaXQnLCAx
KTsKICAgICAgICByZWdpc3Rlcl9jYWxsYmFjaygnYXJjX2FwcGVuZF90d2l0dGVyJywgJ2Fy
dGljbGVfdWknLCAnc3RhdHVzJyk7CiAgICB9Cn0KCi8qCiAgICBQdWJsaWMtc2lkZSBmdW5j
dGlvbnMKICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0KKi8KCmZ1bmN0aW9uIGFyY190d2l0dGVyKCRhdHRzKQp7
CiAgZ2xvYmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRl
cl9jb25zdW1lclNlY3JldDsKCiAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICd1c2VyJyAg
ICAgID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLAogICAgJ3Bhc3N3b3JkJyAgPT4g
JycsCiAgICAndGltZWxpbmUnICA9PiAndXNlcicsCiAgICAnbGltaXQnICAgICA9PiAnMTAn
LAogICAgJ3JldHdlZXRzJyAgPT4gZmFsc2UsCiAgICAnZGF0ZWZvcm1hdCc9PiAkcHJlZnNb
J2FyY2hpdmVfZGF0ZWZvcm1hdCddLAogICAgJ2NhY2hpbmcnICAgPT4gJzEnLAogICAgJ2Nh
Y2hlX2RpcicgPT4gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXSwKICAgICdjYWNo
ZV90aW1lJz0+ICc1JywKICAgICdsYWJlbCcgICAgID0+ICcnLAogICAgJ2xhYmVsdGFnJyAg
PT4gJycsCiAgICAnYnJlYWsnICAgICA9PiAnbGknLAogICAgJ3dyYXB0YWcnICAgPT4gJycs
CiAgICAnY2xhc3MnICAgICA9PiBfX0ZVTkNUSU9OX18sCiAgICAnY2xhc3NfcG9zdGVkJyA9
PiBfX0ZVTkNUSU9OX18uJy1wb3N0ZWQnCiAgICApLCRhdHRzKSk7CgogICR0d2l0ID0gbmV3
IGFyY19Ud2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2Nv
bnN1bWVyU2VjcmV0KTsKCiAgaWYgKCRjYWNoaW5nKSB7ICAvLyB0dXJuIG9uIGNhY2hpbmcs
IHJlY29tbWVuZGVkIChkZWZhdWx0KQogICAgJHR3aXQtPnNldENhY2hpbmcodHJ1ZSk7CiAg
ICAkdHdpdC0+Y2FjaGVEaXIoJGNhY2hlX2Rpcik7CiAgICAkdHdpdC0+Y2FjaGVUaW1lKCRj
YWNoZV90aW1lKTsKICB9IGVsc2UgeyAgLy8gdHVybiBvZmYgY2FjaGluZywgbm90IHJlY29t
bWVuZGVkIG90aGVyIHRoYW4gZm9yIHRlc3RpbmcKICAgICR0d2l0LT5zZXRDYWNoaW5nKGZh
bHNlKTsKICB9CgogIHN3aXRjaCAoJHRpbWVsaW5lKSB7CiAgICBjYXNlICdob21lJzogY2Fz
ZSAnZnJpZW5kcyc6CiAgICAgICR0aW1lbGluZSA9ICdzdGF0dXNlcy9mcmllbmRzX3RpbWVs
aW5lJzsgYnJlYWs7CiAgICBjYXNlICdtZW50aW9ucyc6CiAgICAgICR0aW1lbGluZSA9ICdz
dGF0dXNlcy9tZW50aW9ucyc7IGJyZWFrOwogICAgY2FzZSAndXNlcic6IGRlZmF1bHQ6ICR0
aW1lbGluZSA9ICdzdGF0dXNlcy91c2VyX3RpbWVsaW5lJzsKICB9CgogICRvdXQgPSBhcnJh
eSgpOwogICR4bWwgPSAkdHdpdC0+Z2V0KCR0aW1lbGluZQogICAgLCBhcnJheSgnc2NyZWVu
X25hbWUnPT4kdXNlciwnY291bnQnPT4kbGltaXQsJ2luY2x1ZGVfcnRzJz0+JHJldHdlZXRz
KSk7CiAgaWYgKCR4bWwpIHsKICAgICR0d2VldHMgPSBAJHhtbC0+eHBhdGgoJy9zdGF0dXNl
cy9zdGF0dXMnKTsKICAgIGlmICgkdHdlZXRzKSBmb3JlYWNoICgkdHdlZXRzIGFzICR0d2Vl
dCkgewogICAgICAkdGltZSA9IHN0cnRvdGltZShodG1sZW50aXRpZXMoJHR3ZWV0LT5jcmVh
dGVkX2F0KSk7CiAgICAgICRkYXRlID0gc2FmZV9zdHJmdGltZSgkZGF0ZWZvcm1hdCwkdGlt
ZSk7CiAgICAgICRvdXRbXSA9IGFyY19Ud2l0dGVyOjptYWtlTGlua3MoaHRtbGVudGl0aWVz
KCR0d2VldC0+dGV4dCwgRU5UX1FVT1RFUywnVVRGLTgnKSkKICAgICAgICAuJyAnLnRhZyho
dG1sZW50aXRpZXMoJGRhdGUpLCdzcGFuJywnIGNsYXNzPSInLiRjbGFzc19wb3N0ZWQuJyIn
KTsKICAgIH0KCiAgICByZXR1cm4gZG9MYWJlbCgkbGFiZWwsICRsYWJlbHRhZykuZG9XcmFw
KCRvdXQsICR3cmFwdGFnLCAkYnJlYWssICRjbGFzcyk7CiAgfQoKfQoKZnVuY3Rpb24gYXJj
X3R3aXR0ZXJfc2VhcmNoKCRhdHRzKQp7CiAgICBnbG9iYWwgJHByZWZzLCRhcmNfdHdpdHRl
cl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgIGV4dHJh
Y3QobEF0dHMoYXJyYXkoCiAgICAgICAgJ3VzZXInICAgICAgPT4gJHByZWZzWydhcmNfdHdp
dHRlcl91c2VyJ10sCiAgICAgICAgJ3NlYXJjaCcgICAgPT4gJycsCiAgICAgICAgJ2hhc2h0
YWdzJyAgPT4gJycsCiAgICAgICAgJ3VzZXInICAgICAgPT4gJycsCiAgICAgICAgJ3JlcGx5
JyAgICAgPT4gJycsCiAgICAgICAgJ21lbnRpb24nICAgPT4gJycsCiAgICAgICAgJ2xpbWl0
JyAgICAgPT4gJzEwJywKICAgICAgICAnbGFuZycgICAgICA9PiAnJywKICAgICAgICAnZGF0
ZWZvcm1hdCc9PiAkcHJlZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCddLAogICAgICAgICdjYWNo
aW5nJyAgID0+ICcxJywKICAgICAgICAnY2FjaGVfZGlyJyA9PiAkcHJlZnNbJ2FyY190d2l0
dGVyX2NhY2hlX2RpciddLAogICAgICAgICdjYWNoZV90aW1lJz0+ICc1JywKICAgICAgICAn
bGFiZWwnICAgICA9PiAnJywKICAgICAgICAnbGFiZWx0YWcnICA9PiAnJywKICAgICAgICAn
YnJlYWsnICAgICA9PiAnbGknLAogICAgICAgICd3cmFwdGFnJyAgID0+ICcnLAogICAgICAg
ICdjbGFzcycgICAgID0+IF9fRlVOQ1RJT05fXywKICAgICAgICAnY2xhc3NfcG9zdGVkJyA9
PiBfX0ZVTkNUSU9OX18uJy1wb3N0ZWQnLAogICAgICAgICdjbGFzc191c2VyJyAgID0+IF9f
RlVOQ1RJT05fXy4nLXVzZXInCiAgICApLCRhdHRzKSk7CgogICAgICAgICR0d2l0ID0gbmV3
IGFyY19Ud2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAsICRh
cmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCk7CgogICAgICAgIGlmICgkY2FjaGluZykgeyAg
Ly8gdHVybiBvbiBjYWNoaW5nLCByZWNvbW1lbmRlZCAoZGVmYXVsdCkKICAgICAgICAgICAg
JHR3aXQtPnNldENhY2hpbmcodHJ1ZSk7CiAgICAgICAgICAgICR0d2l0LT5jYWNoZURpcigk
Y2FjaGVfZGlyKTsKICAgICAgICAgICAgJHR3aXQtPmNhY2hlVGltZSgkY2FjaGVfdGltZSk7
CiAgICAgICAgfSBlbHNlIHsgIC8vIHR1cm4gb2ZmIGNhY2hpbmcsIG5vdCByZWNvbW1lbmRl
ZCBvdGhlciB0aGFuIGZvciB0ZXN0aW5nCiAgICAgICAgICAgICR0d2l0LT5zZXRDYWNoaW5n
KGZhbHNlKTsKICAgICAgICB9CgogICAgICAgIC8vIGNvbnN0cnVjdCBzZWFyY2ggcXVlcnkK
ICAgICAgICBpZiAoIWVtcHR5KCRzZWFyY2gpKSB7CiAgICAgICAgICAgICR0ZXJtcyA9IGV4
cGxvZGUoJywnLCRzZWFyY2gpOyAkdGVybXMgPSBhcnJheV9tYXAoJ3RyaW0nLCR0ZXJtcyk7
CiAgICAgICAgICAgICRzZWFyY2ggPSBpbXBsb2RlKCcgJywkdGVybXMpOwogICAgICAgIH0K
ICAgICAgICBpZiAoJGhhc2h0YWdzKSB7CiAgICAgICAgICAgICRoYXNoZXMgPSBleHBsb2Rl
KCcsJywkaGFzaHRhZ3MpOyAkaGFzaGVzID0gYXJyYXlfbWFwKCd0cmltJywkaGFzaGVzKTsK
ICAgICAgICAgICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/JyAnOicnKS4nIycuaW1wbG9kZSgn
ICMnLCRoYXNoZXMpOwogICAgICAgIH0KICAgICAgICBpZiAoJHJlcGx5KSB7CiAgICAgICAg
ICAgICRzZWFyY2guPSAoKCRzZWFyY2gpPycgJzonJykuJ3RvOicudHJpbSgkcmVwbHkpOwog
ICAgICAgIH0KICAgICAgICBpZiAoJHVzZXIpIHsKICAgICAgICAgICAgJHNlYXJjaC49ICgo
JHNlYXJjaCk/JyAnOicnKS4nZnJvbTonLnRyaW0oJHVzZXIpOwogICAgICAgIH0KICAgICAg
ICBpZiAoJG1lbnRpb24pIHsKICAgICAgICAgICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/JyAn
OicnKS4nQCcudHJpbSgkbWVudGlvbik7CiAgICAgICAgfQoKICAgICAgICBpZiAoZW1wdHko
JHNlYXJjaCkpIHsKICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0gZWxzZSB7CiAg
ICAgICAgICAgICRzZWFyY2ggPSB1cmxlbmNvZGUoJHNlYXJjaCk7CiAgICAgICAgfQoKICAg
ICAgICAkb3V0ID0gYXJyYXkoKTsKICAgICAgICAkdHdlZXRzID0gJHR3aXQtPmdldCgnaHR0
cDovL3NlYXJjaC50d2l0dGVyLmNvbS9zZWFyY2guYXRvbT9xPScuJHNlYXJjaAogICAgICAg
ICAgICAsIGFycmF5KCdycHAnPT4kbGltaXQsJ2xhbmcnPT4kbGFuZykpOwoKICAgICAgICBp
ZiAoJHR3ZWV0cykgeyBmb3JlYWNoICgkdHdlZXRzLT5lbnRyeSBhcyAkdHdlZXQpIHsKICAg
ICAgICAgICAgcHJlZ19tYXRjaCgiLyguKikgXCgoLiopXCkvIiwkdHdlZXQtPmF1dGhvci0+
bmFtZSwkbWF0Y2hlcyk7CiAgICAgICAgICAgIGxpc3QoJGF1dGhvciwkdW5hbWUsJG5hbWUp
ID0gJG1hdGNoZXM7CiAgICAgICAgICAgICR0aW1lID0gc3RydG90aW1lKGh0bWxlbnRpdGll
cygkdHdlZXQtPnB1Ymxpc2hlZCkpOwogICAgICAgICAgICAkZGF0ZSA9IHNhZmVfc3RyZnRp
bWUoJGRhdGVmb3JtYXQsJHRpbWUpOwogICAgICAgICAgICAkdGV4dCA9ICR0d2VldC0+dGl0
bGU7CiAgICAgICAgICAgICRvdXRbXSA9IHRhZyhocmVmKGh0bWxlbnRpdGllcygkdW5hbWUp
LCR0d2VldC0+YXV0aG9yLT51cmksCiAgICAgICAgICAgICAgICAnIHRpdGxlPSInLmh0bWxl
bnRpdGllcygkbmFtZSkuJyInKS4nOiAnLCdzcGFuJwogICAgICAgICAgICAgICAgICAgICwn
IGNsYXNzPSInLiRjbGFzc191c2VyLiciJykKICAgICAgICAgICAgICAgIC5hcmNfVHdpdHRl
cjo6bWFrZUxpbmtzKGh0bWxlbnRpdGllcygkdGV4dCwgRU5UX1FVT1RFUywnVVRGLTgnKSkK
ICAgICAgICAgICAgICAgIC4nICcudGFnKGh0bWxlbnRpdGllcygkZGF0ZSksJ3NwYW4nCiAg
ICAgICAgICAgICAgICAgICAgLCcgY2xhc3M9IicuJGNsYXNzX3Bvc3RlZC4nIicpOwogICAg
ICAgIH0gcmV0dXJuIGRvTGFiZWwoJGxhYmVsLCAkbGFiZWx0YWcpCiAgICAgICAgICAgIC5k
b1dyYXAoJG91dCwgJHdyYXB0YWcsICRicmVhaywgJGNsYXNzKTsgfQoKfQoKZnVuY3Rpb24g
YXJjX3R3aXR0ZXJfdHdlZXQoJGF0dHMpIHsKICAgIGdsb2JhbCAkdGhpc2FydGljbGU7Cgog
ICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgJ2lkJyAgICAgICAgPT4gJHRoaXNhcnRp
Y2xlWyd0aGlzaWQnXSwKICAgICAgJ2luY2x1ZGVfdXJsJyAgID0+IHRydWUKICAgICksJGF0
dHMpKTsKCiAgICBpZiAoJGlkKSB7CiAgICAgIC8vIEZldGNoIGFyY190d2l0dGVyIHN0dWZm
IHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAgICAgJHR3ZWV0ID0gKCRpbmNsdWRlX3VybCkgPyBz
YWZlX3JvdygidHdlZXQiLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlkfSIpCiAg
ICAgICAgOiBzYWZlX3JvdygiUkVQTEFDRSh0d2VldCxDT05DQVQoJyAnLHRpbnl1cmwpLCcn
KSBBUyB0d2VldCIKICAgICAgICAgICwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRp
ZH0iKTsKICAgIH0KCiAgICBpZiAoJHR3ZWV0Wyd0d2VldCddKSB7CiAgICAgIHJldHVybiBh
cmNfVHdpdHRlcjo6bWFrZUxpbmtzKAogICAgICAgIGh0bWxlbnRpdGllcygkdHdlZXRbJ3R3
ZWV0J10sIEVOVF9RVU9URVMsJ1VURi04JykpOwogICAgfQp9CgpmdW5jdGlvbiBhcmNfdHdp
dHRlcl90d2VldF91cmwoJGF0dHMsICR0aGluZz1udWxsKSB7CiAgICBnbG9iYWwgJHRoaXNh
cnRpY2xlLCRwcmVmczsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAnaWQnICAg
ICAgPT4gJHRoaXNhcnRpY2xlWyd0aGlzaWQnXSwKICAgICAgJ3RpdGxlJyAgID0+ICcnLAog
ICAgICAnY2xhc3MnICAgPT4gJycKICAgICksJGF0dHMpKTsKCiAgICBpZiAoJGlkKSB7CiAg
ICAgIC8vIEZldGNoIGFyY190d2l0dGVyIHN0dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAg
ICAgJHR3ZWV0ID0gc2FmZV9yb3coInR3ZWV0X2lkIgogICAgICAgICwgJ2FyY190d2l0dGVy
JywgImFydGljbGVfaWQ9eyRpZH0iKTsKICAgIH0KCiAgICBpZiAoJHR3ZWV0Wyd0d2VldF9p
ZCddKSB7CiAgICAgICR1cmwgPSAiaHR0cDovL3R3aXR0ZXIuY29tLyIuJHByZWZzWydhcmNf
dHdpdHRlcl91c2VyJ10uIi9zdGF0dXMvIi4kdHdlZXRbJ3R3ZWV0X2lkJ107CiAgICAgIGlm
ICgkdGhpbmc9PT1udWxsKSB7CiAgICAgICAgcmV0dXJuICR1cmw7CiAgICAgIH0KICAgICAg
cmV0dXJuIGhyZWYocGFyc2UoJHRoaW5nKSwgJHVybCwKICAgICAgICAoJHRpdGxlID8gJyB0
aXRsZT0iJy4kdGl0bGUuJyInIDogJycpCiAgICAgICAgLigkY2xhc3MgPyAnIGNsYXNzPSIn
LiRjbGFzcy4nIicgOiAnJykpOwogICAgfQp9CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl90aW55
dXJsKCRhdHRzLCAkdGhpbmc9bnVsbCkgewogICAgZ2xvYmFsICR0aGlzYXJ0aWNsZTsKCiAg
ICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAnaWQnICAgICAgPT4gJHRoaXNhcnRpY2xl
Wyd0aGlzaWQnXSwKICAgICAgJ3RpdGxlJyAgID0+ICcnLAogICAgICAnY2xhc3MnICAgPT4g
JycKICAgICksJGF0dHMpKTsKCiAgICBpZiAoJGlkKSB7CiAgICAgIC8vIEZldGNoIGFyY190
d2l0dGVyIHN0dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAgICAgJHR3ZWV0ID0gc2FmZV9y
b3coInRpbnl1cmwiCiAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlk
fSIpOwogICAgfQoKICAgIGlmICgkdHdlZXRbJ3Rpbnl1cmwnXSkgewogICAgICBpZiAoJHRo
aW5nPT09bnVsbCkgewogICAgICAgIHJldHVybiAkdHdlZXRbJ3Rpbnl1cmwnXTsKICAgICAg
fQoKICAgICAgcmV0dXJuIGhyZWYocGFyc2UoJHRoaW5nKSwgJHR3ZWV0Wyd0aW55dXJsJ10s
CiAgICAgICAgKCR0aXRsZSA/ICcgdGl0bGU9IicuJHRpdGxlLiciJyA6ICcnKQogICAgICAg
IC4oJGNsYXNzID8gJyBjbGFzcz0iJy4kY2xhc3MuJyInIDogJycpKTsKICAgIH0KfQoKLyoK
ICogUHVibGljIHRhZyBmb3Igb3V0cHV0dGluZyB3aWRnZXQgSlMKICovCmZ1bmN0aW9uIGFy
Y190d2l0dGVyX3dpZGdldF9qcygkYXR0cykKewogIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAg
ICAgICAgJ29wdGltaXNlJyA9PiBmYWxzZQogICAgKSwkYXR0cykpOwoKICByZXR1cm4gX2Fy
Y190d2l0dGVyX3dpZGdldF9qcygkb3B0aW1pc2UpOwp9CgpmdW5jdGlvbiBfYXJjX3R3aXR0
ZXJfd2lkZ2V0X2pzKCRvcHRpbWlzZT10cnVlKQp7CiAgZ2xvYmFsICRhcmNfdHdpdHRlcjsK
CiAgLy8gQ2hlY2sgaWYgd2lkZ2V0IEpTIGhhcyBhbHJlYWR5IGJlZW4gb3V0cHV0CiAgaWYg
KCRhcmNfdHdpdHRlclsnd2lkZ2V0X2pzJ10pIHJldHVybjsKCiAgaWYgKCRvcHRpbWlzZT09
ZmFsc2UpIHsKICAgIHJldHVybiAnPHNjcmlwdCBzcmM9Imh0dHA6Ly9wbGF0Zm9ybS50d2l0
dGVyLmNvbS93aWRnZXRzLmpzIiB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPjwvc2NyaXB0Pic7
CiAgfQoKICAkanMgPSA8PDxKUwo8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+Cihm
dW5jdGlvbigpIHsKICBpZiAod2luZG93Ll9fdHdpdHRlckludGVudEhhbmRsZXIpIHJldHVy
bjsKICB2YXIgaW50ZW50UmVnZXggPSAvdHdpdHRlclwuY29tKFw6XGR7Miw0fSk/XC9pbnRl
bnRcLyhcdyspLywKICAgICAgd2luZG93T3B0aW9ucyA9ICdzY3JvbGxiYXJzPXllcyxyZXNp
emFibGU9eWVzLHRvb2xiYXI9bm8sbG9jYXRpb249eWVzJywKICAgICAgd2lkdGggPSA1NTAs
CiAgICAgIGhlaWdodCA9IDQyMCwKICAgICAgd2luSGVpZ2h0ID0gc2NyZWVuLmhlaWdodCwK
ICAgICAgd2luV2lkdGggPSBzY3JlZW4ud2lkdGg7CgogIGZ1bmN0aW9uIGhhbmRsZUludGVu
dChlKSB7CiAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7CiAgICB2YXIgdGFyZ2V0ID0gZS50
YXJnZXQgfHwgZS5zcmNFbGVtZW50LAogICAgICAgIG0sIGxlZnQsIHRvcDsKCiAgICB3aGls
ZSAodGFyZ2V0ICYmIHRhcmdldC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpICE9PSAnYScpIHsK
ICAgICAgdGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGU7CiAgICB9CgogICAgaWYgKHRhcmdl
dCAmJiB0YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2EnICYmIHRhcmdldC5o
cmVmKSB7CiAgICAgIG0gPSB0YXJnZXQuaHJlZi5tYXRjaChpbnRlbnRSZWdleCk7CiAgICAg
IGlmIChtKSB7CiAgICAgICAgbGVmdCA9IE1hdGgucm91bmQoKHdpbldpZHRoIC8gMikgLSAo
d2lkdGggLyAyKSk7CiAgICAgICAgdG9wID0gMDsKCiAgICAgICAgaWYgKHdpbkhlaWdodCA+
IGhlaWdodCkgewogICAgICAgICAgdG9wID0gTWF0aC5yb3VuZCgod2luSGVpZ2h0IC8gMikg
LSAoaGVpZ2h0IC8gMikpOwogICAgICAgIH0KCiAgICAgICAgd2luZG93Lm9wZW4odGFyZ2V0
LmhyZWYsICdpbnRlbnQnLCB3aW5kb3dPcHRpb25zICsgJyx3aWR0aD0nICsgd2lkdGggKwog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyxoZWlnaHQ9JyAr
IGhlaWdodCArICcsbGVmdD0nICsgbGVmdCArICcsdG9wPScgKyB0b3ApOwogICAgICAgIGUu
cmV0dXJuVmFsdWUgPSBmYWxzZTsKICAgICAgICBlLnByZXZlbnREZWZhdWx0ICYmIGUucHJl
dmVudERlZmF1bHQoKTsKICAgICAgfQogICAgfQogIH0KCiAgaWYgKGRvY3VtZW50LmFkZEV2
ZW50TGlzdGVuZXIpIHsKICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywg
aGFuZGxlSW50ZW50LCBmYWxzZSk7CiAgfSBlbHNlIGlmIChkb2N1bWVudC5hdHRhY2hFdmVu
dCkgewogICAgZG9jdW1lbnQuYXR0YWNoRXZlbnQoJ29uY2xpY2snLCBoYW5kbGVJbnRlbnQp
OwogIH0KICB3aW5kb3cuX190d2l0dGVySW50ZW50SGFuZGxlciA9IHRydWU7Cn0oKSk7Cjwv
c2NyaXB0PgpKUzsKICAkYXJjX3R3aXR0ZXJbJ3dpZGdldF9qcyddID0gdHJ1ZTsKICByZXR1
cm4gJGpzOwp9CgovLyBEZXByZWNhdGVkIGFyY190d2l0dGVyX3JldHdlZXQgdGFnLCB1c2Ug
YXJjX3R3aXR0ZXJfdHdlZXRfYnV0dG9uIGluc3RlYWQKZnVuY3Rpb24gYXJjX3R3aXR0ZXJf
cmV0d2VldCgkYXR0cywgJHRoaW5nPW51bGwpCnsKICByZXR1cm4gYXJjX3R3aXR0ZXJfdHdl
ZXRfYnV0dG9uKCRhdHRzLCAkdGhpbmc9bnVsbCk7Cn0KZnVuY3Rpb24gYXJjX3R3aXR0ZXJf
dHdlZXRfYnV0dG9uKCRhdHRzLCAkdGhpbmc9bnVsbCkKewogICAgZ2xvYmFsICRwcmVmcywk
YXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsK
ICAgIGdsb2JhbCAkdGhpc2FydGljbGU7CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAg
ICAgICAndXNlcicgICAgICAgID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLCAvLyB2
aWEgdXNlciBhY2NvdW50CiAgICAgICAgJ3VybCcgICAgICAgICA9PiAnJywKICAgICAgICAn
dGV4dCcgICAgICAgID0+ICcnLAogICAgICAgICdmb2xsb3cxJyAgICAgPT4gJycsCiAgICAg
ICAgJ2ZvbGxvdzInICAgICA9PiAnJywKICAgICAgICAnbGFuZycgICAgICAgID0+ICcnLAog
ICAgICAgICdjb3VudCcgICAgICAgPT4gJ2hvcml6b250YWwnLAogICAgICAgICdpbmNsdWRl
X2pzJyAgPT4gdHJ1ZSwKICAgICAgICAnb3B0aW1pc2VfanMnID0+IGZhbHNlLAogICAgICAg
ICd3cmFwdGFnJyAgICAgPT4gJycsCiAgICAgICAgJ2NsYXNzJyAgICAgICA9PiAndHdpdHRl
ci1zaGFyZS1idXR0b24nCiAgICApLCRhdHRzKSk7CgogICAgJHEgPSAnJzsgLy8gcXVlcnkg
c3RyaW5nCgogICAgaWYgKCRpZD0kdGhpc2FydGljbGVbJ3RoaXNpZCddKSB7CiAgICAgIC8v
IEZldGNoIGFyY190d2l0dGVyIHN0dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAgICAgJHJv
dyA9IHNhZmVfcm93KCJSRVBMQUNFKHR3ZWV0LENPTkNBVCgnICcsdGlueXVybCksJycpIEFT
IHR3ZWV0LHRpbnl1cmwiCiAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17
JGlkfSIpOwoKICAgICAgaWYgKCR1cmw9PScnKSB7CiAgICAgICAgJHVybCA9ICgkdXJsKSA/
ICR1cmwgOiBwZXJtbGlua3VybCgkdGhpc2FydGljbGUpOwogICAgICAgICRxID0gJ3VybD0n
LnVybGVuY29kZSgkdXJsKTsKICAgICAgfQogICAgICBpZiAoJHRleHQ9PScnKSB7CiAgICAg
ICAgJHRleHQgPSAoJHJvd1sndHdlZXQnXSkgPyAkcm93Wyd0d2VldCddIDogJHRoaXNhcnRp
Y2xlWyd0aXRsZSddOwogICAgICB9CiAgICAgICRxIC49ICgkcSA/ICcmYW1wOycgOiAnJyku
J3RleHQ9Jy51cmxlbmNvZGUoJHRleHQpOwogICAgfQogICAgaWYgKCR1c2VyKSB7CiAgICAg
ICRxIC49ICgkcSA/ICcmYW1wOycgOiAnJykuJ3ZpYT0nLnVybGVuY29kZSgkdXNlcik7CiAg
ICB9CiAgICBpZiAoJGZvbGxvdzEmJiRmb2xsb3cyKSB7CiAgICAgICRxIC49ICgkcSA/ICcm
YW1wOycgOiAnJykuJ3JlbGF0ZWQ9Jy51cmxlbmNvZGUoJGZvbGxvdzEuJzonLiRmb2xsb3cy
KTsKICAgIH0gZWxzZWlmICgkZm9sbG93MXx8JGZvbGxvdzIpIHsKICAgICAgJHEgLj0gKCRx
ID8gJyZhbXA7JyA6ICcnKS4ncmVsYXRlZD0nLnVybGVuY29kZSgkZm9sbG93MS4kZm9sbG93
Mik7CiAgICB9CgogICAgc3dpdGNoICgkbGFuZykgewogICAgICBjYXNlICdmcic6IGJyZWFr
OyBjYXNlICdkZSc6IGJyZWFrOyBjYXNlICdlcyc6IGJyZWFrOyBjYXNlICdqcCc6IGJyZWFr
OwogICAgICBkZWZhdWx0OgogICAgICAgICRsYW5nID0gJ2VuJzsKICAgIH0KICAgICRxIC49
ICgkcSA/ICcmYW1wOycgOiAnJykuJ2xhbmc9Jy51cmxlbmNvZGUoJGxhbmcpOwoKICAgIHN3
aXRjaCAoJGNvdW50KSB7CiAgICAgIGNhc2UgJ25vbmUnOiBicmVhazsgY2FzZSAndmVydGlj
YWwnOiBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICAkY291bnQgPSAnaG9yaXpvbnRh
bCc7CiAgICB9CiAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidjb3VudD0nLnVybGVu
Y29kZSgkY291bnQpOwoKICAgICR0aGluZyA9ICgkdGhpbmc9PT1udWxsKSA/ICdUd2VldCcg
OiBwYXJzZSgkdGhpbmcpOwoKICAgICRodG1sID0gaHJlZigkdGhpbmcsJ2h0dHA6Ly90d2l0
dGVyLmNvbS9zaGFyZT8nLiRxCiAgICAgICwgJyBjbGFzcz0iJy4kY2xhc3MuJyInKTsKCiAg
ICAkanMgPSAoJGluY2x1ZGVfanMpID8gX2FyY190d2l0dGVyX3dpZGdldF9qcygkb3B0aW1p
c2VfanM/dHJ1ZTpmYWxzZSkgOiAnJzsKCiAgICByZXR1cm4gJGpzLiRodG1sOwp9CgovKgog
KiBUd2l0dGVyIEZvbGxvdyBidXR0b24KICovCmZ1bmN0aW9uIGFyY190d2l0dGVyX2ZvbGxv
d19idXR0b24oJGF0dHMsICR0aGluZz1udWxsKQp7CiAgICBnbG9iYWwgJHByZWZzLCRhcmNf
dHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwogICAg
Z2xvYmFsICR0aGlzYXJ0aWNsZTsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAg
ICd1c2VyJyAgICAgICAgPT4gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sIC8vIHZpYSB1
c2VyIGFjY291bnQKICAgICAgICAnbGFuZycgICAgICAgID0+ICcnLAogICAgICAgICdjb3Vu
dCcgICAgICAgPT4gdHJ1ZSwKICAgICAgICAnaW5jbHVkZV9qcycgID0+IHRydWUsCiAgICAg
ICAgJ29wdGltaXNlX2pzJyA9PiBmYWxzZSwKICAgICAgICAnY2xhc3MnICAgICAgID0+ICd0
d2l0dGVyLWZvbGxvdy1idXR0b24nCiAgICApLCRhdHRzKSk7CgogICAgJGF0dHMgPSAnJzsg
Ly8gZGF0YSBhdHRyaWJ1dGVzCgogICAgc3dpdGNoICgkbGFuZykgewogICAgICBjYXNlICdm
cic6IGJyZWFrOyBjYXNlICdkZSc6IGJyZWFrOyBjYXNlICdlcyc6IGJyZWFrOyBjYXNlICdq
cCc6IGJyZWFrOwogICAgICBkZWZhdWx0OgogICAgICAgICRsYW5nID0gJ2VuJzsKICAgIH0K
ICAgICRhdHRzIC49ICcgZGF0YS1sYW5nPSInLnVybGVuY29kZSgkbGFuZykuJyInOwoKICAg
ICRhdHRzIC49ICcgZGF0YS1zaG93LWNvdW50PSInLigkY291bnQ/J3RydWUnOidmYWxzZScp
LiciJzsKCiAgICAkdGhpbmcgPSAoJHRoaW5nPT09bnVsbCkgPyAnRm9sbG93IEAnLiR1c2Vy
IDogcGFyc2UoJHRoaW5nKTsKCiAgICAkaHRtbCA9IGhyZWYoJHRoaW5nLCdodHRwOi8vdHdp
dHRlci5jb20vJy51cmxlbmNvZGUoJHVzZXIpCiAgICAgICwgJyBjbGFzcz0iJy4kY2xhc3Mu
JyInLiRhdHRzKTsKCiAgICAkanMgPSAoJGluY2x1ZGVfanMpID8gX2FyY190d2l0dGVyX3dp
ZGdldF9qcygkb3B0aW1pc2VfanM/dHJ1ZTpmYWxzZSkgOiAnJzsKCiAgICByZXR1cm4gJGpz
LiRodG1sOwp9CgovKgogICAgQWRtaW4tc2lkZSBmdW5jdGlvbnMKICAgID09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0K
Ki8KCi8vIEluc3RhbGxhdGlvbiBmdW5jdGlvbiAtIGJ1aWxkcyBNeVNRTCB0YWJsZQpmdW5j
dGlvbiBhcmNfdHdpdHRlcl9pbnN0YWxsKCkKewoKICAgIC8vIEZvciBmaXJzdCBpbnN0YWxs
LCBjcmVhdGUgdGFibGUgZm9yIHR3ZWV0cwogICAgJHNxbCA9ICJDUkVBVEUgVEFCTEUgSUYg
Tk9UIEVYSVNUUyAiLlBGWC4iYXJjX3R3aXR0ZXIgIjsKICAgICRzcWwuPSAiKGFyY190d2l0
dGVyaWQgSU5URUdFUiBBVVRPX0lOQ1JFTUVOVCBQUklNQVJZIEtFWSwKICAgICAgICBhcnRp
Y2xlX2lkIElOVEVHRVIoMTEpLAogICAgICAgIHR3ZWV0X2lkIEJJR0lOVCgyMCksCiAgICAg
ICAgdHdlZXQgVkFSQ0hBUigxNDApLAogICAgICAgIHRpbnl1cmwgVkFSQ0hBUigzMCkpOyI7
CgogICAgaWYgKCFzYWZlX3F1ZXJ5KCRzcWwpKSB7CiAgICAgICAgcmV0dXJuICdFcnJvciAt
IHVuYWJsZSB0byBjcmVhdGUgYXJjX3R3aXR0ZXIgdGFibGUnOwogICAgfQoKfQoKLy8gVW5p
bnN0YWxsIGZ1bmN0aW9uIC0gZGVsZXRlcyBNeVNRTCB0YWJsZSBhbmQgcmVsYXRlZCBwcmVm
ZXJlbmNlcwpmdW5jdGlvbiBhcmNfdHdpdHRlcl91bmluc3RhbGwoKQp7CgogICAgJHNxbCA9
ICJEUk9QIFRBQkxFIElGIEVYSVNUUyAiLlBGWC4iYXJjX3R3aXR0ZXI7IjsKICAgIGlmICgh
c2FmZV9xdWVyeSgkc3FsKSkgewogICAgICAgIHJldHVybiAnRXJyb3IgLSB1bmFibGUgdG8g
ZGVsZXRlIGFyY190d2l0dGVyIHRhYmxlJzsKICAgIH0KCiAgICAkc3FsID0gIkRFTEVURSBG
Uk9NICAiLlBGWC4idHhwX3ByZWZzIFdIRVJFIGV2ZW50PSdhcmNfdHdpdHRlcic7IjsKICAg
IGlmICghc2FmZV9xdWVyeSgkc3FsKSkgewogICAgICAgIHJldHVybiAnRXJyb3IgLSB1bmFi
bGUgdG8gZGVsZXRlIGFyY190d2l0dGVyIHByZWZlcmVuY2VzJzsKICAgIH0KCn0KZnVuY3Rp
b24gYXJjX3R3aXR0ZXJfdXJsX21ldGhvZF9zZWxlY3QoJG5hbWUsICR2YWwpCnsKICAgICRt
ZXRob2RzID0gYXJyYXkoJ3Rpbnl1cmwnID0+ICdUaW55dXJsJywKICAgICAgJ2lzZ2QnID0+
ICdJcy5nZCcsCiAgICAgICdhcmNfdHdpdHRlcicgPT4gJ1RYUCBUd2VldCcsCiAgICAgICdz
bWQnID0+ICdzbWRfc2hvcnRfdXJsJyk7CiAgICByZXR1cm4gc2VsZWN0SW5wdXQoJG5hbWUs
ICRtZXRob2RzLCAkdmFsKTsKfQpmdW5jdGlvbiBhcmNfdHdpdHRlcl90YWJfc2VsZWN0KCRu
YW1lLCAkdmFsKQp7CiAgICAkdGFicyA9IGFycmF5KCdjb250ZW50JyA9PiAnQ29udGVudCcs
CiAgICAgICAgJ2V4dGVuc2lvbnMnID0+ICdFeHRlbnNpb25zJywKICAgICAgICAnJyA9PiAn
SGlkZGVuJyk7CiAgICByZXR1cm4gc2VsZWN0SW5wdXQoJG5hbWUsICR0YWJzLCAkdmFsKTsK
fQovLyBQcm92aWRlIGludGVyZmFjZSBmb3Igc2V0dGluZyBwcmVmZXJlbmNlcwpmdW5jdGlv
biBhcmNfdHdpdHRlcl9wcmVmcygkZXZlbnQsJHN0ZXApCnsKCiAgICBnbG9iYWwgJHByZWZz
LCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7
CgogICAgJHVzZXIgICAgICAgICAgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXTsKICAg
ICRwcmVmaXggICAgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl9wcmVmaXgnXTsKICAgICR0
d2VldF9kZWZhdWx0ID0gJHByZWZzWydhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0J107CiAg
ICAkdXJsX21ldGhvZCAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddOwog
ICAgJHNob3J0X3VybCAgICAgPSAkcHJlZnNbJ2FyY19zaG9ydF91cmwnXTsKICAgICRzaG9y
dF9zaXRlX3VybD0gJHByZWZzWydhcmNfc2hvcnRfc2l0ZV91cmwnXTsKICAgICRjYWNoZV9k
aXIgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXTsKICAgICR0YWIgICAg
ICAgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl90YWInXTsKCiAgICBzd2l0Y2ggKCRzdGVw
KSB7CiAgICAgICAgY2FzZSAncHJlZnNfc2F2ZSc6IHBhZ2V0b3AoJ1RYUCBUd2VldCcsICdQ
cmVmZXJlbmNlcyBzYXZlZCcpOyBicmVhazsKICAgICAgICBjYXNlICdyZWdpc3Rlcic6IHBh
Z2V0b3AoJ1RYUCBUd2VldCcsJ0Nvbm5lY3QgdG8gVHdpdHRlcicpOyBicmVhazsKICAgICAg
ICBjYXNlICd2YWxpZGF0ZSc6CiAgICAgICAgZGVmYXVsdDogcGFnZXRvcCgnVFhQIFR3ZWV0
Jyk7CiAgICB9CgogICAgJGh0bWwgPSAnJzsKCiAgICBpZiAoJHN0ZXA9PSdyZWdpc3Rlcicp
IHsgLy8gT0F1dGggcmVnaXN0cmF0aW9uIHByb2Nlc3MKICAgICAgICAkdHdpdCA9IG5ldyBh
cmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgLCAkYXJj
X3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQpOwoKICAgICAgICAvLyBCdWlsZCBhIGNhbGxiYWNr
IFVSTCBmb3IgVHdpdHRlciB0byByZXR1cm4gdG8gdGhlIG5leHQgc3RhZ2UKICAgICAgICAk
Y2FsbGJhY2tVUkwgPSAkdHdpdC0+Y2FsbGJhY2tVUkwoJGV2ZW50LCd2YWxpZGF0ZScpOwoK
ICAgICAgICAkcmVxdWVzdCA9ICR0d2l0LT5nZXRSZXF1ZXN0VG9rZW4oJGNhbGxiYWNrVVJM
KTsKICAgICAgICAkcmVxdWVzdF90b2tlbiA9ICRyZXF1ZXN0WyJvYXV0aF90b2tlbiJdOwog
ICAgICAgICRyZXF1ZXN0X3Rva2VuX3NlY3JldCA9ICRyZXF1ZXN0WyJvYXV0aF90b2tlbl9z
ZWNyZXQiXTsKCiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3JlcXVlc3RUb2tlbics
JHJlcXVlc3RfdG9rZW4KICAgICAgICAgICAgLCAnYXJjX3R3aXR0ZXInLDIpOwogICAgICAg
IHNldF9wcmVmKCdhcmNfdHdpdHRlcl9yZXF1ZXN0VG9rZW5TZWNyZXQnLCRyZXF1ZXN0X3Rv
a2VuX3NlY3JldAogICAgICAgICAgICAsICdhcmNfdHdpdHRlcicsMik7CgogICAgICAgICRo
dG1sLj0gc3RhcnRUYWJsZSgnZWRpdCcpLgogICAgICAgICAgICAgICAgdHIodGQoCiAgICAg
ICAgICAgICAgICAgICAgKCc8cD4nLmhyZWYoJ1NpZ24taW4gdG8gVHdpdHRlcicKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICwkdHdpdC0+Z2V0QXV0aG9yaXplVVJMKCRyZXF1ZXN0
KSkKICAgICAgICAgICAgICAgICAgICAgICAgLicgYW5kIGZvbGxvdyB0aGUgaW5zdHJ1Y3Rp
b25zIHRvIGFsbG93IFRYUCBUd2VldCB0byB1c2UgeW91ciBhY2NvdW50LiBJZiB5b3UgYXJl
IGFscmVhZHkgc2lnbmVkIGluIHRvIFR3aXR0ZXIgdGhlbiB0aGF0IGFjY291bnQgd2lsbCBi
ZSBhc3NvY2lhdGVkIHdpdGggVFhQIFR3ZWV0IHNvIHlvdSBtYXkgbmVlZCB0byBzaWduIG91
dCBmaXJzdCBpZiB5b3Ugd2FudCB0byB1c2UgYSBkaWZmZXJlbnQgYWNjb3VudC48L3A+JykK
ICAgICAgICAgICAgICAgICkpLmVuZFRhYmxlKCk7CiAgICB9IGVsc2VpZiAoJHN0ZXA9PSd2
YWxpZGF0ZScpIHsKICAgICAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJjX3R3aXR0
ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNy
ZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfcmVxdWVzdFRva2VuJ10KICAgICAgICAgICAgLCAk
cHJlZnNbJ2FyY190d2l0dGVyX3JlcXVlc3RUb2tlblNlY3JldCddKTsKICAgICAgICAvLyBB
c2sgVHdpdHRlciBmb3IgYW4gYWNjZXNzIHRva2VuIChhbmQgYW4gYWNjZXNzIHRva2VuIHNl
Y3JldCkKICAgICAgICAkcmVxdWVzdCA9ICR0d2l0LT5nZXRBY2Nlc3NUb2tlbiggZ3BzKCdv
YXV0aF92ZXJpZmllcicpICk7CiAgICAgICAgJGFjY2Vzc190b2tlbiA9ICRyZXF1ZXN0Wydv
YXV0aF90b2tlbiddOwogICAgICAgICRhY2Nlc3NfdG9rZW5fc2VjcmV0ID0gJHJlcXVlc3Rb
J29hdXRoX3Rva2VuX3NlY3JldCddOwogICAgICAgICR1c2VyID0gJHJlcXVlc3RbJ3NjcmVl
bl9uYW1lJ107CiAgICAgICAgLy8gU3RvcmUgdGhlIGFjY2VzcyB0b2tlbiBhbmQgc2VjcmV0
CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJywkYWNjZXNzX3Rv
a2VuLCAnYXJjX3R3aXR0ZXInLDIpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9h
Y2Nlc3NUb2tlblNlY3JldCcsJGFjY2Vzc190b2tlbl9zZWNyZXQKICAgICAgICAgICAgLCAn
YXJjX3R3aXR0ZXInLDIpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl91c2VyJywk
dXNlcik7CiAgICAgICAgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddID0gJGFj
Y2Vzc190b2tlbjsKICAgICAgICAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2Vj
cmV0J10gPSAkYWNjZXNzX3Rva2VuX3NlY3JldDsKICAgICAgICB1bnNldCgkdHdpdCk7CiAg
ICB9CgogICAgaWYgKCRzdGVwPT0icHJlZnNfc2F2ZSIpIHsKICAgICAgICAkcHJlZml4ID0g
dHJpbShncHMoJ2FyY190d2l0dGVyX3ByZWZpeCcpKTsKICAgICAgICAkdHdlZXRfZGVmYXVs
dCA9IGdwcygnYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcpOwogICAgICAgICR1cmxfbWV0
aG9kID0gZ3BzKCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJyk7CiAgICAgICAgJHNob3J0X3Vy
bCA9IGdwcygnYXJjX3Nob3J0X3VybCcpOwogICAgICAgICRzaG9ydF9zaXRlX3VybCA9IGdw
cygnYXJjX3Nob3J0X3NpdGVfdXJsJyk7CiAgICAgICAgJGNhY2hlX2RpciA9IGdwcygnYXJj
X3R3aXR0ZXJfY2FjaGVfZGlyJyk7CiAgICAgICAgJHRhYiA9IGdwcygnYXJjX3R3aXR0ZXJf
dGFiJyk7CiAgICAgICAgaWYgKHN0cmxlbigkcHJlZml4KTw9MjApIHsKICAgICAgICAgICAg
c2V0X3ByZWYoJ2FyY190d2l0dGVyX3ByZWZpeCcsJHByZWZpeCk7CiAgICAgICAgfSBlbHNl
IHsKICAgICAgICAgICAgJHByZWZpeCA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfcHJlZml4J107
CiAgICAgICAgfQogICAgICAgICR0d2VldF9kZWZhdWx0ID0gKCR0d2VldF9kZWZhdWx0KSA/
IDEgOiAwOwogICAgICAgICRzaG9ydF91cmwgPSAoJHNob3J0X3VybCkgPyAxIDogMDsKICAg
ICAgICBpZiAoISRzaG9ydF9zaXRlX3VybCkgJHNob3J0X3NpdGVfdXJsID0gJHByZWZzWydz
aXRldXJsJ107CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQn
LCR0d2VldF9kZWZhdWx0KTsKICAgICAgICBzZXRfcHJlZignYXJjX3Nob3J0X3VybCcsJHNo
b3J0X3VybCk7CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3VybF9tZXRob2QnLCR1
cmxfbWV0aG9kKTsKICAgICAgICBzZXRfcHJlZignYXJjX3Nob3J0X3NpdGVfdXJsJywkc2hv
cnRfc2l0ZV91cmwpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9jYWNoZV9kaXIn
LCRjYWNoZV9kaXIpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl90YWInLCR0YWIp
OwogICAgfQoKICAgIGlmICggJHN0ZXAhPSdyZWdpc3RlcicgKSB7CiAgICAgICAgaWYgKCBp
c3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10pCiAgICAgICAgJiYgaXNz
ZXQoJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKSApIHsKICAgICAg
ICAgICAgJHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5
CiAgICAgICAgICAgICAgICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCwgJHByZWZz
WydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddCiAgICAgICAgICAgICAgICAsICRwcmVmc1sn
YXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSk7CiAgICAgICAgICAgICRyZWdpc3Rl
clVSTCA9ICR0d2l0LT5jYWxsYmFja1VSTCgkZXZlbnQsJ3JlZ2lzdGVyJyk7CiAgICAgICAg
ICAgICRodG1sLj0gc3RhcnRUYWJsZSgnbGlzdCcpLmZvcm0oCiAgICAgICAgICAgICAgICB0
cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVHdpdHRlciBhY2NvdW50IGRldGFp
bHMnLCAyKSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAogICAg
ICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfdXNlciI+VHdp
dHRlciB1c2VybmFtZTwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHls
ZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAg
ICAgICAgICAgICAgICAgLnRkKAogICAgICAgICAgICAgICAgICAgICAgICAoJHByZWZzWydh
cmNfdHdpdHRlcl91c2VyJ10pID8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICR1c2Vy
LicgKCcuaHJlZignUmUtY29ubmVjdCcsJHJlZ2lzdGVyVVJMKS4nKScKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIDogJzxlbT51bmtub3duPC9lbT4nCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAuaHJlZignQ29ubmVjdCB0byBUd2l0dGVyJywkcmVnaXN0ZXJVUkwpKQog
ICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAogICAgICAgICAgICAgICAg
ICAgIHRkY3MoaGVkKCdUd2VldCBzZXR0aW5ncycsIDIpLDIpCiAgICAgICAgICAgICAgICAp
CiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwg
Zm9yPSJhcmNfdHdpdHRlcl9jYWNoZV9kaXIiPlR3ZWV0IHByZWZpeDwvbGFiZWw+JywKICAg
ICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRp
Y2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKGZJbnB1dCgn
dGV4dCcsJ2FyY190d2l0dGVyX3ByZWZpeCcsJHByZWZpeCwnJywnJywnJywnJywnJywnYXJj
X3R3aXR0ZXJfcHJlZml4JykpCiAgICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAg
ICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCI+VHdl
ZXQgYXJ0aWNsZXMgYnkgZGVmYXVsdDwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAg
ICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7
IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKHllc25vUmFkaW8oJ2FyY190d2l0dGVyX3R3
ZWV0X2RlZmF1bHQnLCAkdHdlZXRfZGVmYXVsdCwgJycsICdhcmNfdHdpdHRlcl90d2VldF9k
ZWZhdWx0JykpCiAgICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRk
YSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCI+VVJMIHNob3J0bmVyPC9s
YWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiBy
aWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAu
dGQoYXJjX3R3aXR0ZXJfdXJsX21ldGhvZF9zZWxlY3QoJ2FyY190d2l0dGVyX3VybF9tZXRo
b2QnLCR1cmxfbWV0aG9kKSkKICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAgICAg
ICAgICAgdGRjcyhoZWQoJ1RYUCBUd2VldCBzaG9ydCBVUkwnLCAyKSwyKQogICAgICAgICAg
ICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgn
PGxhYmVsIGZvcj0iYXJjX3Nob3J0X3VybCI+RW5hYmxlIFRYUCBUd2VldCBzaG9ydCBVUkwg
cmVkaXJlY3Q8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRl
eHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAg
ICAgICAgICAgIC50ZCh5ZXNub1JhZGlvKCdhcmNfc2hvcnRfdXJsJywgJHNob3J0X3VybCwg
JycsICdhcmNfc2hvcnRfdXJsJykpLAogICAgICAgICAgICAgICAgICAgICcgaWQ9ImFyY19z
aG9ydF91cmwtb25fb2ZmIicKICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAgICAg
ICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfc2hvcnRfc2l0ZV91cmwiPlRYUCBUd2VldCBz
aG9ydCBzaXRlIFVSTDwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHls
ZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAg
ICAgICAgICAgICAgICAgLnRkKGZJbnB1dCgndGV4dCcsJ2FyY19zaG9ydF9zaXRlX3VybCcs
JHNob3J0X3NpdGVfdXJsLCcnLCcnLCcnLCcnLCcnLCdhcmNfc2hvcnRfc2l0ZV91cmwnKSks
CiAgICAgICAgICAgICAgICAgICAgJyBpZD0iYXJjX3Nob3J0X3NpdGVfdXJsLW9wdGlvbiIn
CiAgICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdU
d2l0dGVyIHRhYicsIDIpLDIpCiAgICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAg
ICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfdGFiIj5Mb2NhdGlvbiBvZiBU
d2l0dGVyIHRhYjwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0i
dGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAg
ICAgICAgICAgICAgLnRkKGFyY190d2l0dGVyX3RhYl9zZWxlY3QoJ2FyY190d2l0dGVyX3Rh
YicsJHRhYikpCiAgICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRk
Y3MoaGVkKCdDYWNoZScsIDIpLDIpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAg
ICAudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRl
cl9jYWNoZV9kaXIiPkNhY2hlIGRpcmVjdG9yeTwvbGFiZWw+JywKICAgICAgICAgICAgICAg
ICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBt
aWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKGZJbnB1dCgndGV4dCcsJ2FyY190
d2l0dGVyX2NhY2hlX2RpcicsJGNhY2hlX2RpciwnJywnJywnJywnJywnJywnYXJjX3R3aXR0
ZXJfY2FjaGVfZGlyJykpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudHIo
CiAgICAgICAgICAgICAgICAgICAgdGRhKAogICAgICAgICAgICAgICAgICAgICAgICBmSW5w
dXQoJ3N1Ym1pdCcsICdTdWJtaXQnLCBnVHh0KCdzYXZlX2J1dHRvbicpLCAncHVibGlzaCcp
CiAgICAgICAgICAgICAgICAgICAgICAgIC5uLnNJbnB1dCgncHJlZnNfc2F2ZScpCiAgICAg
ICAgICAgICAgICAgICAgICAgIC5uLmVJbnB1dCgncGx1Z2luX3ByZWZzLmFyY190d2l0dGVy
JykKICAgICAgICAgICAgICAgICAgICAsICcgY29sc3Bhbj0iMiIgY2xhc3M9Im5vbGluZSIn
KSkpCiAgICAgICAgICAgICAgICAuZW5kVGFibGUoKTsKICAgICAgICB9IGVsc2VpZiAoICRz
dGVwIT0ncmVnaXN0ZXInICkgewogICAgICAgICAgICAkcmVnaXN0ZXJVUkwgPSBhcmNfdHdp
dHRlcjo6Y2FsbGJhY2tVUkwoJGV2ZW50LCdyZWdpc3RlcicpOwogICAgICAgICAgICAkaHRt
bC49IHN0YXJ0VGFibGUoJ2xpc3QnKS5mb3JtKAogICAgICAgICAgICAgICAgdHIoCiAgICAg
ICAgICAgICAgICAgICAgdGRjcyhoZWQoJ1R3aXR0ZXIgYWNjb3VudCBkZXRhaWxzJywgMiks
MikKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAg
ICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX3VzZXIiPlR3aXR0ZXIgdXNl
cm5hbWU8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQt
YWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAg
ICAgICAgIC50ZCgKICAgICAgICAgICAgICAgICAgICAgICAgKCc8ZW0+dW5rbm93bjwvZW0+
ICgnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaHJlZignQ29ubmVjdCB0byBUd2l0
dGVyJywkcmVnaXN0ZXJVUkwpLicpJykKICAgICAgICAgICAgICAgICkpKQogICAgICAgICAg
ICAgICAgLmVuZFRhYmxlKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8vIFNldCBqUXVlcnkg
Zm9yIHN3aXRjaGluZyBvbi9vZmYgcmVsZXZhbnQgYXJjX3Nob3J0X3VybCBmaWVsZHMKICAg
ICRqcyA9IDw8PEpTCjxzY3JpcHQgbGFuZ3VhZ2U9ImphdmFzY3JpcHQiIHR5cGU9InRleHQv
amF2YXNjcmlwdCI+CiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCl7CiAgdmFyIG9ub2Zm
ID0gJCgnI2FyY19zaG9ydF91cmwtb25fb2ZmJyk7CiAgdmFyIGFyY19zaG9ydF91cmxfb2Zm
ID0gJCgnI2FyY19zaG9ydF91cmwtYXJjX3Nob3J0X3VybC0wJyk7CiAgdmFyIHVybCA9ICQo
JyNhcmNfc2hvcnRfc2l0ZV91cmwtb3B0aW9uJyk7CiAgdmFyIHVybF9tZXRob2QgPSAkKCdz
ZWxlY3RbbmFtZT0iYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCJdJyk7CgogIGlmIChhcmNfc2hv
cnRfdXJsX29mZi5hdHRyKCdjaGVja2VkJyk9PXRydWUKICAmJiAkKCdvcHRpb246c2VsZWN0
ZWQnLCB1cmxfbWV0aG9kKS52YWwoKSE9J2FyY190d2l0dGVyJykgewogICAgdXJsLmhpZGUo
KTsKICB9CiAgJCgnaW5wdXQnLCBvbm9mZikuY2hhbmdlKGZ1bmN0aW9uKCl7CiAgICBpZiAo
JCgnb3B0aW9uOnNlbGVjdGVkJywgdXJsX21ldGhvZCkudmFsKCkhPSdhcmNfdHdpdHRlcicp
IHsKICAgICAgYXJjX3Nob3J0X3VybF9vZmYuYXR0cignY2hlY2tlZCcpPT10cnVlID8gdXJs
LmhpZGUoKSA6IHVybC5zaG93KCk7CiAgICB9CiAgfSk7CgogIGlmICgkKCdvcHRpb246c2Vs
ZWN0ZWQnLCB1cmxfbWV0aG9kKS52YWwoKT09J2FyY190d2l0dGVyJykgewogICAgb25vZmYu
aGlkZSgpOyB1cmwuc2hvdygpOwogIH0KICB1cmxfbWV0aG9kLmNoYW5nZShmdW5jdGlvbigp
ewogICAgaWYgKCQoJ29wdGlvbjpzZWxlY3RlZCcsIHVybF9tZXRob2QpLnZhbCgpPT0nYXJj
X3R3aXR0ZXInKSB7CiAgICAgIG9ub2ZmLnRvZ2dsZSgpOyB1cmwuc2hvdygpOwogICAgfSBl
bHNlIHsKICAgICAgb25vZmYudG9nZ2xlKCk7CiAgICAgIGFyY19zaG9ydF91cmxfb2ZmLmF0
dHIoJ2NoZWNrZWQnKT09dHJ1ZSA/IHVybC5oaWRlKCkgOiB1cmwuc2hvdygpOwogICAgfQog
IH0pCn0pOwo8L3NjcmlwdD4KSlM7CgogICAgZWNobyAkanMuJGh0bWw7Cn0KCi8vIEFkZCBU
d2l0dGVyIHRhYiB0byBUZXh0cGF0dGVybgpmdW5jdGlvbiBhcmNfYWRtaW5fdHdpdHRlcigk
ZXZlbnQsJHN0ZXApCnsKICAgIGdsb2JhbCAkcHJlZnMsICRhcmNfdHdpdHRlcl9jb25zdW1l
cktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgICR0d2l0ID0gbmV3IGFy
Y190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAsICRhcmNf
dHdpdHRlcl9jb25zdW1lclNlY3JldCwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tl
biddCiAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3Jl
dCddKTsKCiAgICAkdHdpdC0+Y2FjaGVEaXIoJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9k
aXInXSk7CgogICAgJHhtbCA9ICR0d2l0LT5nZXQoJ3VzZXJzL3Nob3cnCiAgICAgICAgLCBh
cnJheSgnc2NyZWVuX25hbWUnPT4kcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSkpOwogICAg
JHR3aXR0ZXJVc2VyID0gQCR4bWwtPnhwYXRoKCcvdXNlcicpOwogICAgJHR3aXR0ZXJVc2Vy
ID0gJHR3aXR0ZXJVc2VyWzBdOwogICAgJHR3aXR0ZXJVc2VyVVJMID0gJ2h0dHA6Ly93d3cu
dHdpdHRlci5jb20vJy4kdHdpdHRlclVzZXItPnNjcmVlbl9uYW1lOwoKICAgIGlmICgkc3Rl
cD09InR3ZWV0IikgeyAvLyBwb3N0IGFuIHVwZGF0ZSB0byBUd2l0dGVyCgogICAgICAgIC8v
IGZldGNoIGFuZCBjbGVhbiBtZXNzYWdlCiAgICAgICAgJG1lc3NhZ2UgPSBzdHJpcF90YWdz
KGdwcygnbWVzc2FnZScpKTsKICAgICAgICAkY291bnQgPSBzdHJsZW4oJG1lc3NhZ2UpOwoK
ICAgICAgICBpZiAoJGNvdW50PD0xNDAgJiYgJGNvdW50PjApIHsgLy8gcG9zdCB1cGRhdGUK
ICAgICAgICAgICAgJHJlc3VsdCA9ICR0d2l0LT5wb3N0KCdzdGF0dXNlcy91cGRhdGUnLCBh
cnJheSgnc3RhdHVzJyA9PiAkbWVzc2FnZSkpOwogICAgICAgIH0gZWxzZSB7IC8vIG1lc3Nh
Z2UgdG9vIGxvbmcsIEphdmFTY3JpcHQgaW50ZXJmYWNlIHNob3VsZCBwcmV2ZW50IHRoaXMK
ICAgICAgICAgICAgJHJlc3VsdCA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgcGFnZXRv
cCgnVHdpdHRlcicsCiAgICAgICAgICAgICgoJHJlc3VsdCE9ZmFsc2UpPydUd2l0dGVyIHVw
ZGF0ZWQnOidFcnJvciB1cGRhdGluZyBUd2l0dGVyJykpOwoKICAgIH0gZWxzZWlmICgkc3Rl
cD09ImRlbGV0ZSIpIHsgLy8gZGVsZXRlIGFuIHVwZGF0ZSBmcm9tIFR3aXR0ZXIKCiAgICAg
ICAgJGlkID0gc3RyaXBfdGFncyhncHMoJ2lkJykpOwogICAgICAgIGlmICgkaWQpIHsKICAg
ICAgICAgICAgJHR3aXQtPmRlbGV0ZSgnc3RhdHVzZXMvZGVzdHJveScuJGlkKTsKICAgICAg
ICAgICAgc2FmZV9kZWxldGUoJ2FyY190d2l0dGVyJywidHdlZXRfaWQgPSAkaWQiKTsKICAg
ICAgICB9CgogICAgICAgIHBhZ2V0b3AoJ1R3aXR0ZXInLCdUd2l0dGVyIHVwZGF0ZWQnKTsK
CiAgICB9IGVsc2UgewoKICAgICAgICBwYWdldG9wKCdUd2l0dGVyJyk7CgogICAgfQoKICAg
IC8vIFByZXBhcmUgSmF2YVNjcmlwdCB0byBjcmVhdGUgVHdpdHRlciB1cGRhdGUgaW50ZXJm
YWNlCgogICAgJGpzID0gJzxzY3JpcHQgbGFuZ3VhZ2U9ImphdmFzY3JpcHQiIHR5cGU9InRl
eHQvamF2YXNjcmlwdCI+JzsKICAgICRqcy49ICIkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlv
bigpewogICAgICAgICAgICB2YXIgY291bnRlclN0eWxlID0gJ2ZvbnQtd2VpZ2h0OmJvbGQ7
ZmxvYXQ6cmlnaHQ7Zm9udC1zaXplOjJlbTtsaW5lLWhlaWdodDoxLjJlbTsnOwogICAgICAg
ICAgICAkKCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0eWxlJywgY291bnRlclN0eWxlKydjb2xv
cjojY2NjOycpOwogICAgICAgICAgICAkKCcjbWVzc2FnZScpLmtleXVwKGZ1bmN0aW9uKCkg
ewogICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gMTQwLSQoJyNtZXNzYWdlJykudmFsKCku
bGVuZ3RoOwogICAgICAgICAgICAgICAgJCgnI3R3ZWV0Y291bnQnKS5odG1sKGNvdW50Kycn
KTsgLy8gaGFjayB0byBmb3JjZSBvdXRwdXQgb2YgMAogICAgICAgICAgICAgICAgaWYgKGNv
dW50PDApIHsKICAgICAgICAgICAgICAgICAgICAkKCdpbnB1dC5wdWJsaXNoJykuYXR0cign
ZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAg
ICAgICAgICAgICAgICAgJCgnaW5wdXQucHVibGlzaCcpLmF0dHIoJ2Rpc2FibGVkJywgJycp
OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGNvdW50PDApIHsKICAg
ICAgICAgICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0eWxlJywgY291bnRl
clN0eWxlKydjb2xvcjojZjAwOycpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb3Vu
dDwxMCkgewogICAgICAgICAgICAgICAgICAgICQoJyN0d2VldGNvdW50JykuYXR0cignc3R5
bGUnLCBjb3VudGVyU3R5bGUrJ2NvbG9yOiMwMDA7Jyk7CiAgICAgICAgICAgICAgICB9IGVs
c2UgewogICAgICAgICAgICAgICAgICAgICQoJyN0d2VldGNvdW50JykuYXR0cignc3R5bGUn
LCBjb3VudGVyU3R5bGUrJ2NvbG9yOiNjY2M7Jyk7CiAgICAgICAgICAgICAgICB9CiAgICAg
ICAgICAgIH0pCiAgICAgICAgfSk7IjsKICAgICRqcy49ICI8L3NjcmlwdD4iOwoKICAgICRv
dXQgPSAnJzsKICAgICR4bWwgPSAkdHdpdC0+Z2V0KCdzdGF0dXNlcy91c2VyX3RpbWVsaW5l
JwogICAgICAgICwgYXJyYXkoJ3NjcmVlbl9uYW1lJz0+JHByZWZzWydhcmNfdHdpdHRlcl91
c2VyJ10sJ2NvdW50Jz0+MjUpKTsKICAgICR0d2VldHMgPSBAJHhtbC0+eHBhdGgoJy9zdGF0
dXNlcy9zdGF0dXMnKTsKICAgIGlmICgkdHdlZXRzKSBmb3JlYWNoICgkdHdlZXRzIGFzICR0
d2VldCkgewogICAgICAgICR0aW1lID0gc3RydG90aW1lKGh0bWxlbnRpdGllcygkdHdlZXQt
PmNyZWF0ZWRfYXQpKTsKICAgICAgICAkZGF0ZSA9IHNhZmVfc3RyZnRpbWUoJHByZWZzWydh
cmNoaXZlX2RhdGVmb3JtYXQnXSwkdGltZSk7CiAgICAgICAgJG91dC49IHRyKHRkKCRkYXRl
LCdzcGFuJykKICAgICAgICAgICAgLnRkKGFyY19Ud2l0dGVyOjptYWtlTGlua3MoaHRtbGVu
dGl0aWVzKCR0d2VldC0+dGV4dAogICAgICAgICAgICAgICAgLCBFTlRfUVVPVEVTLCdVVEYt
OCcpKSkKICAgICAgICAgICAgLnRkKGRMaW5rKCdhcmNfYWRtaW5fdHdpdHRlcicsJ2RlbGV0
ZScsJ2lkJywkdHdlZXQtPmlkLCcnKSkKICAgICAgICAgICAgKTsKICAgIH0KCiAgICAkaHRt
bCA9IHN0YXJ0VGFibGUoJ2VkaXQnKQogICAgICAgICAgICAudHIodGQoCiAgICAgICAgICAg
IGdyYWYoJzxpbWcgc3JjPSInLiR0d2l0dGVyVXNlci0+cHJvZmlsZV9pbWFnZV91cmwuJyIg
YWx0PSJUd2l0dGVyIGF2YXRhciIgLz4nCiAgICAgICAgICAgICwnIHN0eWxlPSJmbG9hdDps
ZWZ0O3BhZGRpbmc6MnB4OyInKQogICAgICAgICAgICAuZ3JhZihocmVmKCR0d2l0dGVyVXNl
ci0+bmFtZSwkdHdpdHRlclVzZXJVUkwpLCcgc3R5bGU9ImZvbnQtc2l6ZToxLjJlbTtmb250
LXdlaWdodDpib2xkOyInKQogICAgICAgICAgICAuZ3JhZihocmVmKCR0d2l0dGVyVXNlci0+
ZnJpZW5kc19jb3VudC4nIGZvbGxvd2luZycsJHR3aXR0ZXJVc2VyVVJMLicvZm9sbG93aW5n
JykKICAgICAgICAgICAgLicsICcuaHJlZigkdHdpdHRlclVzZXItPmZvbGxvd2Vyc19jb3Vu
dC4nIGZvbGxvd2VycycsJHR3aXR0ZXJVc2VyVVJMLicvZm9sbG93ZXJzJykKICAgICAgICAg
ICAgLicsICcuaHJlZigkdHdpdHRlclVzZXItPnN0YXR1c2VzX2NvdW50LicgdXBkYXRlcycs
JHR3aXR0ZXJVc2VyVVJMKSkpKQogICAgICAgICAgICAudHIodGQoZm9ybSgKICAgICAgICAg
ICAgZ3JhZigiVXBkYXRlIFR3aXR0ZXIuLi48c3BhbiBpZD0ndHdlZXRjb3VudCcgc3R5bGU9
J2ZvbnQtd2VpZ2h0OmJvbGQ7ZmxvYXQ6cmlnaHQ7Jz4xNDA8L3NwYW4+IikKICAgICAgICAg
ICAgLnRleHRfYXJlYSgnbWVzc2FnZScsJzUwJywnNTUwJywnJywnbWVzc2FnZScpCiAgICAg
ICAgICAgIC5lSW5wdXQoJ2FyY19hZG1pbl90d2l0dGVyJykKICAgICAgICAgICAgLnNJbnB1
dCgndHdlZXQnKS5icgogICAgICAgICAgICAuZklucHV0KCdzdWJtaXQnLCd1cGRhdGUnLGdU
eHQoJ1VwZGF0ZScpLCdwdWJsaXNoJykKICAgICAgICApKSkKICAgICAgICAuZW5kVGFibGUo
KTsKCiAgICAvLyBBdHRhY2ggcmVjZW50IFR3aXR0ZXIgdXBkYXRlcwoKICAgICRodG1sLj0g
c3RhcnRUYWJsZSgnbGlzdCcsJycsJycsJycsJzkwJScpCiAgICAgICAgLiRvdXQKICAgICAg
ICAuZW5kVGFibGUoKTsKCiAgICAvLyBPdXRwdXQgSmF2YVNjcmlwdCBhbmQgSFRNTAoKICAg
IGVjaG8gJGpzLiRodG1sOwp9CgovLyBBZGQgVHdpdHRlciBvcHRpb25zIHRvIGFydGljbGUg
YXJ0aWNsZSBzY3JlZW4KZnVuY3Rpb24gYXJjX2FwcGVuZF90d2l0dGVyKCRldmVudCwgJHN0
ZXAsICRkYXRhLCAkcnMxKQp7CiAgICBnbG9iYWwgJHByZWZzLCAkYXJjX3R3aXR0ZXI7CiAg
ICAkcHJlZml4ID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3ByZWZpeCcpKTsKICAgICRwcmVm
aXggPSAoJHByZWZpeCkgPyAkcHJlZml4IDogJHByZWZzWydhcmNfdHdpdHRlcl9wcmVmaXgn
XTsKICAgICRzdWZmaXggPSB0cmltKGdwcygnYXJjX3R3aXR0ZXJfc3VmZml4JykpOwoKICAg
IGlmICgkcnMxWydJRCddKSB7CiAgICAgICAgJHNxbCA9ICJTRUxFQ1QgdHdlZXRfaWQsdHdl
ZXQgRlJPTSAiLlBGWC4iYXJjX3R3aXR0ZXIgV0hFUkUgYXJ0aWNsZV9pZD0iLiRyczFbJ0lE
J10uIjsiOwogICAgICAgICRyczIgPSBzYWZlX3F1ZXJ5KCRzcWwpOyAkcnMyID0gbmV4dFJv
dygkcnMyKTsKICAgIH0gZWxzZSB7IC8vIG5ldyBhcnRpY2xlCiAgICAgICAgJHJzMiA9ICcn
OwogICAgfQoKICAgIGlmICgkcnMxWydJRCddICYmICRyczJbJ3R3ZWV0X2lkJ10pIHsKICAg
ICAgICAkY29udGVudCA9IGFyY19Ud2l0dGVyOjptYWtlTGlua3MoJHJzMlsndHdlZXQnXSk7
CiAgICAgICAgcmV0dXJuICRkYXRhLmZpZWxkc2V0KCRjb250ZW50LCAnVHdpdHRlciB1cGRh
dGUnLCAnYXJjX3R3aXR0ZXInKTsKICAgIH0gZWxzZSB7CiAgICAgICAgJHZhciA9IGdwcygn
YXJjX3R3ZWV0X3RoaXMnKTsKICAgICAgICAkdmFyID0gKCRyczFbJ0lEJ10mJiEkdmFyKSA/
IDAgOiAkcHJlZnNbJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnXTsKICAgICAgICAkY29u
dGVudCAgPSB0YWcoeWVzbm9SYWRpbygnYXJjX3R3ZWV0X3RoaXMnLCAkdmFyLCAnJywgJ2Fy
Y190d2VldF90aGlzJyksJ3AnKTsKICAgICAgICAkY29udGVudCAuPSB0YWcoaHJlZignT3B0
aW9ucycsJyNhcmNfdHdpdHRlcl9vcHRpb25zJyksJ3AnLCcgY2xhc3M9InBsYWluIGxldmVy
IiBzdHlsZT0ibWFyZ2luLXRvcDo1cHg7IicpOwogICAgICAgICRjb250ZW50IC49IHRhZyh0
YWcodGFnKCdUd2VldCBwcmVmaXgnLCdsYWJlbCcsICcgZm9yPSJhcmNfdHdpdHRlcl9wcmVm
aXgiJykKICAgICAgICAgICAgLmZJbnB1dCgndGV4dCcsJ2FyY190d2l0dGVyX3ByZWZpeCcs
JHByZWZpeCwnZWRpdCcsJycsJycsJzIyJywnJywnYXJjX3R3aXR0ZXJfcHJlZml4JyksJ3An
KQogICAgICAgICAgICAudGFnKHRhZygnVHdlZXQgc3VmZml4IChlZyAjaGFzaHRhZ3MpJywn
bGFiZWwnLCAnIGZvcj0iYXJjX3R3aXR0ZXJfc3VmZml4IicpCiAgICAgICAgICAgIC5mSW5w
dXQoJ3RleHQnLCdhcmNfdHdpdHRlcl9zdWZmaXgnLCRzdWZmaXgsJ2VkaXQnLCcnLCcnLCcy
MicsJycsJ2FyY190d2l0dGVyX3N1ZmZpeCcpLCdwJykKICAgICAgICAgICAgLCdkaXYnLCcg
aWQ9ImFyY190d2l0dGVyX29wdGlvbnMiIGNsYXNzPSJ0b2dnbGUiIHN0eWxlPSJkaXNwbGF5
Om5vbmUiJyk7CiAgICAgICAgaWYgKGlzc2V0KCRhcmNfdHdpdHRlclsnZXJyb3InXSkpIHsK
ICAgICAgICAgICAgJGNvbnRlbnQgLj0gJzxwPicuJGFyY190d2l0dGVyWydlcnJvciddLic8
L3A+JzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICRkYXRhLmZpZWxkc2V0KCRjb250ZW50
LCAnVXBkYXRlIFR3aXR0ZXInLCAnYXJjX3R3aXR0ZXInKTsKICAgIH0KCn0KCi8vIFVwZGF0
ZSBUd2l0dGVyIHdpdGggcG9zdGVkIGFydGljbGUKZnVuY3Rpb24gYXJjX2FydGljbGVfdHdl
ZXQoJGV2ZW50LCRzdGVwKQp7CiAgICBnbG9iYWwgJHByZWZzLCAkYXJjX3R3aXR0ZXIsICRh
cmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVy
U2VjcmV0OwoKICAgICRhcnRpY2xlX2lkID0gZW1wdHkoJEdMT0JBTFNbJ0lEJ10pID8gZ3Bz
KCdJRCcpIDogJEdMT0JBTFNbJ0lEJ107CiAgICBpZiAoIWVtcHR5KCRhcnRpY2xlX2lkKSkg
ewoKICAgICAgICBpbmNsdWRlX29uY2UgdHhwYXRoLicvcHVibGlzaC90YWdoYW5kbGVycy5w
aHAnOwoKICAgICAgICAkYXJ0aWNsZSA9IHNhZmVfcm93KCJJRCwgVGl0bGUsIFNlY3Rpb24s
IFBvc3RlZCIsICd0ZXh0cGF0dGVybicsCiAgICAgICAgICAgICJJRD17JGFydGljbGVfaWR9
IEFORCBTdGF0dXM9NCBBTkQgbm93KCk+PVBvc3RlZCIpOwoKICAgICAgICBpZiAoJGFydGlj
bGUgJiYgZ3BzKCdhcmNfdHdlZXRfdGhpcycpKSB7IC8vIHR3ZWV0IGFydGljbGUKCiAgICAg
ICAgICAgIC8vIE5lZWQgdG8gbWFudWFsbHkgdXBkYXRlIHRoZSAnVVJMIG9ubHkgdGl0bGUn
IGJlZm9yZSBidWlsZGluZyB0aGUKICAgICAgICAgICAgLy8gVVJMCiAgICAgICAgICAgICRh
cnRpY2xlWyd1cmxfdGl0bGUnXSA9IGdwcygndXJsX3RpdGxlJyk7CiAgICAgICAgICAgIC8v
IE1ha2Ugc2hvcnQgVVJMCiAgICAgICAgICAgICR1cmwgPSBwZXJtbGlua3VybCgkYXJ0aWNs
ZSk7CiAgICAgICAgICAgICRzaG9ydF91cmwgPSBhcmNfc2hvcnRlbl91cmwoJHVybCwkcHJl
ZnNbJ2FyY190d2l0dGVyX3VybF9tZXRob2QnXSwKICAgICAgICAgICAgICAgIGFycmF5KCdp
ZCc9PiRhcnRpY2xlX2lkKSk7CgogICAgICAgICAgICBpZiAoISRzaG9ydF91cmwpIHsgLy8g
RmFpbGVkIHRvIG9idGFpbiBhIHNob3J0ZW5lZCBVUkwsIGRvIG5vdCB0d2VldCEKICAgICAg
ICAgICAgICAgICRhcmNfdHdpdHRlclsnZXJyb3InXSA9ICdVbmFibGUgdG8gb2J0YWluIGEg
c2hvcnQgVVJMIGZvciB0aGlzIGFydGljbGUuJzsKCiAgICAgICAgICAgICAgICByZXR1cm4g
ZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIENvbnN0cnVjdCBUd2l0dGVy
IHVwZGF0ZQogICAgICAgICAgICAkcHJlZml4ICA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9w
cmVmaXgnKSk7CiAgICAgICAgICAgICRwcmVfbGVuID0gc3RybGVuKCRwcmVmaXgpOwogICAg
ICAgICAgICAkcHJlZml4ICA9ICgkcHJlZml4ICYmICRwcmVfbGVuPD0yMCkgPyAkcHJlZml4
LicgJyA6ICcnOwogICAgICAgICAgICAkc3VmZml4ICA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRl
cl9zdWZmaXgnKSk7CiAgICAgICAgICAgICRzdWZfbGVuID0gc3RybGVuKCRzdWZmaXgpOwog
ICAgICAgICAgICAkc3VmZml4ICA9ICgkc3VmZml4ICYmICRzdWZfbGVuPD00MCkgPyAnICcu
JHN1ZmZpeCA6ICcnOwogICAgICAgICAgICAkdXJsX2xlbiA9IHN0cmxlbigkc2hvcnRfdXJs
KSsxOyAvLyBjb3VudCBVUkwgbGVuZ3RoICsgMSBmb3IgcHJlZml4ZWQgc3BhY2UKICAgICAg
ICAgICAgaWYgKCRwcmVmaXgpICRwcmVfbGVuICs9IDE7CiAgICAgICAgICAgIGlmICgkc3Vm
Zml4KSAkc3VmX2xlbiArPSAxOwogICAgICAgICAgICBpZiAoKHN0cmxlbigkYXJ0aWNsZVsn
VGl0bGUnXSkrJHVybF9sZW4rJHByZV9sZW4rJHN1Zl9sZW4pPjE0MCkgewogICAgICAgICAg
ICAgICAgJGFydGljbGVbJ1RpdGxlJ10gPSBzdWJzdHIoJGFydGljbGVbJ1RpdGxlJ10sMCwx
MzUtJHVybF9sZW4tJHByZV9sZW4tJHN1Zl9sZW4pLicuLi4nOwogICAgICAgICAgICB9CiAg
ICAgICAgICAgICR0d2VldCA9ICRwcmVmaXguJGFydGljbGVbJ1RpdGxlJ10uIiAiLiRzaG9y
dF91cmwuJHN1ZmZpeDsKCiAgICAgICAgICAgIC8vIFVwZGF0ZSBUd2l0dGVyCiAgICAgICAg
ICAgICR0d2l0ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQog
ICAgICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQsICRwcmVmc1sn
YXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXQogICAgICAgICAgICAgICAgLCAkcHJlZnNbJ2Fy
Y190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0J10pOwogICAgICAgICAgICAkcmVzdWx0ID0g
JHR3aXQtPnBvc3QoJ3N0YXR1c2VzL3VwZGF0ZScsIGFycmF5KCdzdGF0dXMnID0+ICR0d2Vl
dCkpOwoKICAgICAgICAgICAgJHR3ZWV0X2lkID0gKGlzX29iamVjdCgkcmVzdWx0KSkgPyAk
cmVzdWx0WzBdLT5pZCA6IDA7CgogICAgICAgICAgICBpZiAoJHR3ZWV0X2lkKSB7CgogICAg
ICAgICAgICAgICAgJHR3ZWV0ID0gYWRkc2xhc2hlcygkdHdlZXQpOwoKICAgICAgICAgICAg
ICAgIC8vIHVwZGF0ZSBhcmNfdHdpdHRlciB0YWJsZSB3aXRoIHR3ZWV0CiAgICAgICAgICAg
ICAgICAkc3FsID0gIklOU0VSVCBJTlRPICIuUEZYLiJhcmNfdHdpdHRlciAoYXJ0aWNsZV9p
ZCx0d2VldF9pZCx0d2VldCx0aW55dXJsKSAiOwogICAgICAgICAgICAgICAgJHNxbC49ICJW
QUxVRVMoJGFydGljbGVfaWQsJHR3ZWV0X2lkLFwiJHR3ZWV0XCIsJyRzaG9ydF91cmwnKTsi
OwogICAgICAgICAgICAgICAgc2FmZV9xdWVyeSgkc3FsKTsKCiAgICAgICAgICAgICAgICBy
ZXR1cm4gdHJ1ZTsKCiAgICAgICAgICAgIH0gZWxzZSB7CgogICAgICAgICAgICAgICAgJGFy
Y190d2l0dGVyWydlcnJvciddID0gJ1R3aXR0ZXIgcmVzcG9uc2U6ICcKICAgICAgICAgICAg
ICAgICAgICAuJHR3aXQtPmh0dHBfY29kZTsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxz
ZTsKCiAgICAgICAgICAgIH0KCiAgICAgICAgfQoKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7
Cgp9CgovKgogKiBTaG9ydGVuIFVSTHMgdXNpbmcgdmFyaW91cyBtZXRob2RzCiAqLwoKZnVu
Y3Rpb24gYXJjX3Nob3J0ZW5fdXJsKCR1cmwsICRtZXRob2Q9JycsICRhdHRzPWFycmF5KCkp
CnsKICBnbG9iYWwgJHByZWZzOwoKICAkY2ggPSBjdXJsX2luaXQoKTsKICBjdXJsX3NldG9w
dCgkY2gsIENVUkxPUFRfSEVBREVSLCAwKTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRf
UkVUVVJOVFJBTlNGRVIsIHRydWUpOwogIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9USU1F
T1VULCAxMCk7CgogIHN3aXRjaCAoJG1ldGhvZCkgewogICAgY2FzZSAnc21kJzogLy8gY3Jl
YXRlIGEgc2hvcnRlbmVkIFVSTCB1c2luZyBTTUQgU2hvcnQgVVJMCiAgICAgIHJldHVybiAo
JGF0dHNbJ2lkJ10pID8gaHUuJGF0dHNbJ2lkJ10gOiBmYWxzZTsgYnJlYWs7CiAgICBjYXNl
ICdhcmNfdHdpdHRlcic6IC8vIG5hdGl2ZSBVUkwgc2hvcnRlbmluZwoKICAgICAgcmV0dXJu
ICgkYXR0c1snaWQnXSkgPyBQUk9UT0NPTC4kcHJlZnNbJ2FyY19zaG9ydF9zaXRlX3VybCdd
LicvJy4kYXR0c1snaWQnXSA6IGZhbHNlOwogICAgICBicmVhazsKCiAgICBjYXNlICdpc2dk
JzoKCiAgICAgICR1ID0gJ2h0dHA6Ly9pcy5nZC9hcGkucGhwP2xvbmd1cmw9Jy51cmxlbmNv
ZGUoJHVybCk7CiAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VUkwsICR1KTsKCiAg
ICAgICR0aW55dXJsID0gY3VybF9leGVjKCRjaCk7CiAgICAgIGlmICgkdGlueXVybCE9J0Vy
cm9yJyAmJiAkdGlueXVybCE9JycpIHsKICAgICAgICByZXR1cm4gJHRpbnl1cmw7CiAgICAg
IH0gZWxzZSB7CiAgICAgICAgdHJpZ2dlcl9lcnJvcignYXJjX3R3aXR0ZXIgZmFpbGVkIHRv
IGdldCBhIGlzLmdkIFVSTCBmb3IgJwogICAgICAgICAgICAuJHVybCxFX1VTRVJfV0FSTklO
Ryk7CiAgICAgIH0KICAgICAgYnJlYWs7CgogICAgY2FzZSAndGlueXVybCc6IGRlZmF1bHQ6
IC8vIGNyZWF0ZSBhIHNob3J0ZW5lZCBVUkwgdXNpbmcgVGlueVVSTAoKICAgICAgJHUgPSAn
aHR0cDovL3Rpbnl1cmwuY29tL2FwaS1jcmVhdGUucGhwP3VybD0nLnVybGVuY29kZSgkdXJs
KTsKICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwgJHUpOwogICAgICAkdGlu
eXVybCA9IGN1cmxfZXhlYygkY2gpOwogICAgICBpZiAoJHRpbnl1cmwhPSdFcnJvcicgJiYg
JHRpbnl1cmwhPScnKSB7CiAgICAgICAgcmV0dXJuICR0aW55dXJsOwogICAgICB9IGVsc2Ug
ewogICAgICAgIHRyaWdnZXJfZXJyb3IoJ2FyY190d2l0dGVyIGZhaWxlZCB0byBnZXQgYSBU
aW55VVJMIGZvciAnLiR1cmwsRV9VU0VSX1dBUk5JTkcpOwogICAgICB9CgogIH0KCiAgcmV0
dXJuIGZhbHNlOyAvLyBmYWlsCgp9CgovKgogKiBTaG9ydGVuZWQgVVJMIHJlZGlyZWN0IGJh
c2VkIG9uIHNtZF9zaG9ydF91cmwKICovCmZ1bmN0aW9uIGFyY19zaG9ydF91cmxfcmVkaXJl
Y3QoJGV2ZW50LCAkc3RlcCkgewogIGdsb2JhbCAkcHJlZnM7CgogICRoYXZlX2lkID0gMDsK
CiAgLy8gQ2hlY2sgaWYgdGhlcmUgaXMgYW4gYXZhaWxhYmxlIHNob3J0IHNpdGUgdXJsIGFu
ZCBpZiBpdCBpcyBiZWluZyB1c2VkIGluCiAgLy8gdGhpcyBpbnN0YW5jZQogICRzaG9ydF9z
aXRlX3VybCA9ICRwcmVmc1snYXJjX3Nob3J0X3NpdGVfdXJsJ107CiAgaWYgKCRzaG9ydF9z
aXRlX3VybCkgewogICAgJHNob3J0X3NpdGVfdXJsID0gUFJPVE9DT0wuJHNob3J0X3NpdGVf
dXJsLicvJzsKICAgICR1cmxfcGFydHMgPSBwYXJzZV91cmwoJHNob3J0X3NpdGVfdXJsKTsK
ICAgICRyZSA9ICcjXicuJHVybF9wYXJ0c1sncGF0aCddLicoWzAtOV0uKikjJzsKICAgICRo
YXZlX2lkID0gcHJlZ19tYXRjaCgkcmUsICRfU0VSVkVSWydSRVFVRVNUX1VSSSddLCAkbSk7
CiAgfQoKICAvLyBGYWxsIGJhY2sgdG8gc3RhbmRhcmQgc2l0ZSB1cmwgKHNtZF9zaG9ydF91
cmwgYmVoYXZpb3VyKQogIGlmICgkaGF2ZV9pZCkgewogICAgJHVybF9wYXJ0cyA9IHBhcnNl
X3VybChodSk7CiAgICAkcmUgPSAnI14nLiR1cmxfcGFydHNbJ3BhdGgnXS4nKFswLTldLiop
Iyc7CiAgICAkaGF2ZV9pZCA9IHByZWdfbWF0Y2goJHJlLCAkX1NFUlZFUlsnUkVRVUVTVF9V
UkknXSwgJG0pOwogIH0KCiAgLy8gRG8gdGhlIHJlZGlyZWN0IGlmIHdlJ3ZlIGdvdCBhbiBh
cnRpY2xlIGlkCiAgaWYgKCRoYXZlX2lkKSB7CgkgICRpZCA9ICRtWzFdOwoJICAkcGVybWxp
bmsgPSBwZXJtbGlua3VybF9pZCgkaWQpOwoKCSAgaWYgKCRwZXJtbGluaykgewoJCSAgb2Jf
ZW5kX2NsZWFuKCk7CgoJCSAgLy8gU3R1cGlkLCBvdmVyIHRoZSB0b3AgaGVhZGVyIHNldHRp
bmcgZm9yIElFCgkJICBoZWFkZXIoIlN0YXR1czogMzAxIik7CgkJICBoZWFkZXIoIkhUVFAv
MS4wIDMwMSBNb3ZlZCBQZXJtYW5lbnRseSIpOwoJCSAgaGVhZGVyKCJMb2NhdGlvbjogIi4k
cGVybWxpbmssIFRSVUUsIDMwMSk7CgoJCSAgLy8gSW4gY2FzZSB0aGUgaGVhZGVyKCkgbWV0
aG9kIGZhaWxzLCBmYWxsIGJhY2sgb24gYSBjbGFzc2ljIHJlZGlyZWN0CgkJICBlY2hvICc8
aHRtbD48aGVhZD48TUVUQSBIVFRQLUVRVUlWPSJSZWZyZXNoIiBDT05URU5UPSIwO1VSTD0n
CgkJICAgIC4kcGVybWxpbmsuJyI+PC9oZWFkPjxib2R5PjwvYm9keT48L2h0bWw+JzsKCQkg
IGRpZSgpOwoJICB9CiAgfQoKfQoKLyoKICoqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKKi8K
CmNsYXNzIGFyY190d2l0dGVyIGV4dGVuZHMgVHdpdHRlck9BdXRoIHsKICAgIC8vIENhY2hp
bmcgdmFyaWFibGVzCiAgICBwcml2YXRlICRfY2FjaGUgPSB0cnVlOwogICAgcHJpdmF0ZSAk
X2NhY2hlX2RpciA9ICcuL3RtcCc7CiAgICBwcml2YXRlICRfY2FjaGVfdGltZSA9IDE4MDA7
IC8vIDMwIG1pbnV0ZSBjYWNoZQoKICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRjb25zdW1l
cl9rZXksICRjb25zdW1lcl9zZWNyZXQsICRvYXV0aF90b2tlbiA9IE5VTEwKICAgICAgICAs
ICRvYXV0aF90b2tlbl9zZWNyZXQgPSBOVUxMKQogICAgewogICAgICAgIHBhcmVudDo6X19j
b25zdHJ1Y3QoJGNvbnN1bWVyX2tleSwgJGNvbnN1bWVyX3NlY3JldCwgJG9hdXRoX3Rva2Vu
CiAgICAgICAgICAgICwgJG9hdXRoX3Rva2VuX3NlY3JldCk7CiAgICAgICAgJHRoaXMtPmZv
cm1hdCA9ICd4bWwnOwogICAgICAgICR0aGlzLT50aW1lb3V0ID0gMTU7CiAgICAgICAgJHRo
aXMtPmNvbm5lY3R0aW1lb3V0ID0gMTU7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGNh
bGxiYWNrVVJMKCRldmVudCwkc3RlcCkKICAgIHsKICAgICAgICByZXR1cm4gaHUuJ3RleHRw
YXR0ZXJuL2luZGV4LnBocD9ldmVudD0nLiRldmVudC4nJmFtcDtzdGVwPScuJHN0ZXA7CiAg
ICB9CgogICAgLy8gY3JlYXRlIFR3aXR0ZXIgYW5kIGV4dGVybmFsIGxpbmtzIGluIHRleHQK
ICAgIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gbWFrZUxpbmtzKCR0ZXh0KQogICAgewogICAg
ICAgICR1cmwgPSAnL1xiKGh0dHB8aHR0cHN8ZnRwKTpcL1wvKFtBLVowLTldW0EtWjAtOV8t
XSooPzpcLltBLVowLTldW0EtWjAtOV8tXSopKyk6PyhcZCspP1wvPyhbXC9cdytcLl0rKVxi
L2knOwogICAgICAgICR0ZXh0ID0gcHJlZ19yZXBsYWNlKCR1cmwsICI8YSBocmVmPSckMCc+
JDA8L2E+IiwgJHRleHQpOwogICAgICAgICR1cmwgPSAnL1xiKF58XHMpd3d3LihbYS16X0Et
WjAtOV0rKSgoXC5bYS16XSspKylcYi9pJzsKICAgICAgICAkdGV4dCA9IHByZWdfcmVwbGFj
ZSgkdXJsLCAiPGEgaHJlZj0naHR0cDovL3d3dy4kMiQzJz53d3cuJDIkMzwvYT4iLCAkdGV4
dCk7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2UoIi8oXnxccylAKFthLXpfQS1aMC05
XSspLyIsCiAgICAgICAgICAgICIkMUA8YSBocmVmPSdodHRwOi8vdHdpdHRlci5jb20vJDIn
PiQyPC9hPiIsJHRleHQpOwogICAgICAgICR0ZXh0ID0gcHJlZ19yZXBsYWNlKCIvKF58XHMp
KFwjKFthLXpfQS1aMC05Ol8tXSspKS8iLAogICAgICAgICAgICAiJDE8YSBocmVmPSdodHRw
Oi8vdHdpdHRlci5jb20vc2VhcmNoP3E9JTIzJDMnPiQyPC9hPiIsJHRleHQpOwogICAgICAg
IHJldHVybiAkdGV4dDsKICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGdldCgkdXJsLCAkcGFy
YW1zID0gYXJyYXkoKSkKICAgIHsKICAgICAgICAkYXBpX3VybCA9IG1kNSgkdXJsLnVybGVu
Y29kZShzZXJpYWxpemUoJHBhcmFtcykpKTsKICAgICAgICAkZGF0YSA9ICcnOwoKICAgICAg
ICBpZiAoJHRoaXMtPl9jYWNoZSkgeyAvLyBjaGVjayBmb3IgY2FjaGVkIHhtbAoKICAgICAg
ICAgICAgJGRhdGEgPSAkdGhpcy0+X3JldHJpZXZlQ2FjaGUoJGFwaV91cmwpOwoKICAgICAg
ICB9CiAgICAgICAgaWYgKGVtcHR5KCRkYXRhKSkgewogICAgICAgICAgICAkZGF0YSA9IHBh
cmVudDo6Z2V0KCR1cmwsICRwYXJhbXMpOwogICAgICAgICAgICBpZiAoJHRoaXMtPmh0dHBf
Y29kZT09PTIwMCAmJiAkeG1sPXNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSkpIHsgLy8g
c2F2ZSBjYWNoZQogICAgICAgICAgICAgICAgJGZpbGUgPSAkdGhpcy0+X2NhY2hlX2Rpci4n
LycuJGFwaV91cmw7CiAgICAgICAgICAgICAgICBmaWxlX3B1dF9jb250ZW50cygkZmlsZSwk
ZGF0YSxMT0NLX0VYKTsKICAgICAgICAgICAgICAgIHJldHVybiAkeG1sOwogICAgICAgICAg
ICB9IGVsc2UgeyAvLyBmYWlsZWQgdG8gcmV0cmlldmUgZGF0YSBmcm9tIFR3aXR0ZXIKCiAg
ICAgICAgICAgICAgICBpZiAoJHRoaXMtPl9jYWNoZSkgeyAvLyBhdHRlbXB0IHRvIGZvcmNl
IGNhY2hlZCB4bWwgcmV0dXJuCgogICAgICAgICAgICAgICAgICAgICRkYXRhID0gJHRoaXMt
Pl9yZXRyaWV2ZUNhY2hlKCRhcGlfdXJsLHRydWUpOwogICAgICAgICAgICAgICAgICAgIGlm
ICgkZGF0YSkgcmV0dXJuIEBzaW1wbGV4bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwoKICAgICAg
ICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAg
ICB9CiAgICAgICAgfSBlbHNlIHsgLy8gcmV0dXJuIGNhY2hlZCB4bWwKICAgICAgICAgICAg
cmV0dXJuIEBzaW1wbGV4bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwogICAgICAgIH0KICAgIH0g
Ly9lbmQgZ2V0KCkKCiAgICBmdW5jdGlvbiBwb3N0KCR1cmwsICRwYXJhbXMgPSBhcnJheSgp
KQogICAgewogICAgICAgICRkYXRhID0gcGFyZW50Ojpwb3N0KCR1cmwsJHBhcmFtcyk7CiAg
ICAgICAgcmV0dXJuIHNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSk7CiAgICB9CgogICAg
ZnVuY3Rpb24gZGVsZXRlKCR1cmwsICRwYXJhbXMgPSBhcnJheSgpKQogICAgewogICAgICAg
ICRkYXRhID0gcGFyZW50OjpkZWxldGUoJHVybCwkcGFyYW1zKTsKICAgICAgICByZXR1cm4g
c2ltcGxleG1sX2xvYWRfc3RyaW5nKCRkYXRhKTsKICAgIH0KCiAgICAvLyBDYWNoZSBtZXRo
b2RzCgogICAgcHVibGljIGZ1bmN0aW9uIHNldENhY2hpbmcoJGNhY2hlPXRydWUpCiAgICB7
CiAgICAgICAgJHRoaXMtPl9jYWNoZSA9ICgkY2FjaGUpID8gdHJ1ZSA6IGZhbHNlOwogICAg
ICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjYWNoZURpcigk
bG9jKQogICAgewogICAgICAgICR0aGlzLT5fY2FjaGVfZGlyID0gJGxvYzsKICAgICAgICBy
ZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gY2FjaGVUaW1lKCRtaW5z
KQogICAgewogICAgICAgICR0aGlzLT5fY2FjaGVfdGltZSA9ICRtaW5zKjYwOyAvLyBjb252
ZXJ0IG1pbnV0ZXMgaW50byBzZWNvbmRzCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cgog
ICAgcHJpdmF0ZSBmdW5jdGlvbiBfcmV0cmlldmVDYWNoZSgkdXJsLCRvdmVyaWRlX3RpbWVv
dXQ9ZmFsc2UpCiAgICB7CiAgICAgICAgJGZpbGUgPSAkdGhpcy0+X2NhY2hlX2Rpci4nLycu
JHVybDsKICAgICAgICBpZiAoZmlsZV9leGlzdHMoJGZpbGUpKSB7CgogICAgICAgICAgICAk
ZGlmZiA9IHRpbWUoKSAtIGZpbGVtdGltZSgkZmlsZSk7CiAgICAgICAgICAgIGlmICgkb3Zl
cmlkZV90aW1lb3V0IHx8ICRkaWZmIDwgJHRoaXMtPl9jYWNoZV90aW1lKSB7CiAgICAgICAg
ICAgICAgICByZXR1cm4gZmlsZV9nZXRfY29udGVudHMoJGZpbGUpOwogICAgICAgICAgICB9
IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9Cgog
ICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAg
ICB9Cn0KCi8qCiAqIEFicmFoYW0gV2lsbGlhbXMgKGFicmFoYW1AYWJyYWguYW0pIGh0dHA6
Ly9hYnJhaC5hbQogKgogKiBUaGUgZmlyc3QgUEhQIExpYnJhcnkgdG8gc3VwcG9ydCBPQXV0
aCBmb3IgVHdpdHRlcidzIFJFU1QgQVBJLgogKi8KCi8qKgogKiBUd2l0dGVyIE9BdXRoIGNs
YXNzCiAqLwpjbGFzcyBUd2l0dGVyT0F1dGggewogIC8qIENvbnRhaW5zIHRoZSBsYXN0IEhU
VFAgc3RhdHVzIGNvZGUgcmV0dXJuZWQuICovCiAgcHVibGljICRodHRwX2NvZGU7CiAgLyog
Q29udGFpbnMgdGhlIGxhc3QgQVBJIGNhbGwuICovCiAgcHVibGljICR1cmw7CiAgLyogU2V0
IHVwIHRoZSBBUEkgcm9vdCBVUkwuICovCiAgcHVibGljICRob3N0ID0gImh0dHBzOi8vYXBp
LnR3aXR0ZXIuY29tLzEvIjsKICAvKiBTZXQgdGltZW91dCBkZWZhdWx0LiAqLwogIHB1Ymxp
YyAkdGltZW91dCA9IDMwOwogIC8qIFNldCBjb25uZWN0IHRpbWVvdXQuICovCiAgcHVibGlj
ICRjb25uZWN0dGltZW91dCA9IDMwOwogIC8qIFZlcmlmeSBTU0wgQ2VydC4gKi8KICBwdWJs
aWMgJHNzbF92ZXJpZnlwZWVyID0gRkFMU0U7CiAgLyogUmVzcG9ucyBmb3JtYXQuICovCiAg
cHVibGljICRmb3JtYXQgPSAnanNvbic7CiAgLyogRGVjb2RlIHJldHVybmVkIGpzb24gZGF0
YS4gKi8KICBwdWJsaWMgJGRlY29kZV9qc29uID0gVFJVRTsKICAvKiBDb250YWlucyB0aGUg
bGFzdCBIVFRQIGhlYWRlcnMgcmV0dXJuZWQuICovCiAgcHVibGljICRodHRwX2luZm87CiAg
LyogU2V0IHRoZSB1c2VyYWduZXQuICovCiAgcHVibGljICR1c2VyYWdlbnQgPSAnVHdpdHRl
ck9BdXRoIHYwLjIuMC1iZXRhMic7CiAgLyogSW1tZWRpYXRlbHkgcmV0cnkgdGhlIEFQSSBj
YWxsIGlmIHRoZSByZXNwb25zZSB3YXMgbm90IHN1Y2Nlc3NmdWwuICovCiAgLy9wdWJsaWMg
JHJldHJ5ID0gVFJVRTsKCgoKCiAgLyoqCiAgICogU2V0IEFQSSBVUkxTCiAgICovCiAgZnVu
Y3Rpb24gYWNjZXNzVG9rZW5VUkwoKSAgeyByZXR1cm4gJ2h0dHBzOi8vYXBpLnR3aXR0ZXIu
Y29tL29hdXRoL2FjY2Vzc190b2tlbic7IH0KICBmdW5jdGlvbiBhdXRoZW50aWNhdGVVUkwo
KSB7IHJldHVybiAnaHR0cHM6Ly90d2l0dGVyLmNvbS9vYXV0aC9hdXRoZW50aWNhdGUnOyB9
CiAgZnVuY3Rpb24gYXV0aG9yaXplVVJMKCkgICAgeyByZXR1cm4gJ2h0dHBzOi8vdHdpdHRl
ci5jb20vb2F1dGgvYXV0aG9yaXplJzsgfQogIGZ1bmN0aW9uIHJlcXVlc3RUb2tlblVSTCgp
IHsgcmV0dXJuICdodHRwczovL2FwaS50d2l0dGVyLmNvbS9vYXV0aC9yZXF1ZXN0X3Rva2Vu
JzsgfQoKICAvKioKICAgKiBEZWJ1ZyBoZWxwZXJzCiAgICovCiAgZnVuY3Rpb24gbGFzdFN0
YXR1c0NvZGUoKSB7IHJldHVybiAkdGhpcy0+aHR0cF9zdGF0dXM7IH0KICBmdW5jdGlvbiBs
YXN0QVBJQ2FsbCgpIHsgcmV0dXJuICR0aGlzLT5sYXN0X2FwaV9jYWxsOyB9CgogIC8qKgog
ICAqIGNvbnN0cnVjdCBUd2l0dGVyT0F1dGggb2JqZWN0CiAgICovCiAgZnVuY3Rpb24gX19j
b25zdHJ1Y3QoJGNvbnN1bWVyX2tleSwgJGNvbnN1bWVyX3NlY3JldCwgJG9hdXRoX3Rva2Vu
ID0gTlVMTCwgJG9hdXRoX3Rva2VuX3NlY3JldCA9IE5VTEwpIHsKICAgICR0aGlzLT5zaGEx
X21ldGhvZCA9IG5ldyBPQXV0aFNpZ25hdHVyZU1ldGhvZF9ITUFDX1NIQTEoKTsKICAgICR0
aGlzLT5jb25zdW1lciA9IG5ldyBPQXV0aENvbnN1bWVyKCRjb25zdW1lcl9rZXksICRjb25z
dW1lcl9zZWNyZXQpOwogICAgaWYgKCFlbXB0eSgkb2F1dGhfdG9rZW4pICYmICFlbXB0eSgk
b2F1dGhfdG9rZW5fc2VjcmV0KSkgewogICAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhD
b25zdW1lcigkb2F1dGhfdG9rZW4sICRvYXV0aF90b2tlbl9zZWNyZXQpOwogICAgfSBlbHNl
IHsKICAgICAgJHRoaXMtPnRva2VuID0gTlVMTDsKICAgIH0KICB9CgoKICAvKioKICAgKiBH
ZXQgYSByZXF1ZXN0X3Rva2VuIGZyb20gVHdpdHRlcgogICAqCiAgICogQHJldHVybnMgYSBr
ZXkvdmFsdWUgYXJyYXkgY29udGFpbmluZyBvYXV0aF90b2tlbiBhbmQgb2F1dGhfdG9rZW5f
c2VjcmV0CiAgICovCiAgZnVuY3Rpb24gZ2V0UmVxdWVzdFRva2VuKCRvYXV0aF9jYWxsYmFj
ayA9IE5VTEwpIHsKICAgICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgIGlmICghZW1wdHko
JG9hdXRoX2NhbGxiYWNrKSkgewogICAgICAkcGFyYW1ldGVyc1snb2F1dGhfY2FsbGJhY2sn
XSA9ICRvYXV0aF9jYWxsYmFjazsKICAgIH0KICAgICRyZXF1ZXN0ID0gJHRoaXMtPm9BdXRo
UmVxdWVzdCgkdGhpcy0+cmVxdWVzdFRva2VuVVJMKCksICdHRVQnLCAkcGFyYW1ldGVycyk7
CiAgICAkdG9rZW4gPSBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMoJHJlcXVlc3QpOwog
ICAgJHRoaXMtPnRva2VuID0gbmV3IE9BdXRoQ29uc3VtZXIoJHRva2VuWydvYXV0aF90b2tl
biddLCAkdG9rZW5bJ29hdXRoX3Rva2VuX3NlY3JldCddKTsKICAgIHJldHVybiAkdG9rZW47
CiAgfQoKICAvKioKICAgKiBHZXQgdGhlIGF1dGhvcml6ZSBVUkwKICAgKgogICAqIEByZXR1
cm5zIGEgc3RyaW5nCiAgICovCiAgZnVuY3Rpb24gZ2V0QXV0aG9yaXplVVJMKCR0b2tlbiwg
JHNpZ25faW5fd2l0aF90d2l0dGVyID0gVFJVRSkgewogICAgaWYgKGlzX2FycmF5KCR0b2tl
bikpIHsKICAgICAgJHRva2VuID0gJHRva2VuWydvYXV0aF90b2tlbiddOwogICAgfQogICAg
aWYgKGVtcHR5KCRzaWduX2luX3dpdGhfdHdpdHRlcikpIHsKICAgICAgcmV0dXJuICR0aGlz
LT5hdXRob3JpemVVUkwoKSAuICI/b2F1dGhfdG9rZW49eyR0b2tlbn0iOwogICAgfSBlbHNl
IHsKICAgICAgIHJldHVybiAkdGhpcy0+YXV0aGVudGljYXRlVVJMKCkgLiAiP29hdXRoX3Rv
a2VuPXskdG9rZW59IjsKICAgIH0KICB9CgogIC8qKgogICAqIEV4Y2hhbmdlIHJlcXVlc3Qg
dG9rZW4gYW5kIHNlY3JldCBmb3IgYW4gYWNjZXNzIHRva2VuIGFuZAogICAqIHNlY3JldCwg
dG8gc2lnbiBBUEkgY2FsbHMuCiAgICoKICAgKiBAcmV0dXJucyBhcnJheSgib2F1dGhfdG9r
ZW4iID0+ICJ0aGUtYWNjZXNzLXRva2VuIiwKICAgKiAgICAgICAgICAgICAgICAib2F1dGhf
dG9rZW5fc2VjcmV0IiA9PiAidGhlLWFjY2Vzcy1zZWNyZXQiLAogICAqICAgICAgICAgICAg
ICAgICJ1c2VyX2lkIiA9PiAiOTQzNjk5MiIsCiAgICogICAgICAgICAgICAgICAgInNjcmVl
bl9uYW1lIiA9PiAiYWJyYWhhbSIpCiAgICovCiAgZnVuY3Rpb24gZ2V0QWNjZXNzVG9rZW4o
JG9hdXRoX3ZlcmlmaWVyID0gRkFMU0UpIHsKICAgICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsK
ICAgIGlmICghZW1wdHkoJG9hdXRoX3ZlcmlmaWVyKSkgewogICAgICAkcGFyYW1ldGVyc1sn
b2F1dGhfdmVyaWZpZXInXSA9ICRvYXV0aF92ZXJpZmllcjsKICAgIH0KICAgICRyZXF1ZXN0
ID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdGhpcy0+YWNjZXNzVG9rZW5VUkwoKSwgJ0dFVCcs
ICRwYXJhbWV0ZXJzKTsKICAgICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVy
cygkcmVxdWVzdCk7CiAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigkdG9r
ZW5bJ29hdXRoX3Rva2VuJ10sICR0b2tlblsnb2F1dGhfdG9rZW5fc2VjcmV0J10pOwogICAg
cmV0dXJuICR0b2tlbjsKICB9CgogIC8qKgogICAqIE9uZSB0aW1lIGV4Y2hhbmdlIG9mIHVz
ZXJuYW1lIGFuZCBwYXNzd29yZCBmb3IgYWNjZXNzIHRva2VuIGFuZCBzZWNyZXQuCiAgICoK
ICAgKiBAcmV0dXJucyBhcnJheSgib2F1dGhfdG9rZW4iID0+ICJ0aGUtYWNjZXNzLXRva2Vu
IiwKICAgKiAgICAgICAgICAgICAgICAib2F1dGhfdG9rZW5fc2VjcmV0IiA9PiAidGhlLWFj
Y2Vzcy1zZWNyZXQiLAogICAqICAgICAgICAgICAgICAgICJ1c2VyX2lkIiA9PiAiOTQzNjk5
MiIsCiAgICogICAgICAgICAgICAgICAgInNjcmVlbl9uYW1lIiA9PiAiYWJyYWhhbSIsCiAg
ICogICAgICAgICAgICAgICAgInhfYXV0aF9leHBpcmVzIiA9PiAiMCIpCiAgICovCiAgZnVu
Y3Rpb24gZ2V0WEF1dGhUb2tlbigkdXNlcm5hbWUsICRwYXNzd29yZCkgewogICAgJHBhcmFt
ZXRlcnMgPSBhcnJheSgpOwogICAgJHBhcmFtZXRlcnNbJ3hfYXV0aF91c2VybmFtZSddID0g
JHVzZXJuYW1lOwogICAgJHBhcmFtZXRlcnNbJ3hfYXV0aF9wYXNzd29yZCddID0gJHBhc3N3
b3JkOwogICAgJHBhcmFtZXRlcnNbJ3hfYXV0aF9tb2RlJ10gPSAnY2xpZW50X2F1dGgnOwog
ICAgJHJlcXVlc3QgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR0aGlzLT5hY2Nlc3NUb2tlblVS
TCgpLCAnUE9TVCcsICRwYXJhbWV0ZXJzKTsKICAgICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFy
c2VfcGFyYW1ldGVycygkcmVxdWVzdCk7CiAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhD
b25zdW1lcigkdG9rZW5bJ29hdXRoX3Rva2VuJ10sICR0b2tlblsnb2F1dGhfdG9rZW5fc2Vj
cmV0J10pOwogICAgcmV0dXJuICR0b2tlbjsKICB9CgogIC8qKgogICAqIEdFVCB3cmFwcGVy
IGZvciBvQXV0aFJlcXVlc3QuCiAgICovCiAgZnVuY3Rpb24gZ2V0KCR1cmwsICRwYXJhbWV0
ZXJzID0gYXJyYXkoKSkgewogICAgJHJlc3BvbnNlID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgk
dXJsLCAnR0VUJywgJHBhcmFtZXRlcnMpOwogICAgaWYgKCR0aGlzLT5mb3JtYXQgPT09ICdq
c29uJyAmJiAkdGhpcy0+ZGVjb2RlX2pzb24pIHsKICAgICAgcmV0dXJuIGpzb25fZGVjb2Rl
KCRyZXNwb25zZSk7CiAgICB9CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoqCiAg
ICogUE9TVCB3cmFwcGVyIGZvciBvQXV0aFJlcXVlc3QuCiAgICovCiAgZnVuY3Rpb24gcG9z
dCgkdXJsLCAkcGFyYW1ldGVycyA9IGFycmF5KCkpIHsKICAgICRyZXNwb25zZSA9ICR0aGlz
LT5vQXV0aFJlcXVlc3QoJHVybCwgJ1BPU1QnLCAkcGFyYW1ldGVycyk7CiAgICBpZiAoJHRo
aXMtPmZvcm1hdCA9PT0gJ2pzb24nICYmICR0aGlzLT5kZWNvZGVfanNvbikgewogICAgICBy
ZXR1cm4ganNvbl9kZWNvZGUoJHJlc3BvbnNlKTsKICAgIH0KICAgIHJldHVybiAkcmVzcG9u
c2U7CiAgfQoKICAvKioKICAgKiBERUxFVEUgd3JhcHBlciBmb3Igb0F1dGhSZXFldXN0Lgog
ICAqLwogIGZ1bmN0aW9uIGRlbGV0ZSgkdXJsLCAkcGFyYW1ldGVycyA9IGFycmF5KCkpIHsK
ICAgICRyZXNwb25zZSA9ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHVybCwgJ0RFTEVURScsICRw
YXJhbWV0ZXJzKTsKICAgIGlmICgkdGhpcy0+Zm9ybWF0ID09PSAnanNvbicgJiYgJHRoaXMt
PmRlY29kZV9qc29uKSB7CiAgICAgIHJldHVybiBqc29uX2RlY29kZSgkcmVzcG9uc2UpOwog
ICAgfQogICAgcmV0dXJuICRyZXNwb25zZTsKICB9CgogIC8qKgogICAqIEZvcm1hdCBhbmQg
c2lnbiBhbiBPQXV0aCAvIEFQSSByZXF1ZXN0CiAgICovCiAgZnVuY3Rpb24gb0F1dGhSZXF1
ZXN0KCR1cmwsICRtZXRob2QsICRwYXJhbWV0ZXJzKSB7CiAgICBpZiAoc3RycnBvcygkdXJs
LCAnaHR0cHM6Ly8nKSAhPT0gMCAmJiBzdHJycG9zKCR1cmwsICdodHRwOi8vJykgIT09IDAp
IHsKICAgICAgJHVybCA9ICJ7JHRoaXMtPmhvc3R9eyR1cmx9LnskdGhpcy0+Zm9ybWF0fSI7
CiAgICB9CiAgICAkcmVxdWVzdCA9IE9BdXRoUmVxdWVzdDo6ZnJvbV9jb25zdW1lcl9hbmRf
dG9rZW4oJHRoaXMtPmNvbnN1bWVyLCAkdGhpcy0+dG9rZW4sICRtZXRob2QsICR1cmwsICRw
YXJhbWV0ZXJzKTsKICAgICRyZXF1ZXN0LT5zaWduX3JlcXVlc3QoJHRoaXMtPnNoYTFfbWV0
aG9kLCAkdGhpcy0+Y29uc3VtZXIsICR0aGlzLT50b2tlbik7CiAgICBzd2l0Y2ggKCRtZXRo
b2QpIHsKICAgIGNhc2UgJ0dFVCc6CiAgICAgIHJldHVybiAkdGhpcy0+aHR0cCgkcmVxdWVz
dC0+dG9fdXJsKCksICdHRVQnKTsKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiAkdGhpcy0+
aHR0cCgkcmVxdWVzdC0+Z2V0X25vcm1hbGl6ZWRfaHR0cF91cmwoKSwgJG1ldGhvZCwgJHJl
cXVlc3QtPnRvX3Bvc3RkYXRhKCkpOwogICAgfQogIH0KCiAgLyoqCiAgICogTWFrZSBhbiBI
VFRQIHJlcXVlc3QKICAgKgogICAqIEByZXR1cm4gQVBJIHJlc3VsdHMKICAgKi8KICBmdW5j
dGlvbiBodHRwKCR1cmwsICRtZXRob2QsICRwb3N0ZmllbGRzID0gTlVMTCkgewogICAgJHRo
aXMtPmh0dHBfaW5mbyA9IGFycmF5KCk7CiAgICAkY2kgPSBjdXJsX2luaXQoKTsKICAgIC8q
IEN1cmwgc2V0dGluZ3MgKi8KICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9VU0VSQUdF
TlQsICR0aGlzLT51c2VyYWdlbnQpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0NP
Tk5FQ1RUSU1FT1VULCAkdGhpcy0+Y29ubmVjdHRpbWVvdXQpOwogICAgY3VybF9zZXRvcHQo
JGNpLCBDVVJMT1BUX1RJTUVPVVQsICR0aGlzLT50aW1lb3V0KTsKICAgIGN1cmxfc2V0b3B0
KCRjaSwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgVFJVRSk7CiAgICBjdXJsX3NldG9wdCgk
Y2ksIENVUkxPUFRfSFRUUEhFQURFUiwgYXJyYXkoJ0V4cGVjdDonKSk7CiAgICBjdXJsX3Nl
dG9wdCgkY2ksIENVUkxPUFRfU1NMX1ZFUklGWVBFRVIsICR0aGlzLT5zc2xfdmVyaWZ5cGVl
cik7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfSEVBREVSRlVOQ1RJT04sIGFycmF5
KCR0aGlzLCAnZ2V0SGVhZGVyJykpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0hF
QURFUiwgRkFMU0UpOwoKICAgIHN3aXRjaCAoJG1ldGhvZCkgewogICAgICBjYXNlICdQT1NU
JzoKICAgICAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfUE9TVCwgVFJVRSk7CiAgICAg
ICAgaWYgKCFlbXB0eSgkcG9zdGZpZWxkcykpIHsKICAgICAgICAgIGN1cmxfc2V0b3B0KCRj
aSwgQ1VSTE9QVF9QT1NURklFTERTLCAkcG9zdGZpZWxkcyk7CiAgICAgICAgfQogICAgICAg
IGJyZWFrOwogICAgICBjYXNlICdERUxFVEUnOgogICAgICAgIGN1cmxfc2V0b3B0KCRjaSwg
Q1VSTE9QVF9DVVNUT01SRVFVRVNULCAnREVMRVRFJyk7CiAgICAgICAgaWYgKCFlbXB0eSgk
cG9zdGZpZWxkcykpIHsKICAgICAgICAgICR1cmwgPSAieyR1cmx9P3skcG9zdGZpZWxkc30i
OwogICAgICAgIH0KICAgIH0KCiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfVVJMLCAk
dXJsKTsKICAgICRyZXNwb25zZSA9IGN1cmxfZXhlYygkY2kpOwogICAgJHRoaXMtPmh0dHBf
Y29kZSA9IGN1cmxfZ2V0aW5mbygkY2ksIENVUkxJTkZPX0hUVFBfQ09ERSk7CiAgICAkdGhp
cy0+aHR0cF9pbmZvID0gYXJyYXlfbWVyZ2UoJHRoaXMtPmh0dHBfaW5mbywgY3VybF9nZXRp
bmZvKCRjaSkpOwogICAgJHRoaXMtPnVybCA9ICR1cmw7CiAgICBjdXJsX2Nsb3NlICgkY2kp
OwogICAgcmV0dXJuICRyZXNwb25zZTsKICB9CgogIC8qKgogICAqIEdldCB0aGUgaGVhZGVy
IGluZm8gdG8gc3RvcmUuCiAgICovCiAgZnVuY3Rpb24gZ2V0SGVhZGVyKCRjaCwgJGhlYWRl
cikgewogICAgJGkgPSBzdHJwb3MoJGhlYWRlciwgJzonKTsKICAgIGlmICghZW1wdHkoJGkp
KSB7CiAgICAgICRrZXkgPSBzdHJfcmVwbGFjZSgnLScsICdfJywgc3RydG9sb3dlcihzdWJz
dHIoJGhlYWRlciwgMCwgJGkpKSk7CiAgICAgICR2YWx1ZSA9IHRyaW0oc3Vic3RyKCRoZWFk
ZXIsICRpICsgMikpOwogICAgICAkdGhpcy0+aHR0cF9oZWFkZXJbJGtleV0gPSAkdmFsdWU7
CiAgICB9CiAgICByZXR1cm4gc3RybGVuKCRoZWFkZXIpOwogIH0KfQoKY2xhc3MgT0F1dGhF
eGNlcHRpb24gZXh0ZW5kcyBFeGNlcHRpb24gewogIC8vIHBhc3MKfQoKY2xhc3MgT0F1dGhD
b25zdW1lciB7CiAgcHVibGljICRrZXk7CiAgcHVibGljICRzZWNyZXQ7CgogIGZ1bmN0aW9u
IF9fY29uc3RydWN0KCRrZXksICRzZWNyZXQsICRjYWxsYmFja191cmw9TlVMTCkgewogICAg
JHRoaXMtPmtleSA9ICRrZXk7CiAgICAkdGhpcy0+c2VjcmV0ID0gJHNlY3JldDsKICAgICR0
aGlzLT5jYWxsYmFja191cmwgPSAkY2FsbGJhY2tfdXJsOwogIH0KCiAgZnVuY3Rpb24gX190
b1N0cmluZygpIHsKICAgIHJldHVybiAiT0F1dGhDb25zdW1lcltrZXk9JHRoaXMtPmtleSxz
ZWNyZXQ9JHRoaXMtPnNlY3JldF0iOwogIH0KfQoKY2xhc3MgT0F1dGhUb2tlbiB7CiAgLy8g
YWNjZXNzIHRva2VucyBhbmQgcmVxdWVzdCB0b2tlbnMKICBwdWJsaWMgJGtleTsKICBwdWJs
aWMgJHNlY3JldDsKCiAgLyoqCiAgICoga2V5ID0gdGhlIHRva2VuCiAgICogc2VjcmV0ID0g
dGhlIHRva2VuIHNlY3JldAogICAqLwogIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRrZXksICRz
ZWNyZXQpIHsKICAgICR0aGlzLT5rZXkgPSAka2V5OwogICAgJHRoaXMtPnNlY3JldCA9ICRz
ZWNyZXQ7CiAgfQoKICAvKioKICAgKiBnZW5lcmF0ZXMgdGhlIGJhc2ljIHN0cmluZyBzZXJp
YWxpemF0aW9uIG9mIGEgdG9rZW4gdGhhdCBhIHNlcnZlcgogICAqIHdvdWxkIHJlc3BvbmQg
dG8gcmVxdWVzdF90b2tlbiBhbmQgYWNjZXNzX3Rva2VuIGNhbGxzIHdpdGgKICAgKi8KICBm
dW5jdGlvbiB0b19zdHJpbmcoKSB7CiAgICByZXR1cm4gIm9hdXRoX3Rva2VuPSIgLgogICAg
ICAgICAgIE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJHRoaXMtPmtleSkgLgogICAg
ICAgICAgICImb2F1dGhfdG9rZW5fc2VjcmV0PSIgLgogICAgICAgICAgIE9BdXRoVXRpbDo6
dXJsZW5jb2RlX3JmYzM5ODYoJHRoaXMtPnNlY3JldCk7CiAgfQoKICBmdW5jdGlvbiBfX3Rv
U3RyaW5nKCkgewogICAgcmV0dXJuICR0aGlzLT50b19zdHJpbmcoKTsKICB9Cn0KCi8qKgog
KiBBIGNsYXNzIGZvciBpbXBsZW1lbnRpbmcgYSBTaWduYXR1cmUgTWV0aG9kCiAqIFNlZSBz
ZWN0aW9uIDkgKCJTaWduaW5nIFJlcXVlc3RzIikgaW4gdGhlIHNwZWMKICovCmFic3RyYWN0
IGNsYXNzIE9BdXRoU2lnbmF0dXJlTWV0aG9kIHsKICAvKioKICAgKiBOZWVkcyB0byByZXR1
cm4gdGhlIG5hbWUgb2YgdGhlIFNpZ25hdHVyZSBNZXRob2QgKGllIEhNQUMtU0hBMSkKICAg
KiBAcmV0dXJuIHN0cmluZwogICAqLwogIGFic3RyYWN0IHB1YmxpYyBmdW5jdGlvbiBnZXRf
bmFtZSgpOwoKICAvKioKICAgKiBCdWlsZCB1cCB0aGUgc2lnbmF0dXJlCiAgICogTk9URTog
VGhlIG91dHB1dCBvZiB0aGlzIGZ1bmN0aW9uIE1VU1QgTk9UIGJlIHVybGVuY29kZWQuCiAg
ICogdGhlIGVuY29kaW5nIGlzIGhhbmRsZWQgaW4gT0F1dGhSZXF1ZXN0IHdoZW4gdGhlIGZp
bmFsCiAgICogcmVxdWVzdCBpcyBzZXJpYWxpemVkCiAgICogQHBhcmFtIE9BdXRoUmVxdWVz
dCAkcmVxdWVzdAogICAqIEBwYXJhbSBPQXV0aENvbnN1bWVyICRjb25zdW1lcgogICAqIEBw
YXJhbSBPQXV0aFRva2VuICR0b2tlbgogICAqIEByZXR1cm4gc3RyaW5nCiAgICovCiAgYWJz
dHJhY3QgcHVibGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1
bWVyLCAkdG9rZW4pOwoKICAvKioKICAgKiBWZXJpZmllcyB0aGF0IGEgZ2l2ZW4gc2lnbmF0
dXJlIGlzIGNvcnJlY3QKICAgKiBAcGFyYW0gT0F1dGhSZXF1ZXN0ICRyZXF1ZXN0CiAgICog
QHBhcmFtIE9BdXRoQ29uc3VtZXIgJGNvbnN1bWVyCiAgICogQHBhcmFtIE9BdXRoVG9rZW4g
JHRva2VuCiAgICogQHBhcmFtIHN0cmluZyAkc2lnbmF0dXJlCiAgICogQHJldHVybiBib29s
CiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNv
bnN1bWVyLCAkdG9rZW4sICRzaWduYXR1cmUpIHsKICAgICRidWlsdCA9ICR0aGlzLT5idWls
ZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKTsKICAgIHJldHVybiAk
YnVpbHQgPT0gJHNpZ25hdHVyZTsKICB9Cn0KCi8qKgogKiBUaGUgSE1BQy1TSEExIHNpZ25h
dHVyZSBtZXRob2QgdXNlcyB0aGUgSE1BQy1TSEExIHNpZ25hdHVyZSBhbGdvcml0aG0gYXMg
ZGVmaW5lZCBpbiBbUkZDMjEwNF0KICogd2hlcmUgdGhlIFNpZ25hdHVyZSBCYXNlIFN0cmlu
ZyBpcyB0aGUgdGV4dCBhbmQgdGhlIGtleSBpcyB0aGUgY29uY2F0ZW5hdGVkIHZhbHVlcyAo
ZWFjaCBmaXJzdAogKiBlbmNvZGVkIHBlciBQYXJhbWV0ZXIgRW5jb2RpbmcpIG9mIHRoZSBD
b25zdW1lciBTZWNyZXQgYW5kIFRva2VuIFNlY3JldCwgc2VwYXJhdGVkIGJ5IGFuICcmJwog
KiBjaGFyYWN0ZXIgKEFTQ0lJIGNvZGUgMzgpIGV2ZW4gaWYgZW1wdHkuCiAqICAgLSBDaGFw
dGVyIDkuMiAoIkhNQUMtU0hBMSIpCiAqLwpjbGFzcyBPQXV0aFNpZ25hdHVyZU1ldGhvZF9I
TUFDX1NIQTEgZXh0ZW5kcyBPQXV0aFNpZ25hdHVyZU1ldGhvZCB7CiAgZnVuY3Rpb24gZ2V0
X25hbWUoKSB7CiAgICByZXR1cm4gIkhNQUMtU0hBMSI7CiAgfQoKICBwdWJsaWMgZnVuY3Rp
b24gYnVpbGRfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbikgewogICAg
JGJhc2Vfc3RyaW5nID0gJHJlcXVlc3QtPmdldF9zaWduYXR1cmVfYmFzZV9zdHJpbmcoKTsK
ICAgICRyZXF1ZXN0LT5iYXNlX3N0cmluZyA9ICRiYXNlX3N0cmluZzsKCiAgICAka2V5X3Bh
cnRzID0gYXJyYXkoCiAgICAgICRjb25zdW1lci0+c2VjcmV0LAogICAgICAoJHRva2VuKSA/
ICR0b2tlbi0+c2VjcmV0IDogIiIKICAgICk7CgogICAgJGtleV9wYXJ0cyA9IE9BdXRoVXRp
bDo6dXJsZW5jb2RlX3JmYzM5ODYoJGtleV9wYXJ0cyk7CiAgICAka2V5ID0gaW1wbG9kZSgn
JicsICRrZXlfcGFydHMpOwoKICAgIHJldHVybiBiYXNlNjRfZW5jb2RlKGhhc2hfaG1hYygn
c2hhMScsICRiYXNlX3N0cmluZywgJGtleSwgdHJ1ZSkpOwogIH0KfQoKLyoqCiAqIFRoZSBQ
TEFJTlRFWFQgbWV0aG9kIGRvZXMgbm90IHByb3ZpZGUgYW55IHNlY3VyaXR5IHByb3RlY3Rp
b24gYW5kIFNIT1VMRCBvbmx5IGJlIHVzZWQKICogb3ZlciBhIHNlY3VyZSBjaGFubmVsIHN1
Y2ggYXMgSFRUUFMuIEl0IGRvZXMgbm90IHVzZSB0aGUgU2lnbmF0dXJlIEJhc2UgU3RyaW5n
LgogKiAgIC0gQ2hhcHRlciA5LjQgKCJQTEFJTlRFWFQiKQogKi8KY2xhc3MgT0F1dGhTaWdu
YXR1cmVNZXRob2RfUExBSU5URVhUIGV4dGVuZHMgT0F1dGhTaWduYXR1cmVNZXRob2Qgewog
IHB1YmxpYyBmdW5jdGlvbiBnZXRfbmFtZSgpIHsKICAgIHJldHVybiAiUExBSU5URVhUIjsK
ICB9CgogIC8qKgogICAqIG9hdXRoX3NpZ25hdHVyZSBpcyBzZXQgdG8gdGhlIGNvbmNhdGVu
YXRlZCBlbmNvZGVkIHZhbHVlcyBvZiB0aGUgQ29uc3VtZXIgU2VjcmV0IGFuZAogICAqIFRv
a2VuIFNlY3JldCwgc2VwYXJhdGVkIGJ5IGEgJyYnIGNoYXJhY3RlciAoQVNDSUkgY29kZSAz
OCksIGV2ZW4gaWYgZWl0aGVyIHNlY3JldCBpcwogICAqIGVtcHR5LiBUaGUgcmVzdWx0IE1V
U1QgYmUgZW5jb2RlZCBhZ2Fpbi4KICAgKiAgIC0gQ2hhcHRlciA5LjQuMSAoIkdlbmVyYXRp
bmcgU2lnbmF0dXJlcyIpCiAgICoKICAgKiBQbGVhc2Ugbm90ZSB0aGF0IHRoZSBzZWNvbmQg
ZW5jb2RpbmcgTVVTVCBOT1QgaGFwcGVuIGluIHRoZSBTaWduYXR1cmVNZXRob2QsIGFzCiAg
ICogT0F1dGhSZXF1ZXN0IGhhbmRsZXMgdGhpcyEKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24g
YnVpbGRfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJGtl
eV9wYXJ0cyA9IGFycmF5KAogICAgICAkY29uc3VtZXItPnNlY3JldCwKICAgICAgKCR0b2tl
bikgPyAkdG9rZW4tPnNlY3JldCA6ICIiCiAgICApOwoKICAgICRrZXlfcGFydHMgPSBPQXV0
aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCRrZXlfcGFydHMpOwogICAgJGtleSA9IGltcGxv
ZGUoJyYnLCAka2V5X3BhcnRzKTsKICAgICRyZXF1ZXN0LT5iYXNlX3N0cmluZyA9ICRrZXk7
CgogICAgcmV0dXJuICRrZXk7CiAgfQp9CgovKioKICogVGhlIFJTQS1TSEExIHNpZ25hdHVy
ZSBtZXRob2QgdXNlcyB0aGUgUlNBU1NBLVBLQ1MxLXYxXzUgc2lnbmF0dXJlIGFsZ29yaXRo
bSBhcyBkZWZpbmVkIGluCiAqIFtSRkMzNDQ3XSBzZWN0aW9uIDguMiAobW9yZSBzaW1wbHkg
a25vd24gYXMgUEtDUyMxKSwgdXNpbmcgU0hBLTEgYXMgdGhlIGhhc2ggZnVuY3Rpb24gZm9y
CiAqIEVNU0EtUEtDUzEtdjFfNS4gSXQgaXMgYXNzdW1lZCB0aGF0IHRoZSBDb25zdW1lciBo
YXMgcHJvdmlkZWQgaXRzIFJTQSBwdWJsaWMga2V5IGluIGEKICogdmVyaWZpZWQgd2F5IHRv
IHRoZSBTZXJ2aWNlIFByb3ZpZGVyLCBpbiBhIG1hbm5lciB3aGljaCBpcyBiZXlvbmQgdGhl
IHNjb3BlIG9mIHRoaXMKICogc3BlY2lmaWNhdGlvbi4KICogICAtIENoYXB0ZXIgOS4zICgi
UlNBLVNIQTEiKQogKi8KYWJzdHJhY3QgY2xhc3MgT0F1dGhTaWduYXR1cmVNZXRob2RfUlNB
X1NIQTEgZXh0ZW5kcyBPQXV0aFNpZ25hdHVyZU1ldGhvZCB7CiAgcHVibGljIGZ1bmN0aW9u
IGdldF9uYW1lKCkgewogICAgcmV0dXJuICJSU0EtU0hBMSI7CiAgfQoKICAvLyBVcCB0byB0
aGUgU1AgdG8gaW1wbGVtZW50IHRoaXMgbG9va3VwIG9mIGtleXMuIFBvc3NpYmxlIGlkZWFz
IGFyZToKICAvLyAoMSkgZG8gYSBsb29rdXAgaW4gYSB0YWJsZSBvZiB0cnVzdGVkIGNlcnRz
IGtleWVkIG9mZiBvZiBjb25zdW1lcgogIC8vICgyKSBmZXRjaCB2aWEgaHR0cCB1c2luZyBh
IHVybCBwcm92aWRlZCBieSB0aGUgcmVxdWVzdGVyCiAgLy8gKDMpIHNvbWUgc29ydCBvZiBz
cGVjaWZpYyBkaXNjb3ZlcnkgY29kZSBiYXNlZCBvbiByZXF1ZXN0CiAgLy8KICAvLyBFaXRo
ZXIgd2F5IHNob3VsZCByZXR1cm4gYSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIGNl
cnRpZmljYXRlCiAgcHJvdGVjdGVkIGFic3RyYWN0IGZ1bmN0aW9uIGZldGNoX3B1YmxpY19j
ZXJ0KCYkcmVxdWVzdCk7CgogIC8vIFVwIHRvIHRoZSBTUCB0byBpbXBsZW1lbnQgdGhpcyBs
b29rdXAgb2Yga2V5cy4gUG9zc2libGUgaWRlYXMgYXJlOgogIC8vICgxKSBkbyBhIGxvb2t1
cCBpbiBhIHRhYmxlIG9mIHRydXN0ZWQgY2VydHMga2V5ZWQgb2ZmIG9mIGNvbnN1bWVyCiAg
Ly8KICAvLyBFaXRoZXIgd2F5IHNob3VsZCByZXR1cm4gYSBzdHJpbmcgcmVwcmVzZW50YXRp
b24gb2YgdGhlIGNlcnRpZmljYXRlCiAgcHJvdGVjdGVkIGFic3RyYWN0IGZ1bmN0aW9uIGZl
dGNoX3ByaXZhdGVfY2VydCgmJHJlcXVlc3QpOwoKICBwdWJsaWMgZnVuY3Rpb24gYnVpbGRf
c2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJGJhc2Vfc3Ry
aW5nID0gJHJlcXVlc3QtPmdldF9zaWduYXR1cmVfYmFzZV9zdHJpbmcoKTsKICAgICRyZXF1
ZXN0LT5iYXNlX3N0cmluZyA9ICRiYXNlX3N0cmluZzsKCiAgICAvLyBGZXRjaCB0aGUgcHJp
dmF0ZSBrZXkgY2VydCBiYXNlZCBvbiB0aGUgcmVxdWVzdAogICAgJGNlcnQgPSAkdGhpcy0+
ZmV0Y2hfcHJpdmF0ZV9jZXJ0KCRyZXF1ZXN0KTsKCiAgICAvLyBQdWxsIHRoZSBwcml2YXRl
IGtleSBJRCBmcm9tIHRoZSBjZXJ0aWZpY2F0ZQogICAgJHByaXZhdGVrZXlpZCA9IG9wZW5z
c2xfZ2V0X3ByaXZhdGVrZXkoJGNlcnQpOwoKICAgIC8vIFNpZ24gdXNpbmcgdGhlIGtleQog
ICAgJG9rID0gb3BlbnNzbF9zaWduKCRiYXNlX3N0cmluZywgJHNpZ25hdHVyZSwgJHByaXZh
dGVrZXlpZCk7CgogICAgLy8gUmVsZWFzZSB0aGUga2V5IHJlc291cmNlCiAgICBvcGVuc3Ns
X2ZyZWVfa2V5KCRwcml2YXRla2V5aWQpOwoKICAgIHJldHVybiBiYXNlNjRfZW5jb2RlKCRz
aWduYXR1cmUpOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGNoZWNrX3NpZ25hdHVyZSgkcmVx
dWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4sICRzaWduYXR1cmUpIHsKICAgICRkZWNvZGVkX3Np
ZyA9IGJhc2U2NF9kZWNvZGUoJHNpZ25hdHVyZSk7CgogICAgJGJhc2Vfc3RyaW5nID0gJHJl
cXVlc3QtPmdldF9zaWduYXR1cmVfYmFzZV9zdHJpbmcoKTsKCiAgICAvLyBGZXRjaCB0aGUg
cHVibGljIGtleSBjZXJ0IGJhc2VkIG9uIHRoZSByZXF1ZXN0CiAgICAkY2VydCA9ICR0aGlz
LT5mZXRjaF9wdWJsaWNfY2VydCgkcmVxdWVzdCk7CgogICAgLy8gUHVsbCB0aGUgcHVibGlj
IGtleSBJRCBmcm9tIHRoZSBjZXJ0aWZpY2F0ZQogICAgJHB1YmxpY2tleWlkID0gb3BlbnNz
bF9nZXRfcHVibGlja2V5KCRjZXJ0KTsKCiAgICAvLyBDaGVjayB0aGUgY29tcHV0ZWQgc2ln
bmF0dXJlIGFnYWluc3QgdGhlIG9uZSBwYXNzZWQgaW4gdGhlIHF1ZXJ5CiAgICAkb2sgPSBv
cGVuc3NsX3ZlcmlmeSgkYmFzZV9zdHJpbmcsICRkZWNvZGVkX3NpZywgJHB1YmxpY2tleWlk
KTsKCiAgICAvLyBSZWxlYXNlIHRoZSBrZXkgcmVzb3VyY2UKICAgIG9wZW5zc2xfZnJlZV9r
ZXkoJHB1YmxpY2tleWlkKTsKCiAgICByZXR1cm4gJG9rID09IDE7CiAgfQp9CgpjbGFzcyBP
QXV0aFJlcXVlc3QgewogIHByaXZhdGUgJHBhcmFtZXRlcnM7CiAgcHJpdmF0ZSAkaHR0cF9t
ZXRob2Q7CiAgcHJpdmF0ZSAkaHR0cF91cmw7CiAgLy8gZm9yIGRlYnVnIHB1cnBvc2VzCiAg
cHVibGljICRiYXNlX3N0cmluZzsKICBwdWJsaWMgc3RhdGljICR2ZXJzaW9uID0gJzEuMCc7
CiAgcHVibGljIHN0YXRpYyAkUE9TVF9JTlBVVCA9ICdwaHA6Ly9pbnB1dCc7CgogIGZ1bmN0
aW9uIF9fY29uc3RydWN0KCRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVycz1O
VUxMKSB7CiAgICBAJHBhcmFtZXRlcnMgb3IgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAg
JHBhcmFtZXRlcnMgPSBhcnJheV9tZXJnZSggT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJz
KHBhcnNlX3VybCgkaHR0cF91cmwsIFBIUF9VUkxfUVVFUlkpKSwgJHBhcmFtZXRlcnMpOwog
ICAgJHRoaXMtPnBhcmFtZXRlcnMgPSAkcGFyYW1ldGVyczsKICAgICR0aGlzLT5odHRwX21l
dGhvZCA9ICRodHRwX21ldGhvZDsKICAgICR0aGlzLT5odHRwX3VybCA9ICRodHRwX3VybDsK
ICB9CgoKICAvKioKICAgKiBhdHRlbXB0IHRvIGJ1aWxkIHVwIGEgcmVxdWVzdCBmcm9tIHdo
YXQgd2FzIHBhc3NlZCB0byB0aGUgc2VydmVyCiAgICovCiAgcHVibGljIHN0YXRpYyBmdW5j
dGlvbiBmcm9tX3JlcXVlc3QoJGh0dHBfbWV0aG9kPU5VTEwsICRodHRwX3VybD1OVUxMLCAk
cGFyYW1ldGVycz1OVUxMKSB7CiAgICAkc2NoZW1lID0gKCFpc3NldCgkX1NFUlZFUlsnSFRU
UFMnXSkgfHwgJF9TRVJWRVJbJ0hUVFBTJ10gIT0gIm9uIikKICAgICAgICAgICAgICA/ICdo
dHRwJwogICAgICAgICAgICAgIDogJ2h0dHBzJzsKICAgIEAkaHR0cF91cmwgb3IgJGh0dHBf
dXJsID0gJHNjaGVtZSAuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc6Ly8nIC4g
JF9TRVJWRVJbJ0hUVFBfSE9TVCddIC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
JzonIC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJF9TRVJWRVJbJ1NFUlZFUl9Q
T1JUJ10gLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkX1NFUlZFUlsnUkVRVUVT
VF9VUkknXTsKICAgIEAkaHR0cF9tZXRob2Qgb3IgJGh0dHBfbWV0aG9kID0gJF9TRVJWRVJb
J1JFUVVFU1RfTUVUSE9EJ107CgogICAgLy8gV2Ugd2VyZW4ndCBoYW5kZWQgYW55IHBhcmFt
ZXRlcnMsIHNvIGxldCdzIGZpbmQgdGhlIG9uZXMgcmVsZXZhbnQgdG8KICAgIC8vIHRoaXMg
cmVxdWVzdC4KICAgIC8vIElmIHlvdSBydW4gWE1MLVJQQyBvciBzaW1pbGFyIHlvdSBzaG91
bGQgdXNlIHRoaXMgdG8gcHJvdmlkZSB5b3VyIG93bgogICAgLy8gcGFyc2VkIHBhcmFtZXRl
ci1saXN0CiAgICBpZiAoISRwYXJhbWV0ZXJzKSB7CiAgICAgIC8vIEZpbmQgcmVxdWVzdCBo
ZWFkZXJzCiAgICAgICRyZXF1ZXN0X2hlYWRlcnMgPSBPQXV0aFV0aWw6OmdldF9oZWFkZXJz
KCk7CgogICAgICAvLyBQYXJzZSB0aGUgcXVlcnktc3RyaW5nIHRvIGZpbmQgR0VUIHBhcmFt
ZXRlcnMKICAgICAgJHBhcmFtZXRlcnMgPSBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMo
JF9TRVJWRVJbJ1FVRVJZX1NUUklORyddKTsKCiAgICAgIC8vIEl0J3MgYSBQT1NUIHJlcXVl
c3Qgb2YgdGhlIHByb3BlciBjb250ZW50LXR5cGUsIHNvIHBhcnNlIFBPU1QKICAgICAgLy8g
cGFyYW1ldGVycyBhbmQgYWRkIHRob3NlIG92ZXJyaWRpbmcgYW55IGR1cGxpY2F0ZXMgZnJv
bSBHRVQKICAgICAgaWYgKCRodHRwX21ldGhvZCA9PSAiUE9TVCIKICAgICAgICAgICYmIEBz
dHJzdHIoJHJlcXVlc3RfaGVhZGVyc1siQ29udGVudC1UeXBlIl0sCiAgICAgICAgICAgICAg
ICAgICAgICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKQogICAgICAgICAg
KSB7CiAgICAgICAgJHBvc3RfZGF0YSA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygK
ICAgICAgICAgIGZpbGVfZ2V0X2NvbnRlbnRzKHNlbGY6OiRQT1NUX0lOUFVUKQogICAgICAg
ICk7CiAgICAgICAgJHBhcmFtZXRlcnMgPSBhcnJheV9tZXJnZSgkcGFyYW1ldGVycywgJHBv
c3RfZGF0YSk7CiAgICAgIH0KCiAgICAgIC8vIFdlIGhhdmUgYSBBdXRob3JpemF0aW9uLWhl
YWRlciB3aXRoIE9BdXRoIGRhdGEuIFBhcnNlIHRoZSBoZWFkZXIKICAgICAgLy8gYW5kIGFk
ZCB0aG9zZSBvdmVycmlkaW5nIGFueSBkdXBsaWNhdGVzIGZyb20gR0VUIG9yIFBPU1QKICAg
ICAgaWYgKEBzdWJzdHIoJHJlcXVlc3RfaGVhZGVyc1snQXV0aG9yaXphdGlvbiddLCAwLCA2
KSA9PSAiT0F1dGggIikgewogICAgICAgICRoZWFkZXJfcGFyYW1ldGVycyA9IE9BdXRoVXRp
bDo6c3BsaXRfaGVhZGVyKAogICAgICAgICAgJHJlcXVlc3RfaGVhZGVyc1snQXV0aG9yaXph
dGlvbiddCiAgICAgICAgKTsKICAgICAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCRw
YXJhbWV0ZXJzLCAkaGVhZGVyX3BhcmFtZXRlcnMpOwogICAgICB9CgogICAgfQoKICAgIHJl
dHVybiBuZXcgT0F1dGhSZXF1ZXN0KCRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1l
dGVycyk7CiAgfQoKICAvKioKICAgKiBwcmV0dHkgbXVjaCBhIGhlbHBlciBmdW5jdGlvbiB0
byBzZXQgdXAgdGhlIHJlcXVlc3QKICAgKi8KICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGZy
b21fY29uc3VtZXJfYW5kX3Rva2VuKCRjb25zdW1lciwgJHRva2VuLCAkaHR0cF9tZXRob2Qs
ICRodHRwX3VybCwgJHBhcmFtZXRlcnM9TlVMTCkgewogICAgQCRwYXJhbWV0ZXJzIG9yICRw
YXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgICRkZWZhdWx0cyA9IGFycmF5KCJvYXV0aF92ZXJz
aW9uIiA9PiBPQXV0aFJlcXVlc3Q6OiR2ZXJzaW9uLAogICAgICAgICAgICAgICAgICAgICAg
Im9hdXRoX25vbmNlIiA9PiBPQXV0aFJlcXVlc3Q6OmdlbmVyYXRlX25vbmNlKCksCiAgICAg
ICAgICAgICAgICAgICAgICAib2F1dGhfdGltZXN0YW1wIiA9PiBPQXV0aFJlcXVlc3Q6Omdl
bmVyYXRlX3RpbWVzdGFtcCgpLAogICAgICAgICAgICAgICAgICAgICAgIm9hdXRoX2NvbnN1
bWVyX2tleSIgPT4gJGNvbnN1bWVyLT5rZXkpOwogICAgaWYgKCR0b2tlbikKICAgICAgJGRl
ZmF1bHRzWydvYXV0aF90b2tlbiddID0gJHRva2VuLT5rZXk7CgogICAgJHBhcmFtZXRlcnMg
PSBhcnJheV9tZXJnZSgkZGVmYXVsdHMsICRwYXJhbWV0ZXJzKTsKCiAgICByZXR1cm4gbmV3
IE9BdXRoUmVxdWVzdCgkaHR0cF9tZXRob2QsICRodHRwX3VybCwgJHBhcmFtZXRlcnMpOwog
IH0KCiAgcHVibGljIGZ1bmN0aW9uIHNldF9wYXJhbWV0ZXIoJG5hbWUsICR2YWx1ZSwgJGFs
bG93X2R1cGxpY2F0ZXMgPSB0cnVlKSB7CiAgICBpZiAoJGFsbG93X2R1cGxpY2F0ZXMgJiYg
aXNzZXQoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdKSkgewogICAgICAvLyBXZSBoYXZlIGFs
cmVhZHkgYWRkZWQgcGFyYW1ldGVyKHMpIHdpdGggdGhpcyBuYW1lLCBzbyBhZGQgdG8gdGhl
IGxpc3QKICAgICAgaWYgKGlzX3NjYWxhcigkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pKSB7
CiAgICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3QgZHVwbGljYXRlLCBzbyB0cmFuc2Zvcm0g
c2NhbGFyIChzdHJpbmcpCiAgICAgICAgLy8gaW50byBhbiBhcnJheSBzbyB3ZSBjYW4gYWRk
IHRoZSBkdXBsaWNhdGVzCiAgICAgICAgJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdID0gYXJy
YXkoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdKTsKICAgICAgfQoKICAgICAgJHRoaXMtPnBh
cmFtZXRlcnNbJG5hbWVdW10gPSAkdmFsdWU7CiAgICB9IGVsc2UgewogICAgICAkdGhpcy0+
cGFyYW1ldGVyc1skbmFtZV0gPSAkdmFsdWU7CiAgICB9CiAgfQoKICBwdWJsaWMgZnVuY3Rp
b24gZ2V0X3BhcmFtZXRlcigkbmFtZSkgewogICAgcmV0dXJuIGlzc2V0KCR0aGlzLT5wYXJh
bWV0ZXJzWyRuYW1lXSkgPyAkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0gOiBudWxsOwogIH0K
CiAgcHVibGljIGZ1bmN0aW9uIGdldF9wYXJhbWV0ZXJzKCkgewogICAgcmV0dXJuICR0aGlz
LT5wYXJhbWV0ZXJzOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIHVuc2V0X3BhcmFtZXRlcigk
bmFtZSkgewogICAgdW5zZXQoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdKTsKICB9CgogIC8q
KgogICAqIFRoZSByZXF1ZXN0IHBhcmFtZXRlcnMsIHNvcnRlZCBhbmQgY29uY2F0ZW5hdGVk
IGludG8gYSBub3JtYWxpemVkIHN0cmluZy4KICAgKiBAcmV0dXJuIHN0cmluZwogICAqLwog
IHB1YmxpYyBmdW5jdGlvbiBnZXRfc2lnbmFibGVfcGFyYW1ldGVycygpIHsKICAgIC8vIEdy
YWIgYWxsIHBhcmFtZXRlcnMKICAgICRwYXJhbXMgPSAkdGhpcy0+cGFyYW1ldGVyczsKCiAg
ICAvLyBSZW1vdmUgb2F1dGhfc2lnbmF0dXJlIGlmIHByZXNlbnQKICAgIC8vIFJlZjogU3Bl
YzogOS4xLjEgKCJUaGUgb2F1dGhfc2lnbmF0dXJlIHBhcmFtZXRlciBNVVNUIGJlIGV4Y2x1
ZGVkLiIpCiAgICBpZiAoaXNzZXQoJHBhcmFtc1snb2F1dGhfc2lnbmF0dXJlJ10pKSB7CiAg
ICAgIHVuc2V0KCRwYXJhbXNbJ29hdXRoX3NpZ25hdHVyZSddKTsKICAgIH0KCiAgICByZXR1
cm4gT0F1dGhVdGlsOjpidWlsZF9odHRwX3F1ZXJ5KCRwYXJhbXMpOwogIH0KCiAgLyoqCiAg
ICogUmV0dXJucyB0aGUgYmFzZSBzdHJpbmcgb2YgdGhpcyByZXF1ZXN0CiAgICoKICAgKiBU
aGUgYmFzZSBzdHJpbmcgZGVmaW5lZCBhcyB0aGUgbWV0aG9kLCB0aGUgdXJsCiAgICogYW5k
IHRoZSBwYXJhbWV0ZXJzIChub3JtYWxpemVkKSwgZWFjaCB1cmxlbmNvZGVkCiAgICogYW5k
IHRoZSBjb25jYXRlZCB3aXRoICYuCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGdldF9zaWdu
YXR1cmVfYmFzZV9zdHJpbmcoKSB7CiAgICAkcGFydHMgPSBhcnJheSgKICAgICAgJHRoaXMt
PmdldF9ub3JtYWxpemVkX2h0dHBfbWV0aG9kKCksCiAgICAgICR0aGlzLT5nZXRfbm9ybWFs
aXplZF9odHRwX3VybCgpLAogICAgICAkdGhpcy0+Z2V0X3NpZ25hYmxlX3BhcmFtZXRlcnMo
KQogICAgKTsKCiAgICAkcGFydHMgPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCRw
YXJ0cyk7CgogICAgcmV0dXJuIGltcGxvZGUoJyYnLCAkcGFydHMpOwogIH0KCiAgLyoqCiAg
ICoganVzdCB1cHBlcmNhc2VzIHRoZSBodHRwIG1ldGhvZAogICAqLwogIHB1YmxpYyBmdW5j
dGlvbiBnZXRfbm9ybWFsaXplZF9odHRwX21ldGhvZCgpIHsKICAgIHJldHVybiBzdHJ0b3Vw
cGVyKCR0aGlzLT5odHRwX21ldGhvZCk7CiAgfQoKICAvKioKICAgKiBwYXJzZXMgdGhlIHVy
bCBhbmQgcmVidWlsZHMgaXQgdG8gYmUKICAgKiBzY2hlbWU6Ly9ob3N0L3BhdGgKICAgKi8K
ICBwdWJsaWMgZnVuY3Rpb24gZ2V0X25vcm1hbGl6ZWRfaHR0cF91cmwoKSB7CiAgICAkcGFy
dHMgPSBwYXJzZV91cmwoJHRoaXMtPmh0dHBfdXJsKTsKCiAgICAkcG9ydCA9IEAkcGFydHNb
J3BvcnQnXTsKICAgICRzY2hlbWUgPSAkcGFydHNbJ3NjaGVtZSddOwogICAgJGhvc3QgPSAk
cGFydHNbJ2hvc3QnXTsKICAgICRwYXRoID0gQCRwYXJ0c1sncGF0aCddOwoKICAgICRwb3J0
IG9yICRwb3J0ID0gKCRzY2hlbWUgPT0gJ2h0dHBzJykgPyAnNDQzJyA6ICc4MCc7CgogICAg
aWYgKCgkc2NoZW1lID09ICdodHRwcycgJiYgJHBvcnQgIT0gJzQ0MycpCiAgICAgICAgfHwg
KCRzY2hlbWUgPT0gJ2h0dHAnICYmICRwb3J0ICE9ICc4MCcpKSB7CiAgICAgICRob3N0ID0g
IiRob3N0OiRwb3J0IjsKICAgIH0KICAgIHJldHVybiAiJHNjaGVtZTovLyRob3N0JHBhdGgi
OwogIH0KCiAgLyoqCiAgICogYnVpbGRzIGEgdXJsIHVzYWJsZSBmb3IgYSBHRVQgcmVxdWVz
dAogICAqLwogIHB1YmxpYyBmdW5jdGlvbiB0b191cmwoKSB7CiAgICAkcG9zdF9kYXRhID0g
JHRoaXMtPnRvX3Bvc3RkYXRhKCk7CiAgICAkb3V0ID0gJHRoaXMtPmdldF9ub3JtYWxpemVk
X2h0dHBfdXJsKCk7CiAgICBpZiAoJHBvc3RfZGF0YSkgewogICAgICAkb3V0IC49ICc/Jy4k
cG9zdF9kYXRhOwogICAgfQogICAgcmV0dXJuICRvdXQ7CiAgfQoKICAvKioKICAgKiBidWls
ZHMgdGhlIGRhdGEgb25lIHdvdWxkIHNlbmQgaW4gYSBQT1NUIHJlcXVlc3QKICAgKi8KICBw
dWJsaWMgZnVuY3Rpb24gdG9fcG9zdGRhdGEoKSB7CiAgICByZXR1cm4gT0F1dGhVdGlsOjpi
dWlsZF9odHRwX3F1ZXJ5KCR0aGlzLT5wYXJhbWV0ZXJzKTsKICB9CgogIC8qKgogICAqIGJ1
aWxkcyB0aGUgQXV0aG9yaXphdGlvbjogaGVhZGVyCiAgICovCiAgcHVibGljIGZ1bmN0aW9u
IHRvX2hlYWRlcigkcmVhbG09bnVsbCkgewogICAgJGZpcnN0ID0gdHJ1ZTsKICBpZigkcmVh
bG0pIHsKICAgICAgJG91dCA9ICdBdXRob3JpemF0aW9uOiBPQXV0aCByZWFsbT0iJyAuIE9B
dXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJHJlYWxtKSAuICciJzsKICAgICAgJGZpcnN0
ID0gZmFsc2U7CiAgICB9IGVsc2UKICAgICAgJG91dCA9ICdBdXRob3JpemF0aW9uOiBPQXV0
aCc7CgogICAgJHRvdGFsID0gYXJyYXkoKTsKICAgIGZvcmVhY2ggKCR0aGlzLT5wYXJhbWV0
ZXJzIGFzICRrID0+ICR2KSB7CiAgICAgIGlmIChzdWJzdHIoJGssIDAsIDUpICE9ICJvYXV0
aCIpIGNvbnRpbnVlOwogICAgICBpZiAoaXNfYXJyYXkoJHYpKSB7CiAgICAgICAgdGhyb3cg
bmV3IE9BdXRoRXhjZXB0aW9uKCdBcnJheXMgbm90IHN1cHBvcnRlZCBpbiBoZWFkZXJzJyk7
CiAgICAgIH0KICAgICAgJG91dCAuPSAoJGZpcnN0KSA/ICcgJyA6ICcsJzsKICAgICAgJG91
dCAuPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCRrKSAuCiAgICAgICAgICAgICAg
Jz0iJyAuCiAgICAgICAgICAgICAgT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4Nigkdikg
LgogICAgICAgICAgICAgICciJzsKICAgICAgJGZpcnN0ID0gZmFsc2U7CiAgICB9CiAgICBy
ZXR1cm4gJG91dDsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBfX3RvU3RyaW5nKCkgewogICAg
cmV0dXJuICR0aGlzLT50b191cmwoKTsKICB9CgoKICBwdWJsaWMgZnVuY3Rpb24gc2lnbl9y
ZXF1ZXN0KCRzaWduYXR1cmVfbWV0aG9kLCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJHRo
aXMtPnNldF9wYXJhbWV0ZXIoCiAgICAgICJvYXV0aF9zaWduYXR1cmVfbWV0aG9kIiwKICAg
ICAgJHNpZ25hdHVyZV9tZXRob2QtPmdldF9uYW1lKCksCiAgICAgIGZhbHNlCiAgICApOwog
ICAgJHNpZ25hdHVyZSA9ICR0aGlzLT5idWlsZF9zaWduYXR1cmUoJHNpZ25hdHVyZV9tZXRo
b2QsICRjb25zdW1lciwgJHRva2VuKTsKICAgICR0aGlzLT5zZXRfcGFyYW1ldGVyKCJvYXV0
aF9zaWduYXR1cmUiLCAkc2lnbmF0dXJlLCBmYWxzZSk7CiAgfQoKICBwdWJsaWMgZnVuY3Rp
b24gYnVpbGRfc2lnbmF0dXJlKCRzaWduYXR1cmVfbWV0aG9kLCAkY29uc3VtZXIsICR0b2tl
bikgewogICAgJHNpZ25hdHVyZSA9ICRzaWduYXR1cmVfbWV0aG9kLT5idWlsZF9zaWduYXR1
cmUoJHRoaXMsICRjb25zdW1lciwgJHRva2VuKTsKICAgIHJldHVybiAkc2lnbmF0dXJlOwog
IH0KCiAgLyoqCiAgICogdXRpbCBmdW5jdGlvbjogY3VycmVudCB0aW1lc3RhbXAKICAgKi8K
ICBwcml2YXRlIHN0YXRpYyBmdW5jdGlvbiBnZW5lcmF0ZV90aW1lc3RhbXAoKSB7CiAgICBy
ZXR1cm4gdGltZSgpOwogIH0KCiAgLyoqCiAgICogdXRpbCBmdW5jdGlvbjogY3VycmVudCBu
b25jZQogICAqLwogIHByaXZhdGUgc3RhdGljIGZ1bmN0aW9uIGdlbmVyYXRlX25vbmNlKCkg
ewogICAgJG10ID0gbWljcm90aW1lKCk7CiAgICAkcmFuZCA9IG10X3JhbmQoKTsKCiAgICBy
ZXR1cm4gbWQ1KCRtdCAuICRyYW5kKTsgLy8gbWQ1cyBsb29rIG5pY2VyIHRoYW4gbnVtYmVy
cwogIH0KfQoKY2xhc3MgT0F1dGhTZXJ2ZXIgewogIHByb3RlY3RlZCAkdGltZXN0YW1wX3Ro
cmVzaG9sZCA9IDMwMDsgLy8gaW4gc2Vjb25kcywgZml2ZSBtaW51dGVzCiAgcHJvdGVjdGVk
ICR2ZXJzaW9uID0gJzEuMCc7ICAgICAgICAgICAgIC8vIGhpIGJsYWluZQogIHByb3RlY3Rl
ZCAkc2lnbmF0dXJlX21ldGhvZHMgPSBhcnJheSgpOwoKICBwcm90ZWN0ZWQgJGRhdGFfc3Rv
cmU7CgogIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRkYXRhX3N0b3JlKSB7CiAgICAkdGhpcy0+
ZGF0YV9zdG9yZSA9ICRkYXRhX3N0b3JlOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGFkZF9z
aWduYXR1cmVfbWV0aG9kKCRzaWduYXR1cmVfbWV0aG9kKSB7CiAgICAkdGhpcy0+c2lnbmF0
dXJlX21ldGhvZHNbJHNpZ25hdHVyZV9tZXRob2QtPmdldF9uYW1lKCldID0KICAgICAgJHNp
Z25hdHVyZV9tZXRob2Q7CiAgfQoKICAvLyBoaWdoIGxldmVsIGZ1bmN0aW9ucwoKICAvKioK
ICAgKiBwcm9jZXNzIGEgcmVxdWVzdF90b2tlbiByZXF1ZXN0CiAgICogcmV0dXJucyB0aGUg
cmVxdWVzdCB0b2tlbiBvbiBzdWNjZXNzCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGZldGNo
X3JlcXVlc3RfdG9rZW4oJiRyZXF1ZXN0KSB7CiAgICAkdGhpcy0+Z2V0X3ZlcnNpb24oJHJl
cXVlc3QpOwoKICAgICRjb25zdW1lciA9ICR0aGlzLT5nZXRfY29uc3VtZXIoJHJlcXVlc3Qp
OwoKICAgIC8vIG5vIHRva2VuIHJlcXVpcmVkIGZvciB0aGUgaW5pdGlhbCB0b2tlbiByZXF1
ZXN0CiAgICAkdG9rZW4gPSBOVUxMOwoKICAgICR0aGlzLT5jaGVja19zaWduYXR1cmUoJHJl
cXVlc3QsICRjb25zdW1lciwgJHRva2VuKTsKCiAgICAvLyBSZXYgQSBjaGFuZ2UKICAgICRj
YWxsYmFjayA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF9jYWxsYmFjaycpOwog
ICAgJG5ld190b2tlbiA9ICR0aGlzLT5kYXRhX3N0b3JlLT5uZXdfcmVxdWVzdF90b2tlbigk
Y29uc3VtZXIsICRjYWxsYmFjayk7CgogICAgcmV0dXJuICRuZXdfdG9rZW47CiAgfQoKICAv
KioKICAgKiBwcm9jZXNzIGFuIGFjY2Vzc190b2tlbiByZXF1ZXN0CiAgICogcmV0dXJucyB0
aGUgYWNjZXNzIHRva2VuIG9uIHN1Y2Nlc3MKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gZmV0
Y2hfYWNjZXNzX3Rva2VuKCYkcmVxdWVzdCkgewogICAgJHRoaXMtPmdldF92ZXJzaW9uKCRy
ZXF1ZXN0KTsKCiAgICAkY29uc3VtZXIgPSAkdGhpcy0+Z2V0X2NvbnN1bWVyKCRyZXF1ZXN0
KTsKCiAgICAvLyByZXF1aXJlcyBhdXRob3JpemVkIHJlcXVlc3QgdG9rZW4KICAgICR0b2tl
biA9ICR0aGlzLT5nZXRfdG9rZW4oJHJlcXVlc3QsICRjb25zdW1lciwgInJlcXVlc3QiKTsK
CiAgICAkdGhpcy0+Y2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tl
bik7CgogICAgLy8gUmV2IEEgY2hhbmdlCiAgICAkdmVyaWZpZXIgPSAkcmVxdWVzdC0+Z2V0
X3BhcmFtZXRlcignb2F1dGhfdmVyaWZpZXInKTsKICAgICRuZXdfdG9rZW4gPSAkdGhpcy0+
ZGF0YV9zdG9yZS0+bmV3X2FjY2Vzc190b2tlbigkdG9rZW4sICRjb25zdW1lciwgJHZlcmlm
aWVyKTsKCiAgICByZXR1cm4gJG5ld190b2tlbjsKICB9CgogIC8qKgogICAqIHZlcmlmeSBh
biBhcGkgY2FsbCwgY2hlY2tzIGFsbCB0aGUgcGFyYW1ldGVycwogICAqLwogIHB1YmxpYyBm
dW5jdGlvbiB2ZXJpZnlfcmVxdWVzdCgmJHJlcXVlc3QpIHsKICAgICR0aGlzLT5nZXRfdmVy
c2lvbigkcmVxdWVzdCk7CiAgICAkY29uc3VtZXIgPSAkdGhpcy0+Z2V0X2NvbnN1bWVyKCRy
ZXF1ZXN0KTsKICAgICR0b2tlbiA9ICR0aGlzLT5nZXRfdG9rZW4oJHJlcXVlc3QsICRjb25z
dW1lciwgImFjY2VzcyIpOwogICAgJHRoaXMtPmNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwg
JGNvbnN1bWVyLCAkdG9rZW4pOwogICAgcmV0dXJuIGFycmF5KCRjb25zdW1lciwgJHRva2Vu
KTsKICB9CgogIC8vIEludGVybmFscyBmcm9tIGhlcmUKICAvKioKICAgKiB2ZXJzaW9uIDEK
ICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGdldF92ZXJzaW9uKCYkcmVxdWVzdCkgewogICAg
JHZlcnNpb24gPSAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcigib2F1dGhfdmVyc2lvbiIpOwog
ICAgaWYgKCEkdmVyc2lvbikgewogICAgICAvLyBTZXJ2aWNlIFByb3ZpZGVycyBNVVNUIGFz
c3VtZSB0aGUgcHJvdG9jb2wgdmVyc2lvbiB0byBiZSAxLjAgaWYgdGhpcyBwYXJhbWV0ZXIg
aXMgbm90IHByZXNlbnQuCiAgICAgIC8vIENoYXB0ZXIgNy4wICgiQWNjZXNzaW5nIFByb3Rl
Y3RlZCBSZXNzb3VyY2VzIikKICAgICAgJHZlcnNpb24gPSAnMS4wJzsKICAgIH0KICAgIGlm
ICgkdmVyc2lvbiAhPT0gJHRoaXMtPnZlcnNpb24pIHsKICAgICAgdGhyb3cgbmV3IE9BdXRo
RXhjZXB0aW9uKCJPQXV0aCB2ZXJzaW9uICckdmVyc2lvbicgbm90IHN1cHBvcnRlZCIpOwog
ICAgfQogICAgcmV0dXJuICR2ZXJzaW9uOwogIH0KCiAgLyoqCiAgICogZmlndXJlIG91dCB0
aGUgc2lnbmF0dXJlIHdpdGggc29tZSBkZWZhdWx0cwogICAqLwogIHByaXZhdGUgZnVuY3Rp
b24gZ2V0X3NpZ25hdHVyZV9tZXRob2QoJiRyZXF1ZXN0KSB7CiAgICAkc2lnbmF0dXJlX21l
dGhvZCA9CiAgICAgICAgQCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCJvYXV0aF9zaWduYXR1
cmVfbWV0aG9kIik7CgogICAgaWYgKCEkc2lnbmF0dXJlX21ldGhvZCkgewogICAgICAvLyBB
Y2NvcmRpbmcgdG8gY2hhcHRlciA3ICgiQWNjZXNzaW5nIFByb3RlY3RlZCBSZXNzb3VyY2Vz
IikgdGhlIHNpZ25hdHVyZS1tZXRob2QKICAgICAgLy8gcGFyYW1ldGVyIGlzIHJlcXVpcmVk
LCBhbmQgd2UgY2FuJ3QganVzdCBmYWxsYmFjayB0byBQTEFJTlRFWFQKICAgICAgdGhyb3cg
bmV3IE9BdXRoRXhjZXB0aW9uKCdObyBzaWduYXR1cmUgbWV0aG9kIHBhcmFtZXRlci4gVGhp
cyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQnKTsKICAgIH0KCiAgICBpZiAoIWluX2FycmF5KCRz
aWduYXR1cmVfbWV0aG9kLAogICAgICAgICAgICAgICAgICBhcnJheV9rZXlzKCR0aGlzLT5z
aWduYXR1cmVfbWV0aG9kcykpKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigK
ICAgICAgICAiU2lnbmF0dXJlIG1ldGhvZCAnJHNpZ25hdHVyZV9tZXRob2QnIG5vdCBzdXBw
b3J0ZWQgIiAuCiAgICAgICAgInRyeSBvbmUgb2YgdGhlIGZvbGxvd2luZzogIiAuCiAgICAg
ICAgaW1wbG9kZSgiLCAiLCBhcnJheV9rZXlzKCR0aGlzLT5zaWduYXR1cmVfbWV0aG9kcykp
CiAgICAgICk7CiAgICB9CiAgICByZXR1cm4gJHRoaXMtPnNpZ25hdHVyZV9tZXRob2RzWyRz
aWduYXR1cmVfbWV0aG9kXTsKICB9CgogIC8qKgogICAqIHRyeSB0byBmaW5kIHRoZSBjb25z
dW1lciBmb3IgdGhlIHByb3ZpZGVkIHJlcXVlc3QncyBjb25zdW1lciBrZXkKICAgKi8KICBw
cml2YXRlIGZ1bmN0aW9uIGdldF9jb25zdW1lcigmJHJlcXVlc3QpIHsKICAgICRjb25zdW1l
cl9rZXkgPSBAJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoIm9hdXRoX2NvbnN1bWVyX2tleSIp
OwogICAgaWYgKCEkY29uc3VtZXJfa2V5KSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2Vw
dGlvbigiSW52YWxpZCBjb25zdW1lciBrZXkiKTsKICAgIH0KCiAgICAkY29uc3VtZXIgPSAk
dGhpcy0+ZGF0YV9zdG9yZS0+bG9va3VwX2NvbnN1bWVyKCRjb25zdW1lcl9rZXkpOwogICAg
aWYgKCEkY29uc3VtZXIpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJbnZh
bGlkIGNvbnN1bWVyIik7CiAgICB9CgogICAgcmV0dXJuICRjb25zdW1lcjsKICB9CgogIC8q
KgogICAqIHRyeSB0byBmaW5kIHRoZSB0b2tlbiBmb3IgdGhlIHByb3ZpZGVkIHJlcXVlc3Qn
cyB0b2tlbiBrZXkKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGdldF90b2tlbigmJHJlcXVl
c3QsICRjb25zdW1lciwgJHRva2VuX3R5cGU9ImFjY2VzcyIpIHsKICAgICR0b2tlbl9maWVs
ZCA9IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfdG9rZW4nKTsKICAgICR0b2tl
biA9ICR0aGlzLT5kYXRhX3N0b3JlLT5sb29rdXBfdG9rZW4oCiAgICAgICRjb25zdW1lciwg
JHRva2VuX3R5cGUsICR0b2tlbl9maWVsZAogICAgKTsKICAgIGlmICghJHRva2VuKSB7CiAg
ICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiSW52YWxpZCAkdG9rZW5fdHlwZSB0b2tl
bjogJHRva2VuX2ZpZWxkIik7CiAgICB9CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAgLyoq
CiAgICogYWxsLWluLW9uZSBmdW5jdGlvbiB0byBjaGVjayB0aGUgc2lnbmF0dXJlIG9uIGEg
cmVxdWVzdAogICAqIHNob3VsZCBndWVzcyB0aGUgc2lnbmF0dXJlIG1ldGhvZCBhcHByb3By
aWF0ZWx5CiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBjaGVja19zaWduYXR1cmUoJiRyZXF1
ZXN0LCAkY29uc3VtZXIsICR0b2tlbikgewogICAgLy8gdGhpcyBzaG91bGQgcHJvYmFibHkg
YmUgaW4gYSBkaWZmZXJlbnQgbWV0aG9kCiAgICAkdGltZXN0YW1wID0gQCRyZXF1ZXN0LT5n
ZXRfcGFyYW1ldGVyKCdvYXV0aF90aW1lc3RhbXAnKTsKICAgICRub25jZSA9IEAkcmVxdWVz
dC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfbm9uY2UnKTsKCiAgICAkdGhpcy0+Y2hlY2tfdGlt
ZXN0YW1wKCR0aW1lc3RhbXApOwogICAgJHRoaXMtPmNoZWNrX25vbmNlKCRjb25zdW1lciwg
JHRva2VuLCAkbm9uY2UsICR0aW1lc3RhbXApOwoKICAgICRzaWduYXR1cmVfbWV0aG9kID0g
JHRoaXMtPmdldF9zaWduYXR1cmVfbWV0aG9kKCRyZXF1ZXN0KTsKCiAgICAkc2lnbmF0dXJl
ID0gJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX3NpZ25hdHVyZScpOwogICAgJHZh
bGlkX3NpZyA9ICRzaWduYXR1cmVfbWV0aG9kLT5jaGVja19zaWduYXR1cmUoCiAgICAgICRy
ZXF1ZXN0LAogICAgICAkY29uc3VtZXIsCiAgICAgICR0b2tlbiwKICAgICAgJHNpZ25hdHVy
ZQogICAgKTsKCiAgICBpZiAoISR2YWxpZF9zaWcpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRo
RXhjZXB0aW9uKCJJbnZhbGlkIHNpZ25hdHVyZSIpOwogICAgfQogIH0KCiAgLyoqCiAgICog
Y2hlY2sgdGhhdCB0aGUgdGltZXN0YW1wIGlzIG5ldyBlbm91Z2gKICAgKi8KICBwcml2YXRl
IGZ1bmN0aW9uIGNoZWNrX3RpbWVzdGFtcCgkdGltZXN0YW1wKSB7CiAgICBpZiggISAkdGlt
ZXN0YW1wICkKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKAogICAgICAgICdNaXNz
aW5nIHRpbWVzdGFtcCBwYXJhbWV0ZXIuIFRoZSBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQnCiAg
ICAgICk7CgogICAgLy8gdmVyaWZ5IHRoYXQgdGltZXN0YW1wIGlzIHJlY2VudGlzaAogICAg
JG5vdyA9IHRpbWUoKTsKICAgIGlmIChhYnMoJG5vdyAtICR0aW1lc3RhbXApID4gJHRoaXMt
PnRpbWVzdGFtcF90aHJlc2hvbGQpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9u
KAogICAgICAgICJFeHBpcmVkIHRpbWVzdGFtcCwgeW91cnMgJHRpbWVzdGFtcCwgb3VycyAk
bm93IgogICAgICApOwogICAgfQogIH0KCiAgLyoqCiAgICogY2hlY2sgdGhhdCB0aGUgbm9u
Y2UgaXMgbm90IHJlcGVhdGVkCiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBjaGVja19ub25j
ZSgkY29uc3VtZXIsICR0b2tlbiwgJG5vbmNlLCAkdGltZXN0YW1wKSB7CiAgICBpZiggISAk
bm9uY2UgKQogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAgICAgJ01pc3Np
bmcgbm9uY2UgcGFyYW1ldGVyLiBUaGUgcGFyYW1ldGVyIGlzIHJlcXVpcmVkJwogICAgICAp
OwoKICAgIC8vIHZlcmlmeSB0aGF0IHRoZSBub25jZSBpcyB1bmlxdWVpc2gKICAgICRmb3Vu
ZCA9ICR0aGlzLT5kYXRhX3N0b3JlLT5sb29rdXBfbm9uY2UoCiAgICAgICRjb25zdW1lciwK
ICAgICAgJHRva2VuLAogICAgICAkbm9uY2UsCiAgICAgICR0aW1lc3RhbXAKICAgICk7CiAg
ICBpZiAoJGZvdW5kKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiTm9uY2Ug
YWxyZWFkeSB1c2VkOiAkbm9uY2UiKTsKICAgIH0KICB9Cgp9CgpjbGFzcyBPQXV0aERhdGFT
dG9yZSB7CiAgZnVuY3Rpb24gbG9va3VwX2NvbnN1bWVyKCRjb25zdW1lcl9rZXkpIHsKICAg
IC8vIGltcGxlbWVudCBtZQogIH0KCiAgZnVuY3Rpb24gbG9va3VwX3Rva2VuKCRjb25zdW1l
ciwgJHRva2VuX3R5cGUsICR0b2tlbikgewogICAgLy8gaW1wbGVtZW50IG1lCiAgfQoKICBm
dW5jdGlvbiBsb29rdXBfbm9uY2UoJGNvbnN1bWVyLCAkdG9rZW4sICRub25jZSwgJHRpbWVz
dGFtcCkgewogICAgLy8gaW1wbGVtZW50IG1lCiAgfQoKICBmdW5jdGlvbiBuZXdfcmVxdWVz
dF90b2tlbigkY29uc3VtZXIsICRjYWxsYmFjayA9IG51bGwpIHsKICAgIC8vIHJldHVybiBh
IG5ldyB0b2tlbiBhdHRhY2hlZCB0byB0aGlzIGNvbnN1bWVyCiAgfQoKICBmdW5jdGlvbiBu
ZXdfYWNjZXNzX3Rva2VuKCR0b2tlbiwgJGNvbnN1bWVyLCAkdmVyaWZpZXIgPSBudWxsKSB7
CiAgICAvLyByZXR1cm4gYSBuZXcgYWNjZXNzIHRva2VuIGF0dGFjaGVkIHRvIHRoaXMgY29u
c3VtZXIKICAgIC8vIGZvciB0aGUgdXNlciBhc3NvY2lhdGVkIHdpdGggdGhpcyB0b2tlbiBp
ZiB0aGUgcmVxdWVzdCB0b2tlbgogICAgLy8gaXMgYXV0aG9yaXplZAogICAgLy8gc2hvdWxk
IGFsc28gaW52YWxpZGF0ZSB0aGUgcmVxdWVzdCB0b2tlbgogIH0KCn0KCmNsYXNzIE9BdXRo
VXRpbCB7CiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiB1cmxlbmNvZGVfcmZjMzk4NigkaW5w
dXQpIHsKICBpZiAoaXNfYXJyYXkoJGlucHV0KSkgewogICAgcmV0dXJuIGFycmF5X21hcChh
cnJheSgnT0F1dGhVdGlsJywgJ3VybGVuY29kZV9yZmMzOTg2JyksICRpbnB1dCk7CiAgfSBl
bHNlIGlmIChpc19zY2FsYXIoJGlucHV0KSkgewogICAgcmV0dXJuIHN0cl9yZXBsYWNlKAog
ICAgICAnKycsCiAgICAgICcgJywKICAgICAgc3RyX3JlcGxhY2UoJyU3RScsICd+JywgcmF3
dXJsZW5jb2RlKCRpbnB1dCkpCiAgICApOwogIH0gZWxzZSB7CiAgICByZXR1cm4gJyc7CiAg
fQp9CgoKICAvLyBUaGlzIGRlY29kZSBmdW5jdGlvbiBpc24ndCB0YWtpbmcgaW50byBjb25z
aWRlcmF0aW9uIHRoZSBhYm92ZQogIC8vIG1vZGlmaWNhdGlvbnMgdG8gdGhlIGVuY29kaW5n
IHByb2Nlc3MuIEhvd2V2ZXIsIHRoaXMgbWV0aG9kIGRvZXNuJ3QKICAvLyBzZWVtIHRvIGJl
IHVzZWQgYW55d2hlcmUgc28gbGVhdmluZyBpdCBhcyBpcy4KICBwdWJsaWMgc3RhdGljIGZ1
bmN0aW9uIHVybGRlY29kZV9yZmMzOTg2KCRzdHJpbmcpIHsKICAgIHJldHVybiB1cmxkZWNv
ZGUoJHN0cmluZyk7CiAgfQoKICAvLyBVdGlsaXR5IGZ1bmN0aW9uIGZvciB0dXJuaW5nIHRo
ZSBBdXRob3JpemF0aW9uOiBoZWFkZXIgaW50bwogIC8vIHBhcmFtZXRlcnMsIGhhcyB0byBk
byBzb21lIHVuZXNjYXBpbmcKICAvLyBDYW4gZmlsdGVyIG91dCBhbnkgbm9uLW9hdXRoIHBh
cmFtZXRlcnMgaWYgbmVlZGVkIChkZWZhdWx0IGJlaGF2aW91cikKICBwdWJsaWMgc3RhdGlj
IGZ1bmN0aW9uIHNwbGl0X2hlYWRlcigkaGVhZGVyLCAkb25seV9hbGxvd19vYXV0aF9wYXJh
bWV0ZXJzID0gdHJ1ZSkgewogICAgJHBhdHRlcm4gPSAnLygoWy1fYS16XSopPSgiKFteIl0q
KSJ8KFteLF0qKSksPykvJzsKICAgICRvZmZzZXQgPSAwOwogICAgJHBhcmFtcyA9IGFycmF5
KCk7CiAgICB3aGlsZSAocHJlZ19tYXRjaCgkcGF0dGVybiwgJGhlYWRlciwgJG1hdGNoZXMs
IFBSRUdfT0ZGU0VUX0NBUFRVUkUsICRvZmZzZXQpID4gMCkgewogICAgICAkbWF0Y2ggPSAk
bWF0Y2hlc1swXTsKICAgICAgJGhlYWRlcl9uYW1lID0gJG1hdGNoZXNbMl1bMF07CiAgICAg
ICRoZWFkZXJfY29udGVudCA9IChpc3NldCgkbWF0Y2hlc1s1XSkpID8gJG1hdGNoZXNbNV1b
MF0gOiAkbWF0Y2hlc1s0XVswXTsKICAgICAgaWYgKHByZWdfbWF0Y2goJy9eb2F1dGhfLycs
ICRoZWFkZXJfbmFtZSkgfHwgISRvbmx5X2FsbG93X29hdXRoX3BhcmFtZXRlcnMpIHsKICAg
ICAgICAkcGFyYW1zWyRoZWFkZXJfbmFtZV0gPSBPQXV0aFV0aWw6OnVybGRlY29kZV9yZmMz
OTg2KCRoZWFkZXJfY29udGVudCk7CiAgICAgIH0KICAgICAgJG9mZnNldCA9ICRtYXRjaFsx
XSArIHN0cmxlbigkbWF0Y2hbMF0pOwogICAgfQoKICAgIGlmIChpc3NldCgkcGFyYW1zWydy
ZWFsbSddKSkgewogICAgICB1bnNldCgkcGFyYW1zWydyZWFsbSddKTsKICAgIH0KCiAgICBy
ZXR1cm4gJHBhcmFtczsKICB9CgogIC8vIGhlbHBlciB0byB0cnkgdG8gc29ydCBvdXQgaGVh
ZGVycyBmb3IgcGVvcGxlIHdobyBhcmVuJ3QgcnVubmluZyBhcGFjaGUKICBwdWJsaWMgc3Rh
dGljIGZ1bmN0aW9uIGdldF9oZWFkZXJzKCkgewogICAgaWYgKGZ1bmN0aW9uX2V4aXN0cygn
YXBhY2hlX3JlcXVlc3RfaGVhZGVycycpKSB7CiAgICAgIC8vIHdlIG5lZWQgdGhpcyB0byBn
ZXQgdGhlIGFjdHVhbCBBdXRob3JpemF0aW9uOiBoZWFkZXIKICAgICAgLy8gYmVjYXVzZSBh
cGFjaGUgdGVuZHMgdG8gdGVsbCB1cyBpdCBkb2Vzbid0IGV4aXN0CiAgICAgICRoZWFkZXJz
ID0gYXBhY2hlX3JlcXVlc3RfaGVhZGVycygpOwoKICAgICAgLy8gc2FuaXRpemUgdGhlIG91
dHB1dCBvZiBhcGFjaGVfcmVxdWVzdF9oZWFkZXJzIGJlY2F1c2UKICAgICAgLy8gd2UgYWx3
YXlzIHdhbnQgdGhlIGtleXMgdG8gYmUgQ2FzZWQtTGlrZS1UaGlzIGFuZCBhcmgoKQogICAg
ICAvLyByZXR1cm5zIHRoZSBoZWFkZXJzIGluIHRoZSBzYW1lIGNhc2UgYXMgdGhleSBhcmUg
aW4gdGhlCiAgICAgIC8vIHJlcXVlc3QKICAgICAgJG91dCA9IGFycmF5KCk7CiAgICAgIGZv
cmVhY2goICRoZWFkZXJzIEFTICRrZXkgPT4gJHZhbHVlICkgewogICAgICAgICRrZXkgPSBz
dHJfcmVwbGFjZSgKICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAiLSIsCiAgICAgICAg
ICAgIHVjd29yZHMoc3RydG9sb3dlcihzdHJfcmVwbGFjZSgiLSIsICIgIiwgJGtleSkpKQog
ICAgICAgICAgKTsKICAgICAgICAkb3V0WyRrZXldID0gJHZhbHVlOwogICAgICB9CiAgICB9
IGVsc2UgewogICAgICAvLyBvdGhlcndpc2Ugd2UgZG9uJ3QgaGF2ZSBhcGFjaGUgYW5kIGFy
ZSBqdXN0IGdvaW5nIHRvIGhhdmUgdG8gaG9wZQogICAgICAvLyB0aGF0ICRfU0VSVkVSIGFj
dHVhbGx5IGNvbnRhaW5zIHdoYXQgd2UgbmVlZAogICAgICAkb3V0ID0gYXJyYXkoKTsKICAg
ICAgaWYoIGlzc2V0KCRfU0VSVkVSWydDT05URU5UX1RZUEUnXSkgKQogICAgICAgICRvdXRb
J0NvbnRlbnQtVHlwZSddID0gJF9TRVJWRVJbJ0NPTlRFTlRfVFlQRSddOwogICAgICBpZigg
aXNzZXQoJF9FTlZbJ0NPTlRFTlRfVFlQRSddKSApCiAgICAgICAgJG91dFsnQ29udGVudC1U
eXBlJ10gPSAkX0VOVlsnQ09OVEVOVF9UWVBFJ107CgogICAgICBmb3JlYWNoICgkX1NFUlZF
UiBhcyAka2V5ID0+ICR2YWx1ZSkgewogICAgICAgIGlmIChzdWJzdHIoJGtleSwgMCwgNSkg
PT0gIkhUVFBfIikgewogICAgICAgICAgLy8gdGhpcyBpcyBjaGFvcywgYmFzaWNhbGx5IGl0
IGlzIGp1c3QgdGhlcmUgdG8gY2FwaXRhbGl6ZSB0aGUgZmlyc3QKICAgICAgICAgIC8vIGxl
dHRlciBvZiBldmVyeSB3b3JkIHRoYXQgaXMgbm90IGFuIGluaXRpYWwgSFRUUCBhbmQgc3Ry
aXAgSFRUUAogICAgICAgICAgLy8gY29kZSBmcm9tIHByemVtZWsKICAgICAgICAgICRrZXkg
PSBzdHJfcmVwbGFjZSgKICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAiLSIsCiAgICAg
ICAgICAgIHVjd29yZHMoc3RydG9sb3dlcihzdHJfcmVwbGFjZSgiXyIsICIgIiwgc3Vic3Ry
KCRrZXksIDUpKSkpCiAgICAgICAgICApOwogICAgICAgICAgJG91dFska2V5XSA9ICR2YWx1
ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHJldHVybiAkb3V0OwogIH0KCiAgLy8g
VGhpcyBmdW5jdGlvbiB0YWtlcyBhIGlucHV0IGxpa2UgYT1iJmE9YyZkPWUgYW5kIHJldHVy
bnMgdGhlIHBhcnNlZAogIC8vIHBhcmFtZXRlcnMgbGlrZSB0aGlzCiAgLy8gYXJyYXkoJ2En
ID0+IGFycmF5KCdiJywnYycpLCAnZCcgPT4gJ2UnKQogIHB1YmxpYyBzdGF0aWMgZnVuY3Rp
b24gcGFyc2VfcGFyYW1ldGVycyggJGlucHV0ICkgewogICAgaWYgKCFpc3NldCgkaW5wdXQp
IHx8ICEkaW5wdXQpIHJldHVybiBhcnJheSgpOwoKICAgICRwYWlycyA9IGV4cGxvZGUoJyYn
LCAkaW5wdXQpOwoKICAgICRwYXJzZWRfcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICBmb3Jl
YWNoICgkcGFpcnMgYXMgJHBhaXIpIHsKICAgICAgJHNwbGl0ID0gZXhwbG9kZSgnPScsICRw
YWlyLCAyKTsKICAgICAgJHBhcmFtZXRlciA9IE9BdXRoVXRpbDo6dXJsZGVjb2RlX3JmYzM5
ODYoJHNwbGl0WzBdKTsKICAgICAgJHZhbHVlID0gaXNzZXQoJHNwbGl0WzFdKSA/IE9BdXRo
VXRpbDo6dXJsZGVjb2RlX3JmYzM5ODYoJHNwbGl0WzFdKSA6ICcnOwoKICAgICAgaWYgKGlz
c2V0KCRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSkpIHsKICAgICAgICAvLyBXZSBo
YXZlIGFscmVhZHkgcmVjaWV2ZWQgcGFyYW1ldGVyKHMpIHdpdGggdGhpcyBuYW1lLCBzbyBh
ZGQgdG8gdGhlIGxpc3QKICAgICAgICAvLyBvZiBwYXJhbWV0ZXJzIHdpdGggdGhpcyBuYW1l
CgogICAgICAgIGlmIChpc19zY2FsYXIoJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJd
KSkgewogICAgICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3QgZHVwbGljYXRlLCBzbyB0cmFu
c2Zvcm0gc2NhbGFyIChzdHJpbmcpIGludG8gYW4gYXJyYXkKICAgICAgICAgIC8vIHNvIHdl
IGNhbiBhZGQgdGhlIGR1cGxpY2F0ZXMKICAgICAgICAgICRwYXJzZWRfcGFyYW1ldGVyc1sk
cGFyYW1ldGVyXSA9IGFycmF5KCRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSk7CiAg
ICAgICAgfQoKICAgICAgICAkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl1bXSA9ICR2
YWx1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICAkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFt
ZXRlcl0gPSAkdmFsdWU7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiAkcGFyc2VkX3BhcmFt
ZXRlcnM7CiAgfQoKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGJ1aWxkX2h0dHBfcXVlcnko
JHBhcmFtcykgewogICAgaWYgKCEkcGFyYW1zKSByZXR1cm4gJyc7CgogICAgLy8gVXJsZW5j
b2RlIGJvdGgga2V5cyBhbmQgdmFsdWVzCiAgICAka2V5cyA9IE9BdXRoVXRpbDo6dXJsZW5j
b2RlX3JmYzM5ODYoYXJyYXlfa2V5cygkcGFyYW1zKSk7CiAgICAkdmFsdWVzID0gT0F1dGhV
dGlsOjp1cmxlbmNvZGVfcmZjMzk4NihhcnJheV92YWx1ZXMoJHBhcmFtcykpOwogICAgJHBh
cmFtcyA9IGFycmF5X2NvbWJpbmUoJGtleXMsICR2YWx1ZXMpOwoKICAgIC8vIFBhcmFtZXRl
cnMgYXJlIHNvcnRlZCBieSBuYW1lLCB1c2luZyBsZXhpY29ncmFwaGljYWwgYnl0ZSB2YWx1
ZSBvcmRlcmluZy4KICAgIC8vIFJlZjogU3BlYzogOS4xLjEgKDEpCiAgICB1a3NvcnQoJHBh
cmFtcywgJ3N0cmNtcCcpOwoKICAgICRwYWlycyA9IGFycmF5KCk7CiAgICBmb3JlYWNoICgk
cGFyYW1zIGFzICRwYXJhbWV0ZXIgPT4gJHZhbHVlKSB7CiAgICAgIGlmIChpc19hcnJheSgk
dmFsdWUpKSB7CiAgICAgICAgLy8gSWYgdHdvIG9yIG1vcmUgcGFyYW1ldGVycyBzaGFyZSB0
aGUgc2FtZSBuYW1lLCB0aGV5IGFyZSBzb3J0ZWQgYnkgdGhlaXIgdmFsdWUKICAgICAgICAv
LyBSZWY6IFNwZWM6IDkuMS4xICgxKQogICAgICAgIG5hdHNvcnQoJHZhbHVlKTsKICAgICAg
ICBmb3JlYWNoICgkdmFsdWUgYXMgJGR1cGxpY2F0ZV92YWx1ZSkgewogICAgICAgICAgJHBh
aXJzW10gPSAkcGFyYW1ldGVyIC4gJz0nIC4gJGR1cGxpY2F0ZV92YWx1ZTsKICAgICAgICB9
CiAgICAgIH0gZWxzZSB7CiAgICAgICAgJHBhaXJzW10gPSAkcGFyYW1ldGVyIC4gJz0nIC4g
JHZhbHVlOwogICAgICB9CiAgICB9CiAgICAvLyBGb3IgZWFjaCBwYXJhbWV0ZXIsIHRoZSBu
YW1lIGlzIHNlcGFyYXRlZCBmcm9tIHRoZSBjb3JyZXNwb25kaW5nIHZhbHVlIGJ5IGFuICc9
JyBjaGFyYWN0ZXIgKEFTQ0lJIGNvZGUgNjEpCiAgICAvLyBFYWNoIG5hbWUtdmFsdWUgcGFp
ciBpcyBzZXBhcmF0ZWQgYnkgYW4gJyYnIGNoYXJhY3RlciAoQVNDSUkgY29kZSAzOCkKICAg
IHJldHVybiBpbXBsb2RlKCcmJywgJHBhaXJzKTsKICB9Cn0iO3M6MzoibWQ1IjtzOjMyOiIz
Y2VkZDJlMjUwNzQ4NDFlYjVmNDA3NzdhZDRhZGY2YyI7fQ==
