# arc_twitter v3.1
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjM6
IjMuMSI7czo2OiJhdXRob3IiO3M6MTE6IkFuZHkgQ2FydGVyIjtzOjEwOiJhdXRob3JfdXJp
IjtzOjMxOiJodHRwOi8vcmVkaG90Y2hpbGxpcHJvamVjdC5jb20vIjtzOjExOiJkZXNjcmlw
dGlvbiI7czo2MDoiPGEgaHJlZj0iaHR0cDovL3d3dy50d2l0dGVyLmNvbSI+VHdpdHRlcjwv
YT4gZm9yIFRleHRwYXR0ZXJuIjtzOjU6Im9yZGVyIjtzOjE6IjUiO3M6NDoidHlwZSI7czox
OiIxIjtzOjU6ImZsYWdzIjtzOjE6IjMiO3M6NDoiaGVscCI7czoxNzAwNjoiCTxoMSBjbGFz
cz0idGl0bGUiPjxzcGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0IChhcmNfdHdp
dHRlciBmb3IgVGV4dHBhdHRlcm4pPC9oMT4KCgk8b2w+CgkJPGxpPjxhIGhyZWY9IiNhcmNf
dHdpdHRlcl9hdXRob3IiPkF1dGhvcjwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3
aXR0ZXJfaW5zdGFsbGF0aW9uIj5JbnN0YWxsYXRpb24gLyBVbmluc3RhbGxhdGlvbjwvYT48
L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfdGFnIj5UaGUgYXJjX3R3aXR0ZXIg
dGFnPC9hPjwvbGk+CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl9zZWFyY2hfdGFnIj5U
aGUgYXJjX3R3aXR0ZXJfc2VhcmNoIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJj
X3R3aXR0ZXJfdHdlZXRfYnV0dG9uX3RhZyI+VGhlIGFyY190d2l0dGVyX3R3ZWV0X2J1dHRv
biB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX2ZvbGxvd19idXR0
b25fdGFnIj5UaGUgYXJjX3R3aXR0ZXJfZm9sbG93X2J1dHRvbiB0YWc8L2E+PC9saT4KCQk8
bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3R3ZWV0X3VybCI+VGhlIGFyY190d2l0dGVyX3R3
ZWV0X3VybCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3Rpbnl1
cmwiPlRoZSBhcmNfdHdpdHRlcl90aW55dXJsIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVm
PSIjYXJjX3R3aXR0ZXJfY2FjaGluZyI+Q2FjaGluZzwvYT48L2xpPgoJCTxsaT48YSBocmVm
PSIjYXJjX3R3aXR0ZXJfcHJlZnMiPlByZWZlcmVuY2VzPC9hPjwvbGk+CgkJPGxpPjxhIGhy
ZWY9IiNhcmNfdHdpdHRlcl9hcnRpY2xlIj5Ud2VldGluZyBhcnRpY2xlczwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfYWRtaW4iPlRoZSBUd2l0dGVyIHRhYjwvYT48
L2xpPgoJPC9vbD4KCgk8cD48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCBw
cm92aWRlcyBhY2Nlc3MgdG8geW91ciBUd2l0dGVyIGFjY291bnQgdGhyb3VnaCBib3RoIHRo
ZSBhZG1pbiBpbnRlcmZhY2UgYW5kIHRoZSBwdWJsaWMgc2lkZSBvZiB5b3VyIHNpdGUuIFVw
ZGF0ZSBUd2l0dGVyIHdoZW4geW91IHBvc3QgYSBuZXcgYXJ0aWNsZSAod2l0aCBhcnRpY2xl
LWJ5LWFydGljbGUgb3B0IG91dCBvcHRpb24pLCB1cGRhdGUgYW5kIHZpZXcgeW91ciBUd2l0
dGVyIGZlZWQgdGhyb3VnaCB0aGUgYWRtaW4gVHdpdHRlciB0YWIsIGFuZCBkaXNwbGF5IFR3
aXR0ZXIgZmVlZHMgb24geW91ciBzaXRlLjwvcD4KCgk8cD5SZXF1aXJlbWVudHM6LTwvcD4K
Cgk8dWw+CgkJPGxpPlRleHRwYXR0ZXJuIDQuMis8L2xpPgoJCTxsaT48c3BhbiBjbGFzcz0i
Y2FwcyI+UEhQPC9zcGFuPiA1IGFuZCBjVVJMPC9saT4KCTwvdWw+CgoJPGgyIGNsYXNzPSJz
ZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2gyPgoKCTxwPjxhIGhy
ZWY9Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbSI+QW5keSBDYXJ0ZXI8L2E+LiBG
b3Igb3RoZXIgVGV4dHBhdHRlcm4gcGx1Z2lucyBieSBtZSB2aXNpdCBteSA8YSBocmVmPSJo
dHRwOi8vcmVkaG90Y2hpbGxpcHJvamVjdC5jb20vdHhwIj5QbHVnaW5zIHBhZ2U8L2E+Ljwv
cD4KCgk8cD5UaGFua3MgdG8gPGEgaHJlZj0iaHR0cDovL21hbmZyZS5uZXQvIj5NaWNoYWVs
IE1hbmZyZTwvYT4gZm9yIGluc3BpcmF0aW9uIGZvciB0aGUgYXJ0aWNsZSB0d2VldCBwYXJ0
IG9mIHRoaXMgcGx1Z2luIGJhc2VkIG9uIGhpcyA8c3BhbiBjbGFzcz0idGFnIj5tZW1fdHdp
dHRlcjwvc3Bhbj4gcGx1Z2luLiAgQWRkaXRpb25hbCB0aGFua3MgdG8gdGhlIGdyZWF0IFRl
eHRwYXR0ZXJuIGNvbW11bml0eSBmb3IgaGVscGluZyB0byB0ZXN0IHRoaXMgcGx1Z2luIGFu
ZCBmb3Igc3VnZ2VzdGluZyBuZXcgZmVhdHVyZXMuIFRoZSBPQXV0aCBwYXJ0IG9mIHRoZSBw
bHVnaW4gaXMgdGhhbmtzIHRvIDxhIGhyZWY9Imh0dHA6Ly90d2l0dGVyLmNvbS9hYnJhaGFt
Ij5BYnJhaGFtIFdpbGxpYW1zPC9hPi48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0i
YXJjX3R3aXR0ZXJfaW5zdGFsbGF0aW9uIj5JbnN0YWxsYXRpb24gLyBVbmluc3RhbGxhdGlv
bjwvaDI+CgoJPHA+VG8gaW5zdGFsbCBnbyB0byB0aGUgJiM4MjE2O3BsdWdpbnMmIzgyMTc7
IHRhYiB1bmRlciAmIzgyMTY7YWRtaW4mIzgyMTc7IGFuZCBwYXN0ZSB0aGUgcGx1Z2luIGNv
ZGUgaW50byB0aGUgJiM4MjE2O0luc3RhbGwgcGx1Z2luJiM4MjE3OyBib3gsICYjODIxNjt1
cGxvYWQmIzgyMTc7IGFuZCB0aGVuICYjODIxNjtpbnN0YWxsJiM4MjE3Oy4gVGhlIHBsdWdp
biB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgYWN0aXZhdGVkLjwvcD4KCgk8cD5CZWZvcmUgeW91
IHN0YXJ0IHVzaW5nIDxzcGFuIGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiB5b3Ug
d2lsbCBuZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IHRoZSBjYWNoZSBkaXJlY3RvcnkgaXMgd3Jp
dGFibGUuIFNlZSB0aGUgJiM4MjE2O0NhY2hpbmcmIzgyMTc7IHN1YnNlY3Rpb24gYmVsb3cg
Zm9yIGZ1cnRoZXIgaW5mb3JtYXRpb24uPC9wPgoKCTxwPjxzcGFuIGNsYXNzPSJ0YWciPmFy
Y190d2l0dGVyPC9zcGFuPiBzaG91bGQgbm93IGJlIHJlYWR5IGZvciB1c2Ugb24gdGhlIHB1
YmxpYy1zaWRlIG9mIHlvdXIgc2l0ZS48L3A+CgoJPHA+VG8gdW5sb2NrIHRoZSBhZG1pbiBm
ZWF0dXJlcyBvZiB0aGlzIHBsdWdpbiB5b3Ugd2lsbCBuZWVkIHRvIGFzc29jaWF0ZSB5b3Vy
IHNpdGUgd2l0aCBhIFR3aXR0ZXIgYWNjb3VudCBieSBjb25uZWN0aW5nIHRvIFR3aXR0ZXIg
ZnJvbSB0aGUgcGx1Z2luJiM4MjE3O3Mgb3B0aW9ucyBzY3JlZW4uIENsaWNrIG9uIHRoZSBs
aW5rIHRvIGNvbm5lY3QgdG8gVHdpdHRlciwgeW91IHdpbGwgYmUgYXNrZWQgdG8gbG9naW4g
dG8gVHdpdHRlciwgY2xpY2tpbmcgdGhpcyBsaW5rIHdpbGwgdGVtcG9yYXJpbHkgdGFrZSB5
b3UgdG8gdGhlIFR3aXR0ZXIgc2l0ZSB3aGVyZSB5b3Ugd2lsbCBiZSBhc2tlZCB0byBsb2dp
biBhbmQgYXBwcm92ZSBhY2Nlc3MgZm9yIDxzcGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+
IFR3ZWV0IHRvIHJlYWQgYW5kIHdyaXRlIHRvIHlvdXIgVHdpdHRlciBhY2NvdW50LiBJZiBh
bGwgaXMgc3VjY2Vzc2Z1bCB5b3Ugd2lsbCBiZSByZXR1cm5lZCB0byB0aGUgb3B0aW9ucyBz
Y3JlZW4gYW5kIHlvdXIgdXNlciBuYW1lIHdpbGwgYXBwZWFyLjwvcD4KCgk8cD5BdCBhbnkg
dGltZSB5b3UgY2FuIGRpc2Fzc29jaWF0ZSB5b3VyIFR3aXR0ZXIgYWNjb3VudCB3aXRoIDxz
cGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0IHZpYSB5b3VyIFR3aXR0ZXIgYWNj
b3VudCBwcmVmZXJlbmNlcyBvbiB0aGUgPGEgaHJlZj0iaHR0cDovL3d3dy50d2l0dGVyLmNv
bSI+VHdpdHRlciB3ZWJzaXRlPC9hPi48L3A+CgoJPHA+VG8gdW5pbnN0YWxsIDxzcGFuIGNs
YXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiBzaW1wbHkgZGVsZXRlIHRoZSBwbHVnaW4g
ZnJvbSB0aGUgJiM4MjE2O1BsdWdpbnMmIzgyMTc7IHRhYi4gIFRoaXMgd2lsbCByZW1vdmUg
dGhlIHBsdWdpbiBjb2RlLCBkZWxldGUgcmVsYXRlZCBwcmVmZXJlbmNlcyBhbmQgZHJvcCB0
aGUgPHNwYW4gY2xhc3M9InRhZyI+YXJjX3R3aXR0ZXI8L3NwYW4+IHRhYmxlIGZyb20geW91
ciBUZXh0cGF0dGVybiBkYXRhYmFzZS48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0i
YXJjX3R3aXR0ZXJfdGFnIj5UaGUgYXJjX3R3aXR0ZXIgdGFnPC9oMj4KCgk8aDM+U3ludGF4
PC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyIHVzZXI9JnF1b3Q7ZHJtb25rZXluaW5q
YSZxdW90OyAvJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJ
CTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVm
YXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVz
ZXI8L3RkPgoJCQk8dGQ+VHdpdHRlciB1c2VyIG5hbWU8L3RkPgoJCQk8dGQ+IDxlbT5hcmNf
dHdpdHRlciB1c2VybmFtZTwvZW0+PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXlu
aW5qYSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5saW1pdDwvdGQ+CgkJCTx0
ZD5NYXhpbXVtIG51bWJlciBvZiB0d2VldHMgdG8gZGlzcGxheSAobWF4LiAyMDApPC90ZD4K
CQkJPHRkPjEwPC90ZD4KCQkJPHRkPmxpbWl0PSZxdW90OzI1JnF1b3Q7PC90ZD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPmRhdGVmb3JtYXQ8L3RkPgoJCQk8dGQ+Rm9ybWF0IHRoYXQgdXBk
YXRlIGRhdGVzIHdpbGwgYXBwZWFyIGFzPC90ZD4KCQkJPHRkPiA8ZW0+QXJjaGl2ZSBkYXRl
IGZvcm1hdDwvZW0+PC90ZD4KCQkJPHRkPmRhdGVmb3JtYXQ9JnF1b3Q7JWIgJU9lLCAlSTol
TSAlcCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbDwvdGQ+CgkJCTx0
ZD5MYWJlbCBmb3IgdGhlIHRvcCBvZiB0aGUgbGlzdDwvdGQ+CgkJCTx0ZD4gPGVtPm5vIGxh
YmVsPC9lbT48L3RkPgoJCQk8dGQ+bGFiZWw9JnF1b3Q7TXkgVHdpdHRlciB0aW1lbGluZSZx
dW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbHRhZzwvdGQ+CgkJCTx0ZD5J
bmRlcGVuZGVudCB3cmFwdGFnIGZvciBsYWJlbDwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9l
bT48L3RkPgoJCQk8dGQ+bGFiZWx0YWc9JnF1b3Q7aDMmcXVvdDs8L3RkPgoJCTwvdHI+CgkJ
PHRyPgoJCQk8dGQ+YnJlYWs8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFu
IGNsYXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnICh3aXRob3V0IGJyYWNrZXRz
KSwgb3Igc3RyaW5nLCB1c2VkIHRvIHNlcGFyYXRlIHRoZSB1cGRhdGVzPC90ZD4KCQkJPHRk
PmxpPC90ZD4KCQkJPHRkPmJyZWFrPSZxdW90O2JyJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0
cj4KCQkJPHRkPndyYXB0YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFu
IGNsYXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVzZWQgYXMgdGhl
IHdyYXB0YWcsIHdpdGhvdXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+
PC90ZD4KCQkJPHRkPndyYXB0YWc9JnF1b3Q7dWwmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRy
PgoJCQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNs
YXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgZm9yIHdyYXB0
YWc8L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXI8L3RkPgoJCQk8dGQ+Y2xhc3M9JnF1b3Q7dHdp
dHRlciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzc19wb3N0ZWQ8L3Rk
PgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3Nw
YW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byBzcGFuIHRhZyBhcm91bmQg
cG9zdGVkIGRhdGU8L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXItcG9zdGVkPC90ZD4KCQk8L3Ry
PgoJPC90YWJsZT4KCgk8aDM+RXhhbXBsZSB1c2FnZTwvaDM+CgoJPHA+Jmx0O3R4cDphcmNf
dHdpdHRlciB1c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDsgbGltaXQ9JnF1b3Q7NSZx
dW90OyB3cmFwdGFnPSZxdW90O3VsJnF1b3Q7IGJyZWFrPSZxdW90O2xpJnF1b3Q7IGRhdGVm
b3JtYXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAlcCZxdW90OyAvJmd0OzwvcD4KCgk8cD5Qcm9k
dWNlcyBhIGJ1bGxldCBwb2ludCBsaXN0IG9mIHRoZSBsYXN0IDUgVHdpdHRlciB1cGRhdGVz
IGZyb20gZHJtb25rZXluaW5qYSYjODIxNztzIFR3aXR0ZXIgZmVlZCB3aXRoIGEgZGVmaW5l
ZCBkYXRlIGZvcm1hdCB0byBvdmVycmlkZSB0aGUgZGVmYXVsdCBhcmNoaXZlIGRhdGUgZm9y
bWF0LjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9zZWFyY2hf
dGFnIj5UaGUgYXJjX3R3aXR0ZXJfc2VhcmNoIHRhZzwvaDI+CgoJPGgzPlN5bnRheDwvaDM+
CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl9zZWFyY2ggaGFzaHRhZ3M9JnF1b3Q7dHhwJnF1
b3Q7IC8mZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRo
PkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0
PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+c2VhcmNo
PC90ZD4KCQkJPHRkPkNvbW1hIHNlcGFyYXRlZCBsaXN0IG9mIHNlYXJjaCB3b3JkczwvdGQ+
CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+c2VhcmNoPSZxdW90O3R4cCx0
ZXh0cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5oYXNodGFnczwv
dGQ+CgkJCTx0ZD5Db21tYSBzZXBhcmF0ZWQgbGlzdCBvZiBoYXNodGFncyB0byBzZWFyY2gg
Zm9yIChub3QgaW5jbHVkaW5nIHRoZSBoYXNoKTwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9l
bT48L3RkPgoJCQk8dGQ+aGFzaHRhZ3M9JnF1b3Q7dHhwLHRleHRwYXR0ZXJuJnF1b3Q7PC90
ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnJlcGx5PC90ZD4KCQkJPHRkPlVzZXJuYW1lIG9m
IHR3ZWV0cyBpbiByZXBseSB0bzwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJ
CQk8dGQ+cmVwbHk9JnF1b3Q7dHdpdHRlciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJ
CTx0ZD5tZW50aW9uPC90ZD4KCQkJPHRkPlVzZXJuYW1lIG9mIHVzZXIgbWVudGlvbmVkIGlu
IHR3ZWV0cyAoPGk+aS5lLjwvaT4gdHdlZXRzIGNvbnRhaW5pbmcgQHVzZXJuYW1lKTwvdGQ+
CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+bWVudGlvbj0mcXVvdDt0d2l0
dGVyJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxpbWl0PC90ZD4KCQkJPHRk
Pk1heGltdW0gbnVtYmVyIG9mIHR3ZWV0cyB0byBkaXNwbGF5IChtYXguIDIwMCk8L3RkPgoJ
CQk8dGQ+MTA8L3RkPgoJCQk8dGQ+bGltaXQ9JnF1b3Q7MjUmcXVvdDs8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+ZGF0ZWZvcm1hdDwvdGQ+CgkJCTx0ZD5Gb3JtYXQgdGhhdCB1cGRh
dGUgZGF0ZXMgd2lsbCBhcHBlYXIgYXM8L3RkPgoJCQk8dGQ+IDxlbT5BcmNoaXZlIGRhdGUg
Zm9ybWF0PC9lbT48L3RkPgoJCQk8dGQ+ZGF0ZWZvcm1hdD0mcXVvdDslYiAlT2UsICVJOiVN
ICVwJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsPC90ZD4KCQkJPHRk
PkxhYmVsIGZvciB0aGUgdG9wIG9mIHRoZSBsaXN0PC90ZD4KCQkJPHRkPiA8ZW0+bm8gbGFi
ZWw8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbHRhZzwvdGQ+CgkJCTx0
ZD5JbmRlcGVuZGVudCB3cmFwdGFnIGZvciBsYWJlbDwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0
PC9lbT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+YnJlYWs8L3RkPgoJCQk8dGQ+PHNw
YW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4g
dGFnICh3aXRob3V0IGJyYWNrZXRzKSwgb3Igc3RyaW5nLCB1c2VkIHRvIHNlcGFyYXRlIHRo
ZSB1cGRhdGVzPC90ZD4KCQkJPHRkPmxpPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPndy
YXB0YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBz
Ij5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVzZWQgYXMgdGhlIHdyYXB0YWcsIHdp
dGhvdXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48
c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGZv
ciB3cmFwdGFnPC90ZD4KCQkJPHRkPmFyY190d2l0dGVyX3NlYXJjaDwvdGQ+CgkJPC90cj4K
CQk8dHI+CgkJCTx0ZD5jbGFzc191c2VyPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBz
Ij48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRl
IGFwcGxpZWQgdG8gc3BhbiB0YWcgYXJvdW5kIHVzZXIgbmFtZTwvdGQ+CgkJCTx0ZD5hcmNf
dHdpdHRlci11c2VyPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzX3Bvc3RlZDwv
dGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwv
c3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHNwYW4gdGFnIGFyb3Vu
ZCBwb3N0ZWQgZGF0ZTwvdGQ+CgkJCTx0ZD5hcmNfdHdpdHRlci1wb3N0ZWQ8L3RkPgoJCTwv
dHI+Cgk8L3RhYmxlPgoKCTxoMz5FeGFtcGxlIHVzYWdlPC9oMz4KCgk8cD4mbHQ7dHhwOmFy
Y190d2l0dGVyX3NlYXJjaCBzZWFyY2g9JnF1b3Q7cGx1Z2luJnF1b3Q7IGhhc2h0YWdzPSZx
dW90O3R4cCx0ZXh0cGF0dGVybiZxdW90OyBsaW1pdD0mcXVvdDsyNSZxdW90OyAvJmd0Ozwv
cD4KCgk8cD5Qcm9kdWNlcyBhIGxpc3Qgb2YgdHdlZXRzIGNvbnRhaW5pbmcgdGhlIHdvcmQg
JiM4MjE2O3BsdWdpbiYjODIxNzsgYW5kIHRoZSBoYXNodGFncyAmIzgyMTY7I3R4cCYjODIx
NzsgYW5kICYjODIxNjsjdGV4dHBhdHRlcm4mIzgyMTc7LiBUaGUgdGFnIHdpbGwgcmV0dXJu
IGEgbWF4aW11bSBvZiAyNSB0d2VldHMuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9
ImFyY190d2l0dGVyX3JldHdlZXRfdGFnIj5UaGUgYXJjX3R3aXR0ZXJfdHdlZXRfYnV0dG9u
IHRhZzwvaDI+CgoJPHA+T3V0cHV0cyB0aGUgVHdpdHRlciB0d2VldCBidXR0b24gKGZvcm1l
cmx5ICZsdDt0eHA6YXJjX3R3aXR0ZXJfcmV0d2VldCAvJmd0OykuPC9wPgoKCTxoMz5TeW50
YXg8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfdHdlZXRfYnV0dG9uIC8mZ3Q7PC9w
PgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwv
dGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRo
PkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+dXNlcjwvdGQ+CgkJCTx0ZD5U
d2l0dGVyIHVzZXIgbmFtZSB0byBxdW90ZTwvdGQ+CgkJCTx0ZD4gPGVtPmFyY190d2l0dGVy
IHVzZXJuYW1lPC9lbT48L3RkPgoJCQk8dGQ+dXNlcj0mcXVvdDtkcm1vbmtleW5pbmphJnF1
b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVybDwvdGQ+CgkJCTx0ZD48c3BhbiBj
bGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj48L3NwYW4+IHRvIHR3
ZWV0PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnRleHQ8L3RkPgoJCQk8dGQ+VHdlZXQg
dGV4dDwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5mb2xsb3cxPC90ZD4KCQkJPHRkPlN1
Z2dlc3RlZCBUd2l0dGVyIGFjY291bnQgdG8gZm9sbG93LCBmb3IgZXhhbXBsZSB5b3VyIG93
bjwvdGQ+CgkJCTx0ZD5BIFR3aXR0ZXIgdXNlciB0byByZWNvbW1lbmQ8L3RkPgoJCQk8dGQ+
Zm9sbG93MT0mcXVvdDtUZXh0cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJ
CTx0ZD5mb2xsb3cyPC90ZD4KCQkJPHRkPkFzIGZvbGxvdzE8L3RkPgoJCQk8dGQ+IDxlbT51
bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhbmc8L3RkPgoJCQk8dGQ+
TGFuZ3VhZ2U8L3RkPgoJCQk8dGQ+ZW48L3RkPgoJCQk8dGQ+bGFuZz0mcXVvdDtlcyZxdW90
OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jb3VudDwvdGQ+CgkJCTx0ZD5Db3VudCBi
b3ggcG9zaXRpb24sIG9wdGlvbnM6IG5vbmUsIGhvcml6b250YWwgb3IgdmVydGljYWw8L3Rk
PgoJCQk8dGQ+aG9yaXpvbnRhbDwvdGQ+CgkJCTx0ZD5jb3VudD0mcXVvdDtub25lJnF1b3Q7
PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmluY2x1ZGVfanM8L3RkPgoJCQk8dGQ+V2hl
dGhlciBvciBub3QgdG8gaW5jbHVkZSB0aGUgd2lkZ2V0IEphdmFTY3JpcHQ8L3RkPgoJCQk8
dGQ+MTwvdGQ+CgkJCTx0ZD5pbmNsdWRlX2pzPSZxdW90OzAmcXVvdDs8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+b3B0aW1pc2VfanM8L3RkPgoJCQk8dGQ+T3B0aW1pc2UgdGhlIEph
dmFTY3JpcHQgYnkgdXNpbmcgYSBsb2NhbCBzY3JpcHQgcmF0aGVyIHRoYW4gdGhhdCBob3N0
ZWQgb24gdGhlIFR3aXR0ZXIgc2l0ZTwvdGQ+CgkJCTx0ZD4wPC90ZD4KCQkJPHRkPm9wdGlt
aXNlX2pzPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8
L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8
L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byB0aGUgdHdlZXQgYnV0
dG9uPC90ZD4KCQkJPHRkPnR3aXR0ZXItc2hhcmUtYnV0dG9uPC90ZD4KCQk8L3RyPgoJPC90
YWJsZT4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9mb2xsb3dfYnV0
dG9uX3RhZyI+VGhlIGFyY190d2l0dGVyX2ZvbGxvd19idXR0b24gdGFnPC9oMj4KCgk8cD5P
dXRwdXRzIHRoZSBUd2l0dGVyIGZvbGxvdyBidXR0b24gKGFuIGFsdGVybmF0aXZlIHZlcnNp
b24gaXMgaW5jbHVkZWQgaW4gYXJjX3R3aXR0ZXJfaW50ZW50cykuPC9wPgoKCTxoMz5TeW50
YXg8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfZm9sbG93X2J1dHRvbiAvJmd0Ozwv
cD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8
L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0
aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVzZXI8L3RkPgoJCQk8dGQ+
VHdpdHRlciB1c2VyIG5hbWUgdG8gZm9sbG93PC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0
ZXIgdXNlcm5hbWU8L2VtPjwvdGQ+CgkJCTx0ZD51c2VyPSZxdW90O2RybW9ua2V5bmluamEm
cXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFuZzwvdGQ+CgkJCTx0ZD5MYW5n
dWFnZTwvdGQ+CgkJCTx0ZD5lbjwvdGQ+CgkJCTx0ZD5sYW5nPSZxdW90O2VzJnF1b3Q7PC90
ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNvdW50PC90ZD4KCQkJPHRkPldoZXRoZXIgb3Ig
bm90IHRoZSBmb2xsb3dlciBjb3VudCBpcyBzaG93bjwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQkJ
PHRkPmNvdW50PSZxdW90OzAmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aW5j
bHVkZV9qczwvdGQ+CgkJCTx0ZD5XaGV0aGVyIG9yIG5vdCB0byBpbmNsdWRlIHRoZSB3aWRn
ZXQgSmF2YVNjcmlwdDwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQkJPHRkPmluY2x1ZGVfanM9JnF1
b3Q7MCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5vcHRpbWlzZV9qczwvdGQ+
CgkJCTx0ZD5PcHRpbWlzZSB0aGUgSmF2YVNjcmlwdCBieSB1c2luZyBhIGxvY2FsIHNjcmlw
dCByYXRoZXIgdGhhbiB0aGF0IGhvc3RlZCBvbiB0aGUgVHdpdHRlciBzaXRlPC90ZD4KCQkJ
PHRkPjA8L3RkPgoJCQk8dGQ+b3B0aW1pc2VfanM9JnF1b3Q7MSZxdW90OzwvdGQ+CgkJPC90
cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+
PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBh
cHBsaWVkIHRvIHRoZSBmb2xsb3cgYnV0dG9uPC90ZD4KCQkJPHRkPnR3aXR0ZXItZm9sbG93
LWJ1dHRvbjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBp
ZD0iYXJjX3R3aXR0ZXJfdHdlZXRfdXJsIj5hcmNfdHdpdHRlcl90d2VldF91cmw8L2gyPgoK
CTxwPlJldHVybnMgdGhlIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+IG9mIHRoZSBU
d2l0dGVyIHN0YXR1cyBmb3IgYW4gYXJ0aWNsZS48L3A+CgoJPGgzPlN5bnRheDwvaDM+CgoJ
PHA+Jmx0O3R4cDphcmNfdHdpdHRlcl90d2VldF91cmwgLyZndDs8L3A+CgoJPHA+Jmx0O3R4
cDphcmNfdHdpdHRlcl90d2VldF91cmwmZ3Q7TGluayB0ZXh0Jmx0Oy90eHA6YXJjX3R3aXR0
ZXJfdHdlZXRfdXJsJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+
CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+
RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRk
PmlkPC90ZD4KCQkJPHRkPlRleHRwYXR0ZXJuIGFydGljbGUgSUQ8L3RkPgoJCQk8dGQ+IDxl
bT5jdXJyZW50IGFydGljbGU8L2VtPjwvdGQ+CgkJCTx0ZD5pZD0mcXVvdDsxJnF1b3Q7PC90
ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnRpdGxlPC90ZD4KCQkJPHRkPlRpdGxlIGF0dHJp
YnV0ZSBvZiB0aGUgbGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwv
dHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMi
PjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUg
YXBwbGllZCB0byB0aGUgbGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJ
CTwvdHI+Cgk8L3RhYmxlPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVy
X3Rpbnl1cmwiPmFyY190d2l0dGVyX3Rpbnl1cmw8L2gyPgoKCTxwPlJldHVybnMgdGhlIHNo
b3J0ZW5lZCA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPiBvZiB0aGUgYXJ0aWNsZSB1
c2VkIGZvciB0aGUgVHdpdHRlciB1cGRhdGUuPC9wPgoKCTxoMz5TeW50YXg8L2gzPgoKCTxw
PiZsdDt0eHA6YXJjX3R3aXR0ZXJfdGlueXVybCAvJmd0OzwvcD4KCgk8cD4mbHQ7dHhwOmFy
Y190d2l0dGVyX3Rpbnl1cmwmZ3Q7TGluayB0ZXh0Jmx0Oy90eHA6YXJjX3R3aXR0ZXJfdGlu
eXVybCZndDs8L3A+CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+
QXR0cmlidXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8
L3RoPgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5pZDwvdGQ+
CgkJCTx0ZD5UZXh0cGF0dGVybiBhcnRpY2xlIElEPC90ZD4KCQkJPHRkPiA8ZW0+Y3VycmVu
dCBhcnRpY2xlPC9lbT48L3RkPgoJCQk8dGQ+aWQ9JnF1b3Q7MSZxdW90OzwvdGQ+CgkJPC90
cj4KCQk8dHI+CgkJCTx0ZD50aXRsZTwvdGQ+CgkJCTx0ZD5UaXRsZSBhdHRyaWJ1dGUgb2Yg
dGhlIGxpbms8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0
cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBj
bGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQg
dG8gdGhlIGxpbms8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJ
PC90YWJsZT4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9jYWNoaW5n
Ij5DYWNoaW5nPC9oMj4KCgk8cD5JbiBvcmRlciB0byBwcmV2ZW50IGV4Y2Vzc2l2ZSByZXBl
YXRpdGl2ZSBjYWxscyB0byB0aGUgVHdpdHRlciB3ZWJzaXRlIGl0IGlzIHJlY29tbWVuZGVk
IHRvIGNhY2hlIHJlc3VsdHMuIFR3aXR0ZXIgbGltaXRzIHRoZSBudW1iZXIgb2YgY2FsbHMg
dGhyb3VnaCB0aGUgPHNwYW4gY2xhc3M9ImNhcHMiPkFQSTwvc3Bhbj4sIGFuZCBjb250aW51
b3VzIGNhbGxzIHdpbGwgcmVzdWx0IGluIFR3aXR0ZXIgY2xvc2luZyB0byBmdXJ0aGVyIHJl
cXVlc3RzLiBCeSBkZWZhdWx0LCBhcmNfdHdpdHRlciBjYWNoZXMgZm9yIDMwIG1pbnV0ZSBp
bnRlcnZhbHMuPC9wPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJ
CQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFt
cGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNhY2hpbmc8L3RkPgoJCQk8dGQ+JiM4
MjE2OzEmIzgyMTc7IHRvIGNhY2hlIGZlZWQsICYjODIxNjswJiM4MjE3OyB0byB0dXJuIGNh
Y2hpbmcgb2ZmIChub3QgcmVjb21tZW5kZWQpPC90ZD4KCQkJPHRkPjE8L3RkPgoJCQk8dGQ+
Y2FjaGluZz0mcXVvdDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNhY2hl
X2RpcjwvdGQ+CgkJCTx0ZD5BYnNvbHV0ZSBwYXRoIHRvIHRoZSBjYWNoZSBkaXJlY3Rvcnkg
KG11c3QgYmUgd3JpdGFibGUpPC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0ZXIgcHJlZmVy
ZW5jZXM8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jYWNoZV90aW1lPC90ZD4K
CQkJPHRkPlRpbWUgaW4gbWludXRlcyB0aGF0IHRoZSBjYWNoZSBmaWxlcyBhcmUgc3RvcmVk
IGJlZm9yZSBiZWluZyByZWZyZXNoZWQ8L3RkPgoJCQk8dGQ+NTwvdGQ+CgkJCTx0ZD5jYWNo
ZV90aW1lPSZxdW90OzMwJnF1b3Q7PC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8cD5UaGUg
YWRtaW4gc2lkZSBvZiB0aGlzIHBsdWdpbiBlbmZvcmNlcyBjYWNoaW5nLCBhcGFydCBmcm9t
IHdoZW4gaXQgaXMgcG9zdGluZyB0byBUd2l0dGVyICg8aT5lLmcuPC9pPiB3aGVuIHBvc3Rp
bmcgb3IgZGVsZXRpbmcgYW4gdXBkYXRlKS48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBp
ZD0iYXJjX3R3aXR0ZXJfcHJlZnMiPlByZWZlcmVuY2VzPC9oMj4KCgk8cD5Zb3UgY2FuIGFj
Y2VzcyB0aGUgcGx1Z2lucyBjb3JlIHByZWZlcmVuY2VzIGZyb20gZWl0aGVyIHRoZSBQcmVm
ZXJlbmNlcyBvciBQbHVnaW5zIHRhYnMgaW4gYWRtaW4uIFNldHVwIHlvdXIgVHdpdHRlciBh
Y2NvdW50ICh5b3Ugd2lsbCBiZSBhc2tlZCB0byBjb25uZWN0IHZpYSBUd2l0dGVyIGFuZCB0
aGlzIG5lZWRzIGRvaW5nIGJlZm9yZSB5b3UgY2FuIHVzZSB0aGUgcGx1Z2luKSBhbmQgY2hh
bmdlIHRoZSBjYWNoZSBkaXJlY3RvcnkgdXNpbmcgYXJjX3R3aXR0ZXImIzgyMTc7cyBwcmVm
ZXJlbmNlcy4gV2l0aG91dCBwcm92aWRpbmcgeW91ciBhY2NvdW50IGxvZ2luIGRldGFpbHMg
dGhlIGFkbWluIGFyZWEgZmVhdHVyZXMgb2YgdGhpcyBwbHVnaW4gd2lsbCBiZSBpbmFjdGl2
ZS48L3A+CgoJPHA+WW91IGNhbiBzZWxlY3QgdGhlIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8
L3NwYW4+IHNob3J0ZW5lciBtZXRob2QgeW91IHdhbnQgdG8gdXNlIHRvIGxpbmsgYmFjayB0
byB5b3VyIGFydGljbGUgb24gVHdpdHRlci4gUGxlYXNlIG5vdGUgdGhhdCBpZiB5b3Ugc2Vs
ZWN0IHNtZF9zaG9ydF91cmwgeW91IHdpbGwgbmVlZCB0byBoYXZlIGluc3RhbGxlZCBhbmQg
YWN0aXZhdGVkIHRoZSA8YSBocmVmPSJodHRwOi8vdGV4dHBhdHRlcm4ub3JnL3BsdWdpbnMv
MTA5OS9zbWRfc2hvcnRfdXJsIj48c3BhbiBjbGFzcz0idGFnIj5zbWRfc2hvcnRfdXJsPC9z
cGFuPiBwbHVnaW48L2E+IGRldmVsb3BlZCBieSBTdGVmIERhd3Nvbi48L3A+CgoJPGgyIGNs
YXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYXJ0aWNsZSI+VHdlZXRpbmcgYXJ0aWNs
ZXM8L2gyPgoKCTxwPkJ5IGRlZmF1bHQgYXJjX3R3aXR0ZXIgd2lsbCBwb3N0IGFuIHVwZGF0
ZSB0byBUd2l0dGVyIGluY2x1ZGluZyBhIHNob3J0ZW5lZCA8c3BhbiBjbGFzcz0iY2FwcyI+
VVJMPC9zcGFuPiB0byB5b3VyIGFydGljbGUuIE9ubHkgbGl2ZSBhbmQgYWN0aXZlIGFydGlj
bGVzIHdpbGwgYmUgc2VudCB0byBUd2l0dGVyLCA8aT5pLmUuPC9pPiBhcnRpY2xlcyBwb3N0
ZWQgaW4gdGhlIGZ1dHVyZSBvciBhcyBzdGlja3kgYXJ0aWNsZXMgd2lsbCBub3QgYmUgc2Vu
dC4gSWYgeW91ciBhcnRpY2xlIGlzIHN1Y2Nlc3NmdWxseSBzdWJtaXR0ZWQgdG8gVHdpdHRl
ciB0aGUgdXBkYXRlIHdpbGwgYXBwZWFyIGluIHBsYWNlIG9mIHRoZSBUd2l0dGVyIG9wdGlv
biBvbiB0aGUgcmlnaHQtaGFuZC1zaWRlIG9mIHRoZSBhcnRpY2xlIGVkaXQgc2NyZWVuLjwv
cD4KCgk8cD5Ud2VldHMgYXJlIHNlbnQgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6IDxlbT5U
d2VldCBwcmVmaXg8L2VtPiA8ZW0+QXJ0aWNsZSB0aXRsZTwvZW0+IDxlbT5TaG9ydGVuZWQg
PHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj48L2VtPiA8ZW0+VHdlZXQgc3VmZml4PC9l
bT4uIFlvdSBjYW4gY2hhbmdlIHRoZSBwcmVmaXggYW5kIHN1ZmZpeCBvbiBhbiBhcnRpY2xl
LWJ5LWFydGljbGUgYmFzaXMgYnkgY2hhbmdpbmcgdGhlIHR3ZWV0IG9wdGlvbnMgdW5kZXIg
JiM4MjE2O1VwZGF0ZSBUd2l0dGVyJiM4MjE3OyBvbiB0aGUgYXJ0aWNsZSBlZGl0b3Igc2Ny
ZWVuLiBUaGUgZGVmYXVsdCA8ZW0+VHdlZXQgcHJlZml4PC9lbT4gY2FuIGJlIHNldCB1bmRl
ciB0aGUgPHNwYW4gY2xhc3M9InRhZyI+YXJjX3R3aXR0ZXI8L3NwYW4+IHByZWZlcmVuY2Vz
IHNjcmVlbiAodGhlIGRlZmF1bHQgb24gaW5zdGFsbGF0aW9uIGlzICYjODIyMDtKdXN0IHBv
c3RlZDomIzgyMjE7KS48L3A+CgoJPHA+UGxlYXNlIG5vdGUgdGhhdCBvbmNlIGFuIGFydGlj
bGUgaGFzIGJlZW4gdHdlZXRlZCB0aGUgdHdlZXQgY2Fubm90IGJlIGVkaXRlZC48L3A+CgoJ
PGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYWRtaW4iPlRoZSBUd2l0dGVy
IHRhYjwvaDI+CgoJPHA+VW5kZXIgdGhlIEV4dGVuc2lvbnMgdGFiICh0aGlzIGNhbiBiZSBj
aGFuZ2VkIGZyb20gdGhlIHBsdWdpbiYjODIxNztzIHByZWZlcmVuY2UgcGFnZSkgYSBuZXcg
VHdpdHRlciB0YWIgc2hvdWxkIGFwcGVhciBvbmNlIHlvdSBoYXZlIGNvbm5lY3RlZCB5b3Vy
IHNpdGUgdG8geW91ciBUd2l0dGVyIGFjY291bnQuIEZyb20gaGVyZSB5b3Ugd2lsbCBiZSBh
YmxlIHRvIHN1Ym1pdCBuZXcgVHdpdHRlciB1cGRhdGVzLCB2aWV3IGJhc2ljIGFjY291bnQg
c3RhdGlzdGljcywgYW5kIGNoZWNrIG91dCB5b3VyIHJlY2VudCB1cGRhdGVzIChpbmNsdWRp
bmcgdGhlIG9wdGlvbiB0byBkZWxldGUgeW91ciB0d2VldHMpLjwvcD4iO3M6NDoiY29kZSI7
czo3NjIyODoiZ2xvYmFsICRwcmVmcywkdHhwY2ZnLCRhcmNfdHdpdHRlcl9jb25zdW1lcktl
eSwkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgokYXJjX3R3aXR0ZXIgPSBhcnJheSgp
OwoKJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5ID0gJ25LY1hzbHd6WmhCZDBrZktNZXRuUEEn
OwokYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQgPSAnQzZuU1BDTDNlZUhHVEJoS0Nnd2Q5
b2NsY3VEMHNyQjhXVmtmWFFZQzU0JzsKCmFkZF9wcml2cygncGx1Z2luX3ByZWZzLmFyY190
d2l0dGVyJywnMSwyJyk7CnJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfdHdpdHRlcl9pbnN0YWxs
JywncGx1Z2luX2xpZmVjeWNsZS5hcmNfdHdpdHRlcicsICdpbnN0YWxsZWQnKTsKcmVnaXN0
ZXJfY2FsbGJhY2soJ2FyY190d2l0dGVyX3VuaW5zdGFsbCcsJ3BsdWdpbl9saWZlY3ljbGUu
YXJjX3R3aXR0ZXInLCAnZGVsZXRlZCcpOwpyZWdpc3Rlcl9jYWxsYmFjaygnYXJjX3R3aXR0
ZXJfcHJlZnMnLCdwbHVnaW5fcHJlZnMuYXJjX3R3aXR0ZXInKTsKCi8qCiAqIFNldHVwIGlu
aXRpYWwgcHJlZmVyZW5jZXMgaWYgbm90IGluIHRoZSB0eHBfcHJlZnMgdGFibGUuCiAqLwpp
ZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddKSkKICAgIHNldF9wcmVmKCdh
cmNfdHdpdHRlcl91c2VyJywgJycsICdhcmNfdHdpdHRlcicsIDEsICd0ZXh0X2lucHV0Jyk7
CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl9wcmVmaXgnXSkpCiAgc2V0X3ByZWYo
J2FyY190d2l0dGVyX3ByZWZpeCcsJ0p1c3QgcG9zdGVkOicsICdhcmNfdHdpdHRlcicsIDIs
ICd0ZXh0X2lucHV0Jyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl9zdWZmaXgn
XSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3N1ZmZpeCcsJycsICdhcmNfdHdpdHRlcics
IDIsICd0ZXh0X2lucHV0Jyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl9jYWNo
ZV9kaXInXSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX2NhY2hlX2RpcicsJHR4cGNmZ1sn
dHhwYXRoJ10uJHByZWZzWyd0ZW1wZGlyJ10sICdhcmNfdHdpdHRlcicsIDEsICd0ZXh0X2lu
cHV0Jyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0J10p
KQogIHNldF9wcmVmKCdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0JywgMSwgJ2FyY190d2l0
dGVyJywgMiwgJ3llc25vUmFkaW8nKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVy
X3VybF9tZXRob2QnXSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3VybF9tZXRob2QnLCAn
dGlueXVybCcsICdhcmNfdHdpdHRlcicsIDIsCiAgICAnYXJjX3R3aXR0ZXJfdXJsX21ldGhv
ZF9zZWxlY3QnKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY19zaG9ydF91cmwnXSkpCiAgc2V0
X3ByZWYoJ2FyY19zaG9ydF91cmwnLCAwLCAnYXJjX3R3aXR0ZXInLCAyLCAneWVzbm9SYWRp
bycpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3Nob3J0X3NpdGVfdXJsJ10pKQogIHNldF9w
cmVmKCdhcmNfc2hvcnRfc2l0ZV91cmwnLCAkcHJlZnNbJ3NpdGV1cmwnXSwgJ2FyY190d2l0
dGVyJywgMiwgJ3RleHRfaW5wdXQnKTsKLy8gTWFrZSBzdXJlIHRoYXQgdGhlIFR3aXR0ZXIg
dGFiIGhhcyBiZWVuIGRlZmluZWQKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX3Rh
YiddKSkgewogIHNldF9wcmVmKCdhcmNfdHdpdHRlcl90YWInLCAnZXh0ZW5zaW9ucycsICdh
cmNfdHdpdHRlcicsIDIsCiAgICAnYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCcpOwogICAgJHBy
ZWZzWydhcmNfdHdpdHRlcl90YWInXSA9ICdleHRlbnNpb25zJzsKfQoKLy8gQ2hlY2sgaWYg
YXJjX3Nob3J0X3VybCBpcyBlbmFibGVkCmlmICgoaXNzZXQoJHByZWZzWydhcmNfc2hvcnRf
dXJsJ10pJiYkcHJlZnNbJ2FyY19zaG9ydF91cmwnXSkKfHwgKGlzc2V0KCRwcmVmc1snYXJj
X3Nob3J0X3VybF9tZXRob2QnXSkmJiRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCdd
PT0nYXJjX3R3aXR0ZXInKSkgewogIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfc2hvcnRfdXJs
X3JlZGlyZWN0JywgJ3R4cF9kaWUnLCA0MDQpOwp9CgppZiAoQHR4cGludGVyZmFjZSA9PSAn
YWRtaW4nKSB7CiAgICByZWdpc3Rlcl9jYWxsYmFjaygnX2FyY190d2l0dGVyX2F1dG9fZW5h
YmxlJywgJ3BsdWdpbl9saWZlY3ljbGUuYXJjX3R3aXR0ZXInLCAnaW5zdGFsbGVkJyk7CiAg
ICBpZiAoIWVtcHR5KCRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddKQogICAgICAgICYmICFl
bXB0eSgkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10pCiAgICAgICAgJiYgIWVt
cHR5KCRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSkgKSB7CgogICAg
ICAgIGlmICgkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddKSB7CiAgICAgICAgICAgIGFkZF9w
cml2cygnYXJjX2FkbWluX3R3aXR0ZXInLCAnMSwyLDMsNCcpOwogICAgICAgICAgICByZWdp
c3Rlcl90YWIoJHByZWZzWydhcmNfdHdpdHRlcl90YWInXSwgJ2FyY19hZG1pbl90d2l0dGVy
JywgJ1R3aXR0ZXInKTsKICAgICAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hZG1p
bl90d2l0dGVyJywgJ2FyY19hZG1pbl90d2l0dGVyJyk7CiAgICAgICAgfQoKICAgICAgICBy
ZWdpc3Rlcl9jYWxsYmFjaygnYXJjX2FydGljbGVfdHdlZXQnLCAncGluZycpOwogICAgICAg
IHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYXJ0aWNsZV90d2VldCcsICdhcnRpY2xlJywgJ2Vk
aXQnLCAxKTsKICAgICAgICByZWdpc3Rlcl9jYWxsYmFjaygnYXJjX2FwcGVuZF90d2l0dGVy
JywgJ2FydGljbGVfdWknLCAnc3RhdHVzJyk7CiAgICB9Cn0KCi8qCiAgICBQdWJsaWMtc2lk
ZSBmdW5jdGlvbnMKICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT0KKi8KCmZ1bmN0aW9uIGFyY190d2l0dGVyKCRh
dHRzKQp7CiAgZ2xvYmFsICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNf
dHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICd1
c2VyJyAgICAgID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLAogICAgJ3Bhc3N3b3Jk
JyAgPT4gJycsCiAgICAndGltZWxpbmUnICA9PiAndXNlcicsCiAgICAnbGltaXQnICAgICA9
PiAnMTAnLAogICAgJ3JldHdlZXRzJyAgPT4gZmFsc2UsCiAgICAnZGF0ZWZvcm1hdCc9PiAk
cHJlZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCddLAogICAgJ2NhY2hpbmcnICAgPT4gJzEnLAog
ICAgJ2NhY2hlX2RpcicgPT4gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXSwKICAg
ICdjYWNoZV90aW1lJz0+ICc1JywKICAgICdsYWJlbCcgICAgID0+ICcnLAogICAgJ2xhYmVs
dGFnJyAgPT4gJycsCiAgICAnYnJlYWsnICAgICA9PiAnbGknLAogICAgJ3dyYXB0YWcnICAg
PT4gJycsCiAgICAnY2xhc3MnICAgICA9PiBfX0ZVTkNUSU9OX18sCiAgICAnY2xhc3NfcG9z
dGVkJyA9PiBfX0ZVTkNUSU9OX18uJy1wb3N0ZWQnCiAgICApLCRhdHRzKSk7CgogICR0d2l0
ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAg
ICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCwgJHByZWZzWydhcmNfdHdpdHRlcl9h
Y2Nlc3NUb2tlbiddCiAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NU
b2tlblNlY3JldCddKTsKCiAgaWYgKCRjYWNoaW5nKSB7ICAvLyB0dXJuIG9uIGNhY2hpbmcs
IHJlY29tbWVuZGVkIChkZWZhdWx0KQogICAgJHR3aXQtPnNldENhY2hpbmcodHJ1ZSk7CiAg
ICAkdHdpdC0+Y2FjaGVEaXIoJGNhY2hlX2Rpcik7CiAgICAkdHdpdC0+Y2FjaGVUaW1lKCRj
YWNoZV90aW1lKTsKICB9IGVsc2UgeyAgLy8gdHVybiBvZmYgY2FjaGluZywgbm90IHJlY29t
bWVuZGVkIG90aGVyIHRoYW4gZm9yIHRlc3RpbmcKICAgICR0d2l0LT5zZXRDYWNoaW5nKGZh
bHNlKTsKICB9CgogIHN3aXRjaCAoJHRpbWVsaW5lKSB7CiAgICBjYXNlICdob21lJzogY2Fz
ZSAnZnJpZW5kcyc6CiAgICAgICR0aW1lbGluZSA9ICdzdGF0dXNlcy9mcmllbmRzX3RpbWVs
aW5lJzsgYnJlYWs7CiAgICBjYXNlICdtZW50aW9ucyc6CiAgICAgICR0aW1lbGluZSA9ICdz
dGF0dXNlcy9tZW50aW9ucyc7IGJyZWFrOwogICAgY2FzZSAndXNlcic6IGRlZmF1bHQ6ICR0
aW1lbGluZSA9ICdzdGF0dXNlcy91c2VyX3RpbWVsaW5lJzsKICB9CgogICRvdXQgPSBhcnJh
eSgpOwogICR4bWwgPSAkdHdpdC0+Z2V0KCR0aW1lbGluZQogICAgLCBhcnJheSgnc2NyZWVu
X25hbWUnPT4kdXNlciwnY291bnQnPT4kbGltaXQsJ2luY2x1ZGVfcnRzJz0+JHJldHdlZXRz
KSk7CiAgaWYgKCR4bWwpIHsKICAgICR0d2VldHMgPSBAJHhtbC0+eHBhdGgoJy9zdGF0dXNl
cy9zdGF0dXMnKTsKICAgIGlmICgkdHdlZXRzKSBmb3JlYWNoICgkdHdlZXRzIGFzICR0d2Vl
dCkgewogICAgICAkdGltZSA9IHN0cnRvdGltZShodG1sZW50aXRpZXMoJHR3ZWV0LT5jcmVh
dGVkX2F0KSk7CiAgICAgICRkYXRlID0gc2FmZV9zdHJmdGltZSgkZGF0ZWZvcm1hdCwkdGlt
ZSk7CiAgICAgICRvdXRbXSA9IGFyY19Ud2l0dGVyOjptYWtlTGlua3MoaHRtbGVudGl0aWVz
KCR0d2VldC0+dGV4dCwgRU5UX1FVT1RFUywnVVRGLTgnKSkKICAgICAgICAuJyAnLnRhZyho
dG1sZW50aXRpZXMoJGRhdGUpLCdzcGFuJywnIGNsYXNzPSInLiRjbGFzc19wb3N0ZWQuJyIn
KTsKICAgIH0KCiAgICByZXR1cm4gZG9MYWJlbCgkbGFiZWwsICRsYWJlbHRhZykuZG9XcmFw
KCRvdXQsICR3cmFwdGFnLCAkYnJlYWssICRjbGFzcyk7CiAgfQoKfQoKZnVuY3Rpb24gYXJj
X3R3aXR0ZXJfc2VhcmNoKCRhdHRzKQp7CiAgICBnbG9iYWwgJHByZWZzLCRhcmNfdHdpdHRl
cl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgIGV4dHJh
Y3QobEF0dHMoYXJyYXkoCiAgICAgICAgJ3VzZXInICAgICAgPT4gJHByZWZzWydhcmNfdHdp
dHRlcl91c2VyJ10sCiAgICAgICAgJ3NlYXJjaCcgICAgPT4gJycsCiAgICAgICAgJ2hhc2h0
YWdzJyAgPT4gJycsCiAgICAgICAgJ3VzZXInICAgICAgPT4gJycsCiAgICAgICAgJ3JlcGx5
JyAgICAgPT4gJycsCiAgICAgICAgJ21lbnRpb24nICAgPT4gJycsCiAgICAgICAgJ2xpbWl0
JyAgICAgPT4gJzEwJywKICAgICAgICAnbGFuZycgICAgICA9PiAnJywKICAgICAgICAnZGF0
ZWZvcm1hdCc9PiAkcHJlZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCddLAogICAgICAgICdjYWNo
aW5nJyAgID0+ICcxJywKICAgICAgICAnY2FjaGVfZGlyJyA9PiAkcHJlZnNbJ2FyY190d2l0
dGVyX2NhY2hlX2RpciddLAogICAgICAgICdjYWNoZV90aW1lJz0+ICc1JywKICAgICAgICAn
bGFiZWwnICAgICA9PiAnJywKICAgICAgICAnbGFiZWx0YWcnICA9PiAnJywKICAgICAgICAn
YnJlYWsnICAgICA9PiAnbGknLAogICAgICAgICd3cmFwdGFnJyAgID0+ICcnLAogICAgICAg
ICdjbGFzcycgICAgID0+IF9fRlVOQ1RJT05fXywKICAgICAgICAnY2xhc3NfcG9zdGVkJyA9
PiBfX0ZVTkNUSU9OX18uJy1wb3N0ZWQnLAogICAgICAgICdjbGFzc191c2VyJyAgID0+IF9f
RlVOQ1RJT05fXy4nLXVzZXInCiAgICApLCRhdHRzKSk7CgogICAgICAgICR0d2l0ID0gbmV3
IGFyY19Ud2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAsICRh
cmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCk7CgogICAgICAgIGlmICgkY2FjaGluZykgeyAg
Ly8gdHVybiBvbiBjYWNoaW5nLCByZWNvbW1lbmRlZCAoZGVmYXVsdCkKICAgICAgICAgICAg
JHR3aXQtPnNldENhY2hpbmcodHJ1ZSk7CiAgICAgICAgICAgICR0d2l0LT5jYWNoZURpcigk
Y2FjaGVfZGlyKTsKICAgICAgICAgICAgJHR3aXQtPmNhY2hlVGltZSgkY2FjaGVfdGltZSk7
CiAgICAgICAgfSBlbHNlIHsgIC8vIHR1cm4gb2ZmIGNhY2hpbmcsIG5vdCByZWNvbW1lbmRl
ZCBvdGhlciB0aGFuIGZvciB0ZXN0aW5nCiAgICAgICAgICAgICR0d2l0LT5zZXRDYWNoaW5n
KGZhbHNlKTsKICAgICAgICB9CgogICAgICAgIC8vIGNvbnN0cnVjdCBzZWFyY2ggcXVlcnkK
ICAgICAgICBpZiAoIWVtcHR5KCRzZWFyY2gpKSB7CiAgICAgICAgICAgICR0ZXJtcyA9IGV4
cGxvZGUoJywnLCRzZWFyY2gpOyAkdGVybXMgPSBhcnJheV9tYXAoJ3RyaW0nLCR0ZXJtcyk7
CiAgICAgICAgICAgICRzZWFyY2ggPSBpbXBsb2RlKCcgJywkdGVybXMpOwogICAgICAgIH0K
ICAgICAgICBpZiAoJGhhc2h0YWdzKSB7CiAgICAgICAgICAgICRoYXNoZXMgPSBleHBsb2Rl
KCcsJywkaGFzaHRhZ3MpOyAkaGFzaGVzID0gYXJyYXlfbWFwKCd0cmltJywkaGFzaGVzKTsK
ICAgICAgICAgICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/JyAnOicnKS4nIycuaW1wbG9kZSgn
ICMnLCRoYXNoZXMpOwogICAgICAgIH0KICAgICAgICBpZiAoJHJlcGx5KSB7CiAgICAgICAg
ICAgICRzZWFyY2guPSAoKCRzZWFyY2gpPycgJzonJykuJ3RvOicudHJpbSgkcmVwbHkpOwog
ICAgICAgIH0KICAgICAgICBpZiAoJHVzZXIpIHsKICAgICAgICAgICAgJHNlYXJjaC49ICgo
JHNlYXJjaCk/JyAnOicnKS4nZnJvbTonLnRyaW0oJHVzZXIpOwogICAgICAgIH0KICAgICAg
ICBpZiAoJG1lbnRpb24pIHsKICAgICAgICAgICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/JyAn
OicnKS4nQCcudHJpbSgkbWVudGlvbik7CiAgICAgICAgfQoKICAgICAgICBpZiAoZW1wdHko
JHNlYXJjaCkpIHsKICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0gZWxzZSB7CiAg
ICAgICAgICAgICRzZWFyY2ggPSB1cmxlbmNvZGUoJHNlYXJjaCk7CiAgICAgICAgfQoKICAg
ICAgICAkb3V0ID0gYXJyYXkoKTsKICAgICAgICAkdHdlZXRzID0gJHR3aXQtPmdldCgnaHR0
cDovL3NlYXJjaC50d2l0dGVyLmNvbS9zZWFyY2guYXRvbT9xPScuJHNlYXJjaAogICAgICAg
ICAgICAsIGFycmF5KCdycHAnPT4kbGltaXQsJ2xhbmcnPT4kbGFuZykpOwoKICAgICAgICBp
ZiAoJHR3ZWV0cykgeyBmb3JlYWNoICgkdHdlZXRzLT5lbnRyeSBhcyAkdHdlZXQpIHsKICAg
ICAgICAgICAgcHJlZ19tYXRjaCgiLyguKikgXCgoLiopXCkvIiwkdHdlZXQtPmF1dGhvci0+
bmFtZSwkbWF0Y2hlcyk7CiAgICAgICAgICAgIGxpc3QoJGF1dGhvciwkdW5hbWUsJG5hbWUp
ID0gJG1hdGNoZXM7CiAgICAgICAgICAgICR0aW1lID0gc3RydG90aW1lKGh0bWxlbnRpdGll
cygkdHdlZXQtPnB1Ymxpc2hlZCkpOwogICAgICAgICAgICAkZGF0ZSA9IHNhZmVfc3RyZnRp
bWUoJGRhdGVmb3JtYXQsJHRpbWUpOwogICAgICAgICAgICAkdGV4dCA9ICR0d2VldC0+dGl0
bGU7CiAgICAgICAgICAgICRvdXRbXSA9IHRhZyhocmVmKGh0bWxlbnRpdGllcygkdW5hbWUp
LCR0d2VldC0+YXV0aG9yLT51cmksCiAgICAgICAgICAgICAgICAnIHRpdGxlPSInLmh0bWxl
bnRpdGllcygkbmFtZSkuJyInKS4nOiAnLCdzcGFuJwogICAgICAgICAgICAgICAgICAgICwn
IGNsYXNzPSInLiRjbGFzc191c2VyLiciJykKICAgICAgICAgICAgICAgIC5hcmNfVHdpdHRl
cjo6bWFrZUxpbmtzKGh0bWxlbnRpdGllcygkdGV4dCwgRU5UX1FVT1RFUywnVVRGLTgnKSkK
ICAgICAgICAgICAgICAgIC4nICcudGFnKGh0bWxlbnRpdGllcygkZGF0ZSksJ3NwYW4nCiAg
ICAgICAgICAgICAgICAgICAgLCcgY2xhc3M9IicuJGNsYXNzX3Bvc3RlZC4nIicpOwogICAg
ICAgIH0gcmV0dXJuIGRvTGFiZWwoJGxhYmVsLCAkbGFiZWx0YWcpCiAgICAgICAgICAgIC5k
b1dyYXAoJG91dCwgJHdyYXB0YWcsICRicmVhaywgJGNsYXNzKTsgfQoKfQoKZnVuY3Rpb24g
YXJjX3R3aXR0ZXJfdHdlZXQoJGF0dHMpIHsKICAgIGdsb2JhbCAkdGhpc2FydGljbGU7Cgog
ICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgJ2lkJyAgICAgICAgPT4gJHRoaXNhcnRp
Y2xlWyd0aGlzaWQnXSwKICAgICAgJ2luY2x1ZGVfdXJsJyAgID0+IHRydWUKICAgICksJGF0
dHMpKTsKCiAgICBpZiAoJGlkKSB7CiAgICAgIC8vIEZldGNoIGFyY190d2l0dGVyIHN0dWZm
IHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAgICAgJHR3ZWV0ID0gKCRpbmNsdWRlX3VybCkgPyBz
YWZlX3JvdygidHdlZXQiLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlkfSIpCiAg
ICAgICAgOiBzYWZlX3JvdygiUkVQTEFDRSh0d2VldCxDT05DQVQoJyAnLHRpbnl1cmwpLCcn
KSBBUyB0d2VldCIKICAgICAgICAgICwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRp
ZH0iKTsKICAgIH0KCiAgICBpZiAoJHR3ZWV0Wyd0d2VldCddKSB7CiAgICAgIHJldHVybiBh
cmNfVHdpdHRlcjo6bWFrZUxpbmtzKAogICAgICAgIGh0bWxlbnRpdGllcygkdHdlZXRbJ3R3
ZWV0J10sIEVOVF9RVU9URVMsJ1VURi04JykpOwogICAgfQp9CgpmdW5jdGlvbiBhcmNfdHdp
dHRlcl90d2VldF91cmwoJGF0dHMsICR0aGluZz1udWxsKSB7CiAgICBnbG9iYWwgJHRoaXNh
cnRpY2xlLCRwcmVmczsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAnaWQnICAg
ICAgPT4gJHRoaXNhcnRpY2xlWyd0aGlzaWQnXSwKICAgICAgJ3RpdGxlJyAgID0+ICcnLAog
ICAgICAnY2xhc3MnICAgPT4gJycKICAgICksJGF0dHMpKTsKCiAgICBpZiAoJGlkKSB7CiAg
ICAgIC8vIEZldGNoIGFyY190d2l0dGVyIHN0dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAg
ICAgJHR3ZWV0ID0gc2FmZV9yb3coInR3ZWV0X2lkIgogICAgICAgICwgJ2FyY190d2l0dGVy
JywgImFydGljbGVfaWQ9eyRpZH0iKTsKICAgIH0KCiAgICBpZiAoJHR3ZWV0Wyd0d2VldF9p
ZCddKSB7CiAgICAgICR1cmwgPSAiaHR0cDovL3R3aXR0ZXIuY29tLyIuJHByZWZzWydhcmNf
dHdpdHRlcl91c2VyJ10uIi9zdGF0dXMvIi4kdHdlZXRbJ3R3ZWV0X2lkJ107CiAgICAgIGlm
ICgkdGhpbmc9PT1udWxsKSB7CiAgICAgICAgcmV0dXJuICR1cmw7CiAgICAgIH0KICAgICAg
cmV0dXJuIGhyZWYocGFyc2UoJHRoaW5nKSwgJHVybCwKICAgICAgICAoJHRpdGxlID8gJyB0
aXRsZT0iJy4kdGl0bGUuJyInIDogJycpCiAgICAgICAgLigkY2xhc3MgPyAnIGNsYXNzPSIn
LiRjbGFzcy4nIicgOiAnJykpOwogICAgfQp9CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl90aW55
dXJsKCRhdHRzLCAkdGhpbmc9bnVsbCkgewogICAgZ2xvYmFsICR0aGlzYXJ0aWNsZTsKCiAg
ICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAnaWQnICAgICAgPT4gJHRoaXNhcnRpY2xl
Wyd0aGlzaWQnXSwKICAgICAgJ3RpdGxlJyAgID0+ICcnLAogICAgICAnY2xhc3MnICAgPT4g
JycKICAgICksJGF0dHMpKTsKCiAgICBpZiAoJGlkKSB7CiAgICAgIC8vIEZldGNoIGFyY190
d2l0dGVyIHN0dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAgICAgJHR3ZWV0ID0gc2FmZV9y
b3coInRpbnl1cmwiCiAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlk
fSIpOwogICAgfQoKICAgIGlmICgkdHdlZXRbJ3Rpbnl1cmwnXSkgewogICAgICBpZiAoJHRo
aW5nPT09bnVsbCkgewogICAgICAgIHJldHVybiAkdHdlZXRbJ3Rpbnl1cmwnXTsKICAgICAg
fQoKICAgICAgcmV0dXJuIGhyZWYocGFyc2UoJHRoaW5nKSwgJHR3ZWV0Wyd0aW55dXJsJ10s
CiAgICAgICAgKCR0aXRsZSA/ICcgdGl0bGU9IicuJHRpdGxlLiciJyA6ICcnKQogICAgICAg
IC4oJGNsYXNzID8gJyBjbGFzcz0iJy4kY2xhc3MuJyInIDogJycpKTsKICAgIH0KfQoKLyoK
ICogUHVibGljIHRhZyBmb3Igb3V0cHV0dGluZyB3aWRnZXQgSlMKICovCmZ1bmN0aW9uIGFy
Y190d2l0dGVyX3dpZGdldF9qcygkYXR0cykKewogIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAg
ICAgICAgJ29wdGltaXNlJyA9PiBmYWxzZQogICAgKSwkYXR0cykpOwoKICByZXR1cm4gX2Fy
Y190d2l0dGVyX3dpZGdldF9qcygkb3B0aW1pc2UpOwp9CgpmdW5jdGlvbiBfYXJjX3R3aXR0
ZXJfd2lkZ2V0X2pzKCRvcHRpbWlzZT10cnVlKQp7CiAgZ2xvYmFsICRhcmNfdHdpdHRlcjsK
CiAgLy8gQ2hlY2sgaWYgd2lkZ2V0IEpTIGhhcyBhbHJlYWR5IGJlZW4gb3V0cHV0CiAgaWYg
KCRhcmNfdHdpdHRlclsnd2lkZ2V0X2pzJ10pIHJldHVybjsKCiAgaWYgKCRvcHRpbWlzZT09
ZmFsc2UpIHsKICAgIHJldHVybiAnPHNjcmlwdCBzcmM9Imh0dHA6Ly9wbGF0Zm9ybS50d2l0
dGVyLmNvbS93aWRnZXRzLmpzIiB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPjwvc2NyaXB0Pic7
CiAgfQoKICAkanMgPSA8PDxKUwo8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+Cihm
dW5jdGlvbigpIHsKICBpZiAod2luZG93Ll9fdHdpdHRlckludGVudEhhbmRsZXIpIHJldHVy
bjsKICB2YXIgaW50ZW50UmVnZXggPSAvdHdpdHRlclwuY29tKFw6XGR7Miw0fSk/XC9pbnRl
bnRcLyhcdyspLywKICAgICAgd2luZG93T3B0aW9ucyA9ICdzY3JvbGxiYXJzPXllcyxyZXNp
emFibGU9eWVzLHRvb2xiYXI9bm8sbG9jYXRpb249eWVzJywKICAgICAgd2lkdGggPSA1NTAs
CiAgICAgIGhlaWdodCA9IDQyMCwKICAgICAgd2luSGVpZ2h0ID0gc2NyZWVuLmhlaWdodCwK
ICAgICAgd2luV2lkdGggPSBzY3JlZW4ud2lkdGg7CgogIGZ1bmN0aW9uIGhhbmRsZUludGVu
dChlKSB7CiAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7CiAgICB2YXIgdGFyZ2V0ID0gZS50
YXJnZXQgfHwgZS5zcmNFbGVtZW50LAogICAgICAgIG0sIGxlZnQsIHRvcDsKCiAgICB3aGls
ZSAodGFyZ2V0ICYmIHRhcmdldC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpICE9PSAnYScpIHsK
ICAgICAgdGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGU7CiAgICB9CgogICAgaWYgKHRhcmdl
dCAmJiB0YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2EnICYmIHRhcmdldC5o
cmVmKSB7CiAgICAgIG0gPSB0YXJnZXQuaHJlZi5tYXRjaChpbnRlbnRSZWdleCk7CiAgICAg
IGlmIChtKSB7CiAgICAgICAgbGVmdCA9IE1hdGgucm91bmQoKHdpbldpZHRoIC8gMikgLSAo
d2lkdGggLyAyKSk7CiAgICAgICAgdG9wID0gMDsKCiAgICAgICAgaWYgKHdpbkhlaWdodCA+
IGhlaWdodCkgewogICAgICAgICAgdG9wID0gTWF0aC5yb3VuZCgod2luSGVpZ2h0IC8gMikg
LSAoaGVpZ2h0IC8gMikpOwogICAgICAgIH0KCiAgICAgICAgd2luZG93Lm9wZW4odGFyZ2V0
LmhyZWYsICdpbnRlbnQnLCB3aW5kb3dPcHRpb25zICsgJyx3aWR0aD0nICsgd2lkdGggKwog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyxoZWlnaHQ9JyAr
IGhlaWdodCArICcsbGVmdD0nICsgbGVmdCArICcsdG9wPScgKyB0b3ApOwogICAgICAgIGUu
cmV0dXJuVmFsdWUgPSBmYWxzZTsKICAgICAgICBlLnByZXZlbnREZWZhdWx0ICYmIGUucHJl
dmVudERlZmF1bHQoKTsKICAgICAgfQogICAgfQogIH0KCiAgaWYgKGRvY3VtZW50LmFkZEV2
ZW50TGlzdGVuZXIpIHsKICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywg
aGFuZGxlSW50ZW50LCBmYWxzZSk7CiAgfSBlbHNlIGlmIChkb2N1bWVudC5hdHRhY2hFdmVu
dCkgewogICAgZG9jdW1lbnQuYXR0YWNoRXZlbnQoJ29uY2xpY2snLCBoYW5kbGVJbnRlbnQp
OwogIH0KICB3aW5kb3cuX190d2l0dGVySW50ZW50SGFuZGxlciA9IHRydWU7Cn0oKSk7Cjwv
c2NyaXB0PgpKUzsKICAkYXJjX3R3aXR0ZXJbJ3dpZGdldF9qcyddID0gdHJ1ZTsKICByZXR1
cm4gJGpzOwp9CgovLyBEZXByZWNhdGVkIGFyY190d2l0dGVyX3JldHdlZXQgdGFnLCB1c2Ug
YXJjX3R3aXR0ZXJfdHdlZXRfYnV0dG9uIGluc3RlYWQKZnVuY3Rpb24gYXJjX3R3aXR0ZXJf
cmV0d2VldCgkYXR0cywgJHRoaW5nPW51bGwpCnsKICByZXR1cm4gYXJjX3R3aXR0ZXJfdHdl
ZXRfYnV0dG9uKCRhdHRzLCAkdGhpbmc9bnVsbCk7Cn0KZnVuY3Rpb24gYXJjX3R3aXR0ZXJf
dHdlZXRfYnV0dG9uKCRhdHRzLCAkdGhpbmc9bnVsbCkKewogICAgZ2xvYmFsICRwcmVmcywk
YXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsK
ICAgIGdsb2JhbCAkdGhpc2FydGljbGU7CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAg
ICAgICAndXNlcicgICAgICAgID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLCAvLyB2
aWEgdXNlciBhY2NvdW50CiAgICAgICAgJ3VybCcgICAgICAgICA9PiAnJywKICAgICAgICAn
dGV4dCcgICAgICAgID0+ICcnLAogICAgICAgICdmb2xsb3cxJyAgICAgPT4gJycsCiAgICAg
ICAgJ2ZvbGxvdzInICAgICA9PiAnJywKICAgICAgICAnbGFuZycgICAgICAgID0+ICcnLAog
ICAgICAgICdjb3VudCcgICAgICAgPT4gJ2hvcml6b250YWwnLAogICAgICAgICdpbmNsdWRl
X2pzJyAgPT4gdHJ1ZSwKICAgICAgICAnb3B0aW1pc2VfanMnID0+IGZhbHNlLAogICAgICAg
ICd3cmFwdGFnJyAgICAgPT4gJycsCiAgICAgICAgJ2NsYXNzJyAgICAgICA9PiAndHdpdHRl
ci1zaGFyZS1idXR0b24nCiAgICApLCRhdHRzKSk7CgogICAgJHEgPSAnJzsgLy8gcXVlcnkg
c3RyaW5nCgogICAgaWYgKCRpZD0kdGhpc2FydGljbGVbJ3RoaXNpZCddKSB7CiAgICAgIC8v
IEZldGNoIGFyY190d2l0dGVyIHN0dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAgICAgJHJv
dyA9IHNhZmVfcm93KCJSRVBMQUNFKHR3ZWV0LENPTkNBVCgnICcsdGlueXVybCksJycpIEFT
IHR3ZWV0LHRpbnl1cmwiCiAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17
JGlkfSIpOwoKICAgICAgaWYgKCR1cmw9PScnKSB7CiAgICAgICAgJHVybCA9ICgkdXJsKSA/
ICR1cmwgOiBwZXJtbGlua3VybCgkdGhpc2FydGljbGUpOwogICAgICAgICRxID0gJ3VybD0n
LnVybGVuY29kZSgkdXJsKTsKICAgICAgfQogICAgICBpZiAoJHRleHQ9PScnKSB7CiAgICAg
ICAgJHRleHQgPSAoJHJvd1sndHdlZXQnXSkgPyAkcm93Wyd0d2VldCddIDogJHRoaXNhcnRp
Y2xlWyd0aXRsZSddOwogICAgICB9CiAgICAgICRxIC49ICgkcSA/ICcmYW1wOycgOiAnJyku
J3RleHQ9Jy51cmxlbmNvZGUoJHRleHQpOwogICAgfQogICAgaWYgKCR1c2VyKSB7CiAgICAg
ICRxIC49ICgkcSA/ICcmYW1wOycgOiAnJykuJ3ZpYT0nLnVybGVuY29kZSgkdXNlcik7CiAg
ICB9CiAgICBpZiAoJGZvbGxvdzEmJiRmb2xsb3cyKSB7CiAgICAgICRxIC49ICgkcSA/ICcm
YW1wOycgOiAnJykuJ3JlbGF0ZWQ9Jy51cmxlbmNvZGUoJGZvbGxvdzEuJzonLiRmb2xsb3cy
KTsKICAgIH0gZWxzZWlmICgkZm9sbG93MXx8JGZvbGxvdzIpIHsKICAgICAgJHEgLj0gKCRx
ID8gJyZhbXA7JyA6ICcnKS4ncmVsYXRlZD0nLnVybGVuY29kZSgkZm9sbG93MS4kZm9sbG93
Mik7CiAgICB9CgogICAgc3dpdGNoICgkbGFuZykgewogICAgICBjYXNlICdmcic6IGJyZWFr
OyBjYXNlICdkZSc6IGJyZWFrOyBjYXNlICdlcyc6IGJyZWFrOyBjYXNlICdqcCc6IGJyZWFr
OwogICAgICBkZWZhdWx0OgogICAgICAgICRsYW5nID0gJ2VuJzsKICAgIH0KICAgICRxIC49
ICgkcSA/ICcmYW1wOycgOiAnJykuJ2xhbmc9Jy51cmxlbmNvZGUoJGxhbmcpOwoKICAgIHN3
aXRjaCAoJGNvdW50KSB7CiAgICAgIGNhc2UgJ25vbmUnOiBicmVhazsgY2FzZSAndmVydGlj
YWwnOiBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICAkY291bnQgPSAnaG9yaXpvbnRh
bCc7CiAgICB9CiAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidjb3VudD0nLnVybGVu
Y29kZSgkY291bnQpOwoKICAgICR0aGluZyA9ICgkdGhpbmc9PT1udWxsKSA/ICdUd2VldCcg
OiBwYXJzZSgkdGhpbmcpOwoKICAgICRodG1sID0gaHJlZigkdGhpbmcsJ2h0dHA6Ly90d2l0
dGVyLmNvbS9zaGFyZT8nLiRxCiAgICAgICwgJyBjbGFzcz0iJy4kY2xhc3MuJyInKTsKCiAg
ICAkanMgPSAoJGluY2x1ZGVfanMpID8gX2FyY190d2l0dGVyX3dpZGdldF9qcygkb3B0aW1p
c2VfanM/dHJ1ZTpmYWxzZSkgOiAnJzsKCiAgICByZXR1cm4gJGpzLiRodG1sOwp9CgovKgog
KiBUd2l0dGVyIEZvbGxvdyBidXR0b24KICovCmZ1bmN0aW9uIGFyY190d2l0dGVyX2ZvbGxv
d19idXR0b24oJGF0dHMsICR0aGluZz1udWxsKQp7CiAgICBnbG9iYWwgJHByZWZzLCRhcmNf
dHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwogICAg
Z2xvYmFsICR0aGlzYXJ0aWNsZTsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAg
ICd1c2VyJyAgICAgICAgPT4gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sIC8vIHZpYSB1
c2VyIGFjY291bnQKICAgICAgICAnbGFuZycgICAgICAgID0+ICcnLAogICAgICAgICdjb3Vu
dCcgICAgICAgPT4gdHJ1ZSwKICAgICAgICAnaW5jbHVkZV9qcycgID0+IHRydWUsCiAgICAg
ICAgJ29wdGltaXNlX2pzJyA9PiBmYWxzZSwKICAgICAgICAnY2xhc3MnICAgICAgID0+ICd0
d2l0dGVyLWZvbGxvdy1idXR0b24nCiAgICApLCRhdHRzKSk7CgogICAgJGF0dHMgPSAnJzsg
Ly8gZGF0YSBhdHRyaWJ1dGVzCgogICAgc3dpdGNoICgkbGFuZykgewogICAgICBjYXNlICdm
cic6IGJyZWFrOyBjYXNlICdkZSc6IGJyZWFrOyBjYXNlICdlcyc6IGJyZWFrOyBjYXNlICdq
cCc6IGJyZWFrOwogICAgICBkZWZhdWx0OgogICAgICAgICRsYW5nID0gJ2VuJzsKICAgIH0K
ICAgICRhdHRzIC49ICcgZGF0YS1sYW5nPSInLnVybGVuY29kZSgkbGFuZykuJyInOwoKICAg
ICRhdHRzIC49ICcgZGF0YS1zaG93LWNvdW50PSInLigkY291bnQ/J3RydWUnOidmYWxzZScp
LiciJzsKCiAgICAkdGhpbmcgPSAoJHRoaW5nPT09bnVsbCkgPyAnRm9sbG93IEAnLiR1c2Vy
IDogcGFyc2UoJHRoaW5nKTsKCiAgICAkaHRtbCA9IGhyZWYoJHRoaW5nLCdodHRwOi8vdHdp
dHRlci5jb20vJy51cmxlbmNvZGUoJHVzZXIpCiAgICAgICwgJyBjbGFzcz0iJy4kY2xhc3Mu
JyInLiRhdHRzKTsKCiAgICAkanMgPSAoJGluY2x1ZGVfanMpID8gX2FyY190d2l0dGVyX3dp
ZGdldF9qcygkb3B0aW1pc2VfanM/dHJ1ZTpmYWxzZSkgOiAnJzsKCiAgICByZXR1cm4gJGpz
LiRodG1sOwp9CgovKgogICAgQWRtaW4tc2lkZSBmdW5jdGlvbnMKICAgID09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0K
Ki8KCi8vIEluc3RhbGxhdGlvbiBmdW5jdGlvbiAtIGJ1aWxkcyBNeVNRTCB0YWJsZQpmdW5j
dGlvbiBhcmNfdHdpdHRlcl9pbnN0YWxsKCkKewoKICAgIC8vIEZvciBmaXJzdCBpbnN0YWxs
LCBjcmVhdGUgdGFibGUgZm9yIHR3ZWV0cwogICAgJHNxbCA9ICJDUkVBVEUgVEFCTEUgSUYg
Tk9UIEVYSVNUUyAiLlBGWC4iYXJjX3R3aXR0ZXIgIjsKICAgICRzcWwuPSAiKGFyY190d2l0
dGVyaWQgSU5URUdFUiBBVVRPX0lOQ1JFTUVOVCBQUklNQVJZIEtFWSwKICAgICAgICBhcnRp
Y2xlX2lkIElOVEVHRVIoMTEpLAogICAgICAgIHR3ZWV0X2lkIEJJR0lOVCgyMCksCiAgICAg
ICAgdHdlZXQgVkFSQ0hBUigxNDApLAogICAgICAgIHRpbnl1cmwgVkFSQ0hBUigzMCkpOyI7
CgogICAgaWYgKCFzYWZlX3F1ZXJ5KCRzcWwpKSB7CiAgICAgICAgcmV0dXJuICdFcnJvciAt
IHVuYWJsZSB0byBjcmVhdGUgYXJjX3R3aXR0ZXIgdGFibGUnOwogICAgfQoKfQoKLy8gVW5p
bnN0YWxsIGZ1bmN0aW9uIC0gZGVsZXRlcyBNeVNRTCB0YWJsZSBhbmQgcmVsYXRlZCBwcmVm
ZXJlbmNlcwpmdW5jdGlvbiBhcmNfdHdpdHRlcl91bmluc3RhbGwoKQp7CgogICAgJHNxbCA9
ICJEUk9QIFRBQkxFIElGIEVYSVNUUyAiLlBGWC4iYXJjX3R3aXR0ZXI7IjsKICAgIGlmICgh
c2FmZV9xdWVyeSgkc3FsKSkgewogICAgICAgIHJldHVybiAnRXJyb3IgLSB1bmFibGUgdG8g
ZGVsZXRlIGFyY190d2l0dGVyIHRhYmxlJzsKICAgIH0KCiAgICAkc3FsID0gIkRFTEVURSBG
Uk9NICAiLlBGWC4idHhwX3ByZWZzIFdIRVJFIGV2ZW50PSdhcmNfdHdpdHRlcic7IjsKICAg
IGlmICghc2FmZV9xdWVyeSgkc3FsKSkgewogICAgICAgIHJldHVybiAnRXJyb3IgLSB1bmFi
bGUgdG8gZGVsZXRlIGFyY190d2l0dGVyIHByZWZlcmVuY2VzJzsKICAgIH0KCn0KZnVuY3Rp
b24gYXJjX3R3aXR0ZXJfdXJsX21ldGhvZF9zZWxlY3QoJG5hbWUsICR2YWwpCnsKICAgICRt
ZXRob2RzID0gYXJyYXkoJ3Rpbnl1cmwnID0+ICdUaW55dXJsJywKICAgICAgJ2lzZ2QnID0+
ICdJcy5nZCcsCiAgICAgICdhcmNfdHdpdHRlcicgPT4gJ1RYUCBUd2VldCcsCiAgICAgICdz
bWQnID0+ICdzbWRfc2hvcnRfdXJsJyk7CiAgICByZXR1cm4gc2VsZWN0SW5wdXQoJG5hbWUs
ICRtZXRob2RzLCAkdmFsKTsKfQpmdW5jdGlvbiBhcmNfdHdpdHRlcl90YWJfc2VsZWN0KCRu
YW1lLCAkdmFsKQp7CiAgICAkdGFicyA9IGFycmF5KCdjb250ZW50JyA9PiAnQ29udGVudCcs
CiAgICAgICAgJ2V4dGVuc2lvbnMnID0+ICdFeHRlbnNpb25zJywKICAgICAgICAnJyA9PiAn
SGlkZGVuJyk7CiAgICByZXR1cm4gc2VsZWN0SW5wdXQoJG5hbWUsICR0YWJzLCAkdmFsKTsK
fQovLyBQcm92aWRlIGludGVyZmFjZSBmb3Igc2V0dGluZyBwcmVmZXJlbmNlcwpmdW5jdGlv
biBhcmNfdHdpdHRlcl9wcmVmcygkZXZlbnQsJHN0ZXApCnsKCiAgICBnbG9iYWwgJHByZWZz
LCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7
CgogICAgJHVzZXIgICAgICAgICAgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXTsKICAg
ICRwcmVmaXggICAgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl9wcmVmaXgnXTsKICAgICRz
dWZmaXggICAgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl9zdWZmaXgnXTsKICAgICR0d2Vl
dF9kZWZhdWx0ID0gJHByZWZzWydhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0J107CiAgICAk
dXJsX21ldGhvZCAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddOwogICAg
JHNob3J0X3VybCAgICAgPSAkcHJlZnNbJ2FyY19zaG9ydF91cmwnXTsKICAgICRzaG9ydF9z
aXRlX3VybD0gJHByZWZzWydhcmNfc2hvcnRfc2l0ZV91cmwnXTsKICAgICRjYWNoZV9kaXIg
ICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXTsKICAgICR0YWIgICAgICAg
ICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl90YWInXTsKCiAgICBzd2l0Y2ggKCRzdGVwKSB7
CiAgICAgICAgY2FzZSAncHJlZnNfc2F2ZSc6IHBhZ2V0b3AoJ1RYUCBUd2VldCcsICdQcmVm
ZXJlbmNlcyBzYXZlZCcpOyBicmVhazsKICAgICAgICBjYXNlICdyZWdpc3Rlcic6IHBhZ2V0
b3AoJ1RYUCBUd2VldCcsJ0Nvbm5lY3QgdG8gVHdpdHRlcicpOyBicmVhazsKICAgICAgICBj
YXNlICd2YWxpZGF0ZSc6CiAgICAgICAgZGVmYXVsdDogcGFnZXRvcCgnVFhQIFR3ZWV0Jyk7
CiAgICB9CgogICAgJGh0bWwgPSAnJzsKCiAgICBpZiAoJHN0ZXA9PSdyZWdpc3RlcicpIHsg
Ly8gT0F1dGggcmVnaXN0cmF0aW9uIHByb2Nlc3MKICAgICAgICAkdHdpdCA9IG5ldyBhcmNf
dHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgLCAkYXJjX3R3
aXR0ZXJfY29uc3VtZXJTZWNyZXQpOwoKICAgICAgICAvLyBCdWlsZCBhIGNhbGxiYWNrIFVS
TCBmb3IgVHdpdHRlciB0byByZXR1cm4gdG8gdGhlIG5leHQgc3RhZ2UKICAgICAgICAkY2Fs
bGJhY2tVUkwgPSAkdHdpdC0+Y2FsbGJhY2tVUkwoJGV2ZW50LCd2YWxpZGF0ZScpOwoKICAg
ICAgICAkcmVxdWVzdCA9ICR0d2l0LT5nZXRSZXF1ZXN0VG9rZW4oJGNhbGxiYWNrVVJMKTsK
ICAgICAgICAkcmVxdWVzdF90b2tlbiA9ICRyZXF1ZXN0WyJvYXV0aF90b2tlbiJdOwogICAg
ICAgICRyZXF1ZXN0X3Rva2VuX3NlY3JldCA9ICRyZXF1ZXN0WyJvYXV0aF90b2tlbl9zZWNy
ZXQiXTsKCiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3JlcXVlc3RUb2tlbicsJHJl
cXVlc3RfdG9rZW4KICAgICAgICAgICAgLCAnYXJjX3R3aXR0ZXInLDIpOwogICAgICAgIHNl
dF9wcmVmKCdhcmNfdHdpdHRlcl9yZXF1ZXN0VG9rZW5TZWNyZXQnLCRyZXF1ZXN0X3Rva2Vu
X3NlY3JldAogICAgICAgICAgICAsICdhcmNfdHdpdHRlcicsMik7CgogICAgICAgICRodG1s
Lj0gc3RhcnRUYWJsZSgnZWRpdCcpLgogICAgICAgICAgICAgICAgdHIodGQoCiAgICAgICAg
ICAgICAgICAgICAgKCc8cD4nLmhyZWYoJ1NpZ24taW4gdG8gVHdpdHRlcicKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICwkdHdpdC0+Z2V0QXV0aG9yaXplVVJMKCRyZXF1ZXN0KSkK
ICAgICAgICAgICAgICAgICAgICAgICAgLicgYW5kIGZvbGxvdyB0aGUgaW5zdHJ1Y3Rpb25z
IHRvIGFsbG93IFRYUCBUd2VldCB0byB1c2UgeW91ciBhY2NvdW50LiBJZiB5b3UgYXJlIGFs
cmVhZHkgc2lnbmVkIGluIHRvIFR3aXR0ZXIgdGhlbiB0aGF0IGFjY291bnQgd2lsbCBiZSBh
c3NvY2lhdGVkIHdpdGggVFhQIFR3ZWV0IHNvIHlvdSBtYXkgbmVlZCB0byBzaWduIG91dCBm
aXJzdCBpZiB5b3Ugd2FudCB0byB1c2UgYSBkaWZmZXJlbnQgYWNjb3VudC48L3A+JykKICAg
ICAgICAgICAgICAgICkpLmVuZFRhYmxlKCk7CiAgICB9IGVsc2VpZiAoJHN0ZXA9PSd2YWxp
ZGF0ZScpIHsKICAgICAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJf
Y29uc3VtZXJLZXkKICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQs
ICRwcmVmc1snYXJjX3R3aXR0ZXJfcmVxdWVzdFRva2VuJ10KICAgICAgICAgICAgLCAkcHJl
ZnNbJ2FyY190d2l0dGVyX3JlcXVlc3RUb2tlblNlY3JldCddKTsKICAgICAgICAvLyBBc2sg
VHdpdHRlciBmb3IgYW4gYWNjZXNzIHRva2VuIChhbmQgYW4gYWNjZXNzIHRva2VuIHNlY3Jl
dCkKICAgICAgICAkcmVxdWVzdCA9ICR0d2l0LT5nZXRBY2Nlc3NUb2tlbiggZ3BzKCdvYXV0
aF92ZXJpZmllcicpICk7CiAgICAgICAgJGFjY2Vzc190b2tlbiA9ICRyZXF1ZXN0WydvYXV0
aF90b2tlbiddOwogICAgICAgICRhY2Nlc3NfdG9rZW5fc2VjcmV0ID0gJHJlcXVlc3RbJ29h
dXRoX3Rva2VuX3NlY3JldCddOwogICAgICAgICR1c2VyID0gJHJlcXVlc3RbJ3NjcmVlbl9u
YW1lJ107CiAgICAgICAgLy8gU3RvcmUgdGhlIGFjY2VzcyB0b2tlbiBhbmQgc2VjcmV0CiAg
ICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJywkYWNjZXNzX3Rva2Vu
LCAnYXJjX3R3aXR0ZXInLDIpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9hY2Nl
c3NUb2tlblNlY3JldCcsJGFjY2Vzc190b2tlbl9zZWNyZXQKICAgICAgICAgICAgLCAnYXJj
X3R3aXR0ZXInLDIpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl91c2VyJywkdXNl
cik7CiAgICAgICAgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddID0gJGFjY2Vz
c190b2tlbjsKICAgICAgICAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0
J10gPSAkYWNjZXNzX3Rva2VuX3NlY3JldDsKICAgICAgICB1bnNldCgkdHdpdCk7CiAgICB9
CgogICAgaWYgKCRzdGVwPT0icHJlZnNfc2F2ZSIpIHsKICAgICAgICAkcHJlZml4ID0gdHJp
bShncHMoJ2FyY190d2l0dGVyX3ByZWZpeCcpKTsKICAgICAgICAkc3VmZml4ID0gdHJpbShn
cHMoJ2FyY190d2l0dGVyX3N1ZmZpeCcpKTsKICAgICAgICAkdHdlZXRfZGVmYXVsdCA9IGdw
cygnYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcpOwogICAgICAgICR1cmxfbWV0aG9kID0g
Z3BzKCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJyk7CiAgICAgICAgJHNob3J0X3VybCA9IGdw
cygnYXJjX3Nob3J0X3VybCcpOwogICAgICAgICRzaG9ydF9zaXRlX3VybCA9IGdwcygnYXJj
X3Nob3J0X3NpdGVfdXJsJyk7CiAgICAgICAgJGNhY2hlX2RpciA9IGdwcygnYXJjX3R3aXR0
ZXJfY2FjaGVfZGlyJyk7CiAgICAgICAgJHRhYiA9IGdwcygnYXJjX3R3aXR0ZXJfdGFiJyk7
CiAgICAgICAgaWYgKHN0cmxlbigkcHJlZml4KTw9MjApIHsKICAgICAgICAgICAgc2V0X3By
ZWYoJ2FyY190d2l0dGVyX3ByZWZpeCcsJHByZWZpeCk7CiAgICAgICAgfSBlbHNlIHsKICAg
ICAgICAgICAgJHByZWZpeCA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfcHJlZml4J107CiAgICAg
ICAgfQogICAgICAgIGlmIChzdHJsZW4oJHN1ZmZpeCk8PTIwKSB7CiAgICAgICAgICAgIHNl
dF9wcmVmKCdhcmNfdHdpdHRlcl9zdWZmaXgnLCRzdWZmaXgpOwogICAgICAgIH0gZWxzZSB7
CiAgICAgICAgICAgICRzdWZmaXggPSAkcHJlZnNbJ2FyY190d2l0dGVyX3N1ZmZpeCddOwog
ICAgICAgIH0KICAgICAgICAkdHdlZXRfZGVmYXVsdCA9ICgkdHdlZXRfZGVmYXVsdCkgPyAx
IDogMDsKICAgICAgICAkc2hvcnRfdXJsID0gKCRzaG9ydF91cmwpID8gMSA6IDA7CiAgICAg
ICAgaWYgKCEkc2hvcnRfc2l0ZV91cmwpICRzaG9ydF9zaXRlX3VybCA9ICRwcmVmc1snc2l0
ZXVybCddOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0Jywk
dHdlZXRfZGVmYXVsdCk7CiAgICAgICAgc2V0X3ByZWYoJ2FyY19zaG9ydF91cmwnLCRzaG9y
dF91cmwpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJywkdXJs
X21ldGhvZCk7CiAgICAgICAgc2V0X3ByZWYoJ2FyY19zaG9ydF9zaXRlX3VybCcsJHNob3J0
X3NpdGVfdXJsKTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJywk
Y2FjaGVfZGlyKTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdGFiJywkdGFiKTsK
ICAgIH0KCiAgICBpZiAoICRzdGVwIT0ncmVnaXN0ZXInICkgewogICAgICAgIGlmICggaXNz
ZXQoJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddKQogICAgICAgICYmIGlzc2V0
KCRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSkgKSB7CiAgICAgICAg
ICAgICR0d2l0ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQog
ICAgICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQsICRwcmVmc1sn
YXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXQogICAgICAgICAgICAgICAgLCAkcHJlZnNbJ2Fy
Y190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0J10pOwogICAgICAgICAgICAkcmVnaXN0ZXJV
UkwgPSAkdHdpdC0+Y2FsbGJhY2tVUkwoJGV2ZW50LCdyZWdpc3RlcicpOwogICAgICAgICAg
ICAkaHRtbC49IHN0YXJ0VGFibGUoJ2xpc3QnKS5mb3JtKAogICAgICAgICAgICAgICAgdHIo
CiAgICAgICAgICAgICAgICAgICAgdGRjcyhoZWQoJ1R3aXR0ZXIgYWNjb3VudCBkZXRhaWxz
JywgMiksMikKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50cigKICAgICAg
ICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX3VzZXIiPlR3aXR0
ZXIgdXNlcm5hbWU8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9
InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAg
ICAgICAgICAgICAgIC50ZCgKICAgICAgICAgICAgICAgICAgICAgICAgKCRwcmVmc1snYXJj
X3R3aXR0ZXJfdXNlciddKSA/CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdXNlci4n
ICgnLmhyZWYoJ1JlLWNvbm5lY3QnLCRyZWdpc3RlclVSTCkuJyknCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICA6ICc8ZW0+dW5rbm93bjwvZW0+JwogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgLmhyZWYoJ0Nvbm5lY3QgdG8gVHdpdHRlcicsJHJlZ2lzdGVyVVJMKSkKICAg
ICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAg
ICB0ZGNzKGhlZCgnVHdlZXQgc2V0dGluZ3MnLCAyKSwyKQogICAgICAgICAgICAgICAgKQog
ICAgICAgICAgICAgICAgLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZv
cj0iYXJjX3R3aXR0ZXJfcHJlZml4Ij5Ud2VldCBwcmVmaXg8L2xhYmVsPicsCiAgICAgICAg
ICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1h
bGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50ZChmSW5wdXQoJ3RleHQn
LCdhcmNfdHdpdHRlcl9wcmVmaXgnLCRwcmVmaXgsJycsJycsJycsJycsJycsJ2FyY190d2l0
dGVyX3ByZWZpeCcpKQogICAgICAgICAgICAgICAgKS50cigKICAgICAgICAgICAgICAgICAg
ICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX3N1ZmZpeCI+VHdlZXQgc3VmZml4PC9s
YWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiBy
aWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAu
dGQoZklucHV0KCd0ZXh0JywnYXJjX3R3aXR0ZXJfc3VmZml4Jywkc3VmZml4LCcnLCcnLCcn
LCcnLCcnLCdhcmNfdHdpdHRlcl9zdWZmaXgnKSkKICAgICAgICAgICAgICAgICkudHIoCiAg
ICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl90d2VldF9k
ZWZhdWx0Ij5Ud2VldCBhcnRpY2xlcyBieSBkZWZhdWx0PC9sYWJlbD4nLAogICAgICAgICAg
ICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxp
Z246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoeWVzbm9SYWRpbygnYXJj
X3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcsICR0d2VldF9kZWZhdWx0LCAnJywgJ2FyY190d2l0
dGVyX3R3ZWV0X2RlZmF1bHQnKSkKICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAg
ICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl91cmxfbWV0aG9kIj5VUkwg
c2hvcnRuZXI8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRl
eHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAg
ICAgICAgICAgIC50ZChhcmNfdHdpdHRlcl91cmxfbWV0aG9kX3NlbGVjdCgnYXJjX3R3aXR0
ZXJfdXJsX21ldGhvZCcsJHVybF9tZXRob2QpKQogICAgICAgICAgICAgICAgKS50cigKICAg
ICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVFhQIFR3ZWV0IHNob3J0IFVSTCcsIDIpLDIp
CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAg
ICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfc2hvcnRfdXJsIj5FbmFibGUgVFhQIFR3ZWV0
IHNob3J0IFVSTCByZWRpcmVjdDwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAg
JyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7Iicp
CiAgICAgICAgICAgICAgICAgICAgLnRkKHllc25vUmFkaW8oJ2FyY19zaG9ydF91cmwnLCAk
c2hvcnRfdXJsLCAnJywgJ2FyY19zaG9ydF91cmwnKSksCiAgICAgICAgICAgICAgICAgICAg
JyBpZD0iYXJjX3Nob3J0X3VybC1vbl9vZmYiJwogICAgICAgICAgICAgICAgKS50cigKICAg
ICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY19zaG9ydF9zaXRlX3VybCI+
VFhQIFR3ZWV0IHNob3J0IHNpdGUgVVJMPC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAg
ICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRs
ZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoZklucHV0KCd0ZXh0JywnYXJjX3Nob3J0
X3NpdGVfdXJsJywkc2hvcnRfc2l0ZV91cmwsJycsJycsJycsJycsJycsJ2FyY19zaG9ydF9z
aXRlX3VybCcpKSwKICAgICAgICAgICAgICAgICAgICAnIGlkPSJhcmNfc2hvcnRfc2l0ZV91
cmwtb3B0aW9uIicKICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAgICAgICAgICAg
dGRjcyhoZWQoJ1R3aXR0ZXIgdGFiJywgMiksMikKICAgICAgICAgICAgICAgICkudHIoCiAg
ICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl90YWIiPkxv
Y2F0aW9uIG9mIFR3aXR0ZXIgdGFiPC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAg
ICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsi
JykKICAgICAgICAgICAgICAgICAgICAudGQoYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCgnYXJj
X3R3aXR0ZXJfdGFiJywkdGFiKSkKICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAg
ICAgICAgICAgdGRjcyhoZWQoJ0NhY2hlJywgMiksMikKICAgICAgICAgICAgICAgICkKICAg
ICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9
ImFyY190d2l0dGVyX2NhY2hlX2RpciI+Q2FjaGUgZGlyZWN0b3J5PC9sYWJlbD4nLAogICAg
ICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGlj
YWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoZklucHV0KCd0
ZXh0JywnYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJywkY2FjaGVfZGlyLCcnLCcnLCcnLCcnLCcn
LCdhcmNfdHdpdHRlcl9jYWNoZV9kaXInKSkKICAgICAgICAgICAgICAgICkKICAgICAgICAg
ICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoCiAgICAgICAgICAgICAgICAg
ICAgICAgIGZJbnB1dCgnc3VibWl0JywgJ1N1Ym1pdCcsIGdUeHQoJ3NhdmVfYnV0dG9uJyks
ICdwdWJsaXNoJykKICAgICAgICAgICAgICAgICAgICAgICAgLm4uc0lucHV0KCdwcmVmc19z
YXZlJykKICAgICAgICAgICAgICAgICAgICAgICAgLm4uZUlucHV0KCdwbHVnaW5fcHJlZnMu
YXJjX3R3aXR0ZXInKQogICAgICAgICAgICAgICAgICAgICwgJyBjb2xzcGFuPSIyIiBjbGFz
cz0ibm9saW5lIicpKSkKICAgICAgICAgICAgICAgIC5lbmRUYWJsZSgpOwogICAgICAgIH0g
ZWxzZWlmICggJHN0ZXAhPSdyZWdpc3RlcicgKSB7CiAgICAgICAgICAgICRyZWdpc3RlclVS
TCA9IGFyY190d2l0dGVyOjpjYWxsYmFja1VSTCgkZXZlbnQsJ3JlZ2lzdGVyJyk7CiAgICAg
ICAgICAgICRodG1sLj0gc3RhcnRUYWJsZSgnbGlzdCcpLmZvcm0oCiAgICAgICAgICAgICAg
ICB0cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVHdpdHRlciBhY2NvdW50IGRl
dGFpbHMnLCAyKSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAog
ICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfdXNlciI+
VHdpdHRlciB1c2VybmFtZTwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBz
dHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAg
ICAgICAgICAgICAgICAgICAgLnRkKAogICAgICAgICAgICAgICAgICAgICAgICAoJzxlbT51
bmtub3duPC9lbT4gKCcKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5ocmVmKCdDb25u
ZWN0IHRvIFR3aXR0ZXInLCRyZWdpc3RlclVSTCkuJyknKQogICAgICAgICAgICAgICAgKSkp
CiAgICAgICAgICAgICAgICAuZW5kVGFibGUoKTsKICAgICAgICB9CiAgICB9CgogICAgLy8g
U2V0IGpRdWVyeSBmb3Igc3dpdGNoaW5nIG9uL29mZiByZWxldmFudCBhcmNfc2hvcnRfdXJs
IGZpZWxkcwogICAgJGpzID0gPDw8SlMKPHNjcmlwdCBsYW5ndWFnZT0iamF2YXNjcmlwdCIg
dHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXsK
ICB2YXIgb25vZmYgPSAkKCcjYXJjX3Nob3J0X3VybC1vbl9vZmYnKTsKICB2YXIgYXJjX3No
b3J0X3VybF9vZmYgPSAkKCcjYXJjX3Nob3J0X3VybC1hcmNfc2hvcnRfdXJsLTAnKTsKICB2
YXIgdXJsID0gJCgnI2FyY19zaG9ydF9zaXRlX3VybC1vcHRpb24nKTsKICB2YXIgdXJsX21l
dGhvZCA9ICQoJ3NlbGVjdFtuYW1lPSJhcmNfdHdpdHRlcl91cmxfbWV0aG9kIl0nKTsKCiAg
aWYgKGFyY19zaG9ydF91cmxfb2ZmLmF0dHIoJ2NoZWNrZWQnKT09dHJ1ZQogICYmICQoJ29w
dGlvbjpzZWxlY3RlZCcsIHVybF9tZXRob2QpLnZhbCgpIT0nYXJjX3R3aXR0ZXInKSB7CiAg
ICB1cmwuaGlkZSgpOwogIH0KICAkKCdpbnB1dCcsIG9ub2ZmKS5jaGFuZ2UoZnVuY3Rpb24o
KXsKICAgIGlmICgkKCdvcHRpb246c2VsZWN0ZWQnLCB1cmxfbWV0aG9kKS52YWwoKSE9J2Fy
Y190d2l0dGVyJykgewogICAgICBhcmNfc2hvcnRfdXJsX29mZi5hdHRyKCdjaGVja2VkJyk9
PXRydWUgPyB1cmwuaGlkZSgpIDogdXJsLnNob3coKTsKICAgIH0KICB9KTsKCiAgaWYgKCQo
J29wdGlvbjpzZWxlY3RlZCcsIHVybF9tZXRob2QpLnZhbCgpPT0nYXJjX3R3aXR0ZXInKSB7
CiAgICBvbm9mZi5oaWRlKCk7IHVybC5zaG93KCk7CiAgfQogIHVybF9tZXRob2QuY2hhbmdl
KGZ1bmN0aW9uKCl7CiAgICBpZiAoJCgnb3B0aW9uOnNlbGVjdGVkJywgdXJsX21ldGhvZCku
dmFsKCk9PSdhcmNfdHdpdHRlcicpIHsKICAgICAgb25vZmYudG9nZ2xlKCk7IHVybC5zaG93
KCk7CiAgICB9IGVsc2UgewogICAgICBvbm9mZi50b2dnbGUoKTsKICAgICAgYXJjX3Nob3J0
X3VybF9vZmYuYXR0cignY2hlY2tlZCcpPT10cnVlID8gdXJsLmhpZGUoKSA6IHVybC5zaG93
KCk7CiAgICB9CiAgfSkKfSk7Cjwvc2NyaXB0PgpKUzsKCiAgICBlY2hvICRqcy4kaHRtbDsK
fQoKLy8gQWRkIFR3aXR0ZXIgdGFiIHRvIFRleHRwYXR0ZXJuCmZ1bmN0aW9uIGFyY19hZG1p
bl90d2l0dGVyKCRldmVudCwkc3RlcCkKewogICAgZ2xvYmFsICRwcmVmcywgJGFyY190d2l0
dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgogICAgJHR3
aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAg
ICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVy
X2FjY2Vzc1Rva2VuJ10KICAgICAgICAgICAgLCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vz
c1Rva2VuU2VjcmV0J10pOwoKICAgICR0d2l0LT5jYWNoZURpcigkcHJlZnNbJ2FyY190d2l0
dGVyX2NhY2hlX2RpciddKTsKCiAgICAkeG1sID0gJHR3aXQtPmdldCgndXNlcnMvc2hvdycK
ICAgICAgICAsIGFycmF5KCdzY3JlZW5fbmFtZSc9PiRwcmVmc1snYXJjX3R3aXR0ZXJfdXNl
ciddKSk7CiAgICAkdHdpdHRlclVzZXIgPSBAJHhtbC0+eHBhdGgoJy91c2VyJyk7CiAgICAk
dHdpdHRlclVzZXIgPSAkdHdpdHRlclVzZXJbMF07CiAgICAkdHdpdHRlclVzZXJVUkwgPSAn
aHR0cDovL3d3dy50d2l0dGVyLmNvbS8nLiR0d2l0dGVyVXNlci0+c2NyZWVuX25hbWU7Cgog
ICAgaWYgKCRzdGVwPT0idHdlZXQiKSB7IC8vIHBvc3QgYW4gdXBkYXRlIHRvIFR3aXR0ZXIK
CiAgICAgICAgLy8gZmV0Y2ggYW5kIGNsZWFuIG1lc3NhZ2UKICAgICAgICAkbWVzc2FnZSA9
IHN0cmlwX3RhZ3MoZ3BzKCdtZXNzYWdlJykpOwogICAgICAgICRjb3VudCA9IHN0cmxlbigk
bWVzc2FnZSk7CgogICAgICAgIGlmICgkY291bnQ8PTE0MCAmJiAkY291bnQ+MCkgeyAvLyBw
b3N0IHVwZGF0ZQogICAgICAgICAgICAkcmVzdWx0ID0gJHR3aXQtPnBvc3QoJ3N0YXR1c2Vz
L3VwZGF0ZScsIGFycmF5KCdzdGF0dXMnID0+ICRtZXNzYWdlKSk7CiAgICAgICAgfSBlbHNl
IHsgLy8gbWVzc2FnZSB0b28gbG9uZywgSmF2YVNjcmlwdCBpbnRlcmZhY2Ugc2hvdWxkIHBy
ZXZlbnQgdGhpcwogICAgICAgICAgICAkcmVzdWx0ID0gZmFsc2U7CiAgICAgICAgfQoKICAg
ICAgICBwYWdldG9wKCdUd2l0dGVyJywKICAgICAgICAgICAgKCgkcmVzdWx0IT1mYWxzZSk/
J1R3aXR0ZXIgdXBkYXRlZCc6J0Vycm9yIHVwZGF0aW5nIFR3aXR0ZXInKSk7CgogICAgfSBl
bHNlaWYgKCRzdGVwPT0iZGVsZXRlIikgeyAvLyBkZWxldGUgYW4gdXBkYXRlIGZyb20gVHdp
dHRlcgoKICAgICAgICAkaWQgPSBzdHJpcF90YWdzKGdwcygnaWQnKSk7CiAgICAgICAgaWYg
KCRpZCkgewogICAgICAgICAgICAkdHdpdC0+ZGVsZXRlKCdzdGF0dXNlcy9kZXN0cm95Jy4k
aWQpOwogICAgICAgICAgICBzYWZlX2RlbGV0ZSgnYXJjX3R3aXR0ZXInLCJ0d2VldF9pZCA9
ICRpZCIpOwogICAgICAgIH0KCiAgICAgICAgcGFnZXRvcCgnVHdpdHRlcicsJ1R3aXR0ZXIg
dXBkYXRlZCcpOwoKICAgIH0gZWxzZSB7CgogICAgICAgIHBhZ2V0b3AoJ1R3aXR0ZXInKTsK
CiAgICB9CgogICAgLy8gUHJlcGFyZSBKYXZhU2NyaXB0IHRvIGNyZWF0ZSBUd2l0dGVyIHVw
ZGF0ZSBpbnRlcmZhY2UKCiAgICAkanMgPSAnPHNjcmlwdCBsYW5ndWFnZT0iamF2YXNjcmlw
dCIgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4nOwogICAgJGpzLj0gIiQoZG9jdW1lbnQpLnJl
YWR5KGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHZhciBjb3VudGVyU3R5bGUgPSAnZm9udC13
ZWlnaHQ6Ym9sZDtmbG9hdDpyaWdodDtmb250LXNpemU6MmVtO2xpbmUtaGVpZ2h0OjEuMmVt
Oyc7CiAgICAgICAgICAgICQoJyN0d2VldGNvdW50JykuYXR0cignc3R5bGUnLCBjb3VudGVy
U3R5bGUrJ2NvbG9yOiNjY2M7Jyk7CiAgICAgICAgICAgICQoJyNtZXNzYWdlJykua2V5dXAo
ZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB2YXIgY291bnQgPSAxNDAtJCgnI21lc3Nh
Z2UnKS52YWwoKS5sZW5ndGg7CiAgICAgICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmh0
bWwoY291bnQrJycpOyAvLyBoYWNrIHRvIGZvcmNlIG91dHB1dCBvZiAwCiAgICAgICAgICAg
ICAgICBpZiAoY291bnQ8MCkgewogICAgICAgICAgICAgICAgICAgICQoJ2lucHV0LnB1Ymxp
c2gnKS5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpOwogICAgICAgICAgICAgICAgfSBl
bHNlIHsKICAgICAgICAgICAgICAgICAgICAkKCdpbnB1dC5wdWJsaXNoJykuYXR0cignZGlz
YWJsZWQnLCAnJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoY291
bnQ8MCkgewogICAgICAgICAgICAgICAgICAgICQoJyN0d2VldGNvdW50JykuYXR0cignc3R5
bGUnLCBjb3VudGVyU3R5bGUrJ2NvbG9yOiNmMDA7Jyk7CiAgICAgICAgICAgICAgICB9IGVs
c2UgaWYgKGNvdW50PDEwKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnI3R3ZWV0Y291bnQn
KS5hdHRyKCdzdHlsZScsIGNvdW50ZXJTdHlsZSsnY29sb3I6IzAwMDsnKTsKICAgICAgICAg
ICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJCgnI3R3ZWV0Y291bnQnKS5h
dHRyKCdzdHlsZScsIGNvdW50ZXJTdHlsZSsnY29sb3I6I2NjYzsnKTsKICAgICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICB9KTsiOwogICAgJGpzLj0gIjwvc2NyaXB0
PiI7CgogICAgJG91dCA9ICcnOwogICAgJHhtbCA9ICR0d2l0LT5nZXQoJ3N0YXR1c2VzL3Vz
ZXJfdGltZWxpbmUnCiAgICAgICAgLCBhcnJheSgnc2NyZWVuX25hbWUnPT4kcHJlZnNbJ2Fy
Y190d2l0dGVyX3VzZXInXSwnY291bnQnPT4yNSkpOwogICAgJHR3ZWV0cyA9IEAkeG1sLT54
cGF0aCgnL3N0YXR1c2VzL3N0YXR1cycpOwogICAgaWYgKCR0d2VldHMpIGZvcmVhY2ggKCR0
d2VldHMgYXMgJHR3ZWV0KSB7CiAgICAgICAgJHRpbWUgPSBzdHJ0b3RpbWUoaHRtbGVudGl0
aWVzKCR0d2VldC0+Y3JlYXRlZF9hdCkpOwogICAgICAgICRkYXRlID0gc2FmZV9zdHJmdGlt
ZSgkcHJlZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCddLCR0aW1lKTsKICAgICAgICAkb3V0Lj0g
dHIodGQoJGRhdGUsJ3NwYW4nKQogICAgICAgICAgICAudGQoYXJjX1R3aXR0ZXI6Om1ha2VM
aW5rcyhodG1sZW50aXRpZXMoJHR3ZWV0LT50ZXh0CiAgICAgICAgICAgICAgICAsIEVOVF9R
VU9URVMsJ1VURi04JykpKQogICAgICAgICAgICAudGQoZExpbmsoJ2FyY19hZG1pbl90d2l0
dGVyJywnZGVsZXRlJywnaWQnLCR0d2VldC0+aWQsJycpKQogICAgICAgICAgICApOwogICAg
fQoKICAgICRodG1sID0gc3RhcnRUYWJsZSgnZWRpdCcpCiAgICAgICAgICAgIC50cih0ZCgK
ICAgICAgICAgICAgZ3JhZignPGltZyBzcmM9IicuJHR3aXR0ZXJVc2VyLT5wcm9maWxlX2lt
YWdlX3VybC4nIiBhbHQ9IlR3aXR0ZXIgYXZhdGFyIiAvPicKICAgICAgICAgICAgLCcgc3R5
bGU9ImZsb2F0OmxlZnQ7cGFkZGluZzoycHg7IicpCiAgICAgICAgICAgIC5ncmFmKGhyZWYo
JHR3aXR0ZXJVc2VyLT5uYW1lLCR0d2l0dGVyVXNlclVSTCksJyBzdHlsZT0iZm9udC1zaXpl
OjEuMmVtO2ZvbnQtd2VpZ2h0OmJvbGQ7IicpCiAgICAgICAgICAgIC5ncmFmKGhyZWYoJHR3
aXR0ZXJVc2VyLT5mcmllbmRzX2NvdW50LicgZm9sbG93aW5nJywkdHdpdHRlclVzZXJVUkwu
Jy9mb2xsb3dpbmcnKQogICAgICAgICAgICAuJywgJy5ocmVmKCR0d2l0dGVyVXNlci0+Zm9s
bG93ZXJzX2NvdW50LicgZm9sbG93ZXJzJywkdHdpdHRlclVzZXJVUkwuJy9mb2xsb3dlcnMn
KQogICAgICAgICAgICAuJywgJy5ocmVmKCR0d2l0dGVyVXNlci0+c3RhdHVzZXNfY291bnQu
JyB1cGRhdGVzJywkdHdpdHRlclVzZXJVUkwpKSkpCiAgICAgICAgICAgIC50cih0ZChmb3Jt
KAogICAgICAgICAgICBncmFmKCJVcGRhdGUgVHdpdHRlci4uLjxzcGFuIGlkPSd0d2VldGNv
dW50JyBzdHlsZT0nZm9udC13ZWlnaHQ6Ym9sZDtmbG9hdDpyaWdodDsnPjE0MDwvc3Bhbj4i
KQogICAgICAgICAgICAudGV4dF9hcmVhKCdtZXNzYWdlJywnNTAnLCc1NTAnLCcnLCdtZXNz
YWdlJykKICAgICAgICAgICAgLmVJbnB1dCgnYXJjX2FkbWluX3R3aXR0ZXInKQogICAgICAg
ICAgICAuc0lucHV0KCd0d2VldCcpLmJyCiAgICAgICAgICAgIC5mSW5wdXQoJ3N1Ym1pdCcs
J3VwZGF0ZScsZ1R4dCgnVXBkYXRlJyksJ3B1Ymxpc2gnKQogICAgICAgICkpKQogICAgICAg
IC5lbmRUYWJsZSgpOwoKICAgIC8vIEF0dGFjaCByZWNlbnQgVHdpdHRlciB1cGRhdGVzCgog
ICAgJGh0bWwuPSBzdGFydFRhYmxlKCdsaXN0JywnJywnJywnJywnOTAlJykKICAgICAgICAu
JG91dAogICAgICAgIC5lbmRUYWJsZSgpOwoKICAgIC8vIE91dHB1dCBKYXZhU2NyaXB0IGFu
ZCBIVE1MCgogICAgZWNobyAkanMuJGh0bWw7Cn0KCi8vIEFkZCBUd2l0dGVyIG9wdGlvbnMg
dG8gYXJ0aWNsZSBhcnRpY2xlIHNjcmVlbgpmdW5jdGlvbiBhcmNfYXBwZW5kX3R3aXR0ZXIo
JGV2ZW50LCAkc3RlcCwgJGRhdGEsICRyczEpCnsKICAgIGdsb2JhbCAkcHJlZnMsICRhcmNf
dHdpdHRlcjsKICAgICRwcmVmaXggPSB0cmltKGdwcygnYXJjX3R3aXR0ZXJfcHJlZml4Jykp
OwogICAgJHByZWZpeCA9ICgkcHJlZml4KSA/ICRwcmVmaXggOiAkcHJlZnNbJ2FyY190d2l0
dGVyX3ByZWZpeCddOwogICAgJHN1ZmZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9zdWZm
aXgnKSk7CiAgICAkc3VmZml4ID0gKCRzdWZmaXgpID8gJHN1ZmZpeCA6ICRwcmVmc1snYXJj
X3R3aXR0ZXJfc3VmZml4J107CgogICAgaWYgKCRyczFbJ0lEJ10pIHsKICAgICAgICAkc3Fs
ID0gIlNFTEVDVCB0d2VldF9pZCx0d2VldCBGUk9NICIuUEZYLiJhcmNfdHdpdHRlciBXSEVS
RSBhcnRpY2xlX2lkPSIuJHJzMVsnSUQnXS4iOyI7CiAgICAgICAgJHJzMiA9IHNhZmVfcXVl
cnkoJHNxbCk7ICRyczIgPSBuZXh0Um93KCRyczIpOwogICAgfSBlbHNlIHsgLy8gbmV3IGFy
dGljbGUKICAgICAgICAkcnMyID0gJyc7CiAgICB9CgogICAgaWYgKCRyczFbJ0lEJ10gJiYg
JHJzMlsndHdlZXRfaWQnXSkgewogICAgICAgICRjb250ZW50ID0gYXJjX1R3aXR0ZXI6Om1h
a2VMaW5rcygkcnMyWyd0d2VldCddKTsKICAgICAgICByZXR1cm4gJGRhdGEuZmllbGRzZXQo
JGNvbnRlbnQsICdUd2l0dGVyIHVwZGF0ZScsICdhcmNfdHdpdHRlcicpOwogICAgfSBlbHNl
IHsKICAgICAgICAkdmFyID0gZ3BzKCdhcmNfdHdlZXRfdGhpcycpOwogICAgICAgICR2YXIg
PSAoJHJzMVsnSUQnXSYmISR2YXIpID8gMCA6ICRwcmVmc1snYXJjX3R3aXR0ZXJfdHdlZXRf
ZGVmYXVsdCddOwogICAgICAgICRjb250ZW50ICA9IHRhZyh5ZXNub1JhZGlvKCdhcmNfdHdl
ZXRfdGhpcycsICR2YXIsICcnLCAnYXJjX3R3ZWV0X3RoaXMnKSwncCcpOwogICAgICAgICRj
b250ZW50IC49IHRhZyhocmVmKCdPcHRpb25zJywnI2FyY190d2l0dGVyX29wdGlvbnMnKSwn
cCcsJyBjbGFzcz0icGxhaW4gbGV2ZXIiIHN0eWxlPSJtYXJnaW4tdG9wOjVweDsiJyk7CiAg
ICAgICAgJGNvbnRlbnQgLj0gdGFnKHRhZyh0YWcoJ1R3ZWV0IHByZWZpeCcsJ2xhYmVsJywg
JyBmb3I9ImFyY190d2l0dGVyX3ByZWZpeCInKQogICAgICAgICAgICAuZklucHV0KCd0ZXh0
JywnYXJjX3R3aXR0ZXJfcHJlZml4JywkcHJlZml4LCdlZGl0JywnJywnJywnMjInLCcnLCdh
cmNfdHdpdHRlcl9wcmVmaXgnKSwncCcpCiAgICAgICAgICAgIC50YWcodGFnKCdUd2VldCBz
dWZmaXggKGVnICNoYXNodGFncyknLCdsYWJlbCcsICcgZm9yPSJhcmNfdHdpdHRlcl9zdWZm
aXgiJykKICAgICAgICAgICAgLmZJbnB1dCgndGV4dCcsJ2FyY190d2l0dGVyX3N1ZmZpeCcs
JHN1ZmZpeCwnZWRpdCcsJycsJycsJzIyJywnJywnYXJjX3R3aXR0ZXJfc3VmZml4JyksJ3An
KQogICAgICAgICAgICAsJ2RpdicsJyBpZD0iYXJjX3R3aXR0ZXJfb3B0aW9ucyIgY2xhc3M9
InRvZ2dsZSIgc3R5bGU9ImRpc3BsYXk6bm9uZSInKTsKICAgICAgICBpZiAoaXNzZXQoJGFy
Y190d2l0dGVyWydlcnJvciddKSkgewogICAgICAgICAgICAkY29udGVudCAuPSAnPHA+Jy4k
YXJjX3R3aXR0ZXJbJ2Vycm9yJ10uJzwvcD4nOwogICAgICAgIH0KICAgICAgICByZXR1cm4g
JGRhdGEuZmllbGRzZXQoJGNvbnRlbnQsICdVcGRhdGUgVHdpdHRlcicsICdhcmNfdHdpdHRl
cicpOwogICAgfQoKfQoKLy8gVXBkYXRlIFR3aXR0ZXIgd2l0aCBwb3N0ZWQgYXJ0aWNsZQpm
dW5jdGlvbiBhcmNfYXJ0aWNsZV90d2VldCgkZXZlbnQsJHN0ZXApCnsKICAgIGdsb2JhbCAk
cHJlZnMsICRhcmNfdHdpdHRlciwgJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAg
LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgogICAgJGFydGljbGVfaWQgPSBlbXB0
eSgkR0xPQkFMU1snSUQnXSkgPyBncHMoJ0lEJykgOiAkR0xPQkFMU1snSUQnXTsKICAgIGlm
ICghZW1wdHkoJGFydGljbGVfaWQpKSB7CgogICAgICAgIGluY2x1ZGVfb25jZSB0eHBhdGgu
Jy9wdWJsaXNoL3RhZ2hhbmRsZXJzLnBocCc7CgogICAgICAgICRhcnRpY2xlID0gc2FmZV9y
b3coIklELCBUaXRsZSwgU2VjdGlvbiwgUG9zdGVkIiwgJ3RleHRwYXR0ZXJuJywKICAgICAg
ICAgICAgIklEPXskYXJ0aWNsZV9pZH0gQU5EIFN0YXR1cz00IEFORCBub3coKT49UG9zdGVk
Iik7CgogICAgICAgIGlmICgkYXJ0aWNsZSAmJiBncHMoJ2FyY190d2VldF90aGlzJykpIHsg
Ly8gdHdlZXQgYXJ0aWNsZQoKICAgICAgICAgICAgLy8gTmVlZCB0byBtYW51YWxseSB1cGRh
dGUgdGhlICdVUkwgb25seSB0aXRsZScgYmVmb3JlIGJ1aWxkaW5nIHRoZQogICAgICAgICAg
ICAvLyBVUkwKICAgICAgICAgICAgJGFydGljbGVbJ3VybF90aXRsZSddID0gZ3BzKCd1cmxf
dGl0bGUnKTsKICAgICAgICAgICAgLy8gTWFrZSBzaG9ydCBVUkwKICAgICAgICAgICAgJHVy
bCA9IHBlcm1saW5rdXJsKCRhcnRpY2xlKTsKICAgICAgICAgICAgJHNob3J0X3VybCA9IGFy
Y19zaG9ydGVuX3VybCgkdXJsLCRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddLAog
ICAgICAgICAgICAgICAgYXJyYXkoJ2lkJz0+JGFydGljbGVfaWQpKTsKCiAgICAgICAgICAg
IGlmICghJHNob3J0X3VybCkgeyAvLyBGYWlsZWQgdG8gb2J0YWluIGEgc2hvcnRlbmVkIFVS
TCwgZG8gbm90IHR3ZWV0IQogICAgICAgICAgICAgICAgJGFyY190d2l0dGVyWydlcnJvcidd
ID0gJ1VuYWJsZSB0byBvYnRhaW4gYSBzaG9ydCBVUkwgZm9yIHRoaXMgYXJ0aWNsZS4nOwoK
ICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAg
ICAgLy8gQ29uc3RydWN0IFR3aXR0ZXIgdXBkYXRlCiAgICAgICAgICAgICRwcmVmaXggID0g
dHJpbShncHMoJ2FyY190d2l0dGVyX3ByZWZpeCcpKTsKICAgICAgICAgICAgJHByZV9sZW4g
PSBzdHJsZW4oJHByZWZpeCk7CiAgICAgICAgICAgICRwcmVmaXggID0gKCRwcmVmaXggJiYg
JHByZV9sZW48PTIwKSA/ICRwcmVmaXguJyAnIDogJyc7CiAgICAgICAgICAgICRzdWZmaXgg
ID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3N1ZmZpeCcpKTsKICAgICAgICAgICAgJHN1Zl9s
ZW4gPSBzdHJsZW4oJHN1ZmZpeCk7CiAgICAgICAgICAgICRzdWZmaXggID0gKCRzdWZmaXgg
JiYgJHN1Zl9sZW48PTQwKSA/ICcgJy4kc3VmZml4IDogJyc7CiAgICAgICAgICAgICR1cmxf
bGVuID0gc3RybGVuKCRzaG9ydF91cmwpKzE7IC8vIGNvdW50IFVSTCBsZW5ndGggKyAxIGZv
ciBwcmVmaXhlZCBzcGFjZQogICAgICAgICAgICBpZiAoJHByZWZpeCkgJHByZV9sZW4gKz0g
MTsKICAgICAgICAgICAgaWYgKCRzdWZmaXgpICRzdWZfbGVuICs9IDE7CiAgICAgICAgICAg
IGlmICgoc3RybGVuKCRhcnRpY2xlWydUaXRsZSddKSskdXJsX2xlbiskcHJlX2xlbiskc3Vm
X2xlbik+MTQwKSB7CiAgICAgICAgICAgICAgICAkYXJ0aWNsZVsnVGl0bGUnXSA9IHN1YnN0
cigkYXJ0aWNsZVsnVGl0bGUnXSwwLDEzNS0kdXJsX2xlbi0kcHJlX2xlbi0kc3VmX2xlbiku
Jy4uLic7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJHR3ZWV0ID0gJHByZWZpeC4kYXJ0
aWNsZVsnVGl0bGUnXS4iICIuJHNob3J0X3VybC4kc3VmZml4OwoKICAgICAgICAgICAgLy8g
VXBkYXRlIFR3aXR0ZXIKICAgICAgICAgICAgJHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFy
Y190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgICAgICAgICAsICRhcmNfdHdpdHRlcl9j
b25zdW1lclNlY3JldCwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddCiAgICAg
ICAgICAgICAgICAsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSk7
CiAgICAgICAgICAgICRyZXN1bHQgPSAkdHdpdC0+cG9zdCgnc3RhdHVzZXMvdXBkYXRlJywg
YXJyYXkoJ3N0YXR1cycgPT4gJHR3ZWV0KSk7CgogICAgICAgICAgICAkdHdlZXRfaWQgPSAo
aXNfb2JqZWN0KCRyZXN1bHQpKSA/ICRyZXN1bHRbMF0tPmlkIDogMDsKCiAgICAgICAgICAg
IGlmICgkdHdlZXRfaWQpIHsKCiAgICAgICAgICAgICAgICAkdHdlZXQgPSBhZGRzbGFzaGVz
KCR0d2VldCk7CgogICAgICAgICAgICAgICAgLy8gdXBkYXRlIGFyY190d2l0dGVyIHRhYmxl
IHdpdGggdHdlZXQKICAgICAgICAgICAgICAgICRzcWwgPSAiSU5TRVJUIElOVE8gIi5QRlgu
ImFyY190d2l0dGVyIChhcnRpY2xlX2lkLHR3ZWV0X2lkLHR3ZWV0LHRpbnl1cmwpICI7CiAg
ICAgICAgICAgICAgICAkc3FsLj0gIlZBTFVFUygkYXJ0aWNsZV9pZCwkdHdlZXRfaWQsXCIk
dHdlZXRcIiwnJHNob3J0X3VybCcpOyI7CiAgICAgICAgICAgICAgICBzYWZlX3F1ZXJ5KCRz
cWwpOwoKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgICAgICAgfSBlbHNl
IHsKCiAgICAgICAgICAgICAgICAkYXJjX3R3aXR0ZXJbJ2Vycm9yJ10gPSAnVHdpdHRlciBy
ZXNwb25zZTogJwogICAgICAgICAgICAgICAgICAgIC4kdHdpdC0+aHR0cF9jb2RlOwogICAg
ICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAgfQoKICAgICAgICB9Cgog
ICAgfQoKICAgIHJldHVybiBmYWxzZTsKCn0KCi8qCiAqIFNob3J0ZW4gVVJMcyB1c2luZyB2
YXJpb3VzIG1ldGhvZHMKICovCgpmdW5jdGlvbiBhcmNfc2hvcnRlbl91cmwoJHVybCwgJG1l
dGhvZD0nJywgJGF0dHM9YXJyYXkoKSkKewogIGdsb2JhbCAkcHJlZnM7CgogICRjaCA9IGN1
cmxfaW5pdCgpOwogIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9IRUFERVIsIDApOwogIGN1
cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgdHJ1ZSk7CiAgY3VybF9z
ZXRvcHQoJGNoLCBDVVJMT1BUX1RJTUVPVVQsIDEwKTsKCiAgc3dpdGNoICgkbWV0aG9kKSB7
CiAgICBjYXNlICdzbWQnOiAvLyBjcmVhdGUgYSBzaG9ydGVuZWQgVVJMIHVzaW5nIFNNRCBT
aG9ydCBVUkwKICAgICAgcmV0dXJuICgkYXR0c1snaWQnXSkgPyBodS4kYXR0c1snaWQnXSA6
IGZhbHNlOyBicmVhazsKICAgIGNhc2UgJ2FyY190d2l0dGVyJzogLy8gbmF0aXZlIFVSTCBz
aG9ydGVuaW5nCgogICAgICByZXR1cm4gKCRhdHRzWydpZCddKSA/IFBST1RPQ09MLiRwcmVm
c1snYXJjX3Nob3J0X3NpdGVfdXJsJ10uJy8nLiRhdHRzWydpZCddIDogZmFsc2U7CiAgICAg
IGJyZWFrOwoKICAgIGNhc2UgJ2lzZ2QnOgoKICAgICAgJHUgPSAnaHR0cDovL2lzLmdkL2Fw
aS5waHA/bG9uZ3VybD0nLnVybGVuY29kZSgkdXJsKTsKICAgICAgY3VybF9zZXRvcHQoJGNo
LCBDVVJMT1BUX1VSTCwgJHUpOwoKICAgICAgJHRpbnl1cmwgPSBjdXJsX2V4ZWMoJGNoKTsK
ICAgICAgaWYgKCR0aW55dXJsIT0nRXJyb3InICYmICR0aW55dXJsIT0nJykgewogICAgICAg
IHJldHVybiAkdGlueXVybDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0cmlnZ2VyX2Vycm9y
KCdhcmNfdHdpdHRlciBmYWlsZWQgdG8gZ2V0IGEgaXMuZ2QgVVJMIGZvciAnCiAgICAgICAg
ICAgIC4kdXJsLEVfVVNFUl9XQVJOSU5HKTsKICAgICAgfQogICAgICBicmVhazsKCiAgICBj
YXNlICd0aW55dXJsJzogZGVmYXVsdDogLy8gY3JlYXRlIGEgc2hvcnRlbmVkIFVSTCB1c2lu
ZyBUaW55VVJMCgogICAgICAkdSA9ICdodHRwOi8vdGlueXVybC5jb20vYXBpLWNyZWF0ZS5w
aHA/dXJsPScudXJsZW5jb2RlKCR1cmwpOwogICAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxP
UFRfVVJMLCAkdSk7CiAgICAgICR0aW55dXJsID0gY3VybF9leGVjKCRjaCk7CiAgICAgIGlm
ICgkdGlueXVybCE9J0Vycm9yJyAmJiAkdGlueXVybCE9JycpIHsKICAgICAgICByZXR1cm4g
JHRpbnl1cmw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdHJpZ2dlcl9lcnJvcignYXJjX3R3
aXR0ZXIgZmFpbGVkIHRvIGdldCBhIFRpbnlVUkwgZm9yICcuJHVybCxFX1VTRVJfV0FSTklO
Ryk7CiAgICAgIH0KCiAgfQoKICByZXR1cm4gZmFsc2U7IC8vIGZhaWwKCn0KCi8qCiAqIFNo
b3J0ZW5lZCBVUkwgcmVkaXJlY3QgYmFzZWQgb24gc21kX3Nob3J0X3VybAogKi8KZnVuY3Rp
b24gYXJjX3Nob3J0X3VybF9yZWRpcmVjdCgkZXZlbnQsICRzdGVwKSB7CiAgZ2xvYmFsICRw
cmVmczsKCiAgJGhhdmVfaWQgPSAwOwoKICAvLyBDaGVjayBpZiB0aGVyZSBpcyBhbiBhdmFp
bGFibGUgc2hvcnQgc2l0ZSB1cmwgYW5kIGlmIGl0IGlzIGJlaW5nIHVzZWQgaW4KICAvLyB0
aGlzIGluc3RhbmNlCiAgJHNob3J0X3NpdGVfdXJsID0gJHByZWZzWydhcmNfc2hvcnRfc2l0
ZV91cmwnXTsKICBpZiAoJHNob3J0X3NpdGVfdXJsKSB7CiAgICAkc2hvcnRfc2l0ZV91cmwg
PSBQUk9UT0NPTC4kc2hvcnRfc2l0ZV91cmwuJy8nOwogICAgJHVybF9wYXJ0cyA9IHBhcnNl
X3VybCgkc2hvcnRfc2l0ZV91cmwpOwogICAgJHJlID0gJyNeJy4kdXJsX3BhcnRzWydwYXRo
J10uJyhbMC05XS4qKSMnOwogICAgJGhhdmVfaWQgPSBwcmVnX21hdGNoKCRyZSwgJF9TRVJW
RVJbJ1JFUVVFU1RfVVJJJ10sICRtKTsKICB9CgogIC8vIEZhbGwgYmFjayB0byBzdGFuZGFy
ZCBzaXRlIHVybCAoc21kX3Nob3J0X3VybCBiZWhhdmlvdXIpCiAgaWYgKCRoYXZlX2lkKSB7
CiAgICAkdXJsX3BhcnRzID0gcGFyc2VfdXJsKGh1KTsKICAgICRyZSA9ICcjXicuJHVybF9w
YXJ0c1sncGF0aCddLicoWzAtOV0uKikjJzsKICAgICRoYXZlX2lkID0gcHJlZ19tYXRjaCgk
cmUsICRfU0VSVkVSWydSRVFVRVNUX1VSSSddLCAkbSk7CiAgfQoKICAvLyBEbyB0aGUgcmVk
aXJlY3QgaWYgd2UndmUgZ290IGFuIGFydGljbGUgaWQKICBpZiAoJGhhdmVfaWQpIHsKCSAg
JGlkID0gJG1bMV07CgkgICRwZXJtbGluayA9IHBlcm1saW5rdXJsX2lkKCRpZCk7CgoJICBp
ZiAoJHBlcm1saW5rKSB7CgkJICBvYl9lbmRfY2xlYW4oKTsKCgkJICAvLyBTdHVwaWQsIG92
ZXIgdGhlIHRvcCBoZWFkZXIgc2V0dGluZyBmb3IgSUUKCQkgIGhlYWRlcigiU3RhdHVzOiAz
MDEiKTsKCQkgIGhlYWRlcigiSFRUUC8xLjAgMzAxIE1vdmVkIFBlcm1hbmVudGx5Iik7CgkJ
ICBoZWFkZXIoIkxvY2F0aW9uOiAiLiRwZXJtbGluaywgVFJVRSwgMzAxKTsKCgkJICAvLyBJ
biBjYXNlIHRoZSBoZWFkZXIoKSBtZXRob2QgZmFpbHMsIGZhbGwgYmFjayBvbiBhIGNsYXNz
aWMgcmVkaXJlY3QKCQkgIGVjaG8gJzxodG1sPjxoZWFkPjxNRVRBIEhUVFAtRVFVSVY9IlJl
ZnJlc2giIENPTlRFTlQ9IjA7VVJMPScKCQkgICAgLiRwZXJtbGluay4nIj48L2hlYWQ+PGJv
ZHk+PC9ib2R5PjwvaHRtbD4nOwoJCSAgZGllKCk7CgkgIH0KICB9Cgp9CgovLyBBdXRvIGVu
YWJsZSBwbHVnaW4gb24gaW5zdGFsbCAob3JpZ2luYWwgaWRlYSBieSBNaWNoYWVsIE1hbmZy
ZSkKZnVuY3Rpb24gX2FyY190d2l0dGVyX2F1dG9fZW5hYmxlKCRldmVudCwgJHN0ZXAsICRw
cmVmaXg9J2FyY190d2l0dGVyJykKewogICRwbHVnaW4gPSBzdWJzdHIoJGV2ZW50LCBzdHJs
ZW4oJ3BsdWdpbl9saWZlY3ljbGUuJykpOwogIGlmIChzdHJuY21wKCRwbHVnaW4sICRwcmVm
aXgsIHN0cmxlbigkcHJlZml4KSkgPT0gMCkKICB7CiAgICBzYWZlX3VwZGF0ZSgndHhwX3Bs
dWdpbicsICJzdGF0dXMgPSAxIiwgIm5hbWUgPSAnIiAuIGRvU2xhc2goJHBsdWdpbikgLiAi
JyIpOwogIH0KfQoKLyoKICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKKi8KCmNsYXNzIGFy
Y190d2l0dGVyIGV4dGVuZHMgVHdpdHRlck9BdXRoIHsKICAgIC8vIENhY2hpbmcgdmFyaWFi
bGVzCiAgICBwcml2YXRlICRfY2FjaGUgPSB0cnVlOwogICAgcHJpdmF0ZSAkX2NhY2hlX2Rp
ciA9ICcuL3RtcCc7CiAgICBwcml2YXRlICRfY2FjaGVfdGltZSA9IDE4MDA7IC8vIDMwIG1p
bnV0ZSBjYWNoZQoKICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRjb25zdW1lcl9rZXksICRj
b25zdW1lcl9zZWNyZXQsICRvYXV0aF90b2tlbiA9IE5VTEwKICAgICAgICAsICRvYXV0aF90
b2tlbl9zZWNyZXQgPSBOVUxMKQogICAgewogICAgICAgIHBhcmVudDo6X19jb25zdHJ1Y3Qo
JGNvbnN1bWVyX2tleSwgJGNvbnN1bWVyX3NlY3JldCwgJG9hdXRoX3Rva2VuCiAgICAgICAg
ICAgICwgJG9hdXRoX3Rva2VuX3NlY3JldCk7CiAgICAgICAgJHRoaXMtPmZvcm1hdCA9ICd4
bWwnOwogICAgICAgICR0aGlzLT50aW1lb3V0ID0gMTU7CiAgICAgICAgJHRoaXMtPmNvbm5l
Y3R0aW1lb3V0ID0gMTU7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGNhbGxiYWNrVVJM
KCRldmVudCwkc3RlcCkKICAgIHsKICAgICAgICByZXR1cm4gcHJlZ19yZXBsYWNlKCcvXD8u
Ki8nLCAnJyxQUk9UT0NPTC4kX1NFUlZFUlsnU0VSVkVSX05BTUUnXS4kX1NFUlZFUlsnUkVR
VUVTVF9VUkknXSkKICAgICAgICAgIC4nP2V2ZW50PScuJGV2ZW50LicmYW1wO3N0ZXA9Jy4k
c3RlcDsKICAgIH0KCiAgICAvLyBjcmVhdGUgVHdpdHRlciBhbmQgZXh0ZXJuYWwgbGlua3Mg
aW4gdGV4dAogICAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBtYWtlTGlua3MoJHRleHQpCiAg
ICB7CiAgICAgICAgJHVybCA9ICcvXGIoaHR0cHxodHRwc3xmdHApOlwvXC8oW0EtWjAtOV1b
QS1aMC05Xy1dKig/OlwuW0EtWjAtOV1bQS1aMC05Xy1dKikrKTo/KFxkKyk/XC8/KFtcL1x3
K1wuXSspXGIvaSc7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2UoJHVybCwgIjxhIGhy
ZWY9JyQwJz4kMDwvYT4iLCAkdGV4dCk7CiAgICAgICAgJHVybCA9ICcvXGIoXnxccyl3d3cu
KFthLXpfQS1aMC05XSspKChcLlthLXpdKykrKVxiL2knOwogICAgICAgICR0ZXh0ID0gcHJl
Z19yZXBsYWNlKCR1cmwsICI8YSBocmVmPSdodHRwOi8vd3d3LiQyJDMnPnd3dy4kMiQzPC9h
PiIsICR0ZXh0KTsKICAgICAgICAkdGV4dCA9IHByZWdfcmVwbGFjZSgiLyhefFxzKUAoW2Et
el9BLVowLTldKykvIiwKICAgICAgICAgICAgIiQxQDxhIGhyZWY9J2h0dHA6Ly90d2l0dGVy
LmNvbS8kMic+JDI8L2E+IiwkdGV4dCk7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2Uo
Ii8oXnxccykoXCMoW2Etel9BLVowLTk6Xy1dKykpLyIsCiAgICAgICAgICAgICIkMTxhIGhy
ZWY9J2h0dHA6Ly90d2l0dGVyLmNvbS9zZWFyY2g/cT0lMjMkMyc+JDI8L2E+IiwkdGV4dCk7
CiAgICAgICAgcmV0dXJuICR0ZXh0OwogIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gZ2V0KCR1
cmwsICRwYXJhbXMgPSBhcnJheSgpKQogICAgewogICAgICAgICRhcGlfdXJsID0gbWQ1KCR1
cmwudXJsZW5jb2RlKHNlcmlhbGl6ZSgkcGFyYW1zKSkpOwogICAgICAgICRkYXRhID0gJyc7
CgogICAgICAgIGlmICgkdGhpcy0+X2NhY2hlKSB7IC8vIGNoZWNrIGZvciBjYWNoZWQgeG1s
CgogICAgICAgICAgICAkZGF0YSA9ICR0aGlzLT5fcmV0cmlldmVDYWNoZSgkYXBpX3VybCk7
CgogICAgICAgIH0KICAgICAgICBpZiAoZW1wdHkoJGRhdGEpKSB7CiAgICAgICAgICAgICRk
YXRhID0gcGFyZW50OjpnZXQoJHVybCwgJHBhcmFtcyk7CiAgICAgICAgICAgIGlmICgkdGhp
cy0+aHR0cF9jb2RlPT09MjAwICYmICR4bWw9c2ltcGxleG1sX2xvYWRfc3RyaW5nKCRkYXRh
KSkgeyAvLyBzYXZlIGNhY2hlCiAgICAgICAgICAgICAgICAkZmlsZSA9ICR0aGlzLT5fY2Fj
aGVfZGlyLicvJy4kYXBpX3VybDsKICAgICAgICAgICAgICAgIGZpbGVfcHV0X2NvbnRlbnRz
KCRmaWxlLCRkYXRhLExPQ0tfRVgpOwogICAgICAgICAgICAgICAgcmV0dXJuICR4bWw7CiAg
ICAgICAgICAgIH0gZWxzZSB7IC8vIGZhaWxlZCB0byByZXRyaWV2ZSBkYXRhIGZyb20gVHdp
dHRlcgoKICAgICAgICAgICAgICAgIGlmICgkdGhpcy0+X2NhY2hlKSB7IC8vIGF0dGVtcHQg
dG8gZm9yY2UgY2FjaGVkIHhtbCByZXR1cm4KCiAgICAgICAgICAgICAgICAgICAgJGRhdGEg
PSAkdGhpcy0+X3JldHJpZXZlQ2FjaGUoJGFwaV91cmwsdHJ1ZSk7CiAgICAgICAgICAgICAg
ICAgICAgaWYgKCRkYXRhKSByZXR1cm4gQHNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSk7
CgogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAg
ICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgeyAvLyByZXR1cm4gY2FjaGVkIHhtbAogICAg
ICAgICAgICByZXR1cm4gQHNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSk7CiAgICAgICAg
fQogICAgfSAvL2VuZCBnZXQoKQoKICAgIGZ1bmN0aW9uIHBvc3QoJHVybCwgJHBhcmFtcyA9
IGFycmF5KCkpCiAgICB7CiAgICAgICAgJGRhdGEgPSBwYXJlbnQ6OnBvc3QoJHVybCwkcGFy
YW1zKTsKICAgICAgICByZXR1cm4gc2ltcGxleG1sX2xvYWRfc3RyaW5nKCRkYXRhKTsKICAg
IH0KCiAgICBmdW5jdGlvbiBkZWxldGUoJHVybCwgJHBhcmFtcyA9IGFycmF5KCkpCiAgICB7
CiAgICAgICAgJGRhdGEgPSBwYXJlbnQ6OmRlbGV0ZSgkdXJsLCRwYXJhbXMpOwogICAgICAg
IHJldHVybiBzaW1wbGV4bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwogICAgfQoKICAgIC8vIENh
Y2hlIG1ldGhvZHMKCiAgICBwdWJsaWMgZnVuY3Rpb24gc2V0Q2FjaGluZygkY2FjaGU9dHJ1
ZSkKICAgIHsKICAgICAgICAkdGhpcy0+X2NhY2hlID0gKCRjYWNoZSkgPyB0cnVlIDogZmFs
c2U7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGNh
Y2hlRGlyKCRsb2MpCiAgICB7CiAgICAgICAgJHRoaXMtPl9jYWNoZV9kaXIgPSAkbG9jOwog
ICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjYWNoZVRp
bWUoJG1pbnMpCiAgICB7CiAgICAgICAgJHRoaXMtPl9jYWNoZV90aW1lID0gJG1pbnMqNjA7
IC8vIGNvbnZlcnQgbWludXRlcyBpbnRvIHNlY29uZHMKICAgICAgICByZXR1cm4gdHJ1ZTsK
ICAgIH0KCiAgICBwcml2YXRlIGZ1bmN0aW9uIF9yZXRyaWV2ZUNhY2hlKCR1cmwsJG92ZXJp
ZGVfdGltZW91dD1mYWxzZSkKICAgIHsKICAgICAgICAkZmlsZSA9ICR0aGlzLT5fY2FjaGVf
ZGlyLicvJy4kdXJsOwogICAgICAgIGlmIChmaWxlX2V4aXN0cygkZmlsZSkpIHsKCiAgICAg
ICAgICAgICRkaWZmID0gdGltZSgpIC0gZmlsZW10aW1lKCRmaWxlKTsKICAgICAgICAgICAg
aWYgKCRvdmVyaWRlX3RpbWVvdXQgfHwgJGRpZmYgPCAkdGhpcy0+X2NhY2hlX3RpbWUpIHsK
ICAgICAgICAgICAgICAgIHJldHVybiBmaWxlX2dldF9jb250ZW50cygkZmlsZSk7CiAgICAg
ICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAg
ICAgIH0KCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg
ICAgIH0KICAgIH0KfQoKLyoKICogQWJyYWhhbSBXaWxsaWFtcyAoYWJyYWhhbUBhYnJhaC5h
bSkgaHR0cDovL2FicmFoLmFtCiAqCiAqIFRoZSBmaXJzdCBQSFAgTGlicmFyeSB0byBzdXBw
b3J0IE9BdXRoIGZvciBUd2l0dGVyJ3MgUkVTVCBBUEkuCiAqLwoKLyoqCiAqIFR3aXR0ZXIg
T0F1dGggY2xhc3MKICovCmNsYXNzIFR3aXR0ZXJPQXV0aCB7CiAgLyogQ29udGFpbnMgdGhl
IGxhc3QgSFRUUCBzdGF0dXMgY29kZSByZXR1cm5lZC4gKi8KICBwdWJsaWMgJGh0dHBfY29k
ZTsKICAvKiBDb250YWlucyB0aGUgbGFzdCBBUEkgY2FsbC4gKi8KICBwdWJsaWMgJHVybDsK
ICAvKiBTZXQgdXAgdGhlIEFQSSByb290IFVSTC4gKi8KICBwdWJsaWMgJGhvc3QgPSAiaHR0
cHM6Ly9hcGkudHdpdHRlci5jb20vMS8iOwogIC8qIFNldCB0aW1lb3V0IGRlZmF1bHQuICov
CiAgcHVibGljICR0aW1lb3V0ID0gMzA7CiAgLyogU2V0IGNvbm5lY3QgdGltZW91dC4gKi8K
ICBwdWJsaWMgJGNvbm5lY3R0aW1lb3V0ID0gMzA7CiAgLyogVmVyaWZ5IFNTTCBDZXJ0LiAq
LwogIHB1YmxpYyAkc3NsX3ZlcmlmeXBlZXIgPSBGQUxTRTsKICAvKiBSZXNwb25zIGZvcm1h
dC4gKi8KICBwdWJsaWMgJGZvcm1hdCA9ICdqc29uJzsKICAvKiBEZWNvZGUgcmV0dXJuZWQg
anNvbiBkYXRhLiAqLwogIHB1YmxpYyAkZGVjb2RlX2pzb24gPSBUUlVFOwogIC8qIENvbnRh
aW5zIHRoZSBsYXN0IEhUVFAgaGVhZGVycyByZXR1cm5lZC4gKi8KICBwdWJsaWMgJGh0dHBf
aW5mbzsKICAvKiBTZXQgdGhlIHVzZXJhZ25ldC4gKi8KICBwdWJsaWMgJHVzZXJhZ2VudCA9
ICdUd2l0dGVyT0F1dGggdjAuMi4wLWJldGEyJzsKICAvKiBJbW1lZGlhdGVseSByZXRyeSB0
aGUgQVBJIGNhbGwgaWYgdGhlIHJlc3BvbnNlIHdhcyBub3Qgc3VjY2Vzc2Z1bC4gKi8KICAv
L3B1YmxpYyAkcmV0cnkgPSBUUlVFOwoKCgoKICAvKioKICAgKiBTZXQgQVBJIFVSTFMKICAg
Ki8KICBmdW5jdGlvbiBhY2Nlc3NUb2tlblVSTCgpICB7IHJldHVybiAnaHR0cHM6Ly9hcGku
dHdpdHRlci5jb20vb2F1dGgvYWNjZXNzX3Rva2VuJzsgfQogIGZ1bmN0aW9uIGF1dGhlbnRp
Y2F0ZVVSTCgpIHsgcmV0dXJuICdodHRwczovL3R3aXR0ZXIuY29tL29hdXRoL2F1dGhlbnRp
Y2F0ZSc7IH0KICBmdW5jdGlvbiBhdXRob3JpemVVUkwoKSAgICB7IHJldHVybiAnaHR0cHM6
Ly90d2l0dGVyLmNvbS9vYXV0aC9hdXRob3JpemUnOyB9CiAgZnVuY3Rpb24gcmVxdWVzdFRv
a2VuVVJMKCkgeyByZXR1cm4gJ2h0dHBzOi8vYXBpLnR3aXR0ZXIuY29tL29hdXRoL3JlcXVl
c3RfdG9rZW4nOyB9CgogIC8qKgogICAqIERlYnVnIGhlbHBlcnMKICAgKi8KICBmdW5jdGlv
biBsYXN0U3RhdHVzQ29kZSgpIHsgcmV0dXJuICR0aGlzLT5odHRwX3N0YXR1czsgfQogIGZ1
bmN0aW9uIGxhc3RBUElDYWxsKCkgeyByZXR1cm4gJHRoaXMtPmxhc3RfYXBpX2NhbGw7IH0K
CiAgLyoqCiAgICogY29uc3RydWN0IFR3aXR0ZXJPQXV0aCBvYmplY3QKICAgKi8KICBmdW5j
dGlvbiBfX2NvbnN0cnVjdCgkY29uc3VtZXJfa2V5LCAkY29uc3VtZXJfc2VjcmV0LCAkb2F1
dGhfdG9rZW4gPSBOVUxMLCAkb2F1dGhfdG9rZW5fc2VjcmV0ID0gTlVMTCkgewogICAgJHRo
aXMtPnNoYTFfbWV0aG9kID0gbmV3IE9BdXRoU2lnbmF0dXJlTWV0aG9kX0hNQUNfU0hBMSgp
OwogICAgJHRoaXMtPmNvbnN1bWVyID0gbmV3IE9BdXRoQ29uc3VtZXIoJGNvbnN1bWVyX2tl
eSwgJGNvbnN1bWVyX3NlY3JldCk7CiAgICBpZiAoIWVtcHR5KCRvYXV0aF90b2tlbikgJiYg
IWVtcHR5KCRvYXV0aF90b2tlbl9zZWNyZXQpKSB7CiAgICAgICR0aGlzLT50b2tlbiA9IG5l
dyBPQXV0aENvbnN1bWVyKCRvYXV0aF90b2tlbiwgJG9hdXRoX3Rva2VuX3NlY3JldCk7CiAg
ICB9IGVsc2UgewogICAgICAkdGhpcy0+dG9rZW4gPSBOVUxMOwogICAgfQogIH0KCgogIC8q
KgogICAqIEdldCBhIHJlcXVlc3RfdG9rZW4gZnJvbSBUd2l0dGVyCiAgICoKICAgKiBAcmV0
dXJucyBhIGtleS92YWx1ZSBhcnJheSBjb250YWluaW5nIG9hdXRoX3Rva2VuIGFuZCBvYXV0
aF90b2tlbl9zZWNyZXQKICAgKi8KICBmdW5jdGlvbiBnZXRSZXF1ZXN0VG9rZW4oJG9hdXRo
X2NhbGxiYWNrID0gTlVMTCkgewogICAgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgaWYg
KCFlbXB0eSgkb2F1dGhfY2FsbGJhY2spKSB7CiAgICAgICRwYXJhbWV0ZXJzWydvYXV0aF9j
YWxsYmFjayddID0gJG9hdXRoX2NhbGxiYWNrOwogICAgfQogICAgJHJlcXVlc3QgPSAkdGhp
cy0+b0F1dGhSZXF1ZXN0KCR0aGlzLT5yZXF1ZXN0VG9rZW5VUkwoKSwgJ0dFVCcsICRwYXJh
bWV0ZXJzKTsKICAgICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVycygkcmVx
dWVzdCk7CiAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigkdG9rZW5bJ29h
dXRoX3Rva2VuJ10sICR0b2tlblsnb2F1dGhfdG9rZW5fc2VjcmV0J10pOwogICAgcmV0dXJu
ICR0b2tlbjsKICB9CgogIC8qKgogICAqIEdldCB0aGUgYXV0aG9yaXplIFVSTAogICAqCiAg
ICogQHJldHVybnMgYSBzdHJpbmcKICAgKi8KICBmdW5jdGlvbiBnZXRBdXRob3JpemVVUkwo
JHRva2VuLCAkc2lnbl9pbl93aXRoX3R3aXR0ZXIgPSBUUlVFKSB7CiAgICBpZiAoaXNfYXJy
YXkoJHRva2VuKSkgewogICAgICAkdG9rZW4gPSAkdG9rZW5bJ29hdXRoX3Rva2VuJ107CiAg
ICB9CiAgICBpZiAoZW1wdHkoJHNpZ25faW5fd2l0aF90d2l0dGVyKSkgewogICAgICByZXR1
cm4gJHRoaXMtPmF1dGhvcml6ZVVSTCgpIC4gIj9vYXV0aF90b2tlbj17JHRva2VufSI7CiAg
ICB9IGVsc2UgewogICAgICAgcmV0dXJuICR0aGlzLT5hdXRoZW50aWNhdGVVUkwoKSAuICI/
b2F1dGhfdG9rZW49eyR0b2tlbn0iOwogICAgfQogIH0KCiAgLyoqCiAgICogRXhjaGFuZ2Ug
cmVxdWVzdCB0b2tlbiBhbmQgc2VjcmV0IGZvciBhbiBhY2Nlc3MgdG9rZW4gYW5kCiAgICog
c2VjcmV0LCB0byBzaWduIEFQSSBjYWxscy4KICAgKgogICAqIEByZXR1cm5zIGFycmF5KCJv
YXV0aF90b2tlbiIgPT4gInRoZS1hY2Nlc3MtdG9rZW4iLAogICAqICAgICAgICAgICAgICAg
ICJvYXV0aF90b2tlbl9zZWNyZXQiID0+ICJ0aGUtYWNjZXNzLXNlY3JldCIsCiAgICogICAg
ICAgICAgICAgICAgInVzZXJfaWQiID0+ICI5NDM2OTkyIiwKICAgKiAgICAgICAgICAgICAg
ICAic2NyZWVuX25hbWUiID0+ICJhYnJhaGFtIikKICAgKi8KICBmdW5jdGlvbiBnZXRBY2Nl
c3NUb2tlbigkb2F1dGhfdmVyaWZpZXIgPSBGQUxTRSkgewogICAgJHBhcmFtZXRlcnMgPSBh
cnJheSgpOwogICAgaWYgKCFlbXB0eSgkb2F1dGhfdmVyaWZpZXIpKSB7CiAgICAgICRwYXJh
bWV0ZXJzWydvYXV0aF92ZXJpZmllciddID0gJG9hdXRoX3ZlcmlmaWVyOwogICAgfQogICAg
JHJlcXVlc3QgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR0aGlzLT5hY2Nlc3NUb2tlblVSTCgp
LCAnR0VUJywgJHBhcmFtZXRlcnMpOwogICAgJHRva2VuID0gT0F1dGhVdGlsOjpwYXJzZV9w
YXJhbWV0ZXJzKCRyZXF1ZXN0KTsKICAgICR0aGlzLT50b2tlbiA9IG5ldyBPQXV0aENvbnN1
bWVyKCR0b2tlblsnb2F1dGhfdG9rZW4nXSwgJHRva2VuWydvYXV0aF90b2tlbl9zZWNyZXQn
XSk7CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAgLyoqCiAgICogT25lIHRpbWUgZXhjaGFu
Z2Ugb2YgdXNlcm5hbWUgYW5kIHBhc3N3b3JkIGZvciBhY2Nlc3MgdG9rZW4gYW5kIHNlY3Jl
dC4KICAgKgogICAqIEByZXR1cm5zIGFycmF5KCJvYXV0aF90b2tlbiIgPT4gInRoZS1hY2Nl
c3MtdG9rZW4iLAogICAqICAgICAgICAgICAgICAgICJvYXV0aF90b2tlbl9zZWNyZXQiID0+
ICJ0aGUtYWNjZXNzLXNlY3JldCIsCiAgICogICAgICAgICAgICAgICAgInVzZXJfaWQiID0+
ICI5NDM2OTkyIiwKICAgKiAgICAgICAgICAgICAgICAic2NyZWVuX25hbWUiID0+ICJhYnJh
aGFtIiwKICAgKiAgICAgICAgICAgICAgICAieF9hdXRoX2V4cGlyZXMiID0+ICIwIikKICAg
Ki8KICBmdW5jdGlvbiBnZXRYQXV0aFRva2VuKCR1c2VybmFtZSwgJHBhc3N3b3JkKSB7CiAg
ICAkcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICAkcGFyYW1ldGVyc1sneF9hdXRoX3VzZXJu
YW1lJ10gPSAkdXNlcm5hbWU7CiAgICAkcGFyYW1ldGVyc1sneF9hdXRoX3Bhc3N3b3JkJ10g
PSAkcGFzc3dvcmQ7CiAgICAkcGFyYW1ldGVyc1sneF9hdXRoX21vZGUnXSA9ICdjbGllbnRf
YXV0aCc7CiAgICAkcmVxdWVzdCA9ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHRoaXMtPmFjY2Vz
c1Rva2VuVVJMKCksICdQT1NUJywgJHBhcmFtZXRlcnMpOwogICAgJHRva2VuID0gT0F1dGhV
dGlsOjpwYXJzZV9wYXJhbWV0ZXJzKCRyZXF1ZXN0KTsKICAgICR0aGlzLT50b2tlbiA9IG5l
dyBPQXV0aENvbnN1bWVyKCR0b2tlblsnb2F1dGhfdG9rZW4nXSwgJHRva2VuWydvYXV0aF90
b2tlbl9zZWNyZXQnXSk7CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAgLyoqCiAgICogR0VU
IHdyYXBwZXIgZm9yIG9BdXRoUmVxdWVzdC4KICAgKi8KICBmdW5jdGlvbiBnZXQoJHVybCwg
JHBhcmFtZXRlcnMgPSBhcnJheSgpKSB7CiAgICAkcmVzcG9uc2UgPSAkdGhpcy0+b0F1dGhS
ZXF1ZXN0KCR1cmwsICdHRVQnLCAkcGFyYW1ldGVycyk7CiAgICBpZiAoJHRoaXMtPmZvcm1h
dCA9PT0gJ2pzb24nICYmICR0aGlzLT5kZWNvZGVfanNvbikgewogICAgICByZXR1cm4ganNv
bl9kZWNvZGUoJHJlc3BvbnNlKTsKICAgIH0KICAgIHJldHVybiAkcmVzcG9uc2U7CiAgfQoK
ICAvKioKICAgKiBQT1NUIHdyYXBwZXIgZm9yIG9BdXRoUmVxdWVzdC4KICAgKi8KICBmdW5j
dGlvbiBwb3N0KCR1cmwsICRwYXJhbWV0ZXJzID0gYXJyYXkoKSkgewogICAgJHJlc3BvbnNl
ID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdXJsLCAnUE9TVCcsICRwYXJhbWV0ZXJzKTsKICAg
IGlmICgkdGhpcy0+Zm9ybWF0ID09PSAnanNvbicgJiYgJHRoaXMtPmRlY29kZV9qc29uKSB7
CiAgICAgIHJldHVybiBqc29uX2RlY29kZSgkcmVzcG9uc2UpOwogICAgfQogICAgcmV0dXJu
ICRyZXNwb25zZTsKICB9CgogIC8qKgogICAqIERFTEVURSB3cmFwcGVyIGZvciBvQXV0aFJl
cWV1c3QuCiAgICovCiAgZnVuY3Rpb24gZGVsZXRlKCR1cmwsICRwYXJhbWV0ZXJzID0gYXJy
YXkoKSkgewogICAgJHJlc3BvbnNlID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdXJsLCAnREVM
RVRFJywgJHBhcmFtZXRlcnMpOwogICAgaWYgKCR0aGlzLT5mb3JtYXQgPT09ICdqc29uJyAm
JiAkdGhpcy0+ZGVjb2RlX2pzb24pIHsKICAgICAgcmV0dXJuIGpzb25fZGVjb2RlKCRyZXNw
b25zZSk7CiAgICB9CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoqCiAgICogRm9y
bWF0IGFuZCBzaWduIGFuIE9BdXRoIC8gQVBJIHJlcXVlc3QKICAgKi8KICBmdW5jdGlvbiBv
QXV0aFJlcXVlc3QoJHVybCwgJG1ldGhvZCwgJHBhcmFtZXRlcnMpIHsKICAgIGlmIChzdHJy
cG9zKCR1cmwsICdodHRwczovLycpICE9PSAwICYmIHN0cnJwb3MoJHVybCwgJ2h0dHA6Ly8n
KSAhPT0gMCkgewogICAgICAkdXJsID0gInskdGhpcy0+aG9zdH17JHVybH0ueyR0aGlzLT5m
b3JtYXR9IjsKICAgIH0KICAgICRyZXF1ZXN0ID0gT0F1dGhSZXF1ZXN0Ojpmcm9tX2NvbnN1
bWVyX2FuZF90b2tlbigkdGhpcy0+Y29uc3VtZXIsICR0aGlzLT50b2tlbiwgJG1ldGhvZCwg
JHVybCwgJHBhcmFtZXRlcnMpOwogICAgJHJlcXVlc3QtPnNpZ25fcmVxdWVzdCgkdGhpcy0+
c2hhMV9tZXRob2QsICR0aGlzLT5jb25zdW1lciwgJHRoaXMtPnRva2VuKTsKICAgIHN3aXRj
aCAoJG1ldGhvZCkgewogICAgY2FzZSAnR0VUJzoKICAgICAgcmV0dXJuICR0aGlzLT5odHRw
KCRyZXF1ZXN0LT50b191cmwoKSwgJ0dFVCcpOwogICAgZGVmYXVsdDoKICAgICAgcmV0dXJu
ICR0aGlzLT5odHRwKCRyZXF1ZXN0LT5nZXRfbm9ybWFsaXplZF9odHRwX3VybCgpLCAkbWV0
aG9kLCAkcmVxdWVzdC0+dG9fcG9zdGRhdGEoKSk7CiAgICB9CiAgfQoKICAvKioKICAgKiBN
YWtlIGFuIEhUVFAgcmVxdWVzdAogICAqCiAgICogQHJldHVybiBBUEkgcmVzdWx0cwogICAq
LwogIGZ1bmN0aW9uIGh0dHAoJHVybCwgJG1ldGhvZCwgJHBvc3RmaWVsZHMgPSBOVUxMKSB7
CiAgICAkdGhpcy0+aHR0cF9pbmZvID0gYXJyYXkoKTsKICAgICRjaSA9IGN1cmxfaW5pdCgp
OwogICAgLyogQ3VybCBzZXR0aW5ncyAqLwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BU
X1VTRVJBR0VOVCwgJHRoaXMtPnVzZXJhZ2VudCk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENV
UkxPUFRfQ09OTkVDVFRJTUVPVVQsICR0aGlzLT5jb25uZWN0dGltZW91dCk7CiAgICBjdXJs
X3NldG9wdCgkY2ksIENVUkxPUFRfVElNRU9VVCwgJHRoaXMtPnRpbWVvdXQpOwogICAgY3Vy
bF9zZXRvcHQoJGNpLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCBUUlVFKTsKICAgIGN1cmxf
c2V0b3B0KCRjaSwgQ1VSTE9QVF9IVFRQSEVBREVSLCBhcnJheSgnRXhwZWN0OicpKTsKICAg
IGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9TU0xfVkVSSUZZUEVFUiwgJHRoaXMtPnNzbF92
ZXJpZnlwZWVyKTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9IRUFERVJGVU5DVElP
TiwgYXJyYXkoJHRoaXMsICdnZXRIZWFkZXInKSk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENV
UkxPUFRfSEVBREVSLCBGQUxTRSk7CgogICAgc3dpdGNoICgkbWV0aG9kKSB7CiAgICAgIGNh
c2UgJ1BPU1QnOgogICAgICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9QT1NULCBUUlVF
KTsKICAgICAgICBpZiAoIWVtcHR5KCRwb3N0ZmllbGRzKSkgewogICAgICAgICAgY3VybF9z
ZXRvcHQoJGNpLCBDVVJMT1BUX1BPU1RGSUVMRFMsICRwb3N0ZmllbGRzKTsKICAgICAgICB9
CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ0RFTEVURSc6CiAgICAgICAgY3VybF9zZXRv
cHQoJGNpLCBDVVJMT1BUX0NVU1RPTVJFUVVFU1QsICdERUxFVEUnKTsKICAgICAgICBpZiAo
IWVtcHR5KCRwb3N0ZmllbGRzKSkgewogICAgICAgICAgJHVybCA9ICJ7JHVybH0/eyRwb3N0
ZmllbGRzfSI7CiAgICAgICAgfQogICAgfQoKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9Q
VF9VUkwsICR1cmwpOwogICAgJHJlc3BvbnNlID0gY3VybF9leGVjKCRjaSk7CiAgICAkdGhp
cy0+aHR0cF9jb2RlID0gY3VybF9nZXRpbmZvKCRjaSwgQ1VSTElORk9fSFRUUF9DT0RFKTsK
ICAgICR0aGlzLT5odHRwX2luZm8gPSBhcnJheV9tZXJnZSgkdGhpcy0+aHR0cF9pbmZvLCBj
dXJsX2dldGluZm8oJGNpKSk7CiAgICAkdGhpcy0+dXJsID0gJHVybDsKICAgIGN1cmxfY2xv
c2UgKCRjaSk7CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoqCiAgICogR2V0IHRo
ZSBoZWFkZXIgaW5mbyB0byBzdG9yZS4KICAgKi8KICBmdW5jdGlvbiBnZXRIZWFkZXIoJGNo
LCAkaGVhZGVyKSB7CiAgICAkaSA9IHN0cnBvcygkaGVhZGVyLCAnOicpOwogICAgaWYgKCFl
bXB0eSgkaSkpIHsKICAgICAgJGtleSA9IHN0cl9yZXBsYWNlKCctJywgJ18nLCBzdHJ0b2xv
d2VyKHN1YnN0cigkaGVhZGVyLCAwLCAkaSkpKTsKICAgICAgJHZhbHVlID0gdHJpbShzdWJz
dHIoJGhlYWRlciwgJGkgKyAyKSk7CiAgICAgICR0aGlzLT5odHRwX2hlYWRlclska2V5XSA9
ICR2YWx1ZTsKICAgIH0KICAgIHJldHVybiBzdHJsZW4oJGhlYWRlcik7CiAgfQp9CgpjbGFz
cyBPQXV0aEV4Y2VwdGlvbiBleHRlbmRzIEV4Y2VwdGlvbiB7CiAgLy8gcGFzcwp9CgpjbGFz
cyBPQXV0aENvbnN1bWVyIHsKICBwdWJsaWMgJGtleTsKICBwdWJsaWMgJHNlY3JldDsKCiAg
ZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGtleSwgJHNlY3JldCwgJGNhbGxiYWNrX3VybD1OVUxM
KSB7CiAgICAkdGhpcy0+a2V5ID0gJGtleTsKICAgICR0aGlzLT5zZWNyZXQgPSAkc2VjcmV0
OwogICAgJHRoaXMtPmNhbGxiYWNrX3VybCA9ICRjYWxsYmFja191cmw7CiAgfQoKICBmdW5j
dGlvbiBfX3RvU3RyaW5nKCkgewogICAgcmV0dXJuICJPQXV0aENvbnN1bWVyW2tleT0kdGhp
cy0+a2V5LHNlY3JldD0kdGhpcy0+c2VjcmV0XSI7CiAgfQp9CgpjbGFzcyBPQXV0aFRva2Vu
IHsKICAvLyBhY2Nlc3MgdG9rZW5zIGFuZCByZXF1ZXN0IHRva2VucwogIHB1YmxpYyAka2V5
OwogIHB1YmxpYyAkc2VjcmV0OwoKICAvKioKICAgKiBrZXkgPSB0aGUgdG9rZW4KICAgKiBz
ZWNyZXQgPSB0aGUgdG9rZW4gc2VjcmV0CiAgICovCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3Qo
JGtleSwgJHNlY3JldCkgewogICAgJHRoaXMtPmtleSA9ICRrZXk7CiAgICAkdGhpcy0+c2Vj
cmV0ID0gJHNlY3JldDsKICB9CgogIC8qKgogICAqIGdlbmVyYXRlcyB0aGUgYmFzaWMgc3Ry
aW5nIHNlcmlhbGl6YXRpb24gb2YgYSB0b2tlbiB0aGF0IGEgc2VydmVyCiAgICogd291bGQg
cmVzcG9uZCB0byByZXF1ZXN0X3Rva2VuIGFuZCBhY2Nlc3NfdG9rZW4gY2FsbHMgd2l0aAog
ICAqLwogIGZ1bmN0aW9uIHRvX3N0cmluZygpIHsKICAgIHJldHVybiAib2F1dGhfdG9rZW49
IiAuCiAgICAgICAgICAgT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkdGhpcy0+a2V5
KSAuCiAgICAgICAgICAgIiZvYXV0aF90b2tlbl9zZWNyZXQ9IiAuCiAgICAgICAgICAgT0F1
dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkdGhpcy0+c2VjcmV0KTsKICB9CgogIGZ1bmN0
aW9uIF9fdG9TdHJpbmcoKSB7CiAgICByZXR1cm4gJHRoaXMtPnRvX3N0cmluZygpOwogIH0K
fQoKLyoqCiAqIEEgY2xhc3MgZm9yIGltcGxlbWVudGluZyBhIFNpZ25hdHVyZSBNZXRob2QK
ICogU2VlIHNlY3Rpb24gOSAoIlNpZ25pbmcgUmVxdWVzdHMiKSBpbiB0aGUgc3BlYwogKi8K
YWJzdHJhY3QgY2xhc3MgT0F1dGhTaWduYXR1cmVNZXRob2QgewogIC8qKgogICAqIE5lZWRz
IHRvIHJldHVybiB0aGUgbmFtZSBvZiB0aGUgU2lnbmF0dXJlIE1ldGhvZCAoaWUgSE1BQy1T
SEExKQogICAqIEByZXR1cm4gc3RyaW5nCiAgICovCiAgYWJzdHJhY3QgcHVibGljIGZ1bmN0
aW9uIGdldF9uYW1lKCk7CgogIC8qKgogICAqIEJ1aWxkIHVwIHRoZSBzaWduYXR1cmUKICAg
KiBOT1RFOiBUaGUgb3V0cHV0IG9mIHRoaXMgZnVuY3Rpb24gTVVTVCBOT1QgYmUgdXJsZW5j
b2RlZC4KICAgKiB0aGUgZW5jb2RpbmcgaXMgaGFuZGxlZCBpbiBPQXV0aFJlcXVlc3Qgd2hl
biB0aGUgZmluYWwKICAgKiByZXF1ZXN0IGlzIHNlcmlhbGl6ZWQKICAgKiBAcGFyYW0gT0F1
dGhSZXF1ZXN0ICRyZXF1ZXN0CiAgICogQHBhcmFtIE9BdXRoQ29uc3VtZXIgJGNvbnN1bWVy
CiAgICogQHBhcmFtIE9BdXRoVG9rZW4gJHRva2VuCiAgICogQHJldHVybiBzdHJpbmcKICAg
Ki8KICBhYnN0cmFjdCBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2lnbmF0dXJlKCRyZXF1ZXN0
LCAkY29uc3VtZXIsICR0b2tlbik7CgogIC8qKgogICAqIFZlcmlmaWVzIHRoYXQgYSBnaXZl
biBzaWduYXR1cmUgaXMgY29ycmVjdAogICAqIEBwYXJhbSBPQXV0aFJlcXVlc3QgJHJlcXVl
c3QKICAgKiBAcGFyYW0gT0F1dGhDb25zdW1lciAkY29uc3VtZXIKICAgKiBAcGFyYW0gT0F1
dGhUb2tlbiAkdG9rZW4KICAgKiBAcGFyYW0gc3RyaW5nICRzaWduYXR1cmUKICAgKiBAcmV0
dXJuIGJvb2wKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gY2hlY2tfc2lnbmF0dXJlKCRyZXF1
ZXN0LCAkY29uc3VtZXIsICR0b2tlbiwgJHNpZ25hdHVyZSkgewogICAgJGJ1aWx0ID0gJHRo
aXMtPmJ1aWxkX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAg
cmV0dXJuICRidWlsdCA9PSAkc2lnbmF0dXJlOwogIH0KfQoKLyoqCiAqIFRoZSBITUFDLVNI
QTEgc2lnbmF0dXJlIG1ldGhvZCB1c2VzIHRoZSBITUFDLVNIQTEgc2lnbmF0dXJlIGFsZ29y
aXRobSBhcyBkZWZpbmVkIGluIFtSRkMyMTA0XQogKiB3aGVyZSB0aGUgU2lnbmF0dXJlIEJh
c2UgU3RyaW5nIGlzIHRoZSB0ZXh0IGFuZCB0aGUga2V5IGlzIHRoZSBjb25jYXRlbmF0ZWQg
dmFsdWVzIChlYWNoIGZpcnN0CiAqIGVuY29kZWQgcGVyIFBhcmFtZXRlciBFbmNvZGluZykg
b2YgdGhlIENvbnN1bWVyIFNlY3JldCBhbmQgVG9rZW4gU2VjcmV0LCBzZXBhcmF0ZWQgYnkg
YW4gJyYnCiAqIGNoYXJhY3RlciAoQVNDSUkgY29kZSAzOCkgZXZlbiBpZiBlbXB0eS4KICog
ICAtIENoYXB0ZXIgOS4yICgiSE1BQy1TSEExIikKICovCmNsYXNzIE9BdXRoU2lnbmF0dXJl
TWV0aG9kX0hNQUNfU0hBMSBleHRlbmRzIE9BdXRoU2lnbmF0dXJlTWV0aG9kIHsKICBmdW5j
dGlvbiBnZXRfbmFtZSgpIHsKICAgIHJldHVybiAiSE1BQy1TSEExIjsKICB9CgogIHB1Ymxp
YyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2Vu
KSB7CiAgICAkYmFzZV9zdHJpbmcgPSAkcmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9iYXNlX3N0
cmluZygpOwogICAgJHJlcXVlc3QtPmJhc2Vfc3RyaW5nID0gJGJhc2Vfc3RyaW5nOwoKICAg
ICRrZXlfcGFydHMgPSBhcnJheSgKICAgICAgJGNvbnN1bWVyLT5zZWNyZXQsCiAgICAgICgk
dG9rZW4pID8gJHRva2VuLT5zZWNyZXQgOiAiIgogICAgKTsKCiAgICAka2V5X3BhcnRzID0g
T0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4Nigka2V5X3BhcnRzKTsKICAgICRrZXkgPSBp
bXBsb2RlKCcmJywgJGtleV9wYXJ0cyk7CgogICAgcmV0dXJuIGJhc2U2NF9lbmNvZGUoaGFz
aF9obWFjKCdzaGExJywgJGJhc2Vfc3RyaW5nLCAka2V5LCB0cnVlKSk7CiAgfQp9CgovKioK
ICogVGhlIFBMQUlOVEVYVCBtZXRob2QgZG9lcyBub3QgcHJvdmlkZSBhbnkgc2VjdXJpdHkg
cHJvdGVjdGlvbiBhbmQgU0hPVUxEIG9ubHkgYmUgdXNlZAogKiBvdmVyIGEgc2VjdXJlIGNo
YW5uZWwgc3VjaCBhcyBIVFRQUy4gSXQgZG9lcyBub3QgdXNlIHRoZSBTaWduYXR1cmUgQmFz
ZSBTdHJpbmcuCiAqICAgLSBDaGFwdGVyIDkuNCAoIlBMQUlOVEVYVCIpCiAqLwpjbGFzcyBP
QXV0aFNpZ25hdHVyZU1ldGhvZF9QTEFJTlRFWFQgZXh0ZW5kcyBPQXV0aFNpZ25hdHVyZU1l
dGhvZCB7CiAgcHVibGljIGZ1bmN0aW9uIGdldF9uYW1lKCkgewogICAgcmV0dXJuICJQTEFJ
TlRFWFQiOwogIH0KCiAgLyoqCiAgICogb2F1dGhfc2lnbmF0dXJlIGlzIHNldCB0byB0aGUg
Y29uY2F0ZW5hdGVkIGVuY29kZWQgdmFsdWVzIG9mIHRoZSBDb25zdW1lciBTZWNyZXQgYW5k
CiAgICogVG9rZW4gU2VjcmV0LCBzZXBhcmF0ZWQgYnkgYSAnJicgY2hhcmFjdGVyIChBU0NJ
SSBjb2RlIDM4KSwgZXZlbiBpZiBlaXRoZXIgc2VjcmV0IGlzCiAgICogZW1wdHkuIFRoZSBy
ZXN1bHQgTVVTVCBiZSBlbmNvZGVkIGFnYWluLgogICAqICAgLSBDaGFwdGVyIDkuNC4xICgi
R2VuZXJhdGluZyBTaWduYXR1cmVzIikKICAgKgogICAqIFBsZWFzZSBub3RlIHRoYXQgdGhl
IHNlY29uZCBlbmNvZGluZyBNVVNUIE5PVCBoYXBwZW4gaW4gdGhlIFNpZ25hdHVyZU1ldGhv
ZCwgYXMKICAgKiBPQXV0aFJlcXVlc3QgaGFuZGxlcyB0aGlzIQogICAqLwogIHB1YmxpYyBm
dW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7
CiAgICAka2V5X3BhcnRzID0gYXJyYXkoCiAgICAgICRjb25zdW1lci0+c2VjcmV0LAogICAg
ICAoJHRva2VuKSA/ICR0b2tlbi0+c2VjcmV0IDogIiIKICAgICk7CgogICAgJGtleV9wYXJ0
cyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJGtleV9wYXJ0cyk7CiAgICAka2V5
ID0gaW1wbG9kZSgnJicsICRrZXlfcGFydHMpOwogICAgJHJlcXVlc3QtPmJhc2Vfc3RyaW5n
ID0gJGtleTsKCiAgICByZXR1cm4gJGtleTsKICB9Cn0KCi8qKgogKiBUaGUgUlNBLVNIQTEg
c2lnbmF0dXJlIG1ldGhvZCB1c2VzIHRoZSBSU0FTU0EtUEtDUzEtdjFfNSBzaWduYXR1cmUg
YWxnb3JpdGhtIGFzIGRlZmluZWQgaW4KICogW1JGQzM0NDddIHNlY3Rpb24gOC4yIChtb3Jl
IHNpbXBseSBrbm93biBhcyBQS0NTIzEpLCB1c2luZyBTSEEtMSBhcyB0aGUgaGFzaCBmdW5j
dGlvbiBmb3IKICogRU1TQS1QS0NTMS12MV81LiBJdCBpcyBhc3N1bWVkIHRoYXQgdGhlIENv
bnN1bWVyIGhhcyBwcm92aWRlZCBpdHMgUlNBIHB1YmxpYyBrZXkgaW4gYQogKiB2ZXJpZmll
ZCB3YXkgdG8gdGhlIFNlcnZpY2UgUHJvdmlkZXIsIGluIGEgbWFubmVyIHdoaWNoIGlzIGJl
eW9uZCB0aGUgc2NvcGUgb2YgdGhpcwogKiBzcGVjaWZpY2F0aW9uLgogKiAgIC0gQ2hhcHRl
ciA5LjMgKCJSU0EtU0hBMSIpCiAqLwphYnN0cmFjdCBjbGFzcyBPQXV0aFNpZ25hdHVyZU1l
dGhvZF9SU0FfU0hBMSBleHRlbmRzIE9BdXRoU2lnbmF0dXJlTWV0aG9kIHsKICBwdWJsaWMg
ZnVuY3Rpb24gZ2V0X25hbWUoKSB7CiAgICByZXR1cm4gIlJTQS1TSEExIjsKICB9CgogIC8v
IFVwIHRvIHRoZSBTUCB0byBpbXBsZW1lbnQgdGhpcyBsb29rdXAgb2Yga2V5cy4gUG9zc2li
bGUgaWRlYXMgYXJlOgogIC8vICgxKSBkbyBhIGxvb2t1cCBpbiBhIHRhYmxlIG9mIHRydXN0
ZWQgY2VydHMga2V5ZWQgb2ZmIG9mIGNvbnN1bWVyCiAgLy8gKDIpIGZldGNoIHZpYSBodHRw
IHVzaW5nIGEgdXJsIHByb3ZpZGVkIGJ5IHRoZSByZXF1ZXN0ZXIKICAvLyAoMykgc29tZSBz
b3J0IG9mIHNwZWNpZmljIGRpc2NvdmVyeSBjb2RlIGJhc2VkIG9uIHJlcXVlc3QKICAvLwog
IC8vIEVpdGhlciB3YXkgc2hvdWxkIHJldHVybiBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBv
ZiB0aGUgY2VydGlmaWNhdGUKICBwcm90ZWN0ZWQgYWJzdHJhY3QgZnVuY3Rpb24gZmV0Y2hf
cHVibGljX2NlcnQoJiRyZXF1ZXN0KTsKCiAgLy8gVXAgdG8gdGhlIFNQIHRvIGltcGxlbWVu
dCB0aGlzIGxvb2t1cCBvZiBrZXlzLiBQb3NzaWJsZSBpZGVhcyBhcmU6CiAgLy8gKDEpIGRv
IGEgbG9va3VwIGluIGEgdGFibGUgb2YgdHJ1c3RlZCBjZXJ0cyBrZXllZCBvZmYgb2YgY29u
c3VtZXIKICAvLwogIC8vIEVpdGhlciB3YXkgc2hvdWxkIHJldHVybiBhIHN0cmluZyByZXBy
ZXNlbnRhdGlvbiBvZiB0aGUgY2VydGlmaWNhdGUKICBwcm90ZWN0ZWQgYWJzdHJhY3QgZnVu
Y3Rpb24gZmV0Y2hfcHJpdmF0ZV9jZXJ0KCYkcmVxdWVzdCk7CgogIHB1YmxpYyBmdW5jdGlv
biBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAk
YmFzZV9zdHJpbmcgPSAkcmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpOwog
ICAgJHJlcXVlc3QtPmJhc2Vfc3RyaW5nID0gJGJhc2Vfc3RyaW5nOwoKICAgIC8vIEZldGNo
IHRoZSBwcml2YXRlIGtleSBjZXJ0IGJhc2VkIG9uIHRoZSByZXF1ZXN0CiAgICAkY2VydCA9
ICR0aGlzLT5mZXRjaF9wcml2YXRlX2NlcnQoJHJlcXVlc3QpOwoKICAgIC8vIFB1bGwgdGhl
IHByaXZhdGUga2V5IElEIGZyb20gdGhlIGNlcnRpZmljYXRlCiAgICAkcHJpdmF0ZWtleWlk
ID0gb3BlbnNzbF9nZXRfcHJpdmF0ZWtleSgkY2VydCk7CgogICAgLy8gU2lnbiB1c2luZyB0
aGUga2V5CiAgICAkb2sgPSBvcGVuc3NsX3NpZ24oJGJhc2Vfc3RyaW5nLCAkc2lnbmF0dXJl
LCAkcHJpdmF0ZWtleWlkKTsKCiAgICAvLyBSZWxlYXNlIHRoZSBrZXkgcmVzb3VyY2UKICAg
IG9wZW5zc2xfZnJlZV9rZXkoJHByaXZhdGVrZXlpZCk7CgogICAgcmV0dXJuIGJhc2U2NF9l
bmNvZGUoJHNpZ25hdHVyZSk7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gY2hlY2tfc2lnbmF0
dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbiwgJHNpZ25hdHVyZSkgewogICAgJGRl
Y29kZWRfc2lnID0gYmFzZTY0X2RlY29kZSgkc2lnbmF0dXJlKTsKCiAgICAkYmFzZV9zdHJp
bmcgPSAkcmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpOwoKICAgIC8vIEZl
dGNoIHRoZSBwdWJsaWMga2V5IGNlcnQgYmFzZWQgb24gdGhlIHJlcXVlc3QKICAgICRjZXJ0
ID0gJHRoaXMtPmZldGNoX3B1YmxpY19jZXJ0KCRyZXF1ZXN0KTsKCiAgICAvLyBQdWxsIHRo
ZSBwdWJsaWMga2V5IElEIGZyb20gdGhlIGNlcnRpZmljYXRlCiAgICAkcHVibGlja2V5aWQg
PSBvcGVuc3NsX2dldF9wdWJsaWNrZXkoJGNlcnQpOwoKICAgIC8vIENoZWNrIHRoZSBjb21w
dXRlZCBzaWduYXR1cmUgYWdhaW5zdCB0aGUgb25lIHBhc3NlZCBpbiB0aGUgcXVlcnkKICAg
ICRvayA9IG9wZW5zc2xfdmVyaWZ5KCRiYXNlX3N0cmluZywgJGRlY29kZWRfc2lnLCAkcHVi
bGlja2V5aWQpOwoKICAgIC8vIFJlbGVhc2UgdGhlIGtleSByZXNvdXJjZQogICAgb3BlbnNz
bF9mcmVlX2tleSgkcHVibGlja2V5aWQpOwoKICAgIHJldHVybiAkb2sgPT0gMTsKICB9Cn0K
CmNsYXNzIE9BdXRoUmVxdWVzdCB7CiAgcHJpdmF0ZSAkcGFyYW1ldGVyczsKICBwcml2YXRl
ICRodHRwX21ldGhvZDsKICBwcml2YXRlICRodHRwX3VybDsKICAvLyBmb3IgZGVidWcgcHVy
cG9zZXMKICBwdWJsaWMgJGJhc2Vfc3RyaW5nOwogIHB1YmxpYyBzdGF0aWMgJHZlcnNpb24g
PSAnMS4wJzsKICBwdWJsaWMgc3RhdGljICRQT1NUX0lOUFVUID0gJ3BocDovL2lucHV0JzsK
CiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGh0dHBfbWV0aG9kLCAkaHR0cF91cmwsICRwYXJh
bWV0ZXJzPU5VTEwpIHsKICAgIEAkcGFyYW1ldGVycyBvciAkcGFyYW1ldGVycyA9IGFycmF5
KCk7CiAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCBPQXV0aFV0aWw6OnBhcnNlX3Bh
cmFtZXRlcnMocGFyc2VfdXJsKCRodHRwX3VybCwgUEhQX1VSTF9RVUVSWSkpLCAkcGFyYW1l
dGVycyk7CiAgICAkdGhpcy0+cGFyYW1ldGVycyA9ICRwYXJhbWV0ZXJzOwogICAgJHRoaXMt
Pmh0dHBfbWV0aG9kID0gJGh0dHBfbWV0aG9kOwogICAgJHRoaXMtPmh0dHBfdXJsID0gJGh0
dHBfdXJsOwogIH0KCgogIC8qKgogICAqIGF0dGVtcHQgdG8gYnVpbGQgdXAgYSByZXF1ZXN0
IGZyb20gd2hhdCB3YXMgcGFzc2VkIHRvIHRoZSBzZXJ2ZXIKICAgKi8KICBwdWJsaWMgc3Rh
dGljIGZ1bmN0aW9uIGZyb21fcmVxdWVzdCgkaHR0cF9tZXRob2Q9TlVMTCwgJGh0dHBfdXJs
PU5VTEwsICRwYXJhbWV0ZXJzPU5VTEwpIHsKICAgICRzY2hlbWUgPSAoIWlzc2V0KCRfU0VS
VkVSWydIVFRQUyddKSB8fCAkX1NFUlZFUlsnSFRUUFMnXSAhPSAib24iKQogICAgICAgICAg
ICAgID8gJ2h0dHAnCiAgICAgICAgICAgICAgOiAnaHR0cHMnOwogICAgQCRodHRwX3VybCBv
ciAkaHR0cF91cmwgPSAkc2NoZW1lIC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
JzovLycgLiAkX1NFUlZFUlsnSFRUUF9IT1NUJ10gLgogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAnOicgLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkX1NFUlZFUlsn
U0VSVkVSX1BPUlQnXSAuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRfU0VSVkVS
WydSRVFVRVNUX1VSSSddOwogICAgQCRodHRwX21ldGhvZCBvciAkaHR0cF9tZXRob2QgPSAk
X1NFUlZFUlsnUkVRVUVTVF9NRVRIT0QnXTsKCiAgICAvLyBXZSB3ZXJlbid0IGhhbmRlZCBh
bnkgcGFyYW1ldGVycywgc28gbGV0J3MgZmluZCB0aGUgb25lcyByZWxldmFudCB0bwogICAg
Ly8gdGhpcyByZXF1ZXN0LgogICAgLy8gSWYgeW91IHJ1biBYTUwtUlBDIG9yIHNpbWlsYXIg
eW91IHNob3VsZCB1c2UgdGhpcyB0byBwcm92aWRlIHlvdXIgb3duCiAgICAvLyBwYXJzZWQg
cGFyYW1ldGVyLWxpc3QKICAgIGlmICghJHBhcmFtZXRlcnMpIHsKICAgICAgLy8gRmluZCBy
ZXF1ZXN0IGhlYWRlcnMKICAgICAgJHJlcXVlc3RfaGVhZGVycyA9IE9BdXRoVXRpbDo6Z2V0
X2hlYWRlcnMoKTsKCiAgICAgIC8vIFBhcnNlIHRoZSBxdWVyeS1zdHJpbmcgdG8gZmluZCBH
RVQgcGFyYW1ldGVycwogICAgICAkcGFyYW1ldGVycyA9IE9BdXRoVXRpbDo6cGFyc2VfcGFy
YW1ldGVycygkX1NFUlZFUlsnUVVFUllfU1RSSU5HJ10pOwoKICAgICAgLy8gSXQncyBhIFBP
U1QgcmVxdWVzdCBvZiB0aGUgcHJvcGVyIGNvbnRlbnQtdHlwZSwgc28gcGFyc2UgUE9TVAog
ICAgICAvLyBwYXJhbWV0ZXJzIGFuZCBhZGQgdGhvc2Ugb3ZlcnJpZGluZyBhbnkgZHVwbGlj
YXRlcyBmcm9tIEdFVAogICAgICBpZiAoJGh0dHBfbWV0aG9kID09ICJQT1NUIgogICAgICAg
ICAgJiYgQHN0cnN0cigkcmVxdWVzdF9oZWFkZXJzWyJDb250ZW50LVR5cGUiXSwKICAgICAg
ICAgICAgICAgICAgICAgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpCiAg
ICAgICAgICApIHsKICAgICAgICAkcG9zdF9kYXRhID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJh
bWV0ZXJzKAogICAgICAgICAgZmlsZV9nZXRfY29udGVudHMoc2VsZjo6JFBPU1RfSU5QVVQp
CiAgICAgICAgKTsKICAgICAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCRwYXJhbWV0
ZXJzLCAkcG9zdF9kYXRhKTsKICAgICAgfQoKICAgICAgLy8gV2UgaGF2ZSBhIEF1dGhvcml6
YXRpb24taGVhZGVyIHdpdGggT0F1dGggZGF0YS4gUGFyc2UgdGhlIGhlYWRlcgogICAgICAv
LyBhbmQgYWRkIHRob3NlIG92ZXJyaWRpbmcgYW55IGR1cGxpY2F0ZXMgZnJvbSBHRVQgb3Ig
UE9TVAogICAgICBpZiAoQHN1YnN0cigkcmVxdWVzdF9oZWFkZXJzWydBdXRob3JpemF0aW9u
J10sIDAsIDYpID09ICJPQXV0aCAiKSB7CiAgICAgICAgJGhlYWRlcl9wYXJhbWV0ZXJzID0g
T0F1dGhVdGlsOjpzcGxpdF9oZWFkZXIoCiAgICAgICAgICAkcmVxdWVzdF9oZWFkZXJzWydB
dXRob3JpemF0aW9uJ10KICAgICAgICApOwogICAgICAgICRwYXJhbWV0ZXJzID0gYXJyYXlf
bWVyZ2UoJHBhcmFtZXRlcnMsICRoZWFkZXJfcGFyYW1ldGVycyk7CiAgICAgIH0KCiAgICB9
CgogICAgcmV0dXJuIG5ldyBPQXV0aFJlcXVlc3QoJGh0dHBfbWV0aG9kLCAkaHR0cF91cmws
ICRwYXJhbWV0ZXJzKTsKICB9CgogIC8qKgogICAqIHByZXR0eSBtdWNoIGEgaGVscGVyIGZ1
bmN0aW9uIHRvIHNldCB1cCB0aGUgcmVxdWVzdAogICAqLwogIHB1YmxpYyBzdGF0aWMgZnVu
Y3Rpb24gZnJvbV9jb25zdW1lcl9hbmRfdG9rZW4oJGNvbnN1bWVyLCAkdG9rZW4sICRodHRw
X21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVycz1OVUxMKSB7CiAgICBAJHBhcmFtZXRl
cnMgb3IgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgJGRlZmF1bHRzID0gYXJyYXkoIm9h
dXRoX3ZlcnNpb24iID0+IE9BdXRoUmVxdWVzdDo6JHZlcnNpb24sCiAgICAgICAgICAgICAg
ICAgICAgICAib2F1dGhfbm9uY2UiID0+IE9BdXRoUmVxdWVzdDo6Z2VuZXJhdGVfbm9uY2Uo
KSwKICAgICAgICAgICAgICAgICAgICAgICJvYXV0aF90aW1lc3RhbXAiID0+IE9BdXRoUmVx
dWVzdDo6Z2VuZXJhdGVfdGltZXN0YW1wKCksCiAgICAgICAgICAgICAgICAgICAgICAib2F1
dGhfY29uc3VtZXJfa2V5IiA9PiAkY29uc3VtZXItPmtleSk7CiAgICBpZiAoJHRva2VuKQog
ICAgICAkZGVmYXVsdHNbJ29hdXRoX3Rva2VuJ10gPSAkdG9rZW4tPmtleTsKCiAgICAkcGFy
YW1ldGVycyA9IGFycmF5X21lcmdlKCRkZWZhdWx0cywgJHBhcmFtZXRlcnMpOwoKICAgIHJl
dHVybiBuZXcgT0F1dGhSZXF1ZXN0KCRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1l
dGVycyk7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gc2V0X3BhcmFtZXRlcigkbmFtZSwgJHZh
bHVlLCAkYWxsb3dfZHVwbGljYXRlcyA9IHRydWUpIHsKICAgIGlmICgkYWxsb3dfZHVwbGlj
YXRlcyAmJiBpc3NldCgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pKSB7CiAgICAgIC8vIFdl
IGhhdmUgYWxyZWFkeSBhZGRlZCBwYXJhbWV0ZXIocykgd2l0aCB0aGlzIG5hbWUsIHNvIGFk
ZCB0byB0aGUgbGlzdAogICAgICBpZiAoaXNfc2NhbGFyKCR0aGlzLT5wYXJhbWV0ZXJzWyRu
YW1lXSkpIHsKICAgICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCBkdXBsaWNhdGUsIHNvIHRy
YW5zZm9ybSBzY2FsYXIgKHN0cmluZykKICAgICAgICAvLyBpbnRvIGFuIGFycmF5IHNvIHdl
IGNhbiBhZGQgdGhlIGR1cGxpY2F0ZXMKICAgICAgICAkdGhpcy0+cGFyYW1ldGVyc1skbmFt
ZV0gPSBhcnJheSgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pOwogICAgICB9CgogICAgICAk
dGhpcy0+cGFyYW1ldGVyc1skbmFtZV1bXSA9ICR2YWx1ZTsKICAgIH0gZWxzZSB7CiAgICAg
ICR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSA9ICR2YWx1ZTsKICAgIH0KICB9CgogIHB1Ymxp
YyBmdW5jdGlvbiBnZXRfcGFyYW1ldGVyKCRuYW1lKSB7CiAgICByZXR1cm4gaXNzZXQoJHRo
aXMtPnBhcmFtZXRlcnNbJG5hbWVdKSA/ICR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSA6IG51
bGw7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gZ2V0X3BhcmFtZXRlcnMoKSB7CiAgICByZXR1
cm4gJHRoaXMtPnBhcmFtZXRlcnM7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gdW5zZXRfcGFy
YW1ldGVyKCRuYW1lKSB7CiAgICB1bnNldCgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pOwog
IH0KCiAgLyoqCiAgICogVGhlIHJlcXVlc3QgcGFyYW1ldGVycywgc29ydGVkIGFuZCBjb25j
YXRlbmF0ZWQgaW50byBhIG5vcm1hbGl6ZWQgc3RyaW5nLgogICAqIEByZXR1cm4gc3RyaW5n
CiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGdldF9zaWduYWJsZV9wYXJhbWV0ZXJzKCkgewog
ICAgLy8gR3JhYiBhbGwgcGFyYW1ldGVycwogICAgJHBhcmFtcyA9ICR0aGlzLT5wYXJhbWV0
ZXJzOwoKICAgIC8vIFJlbW92ZSBvYXV0aF9zaWduYXR1cmUgaWYgcHJlc2VudAogICAgLy8g
UmVmOiBTcGVjOiA5LjEuMSAoIlRoZSBvYXV0aF9zaWduYXR1cmUgcGFyYW1ldGVyIE1VU1Qg
YmUgZXhjbHVkZWQuIikKICAgIGlmIChpc3NldCgkcGFyYW1zWydvYXV0aF9zaWduYXR1cmUn
XSkpIHsKICAgICAgdW5zZXQoJHBhcmFtc1snb2F1dGhfc2lnbmF0dXJlJ10pOwogICAgfQoK
ICAgIHJldHVybiBPQXV0aFV0aWw6OmJ1aWxkX2h0dHBfcXVlcnkoJHBhcmFtcyk7CiAgfQoK
ICAvKioKICAgKiBSZXR1cm5zIHRoZSBiYXNlIHN0cmluZyBvZiB0aGlzIHJlcXVlc3QKICAg
KgogICAqIFRoZSBiYXNlIHN0cmluZyBkZWZpbmVkIGFzIHRoZSBtZXRob2QsIHRoZSB1cmwK
ICAgKiBhbmQgdGhlIHBhcmFtZXRlcnMgKG5vcm1hbGl6ZWQpLCBlYWNoIHVybGVuY29kZWQK
ICAgKiBhbmQgdGhlIGNvbmNhdGVkIHdpdGggJi4KICAgKi8KICBwdWJsaWMgZnVuY3Rpb24g
Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpIHsKICAgICRwYXJ0cyA9IGFycmF5KAogICAg
ICAkdGhpcy0+Z2V0X25vcm1hbGl6ZWRfaHR0cF9tZXRob2QoKSwKICAgICAgJHRoaXMtPmdl
dF9ub3JtYWxpemVkX2h0dHBfdXJsKCksCiAgICAgICR0aGlzLT5nZXRfc2lnbmFibGVfcGFy
YW1ldGVycygpCiAgICApOwoKICAgICRwYXJ0cyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3Jm
YzM5ODYoJHBhcnRzKTsKCiAgICByZXR1cm4gaW1wbG9kZSgnJicsICRwYXJ0cyk7CiAgfQoK
ICAvKioKICAgKiBqdXN0IHVwcGVyY2FzZXMgdGhlIGh0dHAgbWV0aG9kCiAgICovCiAgcHVi
bGljIGZ1bmN0aW9uIGdldF9ub3JtYWxpemVkX2h0dHBfbWV0aG9kKCkgewogICAgcmV0dXJu
IHN0cnRvdXBwZXIoJHRoaXMtPmh0dHBfbWV0aG9kKTsKICB9CgogIC8qKgogICAqIHBhcnNl
cyB0aGUgdXJsIGFuZCByZWJ1aWxkcyBpdCB0byBiZQogICAqIHNjaGVtZTovL2hvc3QvcGF0
aAogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBnZXRfbm9ybWFsaXplZF9odHRwX3VybCgpIHsK
ICAgICRwYXJ0cyA9IHBhcnNlX3VybCgkdGhpcy0+aHR0cF91cmwpOwoKICAgICRwb3J0ID0g
QCRwYXJ0c1sncG9ydCddOwogICAgJHNjaGVtZSA9ICRwYXJ0c1snc2NoZW1lJ107CiAgICAk
aG9zdCA9ICRwYXJ0c1snaG9zdCddOwogICAgJHBhdGggPSBAJHBhcnRzWydwYXRoJ107Cgog
ICAgJHBvcnQgb3IgJHBvcnQgPSAoJHNjaGVtZSA9PSAnaHR0cHMnKSA/ICc0NDMnIDogJzgw
JzsKCiAgICBpZiAoKCRzY2hlbWUgPT0gJ2h0dHBzJyAmJiAkcG9ydCAhPSAnNDQzJykKICAg
ICAgICB8fCAoJHNjaGVtZSA9PSAnaHR0cCcgJiYgJHBvcnQgIT0gJzgwJykpIHsKICAgICAg
JGhvc3QgPSAiJGhvc3Q6JHBvcnQiOwogICAgfQogICAgcmV0dXJuICIkc2NoZW1lOi8vJGhv
c3QkcGF0aCI7CiAgfQoKICAvKioKICAgKiBidWlsZHMgYSB1cmwgdXNhYmxlIGZvciBhIEdF
VCByZXF1ZXN0CiAgICovCiAgcHVibGljIGZ1bmN0aW9uIHRvX3VybCgpIHsKICAgICRwb3N0
X2RhdGEgPSAkdGhpcy0+dG9fcG9zdGRhdGEoKTsKICAgICRvdXQgPSAkdGhpcy0+Z2V0X25v
cm1hbGl6ZWRfaHR0cF91cmwoKTsKICAgIGlmICgkcG9zdF9kYXRhKSB7CiAgICAgICRvdXQg
Lj0gJz8nLiRwb3N0X2RhdGE7CiAgICB9CiAgICByZXR1cm4gJG91dDsKICB9CgogIC8qKgog
ICAqIGJ1aWxkcyB0aGUgZGF0YSBvbmUgd291bGQgc2VuZCBpbiBhIFBPU1QgcmVxdWVzdAog
ICAqLwogIHB1YmxpYyBmdW5jdGlvbiB0b19wb3N0ZGF0YSgpIHsKICAgIHJldHVybiBPQXV0
aFV0aWw6OmJ1aWxkX2h0dHBfcXVlcnkoJHRoaXMtPnBhcmFtZXRlcnMpOwogIH0KCiAgLyoq
CiAgICogYnVpbGRzIHRoZSBBdXRob3JpemF0aW9uOiBoZWFkZXIKICAgKi8KICBwdWJsaWMg
ZnVuY3Rpb24gdG9faGVhZGVyKCRyZWFsbT1udWxsKSB7CiAgICAkZmlyc3QgPSB0cnVlOwog
IGlmKCRyZWFsbSkgewogICAgICAkb3V0ID0gJ0F1dGhvcml6YXRpb246IE9BdXRoIHJlYWxt
PSInIC4gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkcmVhbG0pIC4gJyInOwogICAg
ICAkZmlyc3QgPSBmYWxzZTsKICAgIH0gZWxzZQogICAgICAkb3V0ID0gJ0F1dGhvcml6YXRp
b246IE9BdXRoJzsKCiAgICAkdG90YWwgPSBhcnJheSgpOwogICAgZm9yZWFjaCAoJHRoaXMt
PnBhcmFtZXRlcnMgYXMgJGsgPT4gJHYpIHsKICAgICAgaWYgKHN1YnN0cigkaywgMCwgNSkg
IT0gIm9hdXRoIikgY29udGludWU7CiAgICAgIGlmIChpc19hcnJheSgkdikpIHsKICAgICAg
ICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oJ0FycmF5cyBub3Qgc3VwcG9ydGVkIGluIGhl
YWRlcnMnKTsKICAgICAgfQogICAgICAkb3V0IC49ICgkZmlyc3QpID8gJyAnIDogJywnOwog
ICAgICAkb3V0IC49IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJGspIC4KICAgICAg
ICAgICAgICAnPSInIC4KICAgICAgICAgICAgICBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMz
OTg2KCR2KSAuCiAgICAgICAgICAgICAgJyInOwogICAgICAkZmlyc3QgPSBmYWxzZTsKICAg
IH0KICAgIHJldHVybiAkb3V0OwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIF9fdG9TdHJpbmco
KSB7CiAgICByZXR1cm4gJHRoaXMtPnRvX3VybCgpOwogIH0KCgogIHB1YmxpYyBmdW5jdGlv
biBzaWduX3JlcXVlc3QoJHNpZ25hdHVyZV9tZXRob2QsICRjb25zdW1lciwgJHRva2VuKSB7
CiAgICAkdGhpcy0+c2V0X3BhcmFtZXRlcigKICAgICAgIm9hdXRoX3NpZ25hdHVyZV9tZXRo
b2QiLAogICAgICAkc2lnbmF0dXJlX21ldGhvZC0+Z2V0X25hbWUoKSwKICAgICAgZmFsc2UK
ICAgICk7CiAgICAkc2lnbmF0dXJlID0gJHRoaXMtPmJ1aWxkX3NpZ25hdHVyZSgkc2lnbmF0
dXJlX21ldGhvZCwgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAgJHRoaXMtPnNldF9wYXJhbWV0
ZXIoIm9hdXRoX3NpZ25hdHVyZSIsICRzaWduYXR1cmUsIGZhbHNlKTsKICB9CgogIHB1Ymxp
YyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHNpZ25hdHVyZV9tZXRob2QsICRjb25zdW1l
ciwgJHRva2VuKSB7CiAgICAkc2lnbmF0dXJlID0gJHNpZ25hdHVyZV9tZXRob2QtPmJ1aWxk
X3NpZ25hdHVyZSgkdGhpcywgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAgcmV0dXJuICRzaWdu
YXR1cmU7CiAgfQoKICAvKioKICAgKiB1dGlsIGZ1bmN0aW9uOiBjdXJyZW50IHRpbWVzdGFt
cAogICAqLwogIHByaXZhdGUgc3RhdGljIGZ1bmN0aW9uIGdlbmVyYXRlX3RpbWVzdGFtcCgp
IHsKICAgIHJldHVybiB0aW1lKCk7CiAgfQoKICAvKioKICAgKiB1dGlsIGZ1bmN0aW9uOiBj
dXJyZW50IG5vbmNlCiAgICovCiAgcHJpdmF0ZSBzdGF0aWMgZnVuY3Rpb24gZ2VuZXJhdGVf
bm9uY2UoKSB7CiAgICAkbXQgPSBtaWNyb3RpbWUoKTsKICAgICRyYW5kID0gbXRfcmFuZCgp
OwoKICAgIHJldHVybiBtZDUoJG10IC4gJHJhbmQpOyAvLyBtZDVzIGxvb2sgbmljZXIgdGhh
biBudW1iZXJzCiAgfQp9CgpjbGFzcyBPQXV0aFNlcnZlciB7CiAgcHJvdGVjdGVkICR0aW1l
c3RhbXBfdGhyZXNob2xkID0gMzAwOyAvLyBpbiBzZWNvbmRzLCBmaXZlIG1pbnV0ZXMKICBw
cm90ZWN0ZWQgJHZlcnNpb24gPSAnMS4wJzsgICAgICAgICAgICAgLy8gaGkgYmxhaW5lCiAg
cHJvdGVjdGVkICRzaWduYXR1cmVfbWV0aG9kcyA9IGFycmF5KCk7CgogIHByb3RlY3RlZCAk
ZGF0YV9zdG9yZTsKCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGRhdGFfc3RvcmUpIHsKICAg
ICR0aGlzLT5kYXRhX3N0b3JlID0gJGRhdGFfc3RvcmU7CiAgfQoKICBwdWJsaWMgZnVuY3Rp
b24gYWRkX3NpZ25hdHVyZV9tZXRob2QoJHNpZ25hdHVyZV9tZXRob2QpIHsKICAgICR0aGlz
LT5zaWduYXR1cmVfbWV0aG9kc1skc2lnbmF0dXJlX21ldGhvZC0+Z2V0X25hbWUoKV0gPQog
ICAgICAkc2lnbmF0dXJlX21ldGhvZDsKICB9CgogIC8vIGhpZ2ggbGV2ZWwgZnVuY3Rpb25z
CgogIC8qKgogICAqIHByb2Nlc3MgYSByZXF1ZXN0X3Rva2VuIHJlcXVlc3QKICAgKiByZXR1
cm5zIHRoZSByZXF1ZXN0IHRva2VuIG9uIHN1Y2Nlc3MKICAgKi8KICBwdWJsaWMgZnVuY3Rp
b24gZmV0Y2hfcmVxdWVzdF90b2tlbigmJHJlcXVlc3QpIHsKICAgICR0aGlzLT5nZXRfdmVy
c2lvbigkcmVxdWVzdCk7CgogICAgJGNvbnN1bWVyID0gJHRoaXMtPmdldF9jb25zdW1lcigk
cmVxdWVzdCk7CgogICAgLy8gbm8gdG9rZW4gcmVxdWlyZWQgZm9yIHRoZSBpbml0aWFsIHRv
a2VuIHJlcXVlc3QKICAgICR0b2tlbiA9IE5VTEw7CgogICAgJHRoaXMtPmNoZWNrX3NpZ25h
dHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwoKICAgIC8vIFJldiBBIGNoYW5n
ZQogICAgJGNhbGxiYWNrID0gJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX2NhbGxi
YWNrJyk7CiAgICAkbmV3X3Rva2VuID0gJHRoaXMtPmRhdGFfc3RvcmUtPm5ld19yZXF1ZXN0
X3Rva2VuKCRjb25zdW1lciwgJGNhbGxiYWNrKTsKCiAgICByZXR1cm4gJG5ld190b2tlbjsK
ICB9CgogIC8qKgogICAqIHByb2Nlc3MgYW4gYWNjZXNzX3Rva2VuIHJlcXVlc3QKICAgKiBy
ZXR1cm5zIHRoZSBhY2Nlc3MgdG9rZW4gb24gc3VjY2VzcwogICAqLwogIHB1YmxpYyBmdW5j
dGlvbiBmZXRjaF9hY2Nlc3NfdG9rZW4oJiRyZXF1ZXN0KSB7CiAgICAkdGhpcy0+Z2V0X3Zl
cnNpb24oJHJlcXVlc3QpOwoKICAgICRjb25zdW1lciA9ICR0aGlzLT5nZXRfY29uc3VtZXIo
JHJlcXVlc3QpOwoKICAgIC8vIHJlcXVpcmVzIGF1dGhvcml6ZWQgcmVxdWVzdCB0b2tlbgog
ICAgJHRva2VuID0gJHRoaXMtPmdldF90b2tlbigkcmVxdWVzdCwgJGNvbnN1bWVyLCAicmVx
dWVzdCIpOwoKICAgICR0aGlzLT5jaGVja19zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1l
ciwgJHRva2VuKTsKCiAgICAvLyBSZXYgQSBjaGFuZ2UKICAgICR2ZXJpZmllciA9ICRyZXF1
ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF92ZXJpZmllcicpOwogICAgJG5ld190b2tlbiA9
ICR0aGlzLT5kYXRhX3N0b3JlLT5uZXdfYWNjZXNzX3Rva2VuKCR0b2tlbiwgJGNvbnN1bWVy
LCAkdmVyaWZpZXIpOwoKICAgIHJldHVybiAkbmV3X3Rva2VuOwogIH0KCiAgLyoqCiAgICog
dmVyaWZ5IGFuIGFwaSBjYWxsLCBjaGVja3MgYWxsIHRoZSBwYXJhbWV0ZXJzCiAgICovCiAg
cHVibGljIGZ1bmN0aW9uIHZlcmlmeV9yZXF1ZXN0KCYkcmVxdWVzdCkgewogICAgJHRoaXMt
PmdldF92ZXJzaW9uKCRyZXF1ZXN0KTsKICAgICRjb25zdW1lciA9ICR0aGlzLT5nZXRfY29u
c3VtZXIoJHJlcXVlc3QpOwogICAgJHRva2VuID0gJHRoaXMtPmdldF90b2tlbigkcmVxdWVz
dCwgJGNvbnN1bWVyLCAiYWNjZXNzIik7CiAgICAkdGhpcy0+Y2hlY2tfc2lnbmF0dXJlKCRy
ZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7CiAgICByZXR1cm4gYXJyYXkoJGNvbnN1bWVy
LCAkdG9rZW4pOwogIH0KCiAgLy8gSW50ZXJuYWxzIGZyb20gaGVyZQogIC8qKgogICAqIHZl
cnNpb24gMQogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X3ZlcnNpb24oJiRyZXF1ZXN0
KSB7CiAgICAkdmVyc2lvbiA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCJvYXV0aF92ZXJz
aW9uIik7CiAgICBpZiAoISR2ZXJzaW9uKSB7CiAgICAgIC8vIFNlcnZpY2UgUHJvdmlkZXJz
IE1VU1QgYXNzdW1lIHRoZSBwcm90b2NvbCB2ZXJzaW9uIHRvIGJlIDEuMCBpZiB0aGlzIHBh
cmFtZXRlciBpcyBub3QgcHJlc2VudC4KICAgICAgLy8gQ2hhcHRlciA3LjAgKCJBY2Nlc3Np
bmcgUHJvdGVjdGVkIFJlc3NvdXJjZXMiKQogICAgICAkdmVyc2lvbiA9ICcxLjAnOwogICAg
fQogICAgaWYgKCR2ZXJzaW9uICE9PSAkdGhpcy0+dmVyc2lvbikgewogICAgICB0aHJvdyBu
ZXcgT0F1dGhFeGNlcHRpb24oIk9BdXRoIHZlcnNpb24gJyR2ZXJzaW9uJyBub3Qgc3VwcG9y
dGVkIik7CiAgICB9CiAgICByZXR1cm4gJHZlcnNpb247CiAgfQoKICAvKioKICAgKiBmaWd1
cmUgb3V0IHRoZSBzaWduYXR1cmUgd2l0aCBzb21lIGRlZmF1bHRzCiAgICovCiAgcHJpdmF0
ZSBmdW5jdGlvbiBnZXRfc2lnbmF0dXJlX21ldGhvZCgmJHJlcXVlc3QpIHsKICAgICRzaWdu
YXR1cmVfbWV0aG9kID0KICAgICAgICBAJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoIm9hdXRo
X3NpZ25hdHVyZV9tZXRob2QiKTsKCiAgICBpZiAoISRzaWduYXR1cmVfbWV0aG9kKSB7CiAg
ICAgIC8vIEFjY29yZGluZyB0byBjaGFwdGVyIDcgKCJBY2Nlc3NpbmcgUHJvdGVjdGVkIFJl
c3NvdXJjZXMiKSB0aGUgc2lnbmF0dXJlLW1ldGhvZAogICAgICAvLyBwYXJhbWV0ZXIgaXMg
cmVxdWlyZWQsIGFuZCB3ZSBjYW4ndCBqdXN0IGZhbGxiYWNrIHRvIFBMQUlOVEVYVAogICAg
ICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oJ05vIHNpZ25hdHVyZSBtZXRob2QgcGFyYW1l
dGVyLiBUaGlzIHBhcmFtZXRlciBpcyByZXF1aXJlZCcpOwogICAgfQoKICAgIGlmICghaW5f
YXJyYXkoJHNpZ25hdHVyZV9tZXRob2QsCiAgICAgICAgICAgICAgICAgIGFycmF5X2tleXMo
JHRoaXMtPnNpZ25hdHVyZV9tZXRob2RzKSkpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhj
ZXB0aW9uKAogICAgICAgICJTaWduYXR1cmUgbWV0aG9kICckc2lnbmF0dXJlX21ldGhvZCcg
bm90IHN1cHBvcnRlZCAiIC4KICAgICAgICAidHJ5IG9uZSBvZiB0aGUgZm9sbG93aW5nOiAi
IC4KICAgICAgICBpbXBsb2RlKCIsICIsIGFycmF5X2tleXMoJHRoaXMtPnNpZ25hdHVyZV9t
ZXRob2RzKSkKICAgICAgKTsKICAgIH0KICAgIHJldHVybiAkdGhpcy0+c2lnbmF0dXJlX21l
dGhvZHNbJHNpZ25hdHVyZV9tZXRob2RdOwogIH0KCiAgLyoqCiAgICogdHJ5IHRvIGZpbmQg
dGhlIGNvbnN1bWVyIGZvciB0aGUgcHJvdmlkZWQgcmVxdWVzdCdzIGNvbnN1bWVyIGtleQog
ICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X2NvbnN1bWVyKCYkcmVxdWVzdCkgewogICAg
JGNvbnN1bWVyX2tleSA9IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcigib2F1dGhfY29uc3Vt
ZXJfa2V5Iik7CiAgICBpZiAoISRjb25zdW1lcl9rZXkpIHsKICAgICAgdGhyb3cgbmV3IE9B
dXRoRXhjZXB0aW9uKCJJbnZhbGlkIGNvbnN1bWVyIGtleSIpOwogICAgfQoKICAgICRjb25z
dW1lciA9ICR0aGlzLT5kYXRhX3N0b3JlLT5sb29rdXBfY29uc3VtZXIoJGNvbnN1bWVyX2tl
eSk7CiAgICBpZiAoISRjb25zdW1lcikgewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRp
b24oIkludmFsaWQgY29uc3VtZXIiKTsKICAgIH0KCiAgICByZXR1cm4gJGNvbnN1bWVyOwog
IH0KCiAgLyoqCiAgICogdHJ5IHRvIGZpbmQgdGhlIHRva2VuIGZvciB0aGUgcHJvdmlkZWQg
cmVxdWVzdCdzIHRva2VuIGtleQogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X3Rva2Vu
KCYkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW5fdHlwZT0iYWNjZXNzIikgewogICAgJHRv
a2VuX2ZpZWxkID0gQCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF90b2tlbicpOwog
ICAgJHRva2VuID0gJHRoaXMtPmRhdGFfc3RvcmUtPmxvb2t1cF90b2tlbigKICAgICAgJGNv
bnN1bWVyLCAkdG9rZW5fdHlwZSwgJHRva2VuX2ZpZWxkCiAgICApOwogICAgaWYgKCEkdG9r
ZW4pIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJbnZhbGlkICR0b2tlbl90
eXBlIHRva2VuOiAkdG9rZW5fZmllbGQiKTsKICAgIH0KICAgIHJldHVybiAkdG9rZW47CiAg
fQoKICAvKioKICAgKiBhbGwtaW4tb25lIGZ1bmN0aW9uIHRvIGNoZWNrIHRoZSBzaWduYXR1
cmUgb24gYSByZXF1ZXN0CiAgICogc2hvdWxkIGd1ZXNzIHRoZSBzaWduYXR1cmUgbWV0aG9k
IGFwcHJvcHJpYXRlbHkKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGNoZWNrX3NpZ25hdHVy
ZSgmJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAvLyB0aGlzIHNob3VsZCBw
cm9iYWJseSBiZSBpbiBhIGRpZmZlcmVudCBtZXRob2QKICAgICR0aW1lc3RhbXAgPSBAJHJl
cXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX3RpbWVzdGFtcCcpOwogICAgJG5vbmNlID0g
QCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF9ub25jZScpOwoKICAgICR0aGlzLT5j
aGVja190aW1lc3RhbXAoJHRpbWVzdGFtcCk7CiAgICAkdGhpcy0+Y2hlY2tfbm9uY2UoJGNv
bnN1bWVyLCAkdG9rZW4sICRub25jZSwgJHRpbWVzdGFtcCk7CgogICAgJHNpZ25hdHVyZV9t
ZXRob2QgPSAkdGhpcy0+Z2V0X3NpZ25hdHVyZV9tZXRob2QoJHJlcXVlc3QpOwoKICAgICRz
aWduYXR1cmUgPSAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfc2lnbmF0dXJlJyk7
CiAgICAkdmFsaWRfc2lnID0gJHNpZ25hdHVyZV9tZXRob2QtPmNoZWNrX3NpZ25hdHVyZSgK
ICAgICAgJHJlcXVlc3QsCiAgICAgICRjb25zdW1lciwKICAgICAgJHRva2VuLAogICAgICAk
c2lnbmF0dXJlCiAgICApOwoKICAgIGlmICghJHZhbGlkX3NpZykgewogICAgICB0aHJvdyBu
ZXcgT0F1dGhFeGNlcHRpb24oIkludmFsaWQgc2lnbmF0dXJlIik7CiAgICB9CiAgfQoKICAv
KioKICAgKiBjaGVjayB0aGF0IHRoZSB0aW1lc3RhbXAgaXMgbmV3IGVub3VnaAogICAqLwog
IHByaXZhdGUgZnVuY3Rpb24gY2hlY2tfdGltZXN0YW1wKCR0aW1lc3RhbXApIHsKICAgIGlm
KCAhICR0aW1lc3RhbXAgKQogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAg
ICAgJ01pc3NpbmcgdGltZXN0YW1wIHBhcmFtZXRlci4gVGhlIHBhcmFtZXRlciBpcyByZXF1
aXJlZCcKICAgICAgKTsKCiAgICAvLyB2ZXJpZnkgdGhhdCB0aW1lc3RhbXAgaXMgcmVjZW50
aXNoCiAgICAkbm93ID0gdGltZSgpOwogICAgaWYgKGFicygkbm93IC0gJHRpbWVzdGFtcCkg
PiAkdGhpcy0+dGltZXN0YW1wX3RocmVzaG9sZCkgewogICAgICB0aHJvdyBuZXcgT0F1dGhF
eGNlcHRpb24oCiAgICAgICAgIkV4cGlyZWQgdGltZXN0YW1wLCB5b3VycyAkdGltZXN0YW1w
LCBvdXJzICRub3ciCiAgICAgICk7CiAgICB9CiAgfQoKICAvKioKICAgKiBjaGVjayB0aGF0
IHRoZSBub25jZSBpcyBub3QgcmVwZWF0ZWQKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGNo
ZWNrX25vbmNlKCRjb25zdW1lciwgJHRva2VuLCAkbm9uY2UsICR0aW1lc3RhbXApIHsKICAg
IGlmKCAhICRub25jZSApCiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigKICAgICAg
ICAnTWlzc2luZyBub25jZSBwYXJhbWV0ZXIuIFRoZSBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQn
CiAgICAgICk7CgogICAgLy8gdmVyaWZ5IHRoYXQgdGhlIG5vbmNlIGlzIHVuaXF1ZWlzaAog
ICAgJGZvdW5kID0gJHRoaXMtPmRhdGFfc3RvcmUtPmxvb2t1cF9ub25jZSgKICAgICAgJGNv
bnN1bWVyLAogICAgICAkdG9rZW4sCiAgICAgICRub25jZSwKICAgICAgJHRpbWVzdGFtcAog
ICAgKTsKICAgIGlmICgkZm91bmQpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9u
KCJOb25jZSBhbHJlYWR5IHVzZWQ6ICRub25jZSIpOwogICAgfQogIH0KCn0KCmNsYXNzIE9B
dXRoRGF0YVN0b3JlIHsKICBmdW5jdGlvbiBsb29rdXBfY29uc3VtZXIoJGNvbnN1bWVyX2tl
eSkgewogICAgLy8gaW1wbGVtZW50IG1lCiAgfQoKICBmdW5jdGlvbiBsb29rdXBfdG9rZW4o
JGNvbnN1bWVyLCAkdG9rZW5fdHlwZSwgJHRva2VuKSB7CiAgICAvLyBpbXBsZW1lbnQgbWUK
ICB9CgogIGZ1bmN0aW9uIGxvb2t1cF9ub25jZSgkY29uc3VtZXIsICR0b2tlbiwgJG5vbmNl
LCAkdGltZXN0YW1wKSB7CiAgICAvLyBpbXBsZW1lbnQgbWUKICB9CgogIGZ1bmN0aW9uIG5l
d19yZXF1ZXN0X3Rva2VuKCRjb25zdW1lciwgJGNhbGxiYWNrID0gbnVsbCkgewogICAgLy8g
cmV0dXJuIGEgbmV3IHRva2VuIGF0dGFjaGVkIHRvIHRoaXMgY29uc3VtZXIKICB9CgogIGZ1
bmN0aW9uIG5ld19hY2Nlc3NfdG9rZW4oJHRva2VuLCAkY29uc3VtZXIsICR2ZXJpZmllciA9
IG51bGwpIHsKICAgIC8vIHJldHVybiBhIG5ldyBhY2Nlc3MgdG9rZW4gYXR0YWNoZWQgdG8g
dGhpcyBjb25zdW1lcgogICAgLy8gZm9yIHRoZSB1c2VyIGFzc29jaWF0ZWQgd2l0aCB0aGlz
IHRva2VuIGlmIHRoZSByZXF1ZXN0IHRva2VuCiAgICAvLyBpcyBhdXRob3JpemVkCiAgICAv
LyBzaG91bGQgYWxzbyBpbnZhbGlkYXRlIHRoZSByZXF1ZXN0IHRva2VuCiAgfQoKfQoKY2xh
c3MgT0F1dGhVdGlsIHsKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHVybGVuY29kZV9yZmMz
OTg2KCRpbnB1dCkgewogIGlmIChpc19hcnJheSgkaW5wdXQpKSB7CiAgICByZXR1cm4gYXJy
YXlfbWFwKGFycmF5KCdPQXV0aFV0aWwnLCAndXJsZW5jb2RlX3JmYzM5ODYnKSwgJGlucHV0
KTsKICB9IGVsc2UgaWYgKGlzX3NjYWxhcigkaW5wdXQpKSB7CiAgICByZXR1cm4gc3RyX3Jl
cGxhY2UoCiAgICAgICcrJywKICAgICAgJyAnLAogICAgICBzdHJfcmVwbGFjZSgnJTdFJywg
J34nLCByYXd1cmxlbmNvZGUoJGlucHV0KSkKICAgICk7CiAgfSBlbHNlIHsKICAgIHJldHVy
biAnJzsKICB9Cn0KCgogIC8vIFRoaXMgZGVjb2RlIGZ1bmN0aW9uIGlzbid0IHRha2luZyBp
bnRvIGNvbnNpZGVyYXRpb24gdGhlIGFib3ZlCiAgLy8gbW9kaWZpY2F0aW9ucyB0byB0aGUg
ZW5jb2RpbmcgcHJvY2Vzcy4gSG93ZXZlciwgdGhpcyBtZXRob2QgZG9lc24ndAogIC8vIHNl
ZW0gdG8gYmUgdXNlZCBhbnl3aGVyZSBzbyBsZWF2aW5nIGl0IGFzIGlzLgogIHB1YmxpYyBz
dGF0aWMgZnVuY3Rpb24gdXJsZGVjb2RlX3JmYzM5ODYoJHN0cmluZykgewogICAgcmV0dXJu
IHVybGRlY29kZSgkc3RyaW5nKTsKICB9CgogIC8vIFV0aWxpdHkgZnVuY3Rpb24gZm9yIHR1
cm5pbmcgdGhlIEF1dGhvcml6YXRpb246IGhlYWRlciBpbnRvCiAgLy8gcGFyYW1ldGVycywg
aGFzIHRvIGRvIHNvbWUgdW5lc2NhcGluZwogIC8vIENhbiBmaWx0ZXIgb3V0IGFueSBub24t
b2F1dGggcGFyYW1ldGVycyBpZiBuZWVkZWQgKGRlZmF1bHQgYmVoYXZpb3VyKQogIHB1Ymxp
YyBzdGF0aWMgZnVuY3Rpb24gc3BsaXRfaGVhZGVyKCRoZWFkZXIsICRvbmx5X2FsbG93X29h
dXRoX3BhcmFtZXRlcnMgPSB0cnVlKSB7CiAgICAkcGF0dGVybiA9ICcvKChbLV9hLXpdKik9
KCIoW14iXSopInwoW14sXSopKSw/KS8nOwogICAgJG9mZnNldCA9IDA7CiAgICAkcGFyYW1z
ID0gYXJyYXkoKTsKICAgIHdoaWxlIChwcmVnX21hdGNoKCRwYXR0ZXJuLCAkaGVhZGVyLCAk
bWF0Y2hlcywgUFJFR19PRkZTRVRfQ0FQVFVSRSwgJG9mZnNldCkgPiAwKSB7CiAgICAgICRt
YXRjaCA9ICRtYXRjaGVzWzBdOwogICAgICAkaGVhZGVyX25hbWUgPSAkbWF0Y2hlc1syXVsw
XTsKICAgICAgJGhlYWRlcl9jb250ZW50ID0gKGlzc2V0KCRtYXRjaGVzWzVdKSkgPyAkbWF0
Y2hlc1s1XVswXSA6ICRtYXRjaGVzWzRdWzBdOwogICAgICBpZiAocHJlZ19tYXRjaCgnL15v
YXV0aF8vJywgJGhlYWRlcl9uYW1lKSB8fCAhJG9ubHlfYWxsb3dfb2F1dGhfcGFyYW1ldGVy
cykgewogICAgICAgICRwYXJhbXNbJGhlYWRlcl9uYW1lXSA9IE9BdXRoVXRpbDo6dXJsZGVj
b2RlX3JmYzM5ODYoJGhlYWRlcl9jb250ZW50KTsKICAgICAgfQogICAgICAkb2Zmc2V0ID0g
JG1hdGNoWzFdICsgc3RybGVuKCRtYXRjaFswXSk7CiAgICB9CgogICAgaWYgKGlzc2V0KCRw
YXJhbXNbJ3JlYWxtJ10pKSB7CiAgICAgIHVuc2V0KCRwYXJhbXNbJ3JlYWxtJ10pOwogICAg
fQoKICAgIHJldHVybiAkcGFyYW1zOwogIH0KCiAgLy8gaGVscGVyIHRvIHRyeSB0byBzb3J0
IG91dCBoZWFkZXJzIGZvciBwZW9wbGUgd2hvIGFyZW4ndCBydW5uaW5nIGFwYWNoZQogIHB1
YmxpYyBzdGF0aWMgZnVuY3Rpb24gZ2V0X2hlYWRlcnMoKSB7CiAgICBpZiAoZnVuY3Rpb25f
ZXhpc3RzKCdhcGFjaGVfcmVxdWVzdF9oZWFkZXJzJykpIHsKICAgICAgLy8gd2UgbmVlZCB0
aGlzIHRvIGdldCB0aGUgYWN0dWFsIEF1dGhvcml6YXRpb246IGhlYWRlcgogICAgICAvLyBi
ZWNhdXNlIGFwYWNoZSB0ZW5kcyB0byB0ZWxsIHVzIGl0IGRvZXNuJ3QgZXhpc3QKICAgICAg
JGhlYWRlcnMgPSBhcGFjaGVfcmVxdWVzdF9oZWFkZXJzKCk7CgogICAgICAvLyBzYW5pdGl6
ZSB0aGUgb3V0cHV0IG9mIGFwYWNoZV9yZXF1ZXN0X2hlYWRlcnMgYmVjYXVzZQogICAgICAv
LyB3ZSBhbHdheXMgd2FudCB0aGUga2V5cyB0byBiZSBDYXNlZC1MaWtlLVRoaXMgYW5kIGFy
aCgpCiAgICAgIC8vIHJldHVybnMgdGhlIGhlYWRlcnMgaW4gdGhlIHNhbWUgY2FzZSBhcyB0
aGV5IGFyZSBpbiB0aGUKICAgICAgLy8gcmVxdWVzdAogICAgICAkb3V0ID0gYXJyYXkoKTsK
ICAgICAgZm9yZWFjaCggJGhlYWRlcnMgQVMgJGtleSA9PiAkdmFsdWUgKSB7CiAgICAgICAg
JGtleSA9IHN0cl9yZXBsYWNlKAogICAgICAgICAgICAiICIsCiAgICAgICAgICAgICItIiwK
ICAgICAgICAgICAgdWN3b3JkcyhzdHJ0b2xvd2VyKHN0cl9yZXBsYWNlKCItIiwgIiAiLCAk
a2V5KSkpCiAgICAgICAgICApOwogICAgICAgICRvdXRbJGtleV0gPSAkdmFsdWU7CiAgICAg
IH0KICAgIH0gZWxzZSB7CiAgICAgIC8vIG90aGVyd2lzZSB3ZSBkb24ndCBoYXZlIGFwYWNo
ZSBhbmQgYXJlIGp1c3QgZ29pbmcgdG8gaGF2ZSB0byBob3BlCiAgICAgIC8vIHRoYXQgJF9T
RVJWRVIgYWN0dWFsbHkgY29udGFpbnMgd2hhdCB3ZSBuZWVkCiAgICAgICRvdXQgPSBhcnJh
eSgpOwogICAgICBpZiggaXNzZXQoJF9TRVJWRVJbJ0NPTlRFTlRfVFlQRSddKSApCiAgICAg
ICAgJG91dFsnQ29udGVudC1UeXBlJ10gPSAkX1NFUlZFUlsnQ09OVEVOVF9UWVBFJ107CiAg
ICAgIGlmKCBpc3NldCgkX0VOVlsnQ09OVEVOVF9UWVBFJ10pICkKICAgICAgICAkb3V0WydD
b250ZW50LVR5cGUnXSA9ICRfRU5WWydDT05URU5UX1RZUEUnXTsKCiAgICAgIGZvcmVhY2gg
KCRfU0VSVkVSIGFzICRrZXkgPT4gJHZhbHVlKSB7CiAgICAgICAgaWYgKHN1YnN0cigka2V5
LCAwLCA1KSA9PSAiSFRUUF8iKSB7CiAgICAgICAgICAvLyB0aGlzIGlzIGNoYW9zLCBiYXNp
Y2FsbHkgaXQgaXMganVzdCB0aGVyZSB0byBjYXBpdGFsaXplIHRoZSBmaXJzdAogICAgICAg
ICAgLy8gbGV0dGVyIG9mIGV2ZXJ5IHdvcmQgdGhhdCBpcyBub3QgYW4gaW5pdGlhbCBIVFRQ
IGFuZCBzdHJpcCBIVFRQCiAgICAgICAgICAvLyBjb2RlIGZyb20gcHJ6ZW1lawogICAgICAg
ICAgJGtleSA9IHN0cl9yZXBsYWNlKAogICAgICAgICAgICAiICIsCiAgICAgICAgICAgICIt
IiwKICAgICAgICAgICAgdWN3b3JkcyhzdHJ0b2xvd2VyKHN0cl9yZXBsYWNlKCJfIiwgIiAi
LCBzdWJzdHIoJGtleSwgNSkpKSkKICAgICAgICAgICk7CiAgICAgICAgICAkb3V0WyRrZXld
ID0gJHZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuICRvdXQ7CiAg
fQoKICAvLyBUaGlzIGZ1bmN0aW9uIHRha2VzIGEgaW5wdXQgbGlrZSBhPWImYT1jJmQ9ZSBh
bmQgcmV0dXJucyB0aGUgcGFyc2VkCiAgLy8gcGFyYW1ldGVycyBsaWtlIHRoaXMKICAvLyBh
cnJheSgnYScgPT4gYXJyYXkoJ2InLCdjJyksICdkJyA9PiAnZScpCiAgcHVibGljIHN0YXRp
YyBmdW5jdGlvbiBwYXJzZV9wYXJhbWV0ZXJzKCAkaW5wdXQgKSB7CiAgICBpZiAoIWlzc2V0
KCRpbnB1dCkgfHwgISRpbnB1dCkgcmV0dXJuIGFycmF5KCk7CgogICAgJHBhaXJzID0gZXhw
bG9kZSgnJicsICRpbnB1dCk7CgogICAgJHBhcnNlZF9wYXJhbWV0ZXJzID0gYXJyYXkoKTsK
ICAgIGZvcmVhY2ggKCRwYWlycyBhcyAkcGFpcikgewogICAgICAkc3BsaXQgPSBleHBsb2Rl
KCc9JywgJHBhaXIsIDIpOwogICAgICAkcGFyYW1ldGVyID0gT0F1dGhVdGlsOjp1cmxkZWNv
ZGVfcmZjMzk4Nigkc3BsaXRbMF0pOwogICAgICAkdmFsdWUgPSBpc3NldCgkc3BsaXRbMV0p
ID8gT0F1dGhVdGlsOjp1cmxkZWNvZGVfcmZjMzk4Nigkc3BsaXRbMV0pIDogJyc7CgogICAg
ICBpZiAoaXNzZXQoJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdKSkgewogICAgICAg
IC8vIFdlIGhhdmUgYWxyZWFkeSByZWNpZXZlZCBwYXJhbWV0ZXIocykgd2l0aCB0aGlzIG5h
bWUsIHNvIGFkZCB0byB0aGUgbGlzdAogICAgICAgIC8vIG9mIHBhcmFtZXRlcnMgd2l0aCB0
aGlzIG5hbWUKCiAgICAgICAgaWYgKGlzX3NjYWxhcigkcGFyc2VkX3BhcmFtZXRlcnNbJHBh
cmFtZXRlcl0pKSB7CiAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCBkdXBsaWNhdGUs
IHNvIHRyYW5zZm9ybSBzY2FsYXIgKHN0cmluZykgaW50byBhbiBhcnJheQogICAgICAgICAg
Ly8gc28gd2UgY2FuIGFkZCB0aGUgZHVwbGljYXRlcwogICAgICAgICAgJHBhcnNlZF9wYXJh
bWV0ZXJzWyRwYXJhbWV0ZXJdID0gYXJyYXkoJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0
ZXJdKTsKICAgICAgICB9CgogICAgICAgICRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVy
XVtdID0gJHZhbHVlOwogICAgICB9IGVsc2UgewogICAgICAgICRwYXJzZWRfcGFyYW1ldGVy
c1skcGFyYW1ldGVyXSA9ICR2YWx1ZTsKICAgICAgfQogICAgfQogICAgcmV0dXJuICRwYXJz
ZWRfcGFyYW1ldGVyczsKICB9CgogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gYnVpbGRfaHR0
cF9xdWVyeSgkcGFyYW1zKSB7CiAgICBpZiAoISRwYXJhbXMpIHJldHVybiAnJzsKCiAgICAv
LyBVcmxlbmNvZGUgYm90aCBrZXlzIGFuZCB2YWx1ZXMKICAgICRrZXlzID0gT0F1dGhVdGls
Ojp1cmxlbmNvZGVfcmZjMzk4NihhcnJheV9rZXlzKCRwYXJhbXMpKTsKICAgICR2YWx1ZXMg
PSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KGFycmF5X3ZhbHVlcygkcGFyYW1zKSk7
CiAgICAkcGFyYW1zID0gYXJyYXlfY29tYmluZSgka2V5cywgJHZhbHVlcyk7CgogICAgLy8g
UGFyYW1ldGVycyBhcmUgc29ydGVkIGJ5IG5hbWUsIHVzaW5nIGxleGljb2dyYXBoaWNhbCBi
eXRlIHZhbHVlIG9yZGVyaW5nLgogICAgLy8gUmVmOiBTcGVjOiA5LjEuMSAoMSkKICAgIHVr
c29ydCgkcGFyYW1zLCAnc3RyY21wJyk7CgogICAgJHBhaXJzID0gYXJyYXkoKTsKICAgIGZv
cmVhY2ggKCRwYXJhbXMgYXMgJHBhcmFtZXRlciA9PiAkdmFsdWUpIHsKICAgICAgaWYgKGlz
X2FycmF5KCR2YWx1ZSkpIHsKICAgICAgICAvLyBJZiB0d28gb3IgbW9yZSBwYXJhbWV0ZXJz
IHNoYXJlIHRoZSBzYW1lIG5hbWUsIHRoZXkgYXJlIHNvcnRlZCBieSB0aGVpciB2YWx1ZQog
ICAgICAgIC8vIFJlZjogU3BlYzogOS4xLjEgKDEpCiAgICAgICAgbmF0c29ydCgkdmFsdWUp
OwogICAgICAgIGZvcmVhY2ggKCR2YWx1ZSBhcyAkZHVwbGljYXRlX3ZhbHVlKSB7CiAgICAg
ICAgICAkcGFpcnNbXSA9ICRwYXJhbWV0ZXIgLiAnPScgLiAkZHVwbGljYXRlX3ZhbHVlOwog
ICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAkcGFpcnNbXSA9ICRwYXJhbWV0ZXIg
LiAnPScgLiAkdmFsdWU7CiAgICAgIH0KICAgIH0KICAgIC8vIEZvciBlYWNoIHBhcmFtZXRl
ciwgdGhlIG5hbWUgaXMgc2VwYXJhdGVkIGZyb20gdGhlIGNvcnJlc3BvbmRpbmcgdmFsdWUg
YnkgYW4gJz0nIGNoYXJhY3RlciAoQVNDSUkgY29kZSA2MSkKICAgIC8vIEVhY2ggbmFtZS12
YWx1ZSBwYWlyIGlzIHNlcGFyYXRlZCBieSBhbiAnJicgY2hhcmFjdGVyIChBU0NJSSBjb2Rl
IDM4KQogICAgcmV0dXJuIGltcGxvZGUoJyYnLCAkcGFpcnMpOwogIH0KfSI7czozOiJtZDUi
O3M6MzI6ImQ4YmExN2ViYjc4MGQzYjA5YjYzOTc0ZDNhODIxMjJlIjt9
