# arc_twitter v3.0-dev
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjc6
IjMuMC1kZXYiO3M6NjoiYXV0aG9yIjtzOjExOiJBbmR5IENhcnRlciI7czoxMDoiYXV0aG9y
X3VyaSI7czozMToiaHR0cDovL3JlZGhvdGNoaWxsaXByb2plY3QuY29tLyI7czoxMToiZGVz
Y3JpcHRpb24iO3M6NjA6IjxhIGhyZWY9Imh0dHA6Ly93d3cudHdpdHRlci5jb20iPlR3aXR0
ZXI8L2E+IGZvciBUZXh0cGF0dGVybiI7czo1OiJvcmRlciI7czoxOiI1IjtzOjQ6InR5cGUi
O3M6MToiMSI7czo1OiJmbGFncyI7czoxOiIzIjtzOjQ6ImhlbHAiO3M6MTU0NTY6Igk8aDEg
Y2xhc3M9InRpdGxlIj48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCAoYXJj
X3R3aXR0ZXIgZm9yIFRleHRwYXR0ZXJuKTwvaDE+CgoJPG9sPgoJCTxsaT48YSBocmVmPSIj
YXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2Fy
Y190d2l0dGVyX2luc3RhbGxhdGlvbiI+SW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxsYXRpb248
L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3RhZyI+VGhlIGFyY190d2l0
dGVyIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfc2VhcmNoX3Rh
ZyI+VGhlIGFyY190d2l0dGVyX3NlYXJjaCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0i
I2FyY190d2l0dGVyX3JldHdlZXRfdGFnIj5UaGUgYXJjX3R3aXR0ZXJfcmV0d2VldCB0YWc8
L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3R3ZWV0X3VybCI+VGhlIGFy
Y190d2l0dGVyX3R3ZWV0X3VybCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190
d2l0dGVyX3Rpbnl1cmwiPlRoZSBhcmNfdHdpdHRlcl90aW55dXJsIHRhZzwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfY2FjaGluZyI+Q2FjaGluZzwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfcHJlZnMiPlByZWZlcmVuY2VzPC9hPjwvbGk+
CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl9hcnRpY2xlIj5Ud2VldGluZyBhcnRpY2xl
czwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfYWRtaW4iPlRoZSBUd2l0
dGVyIHRhYjwvYT48L2xpPgoJPC9vbD4KCgk8cD48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9z
cGFuPiBUd2VldCBwcm92aWRlcyBhY2Nlc3MgdG8geW91ciBUd2l0dGVyIGFjY291bnQgdGhy
b3VnaCBib3RoIHRoZSBhZG1pbiBpbnRlcmZhY2UgYW5kIHRoZSBwdWJsaWMgc2lkZSBvZiB5
b3VyIHNpdGUuIFVwZGF0ZSBUd2l0dGVyIHdoZW4geW91IHBvc3QgYSBuZXcgYXJ0aWNsZSAo
d2l0aCBhcnRpY2xlLWJ5LWFydGljbGUgb3B0IG91dCBvcHRpb24pLCB1cGRhdGUgYW5kIHZp
ZXcgeW91ciBUd2l0dGVyIGZlZWQgdGhyb3VnaCB0aGUgYWRtaW4gVHdpdHRlciB0YWIsIGFu
ZCBkaXNwbGF5IFR3aXR0ZXIgZmVlZHMgb24geW91ciBzaXRlLjwvcD4KCgk8cD5SZXF1aXJl
bWVudHM6LTwvcD4KCgk8dWw+CgkJPGxpPlRleHRwYXR0ZXJuIDQuMis8L2xpPgoJCTxsaT48
c3BhbiBjbGFzcz0iY2FwcyI+UEhQPC9zcGFuPiA1IGFuZCBjVVJMPC9saT4KCTwvdWw+CgoJ
PGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2gy
PgoKCTxwPjxhIGhyZWY9Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbSI+QW5keSBD
YXJ0ZXI8L2E+LiBGb3Igb3RoZXIgVGV4dHBhdHRlcm4gcGx1Z2lucyBieSBtZSB2aXNpdCBt
eSA8YSBocmVmPSJodHRwOi8vcmVkaG90Y2hpbGxpcHJvamVjdC5jb20vdHhwIj5QbHVnaW5z
IHBhZ2U8L2E+LjwvcD4KCgk8cD5UaGFua3MgdG8gPGEgaHJlZj0iaHR0cDovL21hbmZyZS5u
ZXQvIj5NaWNoYWVsIE1hbmZyZTwvYT4gZm9yIGluc3BpcmF0aW9uIGZvciB0aGUgYXJ0aWNs
ZSB0d2VldCBwYXJ0IG9mIHRoaXMgcGx1Z2luIGJhc2VkIG9uIGhpcyA8c3BhbiBjbGFzcz0i
dGFnIj5tZW1fdHdpdHRlcjwvc3Bhbj4gcGx1Z2luLiAgQWRkaXRpb25hbCB0aGFua3MgdG8g
dGhlIGdyZWF0IFRleHRwYXR0ZXJuIGNvbW11bml0eSBmb3IgaGVscGluZyB0byB0ZXN0IHRo
aXMgcGx1Z2luIGFuZCBmb3Igc3VnZ2VzdGluZyBuZXcgZmVhdHVyZXMuIFRoZSBPQXV0aCBw
YXJ0IG9mIHRoZSBwbHVnaW4gaXMgdGhhbmtzIHRvIDxhIGhyZWY9Imh0dHA6Ly90d2l0dGVy
LmNvbS9hYnJhaGFtIj5BYnJhaGFtIFdpbGxpYW1zPC9hPi48L3A+CgoJPGgyIGNsYXNzPSJz
ZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfaW5zdGFsbGF0aW9uIj5JbnN0YWxsYXRpb24gLyBV
bmluc3RhbGxhdGlvbjwvaDI+CgoJPHA+VG8gaW5zdGFsbCBnbyB0byB0aGUgJiM4MjE2O3Bs
dWdpbnMmIzgyMTc7IHRhYiB1bmRlciAmIzgyMTY7YWRtaW4mIzgyMTc7IGFuZCBwYXN0ZSB0
aGUgcGx1Z2luIGNvZGUgaW50byB0aGUgJiM4MjE2O0luc3RhbGwgcGx1Z2luJiM4MjE3OyBi
b3gsICYjODIxNjt1cGxvYWQmIzgyMTc7IGFuZCB0aGVuICYjODIxNjtpbnN0YWxsJiM4MjE3
Oy4gRmluYWxseSBhY3RpdmF0ZSB0aGUgcGx1Z2luLjwvcD4KCgk8cD5CZWZvcmUgeW91IHN0
YXJ0IHVzaW5nIDxzcGFuIGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiB5b3Ugd2ls
bCBuZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IHRoZSBjYWNoZSBkaXJlY3RvcnkgaXMgd3JpdGFi
bGUuIFNlZSB0aGUgJiM4MjE2O0NhY2hpbmcmIzgyMTc7IHN1YnNlY3Rpb24gYmVsb3cgZm9y
IGZ1cnRoZXIgaW5mb3JtYXRpb24uPC9wPgoKCTxwPjxzcGFuIGNsYXNzPSJ0YWciPmFyY190
d2l0dGVyPC9zcGFuPiBzaG91bGQgbm93IGJlIHJlYWR5IGZvciB1c2Ugb24gdGhlIHB1Ymxp
Yy1zaWRlIG9mIHlvdXIgc2l0ZS48L3A+CgoJPHA+VG8gdW5sb2NrIHRoZSBhZG1pbiBmZWF0
dXJlcyBvZiB0aGlzIHBsdWdpbiB5b3Ugd2lsbCBuZWVkIHRvIGFzc29jaWF0ZSB5b3VyIHNp
dGUgd2l0aCBhIFR3aXR0ZXIgYWNjb3VudCBieSBjb25uZWN0aW5nIHRvIFR3aXR0ZXIgZnJv
bSB0aGUgcGx1Z2luJiM4MjE3O3Mgb3B0aW9ucyBzY3JlZW4uIENsaWNrIG9uIHRoZSBsaW5r
IHRvIGNvbm5lY3QgdG8gVHdpdHRlciwgeW91IHdpbGwgYmUgYXNrZWQgdG8gbG9naW4gdG8g
VHdpdHRlciwgY2xpY2tpbmcgdGhpcyBsaW5rIHdpbGwgdGVtcG9yYXJpbHkgdGFrZSB5b3Ug
dG8gdGhlIFR3aXR0ZXIgc2l0ZSB3aGVyZSB5b3Ugd2lsbCBiZSBhc2tlZCB0byBsb2dpbiBh
bmQgYXBwcm92ZSBhY2Nlc3MgZm9yIDxzcGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3
ZWV0IHRvIHJlYWQgYW5kIHdyaXRlIHRvIHlvdXIgVHdpdHRlciBhY2NvdW50LiBJZiBhbGwg
aXMgc3VjY2Vzc2Z1bCB5b3Ugd2lsbCBiZSByZXR1cm5lZCB0byB0aGUgb3B0aW9ucyBzY3Jl
ZW4gYW5kIHlvdXIgdXNlciBuYW1lIHdpbGwgYXBwZWFyLjwvcD4KCgk8cD5BdCBhbnkgdGlt
ZSB5b3UgY2FuIGRpc2Fzc29jaWF0ZSB5b3VyIFR3aXR0ZXIgYWNjb3VudCB3aXRoIDxzcGFu
IGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0IHZpYSB5b3VyIFR3aXR0ZXIgYWNjb3Vu
dCBwcmVmZXJlbmNlcyBvbiB0aGUgPGEgaHJlZj0iaHR0cDovL3d3dy50d2l0dGVyLmNvbSI+
VHdpdHRlciB3ZWJzaXRlPC9hPi48L3A+CgoJPHA+VG8gdW5pbnN0YWxsIDxzcGFuIGNsYXNz
PSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiBzaW1wbHkgZGVsZXRlIHRoZSBwbHVnaW4gZnJv
bSB0aGUgJiM4MjE2O1BsdWdpbnMmIzgyMTc7IHRhYi4gIFRoaXMgd2lsbCByZW1vdmUgdGhl
IHBsdWdpbiBjb2RlLCBkZWxldGUgcmVsYXRlZCBwcmVmZXJlbmNlcyBhbmQgZHJvcCB0aGUg
PHNwYW4gY2xhc3M9InRhZyI+YXJjX3R3aXR0ZXI8L3NwYW4+IHRhYmxlIGZyb20geW91ciBU
ZXh0cGF0dGVybiBkYXRhYmFzZS48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJj
X3R3aXR0ZXJfdGFnIj5UaGUgYXJjX3R3aXR0ZXIgdGFnPC9oMj4KCgk8aDM+U3ludGF4PC9o
Mz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyIHVzZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZx
dW90OyAvJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0
aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVs
dDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVzZXI8
L3RkPgoJCQk8dGQ+VHdpdHRlciB1c2VyIG5hbWU8L3RkPgoJCQk8dGQ+IDxlbT5hcmNfdHdp
dHRlciB1c2VybmFtZTwvZW0+PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXluaW5q
YSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5saW1pdDwvdGQ+CgkJCTx0ZD5N
YXhpbXVtIG51bWJlciBvZiB0d2VldHMgdG8gZGlzcGxheSAobWF4LiAyMDApPC90ZD4KCQkJ
PHRkPjEwPC90ZD4KCQkJPHRkPmxpbWl0PSZxdW90OzI1JnF1b3Q7PC90ZD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmRhdGVmb3JtYXQ8L3RkPgoJCQk8dGQ+Rm9ybWF0IHRoYXQgdXBkYXRl
IGRhdGVzIHdpbGwgYXBwZWFyIGFzPC90ZD4KCQkJPHRkPiA8ZW0+QXJjaGl2ZSBkYXRlIGZv
cm1hdDwvZW0+PC90ZD4KCQkJPHRkPmRhdGVmb3JtYXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAl
cCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbDwvdGQ+CgkJCTx0ZD5M
YWJlbCBmb3IgdGhlIHRvcCBvZiB0aGUgbGlzdDwvdGQ+CgkJCTx0ZD4gPGVtPm5vIGxhYmVs
PC9lbT48L3RkPgoJCQk8dGQ+bGFiZWw9JnF1b3Q7TXkgVHdpdHRlciB0aW1lbGluZSZxdW90
OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbHRhZzwvdGQ+CgkJCTx0ZD5JbmRl
cGVuZGVudCB3cmFwdGFnIGZvciBsYWJlbDwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48
L3RkPgoJCQk8dGQ+bGFiZWx0YWc9JnF1b3Q7aDMmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRy
PgoJCQk8dGQ+YnJlYWs8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNs
YXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnICh3aXRob3V0IGJyYWNrZXRzKSwg
b3Igc3RyaW5nLCB1c2VkIHRvIHNlcGFyYXRlIHRoZSB1cGRhdGVzPC90ZD4KCQkJPHRkPmxp
PC90ZD4KCQkJPHRkPmJyZWFrPSZxdW90O2JyJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4K
CQkJPHRkPndyYXB0YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNs
YXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVzZWQgYXMgdGhlIHdy
YXB0YWcsIHdpdGhvdXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90
ZD4KCQkJPHRkPndyYXB0YWc9JnF1b3Q7dWwmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJ
CQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNz
PSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgZm9yIHdyYXB0YWc8
L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXI8L3RkPgoJCQk8dGQ+Y2xhc3M9JnF1b3Q7dHdpdHRl
ciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzc19wb3N0ZWQ8L3RkPgoJ
CQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+
PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byBzcGFuIHRhZyBhcm91bmQgcG9z
dGVkIGRhdGU8L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXItcG9zdGVkPC90ZD4KCQk8L3RyPgoJ
PC90YWJsZT4KCgk8aDM+RXhhbXBsZSB1c2FnZTwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdp
dHRlciB1c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDsgbGltaXQ9JnF1b3Q7NSZxdW90
OyB3cmFwdGFnPSZxdW90O3VsJnF1b3Q7IGJyZWFrPSZxdW90O2xpJnF1b3Q7IGRhdGVmb3Jt
YXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAlcCZxdW90OyAvJmd0OzwvcD4KCgk8cD5Qcm9kdWNl
cyBhIGJ1bGxldCBwb2ludCBsaXN0IG9mIHRoZSBsYXN0IDUgVHdpdHRlciB1cGRhdGVzIGZy
b20gZHJtb25rZXluaW5qYSYjODIxNztzIFR3aXR0ZXIgZmVlZCB3aXRoIGEgZGVmaW5lZCBk
YXRlIGZvcm1hdCB0byBvdmVycmlkZSB0aGUgZGVmYXVsdCBhcmNoaXZlIGRhdGUgZm9ybWF0
LjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9zZWFyY2hfdGFn
Ij5UaGUgYXJjX3R3aXR0ZXJfc2VhcmNoIHRhZzwvaDI+CgoJPGgzPlN5bnRheDwvaDM+CgoJ
PHA+Jmx0O3R4cDphcmNfdHdpdHRlcl9zZWFyY2ggaGFzaHRhZ3M9JnF1b3Q7dHhwJnF1b3Q7
IC8mZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0
dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90
aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+c2VhcmNoPC90
ZD4KCQkJPHRkPkNvbW1hIHNlcGFyYXRlZCBsaXN0IG9mIHNlYXJjaCB3b3JkczwvdGQ+CgkJ
CTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+c2VhcmNoPSZxdW90O3R4cCx0ZXh0
cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5oYXNodGFnczwvdGQ+
CgkJCTx0ZD5Db21tYSBzZXBhcmF0ZWQgbGlzdCBvZiBoYXNodGFncyB0byBzZWFyY2ggZm9y
IChub3QgaW5jbHVkaW5nIHRoZSBoYXNoKTwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48
L3RkPgoJCQk8dGQ+aGFzaHRhZ3M9JnF1b3Q7dHhwLHRleHRwYXR0ZXJuJnF1b3Q7PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPnJlcGx5PC90ZD4KCQkJPHRkPlVzZXJuYW1lIG9mIHR3
ZWV0cyBpbiByZXBseSB0bzwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8
dGQ+cmVwbHk9JnF1b3Q7dHdpdHRlciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5tZW50aW9uPC90ZD4KCQkJPHRkPlVzZXJuYW1lIG9mIHVzZXIgbWVudGlvbmVkIGluIHR3
ZWV0cyAoPGk+aS5lLjwvaT4gdHdlZXRzIGNvbnRhaW5pbmcgQHVzZXJuYW1lKTwvdGQ+CgkJ
CTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+bWVudGlvbj0mcXVvdDt0d2l0dGVy
JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxpbWl0PC90ZD4KCQkJPHRkPk1h
eGltdW0gbnVtYmVyIG9mIHR3ZWV0cyB0byBkaXNwbGF5IChtYXguIDIwMCk8L3RkPgoJCQk8
dGQ+MTA8L3RkPgoJCQk8dGQ+bGltaXQ9JnF1b3Q7MjUmcXVvdDs8L3RkPgoJCTwvdHI+CgkJ
PHRyPgoJCQk8dGQ+ZGF0ZWZvcm1hdDwvdGQ+CgkJCTx0ZD5Gb3JtYXQgdGhhdCB1cGRhdGUg
ZGF0ZXMgd2lsbCBhcHBlYXIgYXM8L3RkPgoJCQk8dGQ+IDxlbT5BcmNoaXZlIGRhdGUgZm9y
bWF0PC9lbT48L3RkPgoJCQk8dGQ+ZGF0ZWZvcm1hdD0mcXVvdDslYiAlT2UsICVJOiVNICVw
JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsPC90ZD4KCQkJPHRkPkxh
YmVsIGZvciB0aGUgdG9wIG9mIHRoZSBsaXN0PC90ZD4KCQkJPHRkPiA8ZW0+bm8gbGFiZWw8
L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbHRhZzwvdGQ+CgkJCTx0ZD5J
bmRlcGVuZGVudCB3cmFwdGFnIGZvciBsYWJlbDwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9l
bT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+YnJlYWs8L3RkPgoJCQk8dGQ+PHNwYW4g
Y2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFn
ICh3aXRob3V0IGJyYWNrZXRzKSwgb3Igc3RyaW5nLCB1c2VkIHRvIHNlcGFyYXRlIHRoZSB1
cGRhdGVzPC90ZD4KCQkJPHRkPmxpPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPndyYXB0
YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5I
VE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVzZWQgYXMgdGhlIHdyYXB0YWcsIHdpdGhv
dXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3Bh
biBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGZvciB3
cmFwdGFnPC90ZD4KCQkJPHRkPmFyY190d2l0dGVyX3NlYXJjaDwvdGQ+CgkJPC90cj4KCQk8
dHI+CgkJCTx0ZD5jbGFzc191c2VyPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48
c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFw
cGxpZWQgdG8gc3BhbiB0YWcgYXJvdW5kIHVzZXIgbmFtZTwvdGQ+CgkJCTx0ZD5hcmNfdHdp
dHRlci11c2VyPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzX3Bvc3RlZDwvdGQ+
CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bh
bj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHNwYW4gdGFnIGFyb3VuZCBw
b3N0ZWQgZGF0ZTwvdGQ+CgkJCTx0ZD5hcmNfdHdpdHRlci1wb3N0ZWQ8L3RkPgoJCTwvdHI+
Cgk8L3RhYmxlPgoKCTxoMz5FeGFtcGxlIHVzYWdlPC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190
d2l0dGVyX3NlYXJjaCBzZWFyY2g9JnF1b3Q7cGx1Z2luJnF1b3Q7IGhhc2h0YWdzPSZxdW90
O3R4cCx0ZXh0cGF0dGVybiZxdW90OyBsaW1pdD0mcXVvdDsyNSZxdW90OyAvJmd0OzwvcD4K
Cgk8cD5Qcm9kdWNlcyBhIGxpc3Qgb2YgdHdlZXRzIGNvbnRhaW5pbmcgdGhlIHdvcmQgJiM4
MjE2O3BsdWdpbiYjODIxNzsgYW5kIHRoZSBoYXNodGFncyAmIzgyMTY7I3R4cCYjODIxNzsg
YW5kICYjODIxNjsjdGV4dHBhdHRlcm4mIzgyMTc7LiBUaGUgdGFnIHdpbGwgcmV0dXJuIGEg
bWF4aW11bSBvZiAyNSB0d2VldHMuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFy
Y190d2l0dGVyX3JldHdlZXRfdGFnIj5UaGUgYXJjX3R3aXR0ZXJfcmV0d2VldCB0YWc8L2gy
PgoKCTxoMz5TeW50YXg8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfcmV0d2VldCAv
Jmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRy
aWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+
CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVzZXI8L3RkPgoJ
CQk8dGQ+VHdpdHRlciB1c2VyIG5hbWUgdG8gcXVvdGU8L3RkPgoJCQk8dGQ+IDxlbT5hcmNf
dHdpdHRlciB1c2VybmFtZTwvZW0+PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXlu
aW5qYSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD51cmw8L3RkPgoJCQk8dGQ+
PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+PC9zcGFu
PiB0byByZXR3ZWV0PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnRleHQ8L3RkPgoJCQk8
dGQ+UmV0d2VldCB0ZXh0PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmZvbGxvdzE8L3Rk
PgoJCQk8dGQ+U3VnZ2VzdGVkIFR3aXR0ZXIgYWNjb3VudCB0byBmb2xsb3csIGZvciBleGFt
cGxlIHlvdXIgb3duPC90ZD4KCQkJPHRkPkEgVHdpdHRlciB1c2VyIHRvIHJlY29tbWVuZDwv
dGQ+CgkJCTx0ZD5mb2xsb3cxPSZxdW90O1RleHRwYXR0ZXJuJnF1b3Q7PC90ZD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPmZvbGxvdzI8L3RkPgoJCQk8dGQ+QXMgZm9sbG93MTwvdGQ+CgkJ
CTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFuZzwv
dGQ+CgkJCTx0ZD5MYW5ndWFnZTwvdGQ+CgkJCTx0ZD5lbjwvdGQ+CgkJCTx0ZD5sYW5nPSZx
dW90O2VzJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNvdW50PC90ZD4KCQkJ
PHRkPkNvdW50IGJveCBwb3NpdGlvbiwgb3B0aW9uczogbm9uZSwgaG9yaXpvbnRhbCBvciB2
ZXJ0aWNhbDwvdGQ+CgkJCTx0ZD5ob3Jpem9udGFsPC90ZD4KCQkJPHRkPmNvdW50PSZxdW90
O25vbmUmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aW5jbHVkZV9qczwvdGQ+
CgkJCTx0ZD5XaGV0aGVyIG9yIG5vdCB0byBpbmNsdWRlIHRoZSBKYXZhU2NyaXB0PC90ZD4K
CQkJPHRkPjE8L3RkPgoJCQk8dGQ+aW5jbHVkZV9qcz0mcXVvdDswJnF1b3Q7PC90ZD4KCQk8
L3RyPgoJCTx0cj4KCQkJPHRkPndyYXB0YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNh
cHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVz
ZWQgYXMgdGhlIHdyYXB0YWcsIHdpdGhvdXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51
bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRk
PjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bh
bj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gdGhlIHJldHdlZXQgYnV0dG9uPC90ZD4K
CQkJPHRkPnR3aXR0ZXItc2hhcmUtYnV0dG9uPC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8
aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl90d2VldF91cmwiPmFyY190d2l0
dGVyX3R3ZWV0X3VybDwvaDI+CgoJPHA+UmV0dXJucyB0aGUgPHNwYW4gY2xhc3M9ImNhcHMi
PlVSTDwvc3Bhbj4gb2YgdGhlIFR3aXR0ZXIgc3RhdHVzIGZvciBhbiBhcnRpY2xlLjwvcD4K
Cgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyX3R3ZWV0X3VybCAv
Jmd0OzwvcD4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyX3R3ZWV0X3VybCZndDtMaW5rIHRl
eHQmbHQ7L3R4cDphcmNfdHdpdHRlcl90d2VldF91cmwmZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwv
aDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNj
cmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+aWQ8L3RkPgoJCQk8dGQ+VGV4dHBhdHRlcm4gYXJ0aWNs
ZSBJRDwvdGQ+CgkJCTx0ZD4gPGVtPmN1cnJlbnQgYXJ0aWNsZTwvZW0+PC90ZD4KCQkJPHRk
PmlkPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+dGl0bGU8L3Rk
PgoJCQk8dGQ+VGl0bGUgYXR0cmlidXRlIG9mIHRoZSBsaW5rPC90ZD4KCQkJPHRkPiA8ZW0+
dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0
ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3Nw
YW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHRoZSBsaW5rPC90ZD4KCQkJPHRkPiA8
ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPGgyIGNsYXNzPSJzZWN0
aW9uIiBpZD0iYXJjX3R3aXR0ZXJfdGlueXVybCI+YXJjX3R3aXR0ZXJfdGlueXVybDwvaDI+
CgoJPHA+UmV0dXJucyB0aGUgc2hvcnRlbmVkIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3Nw
YW4+IG9mIHRoZSBhcnRpY2xlIHVzZWQgZm9yIHRoZSBUd2l0dGVyIHVwZGF0ZS48L3A+CgoJ
PGgzPlN5bnRheDwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl90aW55dXJsIC8mZ3Q7
PC9wPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfdGlueXVybCZndDtMaW5rIHRleHQmbHQ7
L3R4cDphcmNfdHdpdHRlcl90aW55dXJsJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0
YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248
L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmlkPC90ZD4KCQkJPHRkPlRleHRwYXR0ZXJuIGFydGljbGUgSUQ8L3Rk
PgoJCQk8dGQ+IDxlbT5jdXJyZW50IGFydGljbGU8L2VtPjwvdGQ+CgkJCTx0ZD5pZD0mcXVv
dDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnRpdGxlPC90ZD4KCQkJPHRk
PlRpdGxlIGF0dHJpYnV0ZSBvZiB0aGUgbGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9l
bT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4g
Y2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFz
cyBhdHRyaWJ1dGUgYXBwbGllZCB0byB0aGUgbGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0
PC9lbT48L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9
ImFyY190d2l0dGVyX2NhY2hpbmciPkNhY2hpbmc8L2gyPgoKCTxwPkluIG9yZGVyIHRvIHBy
ZXZlbnQgZXhjZXNzaXZlIHJlcGVhdGl0aXZlIGNhbGxzIHRvIHRoZSBUd2l0dGVyIHdlYnNp
dGUgaXQgaXMgcmVjb21tZW5kZWQgdG8gY2FjaGUgcmVzdWx0cy4gVHdpdHRlciBsaW1pdHMg
dGhlIG51bWJlciBvZiBjYWxscyB0aHJvdWdoIHRoZSA8c3BhbiBjbGFzcz0iY2FwcyI+QVBJ
PC9zcGFuPiwgYW5kIGNvbnRpbnVvdXMgY2FsbHMgd2lsbCByZXN1bHQgaW4gVHdpdHRlciBj
bG9zaW5nIHRvIGZ1cnRoZXIgcmVxdWVzdHMuIEJ5IGRlZmF1bHQsIGFyY190d2l0dGVyIGNh
Y2hlcyBmb3IgMzAgbWludXRlIGludGVydmFscy48L3A+CgoJPHRhYmxlPgoJCTx0cj4KCQkJ
PHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZh
dWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2Fj
aGluZzwvdGQ+CgkJCTx0ZD4mIzgyMTY7MSYjODIxNzsgdG8gY2FjaGUgZmVlZCwgJiM4MjE2
OzAmIzgyMTc7IHRvIHR1cm4gY2FjaGluZyBvZmYgKG5vdCByZWNvbW1lbmRlZCk8L3RkPgoJ
CQk8dGQ+MTwvdGQ+CgkJCTx0ZD5jYWNoaW5nPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+Y2FjaGVfZGlyPC90ZD4KCQkJPHRkPkFic29sdXRlIHBhdGggdG8g
dGhlIGNhY2hlIGRpcmVjdG9yeSAobXVzdCBiZSB3cml0YWJsZSk8L3RkPgoJCQk8dGQ+IDxl
bT5hcmNfdHdpdHRlciBwcmVmZXJlbmNlczwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJ
PHRkPmNhY2hlX3RpbWU8L3RkPgoJCQk8dGQ+VGltZSBpbiBtaW51dGVzIHRoYXQgdGhlIGNh
Y2hlIGZpbGVzIGFyZSBzdG9yZWQgYmVmb3JlIGJlaW5nIHJlZnJlc2hlZDwvdGQ+CgkJCTx0
ZD41PC90ZD4KCQkJPHRkPmNhY2hlX3RpbWU9JnF1b3Q7MzAmcXVvdDs8L3RkPgoJCTwvdHI+
Cgk8L3RhYmxlPgoKCTxwPlRoZSBhZG1pbiBzaWRlIG9mIHRoaXMgcGx1Z2luIGVuZm9yY2Vz
IGNhY2hpbmcsIGFwYXJ0IGZyb20gd2hlbiBpdCBpcyBwb3N0aW5nIHRvIFR3aXR0ZXIgKDxp
PmUuZy48L2k+IHdoZW4gcG9zdGluZyBvciBkZWxldGluZyBhbiB1cGRhdGUpLjwvcD4KCgk8
aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9wcmVmcyI+UHJlZmVyZW5jZXM8
L2gyPgoKCTxwPllvdSBjYW4gYWNjZXNzIHRoZSBwbHVnaW5zIGNvcmUgcHJlZmVyZW5jZXMg
ZnJvbSBlaXRoZXIgdGhlIFByZWZlcmVuY2VzIG9yIFBsdWdpbnMgdGFicyBpbiBhZG1pbi4g
U2V0dXAgeW91ciBUd2l0dGVyIGFjY291bnQgKHlvdSB3aWxsIGJlIGFza2VkIHRvIGNvbm5l
Y3QgdmlhIFR3aXR0ZXIgYW5kIHRoaXMgbmVlZHMgZG9pbmcgYmVmb3JlIHlvdSBjYW4gdXNl
IHRoZSBwbHVnaW4pIGFuZCBjaGFuZ2UgdGhlIGNhY2hlIGRpcmVjdG9yeSB1c2luZyBhcmNf
dHdpdHRlciYjODIxNztzIHByZWZlcmVuY2VzLiBXaXRob3V0IHByb3ZpZGluZyB5b3VyIGFj
Y291bnQgbG9naW4gZGV0YWlscyB0aGUgYWRtaW4gYXJlYSBmZWF0dXJlcyBvZiB0aGlzIHBs
dWdpbiB3aWxsIGJlIGluYWN0aXZlLjwvcD4KCgk8cD5Zb3UgY2FuIHNlbGVjdCB0aGUgPHNw
YW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4gc2hvcnRlbmVyIG1ldGhvZCB5b3Ugd2FudCB0
byB1c2UgdG8gbGluayBiYWNrIHRvIHlvdXIgYXJ0aWNsZSBvbiBUd2l0dGVyLiBQbGVhc2Ug
bm90ZSB0aGF0IGlmIHlvdSBzZWxlY3Qgc21kX3Nob3J0X3VybCB5b3Ugd2lsbCBuZWVkIHRv
IGhhdmUgaW5zdGFsbGVkIGFuZCBhY3RpdmF0ZWQgdGhlIDxhIGhyZWY9Imh0dHA6Ly90ZXh0
cGF0dGVybi5vcmcvcGx1Z2lucy8xMDk5L3NtZF9zaG9ydF91cmwiPjxzcGFuIGNsYXNzPSJ0
YWciPnNtZF9zaG9ydF91cmw8L3NwYW4+IHBsdWdpbjwvYT4gZGV2ZWxvcGVkIGJ5IFN0ZWYg
RGF3c29uLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9hcnRp
Y2xlIj5Ud2VldGluZyBhcnRpY2xlczwvaDI+CgoJPHA+QnkgZGVmYXVsdCBhcmNfdHdpdHRl
ciB3aWxsIHBvc3QgYW4gdXBkYXRlIHRvIFR3aXR0ZXIgaW5jbHVkaW5nIGEgc2hvcnRlbmVk
IDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+IHRvIHlvdXIgYXJ0aWNsZS4gT25seSBs
aXZlIGFuZCBhY3RpdmUgYXJ0aWNsZXMgd2lsbCBiZSBzZW50IHRvIFR3aXR0ZXIsIDxpPmku
ZS48L2k+IGFydGljbGVzIHBvc3RlZCBpbiB0aGUgZnV0dXJlIG9yIGFzIHN0aWNreSBhcnRp
Y2xlcyB3aWxsIG5vdCBiZSBzZW50LiBJZiB5b3VyIGFydGljbGUgaXMgc3VjY2Vzc2Z1bGx5
IHN1Ym1pdHRlZCB0byBUd2l0dGVyIHRoZSB1cGRhdGUgd2lsbCBhcHBlYXIgaW4gcGxhY2Ug
b2YgdGhlIFR3aXR0ZXIgb3B0aW9uIG9uIHRoZSByaWdodC1oYW5kLXNpZGUgb2YgdGhlIGFy
dGljbGUgZWRpdCBzY3JlZW4uPC9wPgoKCTxwPlR3ZWV0cyBhcmUgc2VudCBpbiB0aGUgZm9s
bG93aW5nIGZvcm1hdDogPGVtPlR3ZWV0IHByZWZpeDwvZW0+IDxlbT5BcnRpY2xlIHRpdGxl
PC9lbT4gPGVtPlNob3J0ZW5lZCA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPjwvZW0+
IDxlbT5Ud2VldCBzdWZmaXg8L2VtPi4gWW91IGNhbiBjaGFuZ2UgdGhlIHByZWZpeCBhbmQg
c3VmZml4IG9uIGFuIGFydGljbGUtYnktYXJ0aWNsZSBiYXNpcyBieSBjaGFuZ2luZyB0aGUg
dHdlZXQgb3B0aW9ucyB1bmRlciAmIzgyMTY7VXBkYXRlIFR3aXR0ZXImIzgyMTc7IG9uIHRo
ZSBhcnRpY2xlIGVkaXRvciBzY3JlZW4uIFRoZSBkZWZhdWx0IDxlbT5Ud2VldCBwcmVmaXg8
L2VtPiBjYW4gYmUgc2V0IHVuZGVyIHRoZSA8c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRl
cjwvc3Bhbj4gcHJlZmVyZW5jZXMgc2NyZWVuICh0aGUgZGVmYXVsdCBvbiBpbnN0YWxsYXRp
b24gaXMgJiM4MjIwO0p1c3QgcG9zdGVkOiYjODIyMTspLjwvcD4KCgk8cD5QbGVhc2Ugbm90
ZSB0aGF0IG9uY2UgYW4gYXJ0aWNsZSBoYXMgYmVlbiB0d2VldGVkIHRoZSB0d2VldCBjYW5u
b3QgYmUgZWRpdGVkLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRl
cl9hZG1pbiI+VGhlIFR3aXR0ZXIgdGFiPC9oMj4KCgk8cD5VbmRlciB0aGUgRXh0ZW5zaW9u
cyB0YWIgKHRoaXMgY2FuIGJlIGNoYW5nZWQgZnJvbSB0aGUgcGx1Z2luJiM4MjE3O3MgcHJl
ZmVyZW5jZSBwYWdlKSBhIG5ldyBUd2l0dGVyIHRhYiBzaG91bGQgYXBwZWFyIG9uY2UgeW91
IGhhdmUgY29ubmVjdGVkIHlvdXIgc2l0ZSB0byB5b3VyIFR3aXR0ZXIgYWNjb3VudC4gRnJv
bSBoZXJlIHlvdSB3aWxsIGJlIGFibGUgdG8gc3VibWl0IG5ldyBUd2l0dGVyIHVwZGF0ZXMs
IHZpZXcgYmFzaWMgYWNjb3VudCBzdGF0aXN0aWNzLCBhbmQgY2hlY2sgb3V0IHlvdXIgcmVj
ZW50IHVwZGF0ZXMgKGluY2x1ZGluZyB0aGUgb3B0aW9uIHRvIGRlbGV0ZSB5b3VyIHR3ZWV0
cykuPC9wPiI7czo0OiJjb2RlIjtzOjc1NjI5OiJnbG9iYWwgJHByZWZzLCR0eHBjZmcsJGFy
Y190d2l0dGVyX2NvbnN1bWVyS2V5LCRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiRh
cmNfdHdpdHRlciA9IGFycmF5KCk7CgokYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkgPSAnbktj
WHNsd3paaEJkMGtmS01ldG5QQSc7CiRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCA9ICdD
Nm5TUENMM2VlSEdUQmhLQ2d3ZDlvY2xjdUQwc3JCOFdWa2ZYUVlDNTQnOwoKYWRkX3ByaXZz
KCdwbHVnaW5fcHJlZnMuYXJjX3R3aXR0ZXInLCcxLDInKTsKcmVnaXN0ZXJfY2FsbGJhY2so
J2FyY190d2l0dGVyX2luc3RhbGwnLCdwbHVnaW5fbGlmZWN5Y2xlLmFyY190d2l0dGVyJywg
J2luc3RhbGxlZCcpOwpyZWdpc3Rlcl9jYWxsYmFjaygnYXJjX3R3aXR0ZXJfdW5pbnN0YWxs
JywncGx1Z2luX2xpZmVjeWNsZS5hcmNfdHdpdHRlcicsICdkZWxldGVkJyk7CnJlZ2lzdGVy
X2NhbGxiYWNrKCdhcmNfdHdpdHRlcl9wcmVmcycsJ3BsdWdpbl9wcmVmcy5hcmNfdHdpdHRl
cicpOwoKLyoKICogU2V0dXAgaW5pdGlhbCBwcmVmZXJlbmNlcyBpZiBub3QgaW4gdGhlIHR4
cF9wcmVmcyB0YWJsZS4KICovCmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl91c2Vy
J10pKQogICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3VzZXInLCAnJywgJ2FyY190d2l0dGVy
JywgMSwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX3By
ZWZpeCddKSkKICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfcHJlZml4JywnSnVzdCBwb3N0ZWQ6
JywgJ2FyY190d2l0dGVyJywgMiwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3NldCgkcHJlZnNb
J2FyY190d2l0dGVyX2NhY2hlX2RpciddKSkKICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfY2Fj
aGVfZGlyJywkdHhwY2ZnWyd0eHBhdGgnXS4kcHJlZnNbJ3RlbXBkaXInXSwgJ2FyY190d2l0
dGVyJywgMSwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVy
X3R3ZWV0X2RlZmF1bHQnXSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1
bHQnLCAxLCAnYXJjX3R3aXR0ZXInLCAyLCAneWVzbm9SYWRpbycpOwppZiAoIWlzc2V0KCRw
cmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddKSkKICBzZXRfcHJlZignYXJjX3R3aXR0
ZXJfdXJsX21ldGhvZCcsICd0aW55dXJsJywgJ2FyY190d2l0dGVyJywgMiwKICAgICdhcmNf
dHdpdHRlcl91cmxfbWV0aG9kX3NlbGVjdCcpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3No
b3J0X3VybCddKSkKICBzZXRfcHJlZignYXJjX3Nob3J0X3VybCcsIDAsICdhcmNfdHdpdHRl
cicsIDIsICd5ZXNub1JhZGlvJyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfc2hvcnRfc2l0
ZV91cmwnXSkpCiAgc2V0X3ByZWYoJ2FyY19zaG9ydF9zaXRlX3VybCcsICRwcmVmc1snc2l0
ZXVybCddLCAnYXJjX3R3aXR0ZXInLCAyLCAndGV4dF9pbnB1dCcpOwovLyBNYWtlIHN1cmUg
dGhhdCB0aGUgVHdpdHRlciB0YWIgaGFzIGJlZW4gZGVmaW5lZAppZiAoIWlzc2V0KCRwcmVm
c1snYXJjX3R3aXR0ZXJfdGFiJ10pKSB7CiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3RhYics
ICdleHRlbnNpb25zJywgJ2FyY190d2l0dGVyJywgMiwKICAgICdhcmNfdHdpdHRlcl90YWJf
c2VsZWN0Jyk7CiAgICAkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddID0gJ2V4dGVuc2lvbnMn
Owp9CgovLyBDaGVjayBpZiBhcmNfc2hvcnRfdXJsIGlzIGVuYWJsZWQKaWYgKCRwcmVmc1sn
YXJjX3Nob3J0X3VybCddIHx8ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddPT0n
YXJjX3R3aXR0ZXInKSB7CiAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19zaG9ydF91cmxfcmVk
aXJlY3QnLCAndHhwX2RpZScsIDQwNCk7Cn0KCmlmIChAdHhwaW50ZXJmYWNlID09ICdhZG1p
bicpIHsKICAgIGlmICghZW1wdHkoJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10pCiAgICAg
ICAgJiYgIWVtcHR5KCRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXSkKICAgICAg
ICAmJiAhZW1wdHkoJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKSAp
IHsKCiAgICAgICAgaWYgKCRwcmVmc1snYXJjX3R3aXR0ZXJfdGFiJ10pIHsKICAgICAgICAg
ICAgYWRkX3ByaXZzKCdhcmNfYWRtaW5fdHdpdHRlcicsICcxLDIsMyw0Jyk7CiAgICAgICAg
ICAgIHJlZ2lzdGVyX3RhYigkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddLCAnYXJjX2FkbWlu
X3R3aXR0ZXInLCAnVHdpdHRlcicpOwogICAgICAgICAgICByZWdpc3Rlcl9jYWxsYmFjaygn
YXJjX2FkbWluX3R3aXR0ZXInLCAnYXJjX2FkbWluX3R3aXR0ZXInKTsKICAgICAgICB9Cgog
ICAgICAgIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYXJ0aWNsZV90d2VldCcsICdwaW5nJyk7
CiAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hcnRpY2xlX3R3ZWV0JywgJ2FydGlj
bGUnLCAnZWRpdCcsIDEpOwogICAgICAgIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYXBwZW5k
X3R3aXR0ZXInLCAnYXJ0aWNsZV91aScsICdzdGF0dXMnKTsKICAgIH0KfQoKLyoKICAgIFB1
YmxpYy1zaWRlIGZ1bmN0aW9ucwogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoqLwoKZnVuY3Rpb24gYXJjX3R3
aXR0ZXIoJGF0dHMpCnsKICBnbG9iYWwgJHByZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1lcktl
eSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICBleHRyYWN0KGxBdHRzKGFycmF5
KAogICAgJ3VzZXInICAgICAgPT4gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sCiAgICAn
cGFzc3dvcmQnICA9PiAnJywKICAgICd0aW1lbGluZScgID0+ICd1c2VyJywKICAgICdsaW1p
dCcgICAgID0+ICcxMCcsCiAgICAncmV0d2VldHMnICA9PiBmYWxzZSwKICAgICdkYXRlZm9y
bWF0Jz0+ICRwcmVmc1snYXJjaGl2ZV9kYXRlZm9ybWF0J10sCiAgICAnY2FjaGluZycgICA9
PiAnMScsCiAgICAnY2FjaGVfZGlyJyA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX2NhY2hlX2Rp
ciddLAogICAgJ2NhY2hlX3RpbWUnPT4gJzUnLAogICAgJ2xhYmVsJyAgICAgPT4gJycsCiAg
ICAnbGFiZWx0YWcnICA9PiAnJywKICAgICdicmVhaycgICAgID0+ICdsaScsCiAgICAnd3Jh
cHRhZycgICA9PiAnJywKICAgICdjbGFzcycgICAgID0+IF9fRlVOQ1RJT05fXywKICAgICdj
bGFzc19wb3N0ZWQnID0+IF9fRlVOQ1RJT05fXy4nLXBvc3RlZCcKICAgICksJGF0dHMpKTsK
CiAgJHR3aXQgPSBuZXcgYXJjX1R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAk
YXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQpOwoKICBpZiAoJGNhY2hpbmcpIHsgIC8vIHR1
cm4gb24gY2FjaGluZywgcmVjb21tZW5kZWQgKGRlZmF1bHQpCiAgICAkdHdpdC0+c2V0Q2Fj
aGluZyh0cnVlKTsKICAgICR0d2l0LT5jYWNoZURpcigkY2FjaGVfZGlyKTsKICAgICR0d2l0
LT5jYWNoZVRpbWUoJGNhY2hlX3RpbWUpOwogIH0gZWxzZSB7ICAvLyB0dXJuIG9mZiBjYWNo
aW5nLCBub3QgcmVjb21tZW5kZWQgb3RoZXIgdGhhbiBmb3IgdGVzdGluZwogICAgJHR3aXQt
PnNldENhY2hpbmcoZmFsc2UpOwogIH0KCiAgc3dpdGNoICgkdGltZWxpbmUpIHsKICAgIGNh
c2UgJ2hvbWUnOiBjYXNlICdmcmllbmRzJzoKICAgICAgJHRpbWVsaW5lID0gJ3N0YXR1c2Vz
L2ZyaWVuZHNfdGltZWxpbmUnOyBicmVhazsKICAgIGNhc2UgJ21lbnRpb25zJzoKICAgICAg
JHRpbWVsaW5lID0gJ3N0YXR1c2VzL21lbnRpb25zJzsgYnJlYWs7CiAgICBjYXNlICd1c2Vy
JzogZGVmYXVsdDogJHRpbWVsaW5lID0gJ3N0YXR1c2VzL3VzZXJfdGltZWxpbmUnOwogIH0K
CiAgJG91dCA9IGFycmF5KCk7CiAgJHhtbCA9ICR0d2l0LT5nZXQoJHRpbWVsaW5lCiAgICAs
IGFycmF5KCdzY3JlZW5fbmFtZSc9PiR1c2VyLCdjb3VudCc9PiRsaW1pdCwnaW5jbHVkZV9y
dHMnPT4kcmV0d2VldHMpKTsKICBpZiAoJHhtbCkgewogICAgJHR3ZWV0cyA9IEAkeG1sLT54
cGF0aCgnL3N0YXR1c2VzL3N0YXR1cycpOwogICAgaWYgKCR0d2VldHMpIGZvcmVhY2ggKCR0
d2VldHMgYXMgJHR3ZWV0KSB7CiAgICAgICR0aW1lID0gc3RydG90aW1lKGh0bWxlbnRpdGll
cygkdHdlZXQtPmNyZWF0ZWRfYXQpKTsKICAgICAgJGRhdGUgPSBzYWZlX3N0cmZ0aW1lKCRk
YXRlZm9ybWF0LCR0aW1lKTsKICAgICAgJG91dFtdID0gYXJjX1R3aXR0ZXI6Om1ha2VMaW5r
cyhodG1sZW50aXRpZXMoJHR3ZWV0LT50ZXh0LCBFTlRfUVVPVEVTLCdVVEYtOCcpKQogICAg
ICAgIC4nICcudGFnKGh0bWxlbnRpdGllcygkZGF0ZSksJ3NwYW4nLCcgY2xhc3M9IicuJGNs
YXNzX3Bvc3RlZC4nIicpOwogICAgfQoKICAgIHJldHVybiBkb0xhYmVsKCRsYWJlbCwgJGxh
YmVsdGFnKS5kb1dyYXAoJG91dCwgJHdyYXB0YWcsICRicmVhaywgJGNsYXNzKTsKICB9Cgp9
CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl9zZWFyY2goJGF0dHMpCnsKICAgIGdsb2JhbCAkcHJl
ZnMsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNy
ZXQ7CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgICAndXNlcicgICAgICA9PiAk
cHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSwKICAgICAgICAnc2VhcmNoJyAgICA9PiAnJywK
ICAgICAgICAnaGFzaHRhZ3MnICA9PiAnJywKICAgICAgICAndXNlcicgICAgICA9PiAnJywK
ICAgICAgICAncmVwbHknICAgICA9PiAnJywKICAgICAgICAnbWVudGlvbicgICA9PiAnJywK
ICAgICAgICAnbGltaXQnICAgICA9PiAnMTAnLAogICAgICAgICdsYW5nJyAgICAgID0+ICcn
LAogICAgICAgICdkYXRlZm9ybWF0Jz0+ICRwcmVmc1snYXJjaGl2ZV9kYXRlZm9ybWF0J10s
CiAgICAgICAgJ2NhY2hpbmcnICAgPT4gJzEnLAogICAgICAgICdjYWNoZV9kaXInID0+ICRw
cmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10sCiAgICAgICAgJ2NhY2hlX3RpbWUnPT4g
JzUnLAogICAgICAgICdsYWJlbCcgICAgID0+ICcnLAogICAgICAgICdsYWJlbHRhZycgID0+
ICcnLAogICAgICAgICdicmVhaycgICAgID0+ICdsaScsCiAgICAgICAgJ3dyYXB0YWcnICAg
PT4gJycsCiAgICAgICAgJ2NsYXNzJyAgICAgPT4gX19GVU5DVElPTl9fLAogICAgICAgICdj
bGFzc19wb3N0ZWQnID0+IF9fRlVOQ1RJT05fXy4nLXBvc3RlZCcsCiAgICAgICAgJ2NsYXNz
X3VzZXInICAgPT4gX19GVU5DVElPTl9fLictdXNlcicKICAgICksJGF0dHMpKTsKCiAgICAg
ICAgJHR3aXQgPSBuZXcgYXJjX1R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAg
ICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0KTsKCiAgICAgICAgaWYg
KCRjYWNoaW5nKSB7ICAvLyB0dXJuIG9uIGNhY2hpbmcsIHJlY29tbWVuZGVkIChkZWZhdWx0
KQogICAgICAgICAgICAkdHdpdC0+c2V0Q2FjaGluZyh0cnVlKTsKICAgICAgICAgICAgJHR3
aXQtPmNhY2hlRGlyKCRjYWNoZV9kaXIpOwogICAgICAgICAgICAkdHdpdC0+Y2FjaGVUaW1l
KCRjYWNoZV90aW1lKTsKICAgICAgICB9IGVsc2UgeyAgLy8gdHVybiBvZmYgY2FjaGluZywg
bm90IHJlY29tbWVuZGVkIG90aGVyIHRoYW4gZm9yIHRlc3RpbmcKICAgICAgICAgICAgJHR3
aXQtPnNldENhY2hpbmcoZmFsc2UpOwogICAgICAgIH0KCiAgICAgICAgLy8gY29uc3RydWN0
IHNlYXJjaCBxdWVyeQogICAgICAgIGlmICghZW1wdHkoJHNlYXJjaCkpIHsKICAgICAgICAg
ICAgJHRlcm1zID0gZXhwbG9kZSgnLCcsJHNlYXJjaCk7ICR0ZXJtcyA9IGFycmF5X21hcCgn
dHJpbScsJHRlcm1zKTsKICAgICAgICAgICAgJHNlYXJjaCA9IGltcGxvZGUoJyAnLCR0ZXJt
cyk7CiAgICAgICAgfQogICAgICAgIGlmICgkaGFzaHRhZ3MpIHsKICAgICAgICAgICAgJGhh
c2hlcyA9IGV4cGxvZGUoJywnLCRoYXNodGFncyk7ICRoYXNoZXMgPSBhcnJheV9tYXAoJ3Ry
aW0nLCRoYXNoZXMpOwogICAgICAgICAgICAkc2VhcmNoLj0gKCgkc2VhcmNoKT8nICc6Jycp
LicjJy5pbXBsb2RlKCcgIycsJGhhc2hlcyk7CiAgICAgICAgfQogICAgICAgIGlmICgkcmVw
bHkpIHsKICAgICAgICAgICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/JyAnOicnKS4ndG86Jy50
cmltKCRyZXBseSk7CiAgICAgICAgfQogICAgICAgIGlmICgkdXNlcikgewogICAgICAgICAg
ICAkc2VhcmNoLj0gKCgkc2VhcmNoKT8nICc6JycpLidmcm9tOicudHJpbSgkdXNlcik7CiAg
ICAgICAgfQogICAgICAgIGlmICgkbWVudGlvbikgewogICAgICAgICAgICAkc2VhcmNoLj0g
KCgkc2VhcmNoKT8nICc6JycpLidAJy50cmltKCRtZW50aW9uKTsKICAgICAgICB9CgogICAg
ICAgIGlmIChlbXB0eSgkc2VhcmNoKSkgewogICAgICAgICAgICByZXR1cm4gJyc7CiAgICAg
ICAgfSBlbHNlIHsKICAgICAgICAgICAgJHNlYXJjaCA9IHVybGVuY29kZSgkc2VhcmNoKTsK
ICAgICAgICB9CgogICAgICAgICRvdXQgPSBhcnJheSgpOwogICAgICAgICR0d2VldHMgPSAk
dHdpdC0+Z2V0KCdodHRwOi8vc2VhcmNoLnR3aXR0ZXIuY29tL3NlYXJjaC5hdG9tP3E9Jy4k
c2VhcmNoCiAgICAgICAgICAgICwgYXJyYXkoJ3JwcCc9PiRsaW1pdCwnbGFuZyc9PiRsYW5n
KSk7CgogICAgICAgIGlmICgkdHdlZXRzKSB7IGZvcmVhY2ggKCR0d2VldHMtPmVudHJ5IGFz
ICR0d2VldCkgewogICAgICAgICAgICBwcmVnX21hdGNoKCIvKC4qKSBcKCguKilcKS8iLCR0
d2VldC0+YXV0aG9yLT5uYW1lLCRtYXRjaGVzKTsKICAgICAgICAgICAgbGlzdCgkYXV0aG9y
LCR1bmFtZSwkbmFtZSkgPSAkbWF0Y2hlczsKICAgICAgICAgICAgJHRpbWUgPSBzdHJ0b3Rp
bWUoaHRtbGVudGl0aWVzKCR0d2VldC0+cHVibGlzaGVkKSk7CiAgICAgICAgICAgICRkYXRl
ID0gc2FmZV9zdHJmdGltZSgkZGF0ZWZvcm1hdCwkdGltZSk7CiAgICAgICAgICAgICR0ZXh0
ID0gJHR3ZWV0LT50aXRsZTsKICAgICAgICAgICAgJG91dFtdID0gdGFnKGhyZWYoaHRtbGVu
dGl0aWVzKCR1bmFtZSksJHR3ZWV0LT5hdXRob3ItPnVyaSwKICAgICAgICAgICAgICAgICcg
dGl0bGU9IicuaHRtbGVudGl0aWVzKCRuYW1lKS4nIicpLic6ICcsJ3NwYW4nCiAgICAgICAg
ICAgICAgICAgICAgLCcgY2xhc3M9IicuJGNsYXNzX3VzZXIuJyInKQogICAgICAgICAgICAg
ICAgLmFyY19Ud2l0dGVyOjptYWtlTGlua3MoaHRtbGVudGl0aWVzKCR0ZXh0LCBFTlRfUVVP
VEVTLCdVVEYtOCcpKQogICAgICAgICAgICAgICAgLicgJy50YWcoaHRtbGVudGl0aWVzKCRk
YXRlKSwnc3BhbicKICAgICAgICAgICAgICAgICAgICAsJyBjbGFzcz0iJy4kY2xhc3NfcG9z
dGVkLiciJyk7CiAgICAgICAgfSByZXR1cm4gZG9MYWJlbCgkbGFiZWwsICRsYWJlbHRhZykK
ICAgICAgICAgICAgLmRvV3JhcCgkb3V0LCAkd3JhcHRhZywgJGJyZWFrLCAkY2xhc3MpOyB9
Cgp9CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl90d2VldCgkYXR0cykgewogICAgZ2xvYmFsICR0
aGlzYXJ0aWNsZTsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAnaWQnICAgICAg
ICA9PiAkdGhpc2FydGljbGVbJ3RoaXNpZCddLAogICAgICAnaW5jbHVkZV91cmwnICAgPT4g
dHJ1ZQogICAgKSwkYXR0cykpOwoKICAgIGlmICgkaWQpIHsKICAgICAgLy8gRmV0Y2ggYXJj
X3R3aXR0ZXIgc3R1ZmYgdG8gYnVpbGQgdHdlZXQgZnJvbQogICAgICAkdHdlZXQgPSAoJGlu
Y2x1ZGVfdXJsKSA/IHNhZmVfcm93KCJ0d2VldCIsICdhcmNfdHdpdHRlcicsICJhcnRpY2xl
X2lkPXskaWR9IikKICAgICAgICA6IHNhZmVfcm93KCJSRVBMQUNFKHR3ZWV0LENPTkNBVCgn
ICcsdGlueXVybCksJycpIEFTIHR3ZWV0IgogICAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAi
YXJ0aWNsZV9pZD17JGlkfSIpOwogICAgfQoKICAgIGlmICgkdHdlZXRbJ3R3ZWV0J10pIHsK
ICAgICAgcmV0dXJuIGFyY19Ud2l0dGVyOjptYWtlTGlua3MoCiAgICAgICAgaHRtbGVudGl0
aWVzKCR0d2VldFsndHdlZXQnXSwgRU5UX1FVT1RFUywnVVRGLTgnKSk7CiAgICB9Cn0KCmZ1
bmN0aW9uIGFyY190d2l0dGVyX3R3ZWV0X3VybCgkYXR0cywgJHRoaW5nPW51bGwpIHsKICAg
IGdsb2JhbCAkdGhpc2FydGljbGUsJHByZWZzOwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXko
CiAgICAgICdpZCcgICAgICA9PiAkdGhpc2FydGljbGVbJ3RoaXNpZCddLAogICAgICAndGl0
bGUnICAgPT4gJycsCiAgICAgICdjbGFzcycgICA9PiAnJwogICAgKSwkYXR0cykpOwoKICAg
IGlmICgkaWQpIHsKICAgICAgLy8gRmV0Y2ggYXJjX3R3aXR0ZXIgc3R1ZmYgdG8gYnVpbGQg
dHdlZXQgZnJvbQogICAgICAkdHdlZXQgPSBzYWZlX3JvdygidHdlZXRfaWQiCiAgICAgICAg
LCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlkfSIpOwogICAgfQoKICAgIGlmICgk
dHdlZXRbJ3R3ZWV0X2lkJ10pIHsKICAgICAgJHVybCA9ICJodHRwOi8vdHdpdHRlci5jb20v
Ii4kcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXS4iL3N0YXR1cy8iLiR0d2VldFsndHdlZXRf
aWQnXTsKICAgICAgaWYgKCR0aGluZz09PW51bGwpIHsKICAgICAgICByZXR1cm4gJHVybDsK
ICAgICAgfQogICAgICByZXR1cm4gaHJlZihwYXJzZSgkdGhpbmcpLCAkdXJsLAogICAgICAg
ICgkdGl0bGUgPyAnIHRpdGxlPSInLiR0aXRsZS4nIicgOiAnJykKICAgICAgICAuKCRjbGFz
cyA/ICcgY2xhc3M9IicuJGNsYXNzLiciJyA6ICcnKSk7CiAgICB9Cn0KCmZ1bmN0aW9uIGFy
Y190d2l0dGVyX3Rpbnl1cmwoJGF0dHMsICR0aGluZz1udWxsKSB7CiAgICBnbG9iYWwgJHRo
aXNhcnRpY2xlOwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICdpZCcgICAgICA9
PiAkdGhpc2FydGljbGVbJ3RoaXNpZCddLAogICAgICAndGl0bGUnICAgPT4gJycsCiAgICAg
ICdjbGFzcycgICA9PiAnJwogICAgKSwkYXR0cykpOwoKICAgIGlmICgkaWQpIHsKICAgICAg
Ly8gRmV0Y2ggYXJjX3R3aXR0ZXIgc3R1ZmYgdG8gYnVpbGQgdHdlZXQgZnJvbQogICAgICAk
dHdlZXQgPSBzYWZlX3JvdygidGlueXVybCIKICAgICAgICAsICdhcmNfdHdpdHRlcicsICJh
cnRpY2xlX2lkPXskaWR9Iik7CiAgICB9CgogICAgaWYgKCR0d2VldFsndGlueXVybCddKSB7
CiAgICAgIGlmICgkdGhpbmc9PT1udWxsKSB7CiAgICAgICAgcmV0dXJuICR0d2VldFsndGlu
eXVybCddOwogICAgICB9CgogICAgICByZXR1cm4gaHJlZihwYXJzZSgkdGhpbmcpLCAkdHdl
ZXRbJ3Rpbnl1cmwnXSwKICAgICAgICAoJHRpdGxlID8gJyB0aXRsZT0iJy4kdGl0bGUuJyIn
IDogJycpCiAgICAgICAgLigkY2xhc3MgPyAnIGNsYXNzPSInLiRjbGFzcy4nIicgOiAnJykp
OwogICAgfQp9CgpmdW5jdGlvbiBfYXJjX3R3aXR0ZXJfd2lkZ2V0X2pzKCkgewogICRqcyA9
IDw8PEpTCjxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KKGZ1bmN0aW9uKCkgewog
IGlmICh3aW5kb3cuX190d2l0dGVySW50ZW50SGFuZGxlcikgcmV0dXJuOwogIHZhciBpbnRl
bnRSZWdleCA9IC90d2l0dGVyXC5jb20oXDpcZHsyLDR9KT9cL2ludGVudFwvKFx3KykvLAog
ICAgICB3aW5kb3dPcHRpb25zID0gJ3Njcm9sbGJhcnM9eWVzLHJlc2l6YWJsZT15ZXMsdG9v
bGJhcj1ubyxsb2NhdGlvbj15ZXMnLAogICAgICB3aWR0aCA9IDU1MCwKICAgICAgaGVpZ2h0
ID0gNDIwLAogICAgICB3aW5IZWlnaHQgPSBzY3JlZW4uaGVpZ2h0LAogICAgICB3aW5XaWR0
aCA9IHNjcmVlbi53aWR0aDsKCiAgZnVuY3Rpb24gaGFuZGxlSW50ZW50KGUpIHsKICAgIGUg
PSBlIHx8IHdpbmRvdy5ldmVudDsKICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldCB8fCBlLnNy
Y0VsZW1lbnQsCiAgICAgICAgbSwgbGVmdCwgdG9wOwoKICAgIHdoaWxlICh0YXJnZXQgJiYg
dGFyZ2V0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgIT09ICdhJykgewogICAgICB0YXJnZXQg
PSB0YXJnZXQucGFyZW50Tm9kZTsKICAgIH0KCiAgICBpZiAodGFyZ2V0ICYmIHRhcmdldC5u
b2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnYScgJiYgdGFyZ2V0LmhyZWYpIHsKICAgICAg
bSA9IHRhcmdldC5ocmVmLm1hdGNoKGludGVudFJlZ2V4KTsKICAgICAgaWYgKG0pIHsKICAg
ICAgICBsZWZ0ID0gTWF0aC5yb3VuZCgod2luV2lkdGggLyAyKSAtICh3aWR0aCAvIDIpKTsK
ICAgICAgICB0b3AgPSAwOwoKICAgICAgICBpZiAod2luSGVpZ2h0ID4gaGVpZ2h0KSB7CiAg
ICAgICAgICB0b3AgPSBNYXRoLnJvdW5kKCh3aW5IZWlnaHQgLyAyKSAtIChoZWlnaHQgLyAy
KSk7CiAgICAgICAgfQoKICAgICAgICB3aW5kb3cub3Blbih0YXJnZXQuaHJlZiwgJ2ludGVu
dCcsIHdpbmRvd09wdGlvbnMgKyAnLHdpZHRoPScgKyB3aWR0aCArCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLGhlaWdodD0nICsgaGVpZ2h0ICsgJyxs
ZWZ0PScgKyBsZWZ0ICsgJyx0b3A9JyArIHRvcCk7CiAgICAgICAgZS5yZXR1cm5WYWx1ZSA9
IGZhbHNlOwogICAgICAgIGUucHJldmVudERlZmF1bHQgJiYgZS5wcmV2ZW50RGVmYXVsdCgp
OwogICAgICB9CiAgICB9CiAgfQoKICBpZiAoZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcikg
ewogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVJbnRlbnQs
IGZhbHNlKTsKICB9IGVsc2UgaWYgKGRvY3VtZW50LmF0dGFjaEV2ZW50KSB7CiAgICBkb2N1
bWVudC5hdHRhY2hFdmVudCgnb25jbGljaycsIGhhbmRsZUludGVudCk7CiAgfQogIHdpbmRv
dy5fX3R3aXR0ZXJJbnRlbnRIYW5kbGVyID0gdHJ1ZTsKfSgpKTsKPC9zY3JpcHQ+CkpTOwog
IHJldHVybiAkanM7Cn0KCmZ1bmN0aW9uIGFyY190d2l0dGVyX2ZvbGxvdygkYXR0cywgJHRo
aW5nPW51bGwpCnsKICAgIGdsb2JhbCAkcHJlZnM7CgogICAgZXh0cmFjdChsQXR0cyhhcnJh
eSgKICAgICAgICAndXNlcicgICAgICA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSwK
ICAgICAgICAndXNlcl9pZCcgICA9PiAnJywKICAgICAgICAnbGFuZycgICAgICA9PiAnJywK
ICAgICAgICAnaW5jbHVkZV9qcyc9PiB0cnVlLAogICAgICAgICdjbGFzcycgICAgID0+ICcn
CiAgICApLCRhdHRzKSk7CgogICAgJHEgPSAoJHVzZXJfaWQpID8gJ3VzZXJfaWQ9Jy4kdXNl
cl9pZCA6ICdzY3JlZW5fbmFtZT0nLiR1c2VyOwoKICAgIHN3aXRjaCAoJGxhbmcpIHsKICAg
ICAgY2FzZSAnZnInOiBicmVhazsgY2FzZSAnaXQnOiBicmVhazsgY2FzZSAnZXMnOiBicmVh
azsKICAgICAgY2FzZSAna28nOiBicmVhazsgY2FzZSAnanAnOiBicmVhazsKICAgICAgZGVm
YXVsdDoKICAgICAgICAkbGFuZyA9ICdlbic7CiAgICB9CiAgICAkcSAuPSAnJmFtcDtsYW5n
PScudXJsZW5jb2RlKCRsYW5nKTsKCiAgICAkaHRtbCA9IGhyZWYoJHRoaW5nLCdodHRwOi8v
dHdpdHRlci5jb20vaW50ZW50L3VzZXI/Jy4kcQogICAgICAsICcgY2xhc3M9IicuJGNsYXNz
LiciJyk7CgogICAgJGpzID0gKCRpbmNsdWRlX2pzKSA/IF9hcmNfdHdpdHRlcl93aWRnZXRf
anMoKSA6ICcnOwoKICAgIHJldHVybiAkanMuJGh0bWw7Cn0KCmZ1bmN0aW9uIGFyY190d2l0
dGVyX2Zhdm9yaXRlKCRhdHRzLCAkdGhpbmc9bnVsbCkKewogICAgZ2xvYmFsICRwcmVmcywg
JHRoaXNhcnRpY2xlOwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICAgJ3VzZXIn
ICAgICAgPT4gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sCiAgICAgICAgJ3JlbGF0ZWQn
ICAgPT4gJycsCiAgICAgICAgJ2luY2x1ZGVfanMnPT4gdHJ1ZSwKICAgICAgICAnaWQnICAg
ICAgICA9PiAnJywKICAgICAgICAnY2xhc3MnICAgICA9PiAnJwogICAgKSwkYXR0cykpOwoK
ICAgIGlmICgkaWQgfHwgJHRoaXNhcnRpY2xlWyd0aGlzaWQnXSkgewoKICAgICAgJHEgPSAn
cmVsYXRlZD0nLiR1c2VyOwogICAgICBpZiAoJHJlbGF0ZWQpICRxIC49IHVybGVuY29kZSgo
JHE/JywnOidyZWxhdGVkPScpLiRyZWxhdGVkKTsKCiAgICAgIGlmICghJGlkKSB7CiAgICAg
ICAgJHJvdyA9IHNhZmVfcm93KCJ0d2VldF9pZCIKICAgICAgICAsICdhcmNfdHdpdHRlcics
ICJhcnRpY2xlX2lkPXskdGhpc2FydGljbGVbJ3RoaXNpZCddfSIpOwogICAgICAgIGlmICgh
JGlkID0gJHJvd1sndHdlZXRfaWQnXSkgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICAk
cSAuPSAnJmFtcDt0d2VldF9pZD0nLiRpZDsKCiAgICAgICRodG1sID0gaHJlZigkdGhpbmcs
J2h0dHA6Ly90d2l0dGVyLmNvbS9pbnRlbnQvZmF2b3JpdGU/Jy4kcQogICAgICAgICwgJyBj
bGFzcz0iJy4kY2xhc3MuJyInKTsKCiAgICAgICRqcyA9ICgkaW5jbHVkZV9qcykgPyBfYXJj
X3R3aXR0ZXJfd2lkZ2V0X2pzKCkgOiAnJzsKCiAgICAgIHJldHVybiAkanMuJGh0bWw7Cgog
ICAgfQoKICAgIHJldHVybiBmYWxzZTsKfQoKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfcmVwbHko
JGF0dHMsICR0aGluZz1udWxsKQp7CiAgICBnbG9iYWwgJHByZWZzLCAkdGhpc2FydGljbGU7
CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgICAndXNlcicgICAgICA9PiAkcHJl
ZnNbJ2FyY190d2l0dGVyX3VzZXInXSwKICAgICAgICAncmVsYXRlZCcgICA9PiAnJywKICAg
ICAgICAndGV4dCcgICAgICA9PiAnJywKICAgICAgICAnaW5jbHVkZV9qcyc9PiB0cnVlLAog
ICAgICAgICdpZCcgICAgICAgID0+ICcnLAogICAgICAgICdjbGFzcycgICAgID0+ICcnCiAg
ICApLCRhdHRzKSk7CgogICAgaWYgKCRpZCB8fCAkdGhpc2FydGljbGVbJ3RoaXNpZCddKSB7
CgogICAgICBpZiAoISRpZCkgewogICAgICAgICRyb3cgPSBzYWZlX3JvdygidHdlZXRfaWQi
CiAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JHRoaXNhcnRpY2xlWyd0
aGlzaWQnXX0iKTsKICAgICAgICBpZiAoISRpZCA9ICRyb3dbJ3R3ZWV0X2lkJ10pIHJldHVy
biBmYWxzZTsKICAgICAgfQoKICAgICAgJHEgPSAnaW5fcmVwbHlfdG89Jy4kaWQ7CgogICAg
ICBpZiAoJHVzZXIpIHsKICAgICAgICAkcSAuPSAnJmFtcDtyZWxhdGVkPScudXJsZW5jb2Rl
KCR1c2VyKTsKICAgICAgfQogICAgICBpZiAoJHJlbGF0ZWQpIHsKICAgICAgICAkcSAuPSB1
cmxlbmNvZGUoKCR1c2VyPycsJzonJnJlbGF0ZWQ9JykuJHJlbGF0ZWQpOwogICAgICB9CiAg
ICAgIGlmICgkdGV4dCkgewogICAgICAgICRxIC49ICcmYW1wO3RleHQ9Jy51cmxlbmNvZGUo
JHRleHQpOwogICAgICB9CgogICAgICAkaHRtbCA9IGhyZWYoJHRoaW5nLCdodHRwOi8vdHdp
dHRlci5jb20vaW50ZW50L3R3ZWV0PycuJHEKICAgICAgICAsICcgY2xhc3M9IicuJGNsYXNz
LiciJyk7CgogICAgICAkanMgPSAoJGluY2x1ZGVfanMpID8gX2FyY190d2l0dGVyX3dpZGdl
dF9qcygpIDogJyc7CgogICAgICByZXR1cm4gJGpzLiRodG1sOwoKICAgIH0KCiAgICByZXR1
cm4gZmFsc2U7Cn0KCmZ1bmN0aW9uIGFyY190d2l0dGVyX3JldHdlZXQoJGF0dHMsICR0aGlu
Zz1udWxsKQp7CiAgICBnbG9iYWwgJHByZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwg
JGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwogICAgZ2xvYmFsICR0aGlzYXJ0aWNsZTsK
CiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAgICd1c2VyJyAgICAgID0+ICRwcmVm
c1snYXJjX3R3aXR0ZXJfdXNlciddLCAvLyB2aWEgdXNlciBhY2NvdW50CiAgICAgICAgJ3Vy
bCcgICAgICAgPT4gJycsCiAgICAgICAgJ3RleHQnICAgICAgPT4gJycsCiAgICAgICAgJ2Zv
bGxvdzEnICAgPT4gJycsCiAgICAgICAgJ2ZvbGxvdzInICAgPT4gJycsCiAgICAgICAgJ2xh
bmcnICAgICAgPT4gJycsCiAgICAgICAgJ2NvdW50JyAgICAgPT4gJ2hvcml6b250YWwnLAog
ICAgICAgICdpbmNsdWRlX2pzJz0+IHRydWUsCiAgICAgICAgJ3dyYXB0YWcnICAgPT4gJycs
CiAgICAgICAgJ2NsYXNzJyAgICAgPT4gJ3R3aXR0ZXItc2hhcmUtYnV0dG9uJwogICAgKSwk
YXR0cykpOwoKICAgICRxID0gJyc7IC8vIHF1ZXJ5IHN0cmluZwoKICAgIGlmICgkaWQ9JHRo
aXNhcnRpY2xlWyd0aGlzaWQnXSkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVm
ZiB0byBidWlsZCB0d2VldCBmcm9tCiAgICAgICRyb3cgPSBzYWZlX3JvdygiUkVQTEFDRSh0
d2VldCxDT05DQVQoJyAnLHRpbnl1cmwpLCcnKSBBUyB0d2VldCx0aW55dXJsIgogICAgICAg
ICwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKTsKCiAgICAgIGlmICgkdXJs
PT0nJykgewogICAgICAgICR1cmwgPSAoJHVybCkgPyAkdXJsIDogcGVybWxpbmt1cmwoJHRo
aXNhcnRpY2xlKTsKICAgICAgICAkcSA9ICd1cmw9Jy51cmxlbmNvZGUoJHVybCk7CiAgICAg
IH0KICAgICAgaWYgKCR0ZXh0PT0nJykgewogICAgICAgICR0ZXh0ID0gKCRyb3dbJ3R3ZWV0
J10pID8gJHJvd1sndHdlZXQnXSA6ICR0aGlzYXJ0aWNsZVsndGl0bGUnXTsKICAgICAgfQog
ICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLid0ZXh0PScudXJsZW5jb2RlKCR0ZXh0
KTsKICAgIH0KICAgIGlmICgkdXNlcikgewogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDog
JycpLid2aWE9Jy51cmxlbmNvZGUoJHVzZXIpOwogICAgfQogICAgaWYgKCRmb2xsb3cxJiYk
Zm9sbG93MikgewogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidyZWxhdGVkPScu
dXJsZW5jb2RlKCRmb2xsb3cxLic6Jy4kZm9sbG93Mik7CiAgICB9IGVsc2VpZiAoJGZvbGxv
dzF8fCRmb2xsb3cyKSB7CiAgICAgICRxIC49ICgkcSA/ICcmYW1wOycgOiAnJykuJ3JlbGF0
ZWQ9Jy51cmxlbmNvZGUoJGZvbGxvdzEuJGZvbGxvdzIpOwogICAgfQoKICAgIHN3aXRjaCAo
JGxhbmcpIHsKICAgICAgY2FzZSAnZnInOiBicmVhazsgY2FzZSAnZGUnOiBicmVhazsgY2Fz
ZSAnZXMnOiBicmVhazsgY2FzZSAnanAnOiBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAg
ICAkbGFuZyA9ICdlbic7CiAgICB9CiAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLids
YW5nPScudXJsZW5jb2RlKCRsYW5nKTsKCiAgICBzd2l0Y2ggKCRjb3VudCkgewogICAgICBj
YXNlICdub25lJzogYnJlYWs7IGNhc2UgJ3ZlcnRpY2FsJzogYnJlYWs7CiAgICAgIGRlZmF1
bHQ6CiAgICAgICAgJGNvdW50ID0gJ2hvcml6b250YWwnOwogICAgfQogICAgJHEgLj0gKCRx
ID8gJyZhbXA7JyA6ICcnKS4nY291bnQ9Jy51cmxlbmNvZGUoJGNvdW50KTsKCiAgICAkdGhp
bmcgPSAoJHRoaW5nPT09bnVsbCkgPyAnVHdlZXQnIDogcGFyc2UoJHRoaW5nKTsKCiAgICAk
aHRtbCA9IGhyZWYoJHRoaW5nLCdodHRwOi8vdHdpdHRlci5jb20vc2hhcmU/Jy4kcQogICAg
ICAsICcgY2xhc3M9IicuJGNsYXNzLiciJyk7CgogICAgJGpzID0gKCRpbmNsdWRlX2pzKSA/
CiAgICAgICc8c2NyaXB0IHNyYz0iaHR0cDovL3BsYXRmb3JtLnR3aXR0ZXIuY29tL3dpZGdl
dHMuanMiIHR5cGU9InRleHQvamF2YXNjcmlwdCI+PC9zY3JpcHQ+JwogICAgICA6ICcnOwoK
ICAgIHJldHVybiAkanMuJGh0bWw7Cn0KCi8qCiAgICBBZG1pbi1zaWRlIGZ1bmN0aW9ucwog
ICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PQoqLwoKLy8gSW5zdGFsbGF0aW9uIGZ1bmN0aW9uIC0gYnVpbGRzIE15
U1FMIHRhYmxlCmZ1bmN0aW9uIGFyY190d2l0dGVyX2luc3RhbGwoKQp7CgogICAgLy8gRm9y
IGZpcnN0IGluc3RhbGwsIGNyZWF0ZSB0YWJsZSBmb3IgdHdlZXRzCiAgICAkc3FsID0gIkNS
RUFURSBUQUJMRSBJRiBOT1QgRVhJU1RTICIuUEZYLiJhcmNfdHdpdHRlciAiOwogICAgJHNx
bC49ICIoYXJjX3R3aXR0ZXJpZCBJTlRFR0VSIEFVVE9fSU5DUkVNRU5UIFBSSU1BUlkgS0VZ
LAogICAgICAgIGFydGljbGVfaWQgSU5URUdFUigxMSksCiAgICAgICAgdHdlZXRfaWQgQklH
SU5UKDIwKSwKICAgICAgICB0d2VldCBWQVJDSEFSKDE0MCksCiAgICAgICAgdGlueXVybCBW
QVJDSEFSKDMwKSk7IjsKCiAgICBpZiAoIXNhZmVfcXVlcnkoJHNxbCkpIHsKICAgICAgICBy
ZXR1cm4gJ0Vycm9yIC0gdW5hYmxlIHRvIGNyZWF0ZSBhcmNfdHdpdHRlciB0YWJsZSc7CiAg
ICB9Cgp9CgovLyBVbmluc3RhbGwgZnVuY3Rpb24gLSBkZWxldGVzIE15U1FMIHRhYmxlIGFu
ZCByZWxhdGVkIHByZWZlcmVuY2VzCmZ1bmN0aW9uIGFyY190d2l0dGVyX3VuaW5zdGFsbCgp
CnsKCiAgICAkc3FsID0gIkRST1AgVEFCTEUgSUYgRVhJU1RTICIuUEZYLiJhcmNfdHdpdHRl
cjsiOwogICAgaWYgKCFzYWZlX3F1ZXJ5KCRzcWwpKSB7CiAgICAgICAgcmV0dXJuICdFcnJv
ciAtIHVuYWJsZSB0byBkZWxldGUgYXJjX3R3aXR0ZXIgdGFibGUnOwogICAgfQoKICAgICRz
cWwgPSAiREVMRVRFIEZST00gICIuUEZYLiJ0eHBfcHJlZnMgV0hFUkUgZXZlbnQ9J2FyY190
d2l0dGVyJzsiOwogICAgaWYgKCFzYWZlX3F1ZXJ5KCRzcWwpKSB7CiAgICAgICAgcmV0dXJu
ICdFcnJvciAtIHVuYWJsZSB0byBkZWxldGUgYXJjX3R3aXR0ZXIgcHJlZmVyZW5jZXMnOwog
ICAgfQoKfQpmdW5jdGlvbiBhcmNfdHdpdHRlcl91cmxfbWV0aG9kX3NlbGVjdCgkbmFtZSwg
JHZhbCkKewogICAgJG1ldGhvZHMgPSBhcnJheSgndGlueXVybCcgPT4gJ1Rpbnl1cmwnLAog
ICAgICAnaXNnZCcgPT4gJ0lzLmdkJywKICAgICAgJ2FyY190d2l0dGVyJyA9PiAnVFhQIFR3
ZWV0JywKICAgICAgJ3NtZCcgPT4gJ3NtZF9zaG9ydF91cmwnKTsKICAgIHJldHVybiBzZWxl
Y3RJbnB1dCgkbmFtZSwgJG1ldGhvZHMsICR2YWwpOwp9CmZ1bmN0aW9uIGFyY190d2l0dGVy
X3RhYl9zZWxlY3QoJG5hbWUsICR2YWwpCnsKICAgICR0YWJzID0gYXJyYXkoJ2NvbnRlbnQn
ID0+ICdDb250ZW50JywKICAgICAgICAnZXh0ZW5zaW9ucycgPT4gJ0V4dGVuc2lvbnMnLAog
ICAgICAgICcnID0+ICdIaWRkZW4nKTsKICAgIHJldHVybiBzZWxlY3RJbnB1dCgkbmFtZSwg
JHRhYnMsICR2YWwpOwp9Ci8vIFByb3ZpZGUgaW50ZXJmYWNlIGZvciBzZXR0aW5nIHByZWZl
cmVuY2VzCmZ1bmN0aW9uIGFyY190d2l0dGVyX3ByZWZzKCRldmVudCwkc3RlcCkKewoKICAg
IGdsb2JhbCAkcHJlZnMsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCRhcmNfdHdpdHRlcl9j
b25zdW1lclNlY3JldDsKCiAgICAkdXNlciAgICAgICAgICA9ICRwcmVmc1snYXJjX3R3aXR0
ZXJfdXNlciddOwogICAgJHByZWZpeCAgICAgICAgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3By
ZWZpeCddOwogICAgJHR3ZWV0X2RlZmF1bHQgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3R3ZWV0
X2RlZmF1bHQnXTsKICAgICR1cmxfbWV0aG9kICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl91
cmxfbWV0aG9kJ107CiAgICAkc2hvcnRfdXJsICAgICA9ICRwcmVmc1snYXJjX3Nob3J0X3Vy
bCddOwogICAgJHNob3J0X3NpdGVfdXJsPSAkcHJlZnNbJ2FyY19zaG9ydF9zaXRlX3VybCdd
OwogICAgJGNhY2hlX2RpciAgICAgPSAkcHJlZnNbJ2FyY190d2l0dGVyX2NhY2hlX2Rpcidd
OwogICAgJHRhYiAgICAgICAgICAgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddOwoKICAg
IHN3aXRjaCAoJHN0ZXApIHsKICAgICAgICBjYXNlICdwcmVmc19zYXZlJzogcGFnZXRvcCgn
VFhQIFR3ZWV0JywgJ1ByZWZlcmVuY2VzIHNhdmVkJyk7IGJyZWFrOwogICAgICAgIGNhc2Ug
J3JlZ2lzdGVyJzogcGFnZXRvcCgnVFhQIFR3ZWV0JywnQ29ubmVjdCB0byBUd2l0dGVyJyk7
IGJyZWFrOwogICAgICAgIGNhc2UgJ3ZhbGlkYXRlJzoKICAgICAgICBkZWZhdWx0OiBwYWdl
dG9wKCdUWFAgVHdlZXQnKTsKICAgIH0KCiAgICAkaHRtbCA9ICcnOwoKICAgIGlmICgkc3Rl
cD09J3JlZ2lzdGVyJykgeyAvLyBPQXV0aCByZWdpc3RyYXRpb24gcHJvY2VzcwogICAgICAg
ICR0d2l0ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAg
ICAgICAgICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCk7CgogICAgICAgIC8vIEJ1
aWxkIGEgY2FsbGJhY2sgVVJMIGZvciBUd2l0dGVyIHRvIHJldHVybiB0byB0aGUgbmV4dCBz
dGFnZQogICAgICAgICRjYWxsYmFja1VSTCA9ICR0d2l0LT5jYWxsYmFja1VSTCgkZXZlbnQs
J3ZhbGlkYXRlJyk7CgogICAgICAgICRyZXF1ZXN0ID0gJHR3aXQtPmdldFJlcXVlc3RUb2tl
bigkY2FsbGJhY2tVUkwpOwogICAgICAgICRyZXF1ZXN0X3Rva2VuID0gJHJlcXVlc3RbIm9h
dXRoX3Rva2VuIl07CiAgICAgICAgJHJlcXVlc3RfdG9rZW5fc2VjcmV0ID0gJHJlcXVlc3Rb
Im9hdXRoX3Rva2VuX3NlY3JldCJdOwoKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJf
cmVxdWVzdFRva2VuJywkcmVxdWVzdF90b2tlbgogICAgICAgICAgICAsICdhcmNfdHdpdHRl
cicsMik7CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3JlcXVlc3RUb2tlblNlY3Jl
dCcsJHJlcXVlc3RfdG9rZW5fc2VjcmV0CiAgICAgICAgICAgICwgJ2FyY190d2l0dGVyJywy
KTsKCiAgICAgICAgJGh0bWwuPSBzdGFydFRhYmxlKCdlZGl0JykuCiAgICAgICAgICAgICAg
ICB0cih0ZCgKICAgICAgICAgICAgICAgICAgICAoJzxwPicuaHJlZignU2lnbi1pbiB0byBU
d2l0dGVyJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLCR0d2l0LT5nZXRBdXRob3Jp
emVVUkwoJHJlcXVlc3QpKQogICAgICAgICAgICAgICAgICAgICAgICAuJyBhbmQgZm9sbG93
IHRoZSBpbnN0cnVjdGlvbnMgdG8gYWxsb3cgVFhQIFR3ZWV0IHRvIHVzZSB5b3VyIGFjY291
bnQuIElmIHlvdSBhcmUgYWxyZWFkeSBzaWduZWQgaW4gdG8gVHdpdHRlciB0aGVuIHRoYXQg
YWNjb3VudCB3aWxsIGJlIGFzc29jaWF0ZWQgd2l0aCBUWFAgVHdlZXQgc28geW91IG1heSBu
ZWVkIHRvIHNpZ24gb3V0IGZpcnN0IGlmIHlvdSB3YW50IHRvIHVzZSBhIGRpZmZlcmVudCBh
Y2NvdW50LjwvcD4nKQogICAgICAgICAgICAgICAgKSkuZW5kVGFibGUoKTsKICAgIH0gZWxz
ZWlmICgkc3RlcD09J3ZhbGlkYXRlJykgewogICAgICAgICR0d2l0ID0gbmV3IGFyY190d2l0
dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAsICRhcmNfdHdpdHRl
cl9jb25zdW1lclNlY3JldCwgJHByZWZzWydhcmNfdHdpdHRlcl9yZXF1ZXN0VG9rZW4nXQog
ICAgICAgICAgICAsICRwcmVmc1snYXJjX3R3aXR0ZXJfcmVxdWVzdFRva2VuU2VjcmV0J10p
OwogICAgICAgIC8vIEFzayBUd2l0dGVyIGZvciBhbiBhY2Nlc3MgdG9rZW4gKGFuZCBhbiBh
Y2Nlc3MgdG9rZW4gc2VjcmV0KQogICAgICAgICRyZXF1ZXN0ID0gJHR3aXQtPmdldEFjY2Vz
c1Rva2VuKCBncHMoJ29hdXRoX3ZlcmlmaWVyJykgKTsKICAgICAgICAkYWNjZXNzX3Rva2Vu
ID0gJHJlcXVlc3RbJ29hdXRoX3Rva2VuJ107CiAgICAgICAgJGFjY2Vzc190b2tlbl9zZWNy
ZXQgPSAkcmVxdWVzdFsnb2F1dGhfdG9rZW5fc2VjcmV0J107CiAgICAgICAgJHVzZXIgPSAk
cmVxdWVzdFsnc2NyZWVuX25hbWUnXTsKICAgICAgICAvLyBTdG9yZSB0aGUgYWNjZXNzIHRv
a2VuIGFuZCBzZWNyZXQKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfYWNjZXNzVG9r
ZW4nLCRhY2Nlc3NfdG9rZW4sICdhcmNfdHdpdHRlcicsMik7CiAgICAgICAgc2V0X3ByZWYo
J2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0JywkYWNjZXNzX3Rva2VuX3NlY3JldAog
ICAgICAgICAgICAsICdhcmNfdHdpdHRlcicsMik7CiAgICAgICAgc2V0X3ByZWYoJ2FyY190
d2l0dGVyX3VzZXInLCR1c2VyKTsKICAgICAgICAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vz
c1Rva2VuJ10gPSAkYWNjZXNzX3Rva2VuOwogICAgICAgICRwcmVmc1snYXJjX3R3aXR0ZXJf
YWNjZXNzVG9rZW5TZWNyZXQnXSA9ICRhY2Nlc3NfdG9rZW5fc2VjcmV0OwogICAgICAgIHVu
c2V0KCR0d2l0KTsKICAgIH0KCiAgICBpZiAoJHN0ZXA9PSJwcmVmc19zYXZlIikgewogICAg
ICAgICRwcmVmaXggPSB0cmltKGdwcygnYXJjX3R3aXR0ZXJfcHJlZml4JykpOwogICAgICAg
ICR0d2VldF9kZWZhdWx0ID0gZ3BzKCdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0Jyk7CiAg
ICAgICAgJHVybF9tZXRob2QgPSBncHMoJ2FyY190d2l0dGVyX3VybF9tZXRob2QnKTsKICAg
ICAgICAkc2hvcnRfdXJsID0gZ3BzKCdhcmNfc2hvcnRfdXJsJyk7CiAgICAgICAgJHNob3J0
X3NpdGVfdXJsID0gZ3BzKCdhcmNfc2hvcnRfc2l0ZV91cmwnKTsKICAgICAgICAkY2FjaGVf
ZGlyID0gZ3BzKCdhcmNfdHdpdHRlcl9jYWNoZV9kaXInKTsKICAgICAgICAkdGFiID0gZ3Bz
KCdhcmNfdHdpdHRlcl90YWInKTsKICAgICAgICBpZiAoc3RybGVuKCRwcmVmaXgpPD0yMCkg
ewogICAgICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfcHJlZml4JywkcHJlZml4KTsK
ICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkcHJlZml4ID0gJHByZWZzWydhcmNfdHdp
dHRlcl9wcmVmaXgnXTsKICAgICAgICB9CiAgICAgICAgJHR3ZWV0X2RlZmF1bHQgPSAoJHR3
ZWV0X2RlZmF1bHQpID8gMSA6IDA7CiAgICAgICAgJHNob3J0X3VybCA9ICgkc2hvcnRfdXJs
KSA/IDEgOiAwOwogICAgICAgIGlmICghJHNob3J0X3NpdGVfdXJsKSAkc2hvcnRfc2l0ZV91
cmwgPSAkcHJlZnNbJ3NpdGV1cmwnXTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJf
dHdlZXRfZGVmYXVsdCcsJHR3ZWV0X2RlZmF1bHQpOwogICAgICAgIHNldF9wcmVmKCdhcmNf
c2hvcnRfdXJsJywkc2hvcnRfdXJsKTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJf
dXJsX21ldGhvZCcsJHVybF9tZXRob2QpOwogICAgICAgIHNldF9wcmVmKCdhcmNfc2hvcnRf
c2l0ZV91cmwnLCRzaG9ydF9zaXRlX3VybCk7CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0
dGVyX2NhY2hlX2RpcicsJGNhY2hlX2Rpcik7CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0
dGVyX3RhYicsJHRhYik7CiAgICB9CgogICAgaWYgKCAkc3RlcCE9J3JlZ2lzdGVyJyApIHsK
ICAgICAgICBpZiAoIGlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXSkK
ICAgICAgICAmJiBpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0
J10pICkgewogICAgICAgICAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJjX3R3aXR0
ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVy
U2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10KICAgICAgICAgICAg
ICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKTsKICAgICAg
ICAgICAgJHJlZ2lzdGVyVVJMID0gJHR3aXQtPmNhbGxiYWNrVVJMKCRldmVudCwncmVnaXN0
ZXInKTsKICAgICAgICAgICAgJGh0bWwuPSBzdGFydFRhYmxlKCdsaXN0JykuZm9ybSgKICAg
ICAgICAgICAgICAgIHRyKAogICAgICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdUd2l0dGVy
IGFjY291bnQgZGV0YWlscycsIDIpLDIpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAg
ICAgICAudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdp
dHRlcl91c2VyIj5Ud2l0dGVyIHVzZXJuYW1lPC9sYWJlbD4nLAogICAgICAgICAgICAgICAg
ICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1p
ZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoCiAgICAgICAgICAgICAgICAgICAg
ICAgICgkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSkgPwogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgJHVzZXIuJyAoJy5ocmVmKCdSZS1jb25uZWN0JywkcmVnaXN0ZXJVUkwpLicp
JwogICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnPGVtPnVua25vd248L2VtPicKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIC5ocmVmKCdDb25uZWN0IHRvIFR3aXR0ZXInLCRy
ZWdpc3RlclVSTCkpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAg
ICAgICAgICAgICAgICAgICAgdGRjcyhoZWQoJ1R3ZWV0IHNldHRpbmdzJywgMiksMikKICAg
ICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAg
ICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX2NhY2hlX2RpciI+VHdlZXQgcHJlZml4
PC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWdu
OiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAg
ICAudGQoZklucHV0KCd0ZXh0JywnYXJjX3R3aXR0ZXJfcHJlZml4JywkcHJlZml4LCcnLCcn
LCcnLCcnLCcnLCdhcmNfdHdpdHRlcl9wcmVmaXgnKSkKICAgICAgICAgICAgICAgICkudHIo
CiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl90d2Vl
dF9kZWZhdWx0Ij5Ud2VldCBhcnRpY2xlcyBieSBkZWZhdWx0PC9sYWJlbD4nLAogICAgICAg
ICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwt
YWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoeWVzbm9SYWRpbygn
YXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcsICR0d2VldF9kZWZhdWx0LCAnJywgJ2FyY190
d2l0dGVyX3R3ZWV0X2RlZmF1bHQnKSkKICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAg
ICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl91cmxfbWV0aG9kIj5V
Ukwgc2hvcnRuZXI8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9
InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAg
ICAgICAgICAgICAgIC50ZChhcmNfdHdpdHRlcl91cmxfbWV0aG9kX3NlbGVjdCgnYXJjX3R3
aXR0ZXJfdXJsX21ldGhvZCcsJHVybF9tZXRob2QpKQogICAgICAgICAgICAgICAgKS50cigK
ICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVFhQIFR3ZWV0IHNob3J0IFVSTCcsIDIp
LDIpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAg
ICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfc2hvcnRfdXJsIj5FbmFibGUgVFhQIFR3
ZWV0IHNob3J0IFVSTCByZWRpcmVjdDwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAg
ICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7
IicpCiAgICAgICAgICAgICAgICAgICAgLnRkKHllc25vUmFkaW8oJ2FyY19zaG9ydF91cmwn
LCAkc2hvcnRfdXJsLCAnJywgJ2FyY19zaG9ydF91cmwnKSksCiAgICAgICAgICAgICAgICAg
ICAgJyBpZD0iYXJjX3Nob3J0X3VybC1vbl9vZmYiJwogICAgICAgICAgICAgICAgKS50cigK
ICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY19zaG9ydF9zaXRlX3Vy
bCI+VFhQIFR3ZWV0IHNob3J0IHNpdGUgVVJMPC9sYWJlbD4nLAogICAgICAgICAgICAgICAg
ICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1p
ZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoZklucHV0KCd0ZXh0JywnYXJjX3No
b3J0X3NpdGVfdXJsJywkc2hvcnRfc2l0ZV91cmwsJycsJycsJycsJycsJycsJ2FyY19zaG9y
dF9zaXRlX3VybCcpKSwKICAgICAgICAgICAgICAgICAgICAnIGlkPSJhcmNfc2hvcnRfc2l0
ZV91cmwtb3B0aW9uIicKICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAgICAgICAg
ICAgdGRjcyhoZWQoJ1R3aXR0ZXIgdGFiJywgMiksMikKICAgICAgICAgICAgICAgICkudHIo
CiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl90YWIi
PkxvY2F0aW9uIG9mIFR3aXR0ZXIgdGFiPC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAg
ICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRs
ZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCgn
YXJjX3R3aXR0ZXJfdGFiJywkdGFiKSkKICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAg
ICAgICAgICAgICAgdGRjcyhoZWQoJ0NhY2hlJywgMiksMikKICAgICAgICAgICAgICAgICkK
ICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBm
b3I9ImFyY190d2l0dGVyX2NhY2hlX2RpciI+Q2FjaGUgZGlyZWN0b3J5PC9sYWJlbD4nLAog
ICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVy
dGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoZklucHV0
KCd0ZXh0JywnYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJywkY2FjaGVfZGlyLCcnLCcnLCcnLCcn
LCcnLCdhcmNfdHdpdHRlcl9jYWNoZV9kaXInKSkKICAgICAgICAgICAgICAgICkKICAgICAg
ICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoCiAgICAgICAgICAgICAg
ICAgICAgICAgIGZJbnB1dCgnc3VibWl0JywgJ1N1Ym1pdCcsIGdUeHQoJ3NhdmVfYnV0dG9u
JyksICdwdWJsaXNoJykKICAgICAgICAgICAgICAgICAgICAgICAgLm4uc0lucHV0KCdwcmVm
c19zYXZlJykKICAgICAgICAgICAgICAgICAgICAgICAgLm4uZUlucHV0KCdwbHVnaW5fcHJl
ZnMuYXJjX3R3aXR0ZXInKQogICAgICAgICAgICAgICAgICAgICwgJyBjb2xzcGFuPSIyIiBj
bGFzcz0ibm9saW5lIicpKSkKICAgICAgICAgICAgICAgIC5lbmRUYWJsZSgpOwogICAgICAg
IH0gZWxzZWlmICggJHN0ZXAhPSdyZWdpc3RlcicgKSB7CiAgICAgICAgICAgICRyZWdpc3Rl
clVSTCA9IGFyY190d2l0dGVyOjpjYWxsYmFja1VSTCgkZXZlbnQsJ3JlZ2lzdGVyJyk7CiAg
ICAgICAgICAgICRodG1sLj0gc3RhcnRUYWJsZSgnbGlzdCcpLmZvcm0oCiAgICAgICAgICAg
ICAgICB0cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVHdpdHRlciBhY2NvdW50
IGRldGFpbHMnLCAyKSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRy
KAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfdXNl
ciI+VHdpdHRlciB1c2VybmFtZTwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAg
JyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7Iicp
CiAgICAgICAgICAgICAgICAgICAgLnRkKAogICAgICAgICAgICAgICAgICAgICAgICAoJzxl
bT51bmtub3duPC9lbT4gKCcKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5ocmVmKCdD
b25uZWN0IHRvIFR3aXR0ZXInLCRyZWdpc3RlclVSTCkuJyknKQogICAgICAgICAgICAgICAg
KSkpCiAgICAgICAgICAgICAgICAuZW5kVGFibGUoKTsKICAgICAgICB9CiAgICB9CgogICAg
Ly8gU2V0IGpRdWVyeSBmb3Igc3dpdGNoaW5nIG9uL29mZiByZWxldmFudCBhcmNfc2hvcnRf
dXJsIGZpZWxkcwogICAgJGpzID0gPDw8SlMKPHNjcmlwdCBsYW5ndWFnZT0iamF2YXNjcmlw
dCIgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24o
KXsKICB2YXIgb25vZmYgPSAkKCcjYXJjX3Nob3J0X3VybC1vbl9vZmYnKTsKICB2YXIgYXJj
X3Nob3J0X3VybF9vZmYgPSAkKCcjYXJjX3Nob3J0X3VybC1hcmNfc2hvcnRfdXJsLTAnKTsK
ICB2YXIgdXJsID0gJCgnI2FyY19zaG9ydF9zaXRlX3VybC1vcHRpb24nKTsKICB2YXIgdXJs
X21ldGhvZCA9ICQoJ3NlbGVjdFtuYW1lPSJhcmNfdHdpdHRlcl91cmxfbWV0aG9kIl0nKTsK
CiAgaWYgKGFyY19zaG9ydF91cmxfb2ZmLmF0dHIoJ2NoZWNrZWQnKT09dHJ1ZQogICYmICQo
J29wdGlvbjpzZWxlY3RlZCcsIHVybF9tZXRob2QpLnZhbCgpIT0nYXJjX3R3aXR0ZXInKSB7
CiAgICB1cmwuaGlkZSgpOwogIH0KICAkKCdpbnB1dCcsIG9ub2ZmKS5jaGFuZ2UoZnVuY3Rp
b24oKXsKICAgIGlmICgkKCdvcHRpb246c2VsZWN0ZWQnLCB1cmxfbWV0aG9kKS52YWwoKSE9
J2FyY190d2l0dGVyJykgewogICAgICBhcmNfc2hvcnRfdXJsX29mZi5hdHRyKCdjaGVja2Vk
Jyk9PXRydWUgPyB1cmwuaGlkZSgpIDogdXJsLnNob3coKTsKICAgIH0KICB9KTsKCiAgaWYg
KCQoJ29wdGlvbjpzZWxlY3RlZCcsIHVybF9tZXRob2QpLnZhbCgpPT0nYXJjX3R3aXR0ZXIn
KSB7CiAgICBvbm9mZi5oaWRlKCk7IHVybC5zaG93KCk7CiAgfQogIHVybF9tZXRob2QuY2hh
bmdlKGZ1bmN0aW9uKCl7CiAgICBpZiAoJCgnb3B0aW9uOnNlbGVjdGVkJywgdXJsX21ldGhv
ZCkudmFsKCk9PSdhcmNfdHdpdHRlcicpIHsKICAgICAgb25vZmYudG9nZ2xlKCk7IHVybC5z
aG93KCk7CiAgICB9IGVsc2UgewogICAgICBvbm9mZi50b2dnbGUoKTsKICAgICAgYXJjX3No
b3J0X3VybF9vZmYuYXR0cignY2hlY2tlZCcpPT10cnVlID8gdXJsLmhpZGUoKSA6IHVybC5z
aG93KCk7CiAgICB9CiAgfSkKfSk7Cjwvc2NyaXB0PgpKUzsKCiAgICBlY2hvICRqcy4kaHRt
bDsKfQoKLy8gQWRkIFR3aXR0ZXIgdGFiIHRvIFRleHRwYXR0ZXJuCmZ1bmN0aW9uIGFyY19h
ZG1pbl90d2l0dGVyKCRldmVudCwkc3RlcCkKewogICAgZ2xvYmFsICRwcmVmcywgJGFyY190
d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgogICAg
JHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAg
ICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0
dGVyX2FjY2Vzc1Rva2VuJ10KICAgICAgICAgICAgLCAkcHJlZnNbJ2FyY190d2l0dGVyX2Fj
Y2Vzc1Rva2VuU2VjcmV0J10pOwoKICAgICR0d2l0LT5jYWNoZURpcigkcHJlZnNbJ2FyY190
d2l0dGVyX2NhY2hlX2RpciddKTsKCiAgICAkeG1sID0gJHR3aXQtPmdldCgndXNlcnMvc2hv
dycKICAgICAgICAsIGFycmF5KCdzY3JlZW5fbmFtZSc9PiRwcmVmc1snYXJjX3R3aXR0ZXJf
dXNlciddKSk7CiAgICAkdHdpdHRlclVzZXIgPSBAJHhtbC0+eHBhdGgoJy91c2VyJyk7CiAg
ICAkdHdpdHRlclVzZXIgPSAkdHdpdHRlclVzZXJbMF07CiAgICAkdHdpdHRlclVzZXJVUkwg
PSAnaHR0cDovL3d3dy50d2l0dGVyLmNvbS8nLiR0d2l0dGVyVXNlci0+c2NyZWVuX25hbWU7
CgogICAgaWYgKCRzdGVwPT0idHdlZXQiKSB7IC8vIHBvc3QgYW4gdXBkYXRlIHRvIFR3aXR0
ZXIKCiAgICAgICAgLy8gZmV0Y2ggYW5kIGNsZWFuIG1lc3NhZ2UKICAgICAgICAkbWVzc2Fn
ZSA9IHN0cmlwX3RhZ3MoZ3BzKCdtZXNzYWdlJykpOwogICAgICAgICRjb3VudCA9IHN0cmxl
bigkbWVzc2FnZSk7CgogICAgICAgIGlmICgkY291bnQ8PTE0MCAmJiAkY291bnQ+MCkgeyAv
LyBwb3N0IHVwZGF0ZQogICAgICAgICAgICAkcmVzdWx0ID0gJHR3aXQtPnBvc3QoJ3N0YXR1
c2VzL3VwZGF0ZScsIGFycmF5KCdzdGF0dXMnID0+ICRtZXNzYWdlKSk7CiAgICAgICAgfSBl
bHNlIHsgLy8gbWVzc2FnZSB0b28gbG9uZywgSmF2YVNjcmlwdCBpbnRlcmZhY2Ugc2hvdWxk
IHByZXZlbnQgdGhpcwogICAgICAgICAgICAkcmVzdWx0ID0gZmFsc2U7CiAgICAgICAgfQoK
ICAgICAgICBwYWdldG9wKCdUd2l0dGVyJywKICAgICAgICAgICAgKCgkcmVzdWx0IT1mYWxz
ZSk/J1R3aXR0ZXIgdXBkYXRlZCc6J0Vycm9yIHVwZGF0aW5nIFR3aXR0ZXInKSk7CgogICAg
fSBlbHNlaWYgKCRzdGVwPT0iZGVsZXRlIikgeyAvLyBkZWxldGUgYW4gdXBkYXRlIGZyb20g
VHdpdHRlcgoKICAgICAgICAkaWQgPSBzdHJpcF90YWdzKGdwcygnaWQnKSk7CiAgICAgICAg
aWYgKCRpZCkgewogICAgICAgICAgICAkdHdpdC0+ZGVsZXRlKCdzdGF0dXNlcy9kZXN0cm95
Jy4kaWQpOwogICAgICAgICAgICBzYWZlX2RlbGV0ZSgnYXJjX3R3aXR0ZXInLCJ0d2VldF9p
ZCA9ICRpZCIpOwogICAgICAgIH0KCiAgICAgICAgcGFnZXRvcCgnVHdpdHRlcicsJ1R3aXR0
ZXIgdXBkYXRlZCcpOwoKICAgIH0gZWxzZSB7CgogICAgICAgIHBhZ2V0b3AoJ1R3aXR0ZXIn
KTsKCiAgICB9CgogICAgLy8gUHJlcGFyZSBKYXZhU2NyaXB0IHRvIGNyZWF0ZSBUd2l0dGVy
IHVwZGF0ZSBpbnRlcmZhY2UKCiAgICAkanMgPSAnPHNjcmlwdCBsYW5ndWFnZT0iamF2YXNj
cmlwdCIgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4nOwogICAgJGpzLj0gIiQoZG9jdW1lbnQp
LnJlYWR5KGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHZhciBjb3VudGVyU3R5bGUgPSAnZm9u
dC13ZWlnaHQ6Ym9sZDtmbG9hdDpyaWdodDtmb250LXNpemU6MmVtO2xpbmUtaGVpZ2h0OjEu
MmVtOyc7CiAgICAgICAgICAgICQoJyN0d2VldGNvdW50JykuYXR0cignc3R5bGUnLCBjb3Vu
dGVyU3R5bGUrJ2NvbG9yOiNjY2M7Jyk7CiAgICAgICAgICAgICQoJyNtZXNzYWdlJykua2V5
dXAoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB2YXIgY291bnQgPSAxNDAtJCgnI21l
c3NhZ2UnKS52YWwoKS5sZW5ndGg7CiAgICAgICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcp
Lmh0bWwoY291bnQrJycpOyAvLyBoYWNrIHRvIGZvcmNlIG91dHB1dCBvZiAwCiAgICAgICAg
ICAgICAgICBpZiAoY291bnQ8MCkgewogICAgICAgICAgICAgICAgICAgICQoJ2lucHV0LnB1
Ymxpc2gnKS5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpOwogICAgICAgICAgICAgICAg
fSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkKCdpbnB1dC5wdWJsaXNoJykuYXR0cign
ZGlzYWJsZWQnLCAnJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAo
Y291bnQ8MCkgewogICAgICAgICAgICAgICAgICAgICQoJyN0d2VldGNvdW50JykuYXR0cign
c3R5bGUnLCBjb3VudGVyU3R5bGUrJ2NvbG9yOiNmMDA7Jyk7CiAgICAgICAgICAgICAgICB9
IGVsc2UgaWYgKGNvdW50PDEwKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnI3R3ZWV0Y291
bnQnKS5hdHRyKCdzdHlsZScsIGNvdW50ZXJTdHlsZSsnY29sb3I6IzAwMDsnKTsKICAgICAg
ICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJCgnI3R3ZWV0Y291bnQn
KS5hdHRyKCdzdHlsZScsIGNvdW50ZXJTdHlsZSsnY29sb3I6I2NjYzsnKTsKICAgICAgICAg
ICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICB9KTsiOwogICAgJGpzLj0gIjwvc2Ny
aXB0PiI7CgogICAgJG91dCA9ICcnOwogICAgJHhtbCA9ICR0d2l0LT5nZXQoJ3N0YXR1c2Vz
L3VzZXJfdGltZWxpbmUnCiAgICAgICAgLCBhcnJheSgnc2NyZWVuX25hbWUnPT4kcHJlZnNb
J2FyY190d2l0dGVyX3VzZXInXSwnY291bnQnPT4yNSkpOwogICAgJHR3ZWV0cyA9IEAkeG1s
LT54cGF0aCgnL3N0YXR1c2VzL3N0YXR1cycpOwogICAgaWYgKCR0d2VldHMpIGZvcmVhY2gg
KCR0d2VldHMgYXMgJHR3ZWV0KSB7CiAgICAgICAgJHRpbWUgPSBzdHJ0b3RpbWUoaHRtbGVu
dGl0aWVzKCR0d2VldC0+Y3JlYXRlZF9hdCkpOwogICAgICAgICRkYXRlID0gc2FmZV9zdHJm
dGltZSgkcHJlZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCddLCR0aW1lKTsKICAgICAgICAkb3V0
Lj0gdHIodGQoJGRhdGUsJ3NwYW4nKQogICAgICAgICAgICAudGQoYXJjX1R3aXR0ZXI6Om1h
a2VMaW5rcyhodG1sZW50aXRpZXMoJHR3ZWV0LT50ZXh0CiAgICAgICAgICAgICAgICAsIEVO
VF9RVU9URVMsJ1VURi04JykpKQogICAgICAgICAgICAudGQoZExpbmsoJ2FyY19hZG1pbl90
d2l0dGVyJywnZGVsZXRlJywnaWQnLCR0d2VldC0+aWQsJycpKQogICAgICAgICAgICApOwog
ICAgfQoKICAgICRodG1sID0gc3RhcnRUYWJsZSgnZWRpdCcpCiAgICAgICAgICAgIC50cih0
ZCgKICAgICAgICAgICAgZ3JhZignPGltZyBzcmM9IicuJHR3aXR0ZXJVc2VyLT5wcm9maWxl
X2ltYWdlX3VybC4nIiBhbHQ9IlR3aXR0ZXIgYXZhdGFyIiAvPicKICAgICAgICAgICAgLCcg
c3R5bGU9ImZsb2F0OmxlZnQ7cGFkZGluZzoycHg7IicpCiAgICAgICAgICAgIC5ncmFmKGhy
ZWYoJHR3aXR0ZXJVc2VyLT5uYW1lLCR0d2l0dGVyVXNlclVSTCksJyBzdHlsZT0iZm9udC1z
aXplOjEuMmVtO2ZvbnQtd2VpZ2h0OmJvbGQ7IicpCiAgICAgICAgICAgIC5ncmFmKGhyZWYo
JHR3aXR0ZXJVc2VyLT5mcmllbmRzX2NvdW50LicgZm9sbG93aW5nJywkdHdpdHRlclVzZXJV
UkwuJy9mb2xsb3dpbmcnKQogICAgICAgICAgICAuJywgJy5ocmVmKCR0d2l0dGVyVXNlci0+
Zm9sbG93ZXJzX2NvdW50LicgZm9sbG93ZXJzJywkdHdpdHRlclVzZXJVUkwuJy9mb2xsb3dl
cnMnKQogICAgICAgICAgICAuJywgJy5ocmVmKCR0d2l0dGVyVXNlci0+c3RhdHVzZXNfY291
bnQuJyB1cGRhdGVzJywkdHdpdHRlclVzZXJVUkwpKSkpCiAgICAgICAgICAgIC50cih0ZChm
b3JtKAogICAgICAgICAgICBncmFmKCJVcGRhdGUgVHdpdHRlci4uLjxzcGFuIGlkPSd0d2Vl
dGNvdW50JyBzdHlsZT0nZm9udC13ZWlnaHQ6Ym9sZDtmbG9hdDpyaWdodDsnPjE0MDwvc3Bh
bj4iKQogICAgICAgICAgICAudGV4dF9hcmVhKCdtZXNzYWdlJywnNTAnLCc1NTAnLCcnLCdt
ZXNzYWdlJykKICAgICAgICAgICAgLmVJbnB1dCgnYXJjX2FkbWluX3R3aXR0ZXInKQogICAg
ICAgICAgICAuc0lucHV0KCd0d2VldCcpLmJyCiAgICAgICAgICAgIC5mSW5wdXQoJ3N1Ym1p
dCcsJ3VwZGF0ZScsZ1R4dCgnVXBkYXRlJyksJ3B1Ymxpc2gnKQogICAgICAgICkpKQogICAg
ICAgIC5lbmRUYWJsZSgpOwoKICAgIC8vIEF0dGFjaCByZWNlbnQgVHdpdHRlciB1cGRhdGVz
CgogICAgJGh0bWwuPSBzdGFydFRhYmxlKCdsaXN0JywnJywnJywnJywnOTAlJykKICAgICAg
ICAuJG91dAogICAgICAgIC5lbmRUYWJsZSgpOwoKICAgIC8vIE91dHB1dCBKYXZhU2NyaXB0
IGFuZCBIVE1MCgogICAgZWNobyAkanMuJGh0bWw7Cn0KCi8vIEFkZCBUd2l0dGVyIG9wdGlv
bnMgdG8gYXJ0aWNsZSBhcnRpY2xlIHNjcmVlbgpmdW5jdGlvbiBhcmNfYXBwZW5kX3R3aXR0
ZXIoJGV2ZW50LCAkc3RlcCwgJGRhdGEsICRyczEpCnsKICAgIGdsb2JhbCAkcHJlZnMsICRh
cmNfdHdpdHRlcjsKICAgICRwcmVmaXggPSB0cmltKGdwcygnYXJjX3R3aXR0ZXJfcHJlZml4
JykpOwogICAgJHByZWZpeCA9ICgkcHJlZml4KSA/ICRwcmVmaXggOiAkcHJlZnNbJ2FyY190
d2l0dGVyX3ByZWZpeCddOwogICAgJHN1ZmZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9z
dWZmaXgnKSk7CgogICAgaWYgKCRyczFbJ0lEJ10pIHsKICAgICAgICAkc3FsID0gIlNFTEVD
VCB0d2VldF9pZCx0d2VldCBGUk9NICIuUEZYLiJhcmNfdHdpdHRlciBXSEVSRSBhcnRpY2xl
X2lkPSIuJHJzMVsnSUQnXS4iOyI7CiAgICAgICAgJHJzMiA9IHNhZmVfcXVlcnkoJHNxbCk7
ICRyczIgPSBuZXh0Um93KCRyczIpOwogICAgfSBlbHNlIHsgLy8gbmV3IGFydGljbGUKICAg
ICAgICAkcnMyID0gJyc7CiAgICB9CgogICAgaWYgKCRyczFbJ0lEJ10gJiYgJHJzMlsndHdl
ZXRfaWQnXSkgewogICAgICAgICRjb250ZW50ID0gYXJjX1R3aXR0ZXI6Om1ha2VMaW5rcygk
cnMyWyd0d2VldCddKTsKICAgICAgICByZXR1cm4gJGRhdGEuZmllbGRzZXQoJGNvbnRlbnQs
ICdUd2l0dGVyIHVwZGF0ZScsICdhcmNfdHdpdHRlcicpOwogICAgfSBlbHNlIHsKICAgICAg
ICAkdmFyID0gKCRyczFbJ0lEJ10pID8gMCA6ICRwcmVmc1snYXJjX3R3aXR0ZXJfdHdlZXRf
ZGVmYXVsdCddOwogICAgICAgICRjb250ZW50ICA9IHRhZyh5ZXNub1JhZGlvKCdhcmNfdHdl
ZXRfdGhpcycsICR2YXIsICcnLCAnYXJjX3R3ZWV0X3RoaXMnKSwncCcpOwogICAgICAgICRj
b250ZW50IC49IHRhZyhocmVmKCdPcHRpb25zJywnI2FyY190d2l0dGVyX29wdGlvbnMnKSwn
cCcsJyBjbGFzcz0icGxhaW4gbGV2ZXIiIHN0eWxlPSJtYXJnaW4tdG9wOjVweDsiJyk7CiAg
ICAgICAgJGNvbnRlbnQgLj0gdGFnKHRhZyh0YWcoJ1R3ZWV0IHByZWZpeCcsJ2xhYmVsJywg
JyBmb3I9ImFyY190d2l0dGVyX3ByZWZpeCInKQogICAgICAgICAgICAuZklucHV0KCd0ZXh0
JywnYXJjX3R3aXR0ZXJfcHJlZml4JywkcHJlZml4LCdlZGl0JywnJywnJywnMjInLCcnLCdh
cmNfdHdpdHRlcl9wcmVmaXgnKSwncCcpCiAgICAgICAgICAgIC50YWcodGFnKCdUd2VldCBz
dWZmaXggKGVnICNoYXNodGFncyknLCdsYWJlbCcsICcgZm9yPSJhcmNfdHdpdHRlcl9zdWZm
aXgiJykKICAgICAgICAgICAgLmZJbnB1dCgndGV4dCcsJ2FyY190d2l0dGVyX3N1ZmZpeCcs
JHN1ZmZpeCwnZWRpdCcsJycsJycsJzIyJywnJywnYXJjX3R3aXR0ZXJfc3VmZml4JyksJ3An
KQogICAgICAgICAgICAsJ2RpdicsJyBpZD0iYXJjX3R3aXR0ZXJfb3B0aW9ucyIgY2xhc3M9
InRvZ2dsZSIgc3R5bGU9ImRpc3BsYXk6bm9uZSInKTsKICAgICAgICBpZiAoaXNzZXQoJGFy
Y190d2l0dGVyWydlcnJvciddKSkgewogICAgICAgICAgICAkY29udGVudCAuPSAnPHA+Jy4k
YXJjX3R3aXR0ZXJbJ2Vycm9yJ10uJzwvcD4nOwogICAgICAgIH0KICAgICAgICByZXR1cm4g
JGRhdGEuZmllbGRzZXQoJGNvbnRlbnQsICdVcGRhdGUgVHdpdHRlcicsICdhcmNfdHdpdHRl
cicpOwogICAgfQoKfQoKLy8gVXBkYXRlIFR3aXR0ZXIgd2l0aCBwb3N0ZWQgYXJ0aWNsZQpm
dW5jdGlvbiBhcmNfYXJ0aWNsZV90d2VldCgkZXZlbnQsJHN0ZXApCnsKICAgIGdsb2JhbCAk
cHJlZnMsICRhcmNfdHdpdHRlciwgJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAg
LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgogICAgJGFydGljbGVfaWQgPSBlbXB0
eSgkR0xPQkFMU1snSUQnXSkgPyBncHMoJ0lEJykgOiAkR0xPQkFMU1snSUQnXTsKICAgIGlm
ICghZW1wdHkoJGFydGljbGVfaWQpKSB7CgogICAgICAgIGluY2x1ZGVfb25jZSB0eHBhdGgu
Jy9wdWJsaXNoL3RhZ2hhbmRsZXJzLnBocCc7CgogICAgICAgICRhcnRpY2xlID0gc2FmZV9y
b3coIklELCBUaXRsZSwgU2VjdGlvbiwgUG9zdGVkIiwgJ3RleHRwYXR0ZXJuJywKICAgICAg
ICAgICAgIklEPXskYXJ0aWNsZV9pZH0gQU5EIFN0YXR1cz00IEFORCBub3coKT49UG9zdGVk
Iik7CgogICAgICAgIGlmICgkYXJ0aWNsZSAmJiBncHMoJ2FyY190d2VldF90aGlzJykpIHsg
Ly8gdHdlZXQgYXJ0aWNsZQoKICAgICAgICAgICAgLy8gTmVlZCB0byBtYW51YWxseSB1cGRh
dGUgdGhlICdVUkwgb25seSB0aXRsZScgYmVmb3JlIGJ1aWxkaW5nIHRoZQogICAgICAgICAg
ICAvLyBVUkwKICAgICAgICAgICAgJGFydGljbGVbJ3VybF90aXRsZSddID0gZ3BzKCd1cmxf
dGl0bGUnKTsKICAgICAgICAgICAgLy8gTWFrZSBzaG9ydCBVUkwKICAgICAgICAgICAgJHVy
bCA9IHBlcm1saW5rdXJsKCRhcnRpY2xlKTsKICAgICAgICAgICAgJHNob3J0X3VybCA9IGFy
Y19zaG9ydGVuX3VybCgkdXJsLCRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddLAog
ICAgICAgICAgICAgICAgYXJyYXkoJ2lkJz0+JGFydGljbGVfaWQpKTsKCiAgICAgICAgICAg
IGlmICghJHNob3J0X3VybCkgeyAvLyBGYWlsZWQgdG8gb2J0YWluIGEgc2hvcnRlbmVkIFVS
TCwgZG8gbm90IHR3ZWV0IQogICAgICAgICAgICAgICAgJGFyY190d2l0dGVyWydlcnJvcidd
ID0gJ1VuYWJsZSB0byBvYnRhaW4gYSBzaG9ydCBVUkwgZm9yIHRoaXMgYXJ0aWNsZS4nOwoK
ICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAg
ICAgLy8gQ29uc3RydWN0IFR3aXR0ZXIgdXBkYXRlCiAgICAgICAgICAgICRwcmVmaXggID0g
dHJpbShncHMoJ2FyY190d2l0dGVyX3ByZWZpeCcpKTsKICAgICAgICAgICAgJHByZV9sZW4g
PSBzdHJsZW4oJHByZWZpeCk7CiAgICAgICAgICAgICRwcmVmaXggID0gKCRwcmVmaXggJiYg
JHByZV9sZW48PTIwKSA/ICRwcmVmaXguJyAnIDogJyc7CiAgICAgICAgICAgICRzdWZmaXgg
ID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3N1ZmZpeCcpKTsKICAgICAgICAgICAgJHN1Zl9s
ZW4gPSBzdHJsZW4oJHN1ZmZpeCk7CiAgICAgICAgICAgICRzdWZmaXggID0gKCRzdWZmaXgg
JiYgJHN1Zl9sZW48PTQwKSA/ICcgJy4kc3VmZml4IDogJyc7CiAgICAgICAgICAgICR1cmxf
bGVuID0gc3RybGVuKCRzaG9ydF91cmwpKzE7IC8vIGNvdW50IFVSTCBsZW5ndGggKyAxIGZv
ciBwcmVmaXhlZCBzcGFjZQogICAgICAgICAgICBpZiAoJHByZWZpeCkgJHByZV9sZW4gKz0g
MTsKICAgICAgICAgICAgaWYgKCRzdWZmaXgpICRzdWZfbGVuICs9IDE7CiAgICAgICAgICAg
IGlmICgoc3RybGVuKCRhcnRpY2xlWydUaXRsZSddKSskdXJsX2xlbiskcHJlX2xlbiskc3Vm
X2xlbik+MTQwKSB7CiAgICAgICAgICAgICAgICAkYXJ0aWNsZVsnVGl0bGUnXSA9IHN1YnN0
cigkYXJ0aWNsZVsnVGl0bGUnXSwwLDEzNS0kdXJsX2xlbi0kcHJlX2xlbi0kc3VmX2xlbiku
Jy4uLic7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJHR3ZWV0ID0gJHByZWZpeC4kYXJ0
aWNsZVsnVGl0bGUnXS4iICIuJHNob3J0X3VybC4kc3VmZml4OwoKICAgICAgICAgICAgLy8g
VXBkYXRlIFR3aXR0ZXIKICAgICAgICAgICAgJHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFy
Y190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgICAgICAgICAsICRhcmNfdHdpdHRlcl9j
b25zdW1lclNlY3JldCwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddCiAgICAg
ICAgICAgICAgICAsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSk7
CiAgICAgICAgICAgICRyZXN1bHQgPSAkdHdpdC0+cG9zdCgnc3RhdHVzZXMvdXBkYXRlJywg
YXJyYXkoJ3N0YXR1cycgPT4gJHR3ZWV0KSk7CgogICAgICAgICAgICAkdHdlZXRfaWQgPSAo
aXNfb2JqZWN0KCRyZXN1bHQpKSA/ICRyZXN1bHRbMF0tPmlkIDogMDsKCiAgICAgICAgICAg
IGlmICgkdHdlZXRfaWQpIHsKCiAgICAgICAgICAgICAgICAkdHdlZXQgPSBhZGRzbGFzaGVz
KCR0d2VldCk7CgogICAgICAgICAgICAgICAgLy8gdXBkYXRlIGFyY190d2l0dGVyIHRhYmxl
IHdpdGggdHdlZXQKICAgICAgICAgICAgICAgICRzcWwgPSAiSU5TRVJUIElOVE8gIi5QRlgu
ImFyY190d2l0dGVyIChhcnRpY2xlX2lkLHR3ZWV0X2lkLHR3ZWV0LHRpbnl1cmwpICI7CiAg
ICAgICAgICAgICAgICAkc3FsLj0gIlZBTFVFUygkYXJ0aWNsZV9pZCwkdHdlZXRfaWQsXCIk
dHdlZXRcIiwnJHNob3J0X3VybCcpOyI7CiAgICAgICAgICAgICAgICBzYWZlX3F1ZXJ5KCRz
cWwpOwoKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgICAgICAgfSBlbHNl
IHsKCiAgICAgICAgICAgICAgICAkYXJjX3R3aXR0ZXJbJ2Vycm9yJ10gPSAnVHdpdHRlciBy
ZXNwb25zZTogJwogICAgICAgICAgICAgICAgICAgIC4kdHdpdC0+aHR0cF9jb2RlOwogICAg
ICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAgfQoKICAgICAgICB9Cgog
ICAgfQoKICAgIHJldHVybiBmYWxzZTsKCn0KCi8qCiAqIFNob3J0ZW4gVVJMcyB1c2luZyB2
YXJpb3VzIG1ldGhvZHMKICovCgpmdW5jdGlvbiBhcmNfc2hvcnRlbl91cmwoJHVybCwgJG1l
dGhvZD0nJywgJGF0dHM9YXJyYXkoKSkKewogIGdsb2JhbCAkcHJlZnM7CgogICRjaCA9IGN1
cmxfaW5pdCgpOwogIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9IRUFERVIsIDApOwogIGN1
cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgdHJ1ZSk7CiAgY3VybF9z
ZXRvcHQoJGNoLCBDVVJMT1BUX1RJTUVPVVQsIDEwKTsKCiAgc3dpdGNoICgkbWV0aG9kKSB7
CiAgICBjYXNlICdzbWQnOiAvLyBjcmVhdGUgYSBzaG9ydGVuZWQgVVJMIHVzaW5nIFNNRCBT
aG9ydCBVUkwKICAgICAgcmV0dXJuICgkYXR0c1snaWQnXSkgPyBodS4kYXR0c1snaWQnXSA6
IGZhbHNlOyBicmVhazsKICAgIGNhc2UgJ2FyY190d2l0dGVyJzogLy8gbmF0aXZlIFVSTCBz
aG9ydGVuaW5nCgogICAgICByZXR1cm4gKCRhdHRzWydpZCddKSA/IFBST1RPQ09MLiRwcmVm
c1snYXJjX3Nob3J0X3NpdGVfdXJsJ10uJy8nLiRhdHRzWydpZCddIDogZmFsc2U7CiAgICAg
IGJyZWFrOwoKICAgIGNhc2UgJ2lzZ2QnOgoKICAgICAgJHUgPSAnaHR0cDovL2lzLmdkL2Fw
aS5waHA/bG9uZ3VybD0nLnVybGVuY29kZSgkdXJsKTsKICAgICAgY3VybF9zZXRvcHQoJGNo
LCBDVVJMT1BUX1VSTCwgJHUpOwoKICAgICAgJHRpbnl1cmwgPSBjdXJsX2V4ZWMoJGNoKTsK
ICAgICAgaWYgKCR0aW55dXJsIT0nRXJyb3InICYmICR0aW55dXJsIT0nJykgewogICAgICAg
IHJldHVybiAkdGlueXVybDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0cmlnZ2VyX2Vycm9y
KCdhcmNfdHdpdHRlciBmYWlsZWQgdG8gZ2V0IGEgaXMuZ2QgVVJMIGZvciAnCiAgICAgICAg
ICAgIC4kdXJsLEVfVVNFUl9XQVJOSU5HKTsKICAgICAgfQogICAgICBicmVhazsKCiAgICBj
YXNlICd0aW55dXJsJzogZGVmYXVsdDogLy8gY3JlYXRlIGEgc2hvcnRlbmVkIFVSTCB1c2lu
ZyBUaW55VVJMCgogICAgICAkdSA9ICdodHRwOi8vdGlueXVybC5jb20vYXBpLWNyZWF0ZS5w
aHA/dXJsPScudXJsZW5jb2RlKCR1cmwpOwogICAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxP
UFRfVVJMLCAkdSk7CiAgICAgICR0aW55dXJsID0gY3VybF9leGVjKCRjaCk7CiAgICAgIGlm
ICgkdGlueXVybCE9J0Vycm9yJyAmJiAkdGlueXVybCE9JycpIHsKICAgICAgICByZXR1cm4g
JHRpbnl1cmw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdHJpZ2dlcl9lcnJvcignYXJjX3R3
aXR0ZXIgZmFpbGVkIHRvIGdldCBhIFRpbnlVUkwgZm9yICcuJHVybCxFX1VTRVJfV0FSTklO
Ryk7CiAgICAgIH0KCiAgfQoKICByZXR1cm4gZmFsc2U7IC8vIGZhaWwKCn0KCi8qCiAqIFNo
b3J0ZW5lZCBVUkwgcmVkaXJlY3QgYmFzZWQgb24gc21kX3Nob3J0X3VybAogKi8KZnVuY3Rp
b24gYXJjX3Nob3J0X3VybF9yZWRpcmVjdCgkZXZlbnQsICRzdGVwKSB7CiAgZ2xvYmFsICRw
cmVmczsKCiAgJGhhdmVfaWQgPSAwOwoKICAvLyBDaGVjayBpZiB0aGVyZSBpcyBhbiBhdmFp
bGFibGUgc2hvcnQgc2l0ZSB1cmwgYW5kIGlmIGl0IGlzIGJlaW5nIHVzZWQgaW4KICAvLyB0
aGlzIGluc3RhbmNlCiAgJHNob3J0X3NpdGVfdXJsID0gJHByZWZzWydhcmNfc2hvcnRfc2l0
ZV91cmwnXTsKICBpZiAoJHNob3J0X3NpdGVfdXJsKSB7CiAgICAkc2hvcnRfc2l0ZV91cmwg
PSBQUk9UT0NPTC4kc2hvcnRfc2l0ZV91cmwuJy8nOwogICAgJHVybF9wYXJ0cyA9IHBhcnNl
X3VybCgkc2hvcnRfc2l0ZV91cmwpOwogICAgJHJlID0gJyNeJy4kdXJsX3BhcnRzWydwYXRo
J10uJyhbMC05XS4qKSMnOwogICAgJGhhdmVfaWQgPSBwcmVnX21hdGNoKCRyZSwgJF9TRVJW
RVJbJ1JFUVVFU1RfVVJJJ10sICRtKTsKICB9CgogIC8vIEZhbGwgYmFjayB0byBzdGFuZGFy
ZCBzaXRlIHVybCAoc21kX3Nob3J0X3VybCBiZWhhdmlvdXIpCiAgaWYgKCRoYXZlX2lkKSB7
CiAgICAkdXJsX3BhcnRzID0gcGFyc2VfdXJsKGh1KTsKICAgICRyZSA9ICcjXicuJHVybF9w
YXJ0c1sncGF0aCddLicoWzAtOV0uKikjJzsKICAgICRoYXZlX2lkID0gcHJlZ19tYXRjaCgk
cmUsICRfU0VSVkVSWydSRVFVRVNUX1VSSSddLCAkbSk7CiAgfQoKICAvLyBEbyB0aGUgcmVk
aXJlY3QgaWYgd2UndmUgZ290IGFuIGFydGljbGUgaWQKICBpZiAoJGhhdmVfaWQpIHsKCSAg
JGlkID0gJG1bMV07CgkgICRwZXJtbGluayA9IHBlcm1saW5rdXJsX2lkKCRpZCk7CgoJICBp
ZiAoJHBlcm1saW5rKSB7CgkJICBvYl9lbmRfY2xlYW4oKTsKCgkJICAvLyBTdHVwaWQsIG92
ZXIgdGhlIHRvcCBoZWFkZXIgc2V0dGluZyBmb3IgSUUKCQkgIGhlYWRlcigiU3RhdHVzOiAz
MDEiKTsKCQkgIGhlYWRlcigiSFRUUC8xLjAgMzAxIE1vdmVkIFBlcm1hbmVudGx5Iik7CgkJ
ICBoZWFkZXIoIkxvY2F0aW9uOiAiLiRwZXJtbGluaywgVFJVRSwgMzAxKTsKCgkJICAvLyBJ
biBjYXNlIHRoZSBoZWFkZXIoKSBtZXRob2QgZmFpbHMsIGZhbGwgYmFjayBvbiBhIGNsYXNz
aWMgcmVkaXJlY3QKCQkgIGVjaG8gJzxodG1sPjxoZWFkPjxNRVRBIEhUVFAtRVFVSVY9IlJl
ZnJlc2giIENPTlRFTlQ9IjA7VVJMPScKCQkgICAgLiRwZXJtbGluay4nIj48L2hlYWQ+PGJv
ZHk+PC9ib2R5PjwvaHRtbD4nOwoJCSAgZGllKCk7CgkgIH0KICB9Cgp9CgovKgogKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKgoqLwoKY2xhc3MgYXJjX3R3aXR0ZXIgZXh0ZW5kcyBUd2l0
dGVyT0F1dGggewogICAgLy8gQ2FjaGluZyB2YXJpYWJsZXMKICAgIHByaXZhdGUgJF9jYWNo
ZSA9IHRydWU7CiAgICBwcml2YXRlICRfY2FjaGVfZGlyID0gJy4vdG1wJzsKICAgIHByaXZh
dGUgJF9jYWNoZV90aW1lID0gMTgwMDsgLy8gMzAgbWludXRlIGNhY2hlCgogICAgZnVuY3Rp
b24gX19jb25zdHJ1Y3QoJGNvbnN1bWVyX2tleSwgJGNvbnN1bWVyX3NlY3JldCwgJG9hdXRo
X3Rva2VuID0gTlVMTAogICAgICAgICwgJG9hdXRoX3Rva2VuX3NlY3JldCA9IE5VTEwpCiAg
ICB7CiAgICAgICAgcGFyZW50OjpfX2NvbnN0cnVjdCgkY29uc3VtZXJfa2V5LCAkY29uc3Vt
ZXJfc2VjcmV0LCAkb2F1dGhfdG9rZW4KICAgICAgICAgICAgLCAkb2F1dGhfdG9rZW5fc2Vj
cmV0KTsKICAgICAgICAkdGhpcy0+Zm9ybWF0ID0gJ3htbCc7CiAgICAgICAgJHRoaXMtPnRp
bWVvdXQgPSAxNTsKICAgICAgICAkdGhpcy0+Y29ubmVjdHRpbWVvdXQgPSAxNTsKICAgIH0K
CiAgICBwdWJsaWMgZnVuY3Rpb24gY2FsbGJhY2tVUkwoJGV2ZW50LCRzdGVwKQogICAgewog
ICAgICAgIHJldHVybiBodS4ndGV4dHBhdHRlcm4vaW5kZXgucGhwP2V2ZW50PScuJGV2ZW50
LicmYW1wO3N0ZXA9Jy4kc3RlcDsKICAgIH0KCiAgICAvLyBjcmVhdGUgVHdpdHRlciBhbmQg
ZXh0ZXJuYWwgbGlua3MgaW4gdGV4dAogICAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBtYWtl
TGlua3MoJHRleHQpCiAgICB7CiAgICAgICAgJHVybCA9ICcvXGIoaHR0cHxodHRwc3xmdHAp
OlwvXC8oW0EtWjAtOV1bQS1aMC05Xy1dKig/OlwuW0EtWjAtOV1bQS1aMC05Xy1dKikrKTo/
KFxkKyk/XC8/KFtcL1x3K1wuXSspXGIvaSc7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxh
Y2UoJHVybCwgIjxhIGhyZWY9JyQwJz4kMDwvYT4iLCAkdGV4dCk7CiAgICAgICAgJHVybCA9
ICcvXGIoXnxccyl3d3cuKFthLXpfQS1aMC05XSspKChcLlthLXpdKykrKVxiL2knOwogICAg
ICAgICR0ZXh0ID0gcHJlZ19yZXBsYWNlKCR1cmwsICI8YSBocmVmPSdodHRwOi8vd3d3LiQy
JDMnPnd3dy4kMiQzPC9hPiIsICR0ZXh0KTsKICAgICAgICAkdGV4dCA9IHByZWdfcmVwbGFj
ZSgiLyhefFxzKUAoW2Etel9BLVowLTldKykvIiwKICAgICAgICAgICAgIiQxQDxhIGhyZWY9
J2h0dHA6Ly90d2l0dGVyLmNvbS8kMic+JDI8L2E+IiwkdGV4dCk7CiAgICAgICAgJHRleHQg
PSBwcmVnX3JlcGxhY2UoIi8oXnxccykoXCMoW2Etel9BLVowLTk6Xy1dKykpLyIsCiAgICAg
ICAgICAgICIkMTxhIGhyZWY9J2h0dHA6Ly90d2l0dGVyLmNvbS9zZWFyY2g/cT0lMjMkMyc+
JDI8L2E+IiwkdGV4dCk7CiAgICAgICAgcmV0dXJuICR0ZXh0OwogIH0KCiAgICBwdWJsaWMg
ZnVuY3Rpb24gZ2V0KCR1cmwsICRwYXJhbXMgPSBhcnJheSgpKQogICAgewogICAgICAgICRh
cGlfdXJsID0gbWQ1KCR1cmwudXJsZW5jb2RlKHNlcmlhbGl6ZSgkcGFyYW1zKSkpOwogICAg
ICAgICRkYXRhID0gJyc7CgogICAgICAgIGlmICgkdGhpcy0+X2NhY2hlKSB7IC8vIGNoZWNr
IGZvciBjYWNoZWQgeG1sCgogICAgICAgICAgICAkZGF0YSA9ICR0aGlzLT5fcmV0cmlldmVD
YWNoZSgkYXBpX3VybCk7CgogICAgICAgIH0KICAgICAgICBpZiAoZW1wdHkoJGRhdGEpKSB7
CiAgICAgICAgICAgICRkYXRhID0gcGFyZW50OjpnZXQoJHVybCwgJHBhcmFtcyk7CiAgICAg
ICAgICAgIGlmICgkdGhpcy0+aHR0cF9jb2RlPT09MjAwICYmICR4bWw9c2ltcGxleG1sX2xv
YWRfc3RyaW5nKCRkYXRhKSkgeyAvLyBzYXZlIGNhY2hlCiAgICAgICAgICAgICAgICAkZmls
ZSA9ICR0aGlzLT5fY2FjaGVfZGlyLicvJy4kYXBpX3VybDsKICAgICAgICAgICAgICAgIGZp
bGVfcHV0X2NvbnRlbnRzKCRmaWxlLCRkYXRhLExPQ0tfRVgpOwogICAgICAgICAgICAgICAg
cmV0dXJuICR4bWw7CiAgICAgICAgICAgIH0gZWxzZSB7IC8vIGZhaWxlZCB0byByZXRyaWV2
ZSBkYXRhIGZyb20gVHdpdHRlcgoKICAgICAgICAgICAgICAgIGlmICgkdGhpcy0+X2NhY2hl
KSB7IC8vIGF0dGVtcHQgdG8gZm9yY2UgY2FjaGVkIHhtbCByZXR1cm4KCiAgICAgICAgICAg
ICAgICAgICAgJGRhdGEgPSAkdGhpcy0+X3JldHJpZXZlQ2FjaGUoJGFwaV91cmwsdHJ1ZSk7
CiAgICAgICAgICAgICAgICAgICAgaWYgKCRkYXRhKSByZXR1cm4gQHNpbXBsZXhtbF9sb2Fk
X3N0cmluZygkZGF0YSk7CgogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJl
dHVybiBmYWxzZTsKCiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgeyAvLyByZXR1cm4g
Y2FjaGVkIHhtbAogICAgICAgICAgICByZXR1cm4gQHNpbXBsZXhtbF9sb2FkX3N0cmluZygk
ZGF0YSk7CiAgICAgICAgfQogICAgfSAvL2VuZCBnZXQoKQoKICAgIGZ1bmN0aW9uIHBvc3Qo
JHVybCwgJHBhcmFtcyA9IGFycmF5KCkpCiAgICB7CiAgICAgICAgJGRhdGEgPSBwYXJlbnQ6
OnBvc3QoJHVybCwkcGFyYW1zKTsKICAgICAgICByZXR1cm4gc2ltcGxleG1sX2xvYWRfc3Ry
aW5nKCRkYXRhKTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWxldGUoJHVybCwgJHBhcmFtcyA9
IGFycmF5KCkpCiAgICB7CiAgICAgICAgJGRhdGEgPSBwYXJlbnQ6OmRlbGV0ZSgkdXJsLCRw
YXJhbXMpOwogICAgICAgIHJldHVybiBzaW1wbGV4bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwog
ICAgfQoKICAgIC8vIENhY2hlIG1ldGhvZHMKCiAgICBwdWJsaWMgZnVuY3Rpb24gc2V0Q2Fj
aGluZygkY2FjaGU9dHJ1ZSkKICAgIHsKICAgICAgICAkdGhpcy0+X2NhY2hlID0gKCRjYWNo
ZSkgPyB0cnVlIDogZmFsc2U7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHVi
bGljIGZ1bmN0aW9uIGNhY2hlRGlyKCRsb2MpCiAgICB7CiAgICAgICAgJHRoaXMtPl9jYWNo
ZV9kaXIgPSAkbG9jOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHB1YmxpYyBm
dW5jdGlvbiBjYWNoZVRpbWUoJG1pbnMpCiAgICB7CiAgICAgICAgJHRoaXMtPl9jYWNoZV90
aW1lID0gJG1pbnMqNjA7IC8vIGNvbnZlcnQgbWludXRlcyBpbnRvIHNlY29uZHMKICAgICAg
ICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcml2YXRlIGZ1bmN0aW9uIF9yZXRyaWV2ZUNh
Y2hlKCR1cmwsJG92ZXJpZGVfdGltZW91dD1mYWxzZSkKICAgIHsKICAgICAgICAkZmlsZSA9
ICR0aGlzLT5fY2FjaGVfZGlyLicvJy4kdXJsOwogICAgICAgIGlmIChmaWxlX2V4aXN0cygk
ZmlsZSkpIHsKCiAgICAgICAgICAgICRkaWZmID0gdGltZSgpIC0gZmlsZW10aW1lKCRmaWxl
KTsKICAgICAgICAgICAgaWYgKCRvdmVyaWRlX3RpbWVvdXQgfHwgJGRpZmYgPCAkdGhpcy0+
X2NhY2hlX3RpbWUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmaWxlX2dldF9jb250ZW50
cygkZmlsZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4g
ZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0
dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KfQoKLyoKICogQWJyYWhhbSBXaWxsaWFtcyAo
YWJyYWhhbUBhYnJhaC5hbSkgaHR0cDovL2FicmFoLmFtCiAqCiAqIFRoZSBmaXJzdCBQSFAg
TGlicmFyeSB0byBzdXBwb3J0IE9BdXRoIGZvciBUd2l0dGVyJ3MgUkVTVCBBUEkuCiAqLwoK
LyoqCiAqIFR3aXR0ZXIgT0F1dGggY2xhc3MKICovCmNsYXNzIFR3aXR0ZXJPQXV0aCB7CiAg
LyogQ29udGFpbnMgdGhlIGxhc3QgSFRUUCBzdGF0dXMgY29kZSByZXR1cm5lZC4gKi8KICBw
dWJsaWMgJGh0dHBfY29kZTsKICAvKiBDb250YWlucyB0aGUgbGFzdCBBUEkgY2FsbC4gKi8K
ICBwdWJsaWMgJHVybDsKICAvKiBTZXQgdXAgdGhlIEFQSSByb290IFVSTC4gKi8KICBwdWJs
aWMgJGhvc3QgPSAiaHR0cHM6Ly9hcGkudHdpdHRlci5jb20vMS8iOwogIC8qIFNldCB0aW1l
b3V0IGRlZmF1bHQuICovCiAgcHVibGljICR0aW1lb3V0ID0gMzA7CiAgLyogU2V0IGNvbm5l
Y3QgdGltZW91dC4gKi8KICBwdWJsaWMgJGNvbm5lY3R0aW1lb3V0ID0gMzA7CiAgLyogVmVy
aWZ5IFNTTCBDZXJ0LiAqLwogIHB1YmxpYyAkc3NsX3ZlcmlmeXBlZXIgPSBGQUxTRTsKICAv
KiBSZXNwb25zIGZvcm1hdC4gKi8KICBwdWJsaWMgJGZvcm1hdCA9ICdqc29uJzsKICAvKiBE
ZWNvZGUgcmV0dXJuZWQganNvbiBkYXRhLiAqLwogIHB1YmxpYyAkZGVjb2RlX2pzb24gPSBU
UlVFOwogIC8qIENvbnRhaW5zIHRoZSBsYXN0IEhUVFAgaGVhZGVycyByZXR1cm5lZC4gKi8K
ICBwdWJsaWMgJGh0dHBfaW5mbzsKICAvKiBTZXQgdGhlIHVzZXJhZ25ldC4gKi8KICBwdWJs
aWMgJHVzZXJhZ2VudCA9ICdUd2l0dGVyT0F1dGggdjAuMi4wLWJldGEyJzsKICAvKiBJbW1l
ZGlhdGVseSByZXRyeSB0aGUgQVBJIGNhbGwgaWYgdGhlIHJlc3BvbnNlIHdhcyBub3Qgc3Vj
Y2Vzc2Z1bC4gKi8KICAvL3B1YmxpYyAkcmV0cnkgPSBUUlVFOwoKCgoKICAvKioKICAgKiBT
ZXQgQVBJIFVSTFMKICAgKi8KICBmdW5jdGlvbiBhY2Nlc3NUb2tlblVSTCgpICB7IHJldHVy
biAnaHR0cHM6Ly9hcGkudHdpdHRlci5jb20vb2F1dGgvYWNjZXNzX3Rva2VuJzsgfQogIGZ1
bmN0aW9uIGF1dGhlbnRpY2F0ZVVSTCgpIHsgcmV0dXJuICdodHRwczovL3R3aXR0ZXIuY29t
L29hdXRoL2F1dGhlbnRpY2F0ZSc7IH0KICBmdW5jdGlvbiBhdXRob3JpemVVUkwoKSAgICB7
IHJldHVybiAnaHR0cHM6Ly90d2l0dGVyLmNvbS9vYXV0aC9hdXRob3JpemUnOyB9CiAgZnVu
Y3Rpb24gcmVxdWVzdFRva2VuVVJMKCkgeyByZXR1cm4gJ2h0dHBzOi8vYXBpLnR3aXR0ZXIu
Y29tL29hdXRoL3JlcXVlc3RfdG9rZW4nOyB9CgogIC8qKgogICAqIERlYnVnIGhlbHBlcnMK
ICAgKi8KICBmdW5jdGlvbiBsYXN0U3RhdHVzQ29kZSgpIHsgcmV0dXJuICR0aGlzLT5odHRw
X3N0YXR1czsgfQogIGZ1bmN0aW9uIGxhc3RBUElDYWxsKCkgeyByZXR1cm4gJHRoaXMtPmxh
c3RfYXBpX2NhbGw7IH0KCiAgLyoqCiAgICogY29uc3RydWN0IFR3aXR0ZXJPQXV0aCBvYmpl
Y3QKICAgKi8KICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkY29uc3VtZXJfa2V5LCAkY29uc3Vt
ZXJfc2VjcmV0LCAkb2F1dGhfdG9rZW4gPSBOVUxMLCAkb2F1dGhfdG9rZW5fc2VjcmV0ID0g
TlVMTCkgewogICAgJHRoaXMtPnNoYTFfbWV0aG9kID0gbmV3IE9BdXRoU2lnbmF0dXJlTWV0
aG9kX0hNQUNfU0hBMSgpOwogICAgJHRoaXMtPmNvbnN1bWVyID0gbmV3IE9BdXRoQ29uc3Vt
ZXIoJGNvbnN1bWVyX2tleSwgJGNvbnN1bWVyX3NlY3JldCk7CiAgICBpZiAoIWVtcHR5KCRv
YXV0aF90b2tlbikgJiYgIWVtcHR5KCRvYXV0aF90b2tlbl9zZWNyZXQpKSB7CiAgICAgICR0
aGlzLT50b2tlbiA9IG5ldyBPQXV0aENvbnN1bWVyKCRvYXV0aF90b2tlbiwgJG9hdXRoX3Rv
a2VuX3NlY3JldCk7CiAgICB9IGVsc2UgewogICAgICAkdGhpcy0+dG9rZW4gPSBOVUxMOwog
ICAgfQogIH0KCgogIC8qKgogICAqIEdldCBhIHJlcXVlc3RfdG9rZW4gZnJvbSBUd2l0dGVy
CiAgICoKICAgKiBAcmV0dXJucyBhIGtleS92YWx1ZSBhcnJheSBjb250YWluaW5nIG9hdXRo
X3Rva2VuIGFuZCBvYXV0aF90b2tlbl9zZWNyZXQKICAgKi8KICBmdW5jdGlvbiBnZXRSZXF1
ZXN0VG9rZW4oJG9hdXRoX2NhbGxiYWNrID0gTlVMTCkgewogICAgJHBhcmFtZXRlcnMgPSBh
cnJheSgpOwogICAgaWYgKCFlbXB0eSgkb2F1dGhfY2FsbGJhY2spKSB7CiAgICAgICRwYXJh
bWV0ZXJzWydvYXV0aF9jYWxsYmFjayddID0gJG9hdXRoX2NhbGxiYWNrOwogICAgfQogICAg
JHJlcXVlc3QgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR0aGlzLT5yZXF1ZXN0VG9rZW5VUkwo
KSwgJ0dFVCcsICRwYXJhbWV0ZXJzKTsKICAgICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFyc2Vf
cGFyYW1ldGVycygkcmVxdWVzdCk7CiAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25z
dW1lcigkdG9rZW5bJ29hdXRoX3Rva2VuJ10sICR0b2tlblsnb2F1dGhfdG9rZW5fc2VjcmV0
J10pOwogICAgcmV0dXJuICR0b2tlbjsKICB9CgogIC8qKgogICAqIEdldCB0aGUgYXV0aG9y
aXplIFVSTAogICAqCiAgICogQHJldHVybnMgYSBzdHJpbmcKICAgKi8KICBmdW5jdGlvbiBn
ZXRBdXRob3JpemVVUkwoJHRva2VuLCAkc2lnbl9pbl93aXRoX3R3aXR0ZXIgPSBUUlVFKSB7
CiAgICBpZiAoaXNfYXJyYXkoJHRva2VuKSkgewogICAgICAkdG9rZW4gPSAkdG9rZW5bJ29h
dXRoX3Rva2VuJ107CiAgICB9CiAgICBpZiAoZW1wdHkoJHNpZ25faW5fd2l0aF90d2l0dGVy
KSkgewogICAgICByZXR1cm4gJHRoaXMtPmF1dGhvcml6ZVVSTCgpIC4gIj9vYXV0aF90b2tl
bj17JHRva2VufSI7CiAgICB9IGVsc2UgewogICAgICAgcmV0dXJuICR0aGlzLT5hdXRoZW50
aWNhdGVVUkwoKSAuICI/b2F1dGhfdG9rZW49eyR0b2tlbn0iOwogICAgfQogIH0KCiAgLyoq
CiAgICogRXhjaGFuZ2UgcmVxdWVzdCB0b2tlbiBhbmQgc2VjcmV0IGZvciBhbiBhY2Nlc3Mg
dG9rZW4gYW5kCiAgICogc2VjcmV0LCB0byBzaWduIEFQSSBjYWxscy4KICAgKgogICAqIEBy
ZXR1cm5zIGFycmF5KCJvYXV0aF90b2tlbiIgPT4gInRoZS1hY2Nlc3MtdG9rZW4iLAogICAq
ICAgICAgICAgICAgICAgICJvYXV0aF90b2tlbl9zZWNyZXQiID0+ICJ0aGUtYWNjZXNzLXNl
Y3JldCIsCiAgICogICAgICAgICAgICAgICAgInVzZXJfaWQiID0+ICI5NDM2OTkyIiwKICAg
KiAgICAgICAgICAgICAgICAic2NyZWVuX25hbWUiID0+ICJhYnJhaGFtIikKICAgKi8KICBm
dW5jdGlvbiBnZXRBY2Nlc3NUb2tlbigkb2F1dGhfdmVyaWZpZXIgPSBGQUxTRSkgewogICAg
JHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgaWYgKCFlbXB0eSgkb2F1dGhfdmVyaWZpZXIp
KSB7CiAgICAgICRwYXJhbWV0ZXJzWydvYXV0aF92ZXJpZmllciddID0gJG9hdXRoX3Zlcmlm
aWVyOwogICAgfQogICAgJHJlcXVlc3QgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR0aGlzLT5h
Y2Nlc3NUb2tlblVSTCgpLCAnR0VUJywgJHBhcmFtZXRlcnMpOwogICAgJHRva2VuID0gT0F1
dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKCRyZXF1ZXN0KTsKICAgICR0aGlzLT50b2tlbiA9
IG5ldyBPQXV0aENvbnN1bWVyKCR0b2tlblsnb2F1dGhfdG9rZW4nXSwgJHRva2VuWydvYXV0
aF90b2tlbl9zZWNyZXQnXSk7CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAgLyoqCiAgICog
T25lIHRpbWUgZXhjaGFuZ2Ugb2YgdXNlcm5hbWUgYW5kIHBhc3N3b3JkIGZvciBhY2Nlc3Mg
dG9rZW4gYW5kIHNlY3JldC4KICAgKgogICAqIEByZXR1cm5zIGFycmF5KCJvYXV0aF90b2tl
biIgPT4gInRoZS1hY2Nlc3MtdG9rZW4iLAogICAqICAgICAgICAgICAgICAgICJvYXV0aF90
b2tlbl9zZWNyZXQiID0+ICJ0aGUtYWNjZXNzLXNlY3JldCIsCiAgICogICAgICAgICAgICAg
ICAgInVzZXJfaWQiID0+ICI5NDM2OTkyIiwKICAgKiAgICAgICAgICAgICAgICAic2NyZWVu
X25hbWUiID0+ICJhYnJhaGFtIiwKICAgKiAgICAgICAgICAgICAgICAieF9hdXRoX2V4cGly
ZXMiID0+ICIwIikKICAgKi8KICBmdW5jdGlvbiBnZXRYQXV0aFRva2VuKCR1c2VybmFtZSwg
JHBhc3N3b3JkKSB7CiAgICAkcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICAkcGFyYW1ldGVy
c1sneF9hdXRoX3VzZXJuYW1lJ10gPSAkdXNlcm5hbWU7CiAgICAkcGFyYW1ldGVyc1sneF9h
dXRoX3Bhc3N3b3JkJ10gPSAkcGFzc3dvcmQ7CiAgICAkcGFyYW1ldGVyc1sneF9hdXRoX21v
ZGUnXSA9ICdjbGllbnRfYXV0aCc7CiAgICAkcmVxdWVzdCA9ICR0aGlzLT5vQXV0aFJlcXVl
c3QoJHRoaXMtPmFjY2Vzc1Rva2VuVVJMKCksICdQT1NUJywgJHBhcmFtZXRlcnMpOwogICAg
JHRva2VuID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKCRyZXF1ZXN0KTsKICAgICR0
aGlzLT50b2tlbiA9IG5ldyBPQXV0aENvbnN1bWVyKCR0b2tlblsnb2F1dGhfdG9rZW4nXSwg
JHRva2VuWydvYXV0aF90b2tlbl9zZWNyZXQnXSk7CiAgICByZXR1cm4gJHRva2VuOwogIH0K
CiAgLyoqCiAgICogR0VUIHdyYXBwZXIgZm9yIG9BdXRoUmVxdWVzdC4KICAgKi8KICBmdW5j
dGlvbiBnZXQoJHVybCwgJHBhcmFtZXRlcnMgPSBhcnJheSgpKSB7CiAgICAkcmVzcG9uc2Ug
PSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR1cmwsICdHRVQnLCAkcGFyYW1ldGVycyk7CiAgICBp
ZiAoJHRoaXMtPmZvcm1hdCA9PT0gJ2pzb24nICYmICR0aGlzLT5kZWNvZGVfanNvbikgewog
ICAgICByZXR1cm4ganNvbl9kZWNvZGUoJHJlc3BvbnNlKTsKICAgIH0KICAgIHJldHVybiAk
cmVzcG9uc2U7CiAgfQoKICAvKioKICAgKiBQT1NUIHdyYXBwZXIgZm9yIG9BdXRoUmVxdWVz
dC4KICAgKi8KICBmdW5jdGlvbiBwb3N0KCR1cmwsICRwYXJhbWV0ZXJzID0gYXJyYXkoKSkg
ewogICAgJHJlc3BvbnNlID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdXJsLCAnUE9TVCcsICRw
YXJhbWV0ZXJzKTsKICAgIGlmICgkdGhpcy0+Zm9ybWF0ID09PSAnanNvbicgJiYgJHRoaXMt
PmRlY29kZV9qc29uKSB7CiAgICAgIHJldHVybiBqc29uX2RlY29kZSgkcmVzcG9uc2UpOwog
ICAgfQogICAgcmV0dXJuICRyZXNwb25zZTsKICB9CgogIC8qKgogICAqIERFTEVURSB3cmFw
cGVyIGZvciBvQXV0aFJlcWV1c3QuCiAgICovCiAgZnVuY3Rpb24gZGVsZXRlKCR1cmwsICRw
YXJhbWV0ZXJzID0gYXJyYXkoKSkgewogICAgJHJlc3BvbnNlID0gJHRoaXMtPm9BdXRoUmVx
dWVzdCgkdXJsLCAnREVMRVRFJywgJHBhcmFtZXRlcnMpOwogICAgaWYgKCR0aGlzLT5mb3Jt
YXQgPT09ICdqc29uJyAmJiAkdGhpcy0+ZGVjb2RlX2pzb24pIHsKICAgICAgcmV0dXJuIGpz
b25fZGVjb2RlKCRyZXNwb25zZSk7CiAgICB9CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0K
CiAgLyoqCiAgICogRm9ybWF0IGFuZCBzaWduIGFuIE9BdXRoIC8gQVBJIHJlcXVlc3QKICAg
Ki8KICBmdW5jdGlvbiBvQXV0aFJlcXVlc3QoJHVybCwgJG1ldGhvZCwgJHBhcmFtZXRlcnMp
IHsKICAgIGlmIChzdHJycG9zKCR1cmwsICdodHRwczovLycpICE9PSAwICYmIHN0cnJwb3Mo
JHVybCwgJ2h0dHA6Ly8nKSAhPT0gMCkgewogICAgICAkdXJsID0gInskdGhpcy0+aG9zdH17
JHVybH0ueyR0aGlzLT5mb3JtYXR9IjsKICAgIH0KICAgICRyZXF1ZXN0ID0gT0F1dGhSZXF1
ZXN0Ojpmcm9tX2NvbnN1bWVyX2FuZF90b2tlbigkdGhpcy0+Y29uc3VtZXIsICR0aGlzLT50
b2tlbiwgJG1ldGhvZCwgJHVybCwgJHBhcmFtZXRlcnMpOwogICAgJHJlcXVlc3QtPnNpZ25f
cmVxdWVzdCgkdGhpcy0+c2hhMV9tZXRob2QsICR0aGlzLT5jb25zdW1lciwgJHRoaXMtPnRv
a2VuKTsKICAgIHN3aXRjaCAoJG1ldGhvZCkgewogICAgY2FzZSAnR0VUJzoKICAgICAgcmV0
dXJuICR0aGlzLT5odHRwKCRyZXF1ZXN0LT50b191cmwoKSwgJ0dFVCcpOwogICAgZGVmYXVs
dDoKICAgICAgcmV0dXJuICR0aGlzLT5odHRwKCRyZXF1ZXN0LT5nZXRfbm9ybWFsaXplZF9o
dHRwX3VybCgpLCAkbWV0aG9kLCAkcmVxdWVzdC0+dG9fcG9zdGRhdGEoKSk7CiAgICB9CiAg
fQoKICAvKioKICAgKiBNYWtlIGFuIEhUVFAgcmVxdWVzdAogICAqCiAgICogQHJldHVybiBB
UEkgcmVzdWx0cwogICAqLwogIGZ1bmN0aW9uIGh0dHAoJHVybCwgJG1ldGhvZCwgJHBvc3Rm
aWVsZHMgPSBOVUxMKSB7CiAgICAkdGhpcy0+aHR0cF9pbmZvID0gYXJyYXkoKTsKICAgICRj
aSA9IGN1cmxfaW5pdCgpOwogICAgLyogQ3VybCBzZXR0aW5ncyAqLwogICAgY3VybF9zZXRv
cHQoJGNpLCBDVVJMT1BUX1VTRVJBR0VOVCwgJHRoaXMtPnVzZXJhZ2VudCk7CiAgICBjdXJs
X3NldG9wdCgkY2ksIENVUkxPUFRfQ09OTkVDVFRJTUVPVVQsICR0aGlzLT5jb25uZWN0dGlt
ZW91dCk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfVElNRU9VVCwgJHRoaXMtPnRp
bWVvdXQpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCBU
UlVFKTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9IVFRQSEVBREVSLCBhcnJheSgn
RXhwZWN0OicpKTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9TU0xfVkVSSUZZUEVF
UiwgJHRoaXMtPnNzbF92ZXJpZnlwZWVyKTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9Q
VF9IRUFERVJGVU5DVElPTiwgYXJyYXkoJHRoaXMsICdnZXRIZWFkZXInKSk7CiAgICBjdXJs
X3NldG9wdCgkY2ksIENVUkxPUFRfSEVBREVSLCBGQUxTRSk7CgogICAgc3dpdGNoICgkbWV0
aG9kKSB7CiAgICAgIGNhc2UgJ1BPU1QnOgogICAgICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VS
TE9QVF9QT1NULCBUUlVFKTsKICAgICAgICBpZiAoIWVtcHR5KCRwb3N0ZmllbGRzKSkgewog
ICAgICAgICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1BPU1RGSUVMRFMsICRwb3N0Zmll
bGRzKTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ0RFTEVURSc6CiAg
ICAgICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0NVU1RPTVJFUVVFU1QsICdERUxFVEUn
KTsKICAgICAgICBpZiAoIWVtcHR5KCRwb3N0ZmllbGRzKSkgewogICAgICAgICAgJHVybCA9
ICJ7JHVybH0/eyRwb3N0ZmllbGRzfSI7CiAgICAgICAgfQogICAgfQoKICAgIGN1cmxfc2V0
b3B0KCRjaSwgQ1VSTE9QVF9VUkwsICR1cmwpOwogICAgJHJlc3BvbnNlID0gY3VybF9leGVj
KCRjaSk7CiAgICAkdGhpcy0+aHR0cF9jb2RlID0gY3VybF9nZXRpbmZvKCRjaSwgQ1VSTElO
Rk9fSFRUUF9DT0RFKTsKICAgICR0aGlzLT5odHRwX2luZm8gPSBhcnJheV9tZXJnZSgkdGhp
cy0+aHR0cF9pbmZvLCBjdXJsX2dldGluZm8oJGNpKSk7CiAgICAkdGhpcy0+dXJsID0gJHVy
bDsKICAgIGN1cmxfY2xvc2UgKCRjaSk7CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAg
LyoqCiAgICogR2V0IHRoZSBoZWFkZXIgaW5mbyB0byBzdG9yZS4KICAgKi8KICBmdW5jdGlv
biBnZXRIZWFkZXIoJGNoLCAkaGVhZGVyKSB7CiAgICAkaSA9IHN0cnBvcygkaGVhZGVyLCAn
OicpOwogICAgaWYgKCFlbXB0eSgkaSkpIHsKICAgICAgJGtleSA9IHN0cl9yZXBsYWNlKCct
JywgJ18nLCBzdHJ0b2xvd2VyKHN1YnN0cigkaGVhZGVyLCAwLCAkaSkpKTsKICAgICAgJHZh
bHVlID0gdHJpbShzdWJzdHIoJGhlYWRlciwgJGkgKyAyKSk7CiAgICAgICR0aGlzLT5odHRw
X2hlYWRlclska2V5XSA9ICR2YWx1ZTsKICAgIH0KICAgIHJldHVybiBzdHJsZW4oJGhlYWRl
cik7CiAgfQp9CgpjbGFzcyBPQXV0aEV4Y2VwdGlvbiBleHRlbmRzIEV4Y2VwdGlvbiB7CiAg
Ly8gcGFzcwp9CgpjbGFzcyBPQXV0aENvbnN1bWVyIHsKICBwdWJsaWMgJGtleTsKICBwdWJs
aWMgJHNlY3JldDsKCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGtleSwgJHNlY3JldCwgJGNh
bGxiYWNrX3VybD1OVUxMKSB7CiAgICAkdGhpcy0+a2V5ID0gJGtleTsKICAgICR0aGlzLT5z
ZWNyZXQgPSAkc2VjcmV0OwogICAgJHRoaXMtPmNhbGxiYWNrX3VybCA9ICRjYWxsYmFja191
cmw7CiAgfQoKICBmdW5jdGlvbiBfX3RvU3RyaW5nKCkgewogICAgcmV0dXJuICJPQXV0aENv
bnN1bWVyW2tleT0kdGhpcy0+a2V5LHNlY3JldD0kdGhpcy0+c2VjcmV0XSI7CiAgfQp9Cgpj
bGFzcyBPQXV0aFRva2VuIHsKICAvLyBhY2Nlc3MgdG9rZW5zIGFuZCByZXF1ZXN0IHRva2Vu
cwogIHB1YmxpYyAka2V5OwogIHB1YmxpYyAkc2VjcmV0OwoKICAvKioKICAgKiBrZXkgPSB0
aGUgdG9rZW4KICAgKiBzZWNyZXQgPSB0aGUgdG9rZW4gc2VjcmV0CiAgICovCiAgZnVuY3Rp
b24gX19jb25zdHJ1Y3QoJGtleSwgJHNlY3JldCkgewogICAgJHRoaXMtPmtleSA9ICRrZXk7
CiAgICAkdGhpcy0+c2VjcmV0ID0gJHNlY3JldDsKICB9CgogIC8qKgogICAqIGdlbmVyYXRl
cyB0aGUgYmFzaWMgc3RyaW5nIHNlcmlhbGl6YXRpb24gb2YgYSB0b2tlbiB0aGF0IGEgc2Vy
dmVyCiAgICogd291bGQgcmVzcG9uZCB0byByZXF1ZXN0X3Rva2VuIGFuZCBhY2Nlc3NfdG9r
ZW4gY2FsbHMgd2l0aAogICAqLwogIGZ1bmN0aW9uIHRvX3N0cmluZygpIHsKICAgIHJldHVy
biAib2F1dGhfdG9rZW49IiAuCiAgICAgICAgICAgT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZj
Mzk4NigkdGhpcy0+a2V5KSAuCiAgICAgICAgICAgIiZvYXV0aF90b2tlbl9zZWNyZXQ9IiAu
CiAgICAgICAgICAgT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkdGhpcy0+c2VjcmV0
KTsKICB9CgogIGZ1bmN0aW9uIF9fdG9TdHJpbmcoKSB7CiAgICByZXR1cm4gJHRoaXMtPnRv
X3N0cmluZygpOwogIH0KfQoKLyoqCiAqIEEgY2xhc3MgZm9yIGltcGxlbWVudGluZyBhIFNp
Z25hdHVyZSBNZXRob2QKICogU2VlIHNlY3Rpb24gOSAoIlNpZ25pbmcgUmVxdWVzdHMiKSBp
biB0aGUgc3BlYwogKi8KYWJzdHJhY3QgY2xhc3MgT0F1dGhTaWduYXR1cmVNZXRob2Qgewog
IC8qKgogICAqIE5lZWRzIHRvIHJldHVybiB0aGUgbmFtZSBvZiB0aGUgU2lnbmF0dXJlIE1l
dGhvZCAoaWUgSE1BQy1TSEExKQogICAqIEByZXR1cm4gc3RyaW5nCiAgICovCiAgYWJzdHJh
Y3QgcHVibGljIGZ1bmN0aW9uIGdldF9uYW1lKCk7CgogIC8qKgogICAqIEJ1aWxkIHVwIHRo
ZSBzaWduYXR1cmUKICAgKiBOT1RFOiBUaGUgb3V0cHV0IG9mIHRoaXMgZnVuY3Rpb24gTVVT
VCBOT1QgYmUgdXJsZW5jb2RlZC4KICAgKiB0aGUgZW5jb2RpbmcgaXMgaGFuZGxlZCBpbiBP
QXV0aFJlcXVlc3Qgd2hlbiB0aGUgZmluYWwKICAgKiByZXF1ZXN0IGlzIHNlcmlhbGl6ZWQK
ICAgKiBAcGFyYW0gT0F1dGhSZXF1ZXN0ICRyZXF1ZXN0CiAgICogQHBhcmFtIE9BdXRoQ29u
c3VtZXIgJGNvbnN1bWVyCiAgICogQHBhcmFtIE9BdXRoVG9rZW4gJHRva2VuCiAgICogQHJl
dHVybiBzdHJpbmcKICAgKi8KICBhYnN0cmFjdCBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2ln
bmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7CgogIC8qKgogICAqIFZlcmlm
aWVzIHRoYXQgYSBnaXZlbiBzaWduYXR1cmUgaXMgY29ycmVjdAogICAqIEBwYXJhbSBPQXV0
aFJlcXVlc3QgJHJlcXVlc3QKICAgKiBAcGFyYW0gT0F1dGhDb25zdW1lciAkY29uc3VtZXIK
ICAgKiBAcGFyYW0gT0F1dGhUb2tlbiAkdG9rZW4KICAgKiBAcGFyYW0gc3RyaW5nICRzaWdu
YXR1cmUKICAgKiBAcmV0dXJuIGJvb2wKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gY2hlY2tf
c2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbiwgJHNpZ25hdHVyZSkgewog
ICAgJGJ1aWx0ID0gJHRoaXMtPmJ1aWxkX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVy
LCAkdG9rZW4pOwogICAgcmV0dXJuICRidWlsdCA9PSAkc2lnbmF0dXJlOwogIH0KfQoKLyoq
CiAqIFRoZSBITUFDLVNIQTEgc2lnbmF0dXJlIG1ldGhvZCB1c2VzIHRoZSBITUFDLVNIQTEg
c2lnbmF0dXJlIGFsZ29yaXRobSBhcyBkZWZpbmVkIGluIFtSRkMyMTA0XQogKiB3aGVyZSB0
aGUgU2lnbmF0dXJlIEJhc2UgU3RyaW5nIGlzIHRoZSB0ZXh0IGFuZCB0aGUga2V5IGlzIHRo
ZSBjb25jYXRlbmF0ZWQgdmFsdWVzIChlYWNoIGZpcnN0CiAqIGVuY29kZWQgcGVyIFBhcmFt
ZXRlciBFbmNvZGluZykgb2YgdGhlIENvbnN1bWVyIFNlY3JldCBhbmQgVG9rZW4gU2VjcmV0
LCBzZXBhcmF0ZWQgYnkgYW4gJyYnCiAqIGNoYXJhY3RlciAoQVNDSUkgY29kZSAzOCkgZXZl
biBpZiBlbXB0eS4KICogICAtIENoYXB0ZXIgOS4yICgiSE1BQy1TSEExIikKICovCmNsYXNz
IE9BdXRoU2lnbmF0dXJlTWV0aG9kX0hNQUNfU0hBMSBleHRlbmRzIE9BdXRoU2lnbmF0dXJl
TWV0aG9kIHsKICBmdW5jdGlvbiBnZXRfbmFtZSgpIHsKICAgIHJldHVybiAiSE1BQy1TSEEx
IjsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRj
b25zdW1lciwgJHRva2VuKSB7CiAgICAkYmFzZV9zdHJpbmcgPSAkcmVxdWVzdC0+Z2V0X3Np
Z25hdHVyZV9iYXNlX3N0cmluZygpOwogICAgJHJlcXVlc3QtPmJhc2Vfc3RyaW5nID0gJGJh
c2Vfc3RyaW5nOwoKICAgICRrZXlfcGFydHMgPSBhcnJheSgKICAgICAgJGNvbnN1bWVyLT5z
ZWNyZXQsCiAgICAgICgkdG9rZW4pID8gJHRva2VuLT5zZWNyZXQgOiAiIgogICAgKTsKCiAg
ICAka2V5X3BhcnRzID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4Nigka2V5X3BhcnRz
KTsKICAgICRrZXkgPSBpbXBsb2RlKCcmJywgJGtleV9wYXJ0cyk7CgogICAgcmV0dXJuIGJh
c2U2NF9lbmNvZGUoaGFzaF9obWFjKCdzaGExJywgJGJhc2Vfc3RyaW5nLCAka2V5LCB0cnVl
KSk7CiAgfQp9CgovKioKICogVGhlIFBMQUlOVEVYVCBtZXRob2QgZG9lcyBub3QgcHJvdmlk
ZSBhbnkgc2VjdXJpdHkgcHJvdGVjdGlvbiBhbmQgU0hPVUxEIG9ubHkgYmUgdXNlZAogKiBv
dmVyIGEgc2VjdXJlIGNoYW5uZWwgc3VjaCBhcyBIVFRQUy4gSXQgZG9lcyBub3QgdXNlIHRo
ZSBTaWduYXR1cmUgQmFzZSBTdHJpbmcuCiAqICAgLSBDaGFwdGVyIDkuNCAoIlBMQUlOVEVY
VCIpCiAqLwpjbGFzcyBPQXV0aFNpZ25hdHVyZU1ldGhvZF9QTEFJTlRFWFQgZXh0ZW5kcyBP
QXV0aFNpZ25hdHVyZU1ldGhvZCB7CiAgcHVibGljIGZ1bmN0aW9uIGdldF9uYW1lKCkgewog
ICAgcmV0dXJuICJQTEFJTlRFWFQiOwogIH0KCiAgLyoqCiAgICogb2F1dGhfc2lnbmF0dXJl
IGlzIHNldCB0byB0aGUgY29uY2F0ZW5hdGVkIGVuY29kZWQgdmFsdWVzIG9mIHRoZSBDb25z
dW1lciBTZWNyZXQgYW5kCiAgICogVG9rZW4gU2VjcmV0LCBzZXBhcmF0ZWQgYnkgYSAnJicg
Y2hhcmFjdGVyIChBU0NJSSBjb2RlIDM4KSwgZXZlbiBpZiBlaXRoZXIgc2VjcmV0IGlzCiAg
ICogZW1wdHkuIFRoZSByZXN1bHQgTVVTVCBiZSBlbmNvZGVkIGFnYWluLgogICAqICAgLSBD
aGFwdGVyIDkuNC4xICgiR2VuZXJhdGluZyBTaWduYXR1cmVzIikKICAgKgogICAqIFBsZWFz
ZSBub3RlIHRoYXQgdGhlIHNlY29uZCBlbmNvZGluZyBNVVNUIE5PVCBoYXBwZW4gaW4gdGhl
IFNpZ25hdHVyZU1ldGhvZCwgYXMKICAgKiBPQXV0aFJlcXVlc3QgaGFuZGxlcyB0aGlzIQog
ICAqLwogIHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25z
dW1lciwgJHRva2VuKSB7CiAgICAka2V5X3BhcnRzID0gYXJyYXkoCiAgICAgICRjb25zdW1l
ci0+c2VjcmV0LAogICAgICAoJHRva2VuKSA/ICR0b2tlbi0+c2VjcmV0IDogIiIKICAgICk7
CgogICAgJGtleV9wYXJ0cyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJGtleV9w
YXJ0cyk7CiAgICAka2V5ID0gaW1wbG9kZSgnJicsICRrZXlfcGFydHMpOwogICAgJHJlcXVl
c3QtPmJhc2Vfc3RyaW5nID0gJGtleTsKCiAgICByZXR1cm4gJGtleTsKICB9Cn0KCi8qKgog
KiBUaGUgUlNBLVNIQTEgc2lnbmF0dXJlIG1ldGhvZCB1c2VzIHRoZSBSU0FTU0EtUEtDUzEt
djFfNSBzaWduYXR1cmUgYWxnb3JpdGhtIGFzIGRlZmluZWQgaW4KICogW1JGQzM0NDddIHNl
Y3Rpb24gOC4yIChtb3JlIHNpbXBseSBrbm93biBhcyBQS0NTIzEpLCB1c2luZyBTSEEtMSBh
cyB0aGUgaGFzaCBmdW5jdGlvbiBmb3IKICogRU1TQS1QS0NTMS12MV81LiBJdCBpcyBhc3N1
bWVkIHRoYXQgdGhlIENvbnN1bWVyIGhhcyBwcm92aWRlZCBpdHMgUlNBIHB1YmxpYyBrZXkg
aW4gYQogKiB2ZXJpZmllZCB3YXkgdG8gdGhlIFNlcnZpY2UgUHJvdmlkZXIsIGluIGEgbWFu
bmVyIHdoaWNoIGlzIGJleW9uZCB0aGUgc2NvcGUgb2YgdGhpcwogKiBzcGVjaWZpY2F0aW9u
LgogKiAgIC0gQ2hhcHRlciA5LjMgKCJSU0EtU0hBMSIpCiAqLwphYnN0cmFjdCBjbGFzcyBP
QXV0aFNpZ25hdHVyZU1ldGhvZF9SU0FfU0hBMSBleHRlbmRzIE9BdXRoU2lnbmF0dXJlTWV0
aG9kIHsKICBwdWJsaWMgZnVuY3Rpb24gZ2V0X25hbWUoKSB7CiAgICByZXR1cm4gIlJTQS1T
SEExIjsKICB9CgogIC8vIFVwIHRvIHRoZSBTUCB0byBpbXBsZW1lbnQgdGhpcyBsb29rdXAg
b2Yga2V5cy4gUG9zc2libGUgaWRlYXMgYXJlOgogIC8vICgxKSBkbyBhIGxvb2t1cCBpbiBh
IHRhYmxlIG9mIHRydXN0ZWQgY2VydHMga2V5ZWQgb2ZmIG9mIGNvbnN1bWVyCiAgLy8gKDIp
IGZldGNoIHZpYSBodHRwIHVzaW5nIGEgdXJsIHByb3ZpZGVkIGJ5IHRoZSByZXF1ZXN0ZXIK
ICAvLyAoMykgc29tZSBzb3J0IG9mIHNwZWNpZmljIGRpc2NvdmVyeSBjb2RlIGJhc2VkIG9u
IHJlcXVlc3QKICAvLwogIC8vIEVpdGhlciB3YXkgc2hvdWxkIHJldHVybiBhIHN0cmluZyBy
ZXByZXNlbnRhdGlvbiBvZiB0aGUgY2VydGlmaWNhdGUKICBwcm90ZWN0ZWQgYWJzdHJhY3Qg
ZnVuY3Rpb24gZmV0Y2hfcHVibGljX2NlcnQoJiRyZXF1ZXN0KTsKCiAgLy8gVXAgdG8gdGhl
IFNQIHRvIGltcGxlbWVudCB0aGlzIGxvb2t1cCBvZiBrZXlzLiBQb3NzaWJsZSBpZGVhcyBh
cmU6CiAgLy8gKDEpIGRvIGEgbG9va3VwIGluIGEgdGFibGUgb2YgdHJ1c3RlZCBjZXJ0cyBr
ZXllZCBvZmYgb2YgY29uc3VtZXIKICAvLwogIC8vIEVpdGhlciB3YXkgc2hvdWxkIHJldHVy
biBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgY2VydGlmaWNhdGUKICBwcm90ZWN0
ZWQgYWJzdHJhY3QgZnVuY3Rpb24gZmV0Y2hfcHJpdmF0ZV9jZXJ0KCYkcmVxdWVzdCk7Cgog
IHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwg
JHRva2VuKSB7CiAgICAkYmFzZV9zdHJpbmcgPSAkcmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9i
YXNlX3N0cmluZygpOwogICAgJHJlcXVlc3QtPmJhc2Vfc3RyaW5nID0gJGJhc2Vfc3RyaW5n
OwoKICAgIC8vIEZldGNoIHRoZSBwcml2YXRlIGtleSBjZXJ0IGJhc2VkIG9uIHRoZSByZXF1
ZXN0CiAgICAkY2VydCA9ICR0aGlzLT5mZXRjaF9wcml2YXRlX2NlcnQoJHJlcXVlc3QpOwoK
ICAgIC8vIFB1bGwgdGhlIHByaXZhdGUga2V5IElEIGZyb20gdGhlIGNlcnRpZmljYXRlCiAg
ICAkcHJpdmF0ZWtleWlkID0gb3BlbnNzbF9nZXRfcHJpdmF0ZWtleSgkY2VydCk7CgogICAg
Ly8gU2lnbiB1c2luZyB0aGUga2V5CiAgICAkb2sgPSBvcGVuc3NsX3NpZ24oJGJhc2Vfc3Ry
aW5nLCAkc2lnbmF0dXJlLCAkcHJpdmF0ZWtleWlkKTsKCiAgICAvLyBSZWxlYXNlIHRoZSBr
ZXkgcmVzb3VyY2UKICAgIG9wZW5zc2xfZnJlZV9rZXkoJHByaXZhdGVrZXlpZCk7CgogICAg
cmV0dXJuIGJhc2U2NF9lbmNvZGUoJHNpZ25hdHVyZSk7CiAgfQoKICBwdWJsaWMgZnVuY3Rp
b24gY2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbiwgJHNpZ25h
dHVyZSkgewogICAgJGRlY29kZWRfc2lnID0gYmFzZTY0X2RlY29kZSgkc2lnbmF0dXJlKTsK
CiAgICAkYmFzZV9zdHJpbmcgPSAkcmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmlu
ZygpOwoKICAgIC8vIEZldGNoIHRoZSBwdWJsaWMga2V5IGNlcnQgYmFzZWQgb24gdGhlIHJl
cXVlc3QKICAgICRjZXJ0ID0gJHRoaXMtPmZldGNoX3B1YmxpY19jZXJ0KCRyZXF1ZXN0KTsK
CiAgICAvLyBQdWxsIHRoZSBwdWJsaWMga2V5IElEIGZyb20gdGhlIGNlcnRpZmljYXRlCiAg
ICAkcHVibGlja2V5aWQgPSBvcGVuc3NsX2dldF9wdWJsaWNrZXkoJGNlcnQpOwoKICAgIC8v
IENoZWNrIHRoZSBjb21wdXRlZCBzaWduYXR1cmUgYWdhaW5zdCB0aGUgb25lIHBhc3NlZCBp
biB0aGUgcXVlcnkKICAgICRvayA9IG9wZW5zc2xfdmVyaWZ5KCRiYXNlX3N0cmluZywgJGRl
Y29kZWRfc2lnLCAkcHVibGlja2V5aWQpOwoKICAgIC8vIFJlbGVhc2UgdGhlIGtleSByZXNv
dXJjZQogICAgb3BlbnNzbF9mcmVlX2tleSgkcHVibGlja2V5aWQpOwoKICAgIHJldHVybiAk
b2sgPT0gMTsKICB9Cn0KCmNsYXNzIE9BdXRoUmVxdWVzdCB7CiAgcHJpdmF0ZSAkcGFyYW1l
dGVyczsKICBwcml2YXRlICRodHRwX21ldGhvZDsKICBwcml2YXRlICRodHRwX3VybDsKICAv
LyBmb3IgZGVidWcgcHVycG9zZXMKICBwdWJsaWMgJGJhc2Vfc3RyaW5nOwogIHB1YmxpYyBz
dGF0aWMgJHZlcnNpb24gPSAnMS4wJzsKICBwdWJsaWMgc3RhdGljICRQT1NUX0lOUFVUID0g
J3BocDovL2lucHV0JzsKCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGh0dHBfbWV0aG9kLCAk
aHR0cF91cmwsICRwYXJhbWV0ZXJzPU5VTEwpIHsKICAgIEAkcGFyYW1ldGVycyBvciAkcGFy
YW1ldGVycyA9IGFycmF5KCk7CiAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCBPQXV0
aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMocGFyc2VfdXJsKCRodHRwX3VybCwgUEhQX1VSTF9R
VUVSWSkpLCAkcGFyYW1ldGVycyk7CiAgICAkdGhpcy0+cGFyYW1ldGVycyA9ICRwYXJhbWV0
ZXJzOwogICAgJHRoaXMtPmh0dHBfbWV0aG9kID0gJGh0dHBfbWV0aG9kOwogICAgJHRoaXMt
Pmh0dHBfdXJsID0gJGh0dHBfdXJsOwogIH0KCgogIC8qKgogICAqIGF0dGVtcHQgdG8gYnVp
bGQgdXAgYSByZXF1ZXN0IGZyb20gd2hhdCB3YXMgcGFzc2VkIHRvIHRoZSBzZXJ2ZXIKICAg
Ki8KICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGZyb21fcmVxdWVzdCgkaHR0cF9tZXRob2Q9
TlVMTCwgJGh0dHBfdXJsPU5VTEwsICRwYXJhbWV0ZXJzPU5VTEwpIHsKICAgICRzY2hlbWUg
PSAoIWlzc2V0KCRfU0VSVkVSWydIVFRQUyddKSB8fCAkX1NFUlZFUlsnSFRUUFMnXSAhPSAi
b24iKQogICAgICAgICAgICAgID8gJ2h0dHAnCiAgICAgICAgICAgICAgOiAnaHR0cHMnOwog
ICAgQCRodHRwX3VybCBvciAkaHR0cF91cmwgPSAkc2NoZW1lIC4KICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgJzovLycgLiAkX1NFUlZFUlsnSFRUUF9IT1NUJ10gLgogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAnOicgLgogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAkX1NFUlZFUlsnU0VSVkVSX1BPUlQnXSAuCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICRfU0VSVkVSWydSRVFVRVNUX1VSSSddOwogICAgQCRodHRwX21ldGhvZCBvciAk
aHR0cF9tZXRob2QgPSAkX1NFUlZFUlsnUkVRVUVTVF9NRVRIT0QnXTsKCiAgICAvLyBXZSB3
ZXJlbid0IGhhbmRlZCBhbnkgcGFyYW1ldGVycywgc28gbGV0J3MgZmluZCB0aGUgb25lcyBy
ZWxldmFudCB0bwogICAgLy8gdGhpcyByZXF1ZXN0LgogICAgLy8gSWYgeW91IHJ1biBYTUwt
UlBDIG9yIHNpbWlsYXIgeW91IHNob3VsZCB1c2UgdGhpcyB0byBwcm92aWRlIHlvdXIgb3du
CiAgICAvLyBwYXJzZWQgcGFyYW1ldGVyLWxpc3QKICAgIGlmICghJHBhcmFtZXRlcnMpIHsK
ICAgICAgLy8gRmluZCByZXF1ZXN0IGhlYWRlcnMKICAgICAgJHJlcXVlc3RfaGVhZGVycyA9
IE9BdXRoVXRpbDo6Z2V0X2hlYWRlcnMoKTsKCiAgICAgIC8vIFBhcnNlIHRoZSBxdWVyeS1z
dHJpbmcgdG8gZmluZCBHRVQgcGFyYW1ldGVycwogICAgICAkcGFyYW1ldGVycyA9IE9BdXRo
VXRpbDo6cGFyc2VfcGFyYW1ldGVycygkX1NFUlZFUlsnUVVFUllfU1RSSU5HJ10pOwoKICAg
ICAgLy8gSXQncyBhIFBPU1QgcmVxdWVzdCBvZiB0aGUgcHJvcGVyIGNvbnRlbnQtdHlwZSwg
c28gcGFyc2UgUE9TVAogICAgICAvLyBwYXJhbWV0ZXJzIGFuZCBhZGQgdGhvc2Ugb3ZlcnJp
ZGluZyBhbnkgZHVwbGljYXRlcyBmcm9tIEdFVAogICAgICBpZiAoJGh0dHBfbWV0aG9kID09
ICJQT1NUIgogICAgICAgICAgJiYgQHN0cnN0cigkcmVxdWVzdF9oZWFkZXJzWyJDb250ZW50
LVR5cGUiXSwKICAgICAgICAgICAgICAgICAgICAgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0t
dXJsZW5jb2RlZCIpCiAgICAgICAgICApIHsKICAgICAgICAkcG9zdF9kYXRhID0gT0F1dGhV
dGlsOjpwYXJzZV9wYXJhbWV0ZXJzKAogICAgICAgICAgZmlsZV9nZXRfY29udGVudHMoc2Vs
Zjo6JFBPU1RfSU5QVVQpCiAgICAgICAgKTsKICAgICAgICAkcGFyYW1ldGVycyA9IGFycmF5
X21lcmdlKCRwYXJhbWV0ZXJzLCAkcG9zdF9kYXRhKTsKICAgICAgfQoKICAgICAgLy8gV2Ug
aGF2ZSBhIEF1dGhvcml6YXRpb24taGVhZGVyIHdpdGggT0F1dGggZGF0YS4gUGFyc2UgdGhl
IGhlYWRlcgogICAgICAvLyBhbmQgYWRkIHRob3NlIG92ZXJyaWRpbmcgYW55IGR1cGxpY2F0
ZXMgZnJvbSBHRVQgb3IgUE9TVAogICAgICBpZiAoQHN1YnN0cigkcmVxdWVzdF9oZWFkZXJz
WydBdXRob3JpemF0aW9uJ10sIDAsIDYpID09ICJPQXV0aCAiKSB7CiAgICAgICAgJGhlYWRl
cl9wYXJhbWV0ZXJzID0gT0F1dGhVdGlsOjpzcGxpdF9oZWFkZXIoCiAgICAgICAgICAkcmVx
dWVzdF9oZWFkZXJzWydBdXRob3JpemF0aW9uJ10KICAgICAgICApOwogICAgICAgICRwYXJh
bWV0ZXJzID0gYXJyYXlfbWVyZ2UoJHBhcmFtZXRlcnMsICRoZWFkZXJfcGFyYW1ldGVycyk7
CiAgICAgIH0KCiAgICB9CgogICAgcmV0dXJuIG5ldyBPQXV0aFJlcXVlc3QoJGh0dHBfbWV0
aG9kLCAkaHR0cF91cmwsICRwYXJhbWV0ZXJzKTsKICB9CgogIC8qKgogICAqIHByZXR0eSBt
dWNoIGEgaGVscGVyIGZ1bmN0aW9uIHRvIHNldCB1cCB0aGUgcmVxdWVzdAogICAqLwogIHB1
YmxpYyBzdGF0aWMgZnVuY3Rpb24gZnJvbV9jb25zdW1lcl9hbmRfdG9rZW4oJGNvbnN1bWVy
LCAkdG9rZW4sICRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVycz1OVUxMKSB7
CiAgICBAJHBhcmFtZXRlcnMgb3IgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgJGRlZmF1
bHRzID0gYXJyYXkoIm9hdXRoX3ZlcnNpb24iID0+IE9BdXRoUmVxdWVzdDo6JHZlcnNpb24s
CiAgICAgICAgICAgICAgICAgICAgICAib2F1dGhfbm9uY2UiID0+IE9BdXRoUmVxdWVzdDo6
Z2VuZXJhdGVfbm9uY2UoKSwKICAgICAgICAgICAgICAgICAgICAgICJvYXV0aF90aW1lc3Rh
bXAiID0+IE9BdXRoUmVxdWVzdDo6Z2VuZXJhdGVfdGltZXN0YW1wKCksCiAgICAgICAgICAg
ICAgICAgICAgICAib2F1dGhfY29uc3VtZXJfa2V5IiA9PiAkY29uc3VtZXItPmtleSk7CiAg
ICBpZiAoJHRva2VuKQogICAgICAkZGVmYXVsdHNbJ29hdXRoX3Rva2VuJ10gPSAkdG9rZW4t
PmtleTsKCiAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCRkZWZhdWx0cywgJHBhcmFt
ZXRlcnMpOwoKICAgIHJldHVybiBuZXcgT0F1dGhSZXF1ZXN0KCRodHRwX21ldGhvZCwgJGh0
dHBfdXJsLCAkcGFyYW1ldGVycyk7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gc2V0X3BhcmFt
ZXRlcigkbmFtZSwgJHZhbHVlLCAkYWxsb3dfZHVwbGljYXRlcyA9IHRydWUpIHsKICAgIGlm
ICgkYWxsb3dfZHVwbGljYXRlcyAmJiBpc3NldCgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0p
KSB7CiAgICAgIC8vIFdlIGhhdmUgYWxyZWFkeSBhZGRlZCBwYXJhbWV0ZXIocykgd2l0aCB0
aGlzIG5hbWUsIHNvIGFkZCB0byB0aGUgbGlzdAogICAgICBpZiAoaXNfc2NhbGFyKCR0aGlz
LT5wYXJhbWV0ZXJzWyRuYW1lXSkpIHsKICAgICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCBk
dXBsaWNhdGUsIHNvIHRyYW5zZm9ybSBzY2FsYXIgKHN0cmluZykKICAgICAgICAvLyBpbnRv
IGFuIGFycmF5IHNvIHdlIGNhbiBhZGQgdGhlIGR1cGxpY2F0ZXMKICAgICAgICAkdGhpcy0+
cGFyYW1ldGVyc1skbmFtZV0gPSBhcnJheSgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pOwog
ICAgICB9CgogICAgICAkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV1bXSA9ICR2YWx1ZTsKICAg
IH0gZWxzZSB7CiAgICAgICR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSA9ICR2YWx1ZTsKICAg
IH0KICB9CgogIHB1YmxpYyBmdW5jdGlvbiBnZXRfcGFyYW1ldGVyKCRuYW1lKSB7CiAgICBy
ZXR1cm4gaXNzZXQoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdKSA/ICR0aGlzLT5wYXJhbWV0
ZXJzWyRuYW1lXSA6IG51bGw7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gZ2V0X3BhcmFtZXRl
cnMoKSB7CiAgICByZXR1cm4gJHRoaXMtPnBhcmFtZXRlcnM7CiAgfQoKICBwdWJsaWMgZnVu
Y3Rpb24gdW5zZXRfcGFyYW1ldGVyKCRuYW1lKSB7CiAgICB1bnNldCgkdGhpcy0+cGFyYW1l
dGVyc1skbmFtZV0pOwogIH0KCiAgLyoqCiAgICogVGhlIHJlcXVlc3QgcGFyYW1ldGVycywg
c29ydGVkIGFuZCBjb25jYXRlbmF0ZWQgaW50byBhIG5vcm1hbGl6ZWQgc3RyaW5nLgogICAq
IEByZXR1cm4gc3RyaW5nCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGdldF9zaWduYWJsZV9w
YXJhbWV0ZXJzKCkgewogICAgLy8gR3JhYiBhbGwgcGFyYW1ldGVycwogICAgJHBhcmFtcyA9
ICR0aGlzLT5wYXJhbWV0ZXJzOwoKICAgIC8vIFJlbW92ZSBvYXV0aF9zaWduYXR1cmUgaWYg
cHJlc2VudAogICAgLy8gUmVmOiBTcGVjOiA5LjEuMSAoIlRoZSBvYXV0aF9zaWduYXR1cmUg
cGFyYW1ldGVyIE1VU1QgYmUgZXhjbHVkZWQuIikKICAgIGlmIChpc3NldCgkcGFyYW1zWydv
YXV0aF9zaWduYXR1cmUnXSkpIHsKICAgICAgdW5zZXQoJHBhcmFtc1snb2F1dGhfc2lnbmF0
dXJlJ10pOwogICAgfQoKICAgIHJldHVybiBPQXV0aFV0aWw6OmJ1aWxkX2h0dHBfcXVlcnko
JHBhcmFtcyk7CiAgfQoKICAvKioKICAgKiBSZXR1cm5zIHRoZSBiYXNlIHN0cmluZyBvZiB0
aGlzIHJlcXVlc3QKICAgKgogICAqIFRoZSBiYXNlIHN0cmluZyBkZWZpbmVkIGFzIHRoZSBt
ZXRob2QsIHRoZSB1cmwKICAgKiBhbmQgdGhlIHBhcmFtZXRlcnMgKG5vcm1hbGl6ZWQpLCBl
YWNoIHVybGVuY29kZWQKICAgKiBhbmQgdGhlIGNvbmNhdGVkIHdpdGggJi4KICAgKi8KICBw
dWJsaWMgZnVuY3Rpb24gZ2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpIHsKICAgICRwYXJ0
cyA9IGFycmF5KAogICAgICAkdGhpcy0+Z2V0X25vcm1hbGl6ZWRfaHR0cF9tZXRob2QoKSwK
ICAgICAgJHRoaXMtPmdldF9ub3JtYWxpemVkX2h0dHBfdXJsKCksCiAgICAgICR0aGlzLT5n
ZXRfc2lnbmFibGVfcGFyYW1ldGVycygpCiAgICApOwoKICAgICRwYXJ0cyA9IE9BdXRoVXRp
bDo6dXJsZW5jb2RlX3JmYzM5ODYoJHBhcnRzKTsKCiAgICByZXR1cm4gaW1wbG9kZSgnJics
ICRwYXJ0cyk7CiAgfQoKICAvKioKICAgKiBqdXN0IHVwcGVyY2FzZXMgdGhlIGh0dHAgbWV0
aG9kCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGdldF9ub3JtYWxpemVkX2h0dHBfbWV0aG9k
KCkgewogICAgcmV0dXJuIHN0cnRvdXBwZXIoJHRoaXMtPmh0dHBfbWV0aG9kKTsKICB9Cgog
IC8qKgogICAqIHBhcnNlcyB0aGUgdXJsIGFuZCByZWJ1aWxkcyBpdCB0byBiZQogICAqIHNj
aGVtZTovL2hvc3QvcGF0aAogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBnZXRfbm9ybWFsaXpl
ZF9odHRwX3VybCgpIHsKICAgICRwYXJ0cyA9IHBhcnNlX3VybCgkdGhpcy0+aHR0cF91cmwp
OwoKICAgICRwb3J0ID0gQCRwYXJ0c1sncG9ydCddOwogICAgJHNjaGVtZSA9ICRwYXJ0c1sn
c2NoZW1lJ107CiAgICAkaG9zdCA9ICRwYXJ0c1snaG9zdCddOwogICAgJHBhdGggPSBAJHBh
cnRzWydwYXRoJ107CgogICAgJHBvcnQgb3IgJHBvcnQgPSAoJHNjaGVtZSA9PSAnaHR0cHMn
KSA/ICc0NDMnIDogJzgwJzsKCiAgICBpZiAoKCRzY2hlbWUgPT0gJ2h0dHBzJyAmJiAkcG9y
dCAhPSAnNDQzJykKICAgICAgICB8fCAoJHNjaGVtZSA9PSAnaHR0cCcgJiYgJHBvcnQgIT0g
JzgwJykpIHsKICAgICAgJGhvc3QgPSAiJGhvc3Q6JHBvcnQiOwogICAgfQogICAgcmV0dXJu
ICIkc2NoZW1lOi8vJGhvc3QkcGF0aCI7CiAgfQoKICAvKioKICAgKiBidWlsZHMgYSB1cmwg
dXNhYmxlIGZvciBhIEdFVCByZXF1ZXN0CiAgICovCiAgcHVibGljIGZ1bmN0aW9uIHRvX3Vy
bCgpIHsKICAgICRwb3N0X2RhdGEgPSAkdGhpcy0+dG9fcG9zdGRhdGEoKTsKICAgICRvdXQg
PSAkdGhpcy0+Z2V0X25vcm1hbGl6ZWRfaHR0cF91cmwoKTsKICAgIGlmICgkcG9zdF9kYXRh
KSB7CiAgICAgICRvdXQgLj0gJz8nLiRwb3N0X2RhdGE7CiAgICB9CiAgICByZXR1cm4gJG91
dDsKICB9CgogIC8qKgogICAqIGJ1aWxkcyB0aGUgZGF0YSBvbmUgd291bGQgc2VuZCBpbiBh
IFBPU1QgcmVxdWVzdAogICAqLwogIHB1YmxpYyBmdW5jdGlvbiB0b19wb3N0ZGF0YSgpIHsK
ICAgIHJldHVybiBPQXV0aFV0aWw6OmJ1aWxkX2h0dHBfcXVlcnkoJHRoaXMtPnBhcmFtZXRl
cnMpOwogIH0KCiAgLyoqCiAgICogYnVpbGRzIHRoZSBBdXRob3JpemF0aW9uOiBoZWFkZXIK
ICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gdG9faGVhZGVyKCRyZWFsbT1udWxsKSB7CiAgICAk
Zmlyc3QgPSB0cnVlOwogIGlmKCRyZWFsbSkgewogICAgICAkb3V0ID0gJ0F1dGhvcml6YXRp
b246IE9BdXRoIHJlYWxtPSInIC4gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkcmVh
bG0pIC4gJyInOwogICAgICAkZmlyc3QgPSBmYWxzZTsKICAgIH0gZWxzZQogICAgICAkb3V0
ID0gJ0F1dGhvcml6YXRpb246IE9BdXRoJzsKCiAgICAkdG90YWwgPSBhcnJheSgpOwogICAg
Zm9yZWFjaCAoJHRoaXMtPnBhcmFtZXRlcnMgYXMgJGsgPT4gJHYpIHsKICAgICAgaWYgKHN1
YnN0cigkaywgMCwgNSkgIT0gIm9hdXRoIikgY29udGludWU7CiAgICAgIGlmIChpc19hcnJh
eSgkdikpIHsKICAgICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oJ0FycmF5cyBub3Qg
c3VwcG9ydGVkIGluIGhlYWRlcnMnKTsKICAgICAgfQogICAgICAkb3V0IC49ICgkZmlyc3Qp
ID8gJyAnIDogJywnOwogICAgICAkb3V0IC49IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5
ODYoJGspIC4KICAgICAgICAgICAgICAnPSInIC4KICAgICAgICAgICAgICBPQXV0aFV0aWw6
OnVybGVuY29kZV9yZmMzOTg2KCR2KSAuCiAgICAgICAgICAgICAgJyInOwogICAgICAkZmly
c3QgPSBmYWxzZTsKICAgIH0KICAgIHJldHVybiAkb3V0OwogIH0KCiAgcHVibGljIGZ1bmN0
aW9uIF9fdG9TdHJpbmcoKSB7CiAgICByZXR1cm4gJHRoaXMtPnRvX3VybCgpOwogIH0KCgog
IHB1YmxpYyBmdW5jdGlvbiBzaWduX3JlcXVlc3QoJHNpZ25hdHVyZV9tZXRob2QsICRjb25z
dW1lciwgJHRva2VuKSB7CiAgICAkdGhpcy0+c2V0X3BhcmFtZXRlcigKICAgICAgIm9hdXRo
X3NpZ25hdHVyZV9tZXRob2QiLAogICAgICAkc2lnbmF0dXJlX21ldGhvZC0+Z2V0X25hbWUo
KSwKICAgICAgZmFsc2UKICAgICk7CiAgICAkc2lnbmF0dXJlID0gJHRoaXMtPmJ1aWxkX3Np
Z25hdHVyZSgkc2lnbmF0dXJlX21ldGhvZCwgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAgJHRo
aXMtPnNldF9wYXJhbWV0ZXIoIm9hdXRoX3NpZ25hdHVyZSIsICRzaWduYXR1cmUsIGZhbHNl
KTsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHNpZ25hdHVyZV9t
ZXRob2QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAkc2lnbmF0dXJlID0gJHNpZ25hdHVy
ZV9tZXRob2QtPmJ1aWxkX3NpZ25hdHVyZSgkdGhpcywgJGNvbnN1bWVyLCAkdG9rZW4pOwog
ICAgcmV0dXJuICRzaWduYXR1cmU7CiAgfQoKICAvKioKICAgKiB1dGlsIGZ1bmN0aW9uOiBj
dXJyZW50IHRpbWVzdGFtcAogICAqLwogIHByaXZhdGUgc3RhdGljIGZ1bmN0aW9uIGdlbmVy
YXRlX3RpbWVzdGFtcCgpIHsKICAgIHJldHVybiB0aW1lKCk7CiAgfQoKICAvKioKICAgKiB1
dGlsIGZ1bmN0aW9uOiBjdXJyZW50IG5vbmNlCiAgICovCiAgcHJpdmF0ZSBzdGF0aWMgZnVu
Y3Rpb24gZ2VuZXJhdGVfbm9uY2UoKSB7CiAgICAkbXQgPSBtaWNyb3RpbWUoKTsKICAgICRy
YW5kID0gbXRfcmFuZCgpOwoKICAgIHJldHVybiBtZDUoJG10IC4gJHJhbmQpOyAvLyBtZDVz
IGxvb2sgbmljZXIgdGhhbiBudW1iZXJzCiAgfQp9CgpjbGFzcyBPQXV0aFNlcnZlciB7CiAg
cHJvdGVjdGVkICR0aW1lc3RhbXBfdGhyZXNob2xkID0gMzAwOyAvLyBpbiBzZWNvbmRzLCBm
aXZlIG1pbnV0ZXMKICBwcm90ZWN0ZWQgJHZlcnNpb24gPSAnMS4wJzsgICAgICAgICAgICAg
Ly8gaGkgYmxhaW5lCiAgcHJvdGVjdGVkICRzaWduYXR1cmVfbWV0aG9kcyA9IGFycmF5KCk7
CgogIHByb3RlY3RlZCAkZGF0YV9zdG9yZTsKCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGRh
dGFfc3RvcmUpIHsKICAgICR0aGlzLT5kYXRhX3N0b3JlID0gJGRhdGFfc3RvcmU7CiAgfQoK
ICBwdWJsaWMgZnVuY3Rpb24gYWRkX3NpZ25hdHVyZV9tZXRob2QoJHNpZ25hdHVyZV9tZXRo
b2QpIHsKICAgICR0aGlzLT5zaWduYXR1cmVfbWV0aG9kc1skc2lnbmF0dXJlX21ldGhvZC0+
Z2V0X25hbWUoKV0gPQogICAgICAkc2lnbmF0dXJlX21ldGhvZDsKICB9CgogIC8vIGhpZ2gg
bGV2ZWwgZnVuY3Rpb25zCgogIC8qKgogICAqIHByb2Nlc3MgYSByZXF1ZXN0X3Rva2VuIHJl
cXVlc3QKICAgKiByZXR1cm5zIHRoZSByZXF1ZXN0IHRva2VuIG9uIHN1Y2Nlc3MKICAgKi8K
ICBwdWJsaWMgZnVuY3Rpb24gZmV0Y2hfcmVxdWVzdF90b2tlbigmJHJlcXVlc3QpIHsKICAg
ICR0aGlzLT5nZXRfdmVyc2lvbigkcmVxdWVzdCk7CgogICAgJGNvbnN1bWVyID0gJHRoaXMt
PmdldF9jb25zdW1lcigkcmVxdWVzdCk7CgogICAgLy8gbm8gdG9rZW4gcmVxdWlyZWQgZm9y
IHRoZSBpbml0aWFsIHRva2VuIHJlcXVlc3QKICAgICR0b2tlbiA9IE5VTEw7CgogICAgJHRo
aXMtPmNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwoKICAg
IC8vIFJldiBBIGNoYW5nZQogICAgJGNhbGxiYWNrID0gJHJlcXVlc3QtPmdldF9wYXJhbWV0
ZXIoJ29hdXRoX2NhbGxiYWNrJyk7CiAgICAkbmV3X3Rva2VuID0gJHRoaXMtPmRhdGFfc3Rv
cmUtPm5ld19yZXF1ZXN0X3Rva2VuKCRjb25zdW1lciwgJGNhbGxiYWNrKTsKCiAgICByZXR1
cm4gJG5ld190b2tlbjsKICB9CgogIC8qKgogICAqIHByb2Nlc3MgYW4gYWNjZXNzX3Rva2Vu
IHJlcXVlc3QKICAgKiByZXR1cm5zIHRoZSBhY2Nlc3MgdG9rZW4gb24gc3VjY2VzcwogICAq
LwogIHB1YmxpYyBmdW5jdGlvbiBmZXRjaF9hY2Nlc3NfdG9rZW4oJiRyZXF1ZXN0KSB7CiAg
ICAkdGhpcy0+Z2V0X3ZlcnNpb24oJHJlcXVlc3QpOwoKICAgICRjb25zdW1lciA9ICR0aGlz
LT5nZXRfY29uc3VtZXIoJHJlcXVlc3QpOwoKICAgIC8vIHJlcXVpcmVzIGF1dGhvcml6ZWQg
cmVxdWVzdCB0b2tlbgogICAgJHRva2VuID0gJHRoaXMtPmdldF90b2tlbigkcmVxdWVzdCwg
JGNvbnN1bWVyLCAicmVxdWVzdCIpOwoKICAgICR0aGlzLT5jaGVja19zaWduYXR1cmUoJHJl
cXVlc3QsICRjb25zdW1lciwgJHRva2VuKTsKCiAgICAvLyBSZXYgQSBjaGFuZ2UKICAgICR2
ZXJpZmllciA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF92ZXJpZmllcicpOwog
ICAgJG5ld190b2tlbiA9ICR0aGlzLT5kYXRhX3N0b3JlLT5uZXdfYWNjZXNzX3Rva2VuKCR0
b2tlbiwgJGNvbnN1bWVyLCAkdmVyaWZpZXIpOwoKICAgIHJldHVybiAkbmV3X3Rva2VuOwog
IH0KCiAgLyoqCiAgICogdmVyaWZ5IGFuIGFwaSBjYWxsLCBjaGVja3MgYWxsIHRoZSBwYXJh
bWV0ZXJzCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIHZlcmlmeV9yZXF1ZXN0KCYkcmVxdWVz
dCkgewogICAgJHRoaXMtPmdldF92ZXJzaW9uKCRyZXF1ZXN0KTsKICAgICRjb25zdW1lciA9
ICR0aGlzLT5nZXRfY29uc3VtZXIoJHJlcXVlc3QpOwogICAgJHRva2VuID0gJHRoaXMtPmdl
dF90b2tlbigkcmVxdWVzdCwgJGNvbnN1bWVyLCAiYWNjZXNzIik7CiAgICAkdGhpcy0+Y2hl
Y2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7CiAgICByZXR1cm4g
YXJyYXkoJGNvbnN1bWVyLCAkdG9rZW4pOwogIH0KCiAgLy8gSW50ZXJuYWxzIGZyb20gaGVy
ZQogIC8qKgogICAqIHZlcnNpb24gMQogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X3Zl
cnNpb24oJiRyZXF1ZXN0KSB7CiAgICAkdmVyc2lvbiA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1l
dGVyKCJvYXV0aF92ZXJzaW9uIik7CiAgICBpZiAoISR2ZXJzaW9uKSB7CiAgICAgIC8vIFNl
cnZpY2UgUHJvdmlkZXJzIE1VU1QgYXNzdW1lIHRoZSBwcm90b2NvbCB2ZXJzaW9uIHRvIGJl
IDEuMCBpZiB0aGlzIHBhcmFtZXRlciBpcyBub3QgcHJlc2VudC4KICAgICAgLy8gQ2hhcHRl
ciA3LjAgKCJBY2Nlc3NpbmcgUHJvdGVjdGVkIFJlc3NvdXJjZXMiKQogICAgICAkdmVyc2lv
biA9ICcxLjAnOwogICAgfQogICAgaWYgKCR2ZXJzaW9uICE9PSAkdGhpcy0+dmVyc2lvbikg
ewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIk9BdXRoIHZlcnNpb24gJyR2ZXJz
aW9uJyBub3Qgc3VwcG9ydGVkIik7CiAgICB9CiAgICByZXR1cm4gJHZlcnNpb247CiAgfQoK
ICAvKioKICAgKiBmaWd1cmUgb3V0IHRoZSBzaWduYXR1cmUgd2l0aCBzb21lIGRlZmF1bHRz
CiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBnZXRfc2lnbmF0dXJlX21ldGhvZCgmJHJlcXVl
c3QpIHsKICAgICRzaWduYXR1cmVfbWV0aG9kID0KICAgICAgICBAJHJlcXVlc3QtPmdldF9w
YXJhbWV0ZXIoIm9hdXRoX3NpZ25hdHVyZV9tZXRob2QiKTsKCiAgICBpZiAoISRzaWduYXR1
cmVfbWV0aG9kKSB7CiAgICAgIC8vIEFjY29yZGluZyB0byBjaGFwdGVyIDcgKCJBY2Nlc3Np
bmcgUHJvdGVjdGVkIFJlc3NvdXJjZXMiKSB0aGUgc2lnbmF0dXJlLW1ldGhvZAogICAgICAv
LyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQsIGFuZCB3ZSBjYW4ndCBqdXN0IGZhbGxiYWNrIHRv
IFBMQUlOVEVYVAogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oJ05vIHNpZ25hdHVy
ZSBtZXRob2QgcGFyYW1ldGVyLiBUaGlzIHBhcmFtZXRlciBpcyByZXF1aXJlZCcpOwogICAg
fQoKICAgIGlmICghaW5fYXJyYXkoJHNpZ25hdHVyZV9tZXRob2QsCiAgICAgICAgICAgICAg
ICAgIGFycmF5X2tleXMoJHRoaXMtPnNpZ25hdHVyZV9tZXRob2RzKSkpIHsKICAgICAgdGhy
b3cgbmV3IE9BdXRoRXhjZXB0aW9uKAogICAgICAgICJTaWduYXR1cmUgbWV0aG9kICckc2ln
bmF0dXJlX21ldGhvZCcgbm90IHN1cHBvcnRlZCAiIC4KICAgICAgICAidHJ5IG9uZSBvZiB0
aGUgZm9sbG93aW5nOiAiIC4KICAgICAgICBpbXBsb2RlKCIsICIsIGFycmF5X2tleXMoJHRo
aXMtPnNpZ25hdHVyZV9tZXRob2RzKSkKICAgICAgKTsKICAgIH0KICAgIHJldHVybiAkdGhp
cy0+c2lnbmF0dXJlX21ldGhvZHNbJHNpZ25hdHVyZV9tZXRob2RdOwogIH0KCiAgLyoqCiAg
ICogdHJ5IHRvIGZpbmQgdGhlIGNvbnN1bWVyIGZvciB0aGUgcHJvdmlkZWQgcmVxdWVzdCdz
IGNvbnN1bWVyIGtleQogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X2NvbnN1bWVyKCYk
cmVxdWVzdCkgewogICAgJGNvbnN1bWVyX2tleSA9IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRl
cigib2F1dGhfY29uc3VtZXJfa2V5Iik7CiAgICBpZiAoISRjb25zdW1lcl9rZXkpIHsKICAg
ICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJbnZhbGlkIGNvbnN1bWVyIGtleSIpOwog
ICAgfQoKICAgICRjb25zdW1lciA9ICR0aGlzLT5kYXRhX3N0b3JlLT5sb29rdXBfY29uc3Vt
ZXIoJGNvbnN1bWVyX2tleSk7CiAgICBpZiAoISRjb25zdW1lcikgewogICAgICB0aHJvdyBu
ZXcgT0F1dGhFeGNlcHRpb24oIkludmFsaWQgY29uc3VtZXIiKTsKICAgIH0KCiAgICByZXR1
cm4gJGNvbnN1bWVyOwogIH0KCiAgLyoqCiAgICogdHJ5IHRvIGZpbmQgdGhlIHRva2VuIGZv
ciB0aGUgcHJvdmlkZWQgcmVxdWVzdCdzIHRva2VuIGtleQogICAqLwogIHByaXZhdGUgZnVu
Y3Rpb24gZ2V0X3Rva2VuKCYkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW5fdHlwZT0iYWNj
ZXNzIikgewogICAgJHRva2VuX2ZpZWxkID0gQCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdv
YXV0aF90b2tlbicpOwogICAgJHRva2VuID0gJHRoaXMtPmRhdGFfc3RvcmUtPmxvb2t1cF90
b2tlbigKICAgICAgJGNvbnN1bWVyLCAkdG9rZW5fdHlwZSwgJHRva2VuX2ZpZWxkCiAgICAp
OwogICAgaWYgKCEkdG9rZW4pIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJ
bnZhbGlkICR0b2tlbl90eXBlIHRva2VuOiAkdG9rZW5fZmllbGQiKTsKICAgIH0KICAgIHJl
dHVybiAkdG9rZW47CiAgfQoKICAvKioKICAgKiBhbGwtaW4tb25lIGZ1bmN0aW9uIHRvIGNo
ZWNrIHRoZSBzaWduYXR1cmUgb24gYSByZXF1ZXN0CiAgICogc2hvdWxkIGd1ZXNzIHRoZSBz
aWduYXR1cmUgbWV0aG9kIGFwcHJvcHJpYXRlbHkKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9u
IGNoZWNrX3NpZ25hdHVyZSgmJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAv
LyB0aGlzIHNob3VsZCBwcm9iYWJseSBiZSBpbiBhIGRpZmZlcmVudCBtZXRob2QKICAgICR0
aW1lc3RhbXAgPSBAJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX3RpbWVzdGFtcCcp
OwogICAgJG5vbmNlID0gQCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF9ub25jZScp
OwoKICAgICR0aGlzLT5jaGVja190aW1lc3RhbXAoJHRpbWVzdGFtcCk7CiAgICAkdGhpcy0+
Y2hlY2tfbm9uY2UoJGNvbnN1bWVyLCAkdG9rZW4sICRub25jZSwgJHRpbWVzdGFtcCk7Cgog
ICAgJHNpZ25hdHVyZV9tZXRob2QgPSAkdGhpcy0+Z2V0X3NpZ25hdHVyZV9tZXRob2QoJHJl
cXVlc3QpOwoKICAgICRzaWduYXR1cmUgPSAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1
dGhfc2lnbmF0dXJlJyk7CiAgICAkdmFsaWRfc2lnID0gJHNpZ25hdHVyZV9tZXRob2QtPmNo
ZWNrX3NpZ25hdHVyZSgKICAgICAgJHJlcXVlc3QsCiAgICAgICRjb25zdW1lciwKICAgICAg
JHRva2VuLAogICAgICAkc2lnbmF0dXJlCiAgICApOwoKICAgIGlmICghJHZhbGlkX3NpZykg
ewogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIkludmFsaWQgc2lnbmF0dXJlIik7
CiAgICB9CiAgfQoKICAvKioKICAgKiBjaGVjayB0aGF0IHRoZSB0aW1lc3RhbXAgaXMgbmV3
IGVub3VnaAogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gY2hlY2tfdGltZXN0YW1wKCR0aW1l
c3RhbXApIHsKICAgIGlmKCAhICR0aW1lc3RhbXAgKQogICAgICB0aHJvdyBuZXcgT0F1dGhF
eGNlcHRpb24oCiAgICAgICAgJ01pc3NpbmcgdGltZXN0YW1wIHBhcmFtZXRlci4gVGhlIHBh
cmFtZXRlciBpcyByZXF1aXJlZCcKICAgICAgKTsKCiAgICAvLyB2ZXJpZnkgdGhhdCB0aW1l
c3RhbXAgaXMgcmVjZW50aXNoCiAgICAkbm93ID0gdGltZSgpOwogICAgaWYgKGFicygkbm93
IC0gJHRpbWVzdGFtcCkgPiAkdGhpcy0+dGltZXN0YW1wX3RocmVzaG9sZCkgewogICAgICB0
aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAgICAgIkV4cGlyZWQgdGltZXN0YW1wLCB5
b3VycyAkdGltZXN0YW1wLCBvdXJzICRub3ciCiAgICAgICk7CiAgICB9CiAgfQoKICAvKioK
ICAgKiBjaGVjayB0aGF0IHRoZSBub25jZSBpcyBub3QgcmVwZWF0ZWQKICAgKi8KICBwcml2
YXRlIGZ1bmN0aW9uIGNoZWNrX25vbmNlKCRjb25zdW1lciwgJHRva2VuLCAkbm9uY2UsICR0
aW1lc3RhbXApIHsKICAgIGlmKCAhICRub25jZSApCiAgICAgIHRocm93IG5ldyBPQXV0aEV4
Y2VwdGlvbigKICAgICAgICAnTWlzc2luZyBub25jZSBwYXJhbWV0ZXIuIFRoZSBwYXJhbWV0
ZXIgaXMgcmVxdWlyZWQnCiAgICAgICk7CgogICAgLy8gdmVyaWZ5IHRoYXQgdGhlIG5vbmNl
IGlzIHVuaXF1ZWlzaAogICAgJGZvdW5kID0gJHRoaXMtPmRhdGFfc3RvcmUtPmxvb2t1cF9u
b25jZSgKICAgICAgJGNvbnN1bWVyLAogICAgICAkdG9rZW4sCiAgICAgICRub25jZSwKICAg
ICAgJHRpbWVzdGFtcAogICAgKTsKICAgIGlmICgkZm91bmQpIHsKICAgICAgdGhyb3cgbmV3
IE9BdXRoRXhjZXB0aW9uKCJOb25jZSBhbHJlYWR5IHVzZWQ6ICRub25jZSIpOwogICAgfQog
IH0KCn0KCmNsYXNzIE9BdXRoRGF0YVN0b3JlIHsKICBmdW5jdGlvbiBsb29rdXBfY29uc3Vt
ZXIoJGNvbnN1bWVyX2tleSkgewogICAgLy8gaW1wbGVtZW50IG1lCiAgfQoKICBmdW5jdGlv
biBsb29rdXBfdG9rZW4oJGNvbnN1bWVyLCAkdG9rZW5fdHlwZSwgJHRva2VuKSB7CiAgICAv
LyBpbXBsZW1lbnQgbWUKICB9CgogIGZ1bmN0aW9uIGxvb2t1cF9ub25jZSgkY29uc3VtZXIs
ICR0b2tlbiwgJG5vbmNlLCAkdGltZXN0YW1wKSB7CiAgICAvLyBpbXBsZW1lbnQgbWUKICB9
CgogIGZ1bmN0aW9uIG5ld19yZXF1ZXN0X3Rva2VuKCRjb25zdW1lciwgJGNhbGxiYWNrID0g
bnVsbCkgewogICAgLy8gcmV0dXJuIGEgbmV3IHRva2VuIGF0dGFjaGVkIHRvIHRoaXMgY29u
c3VtZXIKICB9CgogIGZ1bmN0aW9uIG5ld19hY2Nlc3NfdG9rZW4oJHRva2VuLCAkY29uc3Vt
ZXIsICR2ZXJpZmllciA9IG51bGwpIHsKICAgIC8vIHJldHVybiBhIG5ldyBhY2Nlc3MgdG9r
ZW4gYXR0YWNoZWQgdG8gdGhpcyBjb25zdW1lcgogICAgLy8gZm9yIHRoZSB1c2VyIGFzc29j
aWF0ZWQgd2l0aCB0aGlzIHRva2VuIGlmIHRoZSByZXF1ZXN0IHRva2VuCiAgICAvLyBpcyBh
dXRob3JpemVkCiAgICAvLyBzaG91bGQgYWxzbyBpbnZhbGlkYXRlIHRoZSByZXF1ZXN0IHRv
a2VuCiAgfQoKfQoKY2xhc3MgT0F1dGhVdGlsIHsKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9u
IHVybGVuY29kZV9yZmMzOTg2KCRpbnB1dCkgewogIGlmIChpc19hcnJheSgkaW5wdXQpKSB7
CiAgICByZXR1cm4gYXJyYXlfbWFwKGFycmF5KCdPQXV0aFV0aWwnLCAndXJsZW5jb2RlX3Jm
YzM5ODYnKSwgJGlucHV0KTsKICB9IGVsc2UgaWYgKGlzX3NjYWxhcigkaW5wdXQpKSB7CiAg
ICByZXR1cm4gc3RyX3JlcGxhY2UoCiAgICAgICcrJywKICAgICAgJyAnLAogICAgICBzdHJf
cmVwbGFjZSgnJTdFJywgJ34nLCByYXd1cmxlbmNvZGUoJGlucHV0KSkKICAgICk7CiAgfSBl
bHNlIHsKICAgIHJldHVybiAnJzsKICB9Cn0KCgogIC8vIFRoaXMgZGVjb2RlIGZ1bmN0aW9u
IGlzbid0IHRha2luZyBpbnRvIGNvbnNpZGVyYXRpb24gdGhlIGFib3ZlCiAgLy8gbW9kaWZp
Y2F0aW9ucyB0byB0aGUgZW5jb2RpbmcgcHJvY2Vzcy4gSG93ZXZlciwgdGhpcyBtZXRob2Qg
ZG9lc24ndAogIC8vIHNlZW0gdG8gYmUgdXNlZCBhbnl3aGVyZSBzbyBsZWF2aW5nIGl0IGFz
IGlzLgogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gdXJsZGVjb2RlX3JmYzM5ODYoJHN0cmlu
ZykgewogICAgcmV0dXJuIHVybGRlY29kZSgkc3RyaW5nKTsKICB9CgogIC8vIFV0aWxpdHkg
ZnVuY3Rpb24gZm9yIHR1cm5pbmcgdGhlIEF1dGhvcml6YXRpb246IGhlYWRlciBpbnRvCiAg
Ly8gcGFyYW1ldGVycywgaGFzIHRvIGRvIHNvbWUgdW5lc2NhcGluZwogIC8vIENhbiBmaWx0
ZXIgb3V0IGFueSBub24tb2F1dGggcGFyYW1ldGVycyBpZiBuZWVkZWQgKGRlZmF1bHQgYmVo
YXZpb3VyKQogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gc3BsaXRfaGVhZGVyKCRoZWFkZXIs
ICRvbmx5X2FsbG93X29hdXRoX3BhcmFtZXRlcnMgPSB0cnVlKSB7CiAgICAkcGF0dGVybiA9
ICcvKChbLV9hLXpdKik9KCIoW14iXSopInwoW14sXSopKSw/KS8nOwogICAgJG9mZnNldCA9
IDA7CiAgICAkcGFyYW1zID0gYXJyYXkoKTsKICAgIHdoaWxlIChwcmVnX21hdGNoKCRwYXR0
ZXJuLCAkaGVhZGVyLCAkbWF0Y2hlcywgUFJFR19PRkZTRVRfQ0FQVFVSRSwgJG9mZnNldCkg
PiAwKSB7CiAgICAgICRtYXRjaCA9ICRtYXRjaGVzWzBdOwogICAgICAkaGVhZGVyX25hbWUg
PSAkbWF0Y2hlc1syXVswXTsKICAgICAgJGhlYWRlcl9jb250ZW50ID0gKGlzc2V0KCRtYXRj
aGVzWzVdKSkgPyAkbWF0Y2hlc1s1XVswXSA6ICRtYXRjaGVzWzRdWzBdOwogICAgICBpZiAo
cHJlZ19tYXRjaCgnL15vYXV0aF8vJywgJGhlYWRlcl9uYW1lKSB8fCAhJG9ubHlfYWxsb3df
b2F1dGhfcGFyYW1ldGVycykgewogICAgICAgICRwYXJhbXNbJGhlYWRlcl9uYW1lXSA9IE9B
dXRoVXRpbDo6dXJsZGVjb2RlX3JmYzM5ODYoJGhlYWRlcl9jb250ZW50KTsKICAgICAgfQog
ICAgICAkb2Zmc2V0ID0gJG1hdGNoWzFdICsgc3RybGVuKCRtYXRjaFswXSk7CiAgICB9Cgog
ICAgaWYgKGlzc2V0KCRwYXJhbXNbJ3JlYWxtJ10pKSB7CiAgICAgIHVuc2V0KCRwYXJhbXNb
J3JlYWxtJ10pOwogICAgfQoKICAgIHJldHVybiAkcGFyYW1zOwogIH0KCiAgLy8gaGVscGVy
IHRvIHRyeSB0byBzb3J0IG91dCBoZWFkZXJzIGZvciBwZW9wbGUgd2hvIGFyZW4ndCBydW5u
aW5nIGFwYWNoZQogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZ2V0X2hlYWRlcnMoKSB7CiAg
ICBpZiAoZnVuY3Rpb25fZXhpc3RzKCdhcGFjaGVfcmVxdWVzdF9oZWFkZXJzJykpIHsKICAg
ICAgLy8gd2UgbmVlZCB0aGlzIHRvIGdldCB0aGUgYWN0dWFsIEF1dGhvcml6YXRpb246IGhl
YWRlcgogICAgICAvLyBiZWNhdXNlIGFwYWNoZSB0ZW5kcyB0byB0ZWxsIHVzIGl0IGRvZXNu
J3QgZXhpc3QKICAgICAgJGhlYWRlcnMgPSBhcGFjaGVfcmVxdWVzdF9oZWFkZXJzKCk7Cgog
ICAgICAvLyBzYW5pdGl6ZSB0aGUgb3V0cHV0IG9mIGFwYWNoZV9yZXF1ZXN0X2hlYWRlcnMg
YmVjYXVzZQogICAgICAvLyB3ZSBhbHdheXMgd2FudCB0aGUga2V5cyB0byBiZSBDYXNlZC1M
aWtlLVRoaXMgYW5kIGFyaCgpCiAgICAgIC8vIHJldHVybnMgdGhlIGhlYWRlcnMgaW4gdGhl
IHNhbWUgY2FzZSBhcyB0aGV5IGFyZSBpbiB0aGUKICAgICAgLy8gcmVxdWVzdAogICAgICAk
b3V0ID0gYXJyYXkoKTsKICAgICAgZm9yZWFjaCggJGhlYWRlcnMgQVMgJGtleSA9PiAkdmFs
dWUgKSB7CiAgICAgICAgJGtleSA9IHN0cl9yZXBsYWNlKAogICAgICAgICAgICAiICIsCiAg
ICAgICAgICAgICItIiwKICAgICAgICAgICAgdWN3b3JkcyhzdHJ0b2xvd2VyKHN0cl9yZXBs
YWNlKCItIiwgIiAiLCAka2V5KSkpCiAgICAgICAgICApOwogICAgICAgICRvdXRbJGtleV0g
PSAkdmFsdWU7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIC8vIG90aGVyd2lzZSB3ZSBk
b24ndCBoYXZlIGFwYWNoZSBhbmQgYXJlIGp1c3QgZ29pbmcgdG8gaGF2ZSB0byBob3BlCiAg
ICAgIC8vIHRoYXQgJF9TRVJWRVIgYWN0dWFsbHkgY29udGFpbnMgd2hhdCB3ZSBuZWVkCiAg
ICAgICRvdXQgPSBhcnJheSgpOwogICAgICBpZiggaXNzZXQoJF9TRVJWRVJbJ0NPTlRFTlRf
VFlQRSddKSApCiAgICAgICAgJG91dFsnQ29udGVudC1UeXBlJ10gPSAkX1NFUlZFUlsnQ09O
VEVOVF9UWVBFJ107CiAgICAgIGlmKCBpc3NldCgkX0VOVlsnQ09OVEVOVF9UWVBFJ10pICkK
ICAgICAgICAkb3V0WydDb250ZW50LVR5cGUnXSA9ICRfRU5WWydDT05URU5UX1RZUEUnXTsK
CiAgICAgIGZvcmVhY2ggKCRfU0VSVkVSIGFzICRrZXkgPT4gJHZhbHVlKSB7CiAgICAgICAg
aWYgKHN1YnN0cigka2V5LCAwLCA1KSA9PSAiSFRUUF8iKSB7CiAgICAgICAgICAvLyB0aGlz
IGlzIGNoYW9zLCBiYXNpY2FsbHkgaXQgaXMganVzdCB0aGVyZSB0byBjYXBpdGFsaXplIHRo
ZSBmaXJzdAogICAgICAgICAgLy8gbGV0dGVyIG9mIGV2ZXJ5IHdvcmQgdGhhdCBpcyBub3Qg
YW4gaW5pdGlhbCBIVFRQIGFuZCBzdHJpcCBIVFRQCiAgICAgICAgICAvLyBjb2RlIGZyb20g
cHJ6ZW1lawogICAgICAgICAgJGtleSA9IHN0cl9yZXBsYWNlKAogICAgICAgICAgICAiICIs
CiAgICAgICAgICAgICItIiwKICAgICAgICAgICAgdWN3b3JkcyhzdHJ0b2xvd2VyKHN0cl9y
ZXBsYWNlKCJfIiwgIiAiLCBzdWJzdHIoJGtleSwgNSkpKSkKICAgICAgICAgICk7CiAgICAg
ICAgICAkb3V0WyRrZXldID0gJHZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAg
cmV0dXJuICRvdXQ7CiAgfQoKICAvLyBUaGlzIGZ1bmN0aW9uIHRha2VzIGEgaW5wdXQgbGlr
ZSBhPWImYT1jJmQ9ZSBhbmQgcmV0dXJucyB0aGUgcGFyc2VkCiAgLy8gcGFyYW1ldGVycyBs
aWtlIHRoaXMKICAvLyBhcnJheSgnYScgPT4gYXJyYXkoJ2InLCdjJyksICdkJyA9PiAnZScp
CiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBwYXJzZV9wYXJhbWV0ZXJzKCAkaW5wdXQgKSB7
CiAgICBpZiAoIWlzc2V0KCRpbnB1dCkgfHwgISRpbnB1dCkgcmV0dXJuIGFycmF5KCk7Cgog
ICAgJHBhaXJzID0gZXhwbG9kZSgnJicsICRpbnB1dCk7CgogICAgJHBhcnNlZF9wYXJhbWV0
ZXJzID0gYXJyYXkoKTsKICAgIGZvcmVhY2ggKCRwYWlycyBhcyAkcGFpcikgewogICAgICAk
c3BsaXQgPSBleHBsb2RlKCc9JywgJHBhaXIsIDIpOwogICAgICAkcGFyYW1ldGVyID0gT0F1
dGhVdGlsOjp1cmxkZWNvZGVfcmZjMzk4Nigkc3BsaXRbMF0pOwogICAgICAkdmFsdWUgPSBp
c3NldCgkc3BsaXRbMV0pID8gT0F1dGhVdGlsOjp1cmxkZWNvZGVfcmZjMzk4Nigkc3BsaXRb
MV0pIDogJyc7CgogICAgICBpZiAoaXNzZXQoJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0
ZXJdKSkgewogICAgICAgIC8vIFdlIGhhdmUgYWxyZWFkeSByZWNpZXZlZCBwYXJhbWV0ZXIo
cykgd2l0aCB0aGlzIG5hbWUsIHNvIGFkZCB0byB0aGUgbGlzdAogICAgICAgIC8vIG9mIHBh
cmFtZXRlcnMgd2l0aCB0aGlzIG5hbWUKCiAgICAgICAgaWYgKGlzX3NjYWxhcigkcGFyc2Vk
X3BhcmFtZXRlcnNbJHBhcmFtZXRlcl0pKSB7CiAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBm
aXJzdCBkdXBsaWNhdGUsIHNvIHRyYW5zZm9ybSBzY2FsYXIgKHN0cmluZykgaW50byBhbiBh
cnJheQogICAgICAgICAgLy8gc28gd2UgY2FuIGFkZCB0aGUgZHVwbGljYXRlcwogICAgICAg
ICAgJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdID0gYXJyYXkoJHBhcnNlZF9wYXJh
bWV0ZXJzWyRwYXJhbWV0ZXJdKTsKICAgICAgICB9CgogICAgICAgICRwYXJzZWRfcGFyYW1l
dGVyc1skcGFyYW1ldGVyXVtdID0gJHZhbHVlOwogICAgICB9IGVsc2UgewogICAgICAgICRw
YXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSA9ICR2YWx1ZTsKICAgICAgfQogICAgfQog
ICAgcmV0dXJuICRwYXJzZWRfcGFyYW1ldGVyczsKICB9CgogIHB1YmxpYyBzdGF0aWMgZnVu
Y3Rpb24gYnVpbGRfaHR0cF9xdWVyeSgkcGFyYW1zKSB7CiAgICBpZiAoISRwYXJhbXMpIHJl
dHVybiAnJzsKCiAgICAvLyBVcmxlbmNvZGUgYm90aCBrZXlzIGFuZCB2YWx1ZXMKICAgICRr
ZXlzID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NihhcnJheV9rZXlzKCRwYXJhbXMp
KTsKICAgICR2YWx1ZXMgPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KGFycmF5X3Zh
bHVlcygkcGFyYW1zKSk7CiAgICAkcGFyYW1zID0gYXJyYXlfY29tYmluZSgka2V5cywgJHZh
bHVlcyk7CgogICAgLy8gUGFyYW1ldGVycyBhcmUgc29ydGVkIGJ5IG5hbWUsIHVzaW5nIGxl
eGljb2dyYXBoaWNhbCBieXRlIHZhbHVlIG9yZGVyaW5nLgogICAgLy8gUmVmOiBTcGVjOiA5
LjEuMSAoMSkKICAgIHVrc29ydCgkcGFyYW1zLCAnc3RyY21wJyk7CgogICAgJHBhaXJzID0g
YXJyYXkoKTsKICAgIGZvcmVhY2ggKCRwYXJhbXMgYXMgJHBhcmFtZXRlciA9PiAkdmFsdWUp
IHsKICAgICAgaWYgKGlzX2FycmF5KCR2YWx1ZSkpIHsKICAgICAgICAvLyBJZiB0d28gb3Ig
bW9yZSBwYXJhbWV0ZXJzIHNoYXJlIHRoZSBzYW1lIG5hbWUsIHRoZXkgYXJlIHNvcnRlZCBi
eSB0aGVpciB2YWx1ZQogICAgICAgIC8vIFJlZjogU3BlYzogOS4xLjEgKDEpCiAgICAgICAg
bmF0c29ydCgkdmFsdWUpOwogICAgICAgIGZvcmVhY2ggKCR2YWx1ZSBhcyAkZHVwbGljYXRl
X3ZhbHVlKSB7CiAgICAgICAgICAkcGFpcnNbXSA9ICRwYXJhbWV0ZXIgLiAnPScgLiAkZHVw
bGljYXRlX3ZhbHVlOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAkcGFpcnNb
XSA9ICRwYXJhbWV0ZXIgLiAnPScgLiAkdmFsdWU7CiAgICAgIH0KICAgIH0KICAgIC8vIEZv
ciBlYWNoIHBhcmFtZXRlciwgdGhlIG5hbWUgaXMgc2VwYXJhdGVkIGZyb20gdGhlIGNvcnJl
c3BvbmRpbmcgdmFsdWUgYnkgYW4gJz0nIGNoYXJhY3RlciAoQVNDSUkgY29kZSA2MSkKICAg
IC8vIEVhY2ggbmFtZS12YWx1ZSBwYWlyIGlzIHNlcGFyYXRlZCBieSBhbiAnJicgY2hhcmFj
dGVyIChBU0NJSSBjb2RlIDM4KQogICAgcmV0dXJuIGltcGxvZGUoJyYnLCAkcGFpcnMpOwog
IH0KfSI7czozOiJtZDUiO3M6MzI6ImM1MmU3OWQ4NGZkMjk1YzVlMzYwYjhiODczZmQ0Njg1
Ijt9
