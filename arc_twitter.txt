# arc_twitter v2.0beta
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjc6
IjIuMGJldGEiO3M6NjoiYXV0aG9yIjtzOjExOiJBbmR5IENhcnRlciI7czoxMDoiYXV0aG9y
X3VyaSI7czozMToiaHR0cDovL3JlZGhvdGNoaWxsaXByb2plY3QuY29tLyI7czoxMToiZGVz
Y3JpcHRpb24iO3M6NjA6IjxhIGhyZWY9Imh0dHA6Ly93d3cudHdpdHRlci5jb20iPlR3aXR0
ZXI8L2E+IGZvciBUZXh0cGF0dGVybiI7czo1OiJvcmRlciI7czoxOiI1IjtzOjQ6InR5cGUi
O3M6MToiMSI7czo1OiJmbGFncyI7czoxOiIzIjtzOjQ6ImhlbHAiO3M6MTYwMzA6Igk8aDEg
Y2xhc3M9InRpdGxlIj48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCAoYXJj
X3R3aXR0ZXIgZm9yIFRleHRwYXR0ZXJuKTwvaDE+CgoJPG9sPgoJCTxsaT48YSBocmVmPSIj
YXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2Fy
Y190d2l0dGVyX2luc3RhbGxhdGlvbiI+SW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxsYXRpb248
L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3RhZyI+VGhlIGFyY190d2l0
dGVyIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfc2VhcmNoX3Rh
ZyI+VGhlIGFyY190d2l0dGVyX3NlYXJjaCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0i
I2FyY190d2l0dGVyX3JldHdlZXRfdGFnIj5UaGUgYXJjX3R3aXR0ZXJfcmV0d2VldCB0YWc8
L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3R3ZWV0X3VybCI+VGhlIGFy
Y190d2l0dGVyX3R3ZWV0X3VybCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190
d2l0dGVyX3Rpbnl1cmwiPlRoZSBhcmNfdHdpdHRlcl90aW55dXJsIHRhZzwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfY2FjaGluZyI+Q2FjaGluZzwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfcHJlZnMiPlByZWZlcmVuY2VzPC9hPjwvbGk+
CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl9hcnRpY2xlIj5Ud2VldGluZyBhcnRpY2xl
czwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfYWRtaW4iPlRoZSBUd2l0
dGVyIHRhYjwvYT48L2xpPgoJPC9vbD4KCgk8cD48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9z
cGFuPiBUd2VldCBwcm92aWRlcyBhY2Nlc3MgdG8geW91ciBUd2l0dGVyIGFjY291bnQgdGhy
b3VnaCBib3RoIHRoZSBhZG1pbiBpbnRlcmZhY2UgYW5kIHRoZSBwdWJsaWMgc2lkZSBvZiB5
b3VyIHNpdGUuIFVwZGF0ZSBUd2l0dGVyIHdoZW4geW91IHBvc3QgYSBuZXcgYXJ0aWNsZSAo
d2l0aCBhcnRpY2xlLWJ5LWFydGljbGUgb3B0IG91dCBvcHRpb24pLCB1cGRhdGUgYW5kIHZp
ZXcgeW91ciBUd2l0dGVyIGZlZWQgdGhyb3VnaCB0aGUgYWRtaW4gVHdpdHRlciB0YWIsIGFu
ZCBkaXNwbGF5IFR3aXR0ZXIgZmVlZHMgb24geW91ciBzaXRlLjwvcD4KCgk8cD5SZXF1aXJl
bWVudHM6LTwvcD4KCgk8dWw+CgkJPGxpPlRleHRwYXR0ZXJuIDQuMis8L2xpPgoJCTxsaT48
c3BhbiBjbGFzcz0iY2FwcyI+UEhQPC9zcGFuPiA1IGFuZCBjVVJMPC9saT4KCTwvdWw+CgoJ
PGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2gy
PgoKCTxwPjxhIGhyZWY9Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbSI+QW5keSBD
YXJ0ZXI8L2E+LiBGb3Igb3RoZXIgVGV4dHBhdHRlcm4gcGx1Z2lucyBieSBtZSB2aXNpdCBt
eSA8YSBocmVmPSJodHRwOi8vcmVkaG90Y2hpbGxpcHJvamVjdC5jb20vdHhwIj5QbHVnaW5z
IHBhZ2U8L2E+LjwvcD4KCgk8cD5JZiB5b3UgbGlrZSB0aGlzIHBsdWdpbiBhbmQgd2FudCB0
byBzZWUgZGV2ZWxvcG1lbnQgd29yayBjb250aW51ZSB5b3UgY291bGQgY29uc2lkZXIgc2Vu
ZGluZyBtZSBhIHNtYWxsIGluY2VudGl2ZTotPC9wPgoKPGZvcm0gYWN0aW9uPSJodHRwczov
L3d3dy5wYXlwYWwuY29tL2NnaS1iaW4vd2Vic2NyIiBtZXRob2Q9InBvc3QiPgo8aW5wdXQg
dHlwZT0iaGlkZGVuIiBuYW1lPSJjbWQiIHZhbHVlPSJfcy14Y2xpY2siPgo8aW5wdXQgdHlw
ZT0iaGlkZGVuIiBuYW1lPSJob3N0ZWRfYnV0dG9uX2lkIiB2YWx1ZT0iREZZQ1JVV1JFVzNV
WSI+CjxpbnB1dCB0eXBlPSJpbWFnZSIgc3JjPSJodHRwczovL3d3dy5wYXlwYWwuY29tL2Vu
X0dCL2kvYnRuL2J0bl9kb25hdGVfU00uZ2lmIiBib3JkZXI9IjAiIG5hbWU9InN1Ym1pdCIg
YWx0PSJQYXlQYWwgLSBUaGUgc2FmZXIsIGVhc2llciB3YXkgdG8gcGF5IG9ubGluZS4iPgo8
aW1nIGFsdD0iIiBib3JkZXI9IjAiIHNyYz0iaHR0cHM6Ly93d3cucGF5cGFsLmNvbS9lbl9H
Qi9pL3Njci9waXhlbC5naWYiIHdpZHRoPSIxIiBoZWlnaHQ9IjEiPgo8L2Zvcm0+CgoJPHA+
VGhhbmtzIHRvIDxhIGhyZWY9Imh0dHA6Ly9tYW5mcmUubmV0LyI+TWljaGFlbCBNYW5mcmU8
L2E+IGZvciBpbnNwaXJhdGlvbiBmb3IgdGhlIGFydGljbGUgdHdlZXQgcGFydCBvZiB0aGlz
IHBsdWdpbiBiYXNlZCBvbiBoaXMgPHNwYW4gY2xhc3M9InRhZyI+bWVtX3R3aXR0ZXI8L3Nw
YW4+IHBsdWdpbi4gIEFkZGl0aW9uYWwgdGhhbmtzIHRvIHRoZSBncmVhdCBUZXh0cGF0dGVy
biBjb21tdW5pdHkgZm9yIGhlbHBpbmcgdG8gdGVzdCB0aGlzIHBsdWdpbiBhbmQgZm9yIHN1
Z2dlc3RpbmcgbmV3IGZlYXR1cmVzLiBUaGUgT0F1dGggcGFydCBvZiB0aGUgcGx1Z2luIGlz
IHRoYW5rcyB0byA8YSBocmVmPSJodHRwOi8vdHdpdHRlci5jb20vYWJyYWhhbSI+QWJyYWhh
bSBXaWxsaWFtczwvYT4uPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0
dGVyX2luc3RhbGxhdGlvbiI+SW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxsYXRpb248L2gyPgoK
CTxwPlRvIGluc3RhbGwgZ28gdG8gdGhlICYjODIxNjtwbHVnaW5zJiM4MjE3OyB0YWIgdW5k
ZXIgJiM4MjE2O2FkbWluJiM4MjE3OyBhbmQgcGFzdGUgdGhlIHBsdWdpbiBjb2RlIGludG8g
dGhlICYjODIxNjtJbnN0YWxsIHBsdWdpbiYjODIxNzsgYm94LCAmIzgyMTY7dXBsb2FkJiM4
MjE3OyBhbmQgdGhlbiAmIzgyMTY7aW5zdGFsbCYjODIxNzsuIEZpbmFsbHkgYWN0aXZhdGUg
dGhlIHBsdWdpbi48L3A+CgoJPHA+QmVmb3JlIHlvdSBzdGFydCB1c2luZyA8c3BhbiBjbGFz
cz0idGFnIj5hcmNfdHdpdHRlcjwvc3Bhbj4geW91IHdpbGwgbmVlZCB0byBtYWtlIHN1cmUg
dGhhdCB0aGUgY2FjaGUgZGlyZWN0b3J5IGlzIHdyaXRhYmxlLiBTZWUgdGhlICYjODIxNjtD
YWNoaW5nJiM4MjE3OyBzdWJzZWN0aW9uIGJlbG93IGZvciBmdXJ0aGVyIGluZm9ybWF0aW9u
LjwvcD4KCgk8cD48c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRlcjwvc3Bhbj4gc2hvdWxk
IG5vdyBiZSByZWFkeSBmb3IgdXNlIG9uIHRoZSBwdWJsaWMtc2lkZSBvZiB5b3VyIHNpdGUu
PC9wPgoKCTxwPlRvIHVubG9jayB0aGUgYWRtaW4gZmVhdHVyZXMgb2YgdGhpcyBwbHVnaW4g
eW91IHdpbGwgbmVlZCB0byBhc3NvY2lhdGUgeW91ciBzaXRlIHdpdGggYSBUd2l0dGVyIGFj
Y291bnQgYnkgY29ubmVjdGluZyB0byBUd2l0dGVyIGZyb20gdGhlIHBsdWdpbiYjODIxNztz
IG9wdGlvbnMgc2NyZWVuLiBDbGljayBvbiB0aGUgbGluayB0byBjb25uZWN0IHRvIFR3aXR0
ZXIsIHlvdSB3aWxsIGJlIGFza2VkIHRvIGxvZ2luIHRvIFR3aXR0ZXIsIGNsaWNraW5nIHRo
aXMgbGluayB3aWxsIHRlbXBvcmFyaWx5IHRha2UgeW91IHRvIHRoZSBUd2l0dGVyIHNpdGUg
d2hlcmUgeW91IHdpbGwgYmUgYXNrZWQgdG8gbG9naW4gYW5kIGFwcHJvdmUgYWNjZXNzIGZv
ciA8c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCB0byByZWFkIGFuZCB3cml0
ZSB0byB5b3VyIFR3aXR0ZXIgYWNjb3VudC4gSWYgYWxsIGlzIHN1Y2Nlc3NmdWwgeW91IHdp
bGwgYmUgcmV0dXJuZWQgdG8gdGhlIG9wdGlvbnMgc2NyZWVuIGFuZCB5b3VyIHVzZXIgbmFt
ZSB3aWxsIGFwcGVhci48L3A+CgoJPHA+QXQgYW55IHRpbWUgeW91IGNhbiBkaXNhc3NvY2lh
dGUgeW91ciBUd2l0dGVyIGFjY291bnQgd2l0aCA8c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9z
cGFuPiBUd2VldCB2aWEgeW91ciBUd2l0dGVyIGFjY291bnQgcHJlZmVyZW5jZXMgb24gdGhl
IDxhIGhyZWY9Imh0dHA6Ly93d3cudHdpdHRlci5jb20iPlR3aXR0ZXIgd2Vic2l0ZTwvYT4u
PC9wPgoKCTxwPlRvIHVuaW5zdGFsbCA8c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRlcjwv
c3Bhbj4gc2ltcGx5IGRlbGV0ZSB0aGUgcGx1Z2luIGZyb20gdGhlICYjODIxNjtQbHVnaW5z
JiM4MjE3OyB0YWIuICBUaGlzIHdpbGwgcmVtb3ZlIHRoZSBwbHVnaW4gY29kZSwgZGVsZXRl
IHJlbGF0ZWQgcHJlZmVyZW5jZXMgYW5kIGRyb3AgdGhlIDxzcGFuIGNsYXNzPSJ0YWciPmFy
Y190d2l0dGVyPC9zcGFuPiB0YWJsZSBmcm9tIHlvdXIgVGV4dHBhdHRlcm4gZGF0YWJhc2Uu
PC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVyX3RhZyI+VGhlIGFy
Y190d2l0dGVyIHRhZzwvaDI+CgoJPGgzPlN5bnRheDwvaDM+CgoJPHA+Jmx0O3R4cDphcmNf
dHdpdHRlciB1c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDsgLyZndDs8L3A+CgoJPGgz
PlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJ
PHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBs
ZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD51c2VyPC90ZD4KCQkJPHRkPlR3aXR0ZXIg
dXNlciBuYW1lPC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0ZXIgdXNlcm5hbWU8L2VtPjwv
dGQ+CgkJCTx0ZD51c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDs8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+bGltaXQ8L3RkPgoJCQk8dGQ+TWF4aW11bSBudW1iZXIgb2YgdHdl
ZXRzIHRvIGRpc3BsYXkgKG1heC4gMjAwKTwvdGQ+CgkJCTx0ZD4xMDwvdGQ+CgkJCTx0ZD5s
aW1pdD0mcXVvdDsyNSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5kYXRlZm9y
bWF0PC90ZD4KCQkJPHRkPkZvcm1hdCB0aGF0IHVwZGF0ZSBkYXRlcyB3aWxsIGFwcGVhciBh
czwvdGQ+CgkJCTx0ZD4gPGVtPkFyY2hpdmUgZGF0ZSBmb3JtYXQ8L2VtPjwvdGQ+CgkJCTx0
ZD5kYXRlZm9ybWF0PSZxdW90OyViICVPZSwgJUk6JU0gJXAmcXVvdDs8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+bGFiZWw8L3RkPgoJCQk8dGQ+TGFiZWwgZm9yIHRoZSB0b3Agb2Yg
dGhlIGxpc3Q8L3RkPgoJCQk8dGQ+IDxlbT5ubyBsYWJlbDwvZW0+PC90ZD4KCQkJPHRkPmxh
YmVsPSZxdW90O015IFR3aXR0ZXIgdGltZWxpbmUmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRy
PgoJCQk8dGQ+bGFiZWx0YWc8L3RkPgoJCQk8dGQ+SW5kZXBlbmRlbnQgd3JhcHRhZyBmb3Ig
bGFiZWw8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJPHRkPmxhYmVsdGFn
PSZxdW90O2gzJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmJyZWFrPC90ZD4K
CQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+SFRNTDwvc3Bh
bj48L3NwYW4+IHRhZyAod2l0aG91dCBicmFja2V0cyksIG9yIHN0cmluZywgdXNlZCB0byBz
ZXBhcmF0ZSB0aGUgdXBkYXRlczwvdGQ+CgkJCTx0ZD5saTwvdGQ+CgkJCTx0ZD5icmVhaz0m
cXVvdDticiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD53cmFwdGFnPC90ZD4K
CQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+SFRNTDwvc3Bh
bj48L3NwYW4+IHRhZyB0byBiZSB1c2VkIGFzIHRoZSB3cmFwdGFnLCB3aXRob3V0IGJyYWNr
ZXRzPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJCTx0ZD53cmFwdGFnPSZx
dW90O3VsJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJ
PHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwv
c3Bhbj4gY2xhc3MgYXR0cmlidXRlIGZvciB3cmFwdGFnPC90ZD4KCQkJPHRkPmFyY190d2l0
dGVyPC90ZD4KCQkJPHRkPmNsYXNzPSZxdW90O3R3aXR0ZXImcXVvdDs8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+Y2xhc3NfcG9zdGVkPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJj
YXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmli
dXRlIGFwcGxpZWQgdG8gc3BhbiB0YWcgYXJvdW5kIHBvc3RlZCBkYXRlPC90ZD4KCQkJPHRk
PmFyY190d2l0dGVyLXBvc3RlZDwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPGgzPkV4YW1w
bGUgdXNhZ2U8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXIgdXNlcj0mcXVvdDtkcm1v
bmtleW5pbmphJnF1b3Q7IGxpbWl0PSZxdW90OzUmcXVvdDsgd3JhcHRhZz0mcXVvdDt1bCZx
dW90OyBicmVhaz0mcXVvdDtsaSZxdW90OyBkYXRlZm9ybWF0PSZxdW90OyViICVPZSwgJUk6
JU0gJXAmcXVvdDsgLyZndDs8L3A+CgoJPHA+UHJvZHVjZXMgYSBidWxsZXQgcG9pbnQgbGlz
dCBvZiB0aGUgbGFzdCA1IFR3aXR0ZXIgdXBkYXRlcyBmcm9tIGRybW9ua2V5bmluamEmIzgy
MTc7cyBUd2l0dGVyIGZlZWQgd2l0aCBhIGRlZmluZWQgZGF0ZSBmb3JtYXQgdG8gb3ZlcnJp
ZGUgdGhlIGRlZmF1bHQgYXJjaGl2ZSBkYXRlIGZvcm1hdC48L3A+CgoJPGgyIGNsYXNzPSJz
ZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfc2VhcmNoX3RhZyI+VGhlIGFyY190d2l0dGVyX3Nl
YXJjaCB0YWc8L2gyPgoKCTxoMz5TeW50YXg8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0
ZXJfc2VhcmNoIGhhc2h0YWdzPSZxdW90O3R4cCZxdW90OyAvJmd0OzwvcD4KCgk8aDM+VXNh
Z2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+
RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90
aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnNlYXJjaDwvdGQ+CgkJCTx0ZD5Db21tYSBzZXBh
cmF0ZWQgbGlzdCBvZiBzZWFyY2ggd29yZHM8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+
PC90ZD4KCQkJPHRkPnNlYXJjaD0mcXVvdDt0eHAsdGV4dHBhdHRlcm4mcXVvdDs8L3RkPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+aGFzaHRhZ3M8L3RkPgoJCQk8dGQ+Q29tbWEgc2VwYXJh
dGVkIGxpc3Qgb2YgaGFzaHRhZ3MgdG8gc2VhcmNoIGZvciAobm90IGluY2x1ZGluZyB0aGUg
aGFzaCk8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJPHRkPmhhc2h0YWdz
PSZxdW90O3R4cCx0ZXh0cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5yZXBseTwvdGQ+CgkJCTx0ZD5Vc2VybmFtZSBvZiB0d2VldHMgaW4gcmVwbHkgdG88L3Rk
PgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQkJPHRkPnJlcGx5PSZxdW90O3R3aXR0
ZXImcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bWVudGlvbjwvdGQ+CgkJCTx0
ZD5Vc2VybmFtZSBvZiB1c2VyIG1lbnRpb25lZCBpbiB0d2VldHMgKDxpPmkuZS48L2k+IHR3
ZWV0cyBjb250YWluaW5nIEB1c2VybmFtZSk8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+
PC90ZD4KCQkJPHRkPm1lbnRpb249JnF1b3Q7dHdpdHRlciZxdW90OzwvdGQ+CgkJPC90cj4K
CQk8dHI+CgkJCTx0ZD5saW1pdDwvdGQ+CgkJCTx0ZD5NYXhpbXVtIG51bWJlciBvZiB0d2Vl
dHMgdG8gZGlzcGxheSAobWF4LiAyMDApPC90ZD4KCQkJPHRkPjEwPC90ZD4KCQkJPHRkPmxp
bWl0PSZxdW90OzI1JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmRhdGVmb3Jt
YXQ8L3RkPgoJCQk8dGQ+Rm9ybWF0IHRoYXQgdXBkYXRlIGRhdGVzIHdpbGwgYXBwZWFyIGFz
PC90ZD4KCQkJPHRkPiA8ZW0+QXJjaGl2ZSBkYXRlIGZvcm1hdDwvZW0+PC90ZD4KCQkJPHRk
PmRhdGVmb3JtYXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAlcCZxdW90OzwvdGQ+CgkJPC90cj4K
CQk8dHI+CgkJCTx0ZD5sYWJlbDwvdGQ+CgkJCTx0ZD5MYWJlbCBmb3IgdGhlIHRvcCBvZiB0
aGUgbGlzdDwvdGQ+CgkJCTx0ZD4gPGVtPm5vIGxhYmVsPC9lbT48L3RkPgoJCTwvdHI+CgkJ
PHRyPgoJCQk8dGQ+bGFiZWx0YWc8L3RkPgoJCQk8dGQ+SW5kZXBlbmRlbnQgd3JhcHRhZyBm
b3IgbGFiZWw8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0
cj4KCQkJPHRkPmJyZWFrPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBj
bGFzcz0iY2FwcyI+SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyAod2l0aG91dCBicmFja2V0cyks
IG9yIHN0cmluZywgdXNlZCB0byBzZXBhcmF0ZSB0aGUgdXBkYXRlczwvdGQ+CgkJCTx0ZD5s
aTwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD53cmFwdGFnPC90ZD4KCQkJPHRkPjxzcGFu
IGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+SFRNTDwvc3Bhbj48L3NwYW4+IHRh
ZyB0byBiZSB1c2VkIGFzIHRoZSB3cmFwdGFnLCB3aXRob3V0IGJyYWNrZXRzPC90ZD4KCQkJ
PHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwv
dGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwv
c3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBmb3Igd3JhcHRhZzwvdGQ+CgkJCTx0ZD5h
cmNfdHdpdHRlcl9zZWFyY2g8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3NfdXNl
cjwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNT
Uzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHNwYW4gdGFnIGFy
b3VuZCB1c2VyIG5hbWU8L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXItdXNlcjwvdGQ+CgkJPC90
cj4KCQk8dHI+CgkJCTx0ZD5jbGFzc19wb3N0ZWQ8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9
ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRy
aWJ1dGUgYXBwbGllZCB0byBzcGFuIHRhZyBhcm91bmQgcG9zdGVkIGRhdGU8L3RkPgoJCQk8
dGQ+YXJjX3R3aXR0ZXItcG9zdGVkPC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8aDM+RXhh
bXBsZSB1c2FnZTwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl9zZWFyY2ggc2VhcmNo
PSZxdW90O3BsdWdpbiZxdW90OyBoYXNodGFncz0mcXVvdDt0eHAsdGV4dHBhdHRlcm4mcXVv
dDsgbGltaXQ9JnF1b3Q7MjUmcXVvdDsgLyZndDs8L3A+CgoJPHA+UHJvZHVjZXMgYSBsaXN0
IG9mIHR3ZWV0cyBjb250YWluaW5nIHRoZSB3b3JkICYjODIxNjtwbHVnaW4mIzgyMTc7IGFu
ZCB0aGUgaGFzaHRhZ3MgJiM4MjE2OyN0eHAmIzgyMTc7IGFuZCAmIzgyMTY7I3RleHRwYXR0
ZXJuJiM4MjE3Oy4gVGhlIHRhZyB3aWxsIHJldHVybiBhIG1heGltdW0gb2YgMjUgdHdlZXRz
LjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9yZXR3ZWV0X3Rh
ZyI+VGhlIGFyY190d2l0dGVyX3JldHdlZXQgdGFnPC9oMj4KCgk8aDM+U3ludGF4PC9oMz4K
Cgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyX3JldHdlZXQgLyZndDs8L3A+CgoJPGgzPlVzYWdl
PC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+QXR0cmlidXRlPC90aD4KCQkJPHRoPkRl
c2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8L3RoPgoJCQk8dGg+RXhhbXBsZTwvdGg+
CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD51c2VyPC90ZD4KCQkJPHRkPlR3aXR0ZXIgdXNlciBu
YW1lIHRvIHF1b3RlPC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0ZXIgdXNlcm5hbWU8L2Vt
PjwvdGQ+CgkJCTx0ZD51c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDs8L3RkPgoJCTwv
dHI+CgkJPHRyPgoJCQk8dGQ+dXJsPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48
c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPjwvc3Bhbj4gdG8gcmV0d2VldDwvdGQ+CgkJ
PC90cj4KCQk8dHI+CgkJCTx0ZD50ZXh0PC90ZD4KCQkJPHRkPlJldHdlZXQgdGV4dDwvdGQ+
CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5mb2xsb3cxPC90ZD4KCQkJPHRkPlN1Z2dlc3RlZCBU
d2l0dGVyIGFjY291bnQgdG8gZm9sbG93LCBmb3IgZXhhbXBsZSB5b3VyIG93bjwvdGQ+CgkJ
CTx0ZD5BIFR3aXR0ZXIgdXNlciB0byByZWNvbW1lbmQ8L3RkPgoJCQk8dGQ+Zm9sbG93MT0m
cXVvdDtUZXh0cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5mb2xs
b3cyPC90ZD4KCQkJPHRkPkFzIGZvbGxvdzE8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+
PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhbmc8L3RkPgoJCQk8dGQ+TGFuZ3VhZ2U8
L3RkPgoJCQk8dGQ+ZW48L3RkPgoJCQk8dGQ+bGFuZz0mcXVvdDtlcyZxdW90OzwvdGQ+CgkJ
PC90cj4KCQk8dHI+CgkJCTx0ZD5jb3VudDwvdGQ+CgkJCTx0ZD5Db3VudCBib3ggcG9zaXRp
b24sIG9wdGlvbnM6IG5vbmUsIGhvcml6b250YWwgb3IgdmVydGljYWw8L3RkPgoJCQk8dGQ+
aG9yaXpvbnRhbDwvdGQ+CgkJCTx0ZD5jb3VudD0mcXVvdDtub25lJnF1b3Q7PC90ZD4KCQk8
L3RyPgoJCTx0cj4KCQkJPHRkPmluY2x1ZGVfanM8L3RkPgoJCQk8dGQ+V2hldGhlciBvciBu
b3QgdG8gaW5jbHVkZSB0aGUgSmF2YVNjcmlwdDwvdGQ+CgkJCTx0ZD4xPC90ZD4KCQkJPHRk
PmluY2x1ZGVfanM9JnF1b3Q7MCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD53
cmFwdGFnPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2Fw
cyI+SFRNTDwvc3Bhbj48L3NwYW4+IHRhZyB0byBiZSB1c2VkIGFzIHRoZSB3cmFwdGFnLCB3
aXRob3V0IGJyYWNrZXRzPC90ZD4KCQkJPHRkPiA8ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90
cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+
PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBh
cHBsaWVkIHRvIHRoZSByZXR3ZWV0IGJ1dHRvbjwvdGQ+CgkJCTx0ZD50d2l0dGVyLXNoYXJl
LWJ1dHRvbjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBp
ZD0iYXJjX3R3aXR0ZXJfdHdlZXRfdXJsIj5hcmNfdHdpdHRlcl90d2VldF91cmw8L2gyPgoK
CTxwPlJldHVybnMgdGhlIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+IG9mIHRoZSBU
d2l0dGVyIHN0YXR1cyBmb3IgYW4gYXJ0aWNsZS48L3A+CgoJPGgzPlN5bnRheDwvaDM+CgoJ
PHA+Jmx0O3R4cDphcmNfdHdpdHRlcl90d2VldF91cmwgLyZndDs8L3A+CgoJPHA+Jmx0O3R4
cDphcmNfdHdpdHRlcl90d2VldF91cmwmZ3Q7TGluayB0ZXh0Jmx0Oy90eHA6YXJjX3R3aXR0
ZXJfdHdlZXRfdXJsJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+
CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+
RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRk
PmlkPC90ZD4KCQkJPHRkPlRleHRwYXR0ZXJuIGFydGljbGUgSUQ8L3RkPgoJCQk8dGQ+IDxl
bT5jdXJyZW50IGFydGljbGU8L2VtPjwvdGQ+CgkJCTx0ZD5pZD0mcXVvdDsxJnF1b3Q7PC90
ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnRpdGxlPC90ZD4KCQkJPHRkPlRpdGxlIGF0dHJp
YnV0ZSBvZiB0aGUgbGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwv
dHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMi
PjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUg
YXBwbGllZCB0byB0aGUgbGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJ
CTwvdHI+Cgk8L3RhYmxlPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFyY190d2l0dGVy
X3Rpbnl1cmwiPmFyY190d2l0dGVyX3Rpbnl1cmw8L2gyPgoKCTxwPlJldHVybnMgdGhlIHNo
b3J0ZW5lZCA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPiBvZiB0aGUgYXJ0aWNsZSB1
c2VkIGZvciB0aGUgVHdpdHRlciB1cGRhdGUuPC9wPgoKCTxoMz5TeW50YXg8L2gzPgoKCTxw
PiZsdDt0eHA6YXJjX3R3aXR0ZXJfdGlueXVybCAvJmd0OzwvcD4KCgk8cD4mbHQ7dHhwOmFy
Y190d2l0dGVyX3Rpbnl1cmwmZ3Q7TGluayB0ZXh0Jmx0Oy90eHA6YXJjX3R3aXR0ZXJfdGlu
eXVybCZndDs8L3A+CgoJPGgzPlVzYWdlPC9oMz4KCgk8dGFibGU+CgkJPHRyPgoJCQk8dGg+
QXR0cmlidXRlPC90aD4KCQkJPHRoPkRlc2NyaXB0aW9uPC90aD4KCQkJPHRoPkRlZmF1bHQ8
L3RoPgoJCQk8dGg+RXhhbXBsZTwvdGg+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5pZDwvdGQ+
CgkJCTx0ZD5UZXh0cGF0dGVybiBhcnRpY2xlIElEPC90ZD4KCQkJPHRkPiA8ZW0+Y3VycmVu
dCBhcnRpY2xlPC9lbT48L3RkPgoJCQk8dGQ+aWQ9JnF1b3Q7MSZxdW90OzwvdGQ+CgkJPC90
cj4KCQk8dHI+CgkJCTx0ZD50aXRsZTwvdGQ+CgkJCTx0ZD5UaXRsZSBhdHRyaWJ1dGUgb2Yg
dGhlIGxpbms8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0
cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBj
bGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQg
dG8gdGhlIGxpbms8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJ
PC90YWJsZT4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9jYWNoaW5n
Ij5DYWNoaW5nPC9oMj4KCgk8cD5JbiBvcmRlciB0byBwcmV2ZW50IGV4Y2Vzc2l2ZSByZXBl
YXRpdGl2ZSBjYWxscyB0byB0aGUgVHdpdHRlciB3ZWJzaXRlIGl0IGlzIHJlY29tbWVuZGVk
IHRvIGNhY2hlIHJlc3VsdHMuIFR3aXR0ZXIgbGltaXRzIHRoZSBudW1iZXIgb2YgY2FsbHMg
dGhyb3VnaCB0aGUgPHNwYW4gY2xhc3M9ImNhcHMiPkFQSTwvc3Bhbj4sIGFuZCBjb250aW51
b3VzIGNhbGxzIHdpbGwgcmVzdWx0IGluIFR3aXR0ZXIgY2xvc2luZyB0byBmdXJ0aGVyIHJl
cXVlc3RzLiBCeSBkZWZhdWx0LCBhcmNfdHdpdHRlciBjYWNoZXMgZm9yIDMwIG1pbnV0ZSBp
bnRlcnZhbHMuPC9wPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJ
CQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFt
cGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNhY2hpbmc8L3RkPgoJCQk8dGQ+JiM4
MjE2OzEmIzgyMTc7IHRvIGNhY2hlIGZlZWQsICYjODIxNjswJiM4MjE3OyB0byB0dXJuIGNh
Y2hpbmcgb2ZmIChub3QgcmVjb21tZW5kZWQpPC90ZD4KCQkJPHRkPjE8L3RkPgoJCQk8dGQ+
Y2FjaGluZz0mcXVvdDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNhY2hl
X2RpcjwvdGQ+CgkJCTx0ZD5BYnNvbHV0ZSBwYXRoIHRvIHRoZSBjYWNoZSBkaXJlY3Rvcnkg
KG11c3QgYmUgd3JpdGFibGUpPC90ZD4KCQkJPHRkPiA8ZW0+YXJjX3R3aXR0ZXIgcHJlZmVy
ZW5jZXM8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jYWNoZV90aW1lPC90ZD4K
CQkJPHRkPlRpbWUgaW4gbWludXRlcyB0aGF0IHRoZSBjYWNoZSBmaWxlcyBhcmUgc3RvcmVk
IGJlZm9yZSBiZWluZyByZWZyZXNoZWQ8L3RkPgoJCQk8dGQ+NTwvdGQ+CgkJCTx0ZD5jYWNo
ZV90aW1lPSZxdW90OzMwJnF1b3Q7PC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8cD5UaGUg
YWRtaW4gc2lkZSBvZiB0aGlzIHBsdWdpbiBlbmZvcmNlcyBjYWNoaW5nLCBhcGFydCBmcm9t
IHdoZW4gaXQgaXMgcG9zdGluZyB0byBUd2l0dGVyICg8aT5lLmcuPC9pPiB3aGVuIHBvc3Rp
bmcgb3IgZGVsZXRpbmcgYW4gdXBkYXRlKS48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBp
ZD0iYXJjX3R3aXR0ZXJfcHJlZnMiPlByZWZlcmVuY2VzPC9oMj4KCgk8cD5Zb3UgY2FuIGFj
Y2VzcyB0aGUgcGx1Z2lucyBjb3JlIHByZWZlcmVuY2VzIGZyb20gZWl0aGVyIHRoZSBQcmVm
ZXJlbmNlcyBvciBQbHVnaW5zIHRhYnMgaW4gYWRtaW4uIFNldHVwIHlvdXIgVHdpdHRlciBh
Y2NvdW50ICh5b3Ugd2lsbCBiZSBhc2tlZCB0byBjb25uZWN0IHZpYSBUd2l0dGVyIGFuZCB0
aGlzIG5lZWRzIGRvaW5nIGJlZm9yZSB5b3UgY2FuIHVzZSB0aGUgcGx1Z2luKSBhbmQgY2hh
bmdlIHRoZSBjYWNoZSBkaXJlY3RvcnkgdXNpbmcgYXJjX3R3aXR0ZXImIzgyMTc7cyBwcmVm
ZXJlbmNlcy4gV2l0aG91dCBwcm92aWRpbmcgeW91ciBhY2NvdW50IGxvZ2luIGRldGFpbHMg
dGhlIGFkbWluIGFyZWEgZmVhdHVyZXMgb2YgdGhpcyBwbHVnaW4gd2lsbCBiZSBpbmFjdGl2
ZS48L3A+CgoJPHA+WW91IGNhbiBzZWxlY3QgdGhlIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8
L3NwYW4+IHNob3J0ZW5lciBtZXRob2QgeW91IHdhbnQgdG8gdXNlIHRvIGxpbmsgYmFjayB0
byB5b3VyIGFydGljbGUgb24gVHdpdHRlci4gUGxlYXNlIG5vdGUgdGhhdCBpZiB5b3Ugc2Vs
ZWN0IHNtZF9zaG9ydF91cmwgeW91IHdpbGwgbmVlZCB0byBoYXZlIGluc3RhbGxlZCBhbmQg
YWN0aXZhdGVkIHRoZSA8YSBocmVmPSJodHRwOi8vdGV4dHBhdHRlcm4ub3JnL3BsdWdpbnMv
MTA5OS9zbWRfc2hvcnRfdXJsIj48c3BhbiBjbGFzcz0idGFnIj5zbWRfc2hvcnRfdXJsPC9z
cGFuPiBwbHVnaW48L2E+IGRldmVsb3BlZCBieSBTdGVmIERhd3Nvbi48L3A+CgoJPGgyIGNs
YXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYXJ0aWNsZSI+VHdlZXRpbmcgYXJ0aWNs
ZXM8L2gyPgoKCTxwPkJ5IGRlZmF1bHQgYXJjX3R3aXR0ZXIgd2lsbCBwb3N0IGFuIHVwZGF0
ZSB0byBUd2l0dGVyIGluY2x1ZGluZyBhIHNob3J0ZW5lZCA8c3BhbiBjbGFzcz0iY2FwcyI+
VVJMPC9zcGFuPiB0byB5b3VyIGFydGljbGUuIE9ubHkgbGl2ZSBhbmQgYWN0aXZlIGFydGlj
bGVzIHdpbGwgYmUgc2VudCB0byBUd2l0dGVyLCA8aT5pLmUuPC9pPiBhcnRpY2xlcyBwb3N0
ZWQgaW4gdGhlIGZ1dHVyZSBvciBhcyBzdGlja3kgYXJ0aWNsZXMgd2lsbCBub3QgYmUgc2Vu
dC4gSWYgeW91ciBhcnRpY2xlIGlzIHN1Y2Nlc3NmdWxseSBzdWJtaXR0ZWQgdG8gVHdpdHRl
ciB0aGUgdXBkYXRlIHdpbGwgYXBwZWFyIGluIHBsYWNlIG9mIHRoZSBUd2l0dGVyIG9wdGlv
biBvbiB0aGUgcmlnaHQtaGFuZC1zaWRlIG9mIHRoZSBhcnRpY2xlIGVkaXQgc2NyZWVuLjwv
cD4KCgk8cD5Ud2VldHMgYXJlIHNlbnQgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6IDxlbT5U
d2VldCBwcmVmaXg8L2VtPiA8ZW0+QXJ0aWNsZSB0aXRsZTwvZW0+IDxlbT5TaG9ydGVuZWQg
PHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj48L2VtPiA8ZW0+VHdlZXQgc3VmZml4PC9l
bT4uIFlvdSBjYW4gY2hhbmdlIHRoZSBwcmVmaXggYW5kIHN1ZmZpeCBvbiBhbiBhcnRpY2xl
LWJ5LWFydGljbGUgYmFzaXMgYnkgY2hhbmdpbmcgdGhlIHR3ZWV0IG9wdGlvbnMgdW5kZXIg
JiM4MjE2O1VwZGF0ZSBUd2l0dGVyJiM4MjE3OyBvbiB0aGUgYXJ0aWNsZSBlZGl0b3Igc2Ny
ZWVuLiBUaGUgZGVmYXVsdCA8ZW0+VHdlZXQgcHJlZml4PC9lbT4gY2FuIGJlIHNldCB1bmRl
ciB0aGUgPHNwYW4gY2xhc3M9InRhZyI+YXJjX3R3aXR0ZXI8L3NwYW4+IHByZWZlcmVuY2Vz
IHNjcmVlbiAodGhlIGRlZmF1bHQgb24gaW5zdGFsbGF0aW9uIGlzICYjODIyMDtKdXN0IHBv
c3RlZDomIzgyMjE7KS48L3A+CgoJPHA+UGxlYXNlIG5vdGUgdGhhdCBvbmNlIGFuIGFydGlj
bGUgaGFzIGJlZW4gdHdlZXRlZCB0aGUgdHdlZXQgY2Fubm90IGJlIGVkaXRlZC48L3A+CgoJ
PGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYWRtaW4iPlRoZSBUd2l0dGVy
IHRhYjwvaDI+CgoJPHA+VW5kZXIgdGhlIEV4dGVuc2lvbnMgdGFiICh0aGlzIGNhbiBiZSBj
aGFuZ2VkIGZyb20gdGhlIHBsdWdpbiYjODIxNztzIHByZWZlcmVuY2UgcGFnZSkgYSBuZXcg
VHdpdHRlciB0YWIgc2hvdWxkIGFwcGVhciBvbmNlIHlvdSBoYXZlIGNvbm5lY3RlZCB5b3Vy
IHNpdGUgdG8geW91ciBUd2l0dGVyIGFjY291bnQuIEZyb20gaGVyZSB5b3Ugd2lsbCBiZSBh
YmxlIHRvIHN1Ym1pdCBuZXcgVHdpdHRlciB1cGRhdGVzLCB2aWV3IGJhc2ljIGFjY291bnQg
c3RhdGlzdGljcywgYW5kIGNoZWNrIG91dCB5b3VyIHJlY2VudCB1cGRhdGVzIChpbmNsdWRp
bmcgdGhlIG9wdGlvbiB0byBkZWxldGUgeW91ciB0d2VldHMpLjwvcD4iO3M6NDoiY29kZSI7
czo2NzMxMzoiZ2xvYmFsICRwcmVmcywkdHhwY2ZnLCRhcmNfdHdpdHRlcl9jb25zdW1lcktl
eSwkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgokYXJjX3R3aXR0ZXIgPSBhcnJheSgp
OwoKJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5ID0gJ25LY1hzbHd6WmhCZDBrZktNZXRuUEEn
OwokYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQgPSAnQzZuU1BDTDNlZUhHVEJoS0Nnd2Q5
b2NsY3VEMHNyQjhXVmtmWFFZQzU0JzsKCmFkZF9wcml2cygncGx1Z2luX3ByZWZzLmFyY190
d2l0dGVyJywnMSwyJyk7CnJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfdHdpdHRlcl9pbnN0YWxs
JywncGx1Z2luX2xpZmVjeWNsZS5hcmNfdHdpdHRlcicsICdpbnN0YWxsZWQnKTsKcmVnaXN0
ZXJfY2FsbGJhY2soJ2FyY190d2l0dGVyX3VuaW5zdGFsbCcsJ3BsdWdpbl9saWZlY3ljbGUu
YXJjX3R3aXR0ZXInLCAnZGVsZXRlZCcpOwpyZWdpc3Rlcl9jYWxsYmFjaygnYXJjX3R3aXR0
ZXJfcHJlZnMnLCdwbHVnaW5fcHJlZnMuYXJjX3R3aXR0ZXInKTsKCgppZiAoIWlzc2V0KCRw
cmVmc1snYXJjX3R3aXR0ZXJfdXNlciddKSkKICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl91
c2VyJywgJycsICdhcmNfdHdpdHRlcicsIDEsICd0ZXh0X2lucHV0Jyk7CmlmICghaXNzZXQo
JHByZWZzWydhcmNfdHdpdHRlcl9wcmVmaXgnXSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVy
X3ByZWZpeCcsJ0p1c3QgcG9zdGVkOicsICdhcmNfdHdpdHRlcicsIDIsICd0ZXh0X2lucHV0
Jyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXSkpCiAgc2V0
X3ByZWYoJ2FyY190d2l0dGVyX2NhY2hlX2RpcicsJHR4cGNmZ1sndHhwYXRoJ10uJHByZWZz
Wyd0ZW1wZGlyJ10sICdhcmNfdHdpdHRlcicsIDEsICd0ZXh0X2lucHV0Jyk7CmlmICghaXNz
ZXQoJHByZWZzWydhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0J10pKQogIHNldF9wcmVmKCdh
cmNfdHdpdHRlcl90d2VldF9kZWZhdWx0JywgMSwgJ2FyY190d2l0dGVyJywgMiwgJ3llc25v
UmFkaW8nKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX3VybF9tZXRob2QnXSkp
CiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3VybF9tZXRob2QnLCAndGlueXVybCcsICdhcmNf
dHdpdHRlcicsIDIsCiAgICAnYXJjX3R3aXR0ZXJfdXJsX21ldGhvZF9zZWxlY3QnKTsKLy8g
TWFrZSBzdXJlIHRoYXQgdGhlIFR3aXR0ZXIgdGFiIGhhcyBiZWVuIGRlZmluZWQKaWYgKCFp
c3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddKSkgewogIHNldF9wcmVmKCdhcmNfdHdp
dHRlcl90YWInLCAnZXh0ZW5zaW9ucycsICdhcmNfdHdpdHRlcicsIDIsCiAgICAnYXJjX3R3
aXR0ZXJfdGFiX3NlbGVjdCcpOwogICAgJHByZWZzWydhcmNfdHdpdHRlcl90YWInXSA9ICdl
eHRlbnNpb25zJzsKfQoKaWYgKEB0eHBpbnRlcmZhY2UgPT0gJ2FkbWluJykgewogICAgaWYg
KCFlbXB0eSgkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSkKICAgICAgICAmJiAhZW1wdHko
JHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddKQogICAgICAgICYmICFlbXB0eSgk
cHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0J10pICkgewoKICAgICAgICBp
ZiAoJHByZWZzWydhcmNfdHdpdHRlcl90YWInXSkgewogICAgICAgICAgICBhZGRfcHJpdnMo
J2FyY19hZG1pbl90d2l0dGVyJywgJzEsMiwzLDQnKTsKICAgICAgICAgICAgcmVnaXN0ZXJf
dGFiKCRwcmVmc1snYXJjX3R3aXR0ZXJfdGFiJ10sICdhcmNfYWRtaW5fdHdpdHRlcicsICdU
d2l0dGVyJyk7CiAgICAgICAgICAgIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYWRtaW5fdHdp
dHRlcicsICdhcmNfYWRtaW5fdHdpdHRlcicpOwogICAgICAgIH0KCiAgICAgICAgcmVnaXN0
ZXJfY2FsbGJhY2soJ2FyY19hcnRpY2xlX3R3ZWV0JywgJ3BpbmcnKTsKICAgICAgICByZWdp
c3Rlcl9jYWxsYmFjaygnYXJjX2FydGljbGVfdHdlZXQnLCAnYXJ0aWNsZScsICdlZGl0Jywg
MSk7CiAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hcHBlbmRfdHdpdHRlcicsICdh
cnRpY2xlX3VpJywgJ3N0YXR1cycpOwogICAgfQp9CgovKgogICAgUHVibGljLXNpZGUgZnVu
Y3Rpb25zCiAgICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09CiovCgpmdW5jdGlvbiBhcmNfdHdpdHRlcigkYXR0cykK
ewogIGdsb2JhbCAkcHJlZnMsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0
ZXJfY29uc3VtZXJTZWNyZXQ7CgogIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAndXNlcicg
ICAgICA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSwKICAgICdwYXNzd29yZCcgID0+
ICcnLAogICAgJ3RpbWVsaW5lJyAgPT4gJ3VzZXInLAogICAgJ2xpbWl0JyAgICAgPT4gJzEw
JywKICAgICdyZXR3ZWV0cycgID0+IGZhbHNlLAogICAgJ2RhdGVmb3JtYXQnPT4gJHByZWZz
WydhcmNoaXZlX2RhdGVmb3JtYXQnXSwKICAgICdjYWNoaW5nJyAgID0+ICcxJywKICAgICdj
YWNoZV9kaXInID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10sCiAgICAnY2Fj
aGVfdGltZSc9PiAnNScsCiAgICAnbGFiZWwnICAgICA9PiAnJywKICAgICdsYWJlbHRhZycg
ID0+ICcnLAogICAgJ2JyZWFrJyAgICAgPT4gJ2xpJywKICAgICd3cmFwdGFnJyAgID0+ICcn
LAogICAgJ2NsYXNzJyAgICAgPT4gX19GVU5DVElPTl9fLAogICAgJ2NsYXNzX3Bvc3RlZCcg
PT4gX19GVU5DVElPTl9fLictcG9zdGVkJwogICAgKSwkYXR0cykpOwoKICAkdHdpdCA9IG5l
dyBhcmNfVHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRlcl9j
b25zdW1lclNlY3JldCk7CgogIGlmICgkY2FjaGluZykgeyAgLy8gdHVybiBvbiBjYWNoaW5n
LCByZWNvbW1lbmRlZCAoZGVmYXVsdCkKICAgICR0d2l0LT5zZXRDYWNoaW5nKHRydWUpOwog
ICAgJHR3aXQtPmNhY2hlRGlyKCRjYWNoZV9kaXIpOwogICAgJHR3aXQtPmNhY2hlVGltZSgk
Y2FjaGVfdGltZSk7CiAgfSBlbHNlIHsgIC8vIHR1cm4gb2ZmIGNhY2hpbmcsIG5vdCByZWNv
bW1lbmRlZCBvdGhlciB0aGFuIGZvciB0ZXN0aW5nCiAgICAkdHdpdC0+c2V0Q2FjaGluZyhm
YWxzZSk7CiAgfQoKICBzd2l0Y2ggKCR0aW1lbGluZSkgewogICAgY2FzZSAnaG9tZSc6IGNh
c2UgJ2ZyaWVuZHMnOgogICAgICAkdGltZWxpbmUgPSAnc3RhdHVzZXMvZnJpZW5kc190aW1l
bGluZSc7IGJyZWFrOwogICAgY2FzZSAnbWVudGlvbnMnOgogICAgICAkdGltZWxpbmUgPSAn
c3RhdHVzZXMvbWVudGlvbnMnOyBicmVhazsKICAgIGNhc2UgJ3VzZXInOiBkZWZhdWx0OiAk
dGltZWxpbmUgPSAnc3RhdHVzZXMvdXNlcl90aW1lbGluZSc7CiAgfQoKICAkb3V0ID0gYXJy
YXkoKTsKICAkeG1sID0gJHR3aXQtPmdldCgkdGltZWxpbmUKICAgICwgYXJyYXkoJ3NjcmVl
bl9uYW1lJz0+JHVzZXIsJ2NvdW50Jz0+JGxpbWl0LCdpbmNsdWRlX3J0cyc9PiRyZXR3ZWV0
cykpOwogIGlmICgkeG1sKSB7CiAgICAkdHdlZXRzID0gQCR4bWwtPnhwYXRoKCcvc3RhdHVz
ZXMvc3RhdHVzJyk7CiAgICBpZiAoJHR3ZWV0cykgZm9yZWFjaCAoJHR3ZWV0cyBhcyAkdHdl
ZXQpIHsKICAgICAgJHRpbWUgPSBzdHJ0b3RpbWUoaHRtbGVudGl0aWVzKCR0d2VldC0+Y3Jl
YXRlZF9hdCkpOwogICAgICAkZGF0ZSA9IHNhZmVfc3RyZnRpbWUoJGRhdGVmb3JtYXQsJHRp
bWUpOwogICAgICAkb3V0W10gPSBhcmNfVHdpdHRlcjo6bWFrZUxpbmtzKGh0bWxlbnRpdGll
cygkdHdlZXQtPnRleHQsIEVOVF9RVU9URVMsJ1VURi04JykpCiAgICAgICAgLicgJy50YWco
aHRtbGVudGl0aWVzKCRkYXRlKSwnc3BhbicsJyBjbGFzcz0iJy4kY2xhc3NfcG9zdGVkLici
Jyk7CiAgICB9CgogICAgcmV0dXJuIGRvTGFiZWwoJGxhYmVsLCAkbGFiZWx0YWcpLmRvV3Jh
cCgkb3V0LCAkd3JhcHRhZywgJGJyZWFrLCAkY2xhc3MpOwogIH0KCn0KCmZ1bmN0aW9uIGFy
Y190d2l0dGVyX3NlYXJjaCgkYXR0cykKewogICAgZ2xvYmFsICRwcmVmcywkYXJjX3R3aXR0
ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiAgICBleHRy
YWN0KGxBdHRzKGFycmF5KAogICAgICAgICd1c2VyJyAgICAgID0+ICRwcmVmc1snYXJjX3R3
aXR0ZXJfdXNlciddLAogICAgICAgICdzZWFyY2gnICAgID0+ICcnLAogICAgICAgICdoYXNo
dGFncycgID0+ICcnLAogICAgICAgICd1c2VyJyAgICAgID0+ICcnLAogICAgICAgICdyZXBs
eScgICAgID0+ICcnLAogICAgICAgICdtZW50aW9uJyAgID0+ICcnLAogICAgICAgICdsaW1p
dCcgICAgID0+ICcxMCcsCiAgICAgICAgJ2xhbmcnICAgICAgPT4gJycsCiAgICAgICAgJ2Rh
dGVmb3JtYXQnPT4gJHByZWZzWydhcmNoaXZlX2RhdGVmb3JtYXQnXSwKICAgICAgICAnY2Fj
aGluZycgICA9PiAnMScsCiAgICAgICAgJ2NhY2hlX2RpcicgPT4gJHByZWZzWydhcmNfdHdp
dHRlcl9jYWNoZV9kaXInXSwKICAgICAgICAnY2FjaGVfdGltZSc9PiAnNScsCiAgICAgICAg
J2xhYmVsJyAgICAgPT4gJycsCiAgICAgICAgJ2xhYmVsdGFnJyAgPT4gJycsCiAgICAgICAg
J2JyZWFrJyAgICAgPT4gJ2xpJywKICAgICAgICAnd3JhcHRhZycgICA9PiAnJywKICAgICAg
ICAnY2xhc3MnICAgICA9PiBfX0ZVTkNUSU9OX18sCiAgICAgICAgJ2NsYXNzX3Bvc3RlZCcg
PT4gX19GVU5DVElPTl9fLictcG9zdGVkJywKICAgICAgICAnY2xhc3NfdXNlcicgICA9PiBf
X0ZVTkNUSU9OX18uJy11c2VyJwogICAgKSwkYXR0cykpOwoKICAgICAgICAkdHdpdCA9IG5l
dyBhcmNfVHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgLCAk
YXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQpOwoKICAgICAgICBpZiAoJGNhY2hpbmcpIHsg
IC8vIHR1cm4gb24gY2FjaGluZywgcmVjb21tZW5kZWQgKGRlZmF1bHQpCiAgICAgICAgICAg
ICR0d2l0LT5zZXRDYWNoaW5nKHRydWUpOwogICAgICAgICAgICAkdHdpdC0+Y2FjaGVEaXIo
JGNhY2hlX2Rpcik7CiAgICAgICAgICAgICR0d2l0LT5jYWNoZVRpbWUoJGNhY2hlX3RpbWUp
OwogICAgICAgIH0gZWxzZSB7ICAvLyB0dXJuIG9mZiBjYWNoaW5nLCBub3QgcmVjb21tZW5k
ZWQgb3RoZXIgdGhhbiBmb3IgdGVzdGluZwogICAgICAgICAgICAkdHdpdC0+c2V0Q2FjaGlu
ZyhmYWxzZSk7CiAgICAgICAgfQoKICAgICAgICAvLyBjb25zdHJ1Y3Qgc2VhcmNoIHF1ZXJ5
CiAgICAgICAgaWYgKCFlbXB0eSgkc2VhcmNoKSkgewogICAgICAgICAgICAkdGVybXMgPSBl
eHBsb2RlKCcsJywkc2VhcmNoKTsgJHRlcm1zID0gYXJyYXlfbWFwKCd0cmltJywkdGVybXMp
OwogICAgICAgICAgICAkc2VhcmNoID0gaW1wbG9kZSgnICcsJHRlcm1zKTsKICAgICAgICB9
CiAgICAgICAgaWYgKCRoYXNodGFncykgewogICAgICAgICAgICAkaGFzaGVzID0gZXhwbG9k
ZSgnLCcsJGhhc2h0YWdzKTsgJGhhc2hlcyA9IGFycmF5X21hcCgndHJpbScsJGhhc2hlcyk7
CiAgICAgICAgICAgICRzZWFyY2guPSAoKCRzZWFyY2gpPycgJzonJykuJyMnLmltcGxvZGUo
JyAjJywkaGFzaGVzKTsKICAgICAgICB9CiAgICAgICAgaWYgKCRyZXBseSkgewogICAgICAg
ICAgICAkc2VhcmNoLj0gKCgkc2VhcmNoKT8nICc6JycpLid0bzonLnRyaW0oJHJlcGx5KTsK
ICAgICAgICB9CiAgICAgICAgaWYgKCR1c2VyKSB7CiAgICAgICAgICAgICRzZWFyY2guPSAo
KCRzZWFyY2gpPycgJzonJykuJ2Zyb206Jy50cmltKCR1c2VyKTsKICAgICAgICB9CiAgICAg
ICAgaWYgKCRtZW50aW9uKSB7CiAgICAgICAgICAgICRzZWFyY2guPSAoKCRzZWFyY2gpPycg
JzonJykuJ0AnLnRyaW0oJG1lbnRpb24pOwogICAgICAgIH0KCiAgICAgICAgaWYgKGVtcHR5
KCRzZWFyY2gpKSB7CiAgICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICB9IGVsc2Ugewog
ICAgICAgICAgICAkc2VhcmNoID0gdXJsZW5jb2RlKCRzZWFyY2gpOwogICAgICAgIH0KCiAg
ICAgICAgJG91dCA9IGFycmF5KCk7CiAgICAgICAgJHR3ZWV0cyA9ICR0d2l0LT5nZXQoJ2h0
dHA6Ly9zZWFyY2gudHdpdHRlci5jb20vc2VhcmNoLmF0b20/cT0nLiRzZWFyY2gKICAgICAg
ICAgICAgLCBhcnJheSgncnBwJz0+JGxpbWl0LCdsYW5nJz0+JGxhbmcpKTsKCiAgICAgICAg
aWYgKCR0d2VldHMpIHsgZm9yZWFjaCAoJHR3ZWV0cy0+ZW50cnkgYXMgJHR3ZWV0KSB7CiAg
ICAgICAgICAgIHByZWdfbWF0Y2goIi8oLiopIFwoKC4qKVwpLyIsJHR3ZWV0LT5hdXRob3It
Pm5hbWUsJG1hdGNoZXMpOwogICAgICAgICAgICBsaXN0KCRhdXRob3IsJHVuYW1lLCRuYW1l
KSA9ICRtYXRjaGVzOwogICAgICAgICAgICAkdGltZSA9IHN0cnRvdGltZShodG1sZW50aXRp
ZXMoJHR3ZWV0LT5wdWJsaXNoZWQpKTsKICAgICAgICAgICAgJGRhdGUgPSBzYWZlX3N0cmZ0
aW1lKCRkYXRlZm9ybWF0LCR0aW1lKTsKICAgICAgICAgICAgJHRleHQgPSAkdHdlZXQtPnRp
dGxlOwogICAgICAgICAgICAkb3V0W10gPSB0YWcoaHJlZihodG1sZW50aXRpZXMoJHVuYW1l
KSwkdHdlZXQtPmF1dGhvci0+dXJpLAogICAgICAgICAgICAgICAgJyB0aXRsZT0iJy5odG1s
ZW50aXRpZXMoJG5hbWUpLiciJykuJzogJywnc3BhbicKICAgICAgICAgICAgICAgICAgICAs
JyBjbGFzcz0iJy4kY2xhc3NfdXNlci4nIicpCiAgICAgICAgICAgICAgICAuYXJjX1R3aXR0
ZXI6Om1ha2VMaW5rcyhodG1sZW50aXRpZXMoJHRleHQsIEVOVF9RVU9URVMsJ1VURi04Jykp
CiAgICAgICAgICAgICAgICAuJyAnLnRhZyhodG1sZW50aXRpZXMoJGRhdGUpLCdzcGFuJwog
ICAgICAgICAgICAgICAgICAgICwnIGNsYXNzPSInLiRjbGFzc19wb3N0ZWQuJyInKTsKICAg
ICAgICB9IHJldHVybiBkb0xhYmVsKCRsYWJlbCwgJGxhYmVsdGFnKQogICAgICAgICAgICAu
ZG9XcmFwKCRvdXQsICR3cmFwdGFnLCAkYnJlYWssICRjbGFzcyk7IH0KCn0KCmZ1bmN0aW9u
IGFyY190d2l0dGVyX3R3ZWV0KCRhdHRzKSB7CiAgICBnbG9iYWwgJHRoaXNhcnRpY2xlOwoK
ICAgIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICdpZCcgICAgICAgID0+ICR0aGlzYXJ0
aWNsZVsndGhpc2lkJ10sCiAgICAgICdpbmNsdWRlX3VybCcgICA9PiB0cnVlCiAgICApLCRh
dHRzKSk7CgogICAgaWYgKCRpZCkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVm
ZiB0byBidWlsZCB0d2VldCBmcm9tCiAgICAgICR0d2VldCA9ICgkaW5jbHVkZV91cmwpID8g
c2FmZV9yb3coInR3ZWV0IiwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKQog
ICAgICAgIDogc2FmZV9yb3coIlJFUExBQ0UodHdlZXQsQ09OQ0FUKCcgJyx0aW55dXJsKSwn
JykgQVMgdHdlZXQiCiAgICAgICAgICAsICdhcmNfdHdpdHRlcicsICJhcnRpY2xlX2lkPXsk
aWR9Iik7CiAgICB9CgogICAgaWYgKCR0d2VldFsndHdlZXQnXSkgewogICAgICByZXR1cm4g
YXJjX1R3aXR0ZXI6Om1ha2VMaW5rcygKICAgICAgICBodG1sZW50aXRpZXMoJHR3ZWV0Wyd0
d2VldCddLCBFTlRfUVVPVEVTLCdVVEYtOCcpKTsKICAgIH0KfQoKZnVuY3Rpb24gYXJjX3R3
aXR0ZXJfdHdlZXRfdXJsKCRhdHRzLCAkdGhpbmc9bnVsbCkgewogICAgZ2xvYmFsICR0aGlz
YXJ0aWNsZSwkcHJlZnM7CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgJ2lkJyAg
ICAgID0+ICR0aGlzYXJ0aWNsZVsndGhpc2lkJ10sCiAgICAgICd0aXRsZScgICA9PiAnJywK
ICAgICAgJ2NsYXNzJyAgID0+ICcnCiAgICApLCRhdHRzKSk7CgogICAgaWYgKCRpZCkgewog
ICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBmcm9tCiAg
ICAgICR0d2VldCA9IHNhZmVfcm93KCJ0d2VldF9pZCIKICAgICAgICAsICdhcmNfdHdpdHRl
cicsICJhcnRpY2xlX2lkPXskaWR9Iik7CiAgICB9CgogICAgaWYgKCR0d2VldFsndHdlZXRf
aWQnXSkgewogICAgICAkdXJsID0gImh0dHA6Ly90d2l0dGVyLmNvbS8iLiRwcmVmc1snYXJj
X3R3aXR0ZXJfdXNlciddLiIvc3RhdHVzLyIuJHR3ZWV0Wyd0d2VldF9pZCddOwogICAgICBp
ZiAoJHRoaW5nPT09bnVsbCkgewogICAgICAgIHJldHVybiAkdXJsOwogICAgICB9CiAgICAg
IHJldHVybiBocmVmKHBhcnNlKCR0aGluZyksICR1cmwsCiAgICAgICAgKCR0aXRsZSA/ICcg
dGl0bGU9IicuJHRpdGxlLiciJyA6ICcnKQogICAgICAgIC4oJGNsYXNzID8gJyBjbGFzcz0i
Jy4kY2xhc3MuJyInIDogJycpKTsKICAgIH0KfQoKZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdGlu
eXVybCgkYXR0cywgJHRoaW5nPW51bGwpIHsKICAgIGdsb2JhbCAkdGhpc2FydGljbGU7Cgog
ICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgJ2lkJyAgICAgID0+ICR0aGlzYXJ0aWNs
ZVsndGhpc2lkJ10sCiAgICAgICd0aXRsZScgICA9PiAnJywKICAgICAgJ2NsYXNzJyAgID0+
ICcnCiAgICApLCRhdHRzKSk7CgogICAgaWYgKCRpZCkgewogICAgICAvLyBGZXRjaCBhcmNf
dHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2VldCBmcm9tCiAgICAgICR0d2VldCA9IHNhZmVf
cm93KCJ0aW55dXJsIgogICAgICAgICwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRp
ZH0iKTsKICAgIH0KCiAgICBpZiAoJHR3ZWV0Wyd0aW55dXJsJ10pIHsKICAgICAgaWYgKCR0
aGluZz09PW51bGwpIHsKICAgICAgICByZXR1cm4gJHR3ZWV0Wyd0aW55dXJsJ107CiAgICAg
IH0KCiAgICAgIHJldHVybiBocmVmKHBhcnNlKCR0aGluZyksICR0d2VldFsndGlueXVybCdd
LAogICAgICAgICgkdGl0bGUgPyAnIHRpdGxlPSInLiR0aXRsZS4nIicgOiAnJykKICAgICAg
ICAuKCRjbGFzcyA/ICcgY2xhc3M9IicuJGNsYXNzLiciJyA6ICcnKSk7CiAgICB9Cn0KCmZ1
bmN0aW9uIGFyY190d2l0dGVyX3JldHdlZXQoJGF0dHMsICR0aGluZz1udWxsKQp7CiAgICBn
bG9iYWwgJHByZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2Nv
bnN1bWVyU2VjcmV0OwogICAgZ2xvYmFsICR0aGlzYXJ0aWNsZTsKCiAgICBleHRyYWN0KGxB
dHRzKGFycmF5KAogICAgICAgICd1c2VyJyAgICAgID0+ICRwcmVmc1snYXJjX3R3aXR0ZXJf
dXNlciddLCAvLyB2aWEgdXNlciBhY2NvdW50CiAgICAgICAgJ3VybCcgICAgICAgPT4gJycs
CiAgICAgICAgJ3RleHQnICAgICAgPT4gJycsCiAgICAgICAgJ2ZvbGxvdzEnICAgPT4gJycs
CiAgICAgICAgJ2ZvbGxvdzInICAgPT4gJycsCiAgICAgICAgJ2xhbmcnICAgICAgPT4gJycs
CiAgICAgICAgJ2NvdW50JyAgICAgPT4gJ2hvcml6b250YWwnLAogICAgICAgICdpbmNsdWRl
X2pzJz0+IHRydWUsCiAgICAgICAgJ3dyYXB0YWcnICAgPT4gJycsCiAgICAgICAgJ2NsYXNz
JyAgICAgPT4gJ3R3aXR0ZXItc2hhcmUtYnV0dG9uJwogICAgKSwkYXR0cykpOwoKICAgICRx
ID0gJyc7IC8vIHF1ZXJ5IHN0cmluZwoKICAgIGlmICgkaWQ9JHRoaXNhcnRpY2xlWyd0aGlz
aWQnXSkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0byBidWlsZCB0d2Vl
dCBmcm9tCiAgICAgICRyb3cgPSBzYWZlX3JvdygiUkVQTEFDRSh0d2VldCxDT05DQVQoJyAn
LHRpbnl1cmwpLCcnKSBBUyB0d2VldCx0aW55dXJsIgogICAgICAgICwgJ2FyY190d2l0dGVy
JywgImFydGljbGVfaWQ9eyRpZH0iKTsKCiAgICAgIGlmICgkdXJsPT0nJykgewogICAgICAg
ICR1cmwgPSAoJHVybCkgPyAkdXJsIDogcGVybWxpbmt1cmwoJHRoaXNhcnRpY2xlKTsKICAg
ICAgICAkcSA9ICd1cmw9Jy51cmxlbmNvZGUoJHVybCk7CiAgICAgIH0KICAgICAgaWYgKCR0
ZXh0PT0nJykgewogICAgICAgICR0ZXh0ID0gKCRyb3dbJ3R3ZWV0J10pID8gJHJvd1sndHdl
ZXQnXSA6ICR0aGlzYXJ0aWNsZVsndGl0bGUnXTsKICAgICAgfQogICAgICAkcSAuPSAoJHEg
PyAnJmFtcDsnIDogJycpLid0ZXh0PScudXJsZW5jb2RlKCR0ZXh0KTsKICAgIH0KICAgIGlm
ICgkdXNlcikgewogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLid2aWE9Jy51cmxl
bmNvZGUoJHVzZXIpOwogICAgfQogICAgaWYgKCRmb2xsb3cxJiYkZm9sbG93MikgewogICAg
ICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidyZWxhdGVkPScudXJsZW5jb2RlKCRmb2xs
b3cxLic6Jy4kZm9sbG93Mik7CiAgICB9IGVsc2VpZiAoJGZvbGxvdzF8fCRmb2xsb3cyKSB7
CiAgICAgICRxIC49ICgkcSA/ICcmYW1wOycgOiAnJykuJ3JlbGF0ZWQ9Jy51cmxlbmNvZGUo
JGZvbGxvdzEuJGZvbGxvdzIpOwogICAgfQoKICAgIHN3aXRjaCAoJGxhbmcpIHsKICAgICAg
Y2FzZSAnZnInOiBicmVhazsgY2FzZSAnZGUnOiBicmVhazsgY2FzZSAnZXMnOiBicmVhazsg
Y2FzZSAnanAnOiBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICAkbGFuZyA9ICdlbic7
CiAgICB9CiAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidsYW5nPScudXJsZW5jb2Rl
KCRsYW5nKTsKCiAgICBzd2l0Y2ggKCRjb3VudCkgewogICAgICBjYXNlICdub25lJzogYnJl
YWs7IGNhc2UgJ3ZlcnRpY2FsJzogYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgJGNv
dW50ID0gJ2hvcml6b250YWwnOwogICAgfQogICAgJHEgLj0gKCRxID8gJyZhbXA7JyA6ICcn
KS4nY291bnQ9Jy51cmxlbmNvZGUoJGNvdW50KTsKCiAgICAkdGhpbmcgPSAoJHRoaW5nPT09
bnVsbCkgPyAnVHdlZXQnIDogcGFyc2UoJHRoaW5nKTsKCiAgICAkaHRtbCA9IGhyZWYoJHRo
aW5nLCdodHRwOi8vdHdpdHRlci5jb20vc2hhcmU/Jy4kcQogICAgICAsICcgY2xhc3M9Iicu
JGNsYXNzLiciJyk7CgogICAgJGpzID0gKCRpbmNsdWRlX2pzKSA/CiAgICAgICc8c2NyaXB0
IHNyYz0iaHR0cDovL3BsYXRmb3JtLnR3aXR0ZXIuY29tL3dpZGdldHMuanMiIHR5cGU9InRl
eHQvamF2YXNjcmlwdCI+PC9zY3JpcHQ+JwogICAgICA6ICcnOwoKICAgIHJldHVybiAkanMu
JGh0bWw7Cn0KCi8qCiAgICBBZG1pbi1zaWRlIGZ1bmN0aW9ucwogICAgPT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoq
LwoKLy8gSW5zdGFsbGF0aW9uIGZ1bmN0aW9uIC0gYnVpbGRzIE15U1FMIHRhYmxlCmZ1bmN0
aW9uIGFyY190d2l0dGVyX2luc3RhbGwoKQp7CgogICAgLy8gRm9yIGZpcnN0IGluc3RhbGws
IGNyZWF0ZSB0YWJsZSBmb3IgdHdlZXRzCiAgICAkc3FsID0gIkNSRUFURSBUQUJMRSBJRiBO
T1QgRVhJU1RTICIuUEZYLiJhcmNfdHdpdHRlciAiOwogICAgJHNxbC49ICIoYXJjX3R3aXR0
ZXJpZCBJTlRFR0VSIEFVVE9fSU5DUkVNRU5UIFBSSU1BUlkgS0VZLAogICAgICAgIGFydGlj
bGVfaWQgSU5URUdFUigxMSksCiAgICAgICAgdHdlZXRfaWQgQklHSU5UKDIwKSwKICAgICAg
ICB0d2VldCBWQVJDSEFSKDE0MCksCiAgICAgICAgdGlueXVybCBWQVJDSEFSKDMwKSk7IjsK
CiAgICBpZiAoIXNhZmVfcXVlcnkoJHNxbCkpIHsKICAgICAgICByZXR1cm4gJ0Vycm9yIC0g
dW5hYmxlIHRvIGNyZWF0ZSBhcmNfdHdpdHRlciB0YWJsZSc7CiAgICB9Cgp9CgovLyBVbmlu
c3RhbGwgZnVuY3Rpb24gLSBkZWxldGVzIE15U1FMIHRhYmxlIGFuZCByZWxhdGVkIHByZWZl
cmVuY2VzCmZ1bmN0aW9uIGFyY190d2l0dGVyX3VuaW5zdGFsbCgpCnsKCiAgICAkc3FsID0g
IkRST1AgVEFCTEUgSUYgRVhJU1RTICIuUEZYLiJhcmNfdHdpdHRlcjsiOwogICAgaWYgKCFz
YWZlX3F1ZXJ5KCRzcWwpKSB7CiAgICAgICAgcmV0dXJuICdFcnJvciAtIHVuYWJsZSB0byBk
ZWxldGUgYXJjX3R3aXR0ZXIgdGFibGUnOwogICAgfQoKICAgICRzcWwgPSAiREVMRVRFIEZS
T00gICIuUEZYLiJ0eHBfcHJlZnMgV0hFUkUgZXZlbnQ9J2FyY190d2l0dGVyJzsiOwogICAg
aWYgKCFzYWZlX3F1ZXJ5KCRzcWwpKSB7CiAgICAgICAgcmV0dXJuICdFcnJvciAtIHVuYWJs
ZSB0byBkZWxldGUgYXJjX3R3aXR0ZXIgcHJlZmVyZW5jZXMnOwogICAgfQoKfQpmdW5jdGlv
biBhcmNfdHdpdHRlcl91cmxfbWV0aG9kX3NlbGVjdCgkbmFtZSwgJHZhbCkKewogICAgJG1l
dGhvZHMgPSBhcnJheSgndGlueXVybCcgPT4gJ1Rpbnl1cmwnLCAnaXNnZCcgPT4gJ0lzLmdk
JywgJ3NtZCcgPT4gJ3NtZF9zaG9ydF91cmwnKTsKICAgIHJldHVybiBzZWxlY3RJbnB1dCgk
bmFtZSwgJG1ldGhvZHMsICR2YWwpOwp9CmZ1bmN0aW9uIGFyY190d2l0dGVyX3RhYl9zZWxl
Y3QoJG5hbWUsICR2YWwpCnsKICAgICR0YWJzID0gYXJyYXkoJ2NvbnRlbnQnID0+ICdDb250
ZW50JywKICAgICAgICAnZXh0ZW5zaW9ucycgPT4gJ0V4dGVuc2lvbnMnLAogICAgICAgICcn
ID0+ICdIaWRkZW4nKTsKICAgIHJldHVybiBzZWxlY3RJbnB1dCgkbmFtZSwgJHRhYnMsICR2
YWwpOwp9Ci8vIFByb3ZpZGUgaW50ZXJmYWNlIGZvciBzZXR0aW5nIHByZWZlcmVuY2VzCmZ1
bmN0aW9uIGFyY190d2l0dGVyX3ByZWZzKCRldmVudCwkc3RlcCkKewoKICAgIGdsb2JhbCAk
cHJlZnMsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCRhcmNfdHdpdHRlcl9jb25zdW1lclNl
Y3JldDsKCiAgICAkdXNlciAgICAgICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlcidd
OwogICAgJHByZWZpeCAgICAgICAgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3ByZWZpeCddOwog
ICAgJHR3ZWV0X2RlZmF1bHQgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQn
XTsKICAgICR1cmxfbWV0aG9kICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl91cmxfbWV0aG9k
J107CiAgICAkY2FjaGVfZGlyICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVfZGly
J107CiAgICAkdGFiICAgICAgICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfdGFiJ107Cgog
ICAgc3dpdGNoICgkc3RlcCkgewogICAgICAgIGNhc2UgJ3ByZWZzX3NhdmUnOiBwYWdldG9w
KCdUWFAgVHdlZXQnLCAnUHJlZmVyZW5jZXMgc2F2ZWQnKTsgYnJlYWs7CiAgICAgICAgY2Fz
ZSAncmVnaXN0ZXInOiBwYWdldG9wKCdUWFAgVHdlZXQnLCdDb25uZWN0IHRvIFR3aXR0ZXIn
KTsgYnJlYWs7CiAgICAgICAgY2FzZSAndmFsaWRhdGUnOgogICAgICAgIGRlZmF1bHQ6IHBh
Z2V0b3AoJ1RYUCBUd2VldCcpOwogICAgfQoKICAgICRodG1sID0gJyc7CgogICAgaWYgKCRz
dGVwPT0ncmVnaXN0ZXInKSB7IC8vIE9BdXRoIHJlZ2lzdHJhdGlvbiBwcm9jZXNzCiAgICAg
ICAgJHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAg
ICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0KTsKCiAgICAgICAgLy8g
QnVpbGQgYSBjYWxsYmFjayBVUkwgZm9yIFR3aXR0ZXIgdG8gcmV0dXJuIHRvIHRoZSBuZXh0
IHN0YWdlCiAgICAgICAgJGNhbGxiYWNrVVJMID0gJHR3aXQtPmNhbGxiYWNrVVJMKCRldmVu
dCwndmFsaWRhdGUnKTsKCiAgICAgICAgJHJlcXVlc3QgPSAkdHdpdC0+Z2V0UmVxdWVzdFRv
a2VuKCRjYWxsYmFja1VSTCk7CiAgICAgICAgJHJlcXVlc3RfdG9rZW4gPSAkcmVxdWVzdFsi
b2F1dGhfdG9rZW4iXTsKICAgICAgICAkcmVxdWVzdF90b2tlbl9zZWNyZXQgPSAkcmVxdWVz
dFsib2F1dGhfdG9rZW5fc2VjcmV0Il07CgogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRl
cl9yZXF1ZXN0VG9rZW4nLCRyZXF1ZXN0X3Rva2VuCiAgICAgICAgICAgICwgJ2FyY190d2l0
dGVyJywyKTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfcmVxdWVzdFRva2VuU2Vj
cmV0JywkcmVxdWVzdF90b2tlbl9zZWNyZXQKICAgICAgICAgICAgLCAnYXJjX3R3aXR0ZXIn
LDIpOwoKICAgICAgICAkaHRtbC49IHN0YXJ0VGFibGUoJ2VkaXQnKS4KICAgICAgICAgICAg
ICAgIHRyKHRkKAogICAgICAgICAgICAgICAgICAgICgnPHA+Jy5ocmVmKCdTaWduLWluIHRv
IFR3aXR0ZXInCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsJHR3aXQtPmdldEF1dGhv
cml6ZVVSTCgkcmVxdWVzdCkpCiAgICAgICAgICAgICAgICAgICAgICAgIC4nIGFuZCBmb2xs
b3cgdGhlIGluc3RydWN0aW9ucyB0byBhbGxvdyBUWFAgVHdlZXQgdG8gdXNlIHlvdXIgYWNj
b3VudC4gSWYgeW91IGFyZSBhbHJlYWR5IHNpZ25lZCBpbiB0byBUd2l0dGVyIHRoZW4gdGhh
dCBhY2NvdW50IHdpbGwgYmUgYXNzb2NpYXRlZCB3aXRoIFRYUCBUd2VldCBzbyB5b3UgbWF5
IG5lZWQgdG8gc2lnbiBvdXQgZmlyc3QgaWYgeW91IHdhbnQgdG8gdXNlIGEgZGlmZmVyZW50
IGFjY291bnQuPC9wPicpCiAgICAgICAgICAgICAgICApKS5lbmRUYWJsZSgpOwogICAgfSBl
bHNlaWYgKCRzdGVwPT0ndmFsaWRhdGUnKSB7CiAgICAgICAgJHR3aXQgPSBuZXcgYXJjX3R3
aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgICAgICwgJGFyY190d2l0
dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX3JlcXVlc3RUb2tlbidd
CiAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9yZXF1ZXN0VG9rZW5TZWNyZXQn
XSk7CiAgICAgICAgLy8gQXNrIFR3aXR0ZXIgZm9yIGFuIGFjY2VzcyB0b2tlbiAoYW5kIGFu
IGFjY2VzcyB0b2tlbiBzZWNyZXQpCiAgICAgICAgJHJlcXVlc3QgPSAkdHdpdC0+Z2V0QWNj
ZXNzVG9rZW4oIGdwcygnb2F1dGhfdmVyaWZpZXInKSApOwogICAgICAgICRhY2Nlc3NfdG9r
ZW4gPSAkcmVxdWVzdFsnb2F1dGhfdG9rZW4nXTsKICAgICAgICAkYWNjZXNzX3Rva2VuX3Nl
Y3JldCA9ICRyZXF1ZXN0WydvYXV0aF90b2tlbl9zZWNyZXQnXTsKICAgICAgICAkdXNlciA9
ICRyZXF1ZXN0WydzY3JlZW5fbmFtZSddOwogICAgICAgIC8vIFN0b3JlIHRoZSBhY2Nlc3Mg
dG9rZW4gYW5kIHNlY3JldAogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9hY2Nlc3NU
b2tlbicsJGFjY2Vzc190b2tlbiwgJ2FyY190d2l0dGVyJywyKTsKICAgICAgICBzZXRfcHJl
ZignYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnLCRhY2Nlc3NfdG9rZW5fc2VjcmV0
CiAgICAgICAgICAgICwgJ2FyY190d2l0dGVyJywyKTsKICAgICAgICBzZXRfcHJlZignYXJj
X3R3aXR0ZXJfdXNlcicsJHVzZXIpOwogICAgICAgICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNj
ZXNzVG9rZW4nXSA9ICRhY2Nlc3NfdG9rZW47CiAgICAgICAgJHByZWZzWydhcmNfdHdpdHRl
cl9hY2Nlc3NUb2tlblNlY3JldCddID0gJGFjY2Vzc190b2tlbl9zZWNyZXQ7CiAgICAgICAg
dW5zZXQoJHR3aXQpOwogICAgfQoKICAgIGlmICgkc3RlcD09InByZWZzX3NhdmUiKSB7CiAg
ICAgICAgJHByZWZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9wcmVmaXgnKSk7CiAgICAg
ICAgJHR3ZWV0X2RlZmF1bHQgPSBncHMoJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnKTsK
ICAgICAgICAkdXJsX21ldGhvZCA9IGdwcygnYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCcpOwog
ICAgICAgICRjYWNoZV9kaXIgPSBncHMoJ2FyY190d2l0dGVyX2NhY2hlX2RpcicpOwogICAg
ICAgICR0YWIgPSBncHMoJ2FyY190d2l0dGVyX3RhYicpOwogICAgICAgIGlmIChzdHJsZW4o
JHByZWZpeCk8PTIwKSB7CiAgICAgICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9wcmVm
aXgnLCRwcmVmaXgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICRwcmVmaXggPSAk
cHJlZnNbJ2FyY190d2l0dGVyX3ByZWZpeCddOwogICAgICAgIH0KICAgICAgICAkdHdlZXRf
ZGVmYXVsdCA9ICgkdHdlZXRfZGVmYXVsdCkgPyAxIDogMDsKICAgICAgICBzZXRfcHJlZign
YXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcsJHR3ZWV0X2RlZmF1bHQpOwogICAgICAgIHNl
dF9wcmVmKCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJywkdXJsX21ldGhvZCk7CiAgICAgICAg
c2V0X3ByZWYoJ2FyY190d2l0dGVyX2NhY2hlX2RpcicsJGNhY2hlX2Rpcik7CiAgICAgICAg
c2V0X3ByZWYoJ2FyY190d2l0dGVyX3RhYicsJHRhYik7CiAgICB9CgogICAgaWYgKCAkc3Rl
cCE9J3JlZ2lzdGVyJyApIHsKICAgICAgICBpZiAoIGlzc2V0KCRwcmVmc1snYXJjX3R3aXR0
ZXJfYWNjZXNzVG9rZW4nXSkKICAgICAgICAmJiBpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVy
X2FjY2Vzc1Rva2VuU2VjcmV0J10pICkgewogICAgICAgICAgICAkdHdpdCA9IG5ldyBhcmNf
dHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgICAgICwgJGFy
Y190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rv
a2VuJ10KICAgICAgICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tl
blNlY3JldCddKTsKICAgICAgICAgICAgJHJlZ2lzdGVyVVJMID0gJHR3aXQtPmNhbGxiYWNr
VVJMKCRldmVudCwncmVnaXN0ZXInKTsKICAgICAgICAgICAgJGh0bWwuPSBzdGFydFRhYmxl
KCdsaXN0JykuZm9ybSgKICAgICAgICAgICAgICAgIHRyKAogICAgICAgICAgICAgICAgICAg
IHRkY3MoaGVkKCdUd2l0dGVyIGFjY291bnQgZGV0YWlscycsIDIpLDIpCiAgICAgICAgICAg
ICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8
bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl91c2VyIj5Ud2l0dGVyIHVzZXJuYW1lPC9sYWJlbD4n
LAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsg
dmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoCiAg
ICAgICAgICAgICAgICAgICAgICAgICgkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSkgPwog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgJHVzZXIuJyAoJy5ocmVmKCdSZS1jb25uZWN0
JywkcmVnaXN0ZXJVUkwpLicpJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnPGVt
PnVua25vd248L2VtPicKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5ocmVmKCdDb25u
ZWN0IHRvIFR3aXR0ZXInLCRyZWdpc3RlclVSTCkpCiAgICAgICAgICAgICAgICApCiAgICAg
ICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAgICAgICAgdGRjcyhoZWQoJ1R3ZWV0IHNl
dHRpbmdzJywgMiksMikKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50cigK
ICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX2NhY2hl
X2RpciI+VHdlZXQgcHJlZml4PC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAn
IHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykK
ICAgICAgICAgICAgICAgICAgICAudGQoZklucHV0KCd0ZXh0JywnYXJjX3R3aXR0ZXJfcHJl
Zml4JywkcHJlZml4LCcnLCcnLCcnLCcnLCcnLCdhcmNfdHdpdHRlcl9wcmVmaXgnKSkKICAg
ICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9y
PSJhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0Ij5Ud2VldCBhcnRpY2xlcyBieSBkZWZhdWx0
PC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWdu
OiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAg
ICAudGQoeWVzbm9SYWRpbygnYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcsICR0d2VldF9k
ZWZhdWx0LCAnJywgJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnKSkKICAgICAgICAgICAg
ICAgICkudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdp
dHRlcl91cmxfbWV0aG9kIj5VUkwgc2hvcnRuZXI8L2xhYmVsPicsCiAgICAgICAgICAgICAg
ICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjog
bWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50ZChhcmNfdHdpdHRlcl91cmxfbWV0
aG9kX3NlbGVjdCgnYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCcsJHVybF9tZXRob2QpKQogICAg
ICAgICAgICAgICAgKS50cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVHdpdHRl
ciB0YWInLCAyKSwyKQogICAgICAgICAgICAgICAgKS50cigKICAgICAgICAgICAgICAgICAg
ICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX3RhYiI+TG9jYXRpb24gb2YgVHdpdHRl
ciB0YWI8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQt
YWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAg
ICAgICAgIC50ZChhcmNfdHdpdHRlcl90YWJfc2VsZWN0KCdhcmNfdHdpdHRlcl90YWInLCR0
YWIpKQogICAgICAgICAgICAgICAgKS50cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhl
ZCgnQ2FjaGUnLCAyKSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRy
KAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfY2Fj
aGVfZGlyIj5DYWNoZSBkaXJlY3Rvcnk8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAg
ICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxl
OyInKQogICAgICAgICAgICAgICAgICAgIC50ZChmSW5wdXQoJ3RleHQnLCdhcmNfdHdpdHRl
cl9jYWNoZV9kaXInLCRjYWNoZV9kaXIsJycsJycsJycsJycsJycsJ2FyY190d2l0dGVyX2Nh
Y2hlX2RpcicpKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAogICAg
ICAgICAgICAgICAgICAgIHRkYSgKICAgICAgICAgICAgICAgICAgICAgICAgZklucHV0KCdz
dWJtaXQnLCAnU3VibWl0JywgZ1R4dCgnc2F2ZV9idXR0b24nKSwgJ3B1Ymxpc2gnKQogICAg
ICAgICAgICAgICAgICAgICAgICAubi5zSW5wdXQoJ3ByZWZzX3NhdmUnKQogICAgICAgICAg
ICAgICAgICAgICAgICAubi5lSW5wdXQoJ3BsdWdpbl9wcmVmcy5hcmNfdHdpdHRlcicpCiAg
ICAgICAgICAgICAgICAgICAgLCAnIGNvbHNwYW49IjIiIGNsYXNzPSJub2xpbmUiJykpKQog
ICAgICAgICAgICAgICAgLmVuZFRhYmxlKCk7CiAgICAgICAgfSBlbHNlaWYgKCAkc3RlcCE9
J3JlZ2lzdGVyJyApIHsKICAgICAgICAgICAgJHJlZ2lzdGVyVVJMID0gYXJjX3R3aXR0ZXI6
OmNhbGxiYWNrVVJMKCRldmVudCwncmVnaXN0ZXInKTsKICAgICAgICAgICAgJGh0bWwuPSBz
dGFydFRhYmxlKCdsaXN0JykuZm9ybSgKICAgICAgICAgICAgICAgIHRyKAogICAgICAgICAg
ICAgICAgICAgIHRkY3MoaGVkKCdUd2l0dGVyIGFjY291bnQgZGV0YWlscycsIDIpLDIpCiAg
ICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAgICAg
ICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl91c2VyIj5Ud2l0dGVyIHVzZXJuYW1l
PC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWdu
OiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAg
ICAudGQoCiAgICAgICAgICAgICAgICAgICAgICAgICgnPGVtPnVua25vd248L2VtPiAoJwog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgLmhyZWYoJ0Nvbm5lY3QgdG8gVHdpdHRlcics
JHJlZ2lzdGVyVVJMKS4nKScpCiAgICAgICAgICAgICAgICApKSkKICAgICAgICAgICAgICAg
IC5lbmRUYWJsZSgpOwogICAgICAgIH0KICAgIH0KCiAgICBlY2hvICRodG1sOwp9CgovLyBB
ZGQgVHdpdHRlciB0YWIgdG8gVGV4dHBhdHRlcm4KZnVuY3Rpb24gYXJjX2FkbWluX3R3aXR0
ZXIoJGV2ZW50LCRzdGVwKQp7CiAgICBnbG9iYWwgJHByZWZzLCAkYXJjX3R3aXR0ZXJfY29u
c3VtZXJLZXksICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiAgICAkdHdpdCA9IG5l
dyBhcmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgLCAk
YXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNz
VG9rZW4nXQogICAgICAgICAgICAsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5T
ZWNyZXQnXSk7CgogICAgJHR3aXQtPmNhY2hlRGlyKCRwcmVmc1snYXJjX3R3aXR0ZXJfY2Fj
aGVfZGlyJ10pOwoKICAgICR4bWwgPSAkdHdpdC0+Z2V0KCd1c2Vycy9zaG93JwogICAgICAg
ICwgYXJyYXkoJ3NjcmVlbl9uYW1lJz0+JHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10pKTsK
ICAgICR0d2l0dGVyVXNlciA9IEAkeG1sLT54cGF0aCgnL3VzZXInKTsKICAgICR0d2l0dGVy
VXNlciA9ICR0d2l0dGVyVXNlclswXTsKICAgICR0d2l0dGVyVXNlclVSTCA9ICdodHRwOi8v
d3d3LnR3aXR0ZXIuY29tLycuJHR3aXR0ZXJVc2VyLT5zY3JlZW5fbmFtZTsKCiAgICBpZiAo
JHN0ZXA9PSJ0d2VldCIpIHsgLy8gcG9zdCBhbiB1cGRhdGUgdG8gVHdpdHRlcgoKICAgICAg
ICAvLyBmZXRjaCBhbmQgY2xlYW4gbWVzc2FnZQogICAgICAgICRtZXNzYWdlID0gc3RyaXBf
dGFncyhncHMoJ21lc3NhZ2UnKSk7CiAgICAgICAgJGNvdW50ID0gc3RybGVuKCRtZXNzYWdl
KTsKCiAgICAgICAgaWYgKCRjb3VudDw9MTQwICYmICRjb3VudD4wKSB7IC8vIHBvc3QgdXBk
YXRlCiAgICAgICAgICAgICRyZXN1bHQgPSAkdHdpdC0+cG9zdCgnc3RhdHVzZXMvdXBkYXRl
JywgYXJyYXkoJ3N0YXR1cycgPT4gJG1lc3NhZ2UpKTsKICAgICAgICB9IGVsc2UgeyAvLyBt
ZXNzYWdlIHRvbyBsb25nLCBKYXZhU2NyaXB0IGludGVyZmFjZSBzaG91bGQgcHJldmVudCB0
aGlzCiAgICAgICAgICAgICRyZXN1bHQgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHBh
Z2V0b3AoJ1R3aXR0ZXInLAogICAgICAgICAgICAoKCRyZXN1bHQhPWZhbHNlKT8nVHdpdHRl
ciB1cGRhdGVkJzonRXJyb3IgdXBkYXRpbmcgVHdpdHRlcicpKTsKCiAgICB9IGVsc2VpZiAo
JHN0ZXA9PSJkZWxldGUiKSB7IC8vIGRlbGV0ZSBhbiB1cGRhdGUgZnJvbSBUd2l0dGVyCgog
ICAgICAgICRpZCA9IHN0cmlwX3RhZ3MoZ3BzKCdpZCcpKTsKICAgICAgICBpZiAoJGlkKSB7
CiAgICAgICAgICAgICR0d2l0LT5kZWxldGUoJ3N0YXR1c2VzL2Rlc3Ryb3knLiRpZCk7CiAg
ICAgICAgICAgIHNhZmVfZGVsZXRlKCdhcmNfdHdpdHRlcicsInR3ZWV0X2lkID0gJGlkIik7
CiAgICAgICAgfQoKICAgICAgICBwYWdldG9wKCdUd2l0dGVyJywnVHdpdHRlciB1cGRhdGVk
Jyk7CgogICAgfSBlbHNlIHsKCiAgICAgICAgcGFnZXRvcCgnVHdpdHRlcicpOwoKICAgIH0K
CiAgICAvLyBQcmVwYXJlIEphdmFTY3JpcHQgdG8gY3JlYXRlIFR3aXR0ZXIgdXBkYXRlIGlu
dGVyZmFjZQoKICAgICRqcyA9ICc8c2NyaXB0IGxhbmd1YWdlPSJqYXZhc2NyaXB0IiB0eXBl
PSJ0ZXh0L2phdmFzY3JpcHQiPic7CiAgICAkanMuPSAiJChkb2N1bWVudCkucmVhZHkoZnVu
Y3Rpb24oKXsKICAgICAgICAgICAgdmFyIGNvdW50ZXJTdHlsZSA9ICdmb250LXdlaWdodDpi
b2xkO2Zsb2F0OnJpZ2h0O2ZvbnQtc2l6ZToyZW07bGluZS1oZWlnaHQ6MS4yZW07JzsKICAg
ICAgICAgICAgJCgnI3R3ZWV0Y291bnQnKS5hdHRyKCdzdHlsZScsIGNvdW50ZXJTdHlsZSsn
Y29sb3I6I2NjYzsnKTsKICAgICAgICAgICAgJCgnI21lc3NhZ2UnKS5rZXl1cChmdW5jdGlv
bigpIHsKICAgICAgICAgICAgICAgIHZhciBjb3VudCA9IDE0MC0kKCcjbWVzc2FnZScpLnZh
bCgpLmxlbmd0aDsKICAgICAgICAgICAgICAgICQoJyN0d2VldGNvdW50JykuaHRtbChjb3Vu
dCsnJyk7IC8vIGhhY2sgdG8gZm9yY2Ugb3V0cHV0IG9mIDAKICAgICAgICAgICAgICAgIGlm
IChjb3VudDwwKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnaW5wdXQucHVibGlzaCcpLmF0
dHIoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7CiAgICAgICAgICAgICAgICB9IGVsc2Ugewog
ICAgICAgICAgICAgICAgICAgICQoJ2lucHV0LnB1Ymxpc2gnKS5hdHRyKCdkaXNhYmxlZCcs
ICcnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChjb3VudDwwKSB7
CiAgICAgICAgICAgICAgICAgICAgJCgnI3R3ZWV0Y291bnQnKS5hdHRyKCdzdHlsZScsIGNv
dW50ZXJTdHlsZSsnY29sb3I6I2YwMDsnKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAo
Y291bnQ8MTApIHsKICAgICAgICAgICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0dHIo
J3N0eWxlJywgY291bnRlclN0eWxlKydjb2xvcjojMDAwOycpOwogICAgICAgICAgICAgICAg
fSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0
eWxlJywgY291bnRlclN0eWxlKydjb2xvcjojY2NjOycpOwogICAgICAgICAgICAgICAgfQog
ICAgICAgICAgICB9KQogICAgICAgIH0pOyI7CiAgICAkanMuPSAiPC9zY3JpcHQ+IjsKCiAg
ICAkb3V0ID0gJyc7CiAgICAkeG1sID0gJHR3aXQtPmdldCgnc3RhdHVzZXMvdXNlcl90aW1l
bGluZScKICAgICAgICAsIGFycmF5KCdzY3JlZW5fbmFtZSc9PiRwcmVmc1snYXJjX3R3aXR0
ZXJfdXNlciddLCdjb3VudCc9PjI1KSk7CiAgICAkdHdlZXRzID0gQCR4bWwtPnhwYXRoKCcv
c3RhdHVzZXMvc3RhdHVzJyk7CiAgICBpZiAoJHR3ZWV0cykgZm9yZWFjaCAoJHR3ZWV0cyBh
cyAkdHdlZXQpIHsKICAgICAgICAkdGltZSA9IHN0cnRvdGltZShodG1sZW50aXRpZXMoJHR3
ZWV0LT5jcmVhdGVkX2F0KSk7CiAgICAgICAgJGRhdGUgPSBzYWZlX3N0cmZ0aW1lKCRwcmVm
c1snYXJjaGl2ZV9kYXRlZm9ybWF0J10sJHRpbWUpOwogICAgICAgICRvdXQuPSB0cih0ZCgk
ZGF0ZSwnc3BhbicpCiAgICAgICAgICAgIC50ZChhcmNfVHdpdHRlcjo6bWFrZUxpbmtzKGh0
bWxlbnRpdGllcygkdHdlZXQtPnRleHQKICAgICAgICAgICAgICAgICwgRU5UX1FVT1RFUywn
VVRGLTgnKSkpCiAgICAgICAgICAgIC50ZChkTGluaygnYXJjX2FkbWluX3R3aXR0ZXInLCdk
ZWxldGUnLCdpZCcsJHR3ZWV0LT5pZCwnJykpCiAgICAgICAgICAgICk7CiAgICB9CgogICAg
JGh0bWwgPSBzdGFydFRhYmxlKCdlZGl0JykKICAgICAgICAgICAgLnRyKHRkKAogICAgICAg
ICAgICBncmFmKCc8aW1nIHNyYz0iJy4kdHdpdHRlclVzZXItPnByb2ZpbGVfaW1hZ2VfdXJs
LiciIGFsdD0iVHdpdHRlciBhdmF0YXIiIC8+JwogICAgICAgICAgICAsJyBzdHlsZT0iZmxv
YXQ6bGVmdDtwYWRkaW5nOjJweDsiJykKICAgICAgICAgICAgLmdyYWYoaHJlZigkdHdpdHRl
clVzZXItPm5hbWUsJHR3aXR0ZXJVc2VyVVJMKSwnIHN0eWxlPSJmb250LXNpemU6MS4yZW07
Zm9udC13ZWlnaHQ6Ym9sZDsiJykKICAgICAgICAgICAgLmdyYWYoaHJlZigkdHdpdHRlclVz
ZXItPmZyaWVuZHNfY291bnQuJyBmb2xsb3dpbmcnLCR0d2l0dGVyVXNlclVSTC4nL2ZvbGxv
d2luZycpCiAgICAgICAgICAgIC4nLCAnLmhyZWYoJHR3aXR0ZXJVc2VyLT5mb2xsb3dlcnNf
Y291bnQuJyBmb2xsb3dlcnMnLCR0d2l0dGVyVXNlclVSTC4nL2ZvbGxvd2VycycpCiAgICAg
ICAgICAgIC4nLCAnLmhyZWYoJHR3aXR0ZXJVc2VyLT5zdGF0dXNlc19jb3VudC4nIHVwZGF0
ZXMnLCR0d2l0dGVyVXNlclVSTCkpKSkKICAgICAgICAgICAgLnRyKHRkKGZvcm0oCiAgICAg
ICAgICAgIGdyYWYoIlVwZGF0ZSBUd2l0dGVyLi4uPHNwYW4gaWQ9J3R3ZWV0Y291bnQnIHN0
eWxlPSdmb250LXdlaWdodDpib2xkO2Zsb2F0OnJpZ2h0Oyc+MTQwPC9zcGFuPiIpCiAgICAg
ICAgICAgIC50ZXh0X2FyZWEoJ21lc3NhZ2UnLCc1MCcsJzU1MCcsJycsJ21lc3NhZ2UnKQog
ICAgICAgICAgICAuZUlucHV0KCdhcmNfYWRtaW5fdHdpdHRlcicpCiAgICAgICAgICAgIC5z
SW5wdXQoJ3R3ZWV0JykuYnIKICAgICAgICAgICAgLmZJbnB1dCgnc3VibWl0JywndXBkYXRl
JyxnVHh0KCdVcGRhdGUnKSwncHVibGlzaCcpCiAgICAgICAgKSkpCiAgICAgICAgLmVuZFRh
YmxlKCk7CgogICAgLy8gQXR0YWNoIHJlY2VudCBUd2l0dGVyIHVwZGF0ZXMKCiAgICAkaHRt
bC49IHN0YXJ0VGFibGUoJ2xpc3QnLCcnLCcnLCcnLCc5MCUnKQogICAgICAgIC4kb3V0CiAg
ICAgICAgLmVuZFRhYmxlKCk7CgogICAgLy8gT3V0cHV0IEphdmFTY3JpcHQgYW5kIEhUTUwK
CiAgICBlY2hvICRqcy4kaHRtbDsKfQoKLy8gQWRkIFR3aXR0ZXIgb3B0aW9ucyB0byBhcnRp
Y2xlIGFydGljbGUgc2NyZWVuCmZ1bmN0aW9uIGFyY19hcHBlbmRfdHdpdHRlcigkZXZlbnQs
ICRzdGVwLCAkZGF0YSwgJHJzMSkKewogICAgZ2xvYmFsICRwcmVmcywgJGFyY190d2l0dGVy
OwogICAgJHByZWZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9wcmVmaXgnKSk7CiAgICAk
cHJlZml4ID0gKCRwcmVmaXgpID8gJHByZWZpeCA6ICRwcmVmc1snYXJjX3R3aXR0ZXJfcHJl
Zml4J107CiAgICAkc3VmZml4ID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3N1ZmZpeCcpKTsK
CiAgICBpZiAoJHJzMVsnSUQnXSkgewogICAgICAgICRzcWwgPSAiU0VMRUNUIHR3ZWV0X2lk
LHR3ZWV0IEZST00gIi5QRlguImFyY190d2l0dGVyIFdIRVJFIGFydGljbGVfaWQ9Ii4kcnMx
WydJRCddLiI7IjsKICAgICAgICAkcnMyID0gc2FmZV9xdWVyeSgkc3FsKTsgJHJzMiA9IG5l
eHRSb3coJHJzMik7CiAgICB9IGVsc2UgeyAvLyBuZXcgYXJ0aWNsZQogICAgICAgICRyczIg
PSAnJzsKICAgIH0KCiAgICBpZiAoJHJzMVsnSUQnXSAmJiAkcnMyWyd0d2VldF9pZCddKSB7
CiAgICAgICAgJGNvbnRlbnQgPSBhcmNfVHdpdHRlcjo6bWFrZUxpbmtzKCRyczJbJ3R3ZWV0
J10pOwogICAgICAgIHJldHVybiAkZGF0YS5maWVsZHNldCgkY29udGVudCwgJ1R3aXR0ZXIg
dXBkYXRlJywgJ2FyY190d2l0dGVyJyk7CiAgICB9IGVsc2UgewogICAgICAgICR2YXIgPSAo
JHJzMVsnSUQnXSkgPyAwIDogJHByZWZzWydhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0J107
CiAgICAgICAgJGNvbnRlbnQgID0gdGFnKHllc25vUmFkaW8oJ2FyY190d2VldF90aGlzJywg
JHZhciwgJycsICdhcmNfdHdlZXRfdGhpcycpLCdwJyk7CiAgICAgICAgJGNvbnRlbnQgLj0g
dGFnKGhyZWYoJ09wdGlvbnMnLCcjYXJjX3R3aXR0ZXJfb3B0aW9ucycpLCdwJywnIGNsYXNz
PSJwbGFpbiBsZXZlciIgc3R5bGU9Im1hcmdpbi10b3A6NXB4OyInKTsKICAgICAgICAkY29u
dGVudCAuPSB0YWcodGFnKHRhZygnVHdlZXQgcHJlZml4JywnbGFiZWwnLCAnIGZvcj0iYXJj
X3R3aXR0ZXJfcHJlZml4IicpCiAgICAgICAgICAgIC5mSW5wdXQoJ3RleHQnLCdhcmNfdHdp
dHRlcl9wcmVmaXgnLCRwcmVmaXgsJ2VkaXQnLCcnLCcnLCcyMicsJycsJ2FyY190d2l0dGVy
X3ByZWZpeCcpLCdwJykKICAgICAgICAgICAgLnRhZyh0YWcoJ1R3ZWV0IHN1ZmZpeCAoZWcg
I2hhc2h0YWdzKScsJ2xhYmVsJywgJyBmb3I9ImFyY190d2l0dGVyX3N1ZmZpeCInKQogICAg
ICAgICAgICAuZklucHV0KCd0ZXh0JywnYXJjX3R3aXR0ZXJfc3VmZml4Jywkc3VmZml4LCdl
ZGl0JywnJywnJywnMjInLCcnLCdhcmNfdHdpdHRlcl9zdWZmaXgnKSwncCcpCiAgICAgICAg
ICAgICwnZGl2JywnIGlkPSJhcmNfdHdpdHRlcl9vcHRpb25zIiBjbGFzcz0idG9nZ2xlIiBz
dHlsZT0iZGlzcGxheTpub25lIicpOwogICAgICAgIGlmIChpc3NldCgkYXJjX3R3aXR0ZXJb
J2Vycm9yJ10pKSB7CiAgICAgICAgICAgICRjb250ZW50IC49ICc8cD4nLiRhcmNfdHdpdHRl
clsnZXJyb3InXS4nPC9wPic7CiAgICAgICAgfQogICAgICAgIHJldHVybiAkZGF0YS5maWVs
ZHNldCgkY29udGVudCwgJ1VwZGF0ZSBUd2l0dGVyJywgJ2FyY190d2l0dGVyJyk7CiAgICB9
Cgp9CgovLyBVcGRhdGUgVHdpdHRlciB3aXRoIHBvc3RlZCBhcnRpY2xlCmZ1bmN0aW9uIGFy
Y19hcnRpY2xlX3R3ZWV0KCRldmVudCwkc3RlcCkKewogICAgZ2xvYmFsICRwcmVmcywgJGFy
Y190d2l0dGVyLCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAsICRhcmNfdHdp
dHRlcl9jb25zdW1lclNlY3JldDsKCiAgICAkYXJ0aWNsZV9pZCA9IGVtcHR5KCRHTE9CQUxT
WydJRCddKSA/IGdwcygnSUQnKSA6ICRHTE9CQUxTWydJRCddOwogICAgaWYgKCFlbXB0eSgk
YXJ0aWNsZV9pZCkpIHsKCiAgICAgICAgaW5jbHVkZV9vbmNlIHR4cGF0aC4nL3B1Ymxpc2gv
dGFnaGFuZGxlcnMucGhwJzsKCiAgICAgICAgJGFydGljbGUgPSBzYWZlX3JvdygiSUQsIFRp
dGxlLCBTZWN0aW9uLCBQb3N0ZWQiLCAndGV4dHBhdHRlcm4nLAogICAgICAgICAgICAiSUQ9
eyRhcnRpY2xlX2lkfSBBTkQgU3RhdHVzPTQgQU5EIG5vdygpPj1Qb3N0ZWQiKTsKCiAgICAg
ICAgaWYgKCRhcnRpY2xlICYmIGdwcygnYXJjX3R3ZWV0X3RoaXMnKSkgeyAvLyB0d2VldCBh
cnRpY2xlCgogICAgICAgICAgICAvLyBOZWVkIHRvIG1hbnVhbGx5IHVwZGF0ZSB0aGUgJ1VS
TCBvbmx5IHRpdGxlJyBiZWZvcmUgYnVpbGRpbmcgdGhlCiAgICAgICAgICAgIC8vIFVSTAog
ICAgICAgICAgICAkYXJ0aWNsZVsndXJsX3RpdGxlJ10gPSBncHMoJ3VybF90aXRsZScpOwog
ICAgICAgICAgICAvLyBNYWtlIHNob3J0IFVSTAogICAgICAgICAgICAkdXJsID0gcGVybWxp
bmt1cmwoJGFydGljbGUpOwogICAgICAgICAgICAkc2hvcnRfdXJsID0gYXJjX3Nob3J0ZW5f
dXJsKCR1cmwsJHByZWZzWydhcmNfdHdpdHRlcl91cmxfbWV0aG9kJ10sCiAgICAgICAgICAg
ICAgICBhcnJheSgnaWQnPT4kYXJ0aWNsZV9pZCkpOwoKICAgICAgICAgICAgaWYgKCEkc2hv
cnRfdXJsKSB7IC8vIEZhaWxlZCB0byBvYnRhaW4gYSBzaG9ydGVuZWQgVVJMLCBkbyBub3Qg
dHdlZXQhCiAgICAgICAgICAgICAgICAkYXJjX3R3aXR0ZXJbJ2Vycm9yJ10gPSAnVW5hYmxl
IHRvIG9idGFpbiBhIHNob3J0IFVSTCBmb3IgdGhpcyBhcnRpY2xlLic7CgogICAgICAgICAg
ICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBDb25z
dHJ1Y3QgVHdpdHRlciB1cGRhdGUKICAgICAgICAgICAgJHByZWZpeCAgPSB0cmltKGdwcygn
YXJjX3R3aXR0ZXJfcHJlZml4JykpOwogICAgICAgICAgICAkcHJlX2xlbiA9IHN0cmxlbigk
cHJlZml4KTsKICAgICAgICAgICAgJHByZWZpeCAgPSAoJHByZWZpeCAmJiAkcHJlX2xlbjw9
MjApID8gJHByZWZpeC4nICcgOiAnJzsKICAgICAgICAgICAgJHN1ZmZpeCAgPSB0cmltKGdw
cygnYXJjX3R3aXR0ZXJfc3VmZml4JykpOwogICAgICAgICAgICAkc3VmX2xlbiA9IHN0cmxl
bigkc3VmZml4KTsKICAgICAgICAgICAgJHN1ZmZpeCAgPSAoJHN1ZmZpeCAmJiAkc3VmX2xl
bjw9NDApID8gJyAnLiRzdWZmaXggOiAnJzsKICAgICAgICAgICAgJHVybF9sZW4gPSBzdHJs
ZW4oJHNob3J0X3VybCkrMTsgLy8gY291bnQgVVJMIGxlbmd0aCArIDEgZm9yIHByZWZpeGVk
IHNwYWNlCiAgICAgICAgICAgIGlmICgkcHJlZml4KSAkcHJlX2xlbiArPSAxOwogICAgICAg
ICAgICBpZiAoJHN1ZmZpeCkgJHN1Zl9sZW4gKz0gMTsKICAgICAgICAgICAgaWYgKChzdHJs
ZW4oJGFydGljbGVbJ1RpdGxlJ10pKyR1cmxfbGVuKyRwcmVfbGVuKyRzdWZfbGVuKT4xNDAp
IHsKICAgICAgICAgICAgICAgICRhcnRpY2xlWydUaXRsZSddID0gc3Vic3RyKCRhcnRpY2xl
WydUaXRsZSddLDAsMTM1LSR1cmxfbGVuLSRwcmVfbGVuLSRzdWZfbGVuKS4nLi4uJzsKICAg
ICAgICAgICAgfQogICAgICAgICAgICAkdHdlZXQgPSAkcHJlZml4LiRhcnRpY2xlWydUaXRs
ZSddLiIgIi4kc2hvcnRfdXJsLiRzdWZmaXg7CgogICAgICAgICAgICAvLyBVcGRhdGUgVHdp
dHRlcgogICAgICAgICAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJf
Y29uc3VtZXJLZXkKICAgICAgICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2Vj
cmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10KICAgICAgICAgICAgICAg
ICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKTsKICAgICAgICAg
ICAgJHJlc3VsdCA9ICR0d2l0LT5wb3N0KCdzdGF0dXNlcy91cGRhdGUnLCBhcnJheSgnc3Rh
dHVzJyA9PiAkdHdlZXQpKTsKCiAgICAgICAgICAgICR0d2VldF9pZCA9IChpc19vYmplY3Qo
JHJlc3VsdCkpID8gJHJlc3VsdFswXS0+aWQgOiAwOwoKICAgICAgICAgICAgaWYgKCR0d2Vl
dF9pZCkgewoKICAgICAgICAgICAgICAgICR0d2VldCA9IGFkZHNsYXNoZXMoJHR3ZWV0KTsK
CiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgYXJjX3R3aXR0ZXIgdGFibGUgd2l0aCB0d2Vl
dAogICAgICAgICAgICAgICAgJHNxbCA9ICJJTlNFUlQgSU5UTyAiLlBGWC4iYXJjX3R3aXR0
ZXIgKGFydGljbGVfaWQsdHdlZXRfaWQsdHdlZXQsdGlueXVybCkgIjsKICAgICAgICAgICAg
ICAgICRzcWwuPSAiVkFMVUVTKCRhcnRpY2xlX2lkLCR0d2VldF9pZCxcIiR0d2VldFwiLCck
c2hvcnRfdXJsJyk7IjsKICAgICAgICAgICAgICAgIHNhZmVfcXVlcnkoJHNxbCk7CgogICAg
ICAgICAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICAgICAgICB9IGVsc2UgewoKICAgICAg
ICAgICAgICAgICRhcmNfdHdpdHRlclsnZXJyb3InXSA9ICdUd2l0dGVyIHJlc3BvbnNlOiAn
CiAgICAgICAgICAgICAgICAgICAgLiR0d2l0LT5odHRwX2NvZGU7CiAgICAgICAgICAgICAg
ICByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICB9CgogICAgICAgIH0KCiAgICB9CgogICAg
cmV0dXJuIGZhbHNlOwoKfQoKLyoKICogU2hvcnRlbiBVUkxzIHVzaW5nIHZhcmlvdXMgbWV0
aG9kcwogKi8KCmZ1bmN0aW9uIGFyY19zaG9ydGVuX3VybCgkdXJsLCAkbWV0aG9kPScnLCAk
YXR0cz1hcnJheSgpKQp7CiAgJGNoID0gY3VybF9pbml0KCk7CiAgY3VybF9zZXRvcHQoJGNo
LCBDVVJMT1BUX0hFQURFUiwgMCk7CiAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1JFVFVS
TlRSQU5TRkVSLCB0cnVlKTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVElNRU9VVCwg
MTApOwoKICBzd2l0Y2ggKCRtZXRob2QpIHsKICAgIGNhc2UgJ3NtZCc6IC8vIGNyZWF0ZSBh
IHNob3J0ZW5lZCBVUkwgdXNpbmcgU01EIFNob3J0IFVSTAogICAgICByZXR1cm4gKCRhdHRz
WydpZCddKSA/IGh1LiRhdHRzWydpZCddIDogZmFsc2U7IGJyZWFrOwogICAgY2FzZSAnaXNn
ZCc6CgogICAgICAkdSA9ICdodHRwOi8vaXMuZ2QvYXBpLnBocD9sb25ndXJsPScudXJsZW5j
b2RlKCR1cmwpOwogICAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVVJMLCAkdSk7Cgog
ICAgICAkdGlueXVybCA9IGN1cmxfZXhlYygkY2gpOwogICAgICBpZiAoJHRpbnl1cmwhPSdF
cnJvcicgJiYgJHRpbnl1cmwhPScnKSB7CiAgICAgICAgcmV0dXJuICR0aW55dXJsOwogICAg
ICB9IGVsc2UgewogICAgICAgIHRyaWdnZXJfZXJyb3IoJ2FyY190d2l0dGVyIGZhaWxlZCB0
byBnZXQgYSBpcy5nZCBVUkwgZm9yICcKICAgICAgICAgICAgLiR1cmwsRV9VU0VSX1dBUk5J
TkcpOwogICAgICB9CiAgICAgIGJyZWFrOwoKICAgIGNhc2UgJ3Rpbnl1cmwnOiBkZWZhdWx0
OiAvLyBjcmVhdGUgYSBzaG9ydGVuZWQgVVJMIHVzaW5nIFRpbnlVUkwKCiAgICAgICR1ID0g
J2h0dHA6Ly90aW55dXJsLmNvbS9hcGktY3JlYXRlLnBocD91cmw9Jy51cmxlbmNvZGUoJHVy
bCk7CiAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VUkwsICR1KTsKICAgICAgJHRp
bnl1cmwgPSBjdXJsX2V4ZWMoJGNoKTsKICAgICAgaWYgKCR0aW55dXJsIT0nRXJyb3InICYm
ICR0aW55dXJsIT0nJykgewogICAgICAgIHJldHVybiAkdGlueXVybDsKICAgICAgfSBlbHNl
IHsKICAgICAgICB0cmlnZ2VyX2Vycm9yKCdhcmNfdHdpdHRlciBmYWlsZWQgdG8gZ2V0IGEg
VGlueVVSTCBmb3IgJy4kdXJsLEVfVVNFUl9XQVJOSU5HKTsKICAgICAgfQoKICB9CgogIHJl
dHVybiBmYWxzZTsgLy8gZmFpbAoKfQoKLyoKICoqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioK
Ki8KCmNsYXNzIGFyY190d2l0dGVyIGV4dGVuZHMgVHdpdHRlck9BdXRoIHsKICAgIC8vIENh
Y2hpbmcgdmFyaWFibGVzCiAgICBwcml2YXRlICRfY2FjaGUgPSB0cnVlOwogICAgcHJpdmF0
ZSAkX2NhY2hlX2RpciA9ICcuL3RtcCc7CiAgICBwcml2YXRlICRfY2FjaGVfdGltZSA9IDE4
MDA7IC8vIDMwIG1pbnV0ZSBjYWNoZQoKICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRjb25z
dW1lcl9rZXksICRjb25zdW1lcl9zZWNyZXQsICRvYXV0aF90b2tlbiA9IE5VTEwKICAgICAg
ICAsICRvYXV0aF90b2tlbl9zZWNyZXQgPSBOVUxMKQogICAgewogICAgICAgIHBhcmVudDo6
X19jb25zdHJ1Y3QoJGNvbnN1bWVyX2tleSwgJGNvbnN1bWVyX3NlY3JldCwgJG9hdXRoX3Rv
a2VuCiAgICAgICAgICAgICwgJG9hdXRoX3Rva2VuX3NlY3JldCk7CiAgICAgICAgJHRoaXMt
PmZvcm1hdCA9ICd4bWwnOwogICAgICAgICR0aGlzLT50aW1lb3V0ID0gMTU7CiAgICAgICAg
JHRoaXMtPmNvbm5lY3R0aW1lb3V0ID0gMTU7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9u
IGNhbGxiYWNrVVJMKCRldmVudCwkc3RlcCkKICAgIHsKICAgICAgICByZXR1cm4gaHUuJ3Rl
eHRwYXR0ZXJuL2luZGV4LnBocD9ldmVudD0nLiRldmVudC4nJmFtcDtzdGVwPScuJHN0ZXA7
CiAgICB9CgogICAgLy8gY3JlYXRlIFR3aXR0ZXIgYW5kIGV4dGVybmFsIGxpbmtzIGluIHRl
eHQKICAgIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gbWFrZUxpbmtzKCR0ZXh0KQogICAgewog
ICAgICAgICR1cmwgPSAnL1xiKGh0dHB8aHR0cHN8ZnRwKTpcL1wvKFtBLVowLTldW0EtWjAt
OV8tXSooPzpcLltBLVowLTldW0EtWjAtOV8tXSopKyk6PyhcZCspP1wvPyhbXC9cdytcLl0r
KVxiL2knOwogICAgICAgICR0ZXh0ID0gcHJlZ19yZXBsYWNlKCR1cmwsICI8YSBocmVmPSck
MCc+JDA8L2E+IiwgJHRleHQpOwogICAgICAgICR1cmwgPSAnL1xiKF58XHMpd3d3LihbYS16
X0EtWjAtOV0rKSgoXC5bYS16XSspKylcYi9pJzsKICAgICAgICAkdGV4dCA9IHByZWdfcmVw
bGFjZSgkdXJsLCAiPGEgaHJlZj0naHR0cDovL3d3dy4kMiQzJz53d3cuJDIkMzwvYT4iLCAk
dGV4dCk7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2UoIi8oXnxccylAKFthLXpfQS1a
MC05XSspLyIsCiAgICAgICAgICAgICIkMUA8YSBocmVmPSdodHRwOi8vdHdpdHRlci5jb20v
JDInPiQyPC9hPiIsJHRleHQpOwogICAgICAgICR0ZXh0ID0gcHJlZ19yZXBsYWNlKCIvKF58
XHMpKFwjKFthLXpfQS1aMC05Ol8tXSspKS8iLAogICAgICAgICAgICAiJDE8YSBocmVmPSdo
dHRwOi8vdHdpdHRlci5jb20vc2VhcmNoP3E9JTIzJDMnPiQyPC9hPiIsJHRleHQpOwogICAg
ICAgIHJldHVybiAkdGV4dDsKICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGdldCgkdXJsLCAk
cGFyYW1zID0gYXJyYXkoKSkKICAgIHsKICAgICAgICAkYXBpX3VybCA9IG1kNSgkdXJsLnVy
bGVuY29kZShzZXJpYWxpemUoJHBhcmFtcykpKTsKICAgICAgICAkZGF0YSA9ICcnOwoKICAg
ICAgICBpZiAoJHRoaXMtPl9jYWNoZSkgeyAvLyBjaGVjayBmb3IgY2FjaGVkIHhtbAoKICAg
ICAgICAgICAgJGRhdGEgPSAkdGhpcy0+X3JldHJpZXZlQ2FjaGUoJGFwaV91cmwpOwoKICAg
ICAgICB9CiAgICAgICAgaWYgKGVtcHR5KCRkYXRhKSkgewogICAgICAgICAgICAkZGF0YSA9
IHBhcmVudDo6Z2V0KCR1cmwsICRwYXJhbXMpOwogICAgICAgICAgICBpZiAoJHRoaXMtPmh0
dHBfY29kZT09PTIwMCAmJiAkeG1sPXNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSkpIHsg
Ly8gc2F2ZSBjYWNoZQogICAgICAgICAgICAgICAgJGZpbGUgPSAkdGhpcy0+X2NhY2hlX2Rp
ci4nLycuJGFwaV91cmw7CiAgICAgICAgICAgICAgICBmaWxlX3B1dF9jb250ZW50cygkZmls
ZSwkZGF0YSxMT0NLX0VYKTsKICAgICAgICAgICAgICAgIHJldHVybiAkeG1sOwogICAgICAg
ICAgICB9IGVsc2UgeyAvLyBmYWlsZWQgdG8gcmV0cmlldmUgZGF0YSBmcm9tIFR3aXR0ZXIK
CiAgICAgICAgICAgICAgICBpZiAoJHRoaXMtPl9jYWNoZSkgeyAvLyBhdHRlbXB0IHRvIGZv
cmNlIGNhY2hlZCB4bWwgcmV0dXJuCgogICAgICAgICAgICAgICAgICAgICRkYXRhID0gJHRo
aXMtPl9yZXRyaWV2ZUNhY2hlKCRhcGlfdXJsLHRydWUpOwogICAgICAgICAgICAgICAgICAg
IGlmICgkZGF0YSkgcmV0dXJuIEBzaW1wbGV4bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwoKICAg
ICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAg
ICAgICB9CiAgICAgICAgfSBlbHNlIHsgLy8gcmV0dXJuIGNhY2hlZCB4bWwKICAgICAgICAg
ICAgcmV0dXJuIEBzaW1wbGV4bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwogICAgICAgIH0KICAg
IH0gLy9lbmQgZ2V0KCkKCiAgICBmdW5jdGlvbiBwb3N0KCR1cmwsICRwYXJhbXMgPSBhcnJh
eSgpKQogICAgewogICAgICAgICRkYXRhID0gcGFyZW50Ojpwb3N0KCR1cmwsJHBhcmFtcyk7
CiAgICAgICAgcmV0dXJuIHNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0YSk7CiAgICB9Cgog
ICAgZnVuY3Rpb24gZGVsZXRlKCR1cmwsICRwYXJhbXMgPSBhcnJheSgpKQogICAgewogICAg
ICAgICRkYXRhID0gcGFyZW50OjpkZWxldGUoJHVybCwkcGFyYW1zKTsKICAgICAgICByZXR1
cm4gc2ltcGxleG1sX2xvYWRfc3RyaW5nKCRkYXRhKTsKICAgIH0KCiAgICAvLyBDYWNoZSBt
ZXRob2RzCgogICAgcHVibGljIGZ1bmN0aW9uIHNldENhY2hpbmcoJGNhY2hlPXRydWUpCiAg
ICB7CiAgICAgICAgJHRoaXMtPl9jYWNoZSA9ICgkY2FjaGUpID8gdHJ1ZSA6IGZhbHNlOwog
ICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjYWNoZURp
cigkbG9jKQogICAgewogICAgICAgICR0aGlzLT5fY2FjaGVfZGlyID0gJGxvYzsKICAgICAg
ICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gY2FjaGVUaW1lKCRt
aW5zKQogICAgewogICAgICAgICR0aGlzLT5fY2FjaGVfdGltZSA9ICRtaW5zKjYwOyAvLyBj
b252ZXJ0IG1pbnV0ZXMgaW50byBzZWNvbmRzCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9
CgogICAgcHJpdmF0ZSBmdW5jdGlvbiBfcmV0cmlldmVDYWNoZSgkdXJsLCRvdmVyaWRlX3Rp
bWVvdXQ9ZmFsc2UpCiAgICB7CiAgICAgICAgJGZpbGUgPSAkdGhpcy0+X2NhY2hlX2Rpci4n
LycuJHVybDsKICAgICAgICBpZiAoZmlsZV9leGlzdHMoJGZpbGUpKSB7CgogICAgICAgICAg
ICAkZGlmZiA9IHRpbWUoKSAtIGZpbGVtdGltZSgkZmlsZSk7CiAgICAgICAgICAgIGlmICgk
b3ZlcmlkZV90aW1lb3V0IHx8ICRkaWZmIDwgJHRoaXMtPl9jYWNoZV90aW1lKSB7CiAgICAg
ICAgICAgICAgICByZXR1cm4gZmlsZV9nZXRfY29udGVudHMoJGZpbGUpOwogICAgICAgICAg
ICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9
CgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9
CiAgICB9Cn0KCi8qCiAqIEFicmFoYW0gV2lsbGlhbXMgKGFicmFoYW1AYWJyYWguYW0pIGh0
dHA6Ly9hYnJhaC5hbQogKgogKiBUaGUgZmlyc3QgUEhQIExpYnJhcnkgdG8gc3VwcG9ydCBP
QXV0aCBmb3IgVHdpdHRlcidzIFJFU1QgQVBJLgogKi8KCi8qKgogKiBUd2l0dGVyIE9BdXRo
IGNsYXNzCiAqLwpjbGFzcyBUd2l0dGVyT0F1dGggewogIC8qIENvbnRhaW5zIHRoZSBsYXN0
IEhUVFAgc3RhdHVzIGNvZGUgcmV0dXJuZWQuICovCiAgcHVibGljICRodHRwX2NvZGU7CiAg
LyogQ29udGFpbnMgdGhlIGxhc3QgQVBJIGNhbGwuICovCiAgcHVibGljICR1cmw7CiAgLyog
U2V0IHVwIHRoZSBBUEkgcm9vdCBVUkwuICovCiAgcHVibGljICRob3N0ID0gImh0dHBzOi8v
YXBpLnR3aXR0ZXIuY29tLzEvIjsKICAvKiBTZXQgdGltZW91dCBkZWZhdWx0LiAqLwogIHB1
YmxpYyAkdGltZW91dCA9IDMwOwogIC8qIFNldCBjb25uZWN0IHRpbWVvdXQuICovCiAgcHVi
bGljICRjb25uZWN0dGltZW91dCA9IDMwOwogIC8qIFZlcmlmeSBTU0wgQ2VydC4gKi8KICBw
dWJsaWMgJHNzbF92ZXJpZnlwZWVyID0gRkFMU0U7CiAgLyogUmVzcG9ucyBmb3JtYXQuICov
CiAgcHVibGljICRmb3JtYXQgPSAnanNvbic7CiAgLyogRGVjb2RlIHJldHVybmVkIGpzb24g
ZGF0YS4gKi8KICBwdWJsaWMgJGRlY29kZV9qc29uID0gVFJVRTsKICAvKiBDb250YWlucyB0
aGUgbGFzdCBIVFRQIGhlYWRlcnMgcmV0dXJuZWQuICovCiAgcHVibGljICRodHRwX2luZm87
CiAgLyogU2V0IHRoZSB1c2VyYWduZXQuICovCiAgcHVibGljICR1c2VyYWdlbnQgPSAnVHdp
dHRlck9BdXRoIHYwLjIuMC1iZXRhMic7CiAgLyogSW1tZWRpYXRlbHkgcmV0cnkgdGhlIEFQ
SSBjYWxsIGlmIHRoZSByZXNwb25zZSB3YXMgbm90IHN1Y2Nlc3NmdWwuICovCiAgLy9wdWJs
aWMgJHJldHJ5ID0gVFJVRTsKCgoKCiAgLyoqCiAgICogU2V0IEFQSSBVUkxTCiAgICovCiAg
ZnVuY3Rpb24gYWNjZXNzVG9rZW5VUkwoKSAgeyByZXR1cm4gJ2h0dHBzOi8vYXBpLnR3aXR0
ZXIuY29tL29hdXRoL2FjY2Vzc190b2tlbic7IH0KICBmdW5jdGlvbiBhdXRoZW50aWNhdGVV
UkwoKSB7IHJldHVybiAnaHR0cHM6Ly90d2l0dGVyLmNvbS9vYXV0aC9hdXRoZW50aWNhdGUn
OyB9CiAgZnVuY3Rpb24gYXV0aG9yaXplVVJMKCkgICAgeyByZXR1cm4gJ2h0dHBzOi8vdHdp
dHRlci5jb20vb2F1dGgvYXV0aG9yaXplJzsgfQogIGZ1bmN0aW9uIHJlcXVlc3RUb2tlblVS
TCgpIHsgcmV0dXJuICdodHRwczovL2FwaS50d2l0dGVyLmNvbS9vYXV0aC9yZXF1ZXN0X3Rv
a2VuJzsgfQoKICAvKioKICAgKiBEZWJ1ZyBoZWxwZXJzCiAgICovCiAgZnVuY3Rpb24gbGFz
dFN0YXR1c0NvZGUoKSB7IHJldHVybiAkdGhpcy0+aHR0cF9zdGF0dXM7IH0KICBmdW5jdGlv
biBsYXN0QVBJQ2FsbCgpIHsgcmV0dXJuICR0aGlzLT5sYXN0X2FwaV9jYWxsOyB9CgogIC8q
KgogICAqIGNvbnN0cnVjdCBUd2l0dGVyT0F1dGggb2JqZWN0CiAgICovCiAgZnVuY3Rpb24g
X19jb25zdHJ1Y3QoJGNvbnN1bWVyX2tleSwgJGNvbnN1bWVyX3NlY3JldCwgJG9hdXRoX3Rv
a2VuID0gTlVMTCwgJG9hdXRoX3Rva2VuX3NlY3JldCA9IE5VTEwpIHsKICAgICR0aGlzLT5z
aGExX21ldGhvZCA9IG5ldyBPQXV0aFNpZ25hdHVyZU1ldGhvZF9ITUFDX1NIQTEoKTsKICAg
ICR0aGlzLT5jb25zdW1lciA9IG5ldyBPQXV0aENvbnN1bWVyKCRjb25zdW1lcl9rZXksICRj
b25zdW1lcl9zZWNyZXQpOwogICAgaWYgKCFlbXB0eSgkb2F1dGhfdG9rZW4pICYmICFlbXB0
eSgkb2F1dGhfdG9rZW5fc2VjcmV0KSkgewogICAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1
dGhDb25zdW1lcigkb2F1dGhfdG9rZW4sICRvYXV0aF90b2tlbl9zZWNyZXQpOwogICAgfSBl
bHNlIHsKICAgICAgJHRoaXMtPnRva2VuID0gTlVMTDsKICAgIH0KICB9CgoKICAvKioKICAg
KiBHZXQgYSByZXF1ZXN0X3Rva2VuIGZyb20gVHdpdHRlcgogICAqCiAgICogQHJldHVybnMg
YSBrZXkvdmFsdWUgYXJyYXkgY29udGFpbmluZyBvYXV0aF90b2tlbiBhbmQgb2F1dGhfdG9r
ZW5fc2VjcmV0CiAgICovCiAgZnVuY3Rpb24gZ2V0UmVxdWVzdFRva2VuKCRvYXV0aF9jYWxs
YmFjayA9IE5VTEwpIHsKICAgICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgIGlmICghZW1w
dHkoJG9hdXRoX2NhbGxiYWNrKSkgewogICAgICAkcGFyYW1ldGVyc1snb2F1dGhfY2FsbGJh
Y2snXSA9ICRvYXV0aF9jYWxsYmFjazsKICAgIH0KICAgICRyZXF1ZXN0ID0gJHRoaXMtPm9B
dXRoUmVxdWVzdCgkdGhpcy0+cmVxdWVzdFRva2VuVVJMKCksICdHRVQnLCAkcGFyYW1ldGVy
cyk7CiAgICAkdG9rZW4gPSBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRlcnMoJHJlcXVlc3Qp
OwogICAgJHRoaXMtPnRva2VuID0gbmV3IE9BdXRoQ29uc3VtZXIoJHRva2VuWydvYXV0aF90
b2tlbiddLCAkdG9rZW5bJ29hdXRoX3Rva2VuX3NlY3JldCddKTsKICAgIHJldHVybiAkdG9r
ZW47CiAgfQoKICAvKioKICAgKiBHZXQgdGhlIGF1dGhvcml6ZSBVUkwKICAgKgogICAqIEBy
ZXR1cm5zIGEgc3RyaW5nCiAgICovCiAgZnVuY3Rpb24gZ2V0QXV0aG9yaXplVVJMKCR0b2tl
biwgJHNpZ25faW5fd2l0aF90d2l0dGVyID0gVFJVRSkgewogICAgaWYgKGlzX2FycmF5KCR0
b2tlbikpIHsKICAgICAgJHRva2VuID0gJHRva2VuWydvYXV0aF90b2tlbiddOwogICAgfQog
ICAgaWYgKGVtcHR5KCRzaWduX2luX3dpdGhfdHdpdHRlcikpIHsKICAgICAgcmV0dXJuICR0
aGlzLT5hdXRob3JpemVVUkwoKSAuICI/b2F1dGhfdG9rZW49eyR0b2tlbn0iOwogICAgfSBl
bHNlIHsKICAgICAgIHJldHVybiAkdGhpcy0+YXV0aGVudGljYXRlVVJMKCkgLiAiP29hdXRo
X3Rva2VuPXskdG9rZW59IjsKICAgIH0KICB9CgogIC8qKgogICAqIEV4Y2hhbmdlIHJlcXVl
c3QgdG9rZW4gYW5kIHNlY3JldCBmb3IgYW4gYWNjZXNzIHRva2VuIGFuZAogICAqIHNlY3Jl
dCwgdG8gc2lnbiBBUEkgY2FsbHMuCiAgICoKICAgKiBAcmV0dXJucyBhcnJheSgib2F1dGhf
dG9rZW4iID0+ICJ0aGUtYWNjZXNzLXRva2VuIiwKICAgKiAgICAgICAgICAgICAgICAib2F1
dGhfdG9rZW5fc2VjcmV0IiA9PiAidGhlLWFjY2Vzcy1zZWNyZXQiLAogICAqICAgICAgICAg
ICAgICAgICJ1c2VyX2lkIiA9PiAiOTQzNjk5MiIsCiAgICogICAgICAgICAgICAgICAgInNj
cmVlbl9uYW1lIiA9PiAiYWJyYWhhbSIpCiAgICovCiAgZnVuY3Rpb24gZ2V0QWNjZXNzVG9r
ZW4oJG9hdXRoX3ZlcmlmaWVyID0gRkFMU0UpIHsKICAgICRwYXJhbWV0ZXJzID0gYXJyYXko
KTsKICAgIGlmICghZW1wdHkoJG9hdXRoX3ZlcmlmaWVyKSkgewogICAgICAkcGFyYW1ldGVy
c1snb2F1dGhfdmVyaWZpZXInXSA9ICRvYXV0aF92ZXJpZmllcjsKICAgIH0KICAgICRyZXF1
ZXN0ID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdGhpcy0+YWNjZXNzVG9rZW5VUkwoKSwgJ0dF
VCcsICRwYXJhbWV0ZXJzKTsKICAgICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1l
dGVycygkcmVxdWVzdCk7CiAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1lcigk
dG9rZW5bJ29hdXRoX3Rva2VuJ10sICR0b2tlblsnb2F1dGhfdG9rZW5fc2VjcmV0J10pOwog
ICAgcmV0dXJuICR0b2tlbjsKICB9CgogIC8qKgogICAqIE9uZSB0aW1lIGV4Y2hhbmdlIG9m
IHVzZXJuYW1lIGFuZCBwYXNzd29yZCBmb3IgYWNjZXNzIHRva2VuIGFuZCBzZWNyZXQuCiAg
ICoKICAgKiBAcmV0dXJucyBhcnJheSgib2F1dGhfdG9rZW4iID0+ICJ0aGUtYWNjZXNzLXRv
a2VuIiwKICAgKiAgICAgICAgICAgICAgICAib2F1dGhfdG9rZW5fc2VjcmV0IiA9PiAidGhl
LWFjY2Vzcy1zZWNyZXQiLAogICAqICAgICAgICAgICAgICAgICJ1c2VyX2lkIiA9PiAiOTQz
Njk5MiIsCiAgICogICAgICAgICAgICAgICAgInNjcmVlbl9uYW1lIiA9PiAiYWJyYWhhbSIs
CiAgICogICAgICAgICAgICAgICAgInhfYXV0aF9leHBpcmVzIiA9PiAiMCIpCiAgICovCiAg
ZnVuY3Rpb24gZ2V0WEF1dGhUb2tlbigkdXNlcm5hbWUsICRwYXNzd29yZCkgewogICAgJHBh
cmFtZXRlcnMgPSBhcnJheSgpOwogICAgJHBhcmFtZXRlcnNbJ3hfYXV0aF91c2VybmFtZSdd
ID0gJHVzZXJuYW1lOwogICAgJHBhcmFtZXRlcnNbJ3hfYXV0aF9wYXNzd29yZCddID0gJHBh
c3N3b3JkOwogICAgJHBhcmFtZXRlcnNbJ3hfYXV0aF9tb2RlJ10gPSAnY2xpZW50X2F1dGgn
OwogICAgJHJlcXVlc3QgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR0aGlzLT5hY2Nlc3NUb2tl
blVSTCgpLCAnUE9TVCcsICRwYXJhbWV0ZXJzKTsKICAgICR0b2tlbiA9IE9BdXRoVXRpbDo6
cGFyc2VfcGFyYW1ldGVycygkcmVxdWVzdCk7CiAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1
dGhDb25zdW1lcigkdG9rZW5bJ29hdXRoX3Rva2VuJ10sICR0b2tlblsnb2F1dGhfdG9rZW5f
c2VjcmV0J10pOwogICAgcmV0dXJuICR0b2tlbjsKICB9CgogIC8qKgogICAqIEdFVCB3cmFw
cGVyIGZvciBvQXV0aFJlcXVlc3QuCiAgICovCiAgZnVuY3Rpb24gZ2V0KCR1cmwsICRwYXJh
bWV0ZXJzID0gYXJyYXkoKSkgewogICAgJHJlc3BvbnNlID0gJHRoaXMtPm9BdXRoUmVxdWVz
dCgkdXJsLCAnR0VUJywgJHBhcmFtZXRlcnMpOwogICAgaWYgKCR0aGlzLT5mb3JtYXQgPT09
ICdqc29uJyAmJiAkdGhpcy0+ZGVjb2RlX2pzb24pIHsKICAgICAgcmV0dXJuIGpzb25fZGVj
b2RlKCRyZXNwb25zZSk7CiAgICB9CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoq
CiAgICogUE9TVCB3cmFwcGVyIGZvciBvQXV0aFJlcXVlc3QuCiAgICovCiAgZnVuY3Rpb24g
cG9zdCgkdXJsLCAkcGFyYW1ldGVycyA9IGFycmF5KCkpIHsKICAgICRyZXNwb25zZSA9ICR0
aGlzLT5vQXV0aFJlcXVlc3QoJHVybCwgJ1BPU1QnLCAkcGFyYW1ldGVycyk7CiAgICBpZiAo
JHRoaXMtPmZvcm1hdCA9PT0gJ2pzb24nICYmICR0aGlzLT5kZWNvZGVfanNvbikgewogICAg
ICByZXR1cm4ganNvbl9kZWNvZGUoJHJlc3BvbnNlKTsKICAgIH0KICAgIHJldHVybiAkcmVz
cG9uc2U7CiAgfQoKICAvKioKICAgKiBERUxFVEUgd3JhcHBlciBmb3Igb0F1dGhSZXFldXN0
LgogICAqLwogIGZ1bmN0aW9uIGRlbGV0ZSgkdXJsLCAkcGFyYW1ldGVycyA9IGFycmF5KCkp
IHsKICAgICRyZXNwb25zZSA9ICR0aGlzLT5vQXV0aFJlcXVlc3QoJHVybCwgJ0RFTEVURScs
ICRwYXJhbWV0ZXJzKTsKICAgIGlmICgkdGhpcy0+Zm9ybWF0ID09PSAnanNvbicgJiYgJHRo
aXMtPmRlY29kZV9qc29uKSB7CiAgICAgIHJldHVybiBqc29uX2RlY29kZSgkcmVzcG9uc2Up
OwogICAgfQogICAgcmV0dXJuICRyZXNwb25zZTsKICB9CgogIC8qKgogICAqIEZvcm1hdCBh
bmQgc2lnbiBhbiBPQXV0aCAvIEFQSSByZXF1ZXN0CiAgICovCiAgZnVuY3Rpb24gb0F1dGhS
ZXF1ZXN0KCR1cmwsICRtZXRob2QsICRwYXJhbWV0ZXJzKSB7CiAgICBpZiAoc3RycnBvcygk
dXJsLCAnaHR0cHM6Ly8nKSAhPT0gMCAmJiBzdHJycG9zKCR1cmwsICdodHRwOi8vJykgIT09
IDApIHsKICAgICAgJHVybCA9ICJ7JHRoaXMtPmhvc3R9eyR1cmx9LnskdGhpcy0+Zm9ybWF0
fSI7CiAgICB9CiAgICAkcmVxdWVzdCA9IE9BdXRoUmVxdWVzdDo6ZnJvbV9jb25zdW1lcl9h
bmRfdG9rZW4oJHRoaXMtPmNvbnN1bWVyLCAkdGhpcy0+dG9rZW4sICRtZXRob2QsICR1cmws
ICRwYXJhbWV0ZXJzKTsKICAgICRyZXF1ZXN0LT5zaWduX3JlcXVlc3QoJHRoaXMtPnNoYTFf
bWV0aG9kLCAkdGhpcy0+Y29uc3VtZXIsICR0aGlzLT50b2tlbik7CiAgICBzd2l0Y2ggKCRt
ZXRob2QpIHsKICAgIGNhc2UgJ0dFVCc6CiAgICAgIHJldHVybiAkdGhpcy0+aHR0cCgkcmVx
dWVzdC0+dG9fdXJsKCksICdHRVQnKTsKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiAkdGhp
cy0+aHR0cCgkcmVxdWVzdC0+Z2V0X25vcm1hbGl6ZWRfaHR0cF91cmwoKSwgJG1ldGhvZCwg
JHJlcXVlc3QtPnRvX3Bvc3RkYXRhKCkpOwogICAgfQogIH0KCiAgLyoqCiAgICogTWFrZSBh
biBIVFRQIHJlcXVlc3QKICAgKgogICAqIEByZXR1cm4gQVBJIHJlc3VsdHMKICAgKi8KICBm
dW5jdGlvbiBodHRwKCR1cmwsICRtZXRob2QsICRwb3N0ZmllbGRzID0gTlVMTCkgewogICAg
JHRoaXMtPmh0dHBfaW5mbyA9IGFycmF5KCk7CiAgICAkY2kgPSBjdXJsX2luaXQoKTsKICAg
IC8qIEN1cmwgc2V0dGluZ3MgKi8KICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9VU0VS
QUdFTlQsICR0aGlzLT51c2VyYWdlbnQpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BU
X0NPTk5FQ1RUSU1FT1VULCAkdGhpcy0+Y29ubmVjdHRpbWVvdXQpOwogICAgY3VybF9zZXRv
cHQoJGNpLCBDVVJMT1BUX1RJTUVPVVQsICR0aGlzLT50aW1lb3V0KTsKICAgIGN1cmxfc2V0
b3B0KCRjaSwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgVFJVRSk7CiAgICBjdXJsX3NldG9w
dCgkY2ksIENVUkxPUFRfSFRUUEhFQURFUiwgYXJyYXkoJ0V4cGVjdDonKSk7CiAgICBjdXJs
X3NldG9wdCgkY2ksIENVUkxPUFRfU1NMX1ZFUklGWVBFRVIsICR0aGlzLT5zc2xfdmVyaWZ5
cGVlcik7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfSEVBREVSRlVOQ1RJT04sIGFy
cmF5KCR0aGlzLCAnZ2V0SGVhZGVyJykpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BU
X0hFQURFUiwgRkFMU0UpOwoKICAgIHN3aXRjaCAoJG1ldGhvZCkgewogICAgICBjYXNlICdQ
T1NUJzoKICAgICAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfUE9TVCwgVFJVRSk7CiAg
ICAgICAgaWYgKCFlbXB0eSgkcG9zdGZpZWxkcykpIHsKICAgICAgICAgIGN1cmxfc2V0b3B0
KCRjaSwgQ1VSTE9QVF9QT1NURklFTERTLCAkcG9zdGZpZWxkcyk7CiAgICAgICAgfQogICAg
ICAgIGJyZWFrOwogICAgICBjYXNlICdERUxFVEUnOgogICAgICAgIGN1cmxfc2V0b3B0KCRj
aSwgQ1VSTE9QVF9DVVNUT01SRVFVRVNULCAnREVMRVRFJyk7CiAgICAgICAgaWYgKCFlbXB0
eSgkcG9zdGZpZWxkcykpIHsKICAgICAgICAgICR1cmwgPSAieyR1cmx9P3skcG9zdGZpZWxk
c30iOwogICAgICAgIH0KICAgIH0KCiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfVVJM
LCAkdXJsKTsKICAgICRyZXNwb25zZSA9IGN1cmxfZXhlYygkY2kpOwogICAgJHRoaXMtPmh0
dHBfY29kZSA9IGN1cmxfZ2V0aW5mbygkY2ksIENVUkxJTkZPX0hUVFBfQ09ERSk7CiAgICAk
dGhpcy0+aHR0cF9pbmZvID0gYXJyYXlfbWVyZ2UoJHRoaXMtPmh0dHBfaW5mbywgY3VybF9n
ZXRpbmZvKCRjaSkpOwogICAgJHRoaXMtPnVybCA9ICR1cmw7CiAgICBjdXJsX2Nsb3NlICgk
Y2kpOwogICAgcmV0dXJuICRyZXNwb25zZTsKICB9CgogIC8qKgogICAqIEdldCB0aGUgaGVh
ZGVyIGluZm8gdG8gc3RvcmUuCiAgICovCiAgZnVuY3Rpb24gZ2V0SGVhZGVyKCRjaCwgJGhl
YWRlcikgewogICAgJGkgPSBzdHJwb3MoJGhlYWRlciwgJzonKTsKICAgIGlmICghZW1wdHko
JGkpKSB7CiAgICAgICRrZXkgPSBzdHJfcmVwbGFjZSgnLScsICdfJywgc3RydG9sb3dlcihz
dWJzdHIoJGhlYWRlciwgMCwgJGkpKSk7CiAgICAgICR2YWx1ZSA9IHRyaW0oc3Vic3RyKCRo
ZWFkZXIsICRpICsgMikpOwogICAgICAkdGhpcy0+aHR0cF9oZWFkZXJbJGtleV0gPSAkdmFs
dWU7CiAgICB9CiAgICByZXR1cm4gc3RybGVuKCRoZWFkZXIpOwogIH0KfQoKY2xhc3MgT0F1
dGhFeGNlcHRpb24gZXh0ZW5kcyBFeGNlcHRpb24gewogIC8vIHBhc3MKfQoKY2xhc3MgT0F1
dGhDb25zdW1lciB7CiAgcHVibGljICRrZXk7CiAgcHVibGljICRzZWNyZXQ7CgogIGZ1bmN0
aW9uIF9fY29uc3RydWN0KCRrZXksICRzZWNyZXQsICRjYWxsYmFja191cmw9TlVMTCkgewog
ICAgJHRoaXMtPmtleSA9ICRrZXk7CiAgICAkdGhpcy0+c2VjcmV0ID0gJHNlY3JldDsKICAg
ICR0aGlzLT5jYWxsYmFja191cmwgPSAkY2FsbGJhY2tfdXJsOwogIH0KCiAgZnVuY3Rpb24g
X190b1N0cmluZygpIHsKICAgIHJldHVybiAiT0F1dGhDb25zdW1lcltrZXk9JHRoaXMtPmtl
eSxzZWNyZXQ9JHRoaXMtPnNlY3JldF0iOwogIH0KfQoKY2xhc3MgT0F1dGhUb2tlbiB7CiAg
Ly8gYWNjZXNzIHRva2VucyBhbmQgcmVxdWVzdCB0b2tlbnMKICBwdWJsaWMgJGtleTsKICBw
dWJsaWMgJHNlY3JldDsKCiAgLyoqCiAgICoga2V5ID0gdGhlIHRva2VuCiAgICogc2VjcmV0
ID0gdGhlIHRva2VuIHNlY3JldAogICAqLwogIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRrZXks
ICRzZWNyZXQpIHsKICAgICR0aGlzLT5rZXkgPSAka2V5OwogICAgJHRoaXMtPnNlY3JldCA9
ICRzZWNyZXQ7CiAgfQoKICAvKioKICAgKiBnZW5lcmF0ZXMgdGhlIGJhc2ljIHN0cmluZyBz
ZXJpYWxpemF0aW9uIG9mIGEgdG9rZW4gdGhhdCBhIHNlcnZlcgogICAqIHdvdWxkIHJlc3Bv
bmQgdG8gcmVxdWVzdF90b2tlbiBhbmQgYWNjZXNzX3Rva2VuIGNhbGxzIHdpdGgKICAgKi8K
ICBmdW5jdGlvbiB0b19zdHJpbmcoKSB7CiAgICByZXR1cm4gIm9hdXRoX3Rva2VuPSIgLgog
ICAgICAgICAgIE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJHRoaXMtPmtleSkgLgog
ICAgICAgICAgICImb2F1dGhfdG9rZW5fc2VjcmV0PSIgLgogICAgICAgICAgIE9BdXRoVXRp
bDo6dXJsZW5jb2RlX3JmYzM5ODYoJHRoaXMtPnNlY3JldCk7CiAgfQoKICBmdW5jdGlvbiBf
X3RvU3RyaW5nKCkgewogICAgcmV0dXJuICR0aGlzLT50b19zdHJpbmcoKTsKICB9Cn0KCi8q
KgogKiBBIGNsYXNzIGZvciBpbXBsZW1lbnRpbmcgYSBTaWduYXR1cmUgTWV0aG9kCiAqIFNl
ZSBzZWN0aW9uIDkgKCJTaWduaW5nIFJlcXVlc3RzIikgaW4gdGhlIHNwZWMKICovCmFic3Ry
YWN0IGNsYXNzIE9BdXRoU2lnbmF0dXJlTWV0aG9kIHsKICAvKioKICAgKiBOZWVkcyB0byBy
ZXR1cm4gdGhlIG5hbWUgb2YgdGhlIFNpZ25hdHVyZSBNZXRob2QgKGllIEhNQUMtU0hBMSkK
ICAgKiBAcmV0dXJuIHN0cmluZwogICAqLwogIGFic3RyYWN0IHB1YmxpYyBmdW5jdGlvbiBn
ZXRfbmFtZSgpOwoKICAvKioKICAgKiBCdWlsZCB1cCB0aGUgc2lnbmF0dXJlCiAgICogTk9U
RTogVGhlIG91dHB1dCBvZiB0aGlzIGZ1bmN0aW9uIE1VU1QgTk9UIGJlIHVybGVuY29kZWQu
CiAgICogdGhlIGVuY29kaW5nIGlzIGhhbmRsZWQgaW4gT0F1dGhSZXF1ZXN0IHdoZW4gdGhl
IGZpbmFsCiAgICogcmVxdWVzdCBpcyBzZXJpYWxpemVkCiAgICogQHBhcmFtIE9BdXRoUmVx
dWVzdCAkcmVxdWVzdAogICAqIEBwYXJhbSBPQXV0aENvbnN1bWVyICRjb25zdW1lcgogICAq
IEBwYXJhbSBPQXV0aFRva2VuICR0b2tlbgogICAqIEByZXR1cm4gc3RyaW5nCiAgICovCiAg
YWJzdHJhY3QgcHVibGljIGZ1bmN0aW9uIGJ1aWxkX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNv
bnN1bWVyLCAkdG9rZW4pOwoKICAvKioKICAgKiBWZXJpZmllcyB0aGF0IGEgZ2l2ZW4gc2ln
bmF0dXJlIGlzIGNvcnJlY3QKICAgKiBAcGFyYW0gT0F1dGhSZXF1ZXN0ICRyZXF1ZXN0CiAg
ICogQHBhcmFtIE9BdXRoQ29uc3VtZXIgJGNvbnN1bWVyCiAgICogQHBhcmFtIE9BdXRoVG9r
ZW4gJHRva2VuCiAgICogQHBhcmFtIHN0cmluZyAkc2lnbmF0dXJlCiAgICogQHJldHVybiBi
b29sCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwg
JGNvbnN1bWVyLCAkdG9rZW4sICRzaWduYXR1cmUpIHsKICAgICRidWlsdCA9ICR0aGlzLT5i
dWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKTsKICAgIHJldHVy
biAkYnVpbHQgPT0gJHNpZ25hdHVyZTsKICB9Cn0KCi8qKgogKiBUaGUgSE1BQy1TSEExIHNp
Z25hdHVyZSBtZXRob2QgdXNlcyB0aGUgSE1BQy1TSEExIHNpZ25hdHVyZSBhbGdvcml0aG0g
YXMgZGVmaW5lZCBpbiBbUkZDMjEwNF0KICogd2hlcmUgdGhlIFNpZ25hdHVyZSBCYXNlIFN0
cmluZyBpcyB0aGUgdGV4dCBhbmQgdGhlIGtleSBpcyB0aGUgY29uY2F0ZW5hdGVkIHZhbHVl
cyAoZWFjaCBmaXJzdAogKiBlbmNvZGVkIHBlciBQYXJhbWV0ZXIgRW5jb2RpbmcpIG9mIHRo
ZSBDb25zdW1lciBTZWNyZXQgYW5kIFRva2VuIFNlY3JldCwgc2VwYXJhdGVkIGJ5IGFuICcm
JwogKiBjaGFyYWN0ZXIgKEFTQ0lJIGNvZGUgMzgpIGV2ZW4gaWYgZW1wdHkuCiAqICAgLSBD
aGFwdGVyIDkuMiAoIkhNQUMtU0hBMSIpCiAqLwpjbGFzcyBPQXV0aFNpZ25hdHVyZU1ldGhv
ZF9ITUFDX1NIQTEgZXh0ZW5kcyBPQXV0aFNpZ25hdHVyZU1ldGhvZCB7CiAgZnVuY3Rpb24g
Z2V0X25hbWUoKSB7CiAgICByZXR1cm4gIkhNQUMtU0hBMSI7CiAgfQoKICBwdWJsaWMgZnVu
Y3Rpb24gYnVpbGRfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbikgewog
ICAgJGJhc2Vfc3RyaW5nID0gJHJlcXVlc3QtPmdldF9zaWduYXR1cmVfYmFzZV9zdHJpbmco
KTsKICAgICRyZXF1ZXN0LT5iYXNlX3N0cmluZyA9ICRiYXNlX3N0cmluZzsKCiAgICAka2V5
X3BhcnRzID0gYXJyYXkoCiAgICAgICRjb25zdW1lci0+c2VjcmV0LAogICAgICAoJHRva2Vu
KSA/ICR0b2tlbi0+c2VjcmV0IDogIiIKICAgICk7CgogICAgJGtleV9wYXJ0cyA9IE9BdXRo
VXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJGtleV9wYXJ0cyk7CiAgICAka2V5ID0gaW1wbG9k
ZSgnJicsICRrZXlfcGFydHMpOwoKICAgIHJldHVybiBiYXNlNjRfZW5jb2RlKGhhc2hfaG1h
Yygnc2hhMScsICRiYXNlX3N0cmluZywgJGtleSwgdHJ1ZSkpOwogIH0KfQoKLyoqCiAqIFRo
ZSBQTEFJTlRFWFQgbWV0aG9kIGRvZXMgbm90IHByb3ZpZGUgYW55IHNlY3VyaXR5IHByb3Rl
Y3Rpb24gYW5kIFNIT1VMRCBvbmx5IGJlIHVzZWQKICogb3ZlciBhIHNlY3VyZSBjaGFubmVs
IHN1Y2ggYXMgSFRUUFMuIEl0IGRvZXMgbm90IHVzZSB0aGUgU2lnbmF0dXJlIEJhc2UgU3Ry
aW5nLgogKiAgIC0gQ2hhcHRlciA5LjQgKCJQTEFJTlRFWFQiKQogKi8KY2xhc3MgT0F1dGhT
aWduYXR1cmVNZXRob2RfUExBSU5URVhUIGV4dGVuZHMgT0F1dGhTaWduYXR1cmVNZXRob2Qg
ewogIHB1YmxpYyBmdW5jdGlvbiBnZXRfbmFtZSgpIHsKICAgIHJldHVybiAiUExBSU5URVhU
IjsKICB9CgogIC8qKgogICAqIG9hdXRoX3NpZ25hdHVyZSBpcyBzZXQgdG8gdGhlIGNvbmNh
dGVuYXRlZCBlbmNvZGVkIHZhbHVlcyBvZiB0aGUgQ29uc3VtZXIgU2VjcmV0IGFuZAogICAq
IFRva2VuIFNlY3JldCwgc2VwYXJhdGVkIGJ5IGEgJyYnIGNoYXJhY3RlciAoQVNDSUkgY29k
ZSAzOCksIGV2ZW4gaWYgZWl0aGVyIHNlY3JldCBpcwogICAqIGVtcHR5LiBUaGUgcmVzdWx0
IE1VU1QgYmUgZW5jb2RlZCBhZ2Fpbi4KICAgKiAgIC0gQ2hhcHRlciA5LjQuMSAoIkdlbmVy
YXRpbmcgU2lnbmF0dXJlcyIpCiAgICoKICAgKiBQbGVhc2Ugbm90ZSB0aGF0IHRoZSBzZWNv
bmQgZW5jb2RpbmcgTVVTVCBOT1QgaGFwcGVuIGluIHRoZSBTaWduYXR1cmVNZXRob2QsIGFz
CiAgICogT0F1dGhSZXF1ZXN0IGhhbmRsZXMgdGhpcyEKICAgKi8KICBwdWJsaWMgZnVuY3Rp
b24gYnVpbGRfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbikgewogICAg
JGtleV9wYXJ0cyA9IGFycmF5KAogICAgICAkY29uc3VtZXItPnNlY3JldCwKICAgICAgKCR0
b2tlbikgPyAkdG9rZW4tPnNlY3JldCA6ICIiCiAgICApOwoKICAgICRrZXlfcGFydHMgPSBP
QXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCRrZXlfcGFydHMpOwogICAgJGtleSA9IGlt
cGxvZGUoJyYnLCAka2V5X3BhcnRzKTsKICAgICRyZXF1ZXN0LT5iYXNlX3N0cmluZyA9ICRr
ZXk7CgogICAgcmV0dXJuICRrZXk7CiAgfQp9CgovKioKICogVGhlIFJTQS1TSEExIHNpZ25h
dHVyZSBtZXRob2QgdXNlcyB0aGUgUlNBU1NBLVBLQ1MxLXYxXzUgc2lnbmF0dXJlIGFsZ29y
aXRobSBhcyBkZWZpbmVkIGluCiAqIFtSRkMzNDQ3XSBzZWN0aW9uIDguMiAobW9yZSBzaW1w
bHkga25vd24gYXMgUEtDUyMxKSwgdXNpbmcgU0hBLTEgYXMgdGhlIGhhc2ggZnVuY3Rpb24g
Zm9yCiAqIEVNU0EtUEtDUzEtdjFfNS4gSXQgaXMgYXNzdW1lZCB0aGF0IHRoZSBDb25zdW1l
ciBoYXMgcHJvdmlkZWQgaXRzIFJTQSBwdWJsaWMga2V5IGluIGEKICogdmVyaWZpZWQgd2F5
IHRvIHRoZSBTZXJ2aWNlIFByb3ZpZGVyLCBpbiBhIG1hbm5lciB3aGljaCBpcyBiZXlvbmQg
dGhlIHNjb3BlIG9mIHRoaXMKICogc3BlY2lmaWNhdGlvbi4KICogICAtIENoYXB0ZXIgOS4z
ICgiUlNBLVNIQTEiKQogKi8KYWJzdHJhY3QgY2xhc3MgT0F1dGhTaWduYXR1cmVNZXRob2Rf
UlNBX1NIQTEgZXh0ZW5kcyBPQXV0aFNpZ25hdHVyZU1ldGhvZCB7CiAgcHVibGljIGZ1bmN0
aW9uIGdldF9uYW1lKCkgewogICAgcmV0dXJuICJSU0EtU0hBMSI7CiAgfQoKICAvLyBVcCB0
byB0aGUgU1AgdG8gaW1wbGVtZW50IHRoaXMgbG9va3VwIG9mIGtleXMuIFBvc3NpYmxlIGlk
ZWFzIGFyZToKICAvLyAoMSkgZG8gYSBsb29rdXAgaW4gYSB0YWJsZSBvZiB0cnVzdGVkIGNl
cnRzIGtleWVkIG9mZiBvZiBjb25zdW1lcgogIC8vICgyKSBmZXRjaCB2aWEgaHR0cCB1c2lu
ZyBhIHVybCBwcm92aWRlZCBieSB0aGUgcmVxdWVzdGVyCiAgLy8gKDMpIHNvbWUgc29ydCBv
ZiBzcGVjaWZpYyBkaXNjb3ZlcnkgY29kZSBiYXNlZCBvbiByZXF1ZXN0CiAgLy8KICAvLyBF
aXRoZXIgd2F5IHNob3VsZCByZXR1cm4gYSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhl
IGNlcnRpZmljYXRlCiAgcHJvdGVjdGVkIGFic3RyYWN0IGZ1bmN0aW9uIGZldGNoX3B1Ymxp
Y19jZXJ0KCYkcmVxdWVzdCk7CgogIC8vIFVwIHRvIHRoZSBTUCB0byBpbXBsZW1lbnQgdGhp
cyBsb29rdXAgb2Yga2V5cy4gUG9zc2libGUgaWRlYXMgYXJlOgogIC8vICgxKSBkbyBhIGxv
b2t1cCBpbiBhIHRhYmxlIG9mIHRydXN0ZWQgY2VydHMga2V5ZWQgb2ZmIG9mIGNvbnN1bWVy
CiAgLy8KICAvLyBFaXRoZXIgd2F5IHNob3VsZCByZXR1cm4gYSBzdHJpbmcgcmVwcmVzZW50
YXRpb24gb2YgdGhlIGNlcnRpZmljYXRlCiAgcHJvdGVjdGVkIGFic3RyYWN0IGZ1bmN0aW9u
IGZldGNoX3ByaXZhdGVfY2VydCgmJHJlcXVlc3QpOwoKICBwdWJsaWMgZnVuY3Rpb24gYnVp
bGRfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbikgewogICAgJGJhc2Vf
c3RyaW5nID0gJHJlcXVlc3QtPmdldF9zaWduYXR1cmVfYmFzZV9zdHJpbmcoKTsKICAgICRy
ZXF1ZXN0LT5iYXNlX3N0cmluZyA9ICRiYXNlX3N0cmluZzsKCiAgICAvLyBGZXRjaCB0aGUg
cHJpdmF0ZSBrZXkgY2VydCBiYXNlZCBvbiB0aGUgcmVxdWVzdAogICAgJGNlcnQgPSAkdGhp
cy0+ZmV0Y2hfcHJpdmF0ZV9jZXJ0KCRyZXF1ZXN0KTsKCiAgICAvLyBQdWxsIHRoZSBwcml2
YXRlIGtleSBJRCBmcm9tIHRoZSBjZXJ0aWZpY2F0ZQogICAgJHByaXZhdGVrZXlpZCA9IG9w
ZW5zc2xfZ2V0X3ByaXZhdGVrZXkoJGNlcnQpOwoKICAgIC8vIFNpZ24gdXNpbmcgdGhlIGtl
eQogICAgJG9rID0gb3BlbnNzbF9zaWduKCRiYXNlX3N0cmluZywgJHNpZ25hdHVyZSwgJHBy
aXZhdGVrZXlpZCk7CgogICAgLy8gUmVsZWFzZSB0aGUga2V5IHJlc291cmNlCiAgICBvcGVu
c3NsX2ZyZWVfa2V5KCRwcml2YXRla2V5aWQpOwoKICAgIHJldHVybiBiYXNlNjRfZW5jb2Rl
KCRzaWduYXR1cmUpOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGNoZWNrX3NpZ25hdHVyZSgk
cmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4sICRzaWduYXR1cmUpIHsKICAgICRkZWNvZGVk
X3NpZyA9IGJhc2U2NF9kZWNvZGUoJHNpZ25hdHVyZSk7CgogICAgJGJhc2Vfc3RyaW5nID0g
JHJlcXVlc3QtPmdldF9zaWduYXR1cmVfYmFzZV9zdHJpbmcoKTsKCiAgICAvLyBGZXRjaCB0
aGUgcHVibGljIGtleSBjZXJ0IGJhc2VkIG9uIHRoZSByZXF1ZXN0CiAgICAkY2VydCA9ICR0
aGlzLT5mZXRjaF9wdWJsaWNfY2VydCgkcmVxdWVzdCk7CgogICAgLy8gUHVsbCB0aGUgcHVi
bGljIGtleSBJRCBmcm9tIHRoZSBjZXJ0aWZpY2F0ZQogICAgJHB1YmxpY2tleWlkID0gb3Bl
bnNzbF9nZXRfcHVibGlja2V5KCRjZXJ0KTsKCiAgICAvLyBDaGVjayB0aGUgY29tcHV0ZWQg
c2lnbmF0dXJlIGFnYWluc3QgdGhlIG9uZSBwYXNzZWQgaW4gdGhlIHF1ZXJ5CiAgICAkb2sg
PSBvcGVuc3NsX3ZlcmlmeSgkYmFzZV9zdHJpbmcsICRkZWNvZGVkX3NpZywgJHB1YmxpY2tl
eWlkKTsKCiAgICAvLyBSZWxlYXNlIHRoZSBrZXkgcmVzb3VyY2UKICAgIG9wZW5zc2xfZnJl
ZV9rZXkoJHB1YmxpY2tleWlkKTsKCiAgICByZXR1cm4gJG9rID09IDE7CiAgfQp9CgpjbGFz
cyBPQXV0aFJlcXVlc3QgewogIHByaXZhdGUgJHBhcmFtZXRlcnM7CiAgcHJpdmF0ZSAkaHR0
cF9tZXRob2Q7CiAgcHJpdmF0ZSAkaHR0cF91cmw7CiAgLy8gZm9yIGRlYnVnIHB1cnBvc2Vz
CiAgcHVibGljICRiYXNlX3N0cmluZzsKICBwdWJsaWMgc3RhdGljICR2ZXJzaW9uID0gJzEu
MCc7CiAgcHVibGljIHN0YXRpYyAkUE9TVF9JTlBVVCA9ICdwaHA6Ly9pbnB1dCc7CgogIGZ1
bmN0aW9uIF9fY29uc3RydWN0KCRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVy
cz1OVUxMKSB7CiAgICBAJHBhcmFtZXRlcnMgb3IgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwog
ICAgJHBhcmFtZXRlcnMgPSBhcnJheV9tZXJnZSggT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0
ZXJzKHBhcnNlX3VybCgkaHR0cF91cmwsIFBIUF9VUkxfUVVFUlkpKSwgJHBhcmFtZXRlcnMp
OwogICAgJHRoaXMtPnBhcmFtZXRlcnMgPSAkcGFyYW1ldGVyczsKICAgICR0aGlzLT5odHRw
X21ldGhvZCA9ICRodHRwX21ldGhvZDsKICAgICR0aGlzLT5odHRwX3VybCA9ICRodHRwX3Vy
bDsKICB9CgoKICAvKioKICAgKiBhdHRlbXB0IHRvIGJ1aWxkIHVwIGEgcmVxdWVzdCBmcm9t
IHdoYXQgd2FzIHBhc3NlZCB0byB0aGUgc2VydmVyCiAgICovCiAgcHVibGljIHN0YXRpYyBm
dW5jdGlvbiBmcm9tX3JlcXVlc3QoJGh0dHBfbWV0aG9kPU5VTEwsICRodHRwX3VybD1OVUxM
LCAkcGFyYW1ldGVycz1OVUxMKSB7CiAgICAkc2NoZW1lID0gKCFpc3NldCgkX1NFUlZFUlsn
SFRUUFMnXSkgfHwgJF9TRVJWRVJbJ0hUVFBTJ10gIT0gIm9uIikKICAgICAgICAgICAgICA/
ICdodHRwJwogICAgICAgICAgICAgIDogJ2h0dHBzJzsKICAgIEAkaHR0cF91cmwgb3IgJGh0
dHBfdXJsID0gJHNjaGVtZSAuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc6Ly8n
IC4gJF9TRVJWRVJbJ0hUVFBfSE9TVCddIC4KICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgJzonIC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJF9TRVJWRVJbJ1NFUlZF
Ul9QT1JUJ10gLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkX1NFUlZFUlsnUkVR
VUVTVF9VUkknXTsKICAgIEAkaHR0cF9tZXRob2Qgb3IgJGh0dHBfbWV0aG9kID0gJF9TRVJW
RVJbJ1JFUVVFU1RfTUVUSE9EJ107CgogICAgLy8gV2Ugd2VyZW4ndCBoYW5kZWQgYW55IHBh
cmFtZXRlcnMsIHNvIGxldCdzIGZpbmQgdGhlIG9uZXMgcmVsZXZhbnQgdG8KICAgIC8vIHRo
aXMgcmVxdWVzdC4KICAgIC8vIElmIHlvdSBydW4gWE1MLVJQQyBvciBzaW1pbGFyIHlvdSBz
aG91bGQgdXNlIHRoaXMgdG8gcHJvdmlkZSB5b3VyIG93bgogICAgLy8gcGFyc2VkIHBhcmFt
ZXRlci1saXN0CiAgICBpZiAoISRwYXJhbWV0ZXJzKSB7CiAgICAgIC8vIEZpbmQgcmVxdWVz
dCBoZWFkZXJzCiAgICAgICRyZXF1ZXN0X2hlYWRlcnMgPSBPQXV0aFV0aWw6OmdldF9oZWFk
ZXJzKCk7CgogICAgICAvLyBQYXJzZSB0aGUgcXVlcnktc3RyaW5nIHRvIGZpbmQgR0VUIHBh
cmFtZXRlcnMKICAgICAgJHBhcmFtZXRlcnMgPSBPQXV0aFV0aWw6OnBhcnNlX3BhcmFtZXRl
cnMoJF9TRVJWRVJbJ1FVRVJZX1NUUklORyddKTsKCiAgICAgIC8vIEl0J3MgYSBQT1NUIHJl
cXVlc3Qgb2YgdGhlIHByb3BlciBjb250ZW50LXR5cGUsIHNvIHBhcnNlIFBPU1QKICAgICAg
Ly8gcGFyYW1ldGVycyBhbmQgYWRkIHRob3NlIG92ZXJyaWRpbmcgYW55IGR1cGxpY2F0ZXMg
ZnJvbSBHRVQKICAgICAgaWYgKCRodHRwX21ldGhvZCA9PSAiUE9TVCIKICAgICAgICAgICYm
IEBzdHJzdHIoJHJlcXVlc3RfaGVhZGVyc1siQ29udGVudC1UeXBlIl0sCiAgICAgICAgICAg
ICAgICAgICAgICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKQogICAgICAg
ICAgKSB7CiAgICAgICAgJHBvc3RfZGF0YSA9IE9BdXRoVXRpbDo6cGFyc2VfcGFyYW1ldGVy
cygKICAgICAgICAgIGZpbGVfZ2V0X2NvbnRlbnRzKHNlbGY6OiRQT1NUX0lOUFVUKQogICAg
ICAgICk7CiAgICAgICAgJHBhcmFtZXRlcnMgPSBhcnJheV9tZXJnZSgkcGFyYW1ldGVycywg
JHBvc3RfZGF0YSk7CiAgICAgIH0KCiAgICAgIC8vIFdlIGhhdmUgYSBBdXRob3JpemF0aW9u
LWhlYWRlciB3aXRoIE9BdXRoIGRhdGEuIFBhcnNlIHRoZSBoZWFkZXIKICAgICAgLy8gYW5k
IGFkZCB0aG9zZSBvdmVycmlkaW5nIGFueSBkdXBsaWNhdGVzIGZyb20gR0VUIG9yIFBPU1QK
ICAgICAgaWYgKEBzdWJzdHIoJHJlcXVlc3RfaGVhZGVyc1snQXV0aG9yaXphdGlvbiddLCAw
LCA2KSA9PSAiT0F1dGggIikgewogICAgICAgICRoZWFkZXJfcGFyYW1ldGVycyA9IE9BdXRo
VXRpbDo6c3BsaXRfaGVhZGVyKAogICAgICAgICAgJHJlcXVlc3RfaGVhZGVyc1snQXV0aG9y
aXphdGlvbiddCiAgICAgICAgKTsKICAgICAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdl
KCRwYXJhbWV0ZXJzLCAkaGVhZGVyX3BhcmFtZXRlcnMpOwogICAgICB9CgogICAgfQoKICAg
IHJldHVybiBuZXcgT0F1dGhSZXF1ZXN0KCRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFy
YW1ldGVycyk7CiAgfQoKICAvKioKICAgKiBwcmV0dHkgbXVjaCBhIGhlbHBlciBmdW5jdGlv
biB0byBzZXQgdXAgdGhlIHJlcXVlc3QKICAgKi8KICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9u
IGZyb21fY29uc3VtZXJfYW5kX3Rva2VuKCRjb25zdW1lciwgJHRva2VuLCAkaHR0cF9tZXRo
b2QsICRodHRwX3VybCwgJHBhcmFtZXRlcnM9TlVMTCkgewogICAgQCRwYXJhbWV0ZXJzIG9y
ICRwYXJhbWV0ZXJzID0gYXJyYXkoKTsKICAgICRkZWZhdWx0cyA9IGFycmF5KCJvYXV0aF92
ZXJzaW9uIiA9PiBPQXV0aFJlcXVlc3Q6OiR2ZXJzaW9uLAogICAgICAgICAgICAgICAgICAg
ICAgIm9hdXRoX25vbmNlIiA9PiBPQXV0aFJlcXVlc3Q6OmdlbmVyYXRlX25vbmNlKCksCiAg
ICAgICAgICAgICAgICAgICAgICAib2F1dGhfdGltZXN0YW1wIiA9PiBPQXV0aFJlcXVlc3Q6
OmdlbmVyYXRlX3RpbWVzdGFtcCgpLAogICAgICAgICAgICAgICAgICAgICAgIm9hdXRoX2Nv
bnN1bWVyX2tleSIgPT4gJGNvbnN1bWVyLT5rZXkpOwogICAgaWYgKCR0b2tlbikKICAgICAg
JGRlZmF1bHRzWydvYXV0aF90b2tlbiddID0gJHRva2VuLT5rZXk7CgogICAgJHBhcmFtZXRl
cnMgPSBhcnJheV9tZXJnZSgkZGVmYXVsdHMsICRwYXJhbWV0ZXJzKTsKCiAgICByZXR1cm4g
bmV3IE9BdXRoUmVxdWVzdCgkaHR0cF9tZXRob2QsICRodHRwX3VybCwgJHBhcmFtZXRlcnMp
OwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIHNldF9wYXJhbWV0ZXIoJG5hbWUsICR2YWx1ZSwg
JGFsbG93X2R1cGxpY2F0ZXMgPSB0cnVlKSB7CiAgICBpZiAoJGFsbG93X2R1cGxpY2F0ZXMg
JiYgaXNzZXQoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdKSkgewogICAgICAvLyBXZSBoYXZl
IGFscmVhZHkgYWRkZWQgcGFyYW1ldGVyKHMpIHdpdGggdGhpcyBuYW1lLCBzbyBhZGQgdG8g
dGhlIGxpc3QKICAgICAgaWYgKGlzX3NjYWxhcigkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0p
KSB7CiAgICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3QgZHVwbGljYXRlLCBzbyB0cmFuc2Zv
cm0gc2NhbGFyIChzdHJpbmcpCiAgICAgICAgLy8gaW50byBhbiBhcnJheSBzbyB3ZSBjYW4g
YWRkIHRoZSBkdXBsaWNhdGVzCiAgICAgICAgJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdID0g
YXJyYXkoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdKTsKICAgICAgfQoKICAgICAgJHRoaXMt
PnBhcmFtZXRlcnNbJG5hbWVdW10gPSAkdmFsdWU7CiAgICB9IGVsc2UgewogICAgICAkdGhp
cy0+cGFyYW1ldGVyc1skbmFtZV0gPSAkdmFsdWU7CiAgICB9CiAgfQoKICBwdWJsaWMgZnVu
Y3Rpb24gZ2V0X3BhcmFtZXRlcigkbmFtZSkgewogICAgcmV0dXJuIGlzc2V0KCR0aGlzLT5w
YXJhbWV0ZXJzWyRuYW1lXSkgPyAkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0gOiBudWxsOwog
IH0KCiAgcHVibGljIGZ1bmN0aW9uIGdldF9wYXJhbWV0ZXJzKCkgewogICAgcmV0dXJuICR0
aGlzLT5wYXJhbWV0ZXJzOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIHVuc2V0X3BhcmFtZXRl
cigkbmFtZSkgewogICAgdW5zZXQoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdKTsKICB9Cgog
IC8qKgogICAqIFRoZSByZXF1ZXN0IHBhcmFtZXRlcnMsIHNvcnRlZCBhbmQgY29uY2F0ZW5h
dGVkIGludG8gYSBub3JtYWxpemVkIHN0cmluZy4KICAgKiBAcmV0dXJuIHN0cmluZwogICAq
LwogIHB1YmxpYyBmdW5jdGlvbiBnZXRfc2lnbmFibGVfcGFyYW1ldGVycygpIHsKICAgIC8v
IEdyYWIgYWxsIHBhcmFtZXRlcnMKICAgICRwYXJhbXMgPSAkdGhpcy0+cGFyYW1ldGVyczsK
CiAgICAvLyBSZW1vdmUgb2F1dGhfc2lnbmF0dXJlIGlmIHByZXNlbnQKICAgIC8vIFJlZjog
U3BlYzogOS4xLjEgKCJUaGUgb2F1dGhfc2lnbmF0dXJlIHBhcmFtZXRlciBNVVNUIGJlIGV4
Y2x1ZGVkLiIpCiAgICBpZiAoaXNzZXQoJHBhcmFtc1snb2F1dGhfc2lnbmF0dXJlJ10pKSB7
CiAgICAgIHVuc2V0KCRwYXJhbXNbJ29hdXRoX3NpZ25hdHVyZSddKTsKICAgIH0KCiAgICBy
ZXR1cm4gT0F1dGhVdGlsOjpidWlsZF9odHRwX3F1ZXJ5KCRwYXJhbXMpOwogIH0KCiAgLyoq
CiAgICogUmV0dXJucyB0aGUgYmFzZSBzdHJpbmcgb2YgdGhpcyByZXF1ZXN0CiAgICoKICAg
KiBUaGUgYmFzZSBzdHJpbmcgZGVmaW5lZCBhcyB0aGUgbWV0aG9kLCB0aGUgdXJsCiAgICog
YW5kIHRoZSBwYXJhbWV0ZXJzIChub3JtYWxpemVkKSwgZWFjaCB1cmxlbmNvZGVkCiAgICog
YW5kIHRoZSBjb25jYXRlZCB3aXRoICYuCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGdldF9z
aWduYXR1cmVfYmFzZV9zdHJpbmcoKSB7CiAgICAkcGFydHMgPSBhcnJheSgKICAgICAgJHRo
aXMtPmdldF9ub3JtYWxpemVkX2h0dHBfbWV0aG9kKCksCiAgICAgICR0aGlzLT5nZXRfbm9y
bWFsaXplZF9odHRwX3VybCgpLAogICAgICAkdGhpcy0+Z2V0X3NpZ25hYmxlX3BhcmFtZXRl
cnMoKQogICAgKTsKCiAgICAkcGFydHMgPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2
KCRwYXJ0cyk7CgogICAgcmV0dXJuIGltcGxvZGUoJyYnLCAkcGFydHMpOwogIH0KCiAgLyoq
CiAgICoganVzdCB1cHBlcmNhc2VzIHRoZSBodHRwIG1ldGhvZAogICAqLwogIHB1YmxpYyBm
dW5jdGlvbiBnZXRfbm9ybWFsaXplZF9odHRwX21ldGhvZCgpIHsKICAgIHJldHVybiBzdHJ0
b3VwcGVyKCR0aGlzLT5odHRwX21ldGhvZCk7CiAgfQoKICAvKioKICAgKiBwYXJzZXMgdGhl
IHVybCBhbmQgcmVidWlsZHMgaXQgdG8gYmUKICAgKiBzY2hlbWU6Ly9ob3N0L3BhdGgKICAg
Ki8KICBwdWJsaWMgZnVuY3Rpb24gZ2V0X25vcm1hbGl6ZWRfaHR0cF91cmwoKSB7CiAgICAk
cGFydHMgPSBwYXJzZV91cmwoJHRoaXMtPmh0dHBfdXJsKTsKCiAgICAkcG9ydCA9IEAkcGFy
dHNbJ3BvcnQnXTsKICAgICRzY2hlbWUgPSAkcGFydHNbJ3NjaGVtZSddOwogICAgJGhvc3Qg
PSAkcGFydHNbJ2hvc3QnXTsKICAgICRwYXRoID0gQCRwYXJ0c1sncGF0aCddOwoKICAgICRw
b3J0IG9yICRwb3J0ID0gKCRzY2hlbWUgPT0gJ2h0dHBzJykgPyAnNDQzJyA6ICc4MCc7Cgog
ICAgaWYgKCgkc2NoZW1lID09ICdodHRwcycgJiYgJHBvcnQgIT0gJzQ0MycpCiAgICAgICAg
fHwgKCRzY2hlbWUgPT0gJ2h0dHAnICYmICRwb3J0ICE9ICc4MCcpKSB7CiAgICAgICRob3N0
ID0gIiRob3N0OiRwb3J0IjsKICAgIH0KICAgIHJldHVybiAiJHNjaGVtZTovLyRob3N0JHBh
dGgiOwogIH0KCiAgLyoqCiAgICogYnVpbGRzIGEgdXJsIHVzYWJsZSBmb3IgYSBHRVQgcmVx
dWVzdAogICAqLwogIHB1YmxpYyBmdW5jdGlvbiB0b191cmwoKSB7CiAgICAkcG9zdF9kYXRh
ID0gJHRoaXMtPnRvX3Bvc3RkYXRhKCk7CiAgICAkb3V0ID0gJHRoaXMtPmdldF9ub3JtYWxp
emVkX2h0dHBfdXJsKCk7CiAgICBpZiAoJHBvc3RfZGF0YSkgewogICAgICAkb3V0IC49ICc/
Jy4kcG9zdF9kYXRhOwogICAgfQogICAgcmV0dXJuICRvdXQ7CiAgfQoKICAvKioKICAgKiBi
dWlsZHMgdGhlIGRhdGEgb25lIHdvdWxkIHNlbmQgaW4gYSBQT1NUIHJlcXVlc3QKICAgKi8K
ICBwdWJsaWMgZnVuY3Rpb24gdG9fcG9zdGRhdGEoKSB7CiAgICByZXR1cm4gT0F1dGhVdGls
OjpidWlsZF9odHRwX3F1ZXJ5KCR0aGlzLT5wYXJhbWV0ZXJzKTsKICB9CgogIC8qKgogICAq
IGJ1aWxkcyB0aGUgQXV0aG9yaXphdGlvbjogaGVhZGVyCiAgICovCiAgcHVibGljIGZ1bmN0
aW9uIHRvX2hlYWRlcigkcmVhbG09bnVsbCkgewogICAgJGZpcnN0ID0gdHJ1ZTsKICBpZigk
cmVhbG0pIHsKICAgICAgJG91dCA9ICdBdXRob3JpemF0aW9uOiBPQXV0aCByZWFsbT0iJyAu
IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJHJlYWxtKSAuICciJzsKICAgICAgJGZp
cnN0ID0gZmFsc2U7CiAgICB9IGVsc2UKICAgICAgJG91dCA9ICdBdXRob3JpemF0aW9uOiBP
QXV0aCc7CgogICAgJHRvdGFsID0gYXJyYXkoKTsKICAgIGZvcmVhY2ggKCR0aGlzLT5wYXJh
bWV0ZXJzIGFzICRrID0+ICR2KSB7CiAgICAgIGlmIChzdWJzdHIoJGssIDAsIDUpICE9ICJv
YXV0aCIpIGNvbnRpbnVlOwogICAgICBpZiAoaXNfYXJyYXkoJHYpKSB7CiAgICAgICAgdGhy
b3cgbmV3IE9BdXRoRXhjZXB0aW9uKCdBcnJheXMgbm90IHN1cHBvcnRlZCBpbiBoZWFkZXJz
Jyk7CiAgICAgIH0KICAgICAgJG91dCAuPSAoJGZpcnN0KSA/ICcgJyA6ICcsJzsKICAgICAg
JG91dCAuPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KCRrKSAuCiAgICAgICAgICAg
ICAgJz0iJyAuCiAgICAgICAgICAgICAgT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4Nigk
dikgLgogICAgICAgICAgICAgICciJzsKICAgICAgJGZpcnN0ID0gZmFsc2U7CiAgICB9CiAg
ICByZXR1cm4gJG91dDsKICB9CgogIHB1YmxpYyBmdW5jdGlvbiBfX3RvU3RyaW5nKCkgewog
ICAgcmV0dXJuICR0aGlzLT50b191cmwoKTsKICB9CgoKICBwdWJsaWMgZnVuY3Rpb24gc2ln
bl9yZXF1ZXN0KCRzaWduYXR1cmVfbWV0aG9kLCAkY29uc3VtZXIsICR0b2tlbikgewogICAg
JHRoaXMtPnNldF9wYXJhbWV0ZXIoCiAgICAgICJvYXV0aF9zaWduYXR1cmVfbWV0aG9kIiwK
ICAgICAgJHNpZ25hdHVyZV9tZXRob2QtPmdldF9uYW1lKCksCiAgICAgIGZhbHNlCiAgICAp
OwogICAgJHNpZ25hdHVyZSA9ICR0aGlzLT5idWlsZF9zaWduYXR1cmUoJHNpZ25hdHVyZV9t
ZXRob2QsICRjb25zdW1lciwgJHRva2VuKTsKICAgICR0aGlzLT5zZXRfcGFyYW1ldGVyKCJv
YXV0aF9zaWduYXR1cmUiLCAkc2lnbmF0dXJlLCBmYWxzZSk7CiAgfQoKICBwdWJsaWMgZnVu
Y3Rpb24gYnVpbGRfc2lnbmF0dXJlKCRzaWduYXR1cmVfbWV0aG9kLCAkY29uc3VtZXIsICR0
b2tlbikgewogICAgJHNpZ25hdHVyZSA9ICRzaWduYXR1cmVfbWV0aG9kLT5idWlsZF9zaWdu
YXR1cmUoJHRoaXMsICRjb25zdW1lciwgJHRva2VuKTsKICAgIHJldHVybiAkc2lnbmF0dXJl
OwogIH0KCiAgLyoqCiAgICogdXRpbCBmdW5jdGlvbjogY3VycmVudCB0aW1lc3RhbXAKICAg
Ki8KICBwcml2YXRlIHN0YXRpYyBmdW5jdGlvbiBnZW5lcmF0ZV90aW1lc3RhbXAoKSB7CiAg
ICByZXR1cm4gdGltZSgpOwogIH0KCiAgLyoqCiAgICogdXRpbCBmdW5jdGlvbjogY3VycmVu
dCBub25jZQogICAqLwogIHByaXZhdGUgc3RhdGljIGZ1bmN0aW9uIGdlbmVyYXRlX25vbmNl
KCkgewogICAgJG10ID0gbWljcm90aW1lKCk7CiAgICAkcmFuZCA9IG10X3JhbmQoKTsKCiAg
ICByZXR1cm4gbWQ1KCRtdCAuICRyYW5kKTsgLy8gbWQ1cyBsb29rIG5pY2VyIHRoYW4gbnVt
YmVycwogIH0KfQoKY2xhc3MgT0F1dGhTZXJ2ZXIgewogIHByb3RlY3RlZCAkdGltZXN0YW1w
X3RocmVzaG9sZCA9IDMwMDsgLy8gaW4gc2Vjb25kcywgZml2ZSBtaW51dGVzCiAgcHJvdGVj
dGVkICR2ZXJzaW9uID0gJzEuMCc7ICAgICAgICAgICAgIC8vIGhpIGJsYWluZQogIHByb3Rl
Y3RlZCAkc2lnbmF0dXJlX21ldGhvZHMgPSBhcnJheSgpOwoKICBwcm90ZWN0ZWQgJGRhdGFf
c3RvcmU7CgogIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRkYXRhX3N0b3JlKSB7CiAgICAkdGhp
cy0+ZGF0YV9zdG9yZSA9ICRkYXRhX3N0b3JlOwogIH0KCiAgcHVibGljIGZ1bmN0aW9uIGFk
ZF9zaWduYXR1cmVfbWV0aG9kKCRzaWduYXR1cmVfbWV0aG9kKSB7CiAgICAkdGhpcy0+c2ln
bmF0dXJlX21ldGhvZHNbJHNpZ25hdHVyZV9tZXRob2QtPmdldF9uYW1lKCldID0KICAgICAg
JHNpZ25hdHVyZV9tZXRob2Q7CiAgfQoKICAvLyBoaWdoIGxldmVsIGZ1bmN0aW9ucwoKICAv
KioKICAgKiBwcm9jZXNzIGEgcmVxdWVzdF90b2tlbiByZXF1ZXN0CiAgICogcmV0dXJucyB0
aGUgcmVxdWVzdCB0b2tlbiBvbiBzdWNjZXNzCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGZl
dGNoX3JlcXVlc3RfdG9rZW4oJiRyZXF1ZXN0KSB7CiAgICAkdGhpcy0+Z2V0X3ZlcnNpb24o
JHJlcXVlc3QpOwoKICAgICRjb25zdW1lciA9ICR0aGlzLT5nZXRfY29uc3VtZXIoJHJlcXVl
c3QpOwoKICAgIC8vIG5vIHRva2VuIHJlcXVpcmVkIGZvciB0aGUgaW5pdGlhbCB0b2tlbiBy
ZXF1ZXN0CiAgICAkdG9rZW4gPSBOVUxMOwoKICAgICR0aGlzLT5jaGVja19zaWduYXR1cmUo
JHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKTsKCiAgICAvLyBSZXYgQSBjaGFuZ2UKICAg
ICRjYWxsYmFjayA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF9jYWxsYmFjaycp
OwogICAgJG5ld190b2tlbiA9ICR0aGlzLT5kYXRhX3N0b3JlLT5uZXdfcmVxdWVzdF90b2tl
bigkY29uc3VtZXIsICRjYWxsYmFjayk7CgogICAgcmV0dXJuICRuZXdfdG9rZW47CiAgfQoK
ICAvKioKICAgKiBwcm9jZXNzIGFuIGFjY2Vzc190b2tlbiByZXF1ZXN0CiAgICogcmV0dXJu
cyB0aGUgYWNjZXNzIHRva2VuIG9uIHN1Y2Nlc3MKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24g
ZmV0Y2hfYWNjZXNzX3Rva2VuKCYkcmVxdWVzdCkgewogICAgJHRoaXMtPmdldF92ZXJzaW9u
KCRyZXF1ZXN0KTsKCiAgICAkY29uc3VtZXIgPSAkdGhpcy0+Z2V0X2NvbnN1bWVyKCRyZXF1
ZXN0KTsKCiAgICAvLyByZXF1aXJlcyBhdXRob3JpemVkIHJlcXVlc3QgdG9rZW4KICAgICR0
b2tlbiA9ICR0aGlzLT5nZXRfdG9rZW4oJHJlcXVlc3QsICRjb25zdW1lciwgInJlcXVlc3Qi
KTsKCiAgICAkdGhpcy0+Y2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0
b2tlbik7CgogICAgLy8gUmV2IEEgY2hhbmdlCiAgICAkdmVyaWZpZXIgPSAkcmVxdWVzdC0+
Z2V0X3BhcmFtZXRlcignb2F1dGhfdmVyaWZpZXInKTsKICAgICRuZXdfdG9rZW4gPSAkdGhp
cy0+ZGF0YV9zdG9yZS0+bmV3X2FjY2Vzc190b2tlbigkdG9rZW4sICRjb25zdW1lciwgJHZl
cmlmaWVyKTsKCiAgICByZXR1cm4gJG5ld190b2tlbjsKICB9CgogIC8qKgogICAqIHZlcmlm
eSBhbiBhcGkgY2FsbCwgY2hlY2tzIGFsbCB0aGUgcGFyYW1ldGVycwogICAqLwogIHB1Ymxp
YyBmdW5jdGlvbiB2ZXJpZnlfcmVxdWVzdCgmJHJlcXVlc3QpIHsKICAgICR0aGlzLT5nZXRf
dmVyc2lvbigkcmVxdWVzdCk7CiAgICAkY29uc3VtZXIgPSAkdGhpcy0+Z2V0X2NvbnN1bWVy
KCRyZXF1ZXN0KTsKICAgICR0b2tlbiA9ICR0aGlzLT5nZXRfdG9rZW4oJHJlcXVlc3QsICRj
b25zdW1lciwgImFjY2VzcyIpOwogICAgJHRoaXMtPmNoZWNrX3NpZ25hdHVyZSgkcmVxdWVz
dCwgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAgcmV0dXJuIGFycmF5KCRjb25zdW1lciwgJHRv
a2VuKTsKICB9CgogIC8vIEludGVybmFscyBmcm9tIGhlcmUKICAvKioKICAgKiB2ZXJzaW9u
IDEKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGdldF92ZXJzaW9uKCYkcmVxdWVzdCkgewog
ICAgJHZlcnNpb24gPSAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcigib2F1dGhfdmVyc2lvbiIp
OwogICAgaWYgKCEkdmVyc2lvbikgewogICAgICAvLyBTZXJ2aWNlIFByb3ZpZGVycyBNVVNU
IGFzc3VtZSB0aGUgcHJvdG9jb2wgdmVyc2lvbiB0byBiZSAxLjAgaWYgdGhpcyBwYXJhbWV0
ZXIgaXMgbm90IHByZXNlbnQuCiAgICAgIC8vIENoYXB0ZXIgNy4wICgiQWNjZXNzaW5nIFBy
b3RlY3RlZCBSZXNzb3VyY2VzIikKICAgICAgJHZlcnNpb24gPSAnMS4wJzsKICAgIH0KICAg
IGlmICgkdmVyc2lvbiAhPT0gJHRoaXMtPnZlcnNpb24pIHsKICAgICAgdGhyb3cgbmV3IE9B
dXRoRXhjZXB0aW9uKCJPQXV0aCB2ZXJzaW9uICckdmVyc2lvbicgbm90IHN1cHBvcnRlZCIp
OwogICAgfQogICAgcmV0dXJuICR2ZXJzaW9uOwogIH0KCiAgLyoqCiAgICogZmlndXJlIG91
dCB0aGUgc2lnbmF0dXJlIHdpdGggc29tZSBkZWZhdWx0cwogICAqLwogIHByaXZhdGUgZnVu
Y3Rpb24gZ2V0X3NpZ25hdHVyZV9tZXRob2QoJiRyZXF1ZXN0KSB7CiAgICAkc2lnbmF0dXJl
X21ldGhvZCA9CiAgICAgICAgQCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCJvYXV0aF9zaWdu
YXR1cmVfbWV0aG9kIik7CgogICAgaWYgKCEkc2lnbmF0dXJlX21ldGhvZCkgewogICAgICAv
LyBBY2NvcmRpbmcgdG8gY2hhcHRlciA3ICgiQWNjZXNzaW5nIFByb3RlY3RlZCBSZXNzb3Vy
Y2VzIikgdGhlIHNpZ25hdHVyZS1tZXRob2QKICAgICAgLy8gcGFyYW1ldGVyIGlzIHJlcXVp
cmVkLCBhbmQgd2UgY2FuJ3QganVzdCBmYWxsYmFjayB0byBQTEFJTlRFWFQKICAgICAgdGhy
b3cgbmV3IE9BdXRoRXhjZXB0aW9uKCdObyBzaWduYXR1cmUgbWV0aG9kIHBhcmFtZXRlci4g
VGhpcyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQnKTsKICAgIH0KCiAgICBpZiAoIWluX2FycmF5
KCRzaWduYXR1cmVfbWV0aG9kLAogICAgICAgICAgICAgICAgICBhcnJheV9rZXlzKCR0aGlz
LT5zaWduYXR1cmVfbWV0aG9kcykpKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlv
bigKICAgICAgICAiU2lnbmF0dXJlIG1ldGhvZCAnJHNpZ25hdHVyZV9tZXRob2QnIG5vdCBz
dXBwb3J0ZWQgIiAuCiAgICAgICAgInRyeSBvbmUgb2YgdGhlIGZvbGxvd2luZzogIiAuCiAg
ICAgICAgaW1wbG9kZSgiLCAiLCBhcnJheV9rZXlzKCR0aGlzLT5zaWduYXR1cmVfbWV0aG9k
cykpCiAgICAgICk7CiAgICB9CiAgICByZXR1cm4gJHRoaXMtPnNpZ25hdHVyZV9tZXRob2Rz
WyRzaWduYXR1cmVfbWV0aG9kXTsKICB9CgogIC8qKgogICAqIHRyeSB0byBmaW5kIHRoZSBj
b25zdW1lciBmb3IgdGhlIHByb3ZpZGVkIHJlcXVlc3QncyBjb25zdW1lciBrZXkKICAgKi8K
ICBwcml2YXRlIGZ1bmN0aW9uIGdldF9jb25zdW1lcigmJHJlcXVlc3QpIHsKICAgICRjb25z
dW1lcl9rZXkgPSBAJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoIm9hdXRoX2NvbnN1bWVyX2tl
eSIpOwogICAgaWYgKCEkY29uc3VtZXJfa2V5KSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4
Y2VwdGlvbigiSW52YWxpZCBjb25zdW1lciBrZXkiKTsKICAgIH0KCiAgICAkY29uc3VtZXIg
PSAkdGhpcy0+ZGF0YV9zdG9yZS0+bG9va3VwX2NvbnN1bWVyKCRjb25zdW1lcl9rZXkpOwog
ICAgaWYgKCEkY29uc3VtZXIpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJ
bnZhbGlkIGNvbnN1bWVyIik7CiAgICB9CgogICAgcmV0dXJuICRjb25zdW1lcjsKICB9Cgog
IC8qKgogICAqIHRyeSB0byBmaW5kIHRoZSB0b2tlbiBmb3IgdGhlIHByb3ZpZGVkIHJlcXVl
c3QncyB0b2tlbiBrZXkKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGdldF90b2tlbigmJHJl
cXVlc3QsICRjb25zdW1lciwgJHRva2VuX3R5cGU9ImFjY2VzcyIpIHsKICAgICR0b2tlbl9m
aWVsZCA9IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfdG9rZW4nKTsKICAgICR0
b2tlbiA9ICR0aGlzLT5kYXRhX3N0b3JlLT5sb29rdXBfdG9rZW4oCiAgICAgICRjb25zdW1l
ciwgJHRva2VuX3R5cGUsICR0b2tlbl9maWVsZAogICAgKTsKICAgIGlmICghJHRva2VuKSB7
CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiSW52YWxpZCAkdG9rZW5fdHlwZSB0
b2tlbjogJHRva2VuX2ZpZWxkIik7CiAgICB9CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAg
LyoqCiAgICogYWxsLWluLW9uZSBmdW5jdGlvbiB0byBjaGVjayB0aGUgc2lnbmF0dXJlIG9u
IGEgcmVxdWVzdAogICAqIHNob3VsZCBndWVzcyB0aGUgc2lnbmF0dXJlIG1ldGhvZCBhcHBy
b3ByaWF0ZWx5CiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBjaGVja19zaWduYXR1cmUoJiRy
ZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbikgewogICAgLy8gdGhpcyBzaG91bGQgcHJvYmFi
bHkgYmUgaW4gYSBkaWZmZXJlbnQgbWV0aG9kCiAgICAkdGltZXN0YW1wID0gQCRyZXF1ZXN0
LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF90aW1lc3RhbXAnKTsKICAgICRub25jZSA9IEAkcmVx
dWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhfbm9uY2UnKTsKCiAgICAkdGhpcy0+Y2hlY2tf
dGltZXN0YW1wKCR0aW1lc3RhbXApOwogICAgJHRoaXMtPmNoZWNrX25vbmNlKCRjb25zdW1l
ciwgJHRva2VuLCAkbm9uY2UsICR0aW1lc3RhbXApOwoKICAgICRzaWduYXR1cmVfbWV0aG9k
ID0gJHRoaXMtPmdldF9zaWduYXR1cmVfbWV0aG9kKCRyZXF1ZXN0KTsKCiAgICAkc2lnbmF0
dXJlID0gJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX3NpZ25hdHVyZScpOwogICAg
JHZhbGlkX3NpZyA9ICRzaWduYXR1cmVfbWV0aG9kLT5jaGVja19zaWduYXR1cmUoCiAgICAg
ICRyZXF1ZXN0LAogICAgICAkY29uc3VtZXIsCiAgICAgICR0b2tlbiwKICAgICAgJHNpZ25h
dHVyZQogICAgKTsKCiAgICBpZiAoISR2YWxpZF9zaWcpIHsKICAgICAgdGhyb3cgbmV3IE9B
dXRoRXhjZXB0aW9uKCJJbnZhbGlkIHNpZ25hdHVyZSIpOwogICAgfQogIH0KCiAgLyoqCiAg
ICogY2hlY2sgdGhhdCB0aGUgdGltZXN0YW1wIGlzIG5ldyBlbm91Z2gKICAgKi8KICBwcml2
YXRlIGZ1bmN0aW9uIGNoZWNrX3RpbWVzdGFtcCgkdGltZXN0YW1wKSB7CiAgICBpZiggISAk
dGltZXN0YW1wICkKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKAogICAgICAgICdN
aXNzaW5nIHRpbWVzdGFtcCBwYXJhbWV0ZXIuIFRoZSBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQn
CiAgICAgICk7CgogICAgLy8gdmVyaWZ5IHRoYXQgdGltZXN0YW1wIGlzIHJlY2VudGlzaAog
ICAgJG5vdyA9IHRpbWUoKTsKICAgIGlmIChhYnMoJG5vdyAtICR0aW1lc3RhbXApID4gJHRo
aXMtPnRpbWVzdGFtcF90aHJlc2hvbGQpIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0
aW9uKAogICAgICAgICJFeHBpcmVkIHRpbWVzdGFtcCwgeW91cnMgJHRpbWVzdGFtcCwgb3Vy
cyAkbm93IgogICAgICApOwogICAgfQogIH0KCiAgLyoqCiAgICogY2hlY2sgdGhhdCB0aGUg
bm9uY2UgaXMgbm90IHJlcGVhdGVkCiAgICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBjaGVja19u
b25jZSgkY29uc3VtZXIsICR0b2tlbiwgJG5vbmNlLCAkdGltZXN0YW1wKSB7CiAgICBpZigg
ISAkbm9uY2UgKQogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAgICAgJ01p
c3Npbmcgbm9uY2UgcGFyYW1ldGVyLiBUaGUgcGFyYW1ldGVyIGlzIHJlcXVpcmVkJwogICAg
ICApOwoKICAgIC8vIHZlcmlmeSB0aGF0IHRoZSBub25jZSBpcyB1bmlxdWVpc2gKICAgICRm
b3VuZCA9ICR0aGlzLT5kYXRhX3N0b3JlLT5sb29rdXBfbm9uY2UoCiAgICAgICRjb25zdW1l
ciwKICAgICAgJHRva2VuLAogICAgICAkbm9uY2UsCiAgICAgICR0aW1lc3RhbXAKICAgICk7
CiAgICBpZiAoJGZvdW5kKSB7CiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2VwdGlvbigiTm9u
Y2UgYWxyZWFkeSB1c2VkOiAkbm9uY2UiKTsKICAgIH0KICB9Cgp9CgpjbGFzcyBPQXV0aERh
dGFTdG9yZSB7CiAgZnVuY3Rpb24gbG9va3VwX2NvbnN1bWVyKCRjb25zdW1lcl9rZXkpIHsK
ICAgIC8vIGltcGxlbWVudCBtZQogIH0KCiAgZnVuY3Rpb24gbG9va3VwX3Rva2VuKCRjb25z
dW1lciwgJHRva2VuX3R5cGUsICR0b2tlbikgewogICAgLy8gaW1wbGVtZW50IG1lCiAgfQoK
ICBmdW5jdGlvbiBsb29rdXBfbm9uY2UoJGNvbnN1bWVyLCAkdG9rZW4sICRub25jZSwgJHRp
bWVzdGFtcCkgewogICAgLy8gaW1wbGVtZW50IG1lCiAgfQoKICBmdW5jdGlvbiBuZXdfcmVx
dWVzdF90b2tlbigkY29uc3VtZXIsICRjYWxsYmFjayA9IG51bGwpIHsKICAgIC8vIHJldHVy
biBhIG5ldyB0b2tlbiBhdHRhY2hlZCB0byB0aGlzIGNvbnN1bWVyCiAgfQoKICBmdW5jdGlv
biBuZXdfYWNjZXNzX3Rva2VuKCR0b2tlbiwgJGNvbnN1bWVyLCAkdmVyaWZpZXIgPSBudWxs
KSB7CiAgICAvLyByZXR1cm4gYSBuZXcgYWNjZXNzIHRva2VuIGF0dGFjaGVkIHRvIHRoaXMg
Y29uc3VtZXIKICAgIC8vIGZvciB0aGUgdXNlciBhc3NvY2lhdGVkIHdpdGggdGhpcyB0b2tl
biBpZiB0aGUgcmVxdWVzdCB0b2tlbgogICAgLy8gaXMgYXV0aG9yaXplZAogICAgLy8gc2hv
dWxkIGFsc28gaW52YWxpZGF0ZSB0aGUgcmVxdWVzdCB0b2tlbgogIH0KCn0KCmNsYXNzIE9B
dXRoVXRpbCB7CiAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiB1cmxlbmNvZGVfcmZjMzk4Nigk
aW5wdXQpIHsKICBpZiAoaXNfYXJyYXkoJGlucHV0KSkgewogICAgcmV0dXJuIGFycmF5X21h
cChhcnJheSgnT0F1dGhVdGlsJywgJ3VybGVuY29kZV9yZmMzOTg2JyksICRpbnB1dCk7CiAg
fSBlbHNlIGlmIChpc19zY2FsYXIoJGlucHV0KSkgewogICAgcmV0dXJuIHN0cl9yZXBsYWNl
KAogICAgICAnKycsCiAgICAgICcgJywKICAgICAgc3RyX3JlcGxhY2UoJyU3RScsICd+Jywg
cmF3dXJsZW5jb2RlKCRpbnB1dCkpCiAgICApOwogIH0gZWxzZSB7CiAgICByZXR1cm4gJyc7
CiAgfQp9CgoKICAvLyBUaGlzIGRlY29kZSBmdW5jdGlvbiBpc24ndCB0YWtpbmcgaW50byBj
b25zaWRlcmF0aW9uIHRoZSBhYm92ZQogIC8vIG1vZGlmaWNhdGlvbnMgdG8gdGhlIGVuY29k
aW5nIHByb2Nlc3MuIEhvd2V2ZXIsIHRoaXMgbWV0aG9kIGRvZXNuJ3QKICAvLyBzZWVtIHRv
IGJlIHVzZWQgYW55d2hlcmUgc28gbGVhdmluZyBpdCBhcyBpcy4KICBwdWJsaWMgc3RhdGlj
IGZ1bmN0aW9uIHVybGRlY29kZV9yZmMzOTg2KCRzdHJpbmcpIHsKICAgIHJldHVybiB1cmxk
ZWNvZGUoJHN0cmluZyk7CiAgfQoKICAvLyBVdGlsaXR5IGZ1bmN0aW9uIGZvciB0dXJuaW5n
IHRoZSBBdXRob3JpemF0aW9uOiBoZWFkZXIgaW50bwogIC8vIHBhcmFtZXRlcnMsIGhhcyB0
byBkbyBzb21lIHVuZXNjYXBpbmcKICAvLyBDYW4gZmlsdGVyIG91dCBhbnkgbm9uLW9hdXRo
IHBhcmFtZXRlcnMgaWYgbmVlZGVkIChkZWZhdWx0IGJlaGF2aW91cikKICBwdWJsaWMgc3Rh
dGljIGZ1bmN0aW9uIHNwbGl0X2hlYWRlcigkaGVhZGVyLCAkb25seV9hbGxvd19vYXV0aF9w
YXJhbWV0ZXJzID0gdHJ1ZSkgewogICAgJHBhdHRlcm4gPSAnLygoWy1fYS16XSopPSgiKFte
Il0qKSJ8KFteLF0qKSksPykvJzsKICAgICRvZmZzZXQgPSAwOwogICAgJHBhcmFtcyA9IGFy
cmF5KCk7CiAgICB3aGlsZSAocHJlZ19tYXRjaCgkcGF0dGVybiwgJGhlYWRlciwgJG1hdGNo
ZXMsIFBSRUdfT0ZGU0VUX0NBUFRVUkUsICRvZmZzZXQpID4gMCkgewogICAgICAkbWF0Y2gg
PSAkbWF0Y2hlc1swXTsKICAgICAgJGhlYWRlcl9uYW1lID0gJG1hdGNoZXNbMl1bMF07CiAg
ICAgICRoZWFkZXJfY29udGVudCA9IChpc3NldCgkbWF0Y2hlc1s1XSkpID8gJG1hdGNoZXNb
NV1bMF0gOiAkbWF0Y2hlc1s0XVswXTsKICAgICAgaWYgKHByZWdfbWF0Y2goJy9eb2F1dGhf
LycsICRoZWFkZXJfbmFtZSkgfHwgISRvbmx5X2FsbG93X29hdXRoX3BhcmFtZXRlcnMpIHsK
ICAgICAgICAkcGFyYW1zWyRoZWFkZXJfbmFtZV0gPSBPQXV0aFV0aWw6OnVybGRlY29kZV9y
ZmMzOTg2KCRoZWFkZXJfY29udGVudCk7CiAgICAgIH0KICAgICAgJG9mZnNldCA9ICRtYXRj
aFsxXSArIHN0cmxlbigkbWF0Y2hbMF0pOwogICAgfQoKICAgIGlmIChpc3NldCgkcGFyYW1z
WydyZWFsbSddKSkgewogICAgICB1bnNldCgkcGFyYW1zWydyZWFsbSddKTsKICAgIH0KCiAg
ICByZXR1cm4gJHBhcmFtczsKICB9CgogIC8vIGhlbHBlciB0byB0cnkgdG8gc29ydCBvdXQg
aGVhZGVycyBmb3IgcGVvcGxlIHdobyBhcmVuJ3QgcnVubmluZyBhcGFjaGUKICBwdWJsaWMg
c3RhdGljIGZ1bmN0aW9uIGdldF9oZWFkZXJzKCkgewogICAgaWYgKGZ1bmN0aW9uX2V4aXN0
cygnYXBhY2hlX3JlcXVlc3RfaGVhZGVycycpKSB7CiAgICAgIC8vIHdlIG5lZWQgdGhpcyB0
byBnZXQgdGhlIGFjdHVhbCBBdXRob3JpemF0aW9uOiBoZWFkZXIKICAgICAgLy8gYmVjYXVz
ZSBhcGFjaGUgdGVuZHMgdG8gdGVsbCB1cyBpdCBkb2Vzbid0IGV4aXN0CiAgICAgICRoZWFk
ZXJzID0gYXBhY2hlX3JlcXVlc3RfaGVhZGVycygpOwoKICAgICAgLy8gc2FuaXRpemUgdGhl
IG91dHB1dCBvZiBhcGFjaGVfcmVxdWVzdF9oZWFkZXJzIGJlY2F1c2UKICAgICAgLy8gd2Ug
YWx3YXlzIHdhbnQgdGhlIGtleXMgdG8gYmUgQ2FzZWQtTGlrZS1UaGlzIGFuZCBhcmgoKQog
ICAgICAvLyByZXR1cm5zIHRoZSBoZWFkZXJzIGluIHRoZSBzYW1lIGNhc2UgYXMgdGhleSBh
cmUgaW4gdGhlCiAgICAgIC8vIHJlcXVlc3QKICAgICAgJG91dCA9IGFycmF5KCk7CiAgICAg
IGZvcmVhY2goICRoZWFkZXJzIEFTICRrZXkgPT4gJHZhbHVlICkgewogICAgICAgICRrZXkg
PSBzdHJfcmVwbGFjZSgKICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAiLSIsCiAgICAg
ICAgICAgIHVjd29yZHMoc3RydG9sb3dlcihzdHJfcmVwbGFjZSgiLSIsICIgIiwgJGtleSkp
KQogICAgICAgICAgKTsKICAgICAgICAkb3V0WyRrZXldID0gJHZhbHVlOwogICAgICB9CiAg
ICB9IGVsc2UgewogICAgICAvLyBvdGhlcndpc2Ugd2UgZG9uJ3QgaGF2ZSBhcGFjaGUgYW5k
IGFyZSBqdXN0IGdvaW5nIHRvIGhhdmUgdG8gaG9wZQogICAgICAvLyB0aGF0ICRfU0VSVkVS
IGFjdHVhbGx5IGNvbnRhaW5zIHdoYXQgd2UgbmVlZAogICAgICAkb3V0ID0gYXJyYXkoKTsK
ICAgICAgaWYoIGlzc2V0KCRfU0VSVkVSWydDT05URU5UX1RZUEUnXSkgKQogICAgICAgICRv
dXRbJ0NvbnRlbnQtVHlwZSddID0gJF9TRVJWRVJbJ0NPTlRFTlRfVFlQRSddOwogICAgICBp
ZiggaXNzZXQoJF9FTlZbJ0NPTlRFTlRfVFlQRSddKSApCiAgICAgICAgJG91dFsnQ29udGVu
dC1UeXBlJ10gPSAkX0VOVlsnQ09OVEVOVF9UWVBFJ107CgogICAgICBmb3JlYWNoICgkX1NF
UlZFUiBhcyAka2V5ID0+ICR2YWx1ZSkgewogICAgICAgIGlmIChzdWJzdHIoJGtleSwgMCwg
NSkgPT0gIkhUVFBfIikgewogICAgICAgICAgLy8gdGhpcyBpcyBjaGFvcywgYmFzaWNhbGx5
IGl0IGlzIGp1c3QgdGhlcmUgdG8gY2FwaXRhbGl6ZSB0aGUgZmlyc3QKICAgICAgICAgIC8v
IGxldHRlciBvZiBldmVyeSB3b3JkIHRoYXQgaXMgbm90IGFuIGluaXRpYWwgSFRUUCBhbmQg
c3RyaXAgSFRUUAogICAgICAgICAgLy8gY29kZSBmcm9tIHByemVtZWsKICAgICAgICAgICRr
ZXkgPSBzdHJfcmVwbGFjZSgKICAgICAgICAgICAgIiAiLAogICAgICAgICAgICAiLSIsCiAg
ICAgICAgICAgIHVjd29yZHMoc3RydG9sb3dlcihzdHJfcmVwbGFjZSgiXyIsICIgIiwgc3Vi
c3RyKCRrZXksIDUpKSkpCiAgICAgICAgICApOwogICAgICAgICAgJG91dFska2V5XSA9ICR2
YWx1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHJldHVybiAkb3V0OwogIH0KCiAg
Ly8gVGhpcyBmdW5jdGlvbiB0YWtlcyBhIGlucHV0IGxpa2UgYT1iJmE9YyZkPWUgYW5kIHJl
dHVybnMgdGhlIHBhcnNlZAogIC8vIHBhcmFtZXRlcnMgbGlrZSB0aGlzCiAgLy8gYXJyYXko
J2EnID0+IGFycmF5KCdiJywnYycpLCAnZCcgPT4gJ2UnKQogIHB1YmxpYyBzdGF0aWMgZnVu
Y3Rpb24gcGFyc2VfcGFyYW1ldGVycyggJGlucHV0ICkgewogICAgaWYgKCFpc3NldCgkaW5w
dXQpIHx8ICEkaW5wdXQpIHJldHVybiBhcnJheSgpOwoKICAgICRwYWlycyA9IGV4cGxvZGUo
JyYnLCAkaW5wdXQpOwoKICAgICRwYXJzZWRfcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICBm
b3JlYWNoICgkcGFpcnMgYXMgJHBhaXIpIHsKICAgICAgJHNwbGl0ID0gZXhwbG9kZSgnPScs
ICRwYWlyLCAyKTsKICAgICAgJHBhcmFtZXRlciA9IE9BdXRoVXRpbDo6dXJsZGVjb2RlX3Jm
YzM5ODYoJHNwbGl0WzBdKTsKICAgICAgJHZhbHVlID0gaXNzZXQoJHNwbGl0WzFdKSA/IE9B
dXRoVXRpbDo6dXJsZGVjb2RlX3JmYzM5ODYoJHNwbGl0WzFdKSA6ICcnOwoKICAgICAgaWYg
KGlzc2V0KCRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSkpIHsKICAgICAgICAvLyBX
ZSBoYXZlIGFscmVhZHkgcmVjaWV2ZWQgcGFyYW1ldGVyKHMpIHdpdGggdGhpcyBuYW1lLCBz
byBhZGQgdG8gdGhlIGxpc3QKICAgICAgICAvLyBvZiBwYXJhbWV0ZXJzIHdpdGggdGhpcyBu
YW1lCgogICAgICAgIGlmIChpc19zY2FsYXIoJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0
ZXJdKSkgewogICAgICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3QgZHVwbGljYXRlLCBzbyB0
cmFuc2Zvcm0gc2NhbGFyIChzdHJpbmcpIGludG8gYW4gYXJyYXkKICAgICAgICAgIC8vIHNv
IHdlIGNhbiBhZGQgdGhlIGR1cGxpY2F0ZXMKICAgICAgICAgICRwYXJzZWRfcGFyYW1ldGVy
c1skcGFyYW1ldGVyXSA9IGFycmF5KCRwYXJzZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSk7
CiAgICAgICAgfQoKICAgICAgICAkcGFyc2VkX3BhcmFtZXRlcnNbJHBhcmFtZXRlcl1bXSA9
ICR2YWx1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICAkcGFyc2VkX3BhcmFtZXRlcnNbJHBh
cmFtZXRlcl0gPSAkdmFsdWU7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiAkcGFyc2VkX3Bh
cmFtZXRlcnM7CiAgfQoKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGJ1aWxkX2h0dHBfcXVl
cnkoJHBhcmFtcykgewogICAgaWYgKCEkcGFyYW1zKSByZXR1cm4gJyc7CgogICAgLy8gVXJs
ZW5jb2RlIGJvdGgga2V5cyBhbmQgdmFsdWVzCiAgICAka2V5cyA9IE9BdXRoVXRpbDo6dXJs
ZW5jb2RlX3JmYzM5ODYoYXJyYXlfa2V5cygkcGFyYW1zKSk7CiAgICAkdmFsdWVzID0gT0F1
dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NihhcnJheV92YWx1ZXMoJHBhcmFtcykpOwogICAg
JHBhcmFtcyA9IGFycmF5X2NvbWJpbmUoJGtleXMsICR2YWx1ZXMpOwoKICAgIC8vIFBhcmFt
ZXRlcnMgYXJlIHNvcnRlZCBieSBuYW1lLCB1c2luZyBsZXhpY29ncmFwaGljYWwgYnl0ZSB2
YWx1ZSBvcmRlcmluZy4KICAgIC8vIFJlZjogU3BlYzogOS4xLjEgKDEpCiAgICB1a3NvcnQo
JHBhcmFtcywgJ3N0cmNtcCcpOwoKICAgICRwYWlycyA9IGFycmF5KCk7CiAgICBmb3JlYWNo
ICgkcGFyYW1zIGFzICRwYXJhbWV0ZXIgPT4gJHZhbHVlKSB7CiAgICAgIGlmIChpc19hcnJh
eSgkdmFsdWUpKSB7CiAgICAgICAgLy8gSWYgdHdvIG9yIG1vcmUgcGFyYW1ldGVycyBzaGFy
ZSB0aGUgc2FtZSBuYW1lLCB0aGV5IGFyZSBzb3J0ZWQgYnkgdGhlaXIgdmFsdWUKICAgICAg
ICAvLyBSZWY6IFNwZWM6IDkuMS4xICgxKQogICAgICAgIG5hdHNvcnQoJHZhbHVlKTsKICAg
ICAgICBmb3JlYWNoICgkdmFsdWUgYXMgJGR1cGxpY2F0ZV92YWx1ZSkgewogICAgICAgICAg
JHBhaXJzW10gPSAkcGFyYW1ldGVyIC4gJz0nIC4gJGR1cGxpY2F0ZV92YWx1ZTsKICAgICAg
ICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgJHBhaXJzW10gPSAkcGFyYW1ldGVyIC4gJz0n
IC4gJHZhbHVlOwogICAgICB9CiAgICB9CiAgICAvLyBGb3IgZWFjaCBwYXJhbWV0ZXIsIHRo
ZSBuYW1lIGlzIHNlcGFyYXRlZCBmcm9tIHRoZSBjb3JyZXNwb25kaW5nIHZhbHVlIGJ5IGFu
ICc9JyBjaGFyYWN0ZXIgKEFTQ0lJIGNvZGUgNjEpCiAgICAvLyBFYWNoIG5hbWUtdmFsdWUg
cGFpciBpcyBzZXBhcmF0ZWQgYnkgYW4gJyYnIGNoYXJhY3RlciAoQVNDSUkgY29kZSAzOCkK
ICAgIHJldHVybiBpbXBsb2RlKCcmJywgJHBhaXJzKTsKICB9Cn0iO3M6MzoibWQ1IjtzOjMy
OiIyOGFjMDliZGQ2YWRhZmQ5OTNiMzdhNmExZWE2M2ViMCI7fQ==
