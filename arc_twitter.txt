# arc_twitter v3.0-dev
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjc6
IjMuMC1kZXYiO3M6NjoiYXV0aG9yIjtzOjExOiJBbmR5IENhcnRlciI7czoxMDoiYXV0aG9y
X3VyaSI7czozMToiaHR0cDovL3JlZGhvdGNoaWxsaXByb2plY3QuY29tLyI7czoxMToiZGVz
Y3JpcHRpb24iO3M6NjA6IjxhIGhyZWY9Imh0dHA6Ly93d3cudHdpdHRlci5jb20iPlR3aXR0
ZXI8L2E+IGZvciBUZXh0cGF0dGVybiI7czo1OiJvcmRlciI7czoxOiI1IjtzOjQ6InR5cGUi
O3M6MToiMSI7czo1OiJmbGFncyI7czoxOiIzIjtzOjQ6ImhlbHAiO3M6MTU0NTY6Igk8aDEg
Y2xhc3M9InRpdGxlIj48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9zcGFuPiBUd2VldCAoYXJj
X3R3aXR0ZXIgZm9yIFRleHRwYXR0ZXJuKTwvaDE+CgoJPG9sPgoJCTxsaT48YSBocmVmPSIj
YXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2Fy
Y190d2l0dGVyX2luc3RhbGxhdGlvbiI+SW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxsYXRpb248
L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3RhZyI+VGhlIGFyY190d2l0
dGVyIHRhZzwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfc2VhcmNoX3Rh
ZyI+VGhlIGFyY190d2l0dGVyX3NlYXJjaCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0i
I2FyY190d2l0dGVyX3JldHdlZXRfdGFnIj5UaGUgYXJjX3R3aXR0ZXJfcmV0d2VldCB0YWc8
L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190d2l0dGVyX3R3ZWV0X3VybCI+VGhlIGFy
Y190d2l0dGVyX3R3ZWV0X3VybCB0YWc8L2E+PC9saT4KCQk8bGk+PGEgaHJlZj0iI2FyY190
d2l0dGVyX3Rpbnl1cmwiPlRoZSBhcmNfdHdpdHRlcl90aW55dXJsIHRhZzwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfY2FjaGluZyI+Q2FjaGluZzwvYT48L2xpPgoJ
CTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfcHJlZnMiPlByZWZlcmVuY2VzPC9hPjwvbGk+
CgkJPGxpPjxhIGhyZWY9IiNhcmNfdHdpdHRlcl9hcnRpY2xlIj5Ud2VldGluZyBhcnRpY2xl
czwvYT48L2xpPgoJCTxsaT48YSBocmVmPSIjYXJjX3R3aXR0ZXJfYWRtaW4iPlRoZSBUd2l0
dGVyIHRhYjwvYT48L2xpPgoJPC9vbD4KCgk8cD48c3BhbiBjbGFzcz0iY2FwcyI+VFhQPC9z
cGFuPiBUd2VldCBwcm92aWRlcyBhY2Nlc3MgdG8geW91ciBUd2l0dGVyIGFjY291bnQgdGhy
b3VnaCBib3RoIHRoZSBhZG1pbiBpbnRlcmZhY2UgYW5kIHRoZSBwdWJsaWMgc2lkZSBvZiB5
b3VyIHNpdGUuIFVwZGF0ZSBUd2l0dGVyIHdoZW4geW91IHBvc3QgYSBuZXcgYXJ0aWNsZSAo
d2l0aCBhcnRpY2xlLWJ5LWFydGljbGUgb3B0IG91dCBvcHRpb24pLCB1cGRhdGUgYW5kIHZp
ZXcgeW91ciBUd2l0dGVyIGZlZWQgdGhyb3VnaCB0aGUgYWRtaW4gVHdpdHRlciB0YWIsIGFu
ZCBkaXNwbGF5IFR3aXR0ZXIgZmVlZHMgb24geW91ciBzaXRlLjwvcD4KCgk8cD5SZXF1aXJl
bWVudHM6LTwvcD4KCgk8dWw+CgkJPGxpPlRleHRwYXR0ZXJuIDQuMis8L2xpPgoJCTxsaT48
c3BhbiBjbGFzcz0iY2FwcyI+UEhQPC9zcGFuPiA1IGFuZCBjVVJMPC9saT4KCTwvdWw+CgoJ
PGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfYXV0aG9yIj5BdXRob3I8L2gy
PgoKCTxwPjxhIGhyZWY9Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbSI+QW5keSBD
YXJ0ZXI8L2E+LiBGb3Igb3RoZXIgVGV4dHBhdHRlcm4gcGx1Z2lucyBieSBtZSB2aXNpdCBt
eSA8YSBocmVmPSJodHRwOi8vcmVkaG90Y2hpbGxpcHJvamVjdC5jb20vdHhwIj5QbHVnaW5z
IHBhZ2U8L2E+LjwvcD4KCgk8cD5UaGFua3MgdG8gPGEgaHJlZj0iaHR0cDovL21hbmZyZS5u
ZXQvIj5NaWNoYWVsIE1hbmZyZTwvYT4gZm9yIGluc3BpcmF0aW9uIGZvciB0aGUgYXJ0aWNs
ZSB0d2VldCBwYXJ0IG9mIHRoaXMgcGx1Z2luIGJhc2VkIG9uIGhpcyA8c3BhbiBjbGFzcz0i
dGFnIj5tZW1fdHdpdHRlcjwvc3Bhbj4gcGx1Z2luLiAgQWRkaXRpb25hbCB0aGFua3MgdG8g
dGhlIGdyZWF0IFRleHRwYXR0ZXJuIGNvbW11bml0eSBmb3IgaGVscGluZyB0byB0ZXN0IHRo
aXMgcGx1Z2luIGFuZCBmb3Igc3VnZ2VzdGluZyBuZXcgZmVhdHVyZXMuIFRoZSBPQXV0aCBw
YXJ0IG9mIHRoZSBwbHVnaW4gaXMgdGhhbmtzIHRvIDxhIGhyZWY9Imh0dHA6Ly90d2l0dGVy
LmNvbS9hYnJhaGFtIj5BYnJhaGFtIFdpbGxpYW1zPC9hPi48L3A+CgoJPGgyIGNsYXNzPSJz
ZWN0aW9uIiBpZD0iYXJjX3R3aXR0ZXJfaW5zdGFsbGF0aW9uIj5JbnN0YWxsYXRpb24gLyBV
bmluc3RhbGxhdGlvbjwvaDI+CgoJPHA+VG8gaW5zdGFsbCBnbyB0byB0aGUgJiM4MjE2O3Bs
dWdpbnMmIzgyMTc7IHRhYiB1bmRlciAmIzgyMTY7YWRtaW4mIzgyMTc7IGFuZCBwYXN0ZSB0
aGUgcGx1Z2luIGNvZGUgaW50byB0aGUgJiM4MjE2O0luc3RhbGwgcGx1Z2luJiM4MjE3OyBi
b3gsICYjODIxNjt1cGxvYWQmIzgyMTc7IGFuZCB0aGVuICYjODIxNjtpbnN0YWxsJiM4MjE3
Oy4gRmluYWxseSBhY3RpdmF0ZSB0aGUgcGx1Z2luLjwvcD4KCgk8cD5CZWZvcmUgeW91IHN0
YXJ0IHVzaW5nIDxzcGFuIGNsYXNzPSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiB5b3Ugd2ls
bCBuZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IHRoZSBjYWNoZSBkaXJlY3RvcnkgaXMgd3JpdGFi
bGUuIFNlZSB0aGUgJiM4MjE2O0NhY2hpbmcmIzgyMTc7IHN1YnNlY3Rpb24gYmVsb3cgZm9y
IGZ1cnRoZXIgaW5mb3JtYXRpb24uPC9wPgoKCTxwPjxzcGFuIGNsYXNzPSJ0YWciPmFyY190
d2l0dGVyPC9zcGFuPiBzaG91bGQgbm93IGJlIHJlYWR5IGZvciB1c2Ugb24gdGhlIHB1Ymxp
Yy1zaWRlIG9mIHlvdXIgc2l0ZS48L3A+CgoJPHA+VG8gdW5sb2NrIHRoZSBhZG1pbiBmZWF0
dXJlcyBvZiB0aGlzIHBsdWdpbiB5b3Ugd2lsbCBuZWVkIHRvIGFzc29jaWF0ZSB5b3VyIHNp
dGUgd2l0aCBhIFR3aXR0ZXIgYWNjb3VudCBieSBjb25uZWN0aW5nIHRvIFR3aXR0ZXIgZnJv
bSB0aGUgcGx1Z2luJiM4MjE3O3Mgb3B0aW9ucyBzY3JlZW4uIENsaWNrIG9uIHRoZSBsaW5r
IHRvIGNvbm5lY3QgdG8gVHdpdHRlciwgeW91IHdpbGwgYmUgYXNrZWQgdG8gbG9naW4gdG8g
VHdpdHRlciwgY2xpY2tpbmcgdGhpcyBsaW5rIHdpbGwgdGVtcG9yYXJpbHkgdGFrZSB5b3Ug
dG8gdGhlIFR3aXR0ZXIgc2l0ZSB3aGVyZSB5b3Ugd2lsbCBiZSBhc2tlZCB0byBsb2dpbiBh
bmQgYXBwcm92ZSBhY2Nlc3MgZm9yIDxzcGFuIGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3
ZWV0IHRvIHJlYWQgYW5kIHdyaXRlIHRvIHlvdXIgVHdpdHRlciBhY2NvdW50LiBJZiBhbGwg
aXMgc3VjY2Vzc2Z1bCB5b3Ugd2lsbCBiZSByZXR1cm5lZCB0byB0aGUgb3B0aW9ucyBzY3Jl
ZW4gYW5kIHlvdXIgdXNlciBuYW1lIHdpbGwgYXBwZWFyLjwvcD4KCgk8cD5BdCBhbnkgdGlt
ZSB5b3UgY2FuIGRpc2Fzc29jaWF0ZSB5b3VyIFR3aXR0ZXIgYWNjb3VudCB3aXRoIDxzcGFu
IGNsYXNzPSJjYXBzIj5UWFA8L3NwYW4+IFR3ZWV0IHZpYSB5b3VyIFR3aXR0ZXIgYWNjb3Vu
dCBwcmVmZXJlbmNlcyBvbiB0aGUgPGEgaHJlZj0iaHR0cDovL3d3dy50d2l0dGVyLmNvbSI+
VHdpdHRlciB3ZWJzaXRlPC9hPi48L3A+CgoJPHA+VG8gdW5pbnN0YWxsIDxzcGFuIGNsYXNz
PSJ0YWciPmFyY190d2l0dGVyPC9zcGFuPiBzaW1wbHkgZGVsZXRlIHRoZSBwbHVnaW4gZnJv
bSB0aGUgJiM4MjE2O1BsdWdpbnMmIzgyMTc7IHRhYi4gIFRoaXMgd2lsbCByZW1vdmUgdGhl
IHBsdWdpbiBjb2RlLCBkZWxldGUgcmVsYXRlZCBwcmVmZXJlbmNlcyBhbmQgZHJvcCB0aGUg
PHNwYW4gY2xhc3M9InRhZyI+YXJjX3R3aXR0ZXI8L3NwYW4+IHRhYmxlIGZyb20geW91ciBU
ZXh0cGF0dGVybiBkYXRhYmFzZS48L3A+CgoJPGgyIGNsYXNzPSJzZWN0aW9uIiBpZD0iYXJj
X3R3aXR0ZXJfdGFnIj5UaGUgYXJjX3R3aXR0ZXIgdGFnPC9oMj4KCgk8aDM+U3ludGF4PC9o
Mz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyIHVzZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZx
dW90OyAvJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0
aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVs
dDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVzZXI8
L3RkPgoJCQk8dGQ+VHdpdHRlciB1c2VyIG5hbWU8L3RkPgoJCQk8dGQ+IDxlbT5hcmNfdHdp
dHRlciB1c2VybmFtZTwvZW0+PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXluaW5q
YSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5saW1pdDwvdGQ+CgkJCTx0ZD5N
YXhpbXVtIG51bWJlciBvZiB0d2VldHMgdG8gZGlzcGxheSAobWF4LiAyMDApPC90ZD4KCQkJ
PHRkPjEwPC90ZD4KCQkJPHRkPmxpbWl0PSZxdW90OzI1JnF1b3Q7PC90ZD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmRhdGVmb3JtYXQ8L3RkPgoJCQk8dGQ+Rm9ybWF0IHRoYXQgdXBkYXRl
IGRhdGVzIHdpbGwgYXBwZWFyIGFzPC90ZD4KCQkJPHRkPiA8ZW0+QXJjaGl2ZSBkYXRlIGZv
cm1hdDwvZW0+PC90ZD4KCQkJPHRkPmRhdGVmb3JtYXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAl
cCZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbDwvdGQ+CgkJCTx0ZD5M
YWJlbCBmb3IgdGhlIHRvcCBvZiB0aGUgbGlzdDwvdGQ+CgkJCTx0ZD4gPGVtPm5vIGxhYmVs
PC9lbT48L3RkPgoJCQk8dGQ+bGFiZWw9JnF1b3Q7TXkgVHdpdHRlciB0aW1lbGluZSZxdW90
OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbHRhZzwvdGQ+CgkJCTx0ZD5JbmRl
cGVuZGVudCB3cmFwdGFnIGZvciBsYWJlbDwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48
L3RkPgoJCQk8dGQ+bGFiZWx0YWc9JnF1b3Q7aDMmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRy
PgoJCQk8dGQ+YnJlYWs8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNs
YXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnICh3aXRob3V0IGJyYWNrZXRzKSwg
b3Igc3RyaW5nLCB1c2VkIHRvIHNlcGFyYXRlIHRoZSB1cGRhdGVzPC90ZD4KCQkJPHRkPmxp
PC90ZD4KCQkJPHRkPmJyZWFrPSZxdW90O2JyJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4K
CQkJPHRkPndyYXB0YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNs
YXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVzZWQgYXMgdGhlIHdy
YXB0YWcsIHdpdGhvdXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90
ZD4KCQkJPHRkPndyYXB0YWc9JnF1b3Q7dWwmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJ
CQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNz
PSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgZm9yIHdyYXB0YWc8
L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXI8L3RkPgoJCQk8dGQ+Y2xhc3M9JnF1b3Q7dHdpdHRl
ciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzc19wb3N0ZWQ8L3RkPgoJ
CQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+
PC9zcGFuPiBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byBzcGFuIHRhZyBhcm91bmQgcG9z
dGVkIGRhdGU8L3RkPgoJCQk8dGQ+YXJjX3R3aXR0ZXItcG9zdGVkPC90ZD4KCQk8L3RyPgoJ
PC90YWJsZT4KCgk8aDM+RXhhbXBsZSB1c2FnZTwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdp
dHRlciB1c2VyPSZxdW90O2RybW9ua2V5bmluamEmcXVvdDsgbGltaXQ9JnF1b3Q7NSZxdW90
OyB3cmFwdGFnPSZxdW90O3VsJnF1b3Q7IGJyZWFrPSZxdW90O2xpJnF1b3Q7IGRhdGVmb3Jt
YXQ9JnF1b3Q7JWIgJU9lLCAlSTolTSAlcCZxdW90OyAvJmd0OzwvcD4KCgk8cD5Qcm9kdWNl
cyBhIGJ1bGxldCBwb2ludCBsaXN0IG9mIHRoZSBsYXN0IDUgVHdpdHRlciB1cGRhdGVzIGZy
b20gZHJtb25rZXluaW5qYSYjODIxNztzIFR3aXR0ZXIgZmVlZCB3aXRoIGEgZGVmaW5lZCBk
YXRlIGZvcm1hdCB0byBvdmVycmlkZSB0aGUgZGVmYXVsdCBhcmNoaXZlIGRhdGUgZm9ybWF0
LjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9zZWFyY2hfdGFn
Ij5UaGUgYXJjX3R3aXR0ZXJfc2VhcmNoIHRhZzwvaDI+CgoJPGgzPlN5bnRheDwvaDM+CgoJ
PHA+Jmx0O3R4cDphcmNfdHdpdHRlcl9zZWFyY2ggaGFzaHRhZ3M9JnF1b3Q7dHhwJnF1b3Q7
IC8mZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwvaDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0
dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90
aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+c2VhcmNoPC90
ZD4KCQkJPHRkPkNvbW1hIHNlcGFyYXRlZCBsaXN0IG9mIHNlYXJjaCB3b3JkczwvdGQ+CgkJ
CTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+c2VhcmNoPSZxdW90O3R4cCx0ZXh0
cGF0dGVybiZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5oYXNodGFnczwvdGQ+
CgkJCTx0ZD5Db21tYSBzZXBhcmF0ZWQgbGlzdCBvZiBoYXNodGFncyB0byBzZWFyY2ggZm9y
IChub3QgaW5jbHVkaW5nIHRoZSBoYXNoKTwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48
L3RkPgoJCQk8dGQ+aGFzaHRhZ3M9JnF1b3Q7dHhwLHRleHRwYXR0ZXJuJnF1b3Q7PC90ZD4K
CQk8L3RyPgoJCTx0cj4KCQkJPHRkPnJlcGx5PC90ZD4KCQkJPHRkPlVzZXJuYW1lIG9mIHR3
ZWV0cyBpbiByZXBseSB0bzwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8
dGQ+cmVwbHk9JnF1b3Q7dHdpdHRlciZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0
ZD5tZW50aW9uPC90ZD4KCQkJPHRkPlVzZXJuYW1lIG9mIHVzZXIgbWVudGlvbmVkIGluIHR3
ZWV0cyAoPGk+aS5lLjwvaT4gdHdlZXRzIGNvbnRhaW5pbmcgQHVzZXJuYW1lKTwvdGQ+CgkJ
CTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCQk8dGQ+bWVudGlvbj0mcXVvdDt0d2l0dGVy
JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxpbWl0PC90ZD4KCQkJPHRkPk1h
eGltdW0gbnVtYmVyIG9mIHR3ZWV0cyB0byBkaXNwbGF5IChtYXguIDIwMCk8L3RkPgoJCQk8
dGQ+MTA8L3RkPgoJCQk8dGQ+bGltaXQ9JnF1b3Q7MjUmcXVvdDs8L3RkPgoJCTwvdHI+CgkJ
PHRyPgoJCQk8dGQ+ZGF0ZWZvcm1hdDwvdGQ+CgkJCTx0ZD5Gb3JtYXQgdGhhdCB1cGRhdGUg
ZGF0ZXMgd2lsbCBhcHBlYXIgYXM8L3RkPgoJCQk8dGQ+IDxlbT5BcmNoaXZlIGRhdGUgZm9y
bWF0PC9lbT48L3RkPgoJCQk8dGQ+ZGF0ZWZvcm1hdD0mcXVvdDslYiAlT2UsICVJOiVNICVw
JnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmxhYmVsPC90ZD4KCQkJPHRkPkxh
YmVsIGZvciB0aGUgdG9wIG9mIHRoZSBsaXN0PC90ZD4KCQkJPHRkPiA8ZW0+bm8gbGFiZWw8
L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5sYWJlbHRhZzwvdGQ+CgkJCTx0ZD5J
bmRlcGVuZGVudCB3cmFwdGFnIGZvciBsYWJlbDwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9l
bT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+YnJlYWs8L3RkPgoJCQk8dGQ+PHNwYW4g
Y2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFn
ICh3aXRob3V0IGJyYWNrZXRzKSwgb3Igc3RyaW5nLCB1c2VkIHRvIHNlcGFyYXRlIHRoZSB1
cGRhdGVzPC90ZD4KCQkJPHRkPmxpPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPndyYXB0
YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5I
VE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVzZWQgYXMgdGhlIHdyYXB0YWcsIHdpdGhv
dXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48c3Bh
biBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGZvciB3
cmFwdGFnPC90ZD4KCQkJPHRkPmFyY190d2l0dGVyX3NlYXJjaDwvdGQ+CgkJPC90cj4KCQk8
dHI+CgkJCTx0ZD5jbGFzc191c2VyPC90ZD4KCQkJPHRkPjxzcGFuIGNsYXNzPSJjYXBzIj48
c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bhbj4gY2xhc3MgYXR0cmlidXRlIGFw
cGxpZWQgdG8gc3BhbiB0YWcgYXJvdW5kIHVzZXIgbmFtZTwvdGQ+CgkJCTx0ZD5hcmNfdHdp
dHRlci11c2VyPC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzX3Bvc3RlZDwvdGQ+
CgkJCTx0ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bh
bj48L3NwYW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHNwYW4gdGFnIGFyb3VuZCBw
b3N0ZWQgZGF0ZTwvdGQ+CgkJCTx0ZD5hcmNfdHdpdHRlci1wb3N0ZWQ8L3RkPgoJCTwvdHI+
Cgk8L3RhYmxlPgoKCTxoMz5FeGFtcGxlIHVzYWdlPC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190
d2l0dGVyX3NlYXJjaCBzZWFyY2g9JnF1b3Q7cGx1Z2luJnF1b3Q7IGhhc2h0YWdzPSZxdW90
O3R4cCx0ZXh0cGF0dGVybiZxdW90OyBsaW1pdD0mcXVvdDsyNSZxdW90OyAvJmd0OzwvcD4K
Cgk8cD5Qcm9kdWNlcyBhIGxpc3Qgb2YgdHdlZXRzIGNvbnRhaW5pbmcgdGhlIHdvcmQgJiM4
MjE2O3BsdWdpbiYjODIxNzsgYW5kIHRoZSBoYXNodGFncyAmIzgyMTY7I3R4cCYjODIxNzsg
YW5kICYjODIxNjsjdGV4dHBhdHRlcm4mIzgyMTc7LiBUaGUgdGFnIHdpbGwgcmV0dXJuIGEg
bWF4aW11bSBvZiAyNSB0d2VldHMuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9ImFy
Y190d2l0dGVyX3JldHdlZXRfdGFnIj5UaGUgYXJjX3R3aXR0ZXJfcmV0d2VldCB0YWc8L2gy
PgoKCTxoMz5TeW50YXg8L2gzPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfcmV0d2VldCAv
Jmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRy
aWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+
CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnVzZXI8L3RkPgoJ
CQk8dGQ+VHdpdHRlciB1c2VyIG5hbWUgdG8gcXVvdGU8L3RkPgoJCQk8dGQ+IDxlbT5hcmNf
dHdpdHRlciB1c2VybmFtZTwvZW0+PC90ZD4KCQkJPHRkPnVzZXI9JnF1b3Q7ZHJtb25rZXlu
aW5qYSZxdW90OzwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD51cmw8L3RkPgoJCQk8dGQ+
PHNwYW4gY2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+PC9zcGFu
PiB0byByZXR3ZWV0PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnRleHQ8L3RkPgoJCQk8
dGQ+UmV0d2VldCB0ZXh0PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmZvbGxvdzE8L3Rk
PgoJCQk8dGQ+U3VnZ2VzdGVkIFR3aXR0ZXIgYWNjb3VudCB0byBmb2xsb3csIGZvciBleGFt
cGxlIHlvdXIgb3duPC90ZD4KCQkJPHRkPkEgVHdpdHRlciB1c2VyIHRvIHJlY29tbWVuZDwv
dGQ+CgkJCTx0ZD5mb2xsb3cxPSZxdW90O1RleHRwYXR0ZXJuJnF1b3Q7PC90ZD4KCQk8L3Ry
PgoJCTx0cj4KCQkJPHRkPmZvbGxvdzI8L3RkPgoJCQk8dGQ+QXMgZm9sbG93MTwvdGQ+CgkJ
CTx0ZD4gPGVtPnVuc2V0PC9lbT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+bGFuZzwv
dGQ+CgkJCTx0ZD5MYW5ndWFnZTwvdGQ+CgkJCTx0ZD5lbjwvdGQ+CgkJCTx0ZD5sYW5nPSZx
dW90O2VzJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNvdW50PC90ZD4KCQkJ
PHRkPkNvdW50IGJveCBwb3NpdGlvbiwgb3B0aW9uczogbm9uZSwgaG9yaXpvbnRhbCBvciB2
ZXJ0aWNhbDwvdGQ+CgkJCTx0ZD5ob3Jpem9udGFsPC90ZD4KCQkJPHRkPmNvdW50PSZxdW90
O25vbmUmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+aW5jbHVkZV9qczwvdGQ+
CgkJCTx0ZD5XaGV0aGVyIG9yIG5vdCB0byBpbmNsdWRlIHRoZSBKYXZhU2NyaXB0PC90ZD4K
CQkJPHRkPjE8L3RkPgoJCQk8dGQ+aW5jbHVkZV9qcz0mcXVvdDswJnF1b3Q7PC90ZD4KCQk8
L3RyPgoJCTx0cj4KCQkJPHRkPndyYXB0YWc8L3RkPgoJCQk8dGQ+PHNwYW4gY2xhc3M9ImNh
cHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5IVE1MPC9zcGFuPjwvc3Bhbj4gdGFnIHRvIGJlIHVz
ZWQgYXMgdGhlIHdyYXB0YWcsIHdpdGhvdXQgYnJhY2tldHM8L3RkPgoJCQk8dGQ+IDxlbT51
bnNldDwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPmNsYXNzPC90ZD4KCQkJPHRk
PjxzcGFuIGNsYXNzPSJjYXBzIj48c3BhbiBjbGFzcz0iY2FwcyI+Q1NTPC9zcGFuPjwvc3Bh
bj4gY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQgdG8gdGhlIHJldHdlZXQgYnV0dG9uPC90ZD4K
CQkJPHRkPnR3aXR0ZXItc2hhcmUtYnV0dG9uPC90ZD4KCQk8L3RyPgoJPC90YWJsZT4KCgk8
aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl90d2VldF91cmwiPmFyY190d2l0
dGVyX3R3ZWV0X3VybDwvaDI+CgoJPHA+UmV0dXJucyB0aGUgPHNwYW4gY2xhc3M9ImNhcHMi
PlVSTDwvc3Bhbj4gb2YgdGhlIFR3aXR0ZXIgc3RhdHVzIGZvciBhbiBhcnRpY2xlLjwvcD4K
Cgk8aDM+U3ludGF4PC9oMz4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyX3R3ZWV0X3VybCAv
Jmd0OzwvcD4KCgk8cD4mbHQ7dHhwOmFyY190d2l0dGVyX3R3ZWV0X3VybCZndDtMaW5rIHRl
eHQmbHQ7L3R4cDphcmNfdHdpdHRlcl90d2VldF91cmwmZ3Q7PC9wPgoKCTxoMz5Vc2FnZTwv
aDM+CgoJPHRhYmxlPgoJCTx0cj4KCQkJPHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNj
cmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZhdWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJ
CTwvdHI+CgkJPHRyPgoJCQk8dGQ+aWQ8L3RkPgoJCQk8dGQ+VGV4dHBhdHRlcm4gYXJ0aWNs
ZSBJRDwvdGQ+CgkJCTx0ZD4gPGVtPmN1cnJlbnQgYXJ0aWNsZTwvZW0+PC90ZD4KCQkJPHRk
PmlkPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+dGl0bGU8L3Rk
PgoJCQk8dGQ+VGl0bGUgYXR0cmlidXRlIG9mIHRoZSBsaW5rPC90ZD4KCQkJPHRkPiA8ZW0+
dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCQk8dHI+CgkJCTx0ZD5jbGFzczwvdGQ+CgkJCTx0
ZD48c3BhbiBjbGFzcz0iY2FwcyI+PHNwYW4gY2xhc3M9ImNhcHMiPkNTUzwvc3Bhbj48L3Nw
YW4+IGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHRoZSBsaW5rPC90ZD4KCQkJPHRkPiA8
ZW0+dW5zZXQ8L2VtPjwvdGQ+CgkJPC90cj4KCTwvdGFibGU+CgoJPGgyIGNsYXNzPSJzZWN0
aW9uIiBpZD0iYXJjX3R3aXR0ZXJfdGlueXVybCI+YXJjX3R3aXR0ZXJfdGlueXVybDwvaDI+
CgoJPHA+UmV0dXJucyB0aGUgc2hvcnRlbmVkIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3Nw
YW4+IG9mIHRoZSBhcnRpY2xlIHVzZWQgZm9yIHRoZSBUd2l0dGVyIHVwZGF0ZS48L3A+CgoJ
PGgzPlN5bnRheDwvaDM+CgoJPHA+Jmx0O3R4cDphcmNfdHdpdHRlcl90aW55dXJsIC8mZ3Q7
PC9wPgoKCTxwPiZsdDt0eHA6YXJjX3R3aXR0ZXJfdGlueXVybCZndDtMaW5rIHRleHQmbHQ7
L3R4cDphcmNfdHdpdHRlcl90aW55dXJsJmd0OzwvcD4KCgk8aDM+VXNhZ2U8L2gzPgoKCTx0
YWJsZT4KCQk8dHI+CgkJCTx0aD5BdHRyaWJ1dGU8L3RoPgoJCQk8dGg+RGVzY3JpcHRpb248
L3RoPgoJCQk8dGg+RGVmYXVsdDwvdGg+CgkJCTx0aD5FeGFtcGxlPC90aD4KCQk8L3RyPgoJ
CTx0cj4KCQkJPHRkPmlkPC90ZD4KCQkJPHRkPlRleHRwYXR0ZXJuIGFydGljbGUgSUQ8L3Rk
PgoJCQk8dGQ+IDxlbT5jdXJyZW50IGFydGljbGU8L2VtPjwvdGQ+CgkJCTx0ZD5pZD0mcXVv
dDsxJnF1b3Q7PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJPHRkPnRpdGxlPC90ZD4KCQkJPHRk
PlRpdGxlIGF0dHJpYnV0ZSBvZiB0aGUgbGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0PC9l
bT48L3RkPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2xhc3M8L3RkPgoJCQk8dGQ+PHNwYW4g
Y2xhc3M9ImNhcHMiPjxzcGFuIGNsYXNzPSJjYXBzIj5DU1M8L3NwYW4+PC9zcGFuPiBjbGFz
cyBhdHRyaWJ1dGUgYXBwbGllZCB0byB0aGUgbGluazwvdGQ+CgkJCTx0ZD4gPGVtPnVuc2V0
PC9lbT48L3RkPgoJCTwvdHI+Cgk8L3RhYmxlPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiIgaWQ9
ImFyY190d2l0dGVyX2NhY2hpbmciPkNhY2hpbmc8L2gyPgoKCTxwPkluIG9yZGVyIHRvIHBy
ZXZlbnQgZXhjZXNzaXZlIHJlcGVhdGl0aXZlIGNhbGxzIHRvIHRoZSBUd2l0dGVyIHdlYnNp
dGUgaXQgaXMgcmVjb21tZW5kZWQgdG8gY2FjaGUgcmVzdWx0cy4gVHdpdHRlciBsaW1pdHMg
dGhlIG51bWJlciBvZiBjYWxscyB0aHJvdWdoIHRoZSA8c3BhbiBjbGFzcz0iY2FwcyI+QVBJ
PC9zcGFuPiwgYW5kIGNvbnRpbnVvdXMgY2FsbHMgd2lsbCByZXN1bHQgaW4gVHdpdHRlciBj
bG9zaW5nIHRvIGZ1cnRoZXIgcmVxdWVzdHMuIEJ5IGRlZmF1bHQsIGFyY190d2l0dGVyIGNh
Y2hlcyBmb3IgMzAgbWludXRlIGludGVydmFscy48L3A+CgoJPHRhYmxlPgoJCTx0cj4KCQkJ
PHRoPkF0dHJpYnV0ZTwvdGg+CgkJCTx0aD5EZXNjcmlwdGlvbjwvdGg+CgkJCTx0aD5EZWZh
dWx0PC90aD4KCQkJPHRoPkV4YW1wbGU8L3RoPgoJCTwvdHI+CgkJPHRyPgoJCQk8dGQ+Y2Fj
aGluZzwvdGQ+CgkJCTx0ZD4mIzgyMTY7MSYjODIxNzsgdG8gY2FjaGUgZmVlZCwgJiM4MjE2
OzAmIzgyMTc7IHRvIHR1cm4gY2FjaGluZyBvZmYgKG5vdCByZWNvbW1lbmRlZCk8L3RkPgoJ
CQk8dGQ+MTwvdGQ+CgkJCTx0ZD5jYWNoaW5nPSZxdW90OzEmcXVvdDs8L3RkPgoJCTwvdHI+
CgkJPHRyPgoJCQk8dGQ+Y2FjaGVfZGlyPC90ZD4KCQkJPHRkPkFic29sdXRlIHBhdGggdG8g
dGhlIGNhY2hlIGRpcmVjdG9yeSAobXVzdCBiZSB3cml0YWJsZSk8L3RkPgoJCQk8dGQ+IDxl
bT5hcmNfdHdpdHRlciBwcmVmZXJlbmNlczwvZW0+PC90ZD4KCQk8L3RyPgoJCTx0cj4KCQkJ
PHRkPmNhY2hlX3RpbWU8L3RkPgoJCQk8dGQ+VGltZSBpbiBtaW51dGVzIHRoYXQgdGhlIGNh
Y2hlIGZpbGVzIGFyZSBzdG9yZWQgYmVmb3JlIGJlaW5nIHJlZnJlc2hlZDwvdGQ+CgkJCTx0
ZD41PC90ZD4KCQkJPHRkPmNhY2hlX3RpbWU9JnF1b3Q7MzAmcXVvdDs8L3RkPgoJCTwvdHI+
Cgk8L3RhYmxlPgoKCTxwPlRoZSBhZG1pbiBzaWRlIG9mIHRoaXMgcGx1Z2luIGVuZm9yY2Vz
IGNhY2hpbmcsIGFwYXJ0IGZyb20gd2hlbiBpdCBpcyBwb3N0aW5nIHRvIFR3aXR0ZXIgKDxp
PmUuZy48L2k+IHdoZW4gcG9zdGluZyBvciBkZWxldGluZyBhbiB1cGRhdGUpLjwvcD4KCgk8
aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9wcmVmcyI+UHJlZmVyZW5jZXM8
L2gyPgoKCTxwPllvdSBjYW4gYWNjZXNzIHRoZSBwbHVnaW5zIGNvcmUgcHJlZmVyZW5jZXMg
ZnJvbSBlaXRoZXIgdGhlIFByZWZlcmVuY2VzIG9yIFBsdWdpbnMgdGFicyBpbiBhZG1pbi4g
U2V0dXAgeW91ciBUd2l0dGVyIGFjY291bnQgKHlvdSB3aWxsIGJlIGFza2VkIHRvIGNvbm5l
Y3QgdmlhIFR3aXR0ZXIgYW5kIHRoaXMgbmVlZHMgZG9pbmcgYmVmb3JlIHlvdSBjYW4gdXNl
IHRoZSBwbHVnaW4pIGFuZCBjaGFuZ2UgdGhlIGNhY2hlIGRpcmVjdG9yeSB1c2luZyBhcmNf
dHdpdHRlciYjODIxNztzIHByZWZlcmVuY2VzLiBXaXRob3V0IHByb3ZpZGluZyB5b3VyIGFj
Y291bnQgbG9naW4gZGV0YWlscyB0aGUgYWRtaW4gYXJlYSBmZWF0dXJlcyBvZiB0aGlzIHBs
dWdpbiB3aWxsIGJlIGluYWN0aXZlLjwvcD4KCgk8cD5Zb3UgY2FuIHNlbGVjdCB0aGUgPHNw
YW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj4gc2hvcnRlbmVyIG1ldGhvZCB5b3Ugd2FudCB0
byB1c2UgdG8gbGluayBiYWNrIHRvIHlvdXIgYXJ0aWNsZSBvbiBUd2l0dGVyLiBQbGVhc2Ug
bm90ZSB0aGF0IGlmIHlvdSBzZWxlY3Qgc21kX3Nob3J0X3VybCB5b3Ugd2lsbCBuZWVkIHRv
IGhhdmUgaW5zdGFsbGVkIGFuZCBhY3RpdmF0ZWQgdGhlIDxhIGhyZWY9Imh0dHA6Ly90ZXh0
cGF0dGVybi5vcmcvcGx1Z2lucy8xMDk5L3NtZF9zaG9ydF91cmwiPjxzcGFuIGNsYXNzPSJ0
YWciPnNtZF9zaG9ydF91cmw8L3NwYW4+IHBsdWdpbjwvYT4gZGV2ZWxvcGVkIGJ5IFN0ZWYg
RGF3c29uLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRlcl9hcnRp
Y2xlIj5Ud2VldGluZyBhcnRpY2xlczwvaDI+CgoJPHA+QnkgZGVmYXVsdCBhcmNfdHdpdHRl
ciB3aWxsIHBvc3QgYW4gdXBkYXRlIHRvIFR3aXR0ZXIgaW5jbHVkaW5nIGEgc2hvcnRlbmVk
IDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+IHRvIHlvdXIgYXJ0aWNsZS4gT25seSBs
aXZlIGFuZCBhY3RpdmUgYXJ0aWNsZXMgd2lsbCBiZSBzZW50IHRvIFR3aXR0ZXIsIDxpPmku
ZS48L2k+IGFydGljbGVzIHBvc3RlZCBpbiB0aGUgZnV0dXJlIG9yIGFzIHN0aWNreSBhcnRp
Y2xlcyB3aWxsIG5vdCBiZSBzZW50LiBJZiB5b3VyIGFydGljbGUgaXMgc3VjY2Vzc2Z1bGx5
IHN1Ym1pdHRlZCB0byBUd2l0dGVyIHRoZSB1cGRhdGUgd2lsbCBhcHBlYXIgaW4gcGxhY2Ug
b2YgdGhlIFR3aXR0ZXIgb3B0aW9uIG9uIHRoZSByaWdodC1oYW5kLXNpZGUgb2YgdGhlIGFy
dGljbGUgZWRpdCBzY3JlZW4uPC9wPgoKCTxwPlR3ZWV0cyBhcmUgc2VudCBpbiB0aGUgZm9s
bG93aW5nIGZvcm1hdDogPGVtPlR3ZWV0IHByZWZpeDwvZW0+IDxlbT5BcnRpY2xlIHRpdGxl
PC9lbT4gPGVtPlNob3J0ZW5lZCA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPjwvZW0+
IDxlbT5Ud2VldCBzdWZmaXg8L2VtPi4gWW91IGNhbiBjaGFuZ2UgdGhlIHByZWZpeCBhbmQg
c3VmZml4IG9uIGFuIGFydGljbGUtYnktYXJ0aWNsZSBiYXNpcyBieSBjaGFuZ2luZyB0aGUg
dHdlZXQgb3B0aW9ucyB1bmRlciAmIzgyMTY7VXBkYXRlIFR3aXR0ZXImIzgyMTc7IG9uIHRo
ZSBhcnRpY2xlIGVkaXRvciBzY3JlZW4uIFRoZSBkZWZhdWx0IDxlbT5Ud2VldCBwcmVmaXg8
L2VtPiBjYW4gYmUgc2V0IHVuZGVyIHRoZSA8c3BhbiBjbGFzcz0idGFnIj5hcmNfdHdpdHRl
cjwvc3Bhbj4gcHJlZmVyZW5jZXMgc2NyZWVuICh0aGUgZGVmYXVsdCBvbiBpbnN0YWxsYXRp
b24gaXMgJiM4MjIwO0p1c3QgcG9zdGVkOiYjODIyMTspLjwvcD4KCgk8cD5QbGVhc2Ugbm90
ZSB0aGF0IG9uY2UgYW4gYXJ0aWNsZSBoYXMgYmVlbiB0d2VldGVkIHRoZSB0d2VldCBjYW5u
b3QgYmUgZWRpdGVkLjwvcD4KCgk8aDIgY2xhc3M9InNlY3Rpb24iIGlkPSJhcmNfdHdpdHRl
cl9hZG1pbiI+VGhlIFR3aXR0ZXIgdGFiPC9oMj4KCgk8cD5VbmRlciB0aGUgRXh0ZW5zaW9u
cyB0YWIgKHRoaXMgY2FuIGJlIGNoYW5nZWQgZnJvbSB0aGUgcGx1Z2luJiM4MjE3O3MgcHJl
ZmVyZW5jZSBwYWdlKSBhIG5ldyBUd2l0dGVyIHRhYiBzaG91bGQgYXBwZWFyIG9uY2UgeW91
IGhhdmUgY29ubmVjdGVkIHlvdXIgc2l0ZSB0byB5b3VyIFR3aXR0ZXIgYWNjb3VudC4gRnJv
bSBoZXJlIHlvdSB3aWxsIGJlIGFibGUgdG8gc3VibWl0IG5ldyBUd2l0dGVyIHVwZGF0ZXMs
IHZpZXcgYmFzaWMgYWNjb3VudCBzdGF0aXN0aWNzLCBhbmQgY2hlY2sgb3V0IHlvdXIgcmVj
ZW50IHVwZGF0ZXMgKGluY2x1ZGluZyB0aGUgb3B0aW9uIHRvIGRlbGV0ZSB5b3VyIHR3ZWV0
cykuPC9wPiI7czo0OiJjb2RlIjtzOjczODQ0OiJnbG9iYWwgJHByZWZzLCR0eHBjZmcsJGFy
Y190d2l0dGVyX2NvbnN1bWVyS2V5LCRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldDsKCiRh
cmNfdHdpdHRlciA9IGFycmF5KCk7CgokYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkgPSAnbktj
WHNsd3paaEJkMGtmS01ldG5QQSc7CiRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCA9ICdD
Nm5TUENMM2VlSEdUQmhLQ2d3ZDlvY2xjdUQwc3JCOFdWa2ZYUVlDNTQnOwoKYWRkX3ByaXZz
KCdwbHVnaW5fcHJlZnMuYXJjX3R3aXR0ZXInLCcxLDInKTsKcmVnaXN0ZXJfY2FsbGJhY2so
J2FyY190d2l0dGVyX2luc3RhbGwnLCdwbHVnaW5fbGlmZWN5Y2xlLmFyY190d2l0dGVyJywg
J2luc3RhbGxlZCcpOwpyZWdpc3Rlcl9jYWxsYmFjaygnYXJjX3R3aXR0ZXJfdW5pbnN0YWxs
JywncGx1Z2luX2xpZmVjeWNsZS5hcmNfdHdpdHRlcicsICdkZWxldGVkJyk7CnJlZ2lzdGVy
X2NhbGxiYWNrKCdhcmNfdHdpdHRlcl9wcmVmcycsJ3BsdWdpbl9wcmVmcy5hcmNfdHdpdHRl
cicpOwoKLyoKICogU2V0dXAgaW5pdGlhbCBwcmVmZXJlbmNlcyBpZiBub3QgaW4gdGhlIHR4
cF9wcmVmcyB0YWJsZS4KICovCmlmICghaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl91c2Vy
J10pKQogICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3VzZXInLCAnJywgJ2FyY190d2l0dGVy
JywgMSwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX3By
ZWZpeCddKSkKICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfcHJlZml4JywnSnVzdCBwb3N0ZWQ6
JywgJ2FyY190d2l0dGVyJywgMiwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3NldCgkcHJlZnNb
J2FyY190d2l0dGVyX2NhY2hlX2RpciddKSkKICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfY2Fj
aGVfZGlyJywkdHhwY2ZnWyd0eHBhdGgnXS4kcHJlZnNbJ3RlbXBkaXInXSwgJ2FyY190d2l0
dGVyJywgMSwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVy
X3R3ZWV0X2RlZmF1bHQnXSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1
bHQnLCAxLCAnYXJjX3R3aXR0ZXInLCAyLCAneWVzbm9SYWRpbycpOwppZiAoIWlzc2V0KCRw
cmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddKSkKICBzZXRfcHJlZignYXJjX3R3aXR0
ZXJfdXJsX21ldGhvZCcsICd0aW55dXJsJywgJ2FyY190d2l0dGVyJywgMiwKICAgICdhcmNf
dHdpdHRlcl91cmxfbWV0aG9kX3NlbGVjdCcpOwppZiAoIWlzc2V0KCRwcmVmc1snYXJjX3No
b3J0X3VybCddKSkKICBzZXRfcHJlZignYXJjX3Nob3J0X3VybCcsIDAsICdhcmNfdHdpdHRl
cicsIDIsICd5ZXNub1JhZGlvJyk7CmlmICghaXNzZXQoJHByZWZzWydhcmNfc2hvcnRfc2l0
ZV91cmwnXSkpCiAgc2V0X3ByZWYoJ2FyY19zaG9ydF9zaXRlX3VybCcsICRwcmVmc1snc2l0
ZXVybCddLCAnYXJjX3R3aXR0ZXInLCAyLCAndGV4dF9pbnB1dCcpOwovLyBNYWtlIHN1cmUg
dGhhdCB0aGUgVHdpdHRlciB0YWIgaGFzIGJlZW4gZGVmaW5lZAppZiAoIWlzc2V0KCRwcmVm
c1snYXJjX3R3aXR0ZXJfdGFiJ10pKSB7CiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3RhYics
ICdleHRlbnNpb25zJywgJ2FyY190d2l0dGVyJywgMiwKICAgICdhcmNfdHdpdHRlcl90YWJf
c2VsZWN0Jyk7CiAgICAkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddID0gJ2V4dGVuc2lvbnMn
Owp9CgovLyBDaGVjayBpZiBhcmNfc2hvcnRfdXJsIGlzIGVuYWJsZWQKaWYgKCRwcmVmc1sn
YXJjX3Nob3J0X3VybCddIHx8ICRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddPT0n
YXJjX3R3aXR0ZXInKSB7CiAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19zaG9ydF91cmxfcmVk
aXJlY3QnLCAndHhwX2RpZScsIDQwNCk7Cn0KCmlmIChAdHhwaW50ZXJmYWNlID09ICdhZG1p
bicpIHsKICAgIGlmICghZW1wdHkoJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10pCiAgICAg
ICAgJiYgIWVtcHR5KCRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXSkKICAgICAg
ICAmJiAhZW1wdHkoJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKSAp
IHsKCiAgICAgICAgaWYgKCRwcmVmc1snYXJjX3R3aXR0ZXJfdGFiJ10pIHsKICAgICAgICAg
ICAgYWRkX3ByaXZzKCdhcmNfYWRtaW5fdHdpdHRlcicsICcxLDIsMyw0Jyk7CiAgICAgICAg
ICAgIHJlZ2lzdGVyX3RhYigkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddLCAnYXJjX2FkbWlu
X3R3aXR0ZXInLCAnVHdpdHRlcicpOwogICAgICAgICAgICByZWdpc3Rlcl9jYWxsYmFjaygn
YXJjX2FkbWluX3R3aXR0ZXInLCAnYXJjX2FkbWluX3R3aXR0ZXInKTsKICAgICAgICB9Cgog
ICAgICAgIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYXJ0aWNsZV90d2VldCcsICdwaW5nJyk7
CiAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hcnRpY2xlX3R3ZWV0JywgJ2FydGlj
bGUnLCAnZWRpdCcsIDEpOwogICAgICAgIHJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfYXBwZW5k
X3R3aXR0ZXInLCAnYXJ0aWNsZV91aScsICdzdGF0dXMnKTsKICAgIH0KfQoKLyoKICAgIFB1
YmxpYy1zaWRlIGZ1bmN0aW9ucwogICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoqLwoKZnVuY3Rpb24gYXJjX3R3
aXR0ZXIoJGF0dHMpCnsKICBnbG9iYWwgJHByZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1lcktl
eSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICBleHRyYWN0KGxBdHRzKGFycmF5
KAogICAgJ3VzZXInICAgICAgPT4gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sCiAgICAn
cGFzc3dvcmQnICA9PiAnJywKICAgICd0aW1lbGluZScgID0+ICd1c2VyJywKICAgICdsaW1p
dCcgICAgID0+ICcxMCcsCiAgICAncmV0d2VldHMnICA9PiBmYWxzZSwKICAgICdkYXRlZm9y
bWF0Jz0+ICRwcmVmc1snYXJjaGl2ZV9kYXRlZm9ybWF0J10sCiAgICAnY2FjaGluZycgICA9
PiAnMScsCiAgICAnY2FjaGVfZGlyJyA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX2NhY2hlX2Rp
ciddLAogICAgJ2NhY2hlX3RpbWUnPT4gJzUnLAogICAgJ2xhYmVsJyAgICAgPT4gJycsCiAg
ICAnbGFiZWx0YWcnICA9PiAnJywKICAgICdicmVhaycgICAgID0+ICdsaScsCiAgICAnd3Jh
cHRhZycgICA9PiAnJywKICAgICdjbGFzcycgICAgID0+IF9fRlVOQ1RJT05fXywKICAgICdj
bGFzc19wb3N0ZWQnID0+IF9fRlVOQ1RJT05fXy4nLXBvc3RlZCcKICAgICksJGF0dHMpKTsK
CiAgJHR3aXQgPSBuZXcgYXJjX1R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAk
YXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQpOwoKICBpZiAoJGNhY2hpbmcpIHsgIC8vIHR1
cm4gb24gY2FjaGluZywgcmVjb21tZW5kZWQgKGRlZmF1bHQpCiAgICAkdHdpdC0+c2V0Q2Fj
aGluZyh0cnVlKTsKICAgICR0d2l0LT5jYWNoZURpcigkY2FjaGVfZGlyKTsKICAgICR0d2l0
LT5jYWNoZVRpbWUoJGNhY2hlX3RpbWUpOwogIH0gZWxzZSB7ICAvLyB0dXJuIG9mZiBjYWNo
aW5nLCBub3QgcmVjb21tZW5kZWQgb3RoZXIgdGhhbiBmb3IgdGVzdGluZwogICAgJHR3aXQt
PnNldENhY2hpbmcoZmFsc2UpOwogIH0KCiAgc3dpdGNoICgkdGltZWxpbmUpIHsKICAgIGNh
c2UgJ2hvbWUnOiBjYXNlICdmcmllbmRzJzoKICAgICAgJHRpbWVsaW5lID0gJ3N0YXR1c2Vz
L2ZyaWVuZHNfdGltZWxpbmUnOyBicmVhazsKICAgIGNhc2UgJ21lbnRpb25zJzoKICAgICAg
JHRpbWVsaW5lID0gJ3N0YXR1c2VzL21lbnRpb25zJzsgYnJlYWs7CiAgICBjYXNlICd1c2Vy
JzogZGVmYXVsdDogJHRpbWVsaW5lID0gJ3N0YXR1c2VzL3VzZXJfdGltZWxpbmUnOwogIH0K
CiAgJG91dCA9IGFycmF5KCk7CiAgJHhtbCA9ICR0d2l0LT5nZXQoJHRpbWVsaW5lCiAgICAs
IGFycmF5KCdzY3JlZW5fbmFtZSc9PiR1c2VyLCdjb3VudCc9PiRsaW1pdCwnaW5jbHVkZV9y
dHMnPT4kcmV0d2VldHMpKTsKICBpZiAoJHhtbCkgewogICAgJHR3ZWV0cyA9IEAkeG1sLT54
cGF0aCgnL3N0YXR1c2VzL3N0YXR1cycpOwogICAgaWYgKCR0d2VldHMpIGZvcmVhY2ggKCR0
d2VldHMgYXMgJHR3ZWV0KSB7CiAgICAgICR0aW1lID0gc3RydG90aW1lKGh0bWxlbnRpdGll
cygkdHdlZXQtPmNyZWF0ZWRfYXQpKTsKICAgICAgJGRhdGUgPSBzYWZlX3N0cmZ0aW1lKCRk
YXRlZm9ybWF0LCR0aW1lKTsKICAgICAgJG91dFtdID0gYXJjX1R3aXR0ZXI6Om1ha2VMaW5r
cyhodG1sZW50aXRpZXMoJHR3ZWV0LT50ZXh0LCBFTlRfUVVPVEVTLCdVVEYtOCcpKQogICAg
ICAgIC4nICcudGFnKGh0bWxlbnRpdGllcygkZGF0ZSksJ3NwYW4nLCcgY2xhc3M9IicuJGNs
YXNzX3Bvc3RlZC4nIicpOwogICAgfQoKICAgIHJldHVybiBkb0xhYmVsKCRsYWJlbCwgJGxh
YmVsdGFnKS5kb1dyYXAoJG91dCwgJHdyYXB0YWcsICRicmVhaywgJGNsYXNzKTsKICB9Cgp9
CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl9zZWFyY2goJGF0dHMpCnsKICAgIGdsb2JhbCAkcHJl
ZnMsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNy
ZXQ7CgogICAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICAgICAndXNlcicgICAgICA9PiAk
cHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSwKICAgICAgICAnc2VhcmNoJyAgICA9PiAnJywK
ICAgICAgICAnaGFzaHRhZ3MnICA9PiAnJywKICAgICAgICAndXNlcicgICAgICA9PiAnJywK
ICAgICAgICAncmVwbHknICAgICA9PiAnJywKICAgICAgICAnbWVudGlvbicgICA9PiAnJywK
ICAgICAgICAnbGltaXQnICAgICA9PiAnMTAnLAogICAgICAgICdsYW5nJyAgICAgID0+ICcn
LAogICAgICAgICdkYXRlZm9ybWF0Jz0+ICRwcmVmc1snYXJjaGl2ZV9kYXRlZm9ybWF0J10s
CiAgICAgICAgJ2NhY2hpbmcnICAgPT4gJzEnLAogICAgICAgICdjYWNoZV9kaXInID0+ICRw
cmVmc1snYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJ10sCiAgICAgICAgJ2NhY2hlX3RpbWUnPT4g
JzUnLAogICAgICAgICdsYWJlbCcgICAgID0+ICcnLAogICAgICAgICdsYWJlbHRhZycgID0+
ICcnLAogICAgICAgICdicmVhaycgICAgID0+ICdsaScsCiAgICAgICAgJ3dyYXB0YWcnICAg
PT4gJycsCiAgICAgICAgJ2NsYXNzJyAgICAgPT4gX19GVU5DVElPTl9fLAogICAgICAgICdj
bGFzc19wb3N0ZWQnID0+IF9fRlVOQ1RJT05fXy4nLXBvc3RlZCcsCiAgICAgICAgJ2NsYXNz
X3VzZXInICAgPT4gX19GVU5DVElPTl9fLictdXNlcicKICAgICksJGF0dHMpKTsKCiAgICAg
ICAgJHR3aXQgPSBuZXcgYXJjX1R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAg
ICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0KTsKCiAgICAgICAgaWYg
KCRjYWNoaW5nKSB7ICAvLyB0dXJuIG9uIGNhY2hpbmcsIHJlY29tbWVuZGVkIChkZWZhdWx0
KQogICAgICAgICAgICAkdHdpdC0+c2V0Q2FjaGluZyh0cnVlKTsKICAgICAgICAgICAgJHR3
aXQtPmNhY2hlRGlyKCRjYWNoZV9kaXIpOwogICAgICAgICAgICAkdHdpdC0+Y2FjaGVUaW1l
KCRjYWNoZV90aW1lKTsKICAgICAgICB9IGVsc2UgeyAgLy8gdHVybiBvZmYgY2FjaGluZywg
bm90IHJlY29tbWVuZGVkIG90aGVyIHRoYW4gZm9yIHRlc3RpbmcKICAgICAgICAgICAgJHR3
aXQtPnNldENhY2hpbmcoZmFsc2UpOwogICAgICAgIH0KCiAgICAgICAgLy8gY29uc3RydWN0
IHNlYXJjaCBxdWVyeQogICAgICAgIGlmICghZW1wdHkoJHNlYXJjaCkpIHsKICAgICAgICAg
ICAgJHRlcm1zID0gZXhwbG9kZSgnLCcsJHNlYXJjaCk7ICR0ZXJtcyA9IGFycmF5X21hcCgn
dHJpbScsJHRlcm1zKTsKICAgICAgICAgICAgJHNlYXJjaCA9IGltcGxvZGUoJyAnLCR0ZXJt
cyk7CiAgICAgICAgfQogICAgICAgIGlmICgkaGFzaHRhZ3MpIHsKICAgICAgICAgICAgJGhh
c2hlcyA9IGV4cGxvZGUoJywnLCRoYXNodGFncyk7ICRoYXNoZXMgPSBhcnJheV9tYXAoJ3Ry
aW0nLCRoYXNoZXMpOwogICAgICAgICAgICAkc2VhcmNoLj0gKCgkc2VhcmNoKT8nICc6Jycp
LicjJy5pbXBsb2RlKCcgIycsJGhhc2hlcyk7CiAgICAgICAgfQogICAgICAgIGlmICgkcmVw
bHkpIHsKICAgICAgICAgICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/JyAnOicnKS4ndG86Jy50
cmltKCRyZXBseSk7CiAgICAgICAgfQogICAgICAgIGlmICgkdXNlcikgewogICAgICAgICAg
ICAkc2VhcmNoLj0gKCgkc2VhcmNoKT8nICc6JycpLidmcm9tOicudHJpbSgkdXNlcik7CiAg
ICAgICAgfQogICAgICAgIGlmICgkbWVudGlvbikgewogICAgICAgICAgICAkc2VhcmNoLj0g
KCgkc2VhcmNoKT8nICc6JycpLidAJy50cmltKCRtZW50aW9uKTsKICAgICAgICB9CgogICAg
ICAgIGlmIChlbXB0eSgkc2VhcmNoKSkgewogICAgICAgICAgICByZXR1cm4gJyc7CiAgICAg
ICAgfSBlbHNlIHsKICAgICAgICAgICAgJHNlYXJjaCA9IHVybGVuY29kZSgkc2VhcmNoKTsK
ICAgICAgICB9CgogICAgICAgICRvdXQgPSBhcnJheSgpOwogICAgICAgICR0d2VldHMgPSAk
dHdpdC0+Z2V0KCdodHRwOi8vc2VhcmNoLnR3aXR0ZXIuY29tL3NlYXJjaC5hdG9tP3E9Jy4k
c2VhcmNoCiAgICAgICAgICAgICwgYXJyYXkoJ3JwcCc9PiRsaW1pdCwnbGFuZyc9PiRsYW5n
KSk7CgogICAgICAgIGlmICgkdHdlZXRzKSB7IGZvcmVhY2ggKCR0d2VldHMtPmVudHJ5IGFz
ICR0d2VldCkgewogICAgICAgICAgICBwcmVnX21hdGNoKCIvKC4qKSBcKCguKilcKS8iLCR0
d2VldC0+YXV0aG9yLT5uYW1lLCRtYXRjaGVzKTsKICAgICAgICAgICAgbGlzdCgkYXV0aG9y
LCR1bmFtZSwkbmFtZSkgPSAkbWF0Y2hlczsKICAgICAgICAgICAgJHRpbWUgPSBzdHJ0b3Rp
bWUoaHRtbGVudGl0aWVzKCR0d2VldC0+cHVibGlzaGVkKSk7CiAgICAgICAgICAgICRkYXRl
ID0gc2FmZV9zdHJmdGltZSgkZGF0ZWZvcm1hdCwkdGltZSk7CiAgICAgICAgICAgICR0ZXh0
ID0gJHR3ZWV0LT50aXRsZTsKICAgICAgICAgICAgJG91dFtdID0gdGFnKGhyZWYoaHRtbGVu
dGl0aWVzKCR1bmFtZSksJHR3ZWV0LT5hdXRob3ItPnVyaSwKICAgICAgICAgICAgICAgICcg
dGl0bGU9IicuaHRtbGVudGl0aWVzKCRuYW1lKS4nIicpLic6ICcsJ3NwYW4nCiAgICAgICAg
ICAgICAgICAgICAgLCcgY2xhc3M9IicuJGNsYXNzX3VzZXIuJyInKQogICAgICAgICAgICAg
ICAgLmFyY19Ud2l0dGVyOjptYWtlTGlua3MoaHRtbGVudGl0aWVzKCR0ZXh0LCBFTlRfUVVP
VEVTLCdVVEYtOCcpKQogICAgICAgICAgICAgICAgLicgJy50YWcoaHRtbGVudGl0aWVzKCRk
YXRlKSwnc3BhbicKICAgICAgICAgICAgICAgICAgICAsJyBjbGFzcz0iJy4kY2xhc3NfcG9z
dGVkLiciJyk7CiAgICAgICAgfSByZXR1cm4gZG9MYWJlbCgkbGFiZWwsICRsYWJlbHRhZykK
ICAgICAgICAgICAgLmRvV3JhcCgkb3V0LCAkd3JhcHRhZywgJGJyZWFrLCAkY2xhc3MpOyB9
Cgp9CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl90d2VldCgkYXR0cykgewogICAgZ2xvYmFsICR0
aGlzYXJ0aWNsZTsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAnaWQnICAgICAg
ICA9PiAkdGhpc2FydGljbGVbJ3RoaXNpZCddLAogICAgICAnaW5jbHVkZV91cmwnICAgPT4g
dHJ1ZQogICAgKSwkYXR0cykpOwoKICAgIGlmICgkaWQpIHsKICAgICAgLy8gRmV0Y2ggYXJj
X3R3aXR0ZXIgc3R1ZmYgdG8gYnVpbGQgdHdlZXQgZnJvbQogICAgICAkdHdlZXQgPSAoJGlu
Y2x1ZGVfdXJsKSA/IHNhZmVfcm93KCJ0d2VldCIsICdhcmNfdHdpdHRlcicsICJhcnRpY2xl
X2lkPXskaWR9IikKICAgICAgICA6IHNhZmVfcm93KCJSRVBMQUNFKHR3ZWV0LENPTkNBVCgn
ICcsdGlueXVybCksJycpIEFTIHR3ZWV0IgogICAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAi
YXJ0aWNsZV9pZD17JGlkfSIpOwogICAgfQoKICAgIGlmICgkdHdlZXRbJ3R3ZWV0J10pIHsK
ICAgICAgcmV0dXJuIGFyY19Ud2l0dGVyOjptYWtlTGlua3MoCiAgICAgICAgaHRtbGVudGl0
aWVzKCR0d2VldFsndHdlZXQnXSwgRU5UX1FVT1RFUywnVVRGLTgnKSk7CiAgICB9Cn0KCmZ1
bmN0aW9uIGFyY190d2l0dGVyX3R3ZWV0X3VybCgkYXR0cywgJHRoaW5nPW51bGwpIHsKICAg
IGdsb2JhbCAkdGhpc2FydGljbGUsJHByZWZzOwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXko
CiAgICAgICdpZCcgICAgICA9PiAkdGhpc2FydGljbGVbJ3RoaXNpZCddLAogICAgICAndGl0
bGUnICAgPT4gJycsCiAgICAgICdjbGFzcycgICA9PiAnJwogICAgKSwkYXR0cykpOwoKICAg
IGlmICgkaWQpIHsKICAgICAgLy8gRmV0Y2ggYXJjX3R3aXR0ZXIgc3R1ZmYgdG8gYnVpbGQg
dHdlZXQgZnJvbQogICAgICAkdHdlZXQgPSBzYWZlX3JvdygidHdlZXRfaWQiCiAgICAgICAg
LCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlkfSIpOwogICAgfQoKICAgIGlmICgk
dHdlZXRbJ3R3ZWV0X2lkJ10pIHsKICAgICAgJHVybCA9ICJodHRwOi8vdHdpdHRlci5jb20v
Ii4kcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXS4iL3N0YXR1cy8iLiR0d2VldFsndHdlZXRf
aWQnXTsKICAgICAgaWYgKCR0aGluZz09PW51bGwpIHsKICAgICAgICByZXR1cm4gJHVybDsK
ICAgICAgfQogICAgICByZXR1cm4gaHJlZihwYXJzZSgkdGhpbmcpLCAkdXJsLAogICAgICAg
ICgkdGl0bGUgPyAnIHRpdGxlPSInLiR0aXRsZS4nIicgOiAnJykKICAgICAgICAuKCRjbGFz
cyA/ICcgY2xhc3M9IicuJGNsYXNzLiciJyA6ICcnKSk7CiAgICB9Cn0KCmZ1bmN0aW9uIGFy
Y190d2l0dGVyX3Rpbnl1cmwoJGF0dHMsICR0aGluZz1udWxsKSB7CiAgICBnbG9iYWwgJHRo
aXNhcnRpY2xlOwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXkoCiAgICAgICdpZCcgICAgICA9
PiAkdGhpc2FydGljbGVbJ3RoaXNpZCddLAogICAgICAndGl0bGUnICAgPT4gJycsCiAgICAg
ICdjbGFzcycgICA9PiAnJwogICAgKSwkYXR0cykpOwoKICAgIGlmICgkaWQpIHsKICAgICAg
Ly8gRmV0Y2ggYXJjX3R3aXR0ZXIgc3R1ZmYgdG8gYnVpbGQgdHdlZXQgZnJvbQogICAgICAk
dHdlZXQgPSBzYWZlX3JvdygidGlueXVybCIKICAgICAgICAsICdhcmNfdHdpdHRlcicsICJh
cnRpY2xlX2lkPXskaWR9Iik7CiAgICB9CgogICAgaWYgKCR0d2VldFsndGlueXVybCddKSB7
CiAgICAgIGlmICgkdGhpbmc9PT1udWxsKSB7CiAgICAgICAgcmV0dXJuICR0d2VldFsndGlu
eXVybCddOwogICAgICB9CgogICAgICByZXR1cm4gaHJlZihwYXJzZSgkdGhpbmcpLCAkdHdl
ZXRbJ3Rpbnl1cmwnXSwKICAgICAgICAoJHRpdGxlID8gJyB0aXRsZT0iJy4kdGl0bGUuJyIn
IDogJycpCiAgICAgICAgLigkY2xhc3MgPyAnIGNsYXNzPSInLiRjbGFzcy4nIicgOiAnJykp
OwogICAgfQp9CgpmdW5jdGlvbiBfYXJjX3R3aXR0ZXJfd2lkZ2V0X2pzKCkgewogICRqcyA9
IDw8PEpTCjxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KKGZ1bmN0aW9uKCkgewog
IGlmICh3aW5kb3cuX190d2l0dGVySW50ZW50SGFuZGxlcikgcmV0dXJuOwogIHZhciBpbnRl
bnRSZWdleCA9IC90d2l0dGVyXC5jb20oXDpcZHsyLDR9KT9cL2ludGVudFwvKFx3KykvLAog
ICAgICB3aW5kb3dPcHRpb25zID0gJ3Njcm9sbGJhcnM9eWVzLHJlc2l6YWJsZT15ZXMsdG9v
bGJhcj1ubyxsb2NhdGlvbj15ZXMnLAogICAgICB3aWR0aCA9IDU1MCwKICAgICAgaGVpZ2h0
ID0gNDIwLAogICAgICB3aW5IZWlnaHQgPSBzY3JlZW4uaGVpZ2h0LAogICAgICB3aW5XaWR0
aCA9IHNjcmVlbi53aWR0aDsKCiAgZnVuY3Rpb24gaGFuZGxlSW50ZW50KGUpIHsKICAgIGUg
PSBlIHx8IHdpbmRvdy5ldmVudDsKICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldCB8fCBlLnNy
Y0VsZW1lbnQsCiAgICAgICAgbSwgbGVmdCwgdG9wOwoKICAgIHdoaWxlICh0YXJnZXQgJiYg
dGFyZ2V0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgIT09ICdhJykgewogICAgICB0YXJnZXQg
PSB0YXJnZXQucGFyZW50Tm9kZTsKICAgIH0KCiAgICBpZiAodGFyZ2V0ICYmIHRhcmdldC5u
b2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnYScgJiYgdGFyZ2V0LmhyZWYpIHsKICAgICAg
bSA9IHRhcmdldC5ocmVmLm1hdGNoKGludGVudFJlZ2V4KTsKICAgICAgaWYgKG0pIHsKICAg
ICAgICBsZWZ0ID0gTWF0aC5yb3VuZCgod2luV2lkdGggLyAyKSAtICh3aWR0aCAvIDIpKTsK
ICAgICAgICB0b3AgPSAwOwoKICAgICAgICBpZiAod2luSGVpZ2h0ID4gaGVpZ2h0KSB7CiAg
ICAgICAgICB0b3AgPSBNYXRoLnJvdW5kKCh3aW5IZWlnaHQgLyAyKSAtIChoZWlnaHQgLyAy
KSk7CiAgICAgICAgfQoKICAgICAgICB3aW5kb3cub3Blbih0YXJnZXQuaHJlZiwgJ2ludGVu
dCcsIHdpbmRvd09wdGlvbnMgKyAnLHdpZHRoPScgKyB3aWR0aCArCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLGhlaWdodD0nICsgaGVpZ2h0ICsgJyxs
ZWZ0PScgKyBsZWZ0ICsgJyx0b3A9JyArIHRvcCk7CiAgICAgICAgZS5yZXR1cm5WYWx1ZSA9
IGZhbHNlOwogICAgICAgIGUucHJldmVudERlZmF1bHQgJiYgZS5wcmV2ZW50RGVmYXVsdCgp
OwogICAgICB9CiAgICB9CiAgfQoKICBpZiAoZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcikg
ewogICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVJbnRlbnQs
IGZhbHNlKTsKICB9IGVsc2UgaWYgKGRvY3VtZW50LmF0dGFjaEV2ZW50KSB7CiAgICBkb2N1
bWVudC5hdHRhY2hFdmVudCgnb25jbGljaycsIGhhbmRsZUludGVudCk7CiAgfQogIHdpbmRv
dy5fX3R3aXR0ZXJJbnRlbnRIYW5kbGVyID0gdHJ1ZTsKfSgpKTsKPC9zY3JpcHQ+CkpTOwog
IHJldHVybiAkanM7Cn0KCmZ1bmN0aW9uIGFyY190d2l0dGVyX2ZvbGxvdygkYXR0cywgJHRo
aW5nPW51bGwpCnsKICAgIGdsb2JhbCAkcHJlZnMsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5
LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgogICAgZXh0cmFjdChsQXR0cyhhcnJh
eSgKICAgICAgICAndXNlcicgICAgICA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSwK
ICAgICAgICAndXNlcl9pZCcgICA9PiAnJywKICAgICAgICAnbGFuZycgICAgICA9PiAnJywK
ICAgICAgICAnaW5jbHVkZV9qcyc9PiB0cnVlLAogICAgICAgICd3cmFwdGFnJyAgID0+ICcn
LAogICAgICAgICdjbGFzcycgICAgID0+ICcnCiAgICApLCRhdHRzKSk7CgogICAgJHEgPSAo
JHVzZXJfaWQpID8gJ3VzZXJfaWQ9Jy4kdXNlcl9pZCA6ICdzY3JlZW5fbmFtZT0nLiR1c2Vy
OwoKICAgIHN3aXRjaCAoJGxhbmcpIHsKICAgICAgY2FzZSAnZnInOiBicmVhazsgY2FzZSAn
aXQnOiBicmVhazsgY2FzZSAnZXMnOiBicmVhazsKICAgICAgY2FzZSAna28nOiBicmVhazsg
Y2FzZSAnanAnOiBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICAkbGFuZyA9ICdlbic7
CiAgICB9CiAgICAkcSAuPSAnJmFtcDtsYW5nPScudXJsZW5jb2RlKCRsYW5nKTsKCiAgICAk
aHRtbCA9IGhyZWYoJHRoaW5nLCdodHRwOi8vdHdpdHRlci5jb20vaW50ZW50L3VzZXI/Jy4k
cQogICAgICAsICcgY2xhc3M9IicuJGNsYXNzLiciJyk7CgogICAgJGpzID0gKCRpbmNsdWRl
X2pzKSA/IF9hcmNfdHdpdHRlcl93aWRnZXRfanMoKSA6ICcnOwoKICAgIHJldHVybiAkanMu
JGh0bWw7Cn0KCmZ1bmN0aW9uIGFyY190d2l0dGVyX3JldHdlZXQoJGF0dHMsICR0aGluZz1u
dWxsKQp7CiAgICBnbG9iYWwgJHByZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwgJGFy
Y190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwogICAgZ2xvYmFsICR0aGlzYXJ0aWNsZTsKCiAg
ICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAgICd1c2VyJyAgICAgID0+ICRwcmVmc1sn
YXJjX3R3aXR0ZXJfdXNlciddLCAvLyB2aWEgdXNlciBhY2NvdW50CiAgICAgICAgJ3VybCcg
ICAgICAgPT4gJycsCiAgICAgICAgJ3RleHQnICAgICAgPT4gJycsCiAgICAgICAgJ2ZvbGxv
dzEnICAgPT4gJycsCiAgICAgICAgJ2ZvbGxvdzInICAgPT4gJycsCiAgICAgICAgJ2xhbmcn
ICAgICAgPT4gJycsCiAgICAgICAgJ2NvdW50JyAgICAgPT4gJ2hvcml6b250YWwnLAogICAg
ICAgICdpbmNsdWRlX2pzJz0+IHRydWUsCiAgICAgICAgJ3dyYXB0YWcnICAgPT4gJycsCiAg
ICAgICAgJ2NsYXNzJyAgICAgPT4gJ3R3aXR0ZXItc2hhcmUtYnV0dG9uJwogICAgKSwkYXR0
cykpOwoKICAgICRxID0gJyc7IC8vIHF1ZXJ5IHN0cmluZwoKICAgIGlmICgkaWQ9JHRoaXNh
cnRpY2xlWyd0aGlzaWQnXSkgewogICAgICAvLyBGZXRjaCBhcmNfdHdpdHRlciBzdHVmZiB0
byBidWlsZCB0d2VldCBmcm9tCiAgICAgICRyb3cgPSBzYWZlX3JvdygiUkVQTEFDRSh0d2Vl
dCxDT05DQVQoJyAnLHRpbnl1cmwpLCcnKSBBUyB0d2VldCx0aW55dXJsIgogICAgICAgICwg
J2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKTsKCiAgICAgIGlmICgkdXJsPT0n
JykgewogICAgICAgICR1cmwgPSAoJHVybCkgPyAkdXJsIDogcGVybWxpbmt1cmwoJHRoaXNh
cnRpY2xlKTsKICAgICAgICAkcSA9ICd1cmw9Jy51cmxlbmNvZGUoJHVybCk7CiAgICAgIH0K
ICAgICAgaWYgKCR0ZXh0PT0nJykgewogICAgICAgICR0ZXh0ID0gKCRyb3dbJ3R3ZWV0J10p
ID8gJHJvd1sndHdlZXQnXSA6ICR0aGlzYXJ0aWNsZVsndGl0bGUnXTsKICAgICAgfQogICAg
ICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLid0ZXh0PScudXJsZW5jb2RlKCR0ZXh0KTsK
ICAgIH0KICAgIGlmICgkdXNlcikgewogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycp
Lid2aWE9Jy51cmxlbmNvZGUoJHVzZXIpOwogICAgfQogICAgaWYgKCRmb2xsb3cxJiYkZm9s
bG93MikgewogICAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidyZWxhdGVkPScudXJs
ZW5jb2RlKCRmb2xsb3cxLic6Jy4kZm9sbG93Mik7CiAgICB9IGVsc2VpZiAoJGZvbGxvdzF8
fCRmb2xsb3cyKSB7CiAgICAgICRxIC49ICgkcSA/ICcmYW1wOycgOiAnJykuJ3JlbGF0ZWQ9
Jy51cmxlbmNvZGUoJGZvbGxvdzEuJGZvbGxvdzIpOwogICAgfQoKICAgIHN3aXRjaCAoJGxh
bmcpIHsKICAgICAgY2FzZSAnZnInOiBicmVhazsgY2FzZSAnZGUnOiBicmVhazsgY2FzZSAn
ZXMnOiBicmVhazsgY2FzZSAnanAnOiBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICAk
bGFuZyA9ICdlbic7CiAgICB9CiAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidsYW5n
PScudXJsZW5jb2RlKCRsYW5nKTsKCiAgICBzd2l0Y2ggKCRjb3VudCkgewogICAgICBjYXNl
ICdub25lJzogYnJlYWs7IGNhc2UgJ3ZlcnRpY2FsJzogYnJlYWs7CiAgICAgIGRlZmF1bHQ6
CiAgICAgICAgJGNvdW50ID0gJ2hvcml6b250YWwnOwogICAgfQogICAgJHEgLj0gKCRxID8g
JyZhbXA7JyA6ICcnKS4nY291bnQ9Jy51cmxlbmNvZGUoJGNvdW50KTsKCiAgICAkdGhpbmcg
PSAoJHRoaW5nPT09bnVsbCkgPyAnVHdlZXQnIDogcGFyc2UoJHRoaW5nKTsKCiAgICAkaHRt
bCA9IGhyZWYoJHRoaW5nLCdodHRwOi8vdHdpdHRlci5jb20vc2hhcmU/Jy4kcQogICAgICAs
ICcgY2xhc3M9IicuJGNsYXNzLiciJyk7CgogICAgJGpzID0gKCRpbmNsdWRlX2pzKSA/CiAg
ICAgICc8c2NyaXB0IHNyYz0iaHR0cDovL3BsYXRmb3JtLnR3aXR0ZXIuY29tL3dpZGdldHMu
anMiIHR5cGU9InRleHQvamF2YXNjcmlwdCI+PC9zY3JpcHQ+JwogICAgICA6ICcnOwoKICAg
IHJldHVybiAkanMuJGh0bWw7Cn0KCi8qCiAgICBBZG1pbi1zaWRlIGZ1bmN0aW9ucwogICAg
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PQoqLwoKLy8gSW5zdGFsbGF0aW9uIGZ1bmN0aW9uIC0gYnVpbGRzIE15U1FM
IHRhYmxlCmZ1bmN0aW9uIGFyY190d2l0dGVyX2luc3RhbGwoKQp7CgogICAgLy8gRm9yIGZp
cnN0IGluc3RhbGwsIGNyZWF0ZSB0YWJsZSBmb3IgdHdlZXRzCiAgICAkc3FsID0gIkNSRUFU
RSBUQUJMRSBJRiBOT1QgRVhJU1RTICIuUEZYLiJhcmNfdHdpdHRlciAiOwogICAgJHNxbC49
ICIoYXJjX3R3aXR0ZXJpZCBJTlRFR0VSIEFVVE9fSU5DUkVNRU5UIFBSSU1BUlkgS0VZLAog
ICAgICAgIGFydGljbGVfaWQgSU5URUdFUigxMSksCiAgICAgICAgdHdlZXRfaWQgQklHSU5U
KDIwKSwKICAgICAgICB0d2VldCBWQVJDSEFSKDE0MCksCiAgICAgICAgdGlueXVybCBWQVJD
SEFSKDMwKSk7IjsKCiAgICBpZiAoIXNhZmVfcXVlcnkoJHNxbCkpIHsKICAgICAgICByZXR1
cm4gJ0Vycm9yIC0gdW5hYmxlIHRvIGNyZWF0ZSBhcmNfdHdpdHRlciB0YWJsZSc7CiAgICB9
Cgp9CgovLyBVbmluc3RhbGwgZnVuY3Rpb24gLSBkZWxldGVzIE15U1FMIHRhYmxlIGFuZCBy
ZWxhdGVkIHByZWZlcmVuY2VzCmZ1bmN0aW9uIGFyY190d2l0dGVyX3VuaW5zdGFsbCgpCnsK
CiAgICAkc3FsID0gIkRST1AgVEFCTEUgSUYgRVhJU1RTICIuUEZYLiJhcmNfdHdpdHRlcjsi
OwogICAgaWYgKCFzYWZlX3F1ZXJ5KCRzcWwpKSB7CiAgICAgICAgcmV0dXJuICdFcnJvciAt
IHVuYWJsZSB0byBkZWxldGUgYXJjX3R3aXR0ZXIgdGFibGUnOwogICAgfQoKICAgICRzcWwg
PSAiREVMRVRFIEZST00gICIuUEZYLiJ0eHBfcHJlZnMgV0hFUkUgZXZlbnQ9J2FyY190d2l0
dGVyJzsiOwogICAgaWYgKCFzYWZlX3F1ZXJ5KCRzcWwpKSB7CiAgICAgICAgcmV0dXJuICdF
cnJvciAtIHVuYWJsZSB0byBkZWxldGUgYXJjX3R3aXR0ZXIgcHJlZmVyZW5jZXMnOwogICAg
fQoKfQpmdW5jdGlvbiBhcmNfdHdpdHRlcl91cmxfbWV0aG9kX3NlbGVjdCgkbmFtZSwgJHZh
bCkKewogICAgJG1ldGhvZHMgPSBhcnJheSgndGlueXVybCcgPT4gJ1Rpbnl1cmwnLAogICAg
ICAnaXNnZCcgPT4gJ0lzLmdkJywKICAgICAgJ2FyY190d2l0dGVyJyA9PiAnVFhQIFR3ZWV0
JywKICAgICAgJ3NtZCcgPT4gJ3NtZF9zaG9ydF91cmwnKTsKICAgIHJldHVybiBzZWxlY3RJ
bnB1dCgkbmFtZSwgJG1ldGhvZHMsICR2YWwpOwp9CmZ1bmN0aW9uIGFyY190d2l0dGVyX3Rh
Yl9zZWxlY3QoJG5hbWUsICR2YWwpCnsKICAgICR0YWJzID0gYXJyYXkoJ2NvbnRlbnQnID0+
ICdDb250ZW50JywKICAgICAgICAnZXh0ZW5zaW9ucycgPT4gJ0V4dGVuc2lvbnMnLAogICAg
ICAgICcnID0+ICdIaWRkZW4nKTsKICAgIHJldHVybiBzZWxlY3RJbnB1dCgkbmFtZSwgJHRh
YnMsICR2YWwpOwp9Ci8vIFByb3ZpZGUgaW50ZXJmYWNlIGZvciBzZXR0aW5nIHByZWZlcmVu
Y2VzCmZ1bmN0aW9uIGFyY190d2l0dGVyX3ByZWZzKCRldmVudCwkc3RlcCkKewoKICAgIGds
b2JhbCAkcHJlZnMsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCRhcmNfdHdpdHRlcl9jb25z
dW1lclNlY3JldDsKCiAgICAkdXNlciAgICAgICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJf
dXNlciddOwogICAgJHByZWZpeCAgICAgICAgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3ByZWZp
eCddOwogICAgJHR3ZWV0X2RlZmF1bHQgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3R3ZWV0X2Rl
ZmF1bHQnXTsKICAgICR1cmxfbWV0aG9kICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl91cmxf
bWV0aG9kJ107CiAgICAkc2hvcnRfdXJsICAgICA9ICRwcmVmc1snYXJjX3Nob3J0X3VybCdd
OwogICAgJHNob3J0X3NpdGVfdXJsPSAkcHJlZnNbJ2FyY19zaG9ydF9zaXRlX3VybCddOwog
ICAgJGNhY2hlX2RpciAgICAgPSAkcHJlZnNbJ2FyY190d2l0dGVyX2NhY2hlX2RpciddOwog
ICAgJHRhYiAgICAgICAgICAgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddOwoKICAgIHN3
aXRjaCAoJHN0ZXApIHsKICAgICAgICBjYXNlICdwcmVmc19zYXZlJzogcGFnZXRvcCgnVFhQ
IFR3ZWV0JywgJ1ByZWZlcmVuY2VzIHNhdmVkJyk7IGJyZWFrOwogICAgICAgIGNhc2UgJ3Jl
Z2lzdGVyJzogcGFnZXRvcCgnVFhQIFR3ZWV0JywnQ29ubmVjdCB0byBUd2l0dGVyJyk7IGJy
ZWFrOwogICAgICAgIGNhc2UgJ3ZhbGlkYXRlJzoKICAgICAgICBkZWZhdWx0OiBwYWdldG9w
KCdUWFAgVHdlZXQnKTsKICAgIH0KCiAgICAkaHRtbCA9ICcnOwoKICAgIGlmICgkc3RlcD09
J3JlZ2lzdGVyJykgeyAvLyBPQXV0aCByZWdpc3RyYXRpb24gcHJvY2VzcwogICAgICAgICR0
d2l0ID0gbmV3IGFyY190d2l0dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAg
ICAgICAsICRhcmNfdHdpdHRlcl9jb25zdW1lclNlY3JldCk7CgogICAgICAgIC8vIEJ1aWxk
IGEgY2FsbGJhY2sgVVJMIGZvciBUd2l0dGVyIHRvIHJldHVybiB0byB0aGUgbmV4dCBzdGFn
ZQogICAgICAgICRjYWxsYmFja1VSTCA9ICR0d2l0LT5jYWxsYmFja1VSTCgkZXZlbnQsJ3Zh
bGlkYXRlJyk7CgogICAgICAgICRyZXF1ZXN0ID0gJHR3aXQtPmdldFJlcXVlc3RUb2tlbigk
Y2FsbGJhY2tVUkwpOwogICAgICAgICRyZXF1ZXN0X3Rva2VuID0gJHJlcXVlc3RbIm9hdXRo
X3Rva2VuIl07CiAgICAgICAgJHJlcXVlc3RfdG9rZW5fc2VjcmV0ID0gJHJlcXVlc3RbIm9h
dXRoX3Rva2VuX3NlY3JldCJdOwoKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfcmVx
dWVzdFRva2VuJywkcmVxdWVzdF90b2tlbgogICAgICAgICAgICAsICdhcmNfdHdpdHRlcics
Mik7CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3JlcXVlc3RUb2tlblNlY3JldCcs
JHJlcXVlc3RfdG9rZW5fc2VjcmV0CiAgICAgICAgICAgICwgJ2FyY190d2l0dGVyJywyKTsK
CiAgICAgICAgJGh0bWwuPSBzdGFydFRhYmxlKCdlZGl0JykuCiAgICAgICAgICAgICAgICB0
cih0ZCgKICAgICAgICAgICAgICAgICAgICAoJzxwPicuaHJlZignU2lnbi1pbiB0byBUd2l0
dGVyJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLCR0d2l0LT5nZXRBdXRob3JpemVV
UkwoJHJlcXVlc3QpKQogICAgICAgICAgICAgICAgICAgICAgICAuJyBhbmQgZm9sbG93IHRo
ZSBpbnN0cnVjdGlvbnMgdG8gYWxsb3cgVFhQIFR3ZWV0IHRvIHVzZSB5b3VyIGFjY291bnQu
IElmIHlvdSBhcmUgYWxyZWFkeSBzaWduZWQgaW4gdG8gVHdpdHRlciB0aGVuIHRoYXQgYWNj
b3VudCB3aWxsIGJlIGFzc29jaWF0ZWQgd2l0aCBUWFAgVHdlZXQgc28geW91IG1heSBuZWVk
IHRvIHNpZ24gb3V0IGZpcnN0IGlmIHlvdSB3YW50IHRvIHVzZSBhIGRpZmZlcmVudCBhY2Nv
dW50LjwvcD4nKQogICAgICAgICAgICAgICAgKSkuZW5kVGFibGUoKTsKICAgIH0gZWxzZWlm
ICgkc3RlcD09J3ZhbGlkYXRlJykgewogICAgICAgICR0d2l0ID0gbmV3IGFyY190d2l0dGVy
KCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAsICRhcmNfdHdpdHRlcl9j
b25zdW1lclNlY3JldCwgJHByZWZzWydhcmNfdHdpdHRlcl9yZXF1ZXN0VG9rZW4nXQogICAg
ICAgICAgICAsICRwcmVmc1snYXJjX3R3aXR0ZXJfcmVxdWVzdFRva2VuU2VjcmV0J10pOwog
ICAgICAgIC8vIEFzayBUd2l0dGVyIGZvciBhbiBhY2Nlc3MgdG9rZW4gKGFuZCBhbiBhY2Nl
c3MgdG9rZW4gc2VjcmV0KQogICAgICAgICRyZXF1ZXN0ID0gJHR3aXQtPmdldEFjY2Vzc1Rv
a2VuKCBncHMoJ29hdXRoX3ZlcmlmaWVyJykgKTsKICAgICAgICAkYWNjZXNzX3Rva2VuID0g
JHJlcXVlc3RbJ29hdXRoX3Rva2VuJ107CiAgICAgICAgJGFjY2Vzc190b2tlbl9zZWNyZXQg
PSAkcmVxdWVzdFsnb2F1dGhfdG9rZW5fc2VjcmV0J107CiAgICAgICAgJHVzZXIgPSAkcmVx
dWVzdFsnc2NyZWVuX25hbWUnXTsKICAgICAgICAvLyBTdG9yZSB0aGUgYWNjZXNzIHRva2Vu
IGFuZCBzZWNyZXQKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4n
LCRhY2Nlc3NfdG9rZW4sICdhcmNfdHdpdHRlcicsMik7CiAgICAgICAgc2V0X3ByZWYoJ2Fy
Y190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0JywkYWNjZXNzX3Rva2VuX3NlY3JldAogICAg
ICAgICAgICAsICdhcmNfdHdpdHRlcicsMik7CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0
dGVyX3VzZXInLCR1c2VyKTsKICAgICAgICAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rv
a2VuJ10gPSAkYWNjZXNzX3Rva2VuOwogICAgICAgICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNj
ZXNzVG9rZW5TZWNyZXQnXSA9ICRhY2Nlc3NfdG9rZW5fc2VjcmV0OwogICAgICAgIHVuc2V0
KCR0d2l0KTsKICAgIH0KCiAgICBpZiAoJHN0ZXA9PSJwcmVmc19zYXZlIikgewogICAgICAg
ICRwcmVmaXggPSB0cmltKGdwcygnYXJjX3R3aXR0ZXJfcHJlZml4JykpOwogICAgICAgICR0
d2VldF9kZWZhdWx0ID0gZ3BzKCdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0Jyk7CiAgICAg
ICAgJHVybF9tZXRob2QgPSBncHMoJ2FyY190d2l0dGVyX3VybF9tZXRob2QnKTsKICAgICAg
ICAkc2hvcnRfdXJsID0gZ3BzKCdhcmNfc2hvcnRfdXJsJyk7CiAgICAgICAgJHNob3J0X3Np
dGVfdXJsID0gZ3BzKCdhcmNfc2hvcnRfc2l0ZV91cmwnKTsKICAgICAgICAkY2FjaGVfZGly
ID0gZ3BzKCdhcmNfdHdpdHRlcl9jYWNoZV9kaXInKTsKICAgICAgICAkdGFiID0gZ3BzKCdh
cmNfdHdpdHRlcl90YWInKTsKICAgICAgICBpZiAoc3RybGVuKCRwcmVmaXgpPD0yMCkgewog
ICAgICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfcHJlZml4JywkcHJlZml4KTsKICAg
ICAgICB9IGVsc2UgewogICAgICAgICAgICAkcHJlZml4ID0gJHByZWZzWydhcmNfdHdpdHRl
cl9wcmVmaXgnXTsKICAgICAgICB9CiAgICAgICAgJHR3ZWV0X2RlZmF1bHQgPSAoJHR3ZWV0
X2RlZmF1bHQpID8gMSA6IDA7CiAgICAgICAgJHNob3J0X3VybCA9ICgkc2hvcnRfdXJsKSA/
IDEgOiAwOwogICAgICAgIGlmICghJHNob3J0X3NpdGVfdXJsKSAkc2hvcnRfc2l0ZV91cmwg
PSAkcHJlZnNbJ3NpdGV1cmwnXTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdHdl
ZXRfZGVmYXVsdCcsJHR3ZWV0X2RlZmF1bHQpOwogICAgICAgIHNldF9wcmVmKCdhcmNfc2hv
cnRfdXJsJywkc2hvcnRfdXJsKTsKICAgICAgICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfdXJs
X21ldGhvZCcsJHVybF9tZXRob2QpOwogICAgICAgIHNldF9wcmVmKCdhcmNfc2hvcnRfc2l0
ZV91cmwnLCRzaG9ydF9zaXRlX3VybCk7CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVy
X2NhY2hlX2RpcicsJGNhY2hlX2Rpcik7CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVy
X3RhYicsJHRhYik7CiAgICB9CgogICAgaWYgKCAkc3RlcCE9J3JlZ2lzdGVyJyApIHsKICAg
ICAgICBpZiAoIGlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXSkKICAg
ICAgICAmJiBpc3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0J10p
ICkgewogICAgICAgICAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJf
Y29uc3VtZXJLZXkKICAgICAgICAgICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2Vj
cmV0LCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJ10KICAgICAgICAgICAgICAg
ICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKTsKICAgICAgICAg
ICAgJHJlZ2lzdGVyVVJMID0gJHR3aXQtPmNhbGxiYWNrVVJMKCRldmVudCwncmVnaXN0ZXIn
KTsKICAgICAgICAgICAgJGh0bWwuPSBzdGFydFRhYmxlKCdsaXN0JykuZm9ybSgKICAgICAg
ICAgICAgICAgIHRyKAogICAgICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdUd2l0dGVyIGFj
Y291bnQgZGV0YWlscycsIDIpLDIpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAg
ICAudHIoCiAgICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRl
cl91c2VyIj5Ud2l0dGVyIHVzZXJuYW1lPC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAg
ICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRs
ZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoCiAgICAgICAgICAgICAgICAgICAgICAg
ICgkcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSkgPwogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgJHVzZXIuJyAoJy5ocmVmKCdSZS1jb25uZWN0JywkcmVnaXN0ZXJVUkwpLicpJwog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnPGVtPnVua25vd248L2VtPicKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIC5ocmVmKCdDb25uZWN0IHRvIFR3aXR0ZXInLCRyZWdp
c3RlclVSTCkpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAg
ICAgICAgICAgICAgICAgdGRjcyhoZWQoJ1R3ZWV0IHNldHRpbmdzJywgMiksMikKICAgICAg
ICAgICAgICAgICkKICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0
ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX2NhY2hlX2RpciI+VHdlZXQgcHJlZml4PC9s
YWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiBy
aWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAu
dGQoZklucHV0KCd0ZXh0JywnYXJjX3R3aXR0ZXJfcHJlZml4JywkcHJlZml4LCcnLCcnLCcn
LCcnLCcnLCdhcmNfdHdpdHRlcl9wcmVmaXgnKSkKICAgICAgICAgICAgICAgICkudHIoCiAg
ICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl90d2VldF9k
ZWZhdWx0Ij5Ud2VldCBhcnRpY2xlcyBieSBkZWZhdWx0PC9sYWJlbD4nLAogICAgICAgICAg
ICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxp
Z246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoeWVzbm9SYWRpbygnYXJj
X3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcsICR0d2VldF9kZWZhdWx0LCAnJywgJ2FyY190d2l0
dGVyX3R3ZWV0X2RlZmF1bHQnKSkKICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAg
ICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl91cmxfbWV0aG9kIj5VUkwg
c2hvcnRuZXI8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRl
eHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAg
ICAgICAgICAgIC50ZChhcmNfdHdpdHRlcl91cmxfbWV0aG9kX3NlbGVjdCgnYXJjX3R3aXR0
ZXJfdXJsX21ldGhvZCcsJHVybF9tZXRob2QpKQogICAgICAgICAgICAgICAgKS50cigKICAg
ICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVFhQIFR3ZWV0IHNob3J0IFVSTCcsIDIpLDIp
CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAg
ICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfc2hvcnRfdXJsIj5FbmFibGUgVFhQIFR3ZWV0
IHNob3J0IFVSTCByZWRpcmVjdDwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAg
JyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7Iicp
CiAgICAgICAgICAgICAgICAgICAgLnRkKHllc25vUmFkaW8oJ2FyY19zaG9ydF91cmwnLCAk
c2hvcnRfdXJsLCAnJywgJ2FyY19zaG9ydF91cmwnKSksCiAgICAgICAgICAgICAgICAgICAg
JyBpZD0iYXJjX3Nob3J0X3VybC1vbl9vZmYiJwogICAgICAgICAgICAgICAgKS50cigKICAg
ICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY19zaG9ydF9zaXRlX3VybCI+
VFhQIFR3ZWV0IHNob3J0IHNpdGUgVVJMPC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAg
ICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRs
ZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoZklucHV0KCd0ZXh0JywnYXJjX3Nob3J0
X3NpdGVfdXJsJywkc2hvcnRfc2l0ZV91cmwsJycsJycsJycsJycsJycsJ2FyY19zaG9ydF9z
aXRlX3VybCcpKSwKICAgICAgICAgICAgICAgICAgICAnIGlkPSJhcmNfc2hvcnRfc2l0ZV91
cmwtb3B0aW9uIicKICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAgICAgICAgICAg
dGRjcyhoZWQoJ1R3aXR0ZXIgdGFiJywgMiksMikKICAgICAgICAgICAgICAgICkudHIoCiAg
ICAgICAgICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl90YWIiPkxv
Y2F0aW9uIG9mIFR3aXR0ZXIgdGFiPC9sYWJlbD4nLAogICAgICAgICAgICAgICAgICAgICAg
ICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsi
JykKICAgICAgICAgICAgICAgICAgICAudGQoYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCgnYXJj
X3R3aXR0ZXJfdGFiJywkdGFiKSkKICAgICAgICAgICAgICAgICkudHIoCiAgICAgICAgICAg
ICAgICAgICAgdGRjcyhoZWQoJ0NhY2hlJywgMiksMikKICAgICAgICAgICAgICAgICkKICAg
ICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9
ImFyY190d2l0dGVyX2NhY2hlX2RpciI+Q2FjaGUgZGlyZWN0b3J5PC9sYWJlbD4nLAogICAg
ICAgICAgICAgICAgICAgICAgICAnIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgdmVydGlj
YWwtYWxpZ246IG1pZGRsZTsiJykKICAgICAgICAgICAgICAgICAgICAudGQoZklucHV0KCd0
ZXh0JywnYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJywkY2FjaGVfZGlyLCcnLCcnLCcnLCcnLCcn
LCdhcmNfdHdpdHRlcl9jYWNoZV9kaXInKSkKICAgICAgICAgICAgICAgICkKICAgICAgICAg
ICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoCiAgICAgICAgICAgICAgICAg
ICAgICAgIGZJbnB1dCgnc3VibWl0JywgJ1N1Ym1pdCcsIGdUeHQoJ3NhdmVfYnV0dG9uJyks
ICdwdWJsaXNoJykKICAgICAgICAgICAgICAgICAgICAgICAgLm4uc0lucHV0KCdwcmVmc19z
YXZlJykKICAgICAgICAgICAgICAgICAgICAgICAgLm4uZUlucHV0KCdwbHVnaW5fcHJlZnMu
YXJjX3R3aXR0ZXInKQogICAgICAgICAgICAgICAgICAgICwgJyBjb2xzcGFuPSIyIiBjbGFz
cz0ibm9saW5lIicpKSkKICAgICAgICAgICAgICAgIC5lbmRUYWJsZSgpOwogICAgICAgIH0g
ZWxzZWlmICggJHN0ZXAhPSdyZWdpc3RlcicgKSB7CiAgICAgICAgICAgICRyZWdpc3RlclVS
TCA9IGFyY190d2l0dGVyOjpjYWxsYmFja1VSTCgkZXZlbnQsJ3JlZ2lzdGVyJyk7CiAgICAg
ICAgICAgICRodG1sLj0gc3RhcnRUYWJsZSgnbGlzdCcpLmZvcm0oCiAgICAgICAgICAgICAg
ICB0cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVHdpdHRlciBhY2NvdW50IGRl
dGFpbHMnLCAyKSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAog
ICAgICAgICAgICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfdXNlciI+
VHdpdHRlciB1c2VybmFtZTwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBz
dHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAg
ICAgICAgICAgICAgICAgICAgLnRkKAogICAgICAgICAgICAgICAgICAgICAgICAoJzxlbT51
bmtub3duPC9lbT4gKCcKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5ocmVmKCdDb25u
ZWN0IHRvIFR3aXR0ZXInLCRyZWdpc3RlclVSTCkuJyknKQogICAgICAgICAgICAgICAgKSkp
CiAgICAgICAgICAgICAgICAuZW5kVGFibGUoKTsKICAgICAgICB9CiAgICB9CgogICAgLy8g
U2V0IGpRdWVyeSBmb3Igc3dpdGNoaW5nIG9uL29mZiByZWxldmFudCBhcmNfc2hvcnRfdXJs
IGZpZWxkcwogICAgJGpzID0gPDw8SlMKPHNjcmlwdCBsYW5ndWFnZT0iamF2YXNjcmlwdCIg
dHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXsK
ICB2YXIgb25vZmYgPSAkKCcjYXJjX3Nob3J0X3VybC1vbl9vZmYnKTsKICB2YXIgYXJjX3No
b3J0X3VybF9vZmYgPSAkKCcjYXJjX3Nob3J0X3VybC1hcmNfc2hvcnRfdXJsLTAnKTsKICB2
YXIgdXJsID0gJCgnI2FyY19zaG9ydF9zaXRlX3VybC1vcHRpb24nKTsKICB2YXIgdXJsX21l
dGhvZCA9ICQoJ3NlbGVjdFtuYW1lPSJhcmNfdHdpdHRlcl91cmxfbWV0aG9kIl0nKTsKCiAg
aWYgKGFyY19zaG9ydF91cmxfb2ZmLmF0dHIoJ2NoZWNrZWQnKT09dHJ1ZQogICYmICQoJ29w
dGlvbjpzZWxlY3RlZCcsIHVybF9tZXRob2QpLnZhbCgpIT0nYXJjX3R3aXR0ZXInKSB7CiAg
ICB1cmwuaGlkZSgpOwogIH0KICAkKCdpbnB1dCcsIG9ub2ZmKS5jaGFuZ2UoZnVuY3Rpb24o
KXsKICAgIGlmICgkKCdvcHRpb246c2VsZWN0ZWQnLCB1cmxfbWV0aG9kKS52YWwoKSE9J2Fy
Y190d2l0dGVyJykgewogICAgICBhcmNfc2hvcnRfdXJsX29mZi5hdHRyKCdjaGVja2VkJyk9
PXRydWUgPyB1cmwuaGlkZSgpIDogdXJsLnNob3coKTsKICAgIH0KICB9KTsKCiAgaWYgKCQo
J29wdGlvbjpzZWxlY3RlZCcsIHVybF9tZXRob2QpLnZhbCgpPT0nYXJjX3R3aXR0ZXInKSB7
CiAgICBvbm9mZi5oaWRlKCk7IHVybC5zaG93KCk7CiAgfQogIHVybF9tZXRob2QuY2hhbmdl
KGZ1bmN0aW9uKCl7CiAgICBpZiAoJCgnb3B0aW9uOnNlbGVjdGVkJywgdXJsX21ldGhvZCku
dmFsKCk9PSdhcmNfdHdpdHRlcicpIHsKICAgICAgb25vZmYudG9nZ2xlKCk7IHVybC5zaG93
KCk7CiAgICB9IGVsc2UgewogICAgICBvbm9mZi50b2dnbGUoKTsKICAgICAgYXJjX3Nob3J0
X3VybF9vZmYuYXR0cignY2hlY2tlZCcpPT10cnVlID8gdXJsLmhpZGUoKSA6IHVybC5zaG93
KCk7CiAgICB9CiAgfSkKfSk7Cjwvc2NyaXB0PgpKUzsKCiAgICBlY2hvICRqcy4kaHRtbDsK
fQoKLy8gQWRkIFR3aXR0ZXIgdGFiIHRvIFRleHRwYXR0ZXJuCmZ1bmN0aW9uIGFyY19hZG1p
bl90d2l0dGVyKCRldmVudCwkc3RlcCkKewogICAgZ2xvYmFsICRwcmVmcywgJGFyY190d2l0
dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgogICAgJHR3
aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAg
ICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0LCAkcHJlZnNbJ2FyY190d2l0dGVy
X2FjY2Vzc1Rva2VuJ10KICAgICAgICAgICAgLCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vz
c1Rva2VuU2VjcmV0J10pOwoKICAgICR0d2l0LT5jYWNoZURpcigkcHJlZnNbJ2FyY190d2l0
dGVyX2NhY2hlX2RpciddKTsKCiAgICAkeG1sID0gJHR3aXQtPmdldCgndXNlcnMvc2hvdycK
ICAgICAgICAsIGFycmF5KCdzY3JlZW5fbmFtZSc9PiRwcmVmc1snYXJjX3R3aXR0ZXJfdXNl
ciddKSk7CiAgICAkdHdpdHRlclVzZXIgPSBAJHhtbC0+eHBhdGgoJy91c2VyJyk7CiAgICAk
dHdpdHRlclVzZXIgPSAkdHdpdHRlclVzZXJbMF07CiAgICAkdHdpdHRlclVzZXJVUkwgPSAn
aHR0cDovL3d3dy50d2l0dGVyLmNvbS8nLiR0d2l0dGVyVXNlci0+c2NyZWVuX25hbWU7Cgog
ICAgaWYgKCRzdGVwPT0idHdlZXQiKSB7IC8vIHBvc3QgYW4gdXBkYXRlIHRvIFR3aXR0ZXIK
CiAgICAgICAgLy8gZmV0Y2ggYW5kIGNsZWFuIG1lc3NhZ2UKICAgICAgICAkbWVzc2FnZSA9
IHN0cmlwX3RhZ3MoZ3BzKCdtZXNzYWdlJykpOwogICAgICAgICRjb3VudCA9IHN0cmxlbigk
bWVzc2FnZSk7CgogICAgICAgIGlmICgkY291bnQ8PTE0MCAmJiAkY291bnQ+MCkgeyAvLyBw
b3N0IHVwZGF0ZQogICAgICAgICAgICAkcmVzdWx0ID0gJHR3aXQtPnBvc3QoJ3N0YXR1c2Vz
L3VwZGF0ZScsIGFycmF5KCdzdGF0dXMnID0+ICRtZXNzYWdlKSk7CiAgICAgICAgfSBlbHNl
IHsgLy8gbWVzc2FnZSB0b28gbG9uZywgSmF2YVNjcmlwdCBpbnRlcmZhY2Ugc2hvdWxkIHBy
ZXZlbnQgdGhpcwogICAgICAgICAgICAkcmVzdWx0ID0gZmFsc2U7CiAgICAgICAgfQoKICAg
ICAgICBwYWdldG9wKCdUd2l0dGVyJywKICAgICAgICAgICAgKCgkcmVzdWx0IT1mYWxzZSk/
J1R3aXR0ZXIgdXBkYXRlZCc6J0Vycm9yIHVwZGF0aW5nIFR3aXR0ZXInKSk7CgogICAgfSBl
bHNlaWYgKCRzdGVwPT0iZGVsZXRlIikgeyAvLyBkZWxldGUgYW4gdXBkYXRlIGZyb20gVHdp
dHRlcgoKICAgICAgICAkaWQgPSBzdHJpcF90YWdzKGdwcygnaWQnKSk7CiAgICAgICAgaWYg
KCRpZCkgewogICAgICAgICAgICAkdHdpdC0+ZGVsZXRlKCdzdGF0dXNlcy9kZXN0cm95Jy4k
aWQpOwogICAgICAgICAgICBzYWZlX2RlbGV0ZSgnYXJjX3R3aXR0ZXInLCJ0d2VldF9pZCA9
ICRpZCIpOwogICAgICAgIH0KCiAgICAgICAgcGFnZXRvcCgnVHdpdHRlcicsJ1R3aXR0ZXIg
dXBkYXRlZCcpOwoKICAgIH0gZWxzZSB7CgogICAgICAgIHBhZ2V0b3AoJ1R3aXR0ZXInKTsK
CiAgICB9CgogICAgLy8gUHJlcGFyZSBKYXZhU2NyaXB0IHRvIGNyZWF0ZSBUd2l0dGVyIHVw
ZGF0ZSBpbnRlcmZhY2UKCiAgICAkanMgPSAnPHNjcmlwdCBsYW5ndWFnZT0iamF2YXNjcmlw
dCIgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4nOwogICAgJGpzLj0gIiQoZG9jdW1lbnQpLnJl
YWR5KGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHZhciBjb3VudGVyU3R5bGUgPSAnZm9udC13
ZWlnaHQ6Ym9sZDtmbG9hdDpyaWdodDtmb250LXNpemU6MmVtO2xpbmUtaGVpZ2h0OjEuMmVt
Oyc7CiAgICAgICAgICAgICQoJyN0d2VldGNvdW50JykuYXR0cignc3R5bGUnLCBjb3VudGVy
U3R5bGUrJ2NvbG9yOiNjY2M7Jyk7CiAgICAgICAgICAgICQoJyNtZXNzYWdlJykua2V5dXAo
ZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB2YXIgY291bnQgPSAxNDAtJCgnI21lc3Nh
Z2UnKS52YWwoKS5sZW5ndGg7CiAgICAgICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmh0
bWwoY291bnQrJycpOyAvLyBoYWNrIHRvIGZvcmNlIG91dHB1dCBvZiAwCiAgICAgICAgICAg
ICAgICBpZiAoY291bnQ8MCkgewogICAgICAgICAgICAgICAgICAgICQoJ2lucHV0LnB1Ymxp
c2gnKS5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpOwogICAgICAgICAgICAgICAgfSBl
bHNlIHsKICAgICAgICAgICAgICAgICAgICAkKCdpbnB1dC5wdWJsaXNoJykuYXR0cignZGlz
YWJsZWQnLCAnJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoY291
bnQ8MCkgewogICAgICAgICAgICAgICAgICAgICQoJyN0d2VldGNvdW50JykuYXR0cignc3R5
bGUnLCBjb3VudGVyU3R5bGUrJ2NvbG9yOiNmMDA7Jyk7CiAgICAgICAgICAgICAgICB9IGVs
c2UgaWYgKGNvdW50PDEwKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnI3R3ZWV0Y291bnQn
KS5hdHRyKCdzdHlsZScsIGNvdW50ZXJTdHlsZSsnY29sb3I6IzAwMDsnKTsKICAgICAgICAg
ICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJCgnI3R3ZWV0Y291bnQnKS5h
dHRyKCdzdHlsZScsIGNvdW50ZXJTdHlsZSsnY29sb3I6I2NjYzsnKTsKICAgICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICB9KTsiOwogICAgJGpzLj0gIjwvc2NyaXB0
PiI7CgogICAgJG91dCA9ICcnOwogICAgJHhtbCA9ICR0d2l0LT5nZXQoJ3N0YXR1c2VzL3Vz
ZXJfdGltZWxpbmUnCiAgICAgICAgLCBhcnJheSgnc2NyZWVuX25hbWUnPT4kcHJlZnNbJ2Fy
Y190d2l0dGVyX3VzZXInXSwnY291bnQnPT4yNSkpOwogICAgJHR3ZWV0cyA9IEAkeG1sLT54
cGF0aCgnL3N0YXR1c2VzL3N0YXR1cycpOwogICAgaWYgKCR0d2VldHMpIGZvcmVhY2ggKCR0
d2VldHMgYXMgJHR3ZWV0KSB7CiAgICAgICAgJHRpbWUgPSBzdHJ0b3RpbWUoaHRtbGVudGl0
aWVzKCR0d2VldC0+Y3JlYXRlZF9hdCkpOwogICAgICAgICRkYXRlID0gc2FmZV9zdHJmdGlt
ZSgkcHJlZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCddLCR0aW1lKTsKICAgICAgICAkb3V0Lj0g
dHIodGQoJGRhdGUsJ3NwYW4nKQogICAgICAgICAgICAudGQoYXJjX1R3aXR0ZXI6Om1ha2VM
aW5rcyhodG1sZW50aXRpZXMoJHR3ZWV0LT50ZXh0CiAgICAgICAgICAgICAgICAsIEVOVF9R
VU9URVMsJ1VURi04JykpKQogICAgICAgICAgICAudGQoZExpbmsoJ2FyY19hZG1pbl90d2l0
dGVyJywnZGVsZXRlJywnaWQnLCR0d2VldC0+aWQsJycpKQogICAgICAgICAgICApOwogICAg
fQoKICAgICRodG1sID0gc3RhcnRUYWJsZSgnZWRpdCcpCiAgICAgICAgICAgIC50cih0ZCgK
ICAgICAgICAgICAgZ3JhZignPGltZyBzcmM9IicuJHR3aXR0ZXJVc2VyLT5wcm9maWxlX2lt
YWdlX3VybC4nIiBhbHQ9IlR3aXR0ZXIgYXZhdGFyIiAvPicKICAgICAgICAgICAgLCcgc3R5
bGU9ImZsb2F0OmxlZnQ7cGFkZGluZzoycHg7IicpCiAgICAgICAgICAgIC5ncmFmKGhyZWYo
JHR3aXR0ZXJVc2VyLT5uYW1lLCR0d2l0dGVyVXNlclVSTCksJyBzdHlsZT0iZm9udC1zaXpl
OjEuMmVtO2ZvbnQtd2VpZ2h0OmJvbGQ7IicpCiAgICAgICAgICAgIC5ncmFmKGhyZWYoJHR3
aXR0ZXJVc2VyLT5mcmllbmRzX2NvdW50LicgZm9sbG93aW5nJywkdHdpdHRlclVzZXJVUkwu
Jy9mb2xsb3dpbmcnKQogICAgICAgICAgICAuJywgJy5ocmVmKCR0d2l0dGVyVXNlci0+Zm9s
bG93ZXJzX2NvdW50LicgZm9sbG93ZXJzJywkdHdpdHRlclVzZXJVUkwuJy9mb2xsb3dlcnMn
KQogICAgICAgICAgICAuJywgJy5ocmVmKCR0d2l0dGVyVXNlci0+c3RhdHVzZXNfY291bnQu
JyB1cGRhdGVzJywkdHdpdHRlclVzZXJVUkwpKSkpCiAgICAgICAgICAgIC50cih0ZChmb3Jt
KAogICAgICAgICAgICBncmFmKCJVcGRhdGUgVHdpdHRlci4uLjxzcGFuIGlkPSd0d2VldGNv
dW50JyBzdHlsZT0nZm9udC13ZWlnaHQ6Ym9sZDtmbG9hdDpyaWdodDsnPjE0MDwvc3Bhbj4i
KQogICAgICAgICAgICAudGV4dF9hcmVhKCdtZXNzYWdlJywnNTAnLCc1NTAnLCcnLCdtZXNz
YWdlJykKICAgICAgICAgICAgLmVJbnB1dCgnYXJjX2FkbWluX3R3aXR0ZXInKQogICAgICAg
ICAgICAuc0lucHV0KCd0d2VldCcpLmJyCiAgICAgICAgICAgIC5mSW5wdXQoJ3N1Ym1pdCcs
J3VwZGF0ZScsZ1R4dCgnVXBkYXRlJyksJ3B1Ymxpc2gnKQogICAgICAgICkpKQogICAgICAg
IC5lbmRUYWJsZSgpOwoKICAgIC8vIEF0dGFjaCByZWNlbnQgVHdpdHRlciB1cGRhdGVzCgog
ICAgJGh0bWwuPSBzdGFydFRhYmxlKCdsaXN0JywnJywnJywnJywnOTAlJykKICAgICAgICAu
JG91dAogICAgICAgIC5lbmRUYWJsZSgpOwoKICAgIC8vIE91dHB1dCBKYXZhU2NyaXB0IGFu
ZCBIVE1MCgogICAgZWNobyAkanMuJGh0bWw7Cn0KCi8vIEFkZCBUd2l0dGVyIG9wdGlvbnMg
dG8gYXJ0aWNsZSBhcnRpY2xlIHNjcmVlbgpmdW5jdGlvbiBhcmNfYXBwZW5kX3R3aXR0ZXIo
JGV2ZW50LCAkc3RlcCwgJGRhdGEsICRyczEpCnsKICAgIGdsb2JhbCAkcHJlZnMsICRhcmNf
dHdpdHRlcjsKICAgICRwcmVmaXggPSB0cmltKGdwcygnYXJjX3R3aXR0ZXJfcHJlZml4Jykp
OwogICAgJHByZWZpeCA9ICgkcHJlZml4KSA/ICRwcmVmaXggOiAkcHJlZnNbJ2FyY190d2l0
dGVyX3ByZWZpeCddOwogICAgJHN1ZmZpeCA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9zdWZm
aXgnKSk7CgogICAgaWYgKCRyczFbJ0lEJ10pIHsKICAgICAgICAkc3FsID0gIlNFTEVDVCB0
d2VldF9pZCx0d2VldCBGUk9NICIuUEZYLiJhcmNfdHdpdHRlciBXSEVSRSBhcnRpY2xlX2lk
PSIuJHJzMVsnSUQnXS4iOyI7CiAgICAgICAgJHJzMiA9IHNhZmVfcXVlcnkoJHNxbCk7ICRy
czIgPSBuZXh0Um93KCRyczIpOwogICAgfSBlbHNlIHsgLy8gbmV3IGFydGljbGUKICAgICAg
ICAkcnMyID0gJyc7CiAgICB9CgogICAgaWYgKCRyczFbJ0lEJ10gJiYgJHJzMlsndHdlZXRf
aWQnXSkgewogICAgICAgICRjb250ZW50ID0gYXJjX1R3aXR0ZXI6Om1ha2VMaW5rcygkcnMy
Wyd0d2VldCddKTsKICAgICAgICByZXR1cm4gJGRhdGEuZmllbGRzZXQoJGNvbnRlbnQsICdU
d2l0dGVyIHVwZGF0ZScsICdhcmNfdHdpdHRlcicpOwogICAgfSBlbHNlIHsKICAgICAgICAk
dmFyID0gKCRyczFbJ0lEJ10pID8gMCA6ICRwcmVmc1snYXJjX3R3aXR0ZXJfdHdlZXRfZGVm
YXVsdCddOwogICAgICAgICRjb250ZW50ICA9IHRhZyh5ZXNub1JhZGlvKCdhcmNfdHdlZXRf
dGhpcycsICR2YXIsICcnLCAnYXJjX3R3ZWV0X3RoaXMnKSwncCcpOwogICAgICAgICRjb250
ZW50IC49IHRhZyhocmVmKCdPcHRpb25zJywnI2FyY190d2l0dGVyX29wdGlvbnMnKSwncCcs
JyBjbGFzcz0icGxhaW4gbGV2ZXIiIHN0eWxlPSJtYXJnaW4tdG9wOjVweDsiJyk7CiAgICAg
ICAgJGNvbnRlbnQgLj0gdGFnKHRhZyh0YWcoJ1R3ZWV0IHByZWZpeCcsJ2xhYmVsJywgJyBm
b3I9ImFyY190d2l0dGVyX3ByZWZpeCInKQogICAgICAgICAgICAuZklucHV0KCd0ZXh0Jywn
YXJjX3R3aXR0ZXJfcHJlZml4JywkcHJlZml4LCdlZGl0JywnJywnJywnMjInLCcnLCdhcmNf
dHdpdHRlcl9wcmVmaXgnKSwncCcpCiAgICAgICAgICAgIC50YWcodGFnKCdUd2VldCBzdWZm
aXggKGVnICNoYXNodGFncyknLCdsYWJlbCcsICcgZm9yPSJhcmNfdHdpdHRlcl9zdWZmaXgi
JykKICAgICAgICAgICAgLmZJbnB1dCgndGV4dCcsJ2FyY190d2l0dGVyX3N1ZmZpeCcsJHN1
ZmZpeCwnZWRpdCcsJycsJycsJzIyJywnJywnYXJjX3R3aXR0ZXJfc3VmZml4JyksJ3AnKQog
ICAgICAgICAgICAsJ2RpdicsJyBpZD0iYXJjX3R3aXR0ZXJfb3B0aW9ucyIgY2xhc3M9InRv
Z2dsZSIgc3R5bGU9ImRpc3BsYXk6bm9uZSInKTsKICAgICAgICBpZiAoaXNzZXQoJGFyY190
d2l0dGVyWydlcnJvciddKSkgewogICAgICAgICAgICAkY29udGVudCAuPSAnPHA+Jy4kYXJj
X3R3aXR0ZXJbJ2Vycm9yJ10uJzwvcD4nOwogICAgICAgIH0KICAgICAgICByZXR1cm4gJGRh
dGEuZmllbGRzZXQoJGNvbnRlbnQsICdVcGRhdGUgVHdpdHRlcicsICdhcmNfdHdpdHRlcicp
OwogICAgfQoKfQoKLy8gVXBkYXRlIFR3aXR0ZXIgd2l0aCBwb3N0ZWQgYXJ0aWNsZQpmdW5j
dGlvbiBhcmNfYXJ0aWNsZV90d2VldCgkZXZlbnQsJHN0ZXApCnsKICAgIGdsb2JhbCAkcHJl
ZnMsICRhcmNfdHdpdHRlciwgJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgLCAk
YXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQ7CgogICAgJGFydGljbGVfaWQgPSBlbXB0eSgk
R0xPQkFMU1snSUQnXSkgPyBncHMoJ0lEJykgOiAkR0xPQkFMU1snSUQnXTsKICAgIGlmICgh
ZW1wdHkoJGFydGljbGVfaWQpKSB7CgogICAgICAgIGluY2x1ZGVfb25jZSB0eHBhdGguJy9w
dWJsaXNoL3RhZ2hhbmRsZXJzLnBocCc7CgogICAgICAgICRhcnRpY2xlID0gc2FmZV9yb3co
IklELCBUaXRsZSwgU2VjdGlvbiwgUG9zdGVkIiwgJ3RleHRwYXR0ZXJuJywKICAgICAgICAg
ICAgIklEPXskYXJ0aWNsZV9pZH0gQU5EIFN0YXR1cz00IEFORCBub3coKT49UG9zdGVkIik7
CgogICAgICAgIGlmICgkYXJ0aWNsZSAmJiBncHMoJ2FyY190d2VldF90aGlzJykpIHsgLy8g
dHdlZXQgYXJ0aWNsZQoKICAgICAgICAgICAgLy8gTmVlZCB0byBtYW51YWxseSB1cGRhdGUg
dGhlICdVUkwgb25seSB0aXRsZScgYmVmb3JlIGJ1aWxkaW5nIHRoZQogICAgICAgICAgICAv
LyBVUkwKICAgICAgICAgICAgJGFydGljbGVbJ3VybF90aXRsZSddID0gZ3BzKCd1cmxfdGl0
bGUnKTsKICAgICAgICAgICAgLy8gTWFrZSBzaG9ydCBVUkwKICAgICAgICAgICAgJHVybCA9
IHBlcm1saW5rdXJsKCRhcnRpY2xlKTsKICAgICAgICAgICAgJHNob3J0X3VybCA9IGFyY19z
aG9ydGVuX3VybCgkdXJsLCRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddLAogICAg
ICAgICAgICAgICAgYXJyYXkoJ2lkJz0+JGFydGljbGVfaWQpKTsKCiAgICAgICAgICAgIGlm
ICghJHNob3J0X3VybCkgeyAvLyBGYWlsZWQgdG8gb2J0YWluIGEgc2hvcnRlbmVkIFVSTCwg
ZG8gbm90IHR3ZWV0IQogICAgICAgICAgICAgICAgJGFyY190d2l0dGVyWydlcnJvciddID0g
J1VuYWJsZSB0byBvYnRhaW4gYSBzaG9ydCBVUkwgZm9yIHRoaXMgYXJ0aWNsZS4nOwoKICAg
ICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAg
Ly8gQ29uc3RydWN0IFR3aXR0ZXIgdXBkYXRlCiAgICAgICAgICAgICRwcmVmaXggID0gdHJp
bShncHMoJ2FyY190d2l0dGVyX3ByZWZpeCcpKTsKICAgICAgICAgICAgJHByZV9sZW4gPSBz
dHJsZW4oJHByZWZpeCk7CiAgICAgICAgICAgICRwcmVmaXggID0gKCRwcmVmaXggJiYgJHBy
ZV9sZW48PTIwKSA/ICRwcmVmaXguJyAnIDogJyc7CiAgICAgICAgICAgICRzdWZmaXggID0g
dHJpbShncHMoJ2FyY190d2l0dGVyX3N1ZmZpeCcpKTsKICAgICAgICAgICAgJHN1Zl9sZW4g
PSBzdHJsZW4oJHN1ZmZpeCk7CiAgICAgICAgICAgICRzdWZmaXggID0gKCRzdWZmaXggJiYg
JHN1Zl9sZW48PTQwKSA/ICcgJy4kc3VmZml4IDogJyc7CiAgICAgICAgICAgICR1cmxfbGVu
ID0gc3RybGVuKCRzaG9ydF91cmwpKzE7IC8vIGNvdW50IFVSTCBsZW5ndGggKyAxIGZvciBw
cmVmaXhlZCBzcGFjZQogICAgICAgICAgICBpZiAoJHByZWZpeCkgJHByZV9sZW4gKz0gMTsK
ICAgICAgICAgICAgaWYgKCRzdWZmaXgpICRzdWZfbGVuICs9IDE7CiAgICAgICAgICAgIGlm
ICgoc3RybGVuKCRhcnRpY2xlWydUaXRsZSddKSskdXJsX2xlbiskcHJlX2xlbiskc3VmX2xl
bik+MTQwKSB7CiAgICAgICAgICAgICAgICAkYXJ0aWNsZVsnVGl0bGUnXSA9IHN1YnN0cigk
YXJ0aWNsZVsnVGl0bGUnXSwwLDEzNS0kdXJsX2xlbi0kcHJlX2xlbi0kc3VmX2xlbikuJy4u
Lic7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJHR3ZWV0ID0gJHByZWZpeC4kYXJ0aWNs
ZVsnVGl0bGUnXS4iICIuJHNob3J0X3VybC4kc3VmZml4OwoKICAgICAgICAgICAgLy8gVXBk
YXRlIFR3aXR0ZXIKICAgICAgICAgICAgJHR3aXQgPSBuZXcgYXJjX3R3aXR0ZXIoJGFyY190
d2l0dGVyX2NvbnN1bWVyS2V5CiAgICAgICAgICAgICAgICAsICRhcmNfdHdpdHRlcl9jb25z
dW1lclNlY3JldCwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddCiAgICAgICAg
ICAgICAgICAsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSk7CiAg
ICAgICAgICAgICRyZXN1bHQgPSAkdHdpdC0+cG9zdCgnc3RhdHVzZXMvdXBkYXRlJywgYXJy
YXkoJ3N0YXR1cycgPT4gJHR3ZWV0KSk7CgogICAgICAgICAgICAkdHdlZXRfaWQgPSAoaXNf
b2JqZWN0KCRyZXN1bHQpKSA/ICRyZXN1bHRbMF0tPmlkIDogMDsKCiAgICAgICAgICAgIGlm
ICgkdHdlZXRfaWQpIHsKCiAgICAgICAgICAgICAgICAkdHdlZXQgPSBhZGRzbGFzaGVzKCR0
d2VldCk7CgogICAgICAgICAgICAgICAgLy8gdXBkYXRlIGFyY190d2l0dGVyIHRhYmxlIHdp
dGggdHdlZXQKICAgICAgICAgICAgICAgICRzcWwgPSAiSU5TRVJUIElOVE8gIi5QRlguImFy
Y190d2l0dGVyIChhcnRpY2xlX2lkLHR3ZWV0X2lkLHR3ZWV0LHRpbnl1cmwpICI7CiAgICAg
ICAgICAgICAgICAkc3FsLj0gIlZBTFVFUygkYXJ0aWNsZV9pZCwkdHdlZXRfaWQsXCIkdHdl
ZXRcIiwnJHNob3J0X3VybCcpOyI7CiAgICAgICAgICAgICAgICBzYWZlX3F1ZXJ5KCRzcWwp
OwoKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgICAgICAgfSBlbHNlIHsK
CiAgICAgICAgICAgICAgICAkYXJjX3R3aXR0ZXJbJ2Vycm9yJ10gPSAnVHdpdHRlciByZXNw
b25zZTogJwogICAgICAgICAgICAgICAgICAgIC4kdHdpdC0+aHR0cF9jb2RlOwogICAgICAg
ICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAgfQoKICAgICAgICB9CgogICAg
fQoKICAgIHJldHVybiBmYWxzZTsKCn0KCi8qCiAqIFNob3J0ZW4gVVJMcyB1c2luZyB2YXJp
b3VzIG1ldGhvZHMKICovCgpmdW5jdGlvbiBhcmNfc2hvcnRlbl91cmwoJHVybCwgJG1ldGhv
ZD0nJywgJGF0dHM9YXJyYXkoKSkKewogIGdsb2JhbCAkcHJlZnM7CgogICRjaCA9IGN1cmxf
aW5pdCgpOwogIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9IRUFERVIsIDApOwogIGN1cmxf
c2V0b3B0KCRjaCwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgdHJ1ZSk7CiAgY3VybF9zZXRv
cHQoJGNoLCBDVVJMT1BUX1RJTUVPVVQsIDEwKTsKCiAgc3dpdGNoICgkbWV0aG9kKSB7CiAg
ICBjYXNlICdzbWQnOiAvLyBjcmVhdGUgYSBzaG9ydGVuZWQgVVJMIHVzaW5nIFNNRCBTaG9y
dCBVUkwKICAgICAgcmV0dXJuICgkYXR0c1snaWQnXSkgPyBodS4kYXR0c1snaWQnXSA6IGZh
bHNlOyBicmVhazsKICAgIGNhc2UgJ2FyY190d2l0dGVyJzogLy8gbmF0aXZlIFVSTCBzaG9y
dGVuaW5nCgogICAgICByZXR1cm4gKCRhdHRzWydpZCddKSA/IFBST1RPQ09MLiRwcmVmc1sn
YXJjX3Nob3J0X3NpdGVfdXJsJ10uJy8nLiRhdHRzWydpZCddIDogZmFsc2U7CiAgICAgIGJy
ZWFrOwoKICAgIGNhc2UgJ2lzZ2QnOgoKICAgICAgJHUgPSAnaHR0cDovL2lzLmdkL2FwaS5w
aHA/bG9uZ3VybD0nLnVybGVuY29kZSgkdXJsKTsKICAgICAgY3VybF9zZXRvcHQoJGNoLCBD
VVJMT1BUX1VSTCwgJHUpOwoKICAgICAgJHRpbnl1cmwgPSBjdXJsX2V4ZWMoJGNoKTsKICAg
ICAgaWYgKCR0aW55dXJsIT0nRXJyb3InICYmICR0aW55dXJsIT0nJykgewogICAgICAgIHJl
dHVybiAkdGlueXVybDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0cmlnZ2VyX2Vycm9yKCdh
cmNfdHdpdHRlciBmYWlsZWQgdG8gZ2V0IGEgaXMuZ2QgVVJMIGZvciAnCiAgICAgICAgICAg
IC4kdXJsLEVfVVNFUl9XQVJOSU5HKTsKICAgICAgfQogICAgICBicmVhazsKCiAgICBjYXNl
ICd0aW55dXJsJzogZGVmYXVsdDogLy8gY3JlYXRlIGEgc2hvcnRlbmVkIFVSTCB1c2luZyBU
aW55VVJMCgogICAgICAkdSA9ICdodHRwOi8vdGlueXVybC5jb20vYXBpLWNyZWF0ZS5waHA/
dXJsPScudXJsZW5jb2RlKCR1cmwpOwogICAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRf
VVJMLCAkdSk7CiAgICAgICR0aW55dXJsID0gY3VybF9leGVjKCRjaCk7CiAgICAgIGlmICgk
dGlueXVybCE9J0Vycm9yJyAmJiAkdGlueXVybCE9JycpIHsKICAgICAgICByZXR1cm4gJHRp
bnl1cmw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdHJpZ2dlcl9lcnJvcignYXJjX3R3aXR0
ZXIgZmFpbGVkIHRvIGdldCBhIFRpbnlVUkwgZm9yICcuJHVybCxFX1VTRVJfV0FSTklORyk7
CiAgICAgIH0KCiAgfQoKICByZXR1cm4gZmFsc2U7IC8vIGZhaWwKCn0KCi8qCiAqIFNob3J0
ZW5lZCBVUkwgcmVkaXJlY3QgYmFzZWQgb24gc21kX3Nob3J0X3VybAogKi8KZnVuY3Rpb24g
YXJjX3Nob3J0X3VybF9yZWRpcmVjdCgkZXZlbnQsICRzdGVwKSB7CiAgZ2xvYmFsICRwcmVm
czsKCiAgJGhhdmVfaWQgPSAwOwoKICAvLyBDaGVjayBpZiB0aGVyZSBpcyBhbiBhdmFpbGFi
bGUgc2hvcnQgc2l0ZSB1cmwgYW5kIGlmIGl0IGlzIGJlaW5nIHVzZWQgaW4KICAvLyB0aGlz
IGluc3RhbmNlCiAgJHNob3J0X3NpdGVfdXJsID0gJHByZWZzWydhcmNfc2hvcnRfc2l0ZV91
cmwnXTsKICBpZiAoJHNob3J0X3NpdGVfdXJsKSB7CiAgICAkc2hvcnRfc2l0ZV91cmwgPSBQ
Uk9UT0NPTC4kc2hvcnRfc2l0ZV91cmwuJy8nOwogICAgJHVybF9wYXJ0cyA9IHBhcnNlX3Vy
bCgkc2hvcnRfc2l0ZV91cmwpOwogICAgJHJlID0gJyNeJy4kdXJsX3BhcnRzWydwYXRoJ10u
JyhbMC05XS4qKSMnOwogICAgJGhhdmVfaWQgPSBwcmVnX21hdGNoKCRyZSwgJF9TRVJWRVJb
J1JFUVVFU1RfVVJJJ10sICRtKTsKICB9CgogIC8vIEZhbGwgYmFjayB0byBzdGFuZGFyZCBz
aXRlIHVybCAoc21kX3Nob3J0X3VybCBiZWhhdmlvdXIpCiAgaWYgKCRoYXZlX2lkKSB7CiAg
ICAkdXJsX3BhcnRzID0gcGFyc2VfdXJsKGh1KTsKICAgICRyZSA9ICcjXicuJHVybF9wYXJ0
c1sncGF0aCddLicoWzAtOV0uKikjJzsKICAgICRoYXZlX2lkID0gcHJlZ19tYXRjaCgkcmUs
ICRfU0VSVkVSWydSRVFVRVNUX1VSSSddLCAkbSk7CiAgfQoKICAvLyBEbyB0aGUgcmVkaXJl
Y3QgaWYgd2UndmUgZ290IGFuIGFydGljbGUgaWQKICBpZiAoJGhhdmVfaWQpIHsKCSAgJGlk
ID0gJG1bMV07CgkgICRwZXJtbGluayA9IHBlcm1saW5rdXJsX2lkKCRpZCk7CgoJICBpZiAo
JHBlcm1saW5rKSB7CgkJICBvYl9lbmRfY2xlYW4oKTsKCgkJICAvLyBTdHVwaWQsIG92ZXIg
dGhlIHRvcCBoZWFkZXIgc2V0dGluZyBmb3IgSUUKCQkgIGhlYWRlcigiU3RhdHVzOiAzMDEi
KTsKCQkgIGhlYWRlcigiSFRUUC8xLjAgMzAxIE1vdmVkIFBlcm1hbmVudGx5Iik7CgkJICBo
ZWFkZXIoIkxvY2F0aW9uOiAiLiRwZXJtbGluaywgVFJVRSwgMzAxKTsKCgkJICAvLyBJbiBj
YXNlIHRoZSBoZWFkZXIoKSBtZXRob2QgZmFpbHMsIGZhbGwgYmFjayBvbiBhIGNsYXNzaWMg
cmVkaXJlY3QKCQkgIGVjaG8gJzxodG1sPjxoZWFkPjxNRVRBIEhUVFAtRVFVSVY9IlJlZnJl
c2giIENPTlRFTlQ9IjA7VVJMPScKCQkgICAgLiRwZXJtbGluay4nIj48L2hlYWQ+PGJvZHk+
PC9ib2R5PjwvaHRtbD4nOwoJCSAgZGllKCk7CgkgIH0KICB9Cgp9CgovKgogKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKgoqLwoKY2xhc3MgYXJjX3R3aXR0ZXIgZXh0ZW5kcyBUd2l0dGVy
T0F1dGggewogICAgLy8gQ2FjaGluZyB2YXJpYWJsZXMKICAgIHByaXZhdGUgJF9jYWNoZSA9
IHRydWU7CiAgICBwcml2YXRlICRfY2FjaGVfZGlyID0gJy4vdG1wJzsKICAgIHByaXZhdGUg
JF9jYWNoZV90aW1lID0gMTgwMDsgLy8gMzAgbWludXRlIGNhY2hlCgogICAgZnVuY3Rpb24g
X19jb25zdHJ1Y3QoJGNvbnN1bWVyX2tleSwgJGNvbnN1bWVyX3NlY3JldCwgJG9hdXRoX3Rv
a2VuID0gTlVMTAogICAgICAgICwgJG9hdXRoX3Rva2VuX3NlY3JldCA9IE5VTEwpCiAgICB7
CiAgICAgICAgcGFyZW50OjpfX2NvbnN0cnVjdCgkY29uc3VtZXJfa2V5LCAkY29uc3VtZXJf
c2VjcmV0LCAkb2F1dGhfdG9rZW4KICAgICAgICAgICAgLCAkb2F1dGhfdG9rZW5fc2VjcmV0
KTsKICAgICAgICAkdGhpcy0+Zm9ybWF0ID0gJ3htbCc7CiAgICAgICAgJHRoaXMtPnRpbWVv
dXQgPSAxNTsKICAgICAgICAkdGhpcy0+Y29ubmVjdHRpbWVvdXQgPSAxNTsKICAgIH0KCiAg
ICBwdWJsaWMgZnVuY3Rpb24gY2FsbGJhY2tVUkwoJGV2ZW50LCRzdGVwKQogICAgewogICAg
ICAgIHJldHVybiBodS4ndGV4dHBhdHRlcm4vaW5kZXgucGhwP2V2ZW50PScuJGV2ZW50Licm
YW1wO3N0ZXA9Jy4kc3RlcDsKICAgIH0KCiAgICAvLyBjcmVhdGUgVHdpdHRlciBhbmQgZXh0
ZXJuYWwgbGlua3MgaW4gdGV4dAogICAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBtYWtlTGlu
a3MoJHRleHQpCiAgICB7CiAgICAgICAgJHVybCA9ICcvXGIoaHR0cHxodHRwc3xmdHApOlwv
XC8oW0EtWjAtOV1bQS1aMC05Xy1dKig/OlwuW0EtWjAtOV1bQS1aMC05Xy1dKikrKTo/KFxk
Kyk/XC8/KFtcL1x3K1wuXSspXGIvaSc7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2Uo
JHVybCwgIjxhIGhyZWY9JyQwJz4kMDwvYT4iLCAkdGV4dCk7CiAgICAgICAgJHVybCA9ICcv
XGIoXnxccyl3d3cuKFthLXpfQS1aMC05XSspKChcLlthLXpdKykrKVxiL2knOwogICAgICAg
ICR0ZXh0ID0gcHJlZ19yZXBsYWNlKCR1cmwsICI8YSBocmVmPSdodHRwOi8vd3d3LiQyJDMn
Pnd3dy4kMiQzPC9hPiIsICR0ZXh0KTsKICAgICAgICAkdGV4dCA9IHByZWdfcmVwbGFjZSgi
LyhefFxzKUAoW2Etel9BLVowLTldKykvIiwKICAgICAgICAgICAgIiQxQDxhIGhyZWY9J2h0
dHA6Ly90d2l0dGVyLmNvbS8kMic+JDI8L2E+IiwkdGV4dCk7CiAgICAgICAgJHRleHQgPSBw
cmVnX3JlcGxhY2UoIi8oXnxccykoXCMoW2Etel9BLVowLTk6Xy1dKykpLyIsCiAgICAgICAg
ICAgICIkMTxhIGhyZWY9J2h0dHA6Ly90d2l0dGVyLmNvbS9zZWFyY2g/cT0lMjMkMyc+JDI8
L2E+IiwkdGV4dCk7CiAgICAgICAgcmV0dXJuICR0ZXh0OwogIH0KCiAgICBwdWJsaWMgZnVu
Y3Rpb24gZ2V0KCR1cmwsICRwYXJhbXMgPSBhcnJheSgpKQogICAgewogICAgICAgICRhcGlf
dXJsID0gbWQ1KCR1cmwudXJsZW5jb2RlKHNlcmlhbGl6ZSgkcGFyYW1zKSkpOwogICAgICAg
ICRkYXRhID0gJyc7CgogICAgICAgIGlmICgkdGhpcy0+X2NhY2hlKSB7IC8vIGNoZWNrIGZv
ciBjYWNoZWQgeG1sCgogICAgICAgICAgICAkZGF0YSA9ICR0aGlzLT5fcmV0cmlldmVDYWNo
ZSgkYXBpX3VybCk7CgogICAgICAgIH0KICAgICAgICBpZiAoZW1wdHkoJGRhdGEpKSB7CiAg
ICAgICAgICAgICRkYXRhID0gcGFyZW50OjpnZXQoJHVybCwgJHBhcmFtcyk7CiAgICAgICAg
ICAgIGlmICgkdGhpcy0+aHR0cF9jb2RlPT09MjAwICYmICR4bWw9c2ltcGxleG1sX2xvYWRf
c3RyaW5nKCRkYXRhKSkgeyAvLyBzYXZlIGNhY2hlCiAgICAgICAgICAgICAgICAkZmlsZSA9
ICR0aGlzLT5fY2FjaGVfZGlyLicvJy4kYXBpX3VybDsKICAgICAgICAgICAgICAgIGZpbGVf
cHV0X2NvbnRlbnRzKCRmaWxlLCRkYXRhLExPQ0tfRVgpOwogICAgICAgICAgICAgICAgcmV0
dXJuICR4bWw7CiAgICAgICAgICAgIH0gZWxzZSB7IC8vIGZhaWxlZCB0byByZXRyaWV2ZSBk
YXRhIGZyb20gVHdpdHRlcgoKICAgICAgICAgICAgICAgIGlmICgkdGhpcy0+X2NhY2hlKSB7
IC8vIGF0dGVtcHQgdG8gZm9yY2UgY2FjaGVkIHhtbCByZXR1cm4KCiAgICAgICAgICAgICAg
ICAgICAgJGRhdGEgPSAkdGhpcy0+X3JldHJpZXZlQ2FjaGUoJGFwaV91cmwsdHJ1ZSk7CiAg
ICAgICAgICAgICAgICAgICAgaWYgKCRkYXRhKSByZXR1cm4gQHNpbXBsZXhtbF9sb2FkX3N0
cmluZygkZGF0YSk7CgogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVy
biBmYWxzZTsKCiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgeyAvLyByZXR1cm4gY2Fj
aGVkIHhtbAogICAgICAgICAgICByZXR1cm4gQHNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0
YSk7CiAgICAgICAgfQogICAgfSAvL2VuZCBnZXQoKQoKICAgIGZ1bmN0aW9uIHBvc3QoJHVy
bCwgJHBhcmFtcyA9IGFycmF5KCkpCiAgICB7CiAgICAgICAgJGRhdGEgPSBwYXJlbnQ6OnBv
c3QoJHVybCwkcGFyYW1zKTsKICAgICAgICByZXR1cm4gc2ltcGxleG1sX2xvYWRfc3RyaW5n
KCRkYXRhKTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWxldGUoJHVybCwgJHBhcmFtcyA9IGFy
cmF5KCkpCiAgICB7CiAgICAgICAgJGRhdGEgPSBwYXJlbnQ6OmRlbGV0ZSgkdXJsLCRwYXJh
bXMpOwogICAgICAgIHJldHVybiBzaW1wbGV4bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwogICAg
fQoKICAgIC8vIENhY2hlIG1ldGhvZHMKCiAgICBwdWJsaWMgZnVuY3Rpb24gc2V0Q2FjaGlu
ZygkY2FjaGU9dHJ1ZSkKICAgIHsKICAgICAgICAkdGhpcy0+X2NhY2hlID0gKCRjYWNoZSkg
PyB0cnVlIDogZmFsc2U7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHVibGlj
IGZ1bmN0aW9uIGNhY2hlRGlyKCRsb2MpCiAgICB7CiAgICAgICAgJHRoaXMtPl9jYWNoZV9k
aXIgPSAkbG9jOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHB1YmxpYyBmdW5j
dGlvbiBjYWNoZVRpbWUoJG1pbnMpCiAgICB7CiAgICAgICAgJHRoaXMtPl9jYWNoZV90aW1l
ID0gJG1pbnMqNjA7IC8vIGNvbnZlcnQgbWludXRlcyBpbnRvIHNlY29uZHMKICAgICAgICBy
ZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcml2YXRlIGZ1bmN0aW9uIF9yZXRyaWV2ZUNhY2hl
KCR1cmwsJG92ZXJpZGVfdGltZW91dD1mYWxzZSkKICAgIHsKICAgICAgICAkZmlsZSA9ICR0
aGlzLT5fY2FjaGVfZGlyLicvJy4kdXJsOwogICAgICAgIGlmIChmaWxlX2V4aXN0cygkZmls
ZSkpIHsKCiAgICAgICAgICAgICRkaWZmID0gdGltZSgpIC0gZmlsZW10aW1lKCRmaWxlKTsK
ICAgICAgICAgICAgaWYgKCRvdmVyaWRlX3RpbWVvdXQgfHwgJGRpZmYgPCAkdGhpcy0+X2Nh
Y2hlX3RpbWUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmaWxlX2dldF9jb250ZW50cygk
ZmlsZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFs
c2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJu
IGZhbHNlOwogICAgICAgIH0KICAgIH0KfQoKLyoKICogQWJyYWhhbSBXaWxsaWFtcyAoYWJy
YWhhbUBhYnJhaC5hbSkgaHR0cDovL2FicmFoLmFtCiAqCiAqIFRoZSBmaXJzdCBQSFAgTGli
cmFyeSB0byBzdXBwb3J0IE9BdXRoIGZvciBUd2l0dGVyJ3MgUkVTVCBBUEkuCiAqLwoKLyoq
CiAqIFR3aXR0ZXIgT0F1dGggY2xhc3MKICovCmNsYXNzIFR3aXR0ZXJPQXV0aCB7CiAgLyog
Q29udGFpbnMgdGhlIGxhc3QgSFRUUCBzdGF0dXMgY29kZSByZXR1cm5lZC4gKi8KICBwdWJs
aWMgJGh0dHBfY29kZTsKICAvKiBDb250YWlucyB0aGUgbGFzdCBBUEkgY2FsbC4gKi8KICBw
dWJsaWMgJHVybDsKICAvKiBTZXQgdXAgdGhlIEFQSSByb290IFVSTC4gKi8KICBwdWJsaWMg
JGhvc3QgPSAiaHR0cHM6Ly9hcGkudHdpdHRlci5jb20vMS8iOwogIC8qIFNldCB0aW1lb3V0
IGRlZmF1bHQuICovCiAgcHVibGljICR0aW1lb3V0ID0gMzA7CiAgLyogU2V0IGNvbm5lY3Qg
dGltZW91dC4gKi8KICBwdWJsaWMgJGNvbm5lY3R0aW1lb3V0ID0gMzA7CiAgLyogVmVyaWZ5
IFNTTCBDZXJ0LiAqLwogIHB1YmxpYyAkc3NsX3ZlcmlmeXBlZXIgPSBGQUxTRTsKICAvKiBS
ZXNwb25zIGZvcm1hdC4gKi8KICBwdWJsaWMgJGZvcm1hdCA9ICdqc29uJzsKICAvKiBEZWNv
ZGUgcmV0dXJuZWQganNvbiBkYXRhLiAqLwogIHB1YmxpYyAkZGVjb2RlX2pzb24gPSBUUlVF
OwogIC8qIENvbnRhaW5zIHRoZSBsYXN0IEhUVFAgaGVhZGVycyByZXR1cm5lZC4gKi8KICBw
dWJsaWMgJGh0dHBfaW5mbzsKICAvKiBTZXQgdGhlIHVzZXJhZ25ldC4gKi8KICBwdWJsaWMg
JHVzZXJhZ2VudCA9ICdUd2l0dGVyT0F1dGggdjAuMi4wLWJldGEyJzsKICAvKiBJbW1lZGlh
dGVseSByZXRyeSB0aGUgQVBJIGNhbGwgaWYgdGhlIHJlc3BvbnNlIHdhcyBub3Qgc3VjY2Vz
c2Z1bC4gKi8KICAvL3B1YmxpYyAkcmV0cnkgPSBUUlVFOwoKCgoKICAvKioKICAgKiBTZXQg
QVBJIFVSTFMKICAgKi8KICBmdW5jdGlvbiBhY2Nlc3NUb2tlblVSTCgpICB7IHJldHVybiAn
aHR0cHM6Ly9hcGkudHdpdHRlci5jb20vb2F1dGgvYWNjZXNzX3Rva2VuJzsgfQogIGZ1bmN0
aW9uIGF1dGhlbnRpY2F0ZVVSTCgpIHsgcmV0dXJuICdodHRwczovL3R3aXR0ZXIuY29tL29h
dXRoL2F1dGhlbnRpY2F0ZSc7IH0KICBmdW5jdGlvbiBhdXRob3JpemVVUkwoKSAgICB7IHJl
dHVybiAnaHR0cHM6Ly90d2l0dGVyLmNvbS9vYXV0aC9hdXRob3JpemUnOyB9CiAgZnVuY3Rp
b24gcmVxdWVzdFRva2VuVVJMKCkgeyByZXR1cm4gJ2h0dHBzOi8vYXBpLnR3aXR0ZXIuY29t
L29hdXRoL3JlcXVlc3RfdG9rZW4nOyB9CgogIC8qKgogICAqIERlYnVnIGhlbHBlcnMKICAg
Ki8KICBmdW5jdGlvbiBsYXN0U3RhdHVzQ29kZSgpIHsgcmV0dXJuICR0aGlzLT5odHRwX3N0
YXR1czsgfQogIGZ1bmN0aW9uIGxhc3RBUElDYWxsKCkgeyByZXR1cm4gJHRoaXMtPmxhc3Rf
YXBpX2NhbGw7IH0KCiAgLyoqCiAgICogY29uc3RydWN0IFR3aXR0ZXJPQXV0aCBvYmplY3QK
ICAgKi8KICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkY29uc3VtZXJfa2V5LCAkY29uc3VtZXJf
c2VjcmV0LCAkb2F1dGhfdG9rZW4gPSBOVUxMLCAkb2F1dGhfdG9rZW5fc2VjcmV0ID0gTlVM
TCkgewogICAgJHRoaXMtPnNoYTFfbWV0aG9kID0gbmV3IE9BdXRoU2lnbmF0dXJlTWV0aG9k
X0hNQUNfU0hBMSgpOwogICAgJHRoaXMtPmNvbnN1bWVyID0gbmV3IE9BdXRoQ29uc3VtZXIo
JGNvbnN1bWVyX2tleSwgJGNvbnN1bWVyX3NlY3JldCk7CiAgICBpZiAoIWVtcHR5KCRvYXV0
aF90b2tlbikgJiYgIWVtcHR5KCRvYXV0aF90b2tlbl9zZWNyZXQpKSB7CiAgICAgICR0aGlz
LT50b2tlbiA9IG5ldyBPQXV0aENvbnN1bWVyKCRvYXV0aF90b2tlbiwgJG9hdXRoX3Rva2Vu
X3NlY3JldCk7CiAgICB9IGVsc2UgewogICAgICAkdGhpcy0+dG9rZW4gPSBOVUxMOwogICAg
fQogIH0KCgogIC8qKgogICAqIEdldCBhIHJlcXVlc3RfdG9rZW4gZnJvbSBUd2l0dGVyCiAg
ICoKICAgKiBAcmV0dXJucyBhIGtleS92YWx1ZSBhcnJheSBjb250YWluaW5nIG9hdXRoX3Rv
a2VuIGFuZCBvYXV0aF90b2tlbl9zZWNyZXQKICAgKi8KICBmdW5jdGlvbiBnZXRSZXF1ZXN0
VG9rZW4oJG9hdXRoX2NhbGxiYWNrID0gTlVMTCkgewogICAgJHBhcmFtZXRlcnMgPSBhcnJh
eSgpOwogICAgaWYgKCFlbXB0eSgkb2F1dGhfY2FsbGJhY2spKSB7CiAgICAgICRwYXJhbWV0
ZXJzWydvYXV0aF9jYWxsYmFjayddID0gJG9hdXRoX2NhbGxiYWNrOwogICAgfQogICAgJHJl
cXVlc3QgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR0aGlzLT5yZXF1ZXN0VG9rZW5VUkwoKSwg
J0dFVCcsICRwYXJhbWV0ZXJzKTsKICAgICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFyc2VfcGFy
YW1ldGVycygkcmVxdWVzdCk7CiAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1l
cigkdG9rZW5bJ29hdXRoX3Rva2VuJ10sICR0b2tlblsnb2F1dGhfdG9rZW5fc2VjcmV0J10p
OwogICAgcmV0dXJuICR0b2tlbjsKICB9CgogIC8qKgogICAqIEdldCB0aGUgYXV0aG9yaXpl
IFVSTAogICAqCiAgICogQHJldHVybnMgYSBzdHJpbmcKICAgKi8KICBmdW5jdGlvbiBnZXRB
dXRob3JpemVVUkwoJHRva2VuLCAkc2lnbl9pbl93aXRoX3R3aXR0ZXIgPSBUUlVFKSB7CiAg
ICBpZiAoaXNfYXJyYXkoJHRva2VuKSkgewogICAgICAkdG9rZW4gPSAkdG9rZW5bJ29hdXRo
X3Rva2VuJ107CiAgICB9CiAgICBpZiAoZW1wdHkoJHNpZ25faW5fd2l0aF90d2l0dGVyKSkg
ewogICAgICByZXR1cm4gJHRoaXMtPmF1dGhvcml6ZVVSTCgpIC4gIj9vYXV0aF90b2tlbj17
JHRva2VufSI7CiAgICB9IGVsc2UgewogICAgICAgcmV0dXJuICR0aGlzLT5hdXRoZW50aWNh
dGVVUkwoKSAuICI/b2F1dGhfdG9rZW49eyR0b2tlbn0iOwogICAgfQogIH0KCiAgLyoqCiAg
ICogRXhjaGFuZ2UgcmVxdWVzdCB0b2tlbiBhbmQgc2VjcmV0IGZvciBhbiBhY2Nlc3MgdG9r
ZW4gYW5kCiAgICogc2VjcmV0LCB0byBzaWduIEFQSSBjYWxscy4KICAgKgogICAqIEByZXR1
cm5zIGFycmF5KCJvYXV0aF90b2tlbiIgPT4gInRoZS1hY2Nlc3MtdG9rZW4iLAogICAqICAg
ICAgICAgICAgICAgICJvYXV0aF90b2tlbl9zZWNyZXQiID0+ICJ0aGUtYWNjZXNzLXNlY3Jl
dCIsCiAgICogICAgICAgICAgICAgICAgInVzZXJfaWQiID0+ICI5NDM2OTkyIiwKICAgKiAg
ICAgICAgICAgICAgICAic2NyZWVuX25hbWUiID0+ICJhYnJhaGFtIikKICAgKi8KICBmdW5j
dGlvbiBnZXRBY2Nlc3NUb2tlbigkb2F1dGhfdmVyaWZpZXIgPSBGQUxTRSkgewogICAgJHBh
cmFtZXRlcnMgPSBhcnJheSgpOwogICAgaWYgKCFlbXB0eSgkb2F1dGhfdmVyaWZpZXIpKSB7
CiAgICAgICRwYXJhbWV0ZXJzWydvYXV0aF92ZXJpZmllciddID0gJG9hdXRoX3ZlcmlmaWVy
OwogICAgfQogICAgJHJlcXVlc3QgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR0aGlzLT5hY2Nl
c3NUb2tlblVSTCgpLCAnR0VUJywgJHBhcmFtZXRlcnMpOwogICAgJHRva2VuID0gT0F1dGhV
dGlsOjpwYXJzZV9wYXJhbWV0ZXJzKCRyZXF1ZXN0KTsKICAgICR0aGlzLT50b2tlbiA9IG5l
dyBPQXV0aENvbnN1bWVyKCR0b2tlblsnb2F1dGhfdG9rZW4nXSwgJHRva2VuWydvYXV0aF90
b2tlbl9zZWNyZXQnXSk7CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAgLyoqCiAgICogT25l
IHRpbWUgZXhjaGFuZ2Ugb2YgdXNlcm5hbWUgYW5kIHBhc3N3b3JkIGZvciBhY2Nlc3MgdG9r
ZW4gYW5kIHNlY3JldC4KICAgKgogICAqIEByZXR1cm5zIGFycmF5KCJvYXV0aF90b2tlbiIg
PT4gInRoZS1hY2Nlc3MtdG9rZW4iLAogICAqICAgICAgICAgICAgICAgICJvYXV0aF90b2tl
bl9zZWNyZXQiID0+ICJ0aGUtYWNjZXNzLXNlY3JldCIsCiAgICogICAgICAgICAgICAgICAg
InVzZXJfaWQiID0+ICI5NDM2OTkyIiwKICAgKiAgICAgICAgICAgICAgICAic2NyZWVuX25h
bWUiID0+ICJhYnJhaGFtIiwKICAgKiAgICAgICAgICAgICAgICAieF9hdXRoX2V4cGlyZXMi
ID0+ICIwIikKICAgKi8KICBmdW5jdGlvbiBnZXRYQXV0aFRva2VuKCR1c2VybmFtZSwgJHBh
c3N3b3JkKSB7CiAgICAkcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICAkcGFyYW1ldGVyc1sn
eF9hdXRoX3VzZXJuYW1lJ10gPSAkdXNlcm5hbWU7CiAgICAkcGFyYW1ldGVyc1sneF9hdXRo
X3Bhc3N3b3JkJ10gPSAkcGFzc3dvcmQ7CiAgICAkcGFyYW1ldGVyc1sneF9hdXRoX21vZGUn
XSA9ICdjbGllbnRfYXV0aCc7CiAgICAkcmVxdWVzdCA9ICR0aGlzLT5vQXV0aFJlcXVlc3Qo
JHRoaXMtPmFjY2Vzc1Rva2VuVVJMKCksICdQT1NUJywgJHBhcmFtZXRlcnMpOwogICAgJHRv
a2VuID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKCRyZXF1ZXN0KTsKICAgICR0aGlz
LT50b2tlbiA9IG5ldyBPQXV0aENvbnN1bWVyKCR0b2tlblsnb2F1dGhfdG9rZW4nXSwgJHRv
a2VuWydvYXV0aF90b2tlbl9zZWNyZXQnXSk7CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAg
LyoqCiAgICogR0VUIHdyYXBwZXIgZm9yIG9BdXRoUmVxdWVzdC4KICAgKi8KICBmdW5jdGlv
biBnZXQoJHVybCwgJHBhcmFtZXRlcnMgPSBhcnJheSgpKSB7CiAgICAkcmVzcG9uc2UgPSAk
dGhpcy0+b0F1dGhSZXF1ZXN0KCR1cmwsICdHRVQnLCAkcGFyYW1ldGVycyk7CiAgICBpZiAo
JHRoaXMtPmZvcm1hdCA9PT0gJ2pzb24nICYmICR0aGlzLT5kZWNvZGVfanNvbikgewogICAg
ICByZXR1cm4ganNvbl9kZWNvZGUoJHJlc3BvbnNlKTsKICAgIH0KICAgIHJldHVybiAkcmVz
cG9uc2U7CiAgfQoKICAvKioKICAgKiBQT1NUIHdyYXBwZXIgZm9yIG9BdXRoUmVxdWVzdC4K
ICAgKi8KICBmdW5jdGlvbiBwb3N0KCR1cmwsICRwYXJhbWV0ZXJzID0gYXJyYXkoKSkgewog
ICAgJHJlc3BvbnNlID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdXJsLCAnUE9TVCcsICRwYXJh
bWV0ZXJzKTsKICAgIGlmICgkdGhpcy0+Zm9ybWF0ID09PSAnanNvbicgJiYgJHRoaXMtPmRl
Y29kZV9qc29uKSB7CiAgICAgIHJldHVybiBqc29uX2RlY29kZSgkcmVzcG9uc2UpOwogICAg
fQogICAgcmV0dXJuICRyZXNwb25zZTsKICB9CgogIC8qKgogICAqIERFTEVURSB3cmFwcGVy
IGZvciBvQXV0aFJlcWV1c3QuCiAgICovCiAgZnVuY3Rpb24gZGVsZXRlKCR1cmwsICRwYXJh
bWV0ZXJzID0gYXJyYXkoKSkgewogICAgJHJlc3BvbnNlID0gJHRoaXMtPm9BdXRoUmVxdWVz
dCgkdXJsLCAnREVMRVRFJywgJHBhcmFtZXRlcnMpOwogICAgaWYgKCR0aGlzLT5mb3JtYXQg
PT09ICdqc29uJyAmJiAkdGhpcy0+ZGVjb2RlX2pzb24pIHsKICAgICAgcmV0dXJuIGpzb25f
ZGVjb2RlKCRyZXNwb25zZSk7CiAgICB9CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAg
LyoqCiAgICogRm9ybWF0IGFuZCBzaWduIGFuIE9BdXRoIC8gQVBJIHJlcXVlc3QKICAgKi8K
ICBmdW5jdGlvbiBvQXV0aFJlcXVlc3QoJHVybCwgJG1ldGhvZCwgJHBhcmFtZXRlcnMpIHsK
ICAgIGlmIChzdHJycG9zKCR1cmwsICdodHRwczovLycpICE9PSAwICYmIHN0cnJwb3MoJHVy
bCwgJ2h0dHA6Ly8nKSAhPT0gMCkgewogICAgICAkdXJsID0gInskdGhpcy0+aG9zdH17JHVy
bH0ueyR0aGlzLT5mb3JtYXR9IjsKICAgIH0KICAgICRyZXF1ZXN0ID0gT0F1dGhSZXF1ZXN0
Ojpmcm9tX2NvbnN1bWVyX2FuZF90b2tlbigkdGhpcy0+Y29uc3VtZXIsICR0aGlzLT50b2tl
biwgJG1ldGhvZCwgJHVybCwgJHBhcmFtZXRlcnMpOwogICAgJHJlcXVlc3QtPnNpZ25fcmVx
dWVzdCgkdGhpcy0+c2hhMV9tZXRob2QsICR0aGlzLT5jb25zdW1lciwgJHRoaXMtPnRva2Vu
KTsKICAgIHN3aXRjaCAoJG1ldGhvZCkgewogICAgY2FzZSAnR0VUJzoKICAgICAgcmV0dXJu
ICR0aGlzLT5odHRwKCRyZXF1ZXN0LT50b191cmwoKSwgJ0dFVCcpOwogICAgZGVmYXVsdDoK
ICAgICAgcmV0dXJuICR0aGlzLT5odHRwKCRyZXF1ZXN0LT5nZXRfbm9ybWFsaXplZF9odHRw
X3VybCgpLCAkbWV0aG9kLCAkcmVxdWVzdC0+dG9fcG9zdGRhdGEoKSk7CiAgICB9CiAgfQoK
ICAvKioKICAgKiBNYWtlIGFuIEhUVFAgcmVxdWVzdAogICAqCiAgICogQHJldHVybiBBUEkg
cmVzdWx0cwogICAqLwogIGZ1bmN0aW9uIGh0dHAoJHVybCwgJG1ldGhvZCwgJHBvc3RmaWVs
ZHMgPSBOVUxMKSB7CiAgICAkdGhpcy0+aHR0cF9pbmZvID0gYXJyYXkoKTsKICAgICRjaSA9
IGN1cmxfaW5pdCgpOwogICAgLyogQ3VybCBzZXR0aW5ncyAqLwogICAgY3VybF9zZXRvcHQo
JGNpLCBDVVJMT1BUX1VTRVJBR0VOVCwgJHRoaXMtPnVzZXJhZ2VudCk7CiAgICBjdXJsX3Nl
dG9wdCgkY2ksIENVUkxPUFRfQ09OTkVDVFRJTUVPVVQsICR0aGlzLT5jb25uZWN0dGltZW91
dCk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfVElNRU9VVCwgJHRoaXMtPnRpbWVv
dXQpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCBUUlVF
KTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9IVFRQSEVBREVSLCBhcnJheSgnRXhw
ZWN0OicpKTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9TU0xfVkVSSUZZUEVFUiwg
JHRoaXMtPnNzbF92ZXJpZnlwZWVyKTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9I
RUFERVJGVU5DVElPTiwgYXJyYXkoJHRoaXMsICdnZXRIZWFkZXInKSk7CiAgICBjdXJsX3Nl
dG9wdCgkY2ksIENVUkxPUFRfSEVBREVSLCBGQUxTRSk7CgogICAgc3dpdGNoICgkbWV0aG9k
KSB7CiAgICAgIGNhc2UgJ1BPU1QnOgogICAgICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9Q
VF9QT1NULCBUUlVFKTsKICAgICAgICBpZiAoIWVtcHR5KCRwb3N0ZmllbGRzKSkgewogICAg
ICAgICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1BPU1RGSUVMRFMsICRwb3N0ZmllbGRz
KTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ0RFTEVURSc6CiAgICAg
ICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0NVU1RPTVJFUVVFU1QsICdERUxFVEUnKTsK
ICAgICAgICBpZiAoIWVtcHR5KCRwb3N0ZmllbGRzKSkgewogICAgICAgICAgJHVybCA9ICJ7
JHVybH0/eyRwb3N0ZmllbGRzfSI7CiAgICAgICAgfQogICAgfQoKICAgIGN1cmxfc2V0b3B0
KCRjaSwgQ1VSTE9QVF9VUkwsICR1cmwpOwogICAgJHJlc3BvbnNlID0gY3VybF9leGVjKCRj
aSk7CiAgICAkdGhpcy0+aHR0cF9jb2RlID0gY3VybF9nZXRpbmZvKCRjaSwgQ1VSTElORk9f
SFRUUF9DT0RFKTsKICAgICR0aGlzLT5odHRwX2luZm8gPSBhcnJheV9tZXJnZSgkdGhpcy0+
aHR0cF9pbmZvLCBjdXJsX2dldGluZm8oJGNpKSk7CiAgICAkdGhpcy0+dXJsID0gJHVybDsK
ICAgIGN1cmxfY2xvc2UgKCRjaSk7CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoq
CiAgICogR2V0IHRoZSBoZWFkZXIgaW5mbyB0byBzdG9yZS4KICAgKi8KICBmdW5jdGlvbiBn
ZXRIZWFkZXIoJGNoLCAkaGVhZGVyKSB7CiAgICAkaSA9IHN0cnBvcygkaGVhZGVyLCAnOicp
OwogICAgaWYgKCFlbXB0eSgkaSkpIHsKICAgICAgJGtleSA9IHN0cl9yZXBsYWNlKCctJywg
J18nLCBzdHJ0b2xvd2VyKHN1YnN0cigkaGVhZGVyLCAwLCAkaSkpKTsKICAgICAgJHZhbHVl
ID0gdHJpbShzdWJzdHIoJGhlYWRlciwgJGkgKyAyKSk7CiAgICAgICR0aGlzLT5odHRwX2hl
YWRlclska2V5XSA9ICR2YWx1ZTsKICAgIH0KICAgIHJldHVybiBzdHJsZW4oJGhlYWRlcik7
CiAgfQp9CgpjbGFzcyBPQXV0aEV4Y2VwdGlvbiBleHRlbmRzIEV4Y2VwdGlvbiB7CiAgLy8g
cGFzcwp9CgpjbGFzcyBPQXV0aENvbnN1bWVyIHsKICBwdWJsaWMgJGtleTsKICBwdWJsaWMg
JHNlY3JldDsKCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGtleSwgJHNlY3JldCwgJGNhbGxi
YWNrX3VybD1OVUxMKSB7CiAgICAkdGhpcy0+a2V5ID0gJGtleTsKICAgICR0aGlzLT5zZWNy
ZXQgPSAkc2VjcmV0OwogICAgJHRoaXMtPmNhbGxiYWNrX3VybCA9ICRjYWxsYmFja191cmw7
CiAgfQoKICBmdW5jdGlvbiBfX3RvU3RyaW5nKCkgewogICAgcmV0dXJuICJPQXV0aENvbnN1
bWVyW2tleT0kdGhpcy0+a2V5LHNlY3JldD0kdGhpcy0+c2VjcmV0XSI7CiAgfQp9CgpjbGFz
cyBPQXV0aFRva2VuIHsKICAvLyBhY2Nlc3MgdG9rZW5zIGFuZCByZXF1ZXN0IHRva2Vucwog
IHB1YmxpYyAka2V5OwogIHB1YmxpYyAkc2VjcmV0OwoKICAvKioKICAgKiBrZXkgPSB0aGUg
dG9rZW4KICAgKiBzZWNyZXQgPSB0aGUgdG9rZW4gc2VjcmV0CiAgICovCiAgZnVuY3Rpb24g
X19jb25zdHJ1Y3QoJGtleSwgJHNlY3JldCkgewogICAgJHRoaXMtPmtleSA9ICRrZXk7CiAg
ICAkdGhpcy0+c2VjcmV0ID0gJHNlY3JldDsKICB9CgogIC8qKgogICAqIGdlbmVyYXRlcyB0
aGUgYmFzaWMgc3RyaW5nIHNlcmlhbGl6YXRpb24gb2YgYSB0b2tlbiB0aGF0IGEgc2VydmVy
CiAgICogd291bGQgcmVzcG9uZCB0byByZXF1ZXN0X3Rva2VuIGFuZCBhY2Nlc3NfdG9rZW4g
Y2FsbHMgd2l0aAogICAqLwogIGZ1bmN0aW9uIHRvX3N0cmluZygpIHsKICAgIHJldHVybiAi
b2F1dGhfdG9rZW49IiAuCiAgICAgICAgICAgT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4
NigkdGhpcy0+a2V5KSAuCiAgICAgICAgICAgIiZvYXV0aF90b2tlbl9zZWNyZXQ9IiAuCiAg
ICAgICAgICAgT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkdGhpcy0+c2VjcmV0KTsK
ICB9CgogIGZ1bmN0aW9uIF9fdG9TdHJpbmcoKSB7CiAgICByZXR1cm4gJHRoaXMtPnRvX3N0
cmluZygpOwogIH0KfQoKLyoqCiAqIEEgY2xhc3MgZm9yIGltcGxlbWVudGluZyBhIFNpZ25h
dHVyZSBNZXRob2QKICogU2VlIHNlY3Rpb24gOSAoIlNpZ25pbmcgUmVxdWVzdHMiKSBpbiB0
aGUgc3BlYwogKi8KYWJzdHJhY3QgY2xhc3MgT0F1dGhTaWduYXR1cmVNZXRob2QgewogIC8q
KgogICAqIE5lZWRzIHRvIHJldHVybiB0aGUgbmFtZSBvZiB0aGUgU2lnbmF0dXJlIE1ldGhv
ZCAoaWUgSE1BQy1TSEExKQogICAqIEByZXR1cm4gc3RyaW5nCiAgICovCiAgYWJzdHJhY3Qg
cHVibGljIGZ1bmN0aW9uIGdldF9uYW1lKCk7CgogIC8qKgogICAqIEJ1aWxkIHVwIHRoZSBz
aWduYXR1cmUKICAgKiBOT1RFOiBUaGUgb3V0cHV0IG9mIHRoaXMgZnVuY3Rpb24gTVVTVCBO
T1QgYmUgdXJsZW5jb2RlZC4KICAgKiB0aGUgZW5jb2RpbmcgaXMgaGFuZGxlZCBpbiBPQXV0
aFJlcXVlc3Qgd2hlbiB0aGUgZmluYWwKICAgKiByZXF1ZXN0IGlzIHNlcmlhbGl6ZWQKICAg
KiBAcGFyYW0gT0F1dGhSZXF1ZXN0ICRyZXF1ZXN0CiAgICogQHBhcmFtIE9BdXRoQ29uc3Vt
ZXIgJGNvbnN1bWVyCiAgICogQHBhcmFtIE9BdXRoVG9rZW4gJHRva2VuCiAgICogQHJldHVy
biBzdHJpbmcKICAgKi8KICBhYnN0cmFjdCBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2lnbmF0
dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7CgogIC8qKgogICAqIFZlcmlmaWVz
IHRoYXQgYSBnaXZlbiBzaWduYXR1cmUgaXMgY29ycmVjdAogICAqIEBwYXJhbSBPQXV0aFJl
cXVlc3QgJHJlcXVlc3QKICAgKiBAcGFyYW0gT0F1dGhDb25zdW1lciAkY29uc3VtZXIKICAg
KiBAcGFyYW0gT0F1dGhUb2tlbiAkdG9rZW4KICAgKiBAcGFyYW0gc3RyaW5nICRzaWduYXR1
cmUKICAgKiBAcmV0dXJuIGJvb2wKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gY2hlY2tfc2ln
bmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbiwgJHNpZ25hdHVyZSkgewogICAg
JGJ1aWx0ID0gJHRoaXMtPmJ1aWxkX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAk
dG9rZW4pOwogICAgcmV0dXJuICRidWlsdCA9PSAkc2lnbmF0dXJlOwogIH0KfQoKLyoqCiAq
IFRoZSBITUFDLVNIQTEgc2lnbmF0dXJlIG1ldGhvZCB1c2VzIHRoZSBITUFDLVNIQTEgc2ln
bmF0dXJlIGFsZ29yaXRobSBhcyBkZWZpbmVkIGluIFtSRkMyMTA0XQogKiB3aGVyZSB0aGUg
U2lnbmF0dXJlIEJhc2UgU3RyaW5nIGlzIHRoZSB0ZXh0IGFuZCB0aGUga2V5IGlzIHRoZSBj
b25jYXRlbmF0ZWQgdmFsdWVzIChlYWNoIGZpcnN0CiAqIGVuY29kZWQgcGVyIFBhcmFtZXRl
ciBFbmNvZGluZykgb2YgdGhlIENvbnN1bWVyIFNlY3JldCBhbmQgVG9rZW4gU2VjcmV0LCBz
ZXBhcmF0ZWQgYnkgYW4gJyYnCiAqIGNoYXJhY3RlciAoQVNDSUkgY29kZSAzOCkgZXZlbiBp
ZiBlbXB0eS4KICogICAtIENoYXB0ZXIgOS4yICgiSE1BQy1TSEExIikKICovCmNsYXNzIE9B
dXRoU2lnbmF0dXJlTWV0aG9kX0hNQUNfU0hBMSBleHRlbmRzIE9BdXRoU2lnbmF0dXJlTWV0
aG9kIHsKICBmdW5jdGlvbiBnZXRfbmFtZSgpIHsKICAgIHJldHVybiAiSE1BQy1TSEExIjsK
ICB9CgogIHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25z
dW1lciwgJHRva2VuKSB7CiAgICAkYmFzZV9zdHJpbmcgPSAkcmVxdWVzdC0+Z2V0X3NpZ25h
dHVyZV9iYXNlX3N0cmluZygpOwogICAgJHJlcXVlc3QtPmJhc2Vfc3RyaW5nID0gJGJhc2Vf
c3RyaW5nOwoKICAgICRrZXlfcGFydHMgPSBhcnJheSgKICAgICAgJGNvbnN1bWVyLT5zZWNy
ZXQsCiAgICAgICgkdG9rZW4pID8gJHRva2VuLT5zZWNyZXQgOiAiIgogICAgKTsKCiAgICAk
a2V5X3BhcnRzID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4Nigka2V5X3BhcnRzKTsK
ICAgICRrZXkgPSBpbXBsb2RlKCcmJywgJGtleV9wYXJ0cyk7CgogICAgcmV0dXJuIGJhc2U2
NF9lbmNvZGUoaGFzaF9obWFjKCdzaGExJywgJGJhc2Vfc3RyaW5nLCAka2V5LCB0cnVlKSk7
CiAgfQp9CgovKioKICogVGhlIFBMQUlOVEVYVCBtZXRob2QgZG9lcyBub3QgcHJvdmlkZSBh
bnkgc2VjdXJpdHkgcHJvdGVjdGlvbiBhbmQgU0hPVUxEIG9ubHkgYmUgdXNlZAogKiBvdmVy
IGEgc2VjdXJlIGNoYW5uZWwgc3VjaCBhcyBIVFRQUy4gSXQgZG9lcyBub3QgdXNlIHRoZSBT
aWduYXR1cmUgQmFzZSBTdHJpbmcuCiAqICAgLSBDaGFwdGVyIDkuNCAoIlBMQUlOVEVYVCIp
CiAqLwpjbGFzcyBPQXV0aFNpZ25hdHVyZU1ldGhvZF9QTEFJTlRFWFQgZXh0ZW5kcyBPQXV0
aFNpZ25hdHVyZU1ldGhvZCB7CiAgcHVibGljIGZ1bmN0aW9uIGdldF9uYW1lKCkgewogICAg
cmV0dXJuICJQTEFJTlRFWFQiOwogIH0KCiAgLyoqCiAgICogb2F1dGhfc2lnbmF0dXJlIGlz
IHNldCB0byB0aGUgY29uY2F0ZW5hdGVkIGVuY29kZWQgdmFsdWVzIG9mIHRoZSBDb25zdW1l
ciBTZWNyZXQgYW5kCiAgICogVG9rZW4gU2VjcmV0LCBzZXBhcmF0ZWQgYnkgYSAnJicgY2hh
cmFjdGVyIChBU0NJSSBjb2RlIDM4KSwgZXZlbiBpZiBlaXRoZXIgc2VjcmV0IGlzCiAgICog
ZW1wdHkuIFRoZSByZXN1bHQgTVVTVCBiZSBlbmNvZGVkIGFnYWluLgogICAqICAgLSBDaGFw
dGVyIDkuNC4xICgiR2VuZXJhdGluZyBTaWduYXR1cmVzIikKICAgKgogICAqIFBsZWFzZSBu
b3RlIHRoYXQgdGhlIHNlY29uZCBlbmNvZGluZyBNVVNUIE5PVCBoYXBwZW4gaW4gdGhlIFNp
Z25hdHVyZU1ldGhvZCwgYXMKICAgKiBPQXV0aFJlcXVlc3QgaGFuZGxlcyB0aGlzIQogICAq
LwogIHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1l
ciwgJHRva2VuKSB7CiAgICAka2V5X3BhcnRzID0gYXJyYXkoCiAgICAgICRjb25zdW1lci0+
c2VjcmV0LAogICAgICAoJHRva2VuKSA/ICR0b2tlbi0+c2VjcmV0IDogIiIKICAgICk7Cgog
ICAgJGtleV9wYXJ0cyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJGtleV9wYXJ0
cyk7CiAgICAka2V5ID0gaW1wbG9kZSgnJicsICRrZXlfcGFydHMpOwogICAgJHJlcXVlc3Qt
PmJhc2Vfc3RyaW5nID0gJGtleTsKCiAgICByZXR1cm4gJGtleTsKICB9Cn0KCi8qKgogKiBU
aGUgUlNBLVNIQTEgc2lnbmF0dXJlIG1ldGhvZCB1c2VzIHRoZSBSU0FTU0EtUEtDUzEtdjFf
NSBzaWduYXR1cmUgYWxnb3JpdGhtIGFzIGRlZmluZWQgaW4KICogW1JGQzM0NDddIHNlY3Rp
b24gOC4yIChtb3JlIHNpbXBseSBrbm93biBhcyBQS0NTIzEpLCB1c2luZyBTSEEtMSBhcyB0
aGUgaGFzaCBmdW5jdGlvbiBmb3IKICogRU1TQS1QS0NTMS12MV81LiBJdCBpcyBhc3N1bWVk
IHRoYXQgdGhlIENvbnN1bWVyIGhhcyBwcm92aWRlZCBpdHMgUlNBIHB1YmxpYyBrZXkgaW4g
YQogKiB2ZXJpZmllZCB3YXkgdG8gdGhlIFNlcnZpY2UgUHJvdmlkZXIsIGluIGEgbWFubmVy
IHdoaWNoIGlzIGJleW9uZCB0aGUgc2NvcGUgb2YgdGhpcwogKiBzcGVjaWZpY2F0aW9uLgog
KiAgIC0gQ2hhcHRlciA5LjMgKCJSU0EtU0hBMSIpCiAqLwphYnN0cmFjdCBjbGFzcyBPQXV0
aFNpZ25hdHVyZU1ldGhvZF9SU0FfU0hBMSBleHRlbmRzIE9BdXRoU2lnbmF0dXJlTWV0aG9k
IHsKICBwdWJsaWMgZnVuY3Rpb24gZ2V0X25hbWUoKSB7CiAgICByZXR1cm4gIlJTQS1TSEEx
IjsKICB9CgogIC8vIFVwIHRvIHRoZSBTUCB0byBpbXBsZW1lbnQgdGhpcyBsb29rdXAgb2Yg
a2V5cy4gUG9zc2libGUgaWRlYXMgYXJlOgogIC8vICgxKSBkbyBhIGxvb2t1cCBpbiBhIHRh
YmxlIG9mIHRydXN0ZWQgY2VydHMga2V5ZWQgb2ZmIG9mIGNvbnN1bWVyCiAgLy8gKDIpIGZl
dGNoIHZpYSBodHRwIHVzaW5nIGEgdXJsIHByb3ZpZGVkIGJ5IHRoZSByZXF1ZXN0ZXIKICAv
LyAoMykgc29tZSBzb3J0IG9mIHNwZWNpZmljIGRpc2NvdmVyeSBjb2RlIGJhc2VkIG9uIHJl
cXVlc3QKICAvLwogIC8vIEVpdGhlciB3YXkgc2hvdWxkIHJldHVybiBhIHN0cmluZyByZXBy
ZXNlbnRhdGlvbiBvZiB0aGUgY2VydGlmaWNhdGUKICBwcm90ZWN0ZWQgYWJzdHJhY3QgZnVu
Y3Rpb24gZmV0Y2hfcHVibGljX2NlcnQoJiRyZXF1ZXN0KTsKCiAgLy8gVXAgdG8gdGhlIFNQ
IHRvIGltcGxlbWVudCB0aGlzIGxvb2t1cCBvZiBrZXlzLiBQb3NzaWJsZSBpZGVhcyBhcmU6
CiAgLy8gKDEpIGRvIGEgbG9va3VwIGluIGEgdGFibGUgb2YgdHJ1c3RlZCBjZXJ0cyBrZXll
ZCBvZmYgb2YgY29uc3VtZXIKICAvLwogIC8vIEVpdGhlciB3YXkgc2hvdWxkIHJldHVybiBh
IHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgY2VydGlmaWNhdGUKICBwcm90ZWN0ZWQg
YWJzdHJhY3QgZnVuY3Rpb24gZmV0Y2hfcHJpdmF0ZV9jZXJ0KCYkcmVxdWVzdCk7CgogIHB1
YmxpYyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRv
a2VuKSB7CiAgICAkYmFzZV9zdHJpbmcgPSAkcmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9iYXNl
X3N0cmluZygpOwogICAgJHJlcXVlc3QtPmJhc2Vfc3RyaW5nID0gJGJhc2Vfc3RyaW5nOwoK
ICAgIC8vIEZldGNoIHRoZSBwcml2YXRlIGtleSBjZXJ0IGJhc2VkIG9uIHRoZSByZXF1ZXN0
CiAgICAkY2VydCA9ICR0aGlzLT5mZXRjaF9wcml2YXRlX2NlcnQoJHJlcXVlc3QpOwoKICAg
IC8vIFB1bGwgdGhlIHByaXZhdGUga2V5IElEIGZyb20gdGhlIGNlcnRpZmljYXRlCiAgICAk
cHJpdmF0ZWtleWlkID0gb3BlbnNzbF9nZXRfcHJpdmF0ZWtleSgkY2VydCk7CgogICAgLy8g
U2lnbiB1c2luZyB0aGUga2V5CiAgICAkb2sgPSBvcGVuc3NsX3NpZ24oJGJhc2Vfc3RyaW5n
LCAkc2lnbmF0dXJlLCAkcHJpdmF0ZWtleWlkKTsKCiAgICAvLyBSZWxlYXNlIHRoZSBrZXkg
cmVzb3VyY2UKICAgIG9wZW5zc2xfZnJlZV9rZXkoJHByaXZhdGVrZXlpZCk7CgogICAgcmV0
dXJuIGJhc2U2NF9lbmNvZGUoJHNpZ25hdHVyZSk7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24g
Y2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbiwgJHNpZ25hdHVy
ZSkgewogICAgJGRlY29kZWRfc2lnID0gYmFzZTY0X2RlY29kZSgkc2lnbmF0dXJlKTsKCiAg
ICAkYmFzZV9zdHJpbmcgPSAkcmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygp
OwoKICAgIC8vIEZldGNoIHRoZSBwdWJsaWMga2V5IGNlcnQgYmFzZWQgb24gdGhlIHJlcXVl
c3QKICAgICRjZXJ0ID0gJHRoaXMtPmZldGNoX3B1YmxpY19jZXJ0KCRyZXF1ZXN0KTsKCiAg
ICAvLyBQdWxsIHRoZSBwdWJsaWMga2V5IElEIGZyb20gdGhlIGNlcnRpZmljYXRlCiAgICAk
cHVibGlja2V5aWQgPSBvcGVuc3NsX2dldF9wdWJsaWNrZXkoJGNlcnQpOwoKICAgIC8vIENo
ZWNrIHRoZSBjb21wdXRlZCBzaWduYXR1cmUgYWdhaW5zdCB0aGUgb25lIHBhc3NlZCBpbiB0
aGUgcXVlcnkKICAgICRvayA9IG9wZW5zc2xfdmVyaWZ5KCRiYXNlX3N0cmluZywgJGRlY29k
ZWRfc2lnLCAkcHVibGlja2V5aWQpOwoKICAgIC8vIFJlbGVhc2UgdGhlIGtleSByZXNvdXJj
ZQogICAgb3BlbnNzbF9mcmVlX2tleSgkcHVibGlja2V5aWQpOwoKICAgIHJldHVybiAkb2sg
PT0gMTsKICB9Cn0KCmNsYXNzIE9BdXRoUmVxdWVzdCB7CiAgcHJpdmF0ZSAkcGFyYW1ldGVy
czsKICBwcml2YXRlICRodHRwX21ldGhvZDsKICBwcml2YXRlICRodHRwX3VybDsKICAvLyBm
b3IgZGVidWcgcHVycG9zZXMKICBwdWJsaWMgJGJhc2Vfc3RyaW5nOwogIHB1YmxpYyBzdGF0
aWMgJHZlcnNpb24gPSAnMS4wJzsKICBwdWJsaWMgc3RhdGljICRQT1NUX0lOUFVUID0gJ3Bo
cDovL2lucHV0JzsKCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGh0dHBfbWV0aG9kLCAkaHR0
cF91cmwsICRwYXJhbWV0ZXJzPU5VTEwpIHsKICAgIEAkcGFyYW1ldGVycyBvciAkcGFyYW1l
dGVycyA9IGFycmF5KCk7CiAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCBPQXV0aFV0
aWw6OnBhcnNlX3BhcmFtZXRlcnMocGFyc2VfdXJsKCRodHRwX3VybCwgUEhQX1VSTF9RVUVS
WSkpLCAkcGFyYW1ldGVycyk7CiAgICAkdGhpcy0+cGFyYW1ldGVycyA9ICRwYXJhbWV0ZXJz
OwogICAgJHRoaXMtPmh0dHBfbWV0aG9kID0gJGh0dHBfbWV0aG9kOwogICAgJHRoaXMtPmh0
dHBfdXJsID0gJGh0dHBfdXJsOwogIH0KCgogIC8qKgogICAqIGF0dGVtcHQgdG8gYnVpbGQg
dXAgYSByZXF1ZXN0IGZyb20gd2hhdCB3YXMgcGFzc2VkIHRvIHRoZSBzZXJ2ZXIKICAgKi8K
ICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGZyb21fcmVxdWVzdCgkaHR0cF9tZXRob2Q9TlVM
TCwgJGh0dHBfdXJsPU5VTEwsICRwYXJhbWV0ZXJzPU5VTEwpIHsKICAgICRzY2hlbWUgPSAo
IWlzc2V0KCRfU0VSVkVSWydIVFRQUyddKSB8fCAkX1NFUlZFUlsnSFRUUFMnXSAhPSAib24i
KQogICAgICAgICAgICAgID8gJ2h0dHAnCiAgICAgICAgICAgICAgOiAnaHR0cHMnOwogICAg
QCRodHRwX3VybCBvciAkaHR0cF91cmwgPSAkc2NoZW1lIC4KICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgJzovLycgLiAkX1NFUlZFUlsnSFRUUF9IT1NUJ10gLgogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAnOicgLgogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAkX1NFUlZFUlsnU0VSVkVSX1BPUlQnXSAuCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICRfU0VSVkVSWydSRVFVRVNUX1VSSSddOwogICAgQCRodHRwX21ldGhvZCBvciAkaHR0
cF9tZXRob2QgPSAkX1NFUlZFUlsnUkVRVUVTVF9NRVRIT0QnXTsKCiAgICAvLyBXZSB3ZXJl
bid0IGhhbmRlZCBhbnkgcGFyYW1ldGVycywgc28gbGV0J3MgZmluZCB0aGUgb25lcyByZWxl
dmFudCB0bwogICAgLy8gdGhpcyByZXF1ZXN0LgogICAgLy8gSWYgeW91IHJ1biBYTUwtUlBD
IG9yIHNpbWlsYXIgeW91IHNob3VsZCB1c2UgdGhpcyB0byBwcm92aWRlIHlvdXIgb3duCiAg
ICAvLyBwYXJzZWQgcGFyYW1ldGVyLWxpc3QKICAgIGlmICghJHBhcmFtZXRlcnMpIHsKICAg
ICAgLy8gRmluZCByZXF1ZXN0IGhlYWRlcnMKICAgICAgJHJlcXVlc3RfaGVhZGVycyA9IE9B
dXRoVXRpbDo6Z2V0X2hlYWRlcnMoKTsKCiAgICAgIC8vIFBhcnNlIHRoZSBxdWVyeS1zdHJp
bmcgdG8gZmluZCBHRVQgcGFyYW1ldGVycwogICAgICAkcGFyYW1ldGVycyA9IE9BdXRoVXRp
bDo6cGFyc2VfcGFyYW1ldGVycygkX1NFUlZFUlsnUVVFUllfU1RSSU5HJ10pOwoKICAgICAg
Ly8gSXQncyBhIFBPU1QgcmVxdWVzdCBvZiB0aGUgcHJvcGVyIGNvbnRlbnQtdHlwZSwgc28g
cGFyc2UgUE9TVAogICAgICAvLyBwYXJhbWV0ZXJzIGFuZCBhZGQgdGhvc2Ugb3ZlcnJpZGlu
ZyBhbnkgZHVwbGljYXRlcyBmcm9tIEdFVAogICAgICBpZiAoJGh0dHBfbWV0aG9kID09ICJQ
T1NUIgogICAgICAgICAgJiYgQHN0cnN0cigkcmVxdWVzdF9oZWFkZXJzWyJDb250ZW50LVR5
cGUiXSwKICAgICAgICAgICAgICAgICAgICAgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJs
ZW5jb2RlZCIpCiAgICAgICAgICApIHsKICAgICAgICAkcG9zdF9kYXRhID0gT0F1dGhVdGls
OjpwYXJzZV9wYXJhbWV0ZXJzKAogICAgICAgICAgZmlsZV9nZXRfY29udGVudHMoc2VsZjo6
JFBPU1RfSU5QVVQpCiAgICAgICAgKTsKICAgICAgICAkcGFyYW1ldGVycyA9IGFycmF5X21l
cmdlKCRwYXJhbWV0ZXJzLCAkcG9zdF9kYXRhKTsKICAgICAgfQoKICAgICAgLy8gV2UgaGF2
ZSBhIEF1dGhvcml6YXRpb24taGVhZGVyIHdpdGggT0F1dGggZGF0YS4gUGFyc2UgdGhlIGhl
YWRlcgogICAgICAvLyBhbmQgYWRkIHRob3NlIG92ZXJyaWRpbmcgYW55IGR1cGxpY2F0ZXMg
ZnJvbSBHRVQgb3IgUE9TVAogICAgICBpZiAoQHN1YnN0cigkcmVxdWVzdF9oZWFkZXJzWydB
dXRob3JpemF0aW9uJ10sIDAsIDYpID09ICJPQXV0aCAiKSB7CiAgICAgICAgJGhlYWRlcl9w
YXJhbWV0ZXJzID0gT0F1dGhVdGlsOjpzcGxpdF9oZWFkZXIoCiAgICAgICAgICAkcmVxdWVz
dF9oZWFkZXJzWydBdXRob3JpemF0aW9uJ10KICAgICAgICApOwogICAgICAgICRwYXJhbWV0
ZXJzID0gYXJyYXlfbWVyZ2UoJHBhcmFtZXRlcnMsICRoZWFkZXJfcGFyYW1ldGVycyk7CiAg
ICAgIH0KCiAgICB9CgogICAgcmV0dXJuIG5ldyBPQXV0aFJlcXVlc3QoJGh0dHBfbWV0aG9k
LCAkaHR0cF91cmwsICRwYXJhbWV0ZXJzKTsKICB9CgogIC8qKgogICAqIHByZXR0eSBtdWNo
IGEgaGVscGVyIGZ1bmN0aW9uIHRvIHNldCB1cCB0aGUgcmVxdWVzdAogICAqLwogIHB1Ymxp
YyBzdGF0aWMgZnVuY3Rpb24gZnJvbV9jb25zdW1lcl9hbmRfdG9rZW4oJGNvbnN1bWVyLCAk
dG9rZW4sICRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVycz1OVUxMKSB7CiAg
ICBAJHBhcmFtZXRlcnMgb3IgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgJGRlZmF1bHRz
ID0gYXJyYXkoIm9hdXRoX3ZlcnNpb24iID0+IE9BdXRoUmVxdWVzdDo6JHZlcnNpb24sCiAg
ICAgICAgICAgICAgICAgICAgICAib2F1dGhfbm9uY2UiID0+IE9BdXRoUmVxdWVzdDo6Z2Vu
ZXJhdGVfbm9uY2UoKSwKICAgICAgICAgICAgICAgICAgICAgICJvYXV0aF90aW1lc3RhbXAi
ID0+IE9BdXRoUmVxdWVzdDo6Z2VuZXJhdGVfdGltZXN0YW1wKCksCiAgICAgICAgICAgICAg
ICAgICAgICAib2F1dGhfY29uc3VtZXJfa2V5IiA9PiAkY29uc3VtZXItPmtleSk7CiAgICBp
ZiAoJHRva2VuKQogICAgICAkZGVmYXVsdHNbJ29hdXRoX3Rva2VuJ10gPSAkdG9rZW4tPmtl
eTsKCiAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCRkZWZhdWx0cywgJHBhcmFtZXRl
cnMpOwoKICAgIHJldHVybiBuZXcgT0F1dGhSZXF1ZXN0KCRodHRwX21ldGhvZCwgJGh0dHBf
dXJsLCAkcGFyYW1ldGVycyk7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gc2V0X3BhcmFtZXRl
cigkbmFtZSwgJHZhbHVlLCAkYWxsb3dfZHVwbGljYXRlcyA9IHRydWUpIHsKICAgIGlmICgk
YWxsb3dfZHVwbGljYXRlcyAmJiBpc3NldCgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pKSB7
CiAgICAgIC8vIFdlIGhhdmUgYWxyZWFkeSBhZGRlZCBwYXJhbWV0ZXIocykgd2l0aCB0aGlz
IG5hbWUsIHNvIGFkZCB0byB0aGUgbGlzdAogICAgICBpZiAoaXNfc2NhbGFyKCR0aGlzLT5w
YXJhbWV0ZXJzWyRuYW1lXSkpIHsKICAgICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCBkdXBs
aWNhdGUsIHNvIHRyYW5zZm9ybSBzY2FsYXIgKHN0cmluZykKICAgICAgICAvLyBpbnRvIGFu
IGFycmF5IHNvIHdlIGNhbiBhZGQgdGhlIGR1cGxpY2F0ZXMKICAgICAgICAkdGhpcy0+cGFy
YW1ldGVyc1skbmFtZV0gPSBhcnJheSgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pOwogICAg
ICB9CgogICAgICAkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV1bXSA9ICR2YWx1ZTsKICAgIH0g
ZWxzZSB7CiAgICAgICR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSA9ICR2YWx1ZTsKICAgIH0K
ICB9CgogIHB1YmxpYyBmdW5jdGlvbiBnZXRfcGFyYW1ldGVyKCRuYW1lKSB7CiAgICByZXR1
cm4gaXNzZXQoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdKSA/ICR0aGlzLT5wYXJhbWV0ZXJz
WyRuYW1lXSA6IG51bGw7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gZ2V0X3BhcmFtZXRlcnMo
KSB7CiAgICByZXR1cm4gJHRoaXMtPnBhcmFtZXRlcnM7CiAgfQoKICBwdWJsaWMgZnVuY3Rp
b24gdW5zZXRfcGFyYW1ldGVyKCRuYW1lKSB7CiAgICB1bnNldCgkdGhpcy0+cGFyYW1ldGVy
c1skbmFtZV0pOwogIH0KCiAgLyoqCiAgICogVGhlIHJlcXVlc3QgcGFyYW1ldGVycywgc29y
dGVkIGFuZCBjb25jYXRlbmF0ZWQgaW50byBhIG5vcm1hbGl6ZWQgc3RyaW5nLgogICAqIEBy
ZXR1cm4gc3RyaW5nCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGdldF9zaWduYWJsZV9wYXJh
bWV0ZXJzKCkgewogICAgLy8gR3JhYiBhbGwgcGFyYW1ldGVycwogICAgJHBhcmFtcyA9ICR0
aGlzLT5wYXJhbWV0ZXJzOwoKICAgIC8vIFJlbW92ZSBvYXV0aF9zaWduYXR1cmUgaWYgcHJl
c2VudAogICAgLy8gUmVmOiBTcGVjOiA5LjEuMSAoIlRoZSBvYXV0aF9zaWduYXR1cmUgcGFy
YW1ldGVyIE1VU1QgYmUgZXhjbHVkZWQuIikKICAgIGlmIChpc3NldCgkcGFyYW1zWydvYXV0
aF9zaWduYXR1cmUnXSkpIHsKICAgICAgdW5zZXQoJHBhcmFtc1snb2F1dGhfc2lnbmF0dXJl
J10pOwogICAgfQoKICAgIHJldHVybiBPQXV0aFV0aWw6OmJ1aWxkX2h0dHBfcXVlcnkoJHBh
cmFtcyk7CiAgfQoKICAvKioKICAgKiBSZXR1cm5zIHRoZSBiYXNlIHN0cmluZyBvZiB0aGlz
IHJlcXVlc3QKICAgKgogICAqIFRoZSBiYXNlIHN0cmluZyBkZWZpbmVkIGFzIHRoZSBtZXRo
b2QsIHRoZSB1cmwKICAgKiBhbmQgdGhlIHBhcmFtZXRlcnMgKG5vcm1hbGl6ZWQpLCBlYWNo
IHVybGVuY29kZWQKICAgKiBhbmQgdGhlIGNvbmNhdGVkIHdpdGggJi4KICAgKi8KICBwdWJs
aWMgZnVuY3Rpb24gZ2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpIHsKICAgICRwYXJ0cyA9
IGFycmF5KAogICAgICAkdGhpcy0+Z2V0X25vcm1hbGl6ZWRfaHR0cF9tZXRob2QoKSwKICAg
ICAgJHRoaXMtPmdldF9ub3JtYWxpemVkX2h0dHBfdXJsKCksCiAgICAgICR0aGlzLT5nZXRf
c2lnbmFibGVfcGFyYW1ldGVycygpCiAgICApOwoKICAgICRwYXJ0cyA9IE9BdXRoVXRpbDo6
dXJsZW5jb2RlX3JmYzM5ODYoJHBhcnRzKTsKCiAgICByZXR1cm4gaW1wbG9kZSgnJicsICRw
YXJ0cyk7CiAgfQoKICAvKioKICAgKiBqdXN0IHVwcGVyY2FzZXMgdGhlIGh0dHAgbWV0aG9k
CiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGdldF9ub3JtYWxpemVkX2h0dHBfbWV0aG9kKCkg
ewogICAgcmV0dXJuIHN0cnRvdXBwZXIoJHRoaXMtPmh0dHBfbWV0aG9kKTsKICB9CgogIC8q
KgogICAqIHBhcnNlcyB0aGUgdXJsIGFuZCByZWJ1aWxkcyBpdCB0byBiZQogICAqIHNjaGVt
ZTovL2hvc3QvcGF0aAogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBnZXRfbm9ybWFsaXplZF9o
dHRwX3VybCgpIHsKICAgICRwYXJ0cyA9IHBhcnNlX3VybCgkdGhpcy0+aHR0cF91cmwpOwoK
ICAgICRwb3J0ID0gQCRwYXJ0c1sncG9ydCddOwogICAgJHNjaGVtZSA9ICRwYXJ0c1snc2No
ZW1lJ107CiAgICAkaG9zdCA9ICRwYXJ0c1snaG9zdCddOwogICAgJHBhdGggPSBAJHBhcnRz
WydwYXRoJ107CgogICAgJHBvcnQgb3IgJHBvcnQgPSAoJHNjaGVtZSA9PSAnaHR0cHMnKSA/
ICc0NDMnIDogJzgwJzsKCiAgICBpZiAoKCRzY2hlbWUgPT0gJ2h0dHBzJyAmJiAkcG9ydCAh
PSAnNDQzJykKICAgICAgICB8fCAoJHNjaGVtZSA9PSAnaHR0cCcgJiYgJHBvcnQgIT0gJzgw
JykpIHsKICAgICAgJGhvc3QgPSAiJGhvc3Q6JHBvcnQiOwogICAgfQogICAgcmV0dXJuICIk
c2NoZW1lOi8vJGhvc3QkcGF0aCI7CiAgfQoKICAvKioKICAgKiBidWlsZHMgYSB1cmwgdXNh
YmxlIGZvciBhIEdFVCByZXF1ZXN0CiAgICovCiAgcHVibGljIGZ1bmN0aW9uIHRvX3VybCgp
IHsKICAgICRwb3N0X2RhdGEgPSAkdGhpcy0+dG9fcG9zdGRhdGEoKTsKICAgICRvdXQgPSAk
dGhpcy0+Z2V0X25vcm1hbGl6ZWRfaHR0cF91cmwoKTsKICAgIGlmICgkcG9zdF9kYXRhKSB7
CiAgICAgICRvdXQgLj0gJz8nLiRwb3N0X2RhdGE7CiAgICB9CiAgICByZXR1cm4gJG91dDsK
ICB9CgogIC8qKgogICAqIGJ1aWxkcyB0aGUgZGF0YSBvbmUgd291bGQgc2VuZCBpbiBhIFBP
U1QgcmVxdWVzdAogICAqLwogIHB1YmxpYyBmdW5jdGlvbiB0b19wb3N0ZGF0YSgpIHsKICAg
IHJldHVybiBPQXV0aFV0aWw6OmJ1aWxkX2h0dHBfcXVlcnkoJHRoaXMtPnBhcmFtZXRlcnMp
OwogIH0KCiAgLyoqCiAgICogYnVpbGRzIHRoZSBBdXRob3JpemF0aW9uOiBoZWFkZXIKICAg
Ki8KICBwdWJsaWMgZnVuY3Rpb24gdG9faGVhZGVyKCRyZWFsbT1udWxsKSB7CiAgICAkZmly
c3QgPSB0cnVlOwogIGlmKCRyZWFsbSkgewogICAgICAkb3V0ID0gJ0F1dGhvcml6YXRpb246
IE9BdXRoIHJlYWxtPSInIC4gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkcmVhbG0p
IC4gJyInOwogICAgICAkZmlyc3QgPSBmYWxzZTsKICAgIH0gZWxzZQogICAgICAkb3V0ID0g
J0F1dGhvcml6YXRpb246IE9BdXRoJzsKCiAgICAkdG90YWwgPSBhcnJheSgpOwogICAgZm9y
ZWFjaCAoJHRoaXMtPnBhcmFtZXRlcnMgYXMgJGsgPT4gJHYpIHsKICAgICAgaWYgKHN1YnN0
cigkaywgMCwgNSkgIT0gIm9hdXRoIikgY29udGludWU7CiAgICAgIGlmIChpc19hcnJheSgk
dikpIHsKICAgICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oJ0FycmF5cyBub3Qgc3Vw
cG9ydGVkIGluIGhlYWRlcnMnKTsKICAgICAgfQogICAgICAkb3V0IC49ICgkZmlyc3QpID8g
JyAnIDogJywnOwogICAgICAkb3V0IC49IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYo
JGspIC4KICAgICAgICAgICAgICAnPSInIC4KICAgICAgICAgICAgICBPQXV0aFV0aWw6OnVy
bGVuY29kZV9yZmMzOTg2KCR2KSAuCiAgICAgICAgICAgICAgJyInOwogICAgICAkZmlyc3Qg
PSBmYWxzZTsKICAgIH0KICAgIHJldHVybiAkb3V0OwogIH0KCiAgcHVibGljIGZ1bmN0aW9u
IF9fdG9TdHJpbmcoKSB7CiAgICByZXR1cm4gJHRoaXMtPnRvX3VybCgpOwogIH0KCgogIHB1
YmxpYyBmdW5jdGlvbiBzaWduX3JlcXVlc3QoJHNpZ25hdHVyZV9tZXRob2QsICRjb25zdW1l
ciwgJHRva2VuKSB7CiAgICAkdGhpcy0+c2V0X3BhcmFtZXRlcigKICAgICAgIm9hdXRoX3Np
Z25hdHVyZV9tZXRob2QiLAogICAgICAkc2lnbmF0dXJlX21ldGhvZC0+Z2V0X25hbWUoKSwK
ICAgICAgZmFsc2UKICAgICk7CiAgICAkc2lnbmF0dXJlID0gJHRoaXMtPmJ1aWxkX3NpZ25h
dHVyZSgkc2lnbmF0dXJlX21ldGhvZCwgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAgJHRoaXMt
PnNldF9wYXJhbWV0ZXIoIm9hdXRoX3NpZ25hdHVyZSIsICRzaWduYXR1cmUsIGZhbHNlKTsK
ICB9CgogIHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHNpZ25hdHVyZV9tZXRo
b2QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAkc2lnbmF0dXJlID0gJHNpZ25hdHVyZV9t
ZXRob2QtPmJ1aWxkX3NpZ25hdHVyZSgkdGhpcywgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAg
cmV0dXJuICRzaWduYXR1cmU7CiAgfQoKICAvKioKICAgKiB1dGlsIGZ1bmN0aW9uOiBjdXJy
ZW50IHRpbWVzdGFtcAogICAqLwogIHByaXZhdGUgc3RhdGljIGZ1bmN0aW9uIGdlbmVyYXRl
X3RpbWVzdGFtcCgpIHsKICAgIHJldHVybiB0aW1lKCk7CiAgfQoKICAvKioKICAgKiB1dGls
IGZ1bmN0aW9uOiBjdXJyZW50IG5vbmNlCiAgICovCiAgcHJpdmF0ZSBzdGF0aWMgZnVuY3Rp
b24gZ2VuZXJhdGVfbm9uY2UoKSB7CiAgICAkbXQgPSBtaWNyb3RpbWUoKTsKICAgICRyYW5k
ID0gbXRfcmFuZCgpOwoKICAgIHJldHVybiBtZDUoJG10IC4gJHJhbmQpOyAvLyBtZDVzIGxv
b2sgbmljZXIgdGhhbiBudW1iZXJzCiAgfQp9CgpjbGFzcyBPQXV0aFNlcnZlciB7CiAgcHJv
dGVjdGVkICR0aW1lc3RhbXBfdGhyZXNob2xkID0gMzAwOyAvLyBpbiBzZWNvbmRzLCBmaXZl
IG1pbnV0ZXMKICBwcm90ZWN0ZWQgJHZlcnNpb24gPSAnMS4wJzsgICAgICAgICAgICAgLy8g
aGkgYmxhaW5lCiAgcHJvdGVjdGVkICRzaWduYXR1cmVfbWV0aG9kcyA9IGFycmF5KCk7Cgog
IHByb3RlY3RlZCAkZGF0YV9zdG9yZTsKCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGRhdGFf
c3RvcmUpIHsKICAgICR0aGlzLT5kYXRhX3N0b3JlID0gJGRhdGFfc3RvcmU7CiAgfQoKICBw
dWJsaWMgZnVuY3Rpb24gYWRkX3NpZ25hdHVyZV9tZXRob2QoJHNpZ25hdHVyZV9tZXRob2Qp
IHsKICAgICR0aGlzLT5zaWduYXR1cmVfbWV0aG9kc1skc2lnbmF0dXJlX21ldGhvZC0+Z2V0
X25hbWUoKV0gPQogICAgICAkc2lnbmF0dXJlX21ldGhvZDsKICB9CgogIC8vIGhpZ2ggbGV2
ZWwgZnVuY3Rpb25zCgogIC8qKgogICAqIHByb2Nlc3MgYSByZXF1ZXN0X3Rva2VuIHJlcXVl
c3QKICAgKiByZXR1cm5zIHRoZSByZXF1ZXN0IHRva2VuIG9uIHN1Y2Nlc3MKICAgKi8KICBw
dWJsaWMgZnVuY3Rpb24gZmV0Y2hfcmVxdWVzdF90b2tlbigmJHJlcXVlc3QpIHsKICAgICR0
aGlzLT5nZXRfdmVyc2lvbigkcmVxdWVzdCk7CgogICAgJGNvbnN1bWVyID0gJHRoaXMtPmdl
dF9jb25zdW1lcigkcmVxdWVzdCk7CgogICAgLy8gbm8gdG9rZW4gcmVxdWlyZWQgZm9yIHRo
ZSBpbml0aWFsIHRva2VuIHJlcXVlc3QKICAgICR0b2tlbiA9IE5VTEw7CgogICAgJHRoaXMt
PmNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwoKICAgIC8v
IFJldiBBIGNoYW5nZQogICAgJGNhbGxiYWNrID0gJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIo
J29hdXRoX2NhbGxiYWNrJyk7CiAgICAkbmV3X3Rva2VuID0gJHRoaXMtPmRhdGFfc3RvcmUt
Pm5ld19yZXF1ZXN0X3Rva2VuKCRjb25zdW1lciwgJGNhbGxiYWNrKTsKCiAgICByZXR1cm4g
JG5ld190b2tlbjsKICB9CgogIC8qKgogICAqIHByb2Nlc3MgYW4gYWNjZXNzX3Rva2VuIHJl
cXVlc3QKICAgKiByZXR1cm5zIHRoZSBhY2Nlc3MgdG9rZW4gb24gc3VjY2VzcwogICAqLwog
IHB1YmxpYyBmdW5jdGlvbiBmZXRjaF9hY2Nlc3NfdG9rZW4oJiRyZXF1ZXN0KSB7CiAgICAk
dGhpcy0+Z2V0X3ZlcnNpb24oJHJlcXVlc3QpOwoKICAgICRjb25zdW1lciA9ICR0aGlzLT5n
ZXRfY29uc3VtZXIoJHJlcXVlc3QpOwoKICAgIC8vIHJlcXVpcmVzIGF1dGhvcml6ZWQgcmVx
dWVzdCB0b2tlbgogICAgJHRva2VuID0gJHRoaXMtPmdldF90b2tlbigkcmVxdWVzdCwgJGNv
bnN1bWVyLCAicmVxdWVzdCIpOwoKICAgICR0aGlzLT5jaGVja19zaWduYXR1cmUoJHJlcXVl
c3QsICRjb25zdW1lciwgJHRva2VuKTsKCiAgICAvLyBSZXYgQSBjaGFuZ2UKICAgICR2ZXJp
ZmllciA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF92ZXJpZmllcicpOwogICAg
JG5ld190b2tlbiA9ICR0aGlzLT5kYXRhX3N0b3JlLT5uZXdfYWNjZXNzX3Rva2VuKCR0b2tl
biwgJGNvbnN1bWVyLCAkdmVyaWZpZXIpOwoKICAgIHJldHVybiAkbmV3X3Rva2VuOwogIH0K
CiAgLyoqCiAgICogdmVyaWZ5IGFuIGFwaSBjYWxsLCBjaGVja3MgYWxsIHRoZSBwYXJhbWV0
ZXJzCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIHZlcmlmeV9yZXF1ZXN0KCYkcmVxdWVzdCkg
ewogICAgJHRoaXMtPmdldF92ZXJzaW9uKCRyZXF1ZXN0KTsKICAgICRjb25zdW1lciA9ICR0
aGlzLT5nZXRfY29uc3VtZXIoJHJlcXVlc3QpOwogICAgJHRva2VuID0gJHRoaXMtPmdldF90
b2tlbigkcmVxdWVzdCwgJGNvbnN1bWVyLCAiYWNjZXNzIik7CiAgICAkdGhpcy0+Y2hlY2tf
c2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7CiAgICByZXR1cm4gYXJy
YXkoJGNvbnN1bWVyLCAkdG9rZW4pOwogIH0KCiAgLy8gSW50ZXJuYWxzIGZyb20gaGVyZQog
IC8qKgogICAqIHZlcnNpb24gMQogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X3ZlcnNp
b24oJiRyZXF1ZXN0KSB7CiAgICAkdmVyc2lvbiA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVy
KCJvYXV0aF92ZXJzaW9uIik7CiAgICBpZiAoISR2ZXJzaW9uKSB7CiAgICAgIC8vIFNlcnZp
Y2UgUHJvdmlkZXJzIE1VU1QgYXNzdW1lIHRoZSBwcm90b2NvbCB2ZXJzaW9uIHRvIGJlIDEu
MCBpZiB0aGlzIHBhcmFtZXRlciBpcyBub3QgcHJlc2VudC4KICAgICAgLy8gQ2hhcHRlciA3
LjAgKCJBY2Nlc3NpbmcgUHJvdGVjdGVkIFJlc3NvdXJjZXMiKQogICAgICAkdmVyc2lvbiA9
ICcxLjAnOwogICAgfQogICAgaWYgKCR2ZXJzaW9uICE9PSAkdGhpcy0+dmVyc2lvbikgewog
ICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIk9BdXRoIHZlcnNpb24gJyR2ZXJzaW9u
JyBub3Qgc3VwcG9ydGVkIik7CiAgICB9CiAgICByZXR1cm4gJHZlcnNpb247CiAgfQoKICAv
KioKICAgKiBmaWd1cmUgb3V0IHRoZSBzaWduYXR1cmUgd2l0aCBzb21lIGRlZmF1bHRzCiAg
ICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBnZXRfc2lnbmF0dXJlX21ldGhvZCgmJHJlcXVlc3Qp
IHsKICAgICRzaWduYXR1cmVfbWV0aG9kID0KICAgICAgICBAJHJlcXVlc3QtPmdldF9wYXJh
bWV0ZXIoIm9hdXRoX3NpZ25hdHVyZV9tZXRob2QiKTsKCiAgICBpZiAoISRzaWduYXR1cmVf
bWV0aG9kKSB7CiAgICAgIC8vIEFjY29yZGluZyB0byBjaGFwdGVyIDcgKCJBY2Nlc3Npbmcg
UHJvdGVjdGVkIFJlc3NvdXJjZXMiKSB0aGUgc2lnbmF0dXJlLW1ldGhvZAogICAgICAvLyBw
YXJhbWV0ZXIgaXMgcmVxdWlyZWQsIGFuZCB3ZSBjYW4ndCBqdXN0IGZhbGxiYWNrIHRvIFBM
QUlOVEVYVAogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oJ05vIHNpZ25hdHVyZSBt
ZXRob2QgcGFyYW1ldGVyLiBUaGlzIHBhcmFtZXRlciBpcyByZXF1aXJlZCcpOwogICAgfQoK
ICAgIGlmICghaW5fYXJyYXkoJHNpZ25hdHVyZV9tZXRob2QsCiAgICAgICAgICAgICAgICAg
IGFycmF5X2tleXMoJHRoaXMtPnNpZ25hdHVyZV9tZXRob2RzKSkpIHsKICAgICAgdGhyb3cg
bmV3IE9BdXRoRXhjZXB0aW9uKAogICAgICAgICJTaWduYXR1cmUgbWV0aG9kICckc2lnbmF0
dXJlX21ldGhvZCcgbm90IHN1cHBvcnRlZCAiIC4KICAgICAgICAidHJ5IG9uZSBvZiB0aGUg
Zm9sbG93aW5nOiAiIC4KICAgICAgICBpbXBsb2RlKCIsICIsIGFycmF5X2tleXMoJHRoaXMt
PnNpZ25hdHVyZV9tZXRob2RzKSkKICAgICAgKTsKICAgIH0KICAgIHJldHVybiAkdGhpcy0+
c2lnbmF0dXJlX21ldGhvZHNbJHNpZ25hdHVyZV9tZXRob2RdOwogIH0KCiAgLyoqCiAgICog
dHJ5IHRvIGZpbmQgdGhlIGNvbnN1bWVyIGZvciB0aGUgcHJvdmlkZWQgcmVxdWVzdCdzIGNv
bnN1bWVyIGtleQogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X2NvbnN1bWVyKCYkcmVx
dWVzdCkgewogICAgJGNvbnN1bWVyX2tleSA9IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcigi
b2F1dGhfY29uc3VtZXJfa2V5Iik7CiAgICBpZiAoISRjb25zdW1lcl9rZXkpIHsKICAgICAg
dGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJbnZhbGlkIGNvbnN1bWVyIGtleSIpOwogICAg
fQoKICAgICRjb25zdW1lciA9ICR0aGlzLT5kYXRhX3N0b3JlLT5sb29rdXBfY29uc3VtZXIo
JGNvbnN1bWVyX2tleSk7CiAgICBpZiAoISRjb25zdW1lcikgewogICAgICB0aHJvdyBuZXcg
T0F1dGhFeGNlcHRpb24oIkludmFsaWQgY29uc3VtZXIiKTsKICAgIH0KCiAgICByZXR1cm4g
JGNvbnN1bWVyOwogIH0KCiAgLyoqCiAgICogdHJ5IHRvIGZpbmQgdGhlIHRva2VuIGZvciB0
aGUgcHJvdmlkZWQgcmVxdWVzdCdzIHRva2VuIGtleQogICAqLwogIHByaXZhdGUgZnVuY3Rp
b24gZ2V0X3Rva2VuKCYkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW5fdHlwZT0iYWNjZXNz
IikgewogICAgJHRva2VuX2ZpZWxkID0gQCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0
aF90b2tlbicpOwogICAgJHRva2VuID0gJHRoaXMtPmRhdGFfc3RvcmUtPmxvb2t1cF90b2tl
bigKICAgICAgJGNvbnN1bWVyLCAkdG9rZW5fdHlwZSwgJHRva2VuX2ZpZWxkCiAgICApOwog
ICAgaWYgKCEkdG9rZW4pIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJbnZh
bGlkICR0b2tlbl90eXBlIHRva2VuOiAkdG9rZW5fZmllbGQiKTsKICAgIH0KICAgIHJldHVy
biAkdG9rZW47CiAgfQoKICAvKioKICAgKiBhbGwtaW4tb25lIGZ1bmN0aW9uIHRvIGNoZWNr
IHRoZSBzaWduYXR1cmUgb24gYSByZXF1ZXN0CiAgICogc2hvdWxkIGd1ZXNzIHRoZSBzaWdu
YXR1cmUgbWV0aG9kIGFwcHJvcHJpYXRlbHkKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGNo
ZWNrX3NpZ25hdHVyZSgmJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAvLyB0
aGlzIHNob3VsZCBwcm9iYWJseSBiZSBpbiBhIGRpZmZlcmVudCBtZXRob2QKICAgICR0aW1l
c3RhbXAgPSBAJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX3RpbWVzdGFtcCcpOwog
ICAgJG5vbmNlID0gQCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF9ub25jZScpOwoK
ICAgICR0aGlzLT5jaGVja190aW1lc3RhbXAoJHRpbWVzdGFtcCk7CiAgICAkdGhpcy0+Y2hl
Y2tfbm9uY2UoJGNvbnN1bWVyLCAkdG9rZW4sICRub25jZSwgJHRpbWVzdGFtcCk7CgogICAg
JHNpZ25hdHVyZV9tZXRob2QgPSAkdGhpcy0+Z2V0X3NpZ25hdHVyZV9tZXRob2QoJHJlcXVl
c3QpOwoKICAgICRzaWduYXR1cmUgPSAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhf
c2lnbmF0dXJlJyk7CiAgICAkdmFsaWRfc2lnID0gJHNpZ25hdHVyZV9tZXRob2QtPmNoZWNr
X3NpZ25hdHVyZSgKICAgICAgJHJlcXVlc3QsCiAgICAgICRjb25zdW1lciwKICAgICAgJHRv
a2VuLAogICAgICAkc2lnbmF0dXJlCiAgICApOwoKICAgIGlmICghJHZhbGlkX3NpZykgewog
ICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIkludmFsaWQgc2lnbmF0dXJlIik7CiAg
ICB9CiAgfQoKICAvKioKICAgKiBjaGVjayB0aGF0IHRoZSB0aW1lc3RhbXAgaXMgbmV3IGVu
b3VnaAogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gY2hlY2tfdGltZXN0YW1wKCR0aW1lc3Rh
bXApIHsKICAgIGlmKCAhICR0aW1lc3RhbXAgKQogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNl
cHRpb24oCiAgICAgICAgJ01pc3NpbmcgdGltZXN0YW1wIHBhcmFtZXRlci4gVGhlIHBhcmFt
ZXRlciBpcyByZXF1aXJlZCcKICAgICAgKTsKCiAgICAvLyB2ZXJpZnkgdGhhdCB0aW1lc3Rh
bXAgaXMgcmVjZW50aXNoCiAgICAkbm93ID0gdGltZSgpOwogICAgaWYgKGFicygkbm93IC0g
JHRpbWVzdGFtcCkgPiAkdGhpcy0+dGltZXN0YW1wX3RocmVzaG9sZCkgewogICAgICB0aHJv
dyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAgICAgIkV4cGlyZWQgdGltZXN0YW1wLCB5b3Vy
cyAkdGltZXN0YW1wLCBvdXJzICRub3ciCiAgICAgICk7CiAgICB9CiAgfQoKICAvKioKICAg
KiBjaGVjayB0aGF0IHRoZSBub25jZSBpcyBub3QgcmVwZWF0ZWQKICAgKi8KICBwcml2YXRl
IGZ1bmN0aW9uIGNoZWNrX25vbmNlKCRjb25zdW1lciwgJHRva2VuLCAkbm9uY2UsICR0aW1l
c3RhbXApIHsKICAgIGlmKCAhICRub25jZSApCiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2Vw
dGlvbigKICAgICAgICAnTWlzc2luZyBub25jZSBwYXJhbWV0ZXIuIFRoZSBwYXJhbWV0ZXIg
aXMgcmVxdWlyZWQnCiAgICAgICk7CgogICAgLy8gdmVyaWZ5IHRoYXQgdGhlIG5vbmNlIGlz
IHVuaXF1ZWlzaAogICAgJGZvdW5kID0gJHRoaXMtPmRhdGFfc3RvcmUtPmxvb2t1cF9ub25j
ZSgKICAgICAgJGNvbnN1bWVyLAogICAgICAkdG9rZW4sCiAgICAgICRub25jZSwKICAgICAg
JHRpbWVzdGFtcAogICAgKTsKICAgIGlmICgkZm91bmQpIHsKICAgICAgdGhyb3cgbmV3IE9B
dXRoRXhjZXB0aW9uKCJOb25jZSBhbHJlYWR5IHVzZWQ6ICRub25jZSIpOwogICAgfQogIH0K
Cn0KCmNsYXNzIE9BdXRoRGF0YVN0b3JlIHsKICBmdW5jdGlvbiBsb29rdXBfY29uc3VtZXIo
JGNvbnN1bWVyX2tleSkgewogICAgLy8gaW1wbGVtZW50IG1lCiAgfQoKICBmdW5jdGlvbiBs
b29rdXBfdG9rZW4oJGNvbnN1bWVyLCAkdG9rZW5fdHlwZSwgJHRva2VuKSB7CiAgICAvLyBp
bXBsZW1lbnQgbWUKICB9CgogIGZ1bmN0aW9uIGxvb2t1cF9ub25jZSgkY29uc3VtZXIsICR0
b2tlbiwgJG5vbmNlLCAkdGltZXN0YW1wKSB7CiAgICAvLyBpbXBsZW1lbnQgbWUKICB9Cgog
IGZ1bmN0aW9uIG5ld19yZXF1ZXN0X3Rva2VuKCRjb25zdW1lciwgJGNhbGxiYWNrID0gbnVs
bCkgewogICAgLy8gcmV0dXJuIGEgbmV3IHRva2VuIGF0dGFjaGVkIHRvIHRoaXMgY29uc3Vt
ZXIKICB9CgogIGZ1bmN0aW9uIG5ld19hY2Nlc3NfdG9rZW4oJHRva2VuLCAkY29uc3VtZXIs
ICR2ZXJpZmllciA9IG51bGwpIHsKICAgIC8vIHJldHVybiBhIG5ldyBhY2Nlc3MgdG9rZW4g
YXR0YWNoZWQgdG8gdGhpcyBjb25zdW1lcgogICAgLy8gZm9yIHRoZSB1c2VyIGFzc29jaWF0
ZWQgd2l0aCB0aGlzIHRva2VuIGlmIHRoZSByZXF1ZXN0IHRva2VuCiAgICAvLyBpcyBhdXRo
b3JpemVkCiAgICAvLyBzaG91bGQgYWxzbyBpbnZhbGlkYXRlIHRoZSByZXF1ZXN0IHRva2Vu
CiAgfQoKfQoKY2xhc3MgT0F1dGhVdGlsIHsKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHVy
bGVuY29kZV9yZmMzOTg2KCRpbnB1dCkgewogIGlmIChpc19hcnJheSgkaW5wdXQpKSB7CiAg
ICByZXR1cm4gYXJyYXlfbWFwKGFycmF5KCdPQXV0aFV0aWwnLCAndXJsZW5jb2RlX3JmYzM5
ODYnKSwgJGlucHV0KTsKICB9IGVsc2UgaWYgKGlzX3NjYWxhcigkaW5wdXQpKSB7CiAgICBy
ZXR1cm4gc3RyX3JlcGxhY2UoCiAgICAgICcrJywKICAgICAgJyAnLAogICAgICBzdHJfcmVw
bGFjZSgnJTdFJywgJ34nLCByYXd1cmxlbmNvZGUoJGlucHV0KSkKICAgICk7CiAgfSBlbHNl
IHsKICAgIHJldHVybiAnJzsKICB9Cn0KCgogIC8vIFRoaXMgZGVjb2RlIGZ1bmN0aW9uIGlz
bid0IHRha2luZyBpbnRvIGNvbnNpZGVyYXRpb24gdGhlIGFib3ZlCiAgLy8gbW9kaWZpY2F0
aW9ucyB0byB0aGUgZW5jb2RpbmcgcHJvY2Vzcy4gSG93ZXZlciwgdGhpcyBtZXRob2QgZG9l
c24ndAogIC8vIHNlZW0gdG8gYmUgdXNlZCBhbnl3aGVyZSBzbyBsZWF2aW5nIGl0IGFzIGlz
LgogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gdXJsZGVjb2RlX3JmYzM5ODYoJHN0cmluZykg
ewogICAgcmV0dXJuIHVybGRlY29kZSgkc3RyaW5nKTsKICB9CgogIC8vIFV0aWxpdHkgZnVu
Y3Rpb24gZm9yIHR1cm5pbmcgdGhlIEF1dGhvcml6YXRpb246IGhlYWRlciBpbnRvCiAgLy8g
cGFyYW1ldGVycywgaGFzIHRvIGRvIHNvbWUgdW5lc2NhcGluZwogIC8vIENhbiBmaWx0ZXIg
b3V0IGFueSBub24tb2F1dGggcGFyYW1ldGVycyBpZiBuZWVkZWQgKGRlZmF1bHQgYmVoYXZp
b3VyKQogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gc3BsaXRfaGVhZGVyKCRoZWFkZXIsICRv
bmx5X2FsbG93X29hdXRoX3BhcmFtZXRlcnMgPSB0cnVlKSB7CiAgICAkcGF0dGVybiA9ICcv
KChbLV9hLXpdKik9KCIoW14iXSopInwoW14sXSopKSw/KS8nOwogICAgJG9mZnNldCA9IDA7
CiAgICAkcGFyYW1zID0gYXJyYXkoKTsKICAgIHdoaWxlIChwcmVnX21hdGNoKCRwYXR0ZXJu
LCAkaGVhZGVyLCAkbWF0Y2hlcywgUFJFR19PRkZTRVRfQ0FQVFVSRSwgJG9mZnNldCkgPiAw
KSB7CiAgICAgICRtYXRjaCA9ICRtYXRjaGVzWzBdOwogICAgICAkaGVhZGVyX25hbWUgPSAk
bWF0Y2hlc1syXVswXTsKICAgICAgJGhlYWRlcl9jb250ZW50ID0gKGlzc2V0KCRtYXRjaGVz
WzVdKSkgPyAkbWF0Y2hlc1s1XVswXSA6ICRtYXRjaGVzWzRdWzBdOwogICAgICBpZiAocHJl
Z19tYXRjaCgnL15vYXV0aF8vJywgJGhlYWRlcl9uYW1lKSB8fCAhJG9ubHlfYWxsb3dfb2F1
dGhfcGFyYW1ldGVycykgewogICAgICAgICRwYXJhbXNbJGhlYWRlcl9uYW1lXSA9IE9BdXRo
VXRpbDo6dXJsZGVjb2RlX3JmYzM5ODYoJGhlYWRlcl9jb250ZW50KTsKICAgICAgfQogICAg
ICAkb2Zmc2V0ID0gJG1hdGNoWzFdICsgc3RybGVuKCRtYXRjaFswXSk7CiAgICB9CgogICAg
aWYgKGlzc2V0KCRwYXJhbXNbJ3JlYWxtJ10pKSB7CiAgICAgIHVuc2V0KCRwYXJhbXNbJ3Jl
YWxtJ10pOwogICAgfQoKICAgIHJldHVybiAkcGFyYW1zOwogIH0KCiAgLy8gaGVscGVyIHRv
IHRyeSB0byBzb3J0IG91dCBoZWFkZXJzIGZvciBwZW9wbGUgd2hvIGFyZW4ndCBydW5uaW5n
IGFwYWNoZQogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZ2V0X2hlYWRlcnMoKSB7CiAgICBp
ZiAoZnVuY3Rpb25fZXhpc3RzKCdhcGFjaGVfcmVxdWVzdF9oZWFkZXJzJykpIHsKICAgICAg
Ly8gd2UgbmVlZCB0aGlzIHRvIGdldCB0aGUgYWN0dWFsIEF1dGhvcml6YXRpb246IGhlYWRl
cgogICAgICAvLyBiZWNhdXNlIGFwYWNoZSB0ZW5kcyB0byB0ZWxsIHVzIGl0IGRvZXNuJ3Qg
ZXhpc3QKICAgICAgJGhlYWRlcnMgPSBhcGFjaGVfcmVxdWVzdF9oZWFkZXJzKCk7CgogICAg
ICAvLyBzYW5pdGl6ZSB0aGUgb3V0cHV0IG9mIGFwYWNoZV9yZXF1ZXN0X2hlYWRlcnMgYmVj
YXVzZQogICAgICAvLyB3ZSBhbHdheXMgd2FudCB0aGUga2V5cyB0byBiZSBDYXNlZC1MaWtl
LVRoaXMgYW5kIGFyaCgpCiAgICAgIC8vIHJldHVybnMgdGhlIGhlYWRlcnMgaW4gdGhlIHNh
bWUgY2FzZSBhcyB0aGV5IGFyZSBpbiB0aGUKICAgICAgLy8gcmVxdWVzdAogICAgICAkb3V0
ID0gYXJyYXkoKTsKICAgICAgZm9yZWFjaCggJGhlYWRlcnMgQVMgJGtleSA9PiAkdmFsdWUg
KSB7CiAgICAgICAgJGtleSA9IHN0cl9yZXBsYWNlKAogICAgICAgICAgICAiICIsCiAgICAg
ICAgICAgICItIiwKICAgICAgICAgICAgdWN3b3JkcyhzdHJ0b2xvd2VyKHN0cl9yZXBsYWNl
KCItIiwgIiAiLCAka2V5KSkpCiAgICAgICAgICApOwogICAgICAgICRvdXRbJGtleV0gPSAk
dmFsdWU7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIC8vIG90aGVyd2lzZSB3ZSBkb24n
dCBoYXZlIGFwYWNoZSBhbmQgYXJlIGp1c3QgZ29pbmcgdG8gaGF2ZSB0byBob3BlCiAgICAg
IC8vIHRoYXQgJF9TRVJWRVIgYWN0dWFsbHkgY29udGFpbnMgd2hhdCB3ZSBuZWVkCiAgICAg
ICRvdXQgPSBhcnJheSgpOwogICAgICBpZiggaXNzZXQoJF9TRVJWRVJbJ0NPTlRFTlRfVFlQ
RSddKSApCiAgICAgICAgJG91dFsnQ29udGVudC1UeXBlJ10gPSAkX1NFUlZFUlsnQ09OVEVO
VF9UWVBFJ107CiAgICAgIGlmKCBpc3NldCgkX0VOVlsnQ09OVEVOVF9UWVBFJ10pICkKICAg
ICAgICAkb3V0WydDb250ZW50LVR5cGUnXSA9ICRfRU5WWydDT05URU5UX1RZUEUnXTsKCiAg
ICAgIGZvcmVhY2ggKCRfU0VSVkVSIGFzICRrZXkgPT4gJHZhbHVlKSB7CiAgICAgICAgaWYg
KHN1YnN0cigka2V5LCAwLCA1KSA9PSAiSFRUUF8iKSB7CiAgICAgICAgICAvLyB0aGlzIGlz
IGNoYW9zLCBiYXNpY2FsbHkgaXQgaXMganVzdCB0aGVyZSB0byBjYXBpdGFsaXplIHRoZSBm
aXJzdAogICAgICAgICAgLy8gbGV0dGVyIG9mIGV2ZXJ5IHdvcmQgdGhhdCBpcyBub3QgYW4g
aW5pdGlhbCBIVFRQIGFuZCBzdHJpcCBIVFRQCiAgICAgICAgICAvLyBjb2RlIGZyb20gcHJ6
ZW1lawogICAgICAgICAgJGtleSA9IHN0cl9yZXBsYWNlKAogICAgICAgICAgICAiICIsCiAg
ICAgICAgICAgICItIiwKICAgICAgICAgICAgdWN3b3JkcyhzdHJ0b2xvd2VyKHN0cl9yZXBs
YWNlKCJfIiwgIiAiLCBzdWJzdHIoJGtleSwgNSkpKSkKICAgICAgICAgICk7CiAgICAgICAg
ICAkb3V0WyRrZXldID0gJHZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0
dXJuICRvdXQ7CiAgfQoKICAvLyBUaGlzIGZ1bmN0aW9uIHRha2VzIGEgaW5wdXQgbGlrZSBh
PWImYT1jJmQ9ZSBhbmQgcmV0dXJucyB0aGUgcGFyc2VkCiAgLy8gcGFyYW1ldGVycyBsaWtl
IHRoaXMKICAvLyBhcnJheSgnYScgPT4gYXJyYXkoJ2InLCdjJyksICdkJyA9PiAnZScpCiAg
cHVibGljIHN0YXRpYyBmdW5jdGlvbiBwYXJzZV9wYXJhbWV0ZXJzKCAkaW5wdXQgKSB7CiAg
ICBpZiAoIWlzc2V0KCRpbnB1dCkgfHwgISRpbnB1dCkgcmV0dXJuIGFycmF5KCk7CgogICAg
JHBhaXJzID0gZXhwbG9kZSgnJicsICRpbnB1dCk7CgogICAgJHBhcnNlZF9wYXJhbWV0ZXJz
ID0gYXJyYXkoKTsKICAgIGZvcmVhY2ggKCRwYWlycyBhcyAkcGFpcikgewogICAgICAkc3Bs
aXQgPSBleHBsb2RlKCc9JywgJHBhaXIsIDIpOwogICAgICAkcGFyYW1ldGVyID0gT0F1dGhV
dGlsOjp1cmxkZWNvZGVfcmZjMzk4Nigkc3BsaXRbMF0pOwogICAgICAkdmFsdWUgPSBpc3Nl
dCgkc3BsaXRbMV0pID8gT0F1dGhVdGlsOjp1cmxkZWNvZGVfcmZjMzk4Nigkc3BsaXRbMV0p
IDogJyc7CgogICAgICBpZiAoaXNzZXQoJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJd
KSkgewogICAgICAgIC8vIFdlIGhhdmUgYWxyZWFkeSByZWNpZXZlZCBwYXJhbWV0ZXIocykg
d2l0aCB0aGlzIG5hbWUsIHNvIGFkZCB0byB0aGUgbGlzdAogICAgICAgIC8vIG9mIHBhcmFt
ZXRlcnMgd2l0aCB0aGlzIG5hbWUKCiAgICAgICAgaWYgKGlzX3NjYWxhcigkcGFyc2VkX3Bh
cmFtZXRlcnNbJHBhcmFtZXRlcl0pKSB7CiAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBmaXJz
dCBkdXBsaWNhdGUsIHNvIHRyYW5zZm9ybSBzY2FsYXIgKHN0cmluZykgaW50byBhbiBhcnJh
eQogICAgICAgICAgLy8gc28gd2UgY2FuIGFkZCB0aGUgZHVwbGljYXRlcwogICAgICAgICAg
JHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdID0gYXJyYXkoJHBhcnNlZF9wYXJhbWV0
ZXJzWyRwYXJhbWV0ZXJdKTsKICAgICAgICB9CgogICAgICAgICRwYXJzZWRfcGFyYW1ldGVy
c1skcGFyYW1ldGVyXVtdID0gJHZhbHVlOwogICAgICB9IGVsc2UgewogICAgICAgICRwYXJz
ZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSA9ICR2YWx1ZTsKICAgICAgfQogICAgfQogICAg
cmV0dXJuICRwYXJzZWRfcGFyYW1ldGVyczsKICB9CgogIHB1YmxpYyBzdGF0aWMgZnVuY3Rp
b24gYnVpbGRfaHR0cF9xdWVyeSgkcGFyYW1zKSB7CiAgICBpZiAoISRwYXJhbXMpIHJldHVy
biAnJzsKCiAgICAvLyBVcmxlbmNvZGUgYm90aCBrZXlzIGFuZCB2YWx1ZXMKICAgICRrZXlz
ID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NihhcnJheV9rZXlzKCRwYXJhbXMpKTsK
ICAgICR2YWx1ZXMgPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KGFycmF5X3ZhbHVl
cygkcGFyYW1zKSk7CiAgICAkcGFyYW1zID0gYXJyYXlfY29tYmluZSgka2V5cywgJHZhbHVl
cyk7CgogICAgLy8gUGFyYW1ldGVycyBhcmUgc29ydGVkIGJ5IG5hbWUsIHVzaW5nIGxleGlj
b2dyYXBoaWNhbCBieXRlIHZhbHVlIG9yZGVyaW5nLgogICAgLy8gUmVmOiBTcGVjOiA5LjEu
MSAoMSkKICAgIHVrc29ydCgkcGFyYW1zLCAnc3RyY21wJyk7CgogICAgJHBhaXJzID0gYXJy
YXkoKTsKICAgIGZvcmVhY2ggKCRwYXJhbXMgYXMgJHBhcmFtZXRlciA9PiAkdmFsdWUpIHsK
ICAgICAgaWYgKGlzX2FycmF5KCR2YWx1ZSkpIHsKICAgICAgICAvLyBJZiB0d28gb3IgbW9y
ZSBwYXJhbWV0ZXJzIHNoYXJlIHRoZSBzYW1lIG5hbWUsIHRoZXkgYXJlIHNvcnRlZCBieSB0
aGVpciB2YWx1ZQogICAgICAgIC8vIFJlZjogU3BlYzogOS4xLjEgKDEpCiAgICAgICAgbmF0
c29ydCgkdmFsdWUpOwogICAgICAgIGZvcmVhY2ggKCR2YWx1ZSBhcyAkZHVwbGljYXRlX3Zh
bHVlKSB7CiAgICAgICAgICAkcGFpcnNbXSA9ICRwYXJhbWV0ZXIgLiAnPScgLiAkZHVwbGlj
YXRlX3ZhbHVlOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAkcGFpcnNbXSA9
ICRwYXJhbWV0ZXIgLiAnPScgLiAkdmFsdWU7CiAgICAgIH0KICAgIH0KICAgIC8vIEZvciBl
YWNoIHBhcmFtZXRlciwgdGhlIG5hbWUgaXMgc2VwYXJhdGVkIGZyb20gdGhlIGNvcnJlc3Bv
bmRpbmcgdmFsdWUgYnkgYW4gJz0nIGNoYXJhY3RlciAoQVNDSUkgY29kZSA2MSkKICAgIC8v
IEVhY2ggbmFtZS12YWx1ZSBwYWlyIGlzIHNlcGFyYXRlZCBieSBhbiAnJicgY2hhcmFjdGVy
IChBU0NJSSBjb2RlIDM4KQogICAgcmV0dXJuIGltcGxvZGUoJyYnLCAkcGFpcnMpOwogIH0K
fSI7czozOiJtZDUiO3M6MzI6IjFhMWI4YjY2ZTg4YjMxYjM2ZTEyMzU4OWY0NzJlYjEwIjt9
