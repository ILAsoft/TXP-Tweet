# arc_twitter v2.0beta
# <a href="http://www.twitter.com">Twitter</a> for Textpattern
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjExOiJhcmNfdHdpdHRlciI7czo3OiJ2ZXJzaW9uIjtzOjc6
IjIuMGJldGEiO3M6NjoiYXV0aG9yIjtzOjExOiJBbmR5IENhcnRlciI7czoxMDoiYXV0aG9y
X3VyaSI7czozMToiaHR0cDovL3JlZGhvdGNoaWxsaXByb2plY3QuY29tLyI7czoxMToiZGVz
Y3JpcHRpb24iO3M6NjA6IjxhIGhyZWY9Imh0dHA6Ly93d3cudHdpdHRlci5jb20iPlR3aXR0
ZXI8L2E+IGZvciBUZXh0cGF0dGVybiI7czo1OiJvcmRlciI7czoxOiI1IjtzOjQ6InR5cGUi
O3M6MToiMSI7czo1OiJmbGFncyI7czoxOiIzIjtzOjQ6ImhlbHAiO3M6MTA5OTg6ImgxKHRp
dGxlKS4gVFhQIFR3ZWV0IChhcmNfdHdpdHRlciBmb3IgVGV4dHBhdHRlcm4pCgojICJBdXRo
b3IiOiNhcmNfdHdpdHRlcl9hdXRob3IKIyAiSW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxsYXRp
b24iOiNhcmNfdHdpdHRlcl9pbnN0YWxsYXRpb24KIyAiVGhlIGFyY190d2l0dGVyIHRhZyI6
I2FyY190d2l0dGVyX3RhZwojICJUaGUgYXJjX3R3aXR0ZXJfc2VhcmNoIHRhZyI6I2FyY190
d2l0dGVyX3NlYXJjaF90YWcKIyAiVGhlIGFyY190d2l0dGVyX3JldHdlZXQgdGFnIjojYXJj
X3R3aXR0ZXJfcmV0d2VldF90YWcKIyAiVGhlIGFyY190d2l0dGVyX3R3ZWV0X3VybCB0YWci
OiNhcmNfdHdpdHRlcl90d2VldF91cmwKIyAiVGhlIGFyY190d2l0dGVyX3Rpbnl1cmwgdGFn
IjojYXJjX3R3aXR0ZXJfdGlueXVybAojICJDYWNoaW5nIjojYXJjX3R3aXR0ZXJfY2FjaGlu
ZwojICJQcmVmZXJlbmNlcyI6I2FyY190d2l0dGVyX3ByZWZzCiMgIlR3ZWV0aW5nIGFydGlj
bGVzIjojYXJjX3R3aXR0ZXJfYXJ0aWNsZQojICJUaGUgVHdpdHRlciB0YWIiOiNhcmNfdHdp
dHRlcl9hZG1pbgoKVFhQIFR3ZWV0IHByb3ZpZGVzIGFjY2VzcyB0byB5b3VyIFR3aXR0ZXIg
YWNjb3VudCB0aHJvdWdoIGJvdGggdGhlIGFkbWluIGludGVyZmFjZSBhbmQgdGhlIHB1Ymxp
YyBzaWRlIG9mIHlvdXIgc2l0ZS4gVXBkYXRlIFR3aXR0ZXIgd2hlbiB5b3UgcG9zdCBhIG5l
dyBhcnRpY2xlICh3aXRoIGFydGljbGUtYnktYXJ0aWNsZSBvcHQgb3V0IG9wdGlvbiksIHVw
ZGF0ZSBhbmQgdmlldyB5b3VyIFR3aXR0ZXIgZmVlZCB0aHJvdWdoIHRoZSBhZG1pbiBUd2l0
dGVyIHRhYiwgYW5kIGRpc3BsYXkgVHdpdHRlciBmZWVkcyBvbiB5b3VyIHNpdGUuCgpSZXF1
aXJlbWVudHM6LQoKKiBUZXh0cGF0dGVybiA0LjIrCiogUEhQIDUgYW5kIGNVUkwKCmgyKHNl
Y3Rpb24jYXJjX3R3aXR0ZXJfYXV0aG9yKS4gQXV0aG9yCgoiQW5keSBDYXJ0ZXIiOmh0dHA6
Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbS4gRm9yIG90aGVyIFRleHRwYXR0ZXJuIHBsdWdp
bnMgYnkgbWUgdmlzaXQgbXkgIlBsdWdpbnMgcGFnZSI6aHR0cDovL3JlZGhvdGNoaWxsaXBy
b2plY3QuY29tL3R4cC4KCklmIHlvdSBsaWtlIHRoaXMgcGx1Z2luIGFuZCB3YW50IHRvIHNl
ZSBkZXZlbG9wbWVudCB3b3JrIGNvbnRpbnVlIHlvdSBjb3VsZCBjb25zaWRlciBzZW5kaW5n
IG1lIGEgc21hbGwgaW5jZW50aXZlOi0KCjxmb3JtIGFjdGlvbj0iaHR0cHM6Ly93d3cucGF5
cGFsLmNvbS9jZ2ktYmluL3dlYnNjciIgbWV0aG9kPSJwb3N0Ij4KPGlucHV0IHR5cGU9Imhp
ZGRlbiIgbmFtZT0iY21kIiB2YWx1ZT0iX3MteGNsaWNrIj4KPGlucHV0IHR5cGU9ImhpZGRl
biIgbmFtZT0iaG9zdGVkX2J1dHRvbl9pZCIgdmFsdWU9IkRGWUNSVVdSRVczVVkiPgo8aW5w
dXQgdHlwZT0iaW1hZ2UiIHNyYz0iaHR0cHM6Ly93d3cucGF5cGFsLmNvbS9lbl9HQi9pL2J0
bi9idG5fZG9uYXRlX1NNLmdpZiIgYm9yZGVyPSIwIiBuYW1lPSJzdWJtaXQiIGFsdD0iUGF5
UGFsIC0gVGhlIHNhZmVyLCBlYXNpZXIgd2F5IHRvIHBheSBvbmxpbmUuIj4KPGltZyBhbHQ9
IiIgYm9yZGVyPSIwIiBzcmM9Imh0dHBzOi8vd3d3LnBheXBhbC5jb20vZW5fR0IvaS9zY3Iv
cGl4ZWwuZ2lmIiB3aWR0aD0iMSIgaGVpZ2h0PSIxIj4KPC9mb3JtPgoKVGhhbmtzIHRvICJN
aWNoYWVsIE1hbmZyZSI6aHR0cDovL21hbmZyZS5uZXQvIGZvciBpbnNwaXJhdGlvbiBmb3Ig
dGhlIGFydGljbGUgdHdlZXQgcGFydCBvZiB0aGlzIHBsdWdpbiBiYXNlZCBvbiBoaXMgJSh0
YWcpbWVtX3R3aXR0ZXIlIHBsdWdpbi4gIEFkZGl0aW9uYWwgdGhhbmtzIHRvIHRoZSBncmVh
dCBUZXh0cGF0dGVybiBjb21tdW5pdHkgZm9yIGhlbHBpbmcgdG8gdGVzdCB0aGlzIHBsdWdp
biBhbmQgZm9yIHN1Z2dlc3RpbmcgbmV3IGZlYXR1cmVzLiBUaGUgT0F1dGggcGFydCBvZiB0
aGUgcGx1Z2luIGlzIHRoYW5rcyB0byAiQWJyYWhhbSBXaWxsaWFtcyI6aHR0cDovL3R3aXR0
ZXIuY29tL2FicmFoYW0uCgoKaDIoc2VjdGlvbiNhcmNfdHdpdHRlcl9pbnN0YWxsYXRpb24p
LiBJbnN0YWxsYXRpb24gLyBVbmluc3RhbGxhdGlvbgoKVG8gaW5zdGFsbCBnbyB0byB0aGUg
J3BsdWdpbnMnIHRhYiB1bmRlciAnYWRtaW4nIGFuZCBwYXN0ZSB0aGUgcGx1Z2luIGNvZGUg
aW50byB0aGUgJ0luc3RhbGwgcGx1Z2luJyBib3gsICd1cGxvYWQnIGFuZCB0aGVuICdpbnN0
YWxsJy4gRmluYWxseSBhY3RpdmF0ZSB0aGUgcGx1Z2luLgoKQmVmb3JlIHlvdSBzdGFydCB1
c2luZyAlKHRhZylhcmNfdHdpdHRlciUgeW91IHdpbGwgbmVlZCB0byBtYWtlIHN1cmUgdGhh
dCB0aGUgY2FjaGUgZGlyZWN0b3J5IGlzIHdyaXRhYmxlLiBTZWUgdGhlICdDYWNoaW5nJyBz
dWJzZWN0aW9uIGJlbG93IGZvciBmdXJ0aGVyIGluZm9ybWF0aW9uLgoKJSh0YWcpYXJjX3R3
aXR0ZXIlIHNob3VsZCBub3cgYmUgcmVhZHkgZm9yIHVzZSBvbiB0aGUgcHVibGljLXNpZGUg
b2YgeW91ciBzaXRlLgoKVG8gdW5sb2NrIHRoZSBhZG1pbiBmZWF0dXJlcyBvZiB0aGlzIHBs
dWdpbiB5b3Ugd2lsbCBuZWVkIHRvIGFzc29jaWF0ZSB5b3VyIHNpdGUgd2l0aCBhIFR3aXR0
ZXIgYWNjb3VudCBieSBjb25uZWN0aW5nIHRvIFR3aXR0ZXIgZnJvbSB0aGUgcGx1Z2luJ3Mg
b3B0aW9ucyBzY3JlZW4uIENsaWNrIG9uIHRoZSBsaW5rIHRvIGNvbm5lY3QgdG8gVHdpdHRl
ciwgeW91IHdpbGwgYmUgYXNrZWQgdG8gbG9naW4gdG8gVHdpdHRlciwgY2xpY2tpbmcgdGhp
cyBsaW5rIHdpbGwgdGVtcG9yYXJpbHkgdGFrZSB5b3UgdG8gdGhlIFR3aXR0ZXIgc2l0ZSB3
aGVyZSB5b3Ugd2lsbCBiZSBhc2tlZCB0byBsb2dpbiBhbmQgYXBwcm92ZSBhY2Nlc3MgZm9y
IFRYUCBUd2VldCB0byByZWFkIGFuZCB3cml0ZSB0byB5b3VyIFR3aXR0ZXIgYWNjb3VudC4g
SWYgYWxsIGlzIHN1Y2Nlc3NmdWwgeW91IHdpbGwgYmUgcmV0dXJuZWQgdG8gdGhlIG9wdGlv
bnMgc2NyZWVuIGFuZCB5b3VyIHVzZXIgbmFtZSB3aWxsIGFwcGVhci4KCkF0IGFueSB0aW1l
IHlvdSBjYW4gZGlzYXNzb2NpYXRlIHlvdXIgVHdpdHRlciBhY2NvdW50IHdpdGggVFhQIFR3
ZWV0IHZpYSB5b3VyIFR3aXR0ZXIgYWNjb3VudCBwcmVmZXJlbmNlcyBvbiB0aGUgIlR3aXR0
ZXIgd2Vic2l0ZSI6aHR0cDovL3d3dy50d2l0dGVyLmNvbS4KClRvIHVuaW5zdGFsbCAlKHRh
ZylhcmNfdHdpdHRlciUgc2ltcGx5IGRlbGV0ZSB0aGUgcGx1Z2luIGZyb20gdGhlICdQbHVn
aW5zJyB0YWIuICBUaGlzIHdpbGwgcmVtb3ZlIHRoZSBwbHVnaW4gY29kZSwgZGVsZXRlIHJl
bGF0ZWQgcHJlZmVyZW5jZXMgYW5kIGRyb3AgdGhlICUodGFnKWFyY190d2l0dGVyJSB0YWJs
ZSBmcm9tIHlvdXIgVGV4dHBhdHRlcm4gZGF0YWJhc2UuCgoKaDIoc2VjdGlvbiNhcmNfdHdp
dHRlcl90YWcpLiBUaGUgYXJjX3R3aXR0ZXIgdGFnCgpoMy4gU3ludGF4CgombHQ7dHhwOmFy
Y190d2l0dGVyIHVzZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZxdW90OyAvJmd0OwoKaDMuIFVz
YWdlCgp8Xy4gQXR0cmlidXRlfF8uIERlc2NyaXB0aW9ufF8uIERlZmF1bHR8Xy4gRXhhbXBs
ZXwKfHVzZXJ8VHdpdHRlciB1c2VyIG5hbWV8IF9hcmNfdHdpdHRlciB1c2VybmFtZV98dXNl
cj0mcXVvdDtkcm1vbmtleW5pbmphJnF1b3Q7fAp8bGltaXR8TWF4aW11bSBudW1iZXIgb2Yg
dHdlZXRzIHRvIGRpc3BsYXkgKG1heC4gMjAwKXwxMHxsaW1pdD0mcXVvdDsyNSZxdW90O3wK
fGRhdGVmb3JtYXR8Rm9ybWF0IHRoYXQgdXBkYXRlIGRhdGVzIHdpbGwgYXBwZWFyIGFzfCBf
QXJjaGl2ZSBkYXRlIGZvcm1hdF98ZGF0ZWZvcm1hdD0mcXVvdDslYiAlT2UsICVJOiVNICVw
JnF1b3Q7fAp8bGFiZWx8TGFiZWwgZm9yIHRoZSB0b3Agb2YgdGhlIGxpc3R8IF9ubyBsYWJl
bF98bGFiZWw9JnF1b3Q7TXkgVHdpdHRlciB0aW1lbGluZSZxdW90O3wKfGxhYmVsdGFnfElu
ZGVwZW5kZW50IHdyYXB0YWcgZm9yIGxhYmVsfCBfdW5zZXRffGxhYmVsdGFnPSZxdW90O2gz
JnF1b3Q7fAp8YnJlYWt8SFRNTCB0YWcgKHdpdGhvdXQgYnJhY2tldHMpLCBvciBzdHJpbmcs
IHVzZWQgdG8gc2VwYXJhdGUgdGhlIHVwZGF0ZXN8bGl8YnJlYWs9JnF1b3Q7YnImcXVvdDt8
Cnx3cmFwdGFnfEhUTUwgdGFnIHRvIGJlIHVzZWQgYXMgdGhlIHdyYXB0YWcsIHdpdGhvdXQg
YnJhY2tldHN8IF91bnNldF98d3JhcHRhZz0mcXVvdDt1bCZxdW90O3wKfGNsYXNzfENTUyBj
bGFzcyBhdHRyaWJ1dGUgZm9yIHdyYXB0YWd8YXJjX3R3aXR0ZXJ8Y2xhc3M9JnF1b3Q7dHdp
dHRlciZxdW90O3wKfGNsYXNzX3Bvc3RlZHxDU1MgY2xhc3MgYXR0cmlidXRlIGFwcGxpZWQg
dG8gc3BhbiB0YWcgYXJvdW5kIHBvc3RlZCBkYXRlfGFyY190d2l0dGVyLXBvc3RlZHwgfAoK
CmgzLiBFeGFtcGxlIHVzYWdlCgombHQ7dHhwOmFyY190d2l0dGVyIHVzZXI9JnF1b3Q7ZHJt
b25rZXluaW5qYSZxdW90OyBsaW1pdD0mcXVvdDs1JnF1b3Q7IHdyYXB0YWc9JnF1b3Q7dWwm
cXVvdDsgYnJlYWs9JnF1b3Q7bGkmcXVvdDsgZGF0ZWZvcm1hdD0mcXVvdDslYiAlT2UsICVJ
OiVNICVwJnF1b3Q7IC8mZ3Q7CgpQcm9kdWNlcyBhIGJ1bGxldCBwb2ludCBsaXN0IG9mIHRo
ZSBsYXN0IDUgVHdpdHRlciB1cGRhdGVzIGZyb20gZHJtb25rZXluaW5qYSdzIFR3aXR0ZXIg
ZmVlZCB3aXRoIGEgZGVmaW5lZCBkYXRlIGZvcm1hdCB0byBvdmVycmlkZSB0aGUgZGVmYXVs
dCBhcmNoaXZlIGRhdGUgZm9ybWF0LgoKCmgyKHNlY3Rpb24jYXJjX3R3aXR0ZXJfc2VhcmNo
X3RhZykuIFRoZSBhcmNfdHdpdHRlcl9zZWFyY2ggdGFnCgpoMy4gU3ludGF4CgombHQ7dHhw
OmFyY190d2l0dGVyX3NlYXJjaCBoYXNodGFncz0mcXVvdDt0eHAmcXVvdDsgLyZndDsKCmgz
LiBVc2FnZQoKfF8uIEF0dHJpYnV0ZXxfLiBEZXNjcmlwdGlvbnxfLiBEZWZhdWx0fF8uIEV4
YW1wbGV8CnxzZWFyY2h8Q29tbWEgc2VwYXJhdGVkIGxpc3Qgb2Ygc2VhcmNoIHdvcmRzfCBf
dW5zZXRffHNlYXJjaD0mcXVvdDt0eHAsdGV4dHBhdHRlcm4mcXVvdDt8CnxoYXNodGFnc3xD
b21tYSBzZXBhcmF0ZWQgbGlzdCBvZiBoYXNodGFncyB0byBzZWFyY2ggZm9yIChub3QgaW5j
bHVkaW5nIHRoZSBoYXNoKXwgX3Vuc2V0X3xoYXNodGFncz0mcXVvdDt0eHAsdGV4dHBhdHRl
cm4mcXVvdDt8CnxyZXBseXxVc2VybmFtZSBvZiB0d2VldHMgaW4gcmVwbHkgdG98IF91bnNl
dF98cmVwbHk9JnF1b3Q7dHdpdHRlciZxdW90O3wKfG1lbnRpb258VXNlcm5hbWUgb2YgdXNl
ciBtZW50aW9uZWQgaW4gdHdlZXRzIChfX2kuZS5fXyB0d2VldHMgY29udGFpbmluZyBAdXNl
cm5hbWUpfCBfdW5zZXRffG1lbnRpb249JnF1b3Q7dHdpdHRlciZxdW90O3wKfGxpbWl0fE1h
eGltdW0gbnVtYmVyIG9mIHR3ZWV0cyB0byBkaXNwbGF5IChtYXguIDIwMCl8MTB8bGltaXQ9
JnF1b3Q7MjUmcXVvdDt8CnxkYXRlZm9ybWF0fEZvcm1hdCB0aGF0IHVwZGF0ZSBkYXRlcyB3
aWxsIGFwcGVhciBhc3wgX0FyY2hpdmUgZGF0ZSBmb3JtYXRffGRhdGVmb3JtYXQ9JnF1b3Q7
JWIgJU9lLCAlSTolTSAlcCZxdW90O3wKfGxhYmVsfExhYmVsIGZvciB0aGUgdG9wIG9mIHRo
ZSBsaXN0fCBfbm8gbGFiZWxffCB8CnxsYWJlbHRhZ3xJbmRlcGVuZGVudCB3cmFwdGFnIGZv
ciBsYWJlbHwgX3Vuc2V0X3wgfAp8YnJlYWt8SFRNTCB0YWcgKHdpdGhvdXQgYnJhY2tldHMp
LCBvciBzdHJpbmcsIHVzZWQgdG8gc2VwYXJhdGUgdGhlIHVwZGF0ZXN8bGl8IHwKfHdyYXB0
YWd8SFRNTCB0YWcgdG8gYmUgdXNlZCBhcyB0aGUgd3JhcHRhZywgd2l0aG91dCBicmFja2V0
c3wgX3Vuc2V0X3wgfAp8Y2xhc3N8Q1NTIGNsYXNzIGF0dHJpYnV0ZSBmb3Igd3JhcHRhZ3xh
cmNfdHdpdHRlcl9zZWFyY2h8IHwKfGNsYXNzX3VzZXJ8Q1NTIGNsYXNzIGF0dHJpYnV0ZSBh
cHBsaWVkIHRvIHNwYW4gdGFnIGFyb3VuZCB1c2VyIG5hbWV8YXJjX3R3aXR0ZXItdXNlcnwg
fAp8Y2xhc3NfcG9zdGVkfENTUyBjbGFzcyBhdHRyaWJ1dGUgYXBwbGllZCB0byBzcGFuIHRh
ZyBhcm91bmQgcG9zdGVkIGRhdGV8YXJjX3R3aXR0ZXItcG9zdGVkfCB8CgpoMy4gRXhhbXBs
ZSB1c2FnZQoKJmx0O3R4cDphcmNfdHdpdHRlcl9zZWFyY2ggc2VhcmNoPSZxdW90O3BsdWdp
biZxdW90OyBoYXNodGFncz0mcXVvdDt0eHAsdGV4dHBhdHRlcm4mcXVvdDsgbGltaXQ9JnF1
b3Q7MjUmcXVvdDsgLyZndDsKClByb2R1Y2VzIGEgbGlzdCBvZiB0d2VldHMgY29udGFpbmlu
ZyB0aGUgd29yZCAncGx1Z2luJyBhbmQgdGhlIGhhc2h0YWdzICcjdHhwJyBhbmQgJyN0ZXh0
cGF0dGVybicuIFRoZSB0YWcgd2lsbCByZXR1cm4gYSBtYXhpbXVtIG9mIDI1IHR3ZWV0cy4K
CgpoMihzZWN0aW9uI2FyY190d2l0dGVyX3JldHdlZXRfdGFnKS4gVGhlIGFyY190d2l0dGVy
X3JldHdlZXQgdGFnCgpoMy4gU3ludGF4CgombHQ7dHhwOmFyY190d2l0dGVyX3JldHdlZXQg
LyZndDsKCmgzLiBVc2FnZQoKfF8uIEF0dHJpYnV0ZXxfLiBEZXNjcmlwdGlvbnxfLiBEZWZh
dWx0fF8uIEV4YW1wbGV8Cnx1c2VyfFR3aXR0ZXIgdXNlciBuYW1lIHRvIHF1b3RlfCBfYXJj
X3R3aXR0ZXIgdXNlcm5hbWVffHVzZXI9JnF1b3Q7ZHJtb25rZXluaW5qYSZxdW90O3wKfHVy
bHxVUkwgdG8gcmV0d2VldHwgfCB8Cnx0ZXh0fFJldHdlZXQgdGV4dHwgfCB8Cnxmb2xsb3cx
fFN1Z2dlc3RlZCBUd2l0dGVyIGFjY291bnQgdG8gZm9sbG93LCBmb3IgZXhhbXBsZSB5b3Vy
IG93bnxBIFR3aXR0ZXIgdXNlciB0byByZWNvbW1lbmR8Zm9sbG93MT0mcXVvdDtUZXh0cGF0
dGVybiZxdW90O3wKfGZvbGxvdzJ8QXMgZm9sbG93MXwgX3Vuc2V0X3wgfAp8bGFuZ3xMYW5n
dWFnZXxlbnxsYW5nPSZxdW90O2VzJnF1b3Q7fAp8Y291bnR8Q291bnQgYm94IHBvc2l0aW9u
LCBvcHRpb25zOiBub25lLCBob3Jpem9udGFsIG9yIHZlcnRpY2FsfGhvcml6b250YWx8Y291
bnQ9JnF1b3Q7bm9uZSZxdW90O3wKfGluY2x1ZGVfanN8V2hldGhlciBvciBub3QgdG8gaW5j
bHVkZSB0aGUgSmF2YVNjcmlwdHwxfGluY2x1ZGVfanM9JnF1b3Q7MCZxdW90O3wKfHdyYXB0
YWd8SFRNTCB0YWcgdG8gYmUgdXNlZCBhcyB0aGUgd3JhcHRhZywgd2l0aG91dCBicmFja2V0
c3wgX3Vuc2V0X3wgfAp8Y2xhc3N8Q1NTIGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVkIHRvIHRo
ZSByZXR3ZWV0IGJ1dHRvbnx0d2l0dGVyLXNoYXJlLWJ1dHRvbnwgfAoKCmgyKHNlY3Rpb24j
YXJjX3R3aXR0ZXJfdHdlZXRfdXJsKS4gYXJjX3R3aXR0ZXJfdHdlZXRfdXJsCgpSZXR1cm5z
IHRoZSBVUkwgb2YgdGhlIFR3aXR0ZXIgc3RhdHVzIGZvciBhbiBhcnRpY2xlLgoKaDMuIFN5
bnRheAoKJmx0O3R4cDphcmNfdHdpdHRlcl90d2VldF91cmwgLyZndDsKCiZsdDt0eHA6YXJj
X3R3aXR0ZXJfdHdlZXRfdXJsJmd0O0xpbmsgdGV4dCZsdDsvdHhwOmFyY190d2l0dGVyX3R3
ZWV0X3VybCZndDsKCmgzLiBVc2FnZQoKfF8uIEF0dHJpYnV0ZXxfLiBEZXNjcmlwdGlvbnxf
LiBEZWZhdWx0fF8uIEV4YW1wbGV8CnxpZHxUZXh0cGF0dGVybiBhcnRpY2xlIElEfCBfY3Vy
cmVudCBhcnRpY2xlX3xpZD0mcXVvdDsxJnF1b3Q7fAp8dGl0bGV8VGl0bGUgYXR0cmlidXRl
IG9mIHRoZSBsaW5rfCBfdW5zZXRffCB8CnxjbGFzc3xDU1MgY2xhc3MgYXR0cmlidXRlIGFw
cGxpZWQgdG8gdGhlIGxpbmt8IF91bnNldF98IHwKCgpoMihzZWN0aW9uI2FyY190d2l0dGVy
X3Rpbnl1cmwpLiBhcmNfdHdpdHRlcl90aW55dXJsCgpSZXR1cm5zIHRoZSBzaG9ydGVuZWQg
VVJMIG9mIHRoZSBhcnRpY2xlIHVzZWQgZm9yIHRoZSBUd2l0dGVyIHVwZGF0ZS4KCmgzLiBT
eW50YXgKCiZsdDt0eHA6YXJjX3R3aXR0ZXJfdGlueXVybCAvJmd0OwoKJmx0O3R4cDphcmNf
dHdpdHRlcl90aW55dXJsJmd0O0xpbmsgdGV4dCZsdDsvdHhwOmFyY190d2l0dGVyX3Rpbnl1
cmwmZ3Q7CgpoMy4gVXNhZ2UKCnxfLiBBdHRyaWJ1dGV8Xy4gRGVzY3JpcHRpb258Xy4gRGVm
YXVsdHxfLiBFeGFtcGxlfAp8aWR8VGV4dHBhdHRlcm4gYXJ0aWNsZSBJRHwgX2N1cnJlbnQg
YXJ0aWNsZV98aWQ9JnF1b3Q7MSZxdW90O3wKfHRpdGxlfFRpdGxlIGF0dHJpYnV0ZSBvZiB0
aGUgbGlua3wgX3Vuc2V0X3wgfAp8Y2xhc3N8Q1NTIGNsYXNzIGF0dHJpYnV0ZSBhcHBsaWVk
IHRvIHRoZSBsaW5rfCBfdW5zZXRffCB8CgoKaDIoc2VjdGlvbiNhcmNfdHdpdHRlcl9jYWNo
aW5nKS4gQ2FjaGluZwoKSW4gb3JkZXIgdG8gcHJldmVudCBleGNlc3NpdmUgcmVwZWF0aXRp
dmUgY2FsbHMgdG8gdGhlIFR3aXR0ZXIgd2Vic2l0ZSBpdCBpcyByZWNvbW1lbmRlZCB0byBj
YWNoZSByZXN1bHRzLiBUd2l0dGVyIGxpbWl0cyB0aGUgbnVtYmVyIG9mIGNhbGxzIHRocm91
Z2ggdGhlIEFQSSwgYW5kIGNvbnRpbnVvdXMgY2FsbHMgd2lsbCByZXN1bHQgaW4gVHdpdHRl
ciBjbG9zaW5nIHRvIGZ1cnRoZXIgcmVxdWVzdHMuIEJ5IGRlZmF1bHQsIGFyY190d2l0dGVy
IGNhY2hlcyBmb3IgMzAgbWludXRlIGludGVydmFscy4KCnxfLiBBdHRyaWJ1dGV8Xy4gRGVz
Y3JpcHRpb258Xy4gRGVmYXVsdHxfLiBFeGFtcGxlfAp8Y2FjaGluZ3wnMScgdG8gY2FjaGUg
ZmVlZCwgJzAnIHRvIHR1cm4gY2FjaGluZyBvZmYgKG5vdCByZWNvbW1lbmRlZCl8MXxjYWNo
aW5nPSZxdW90OzEmcXVvdDt8CnxjYWNoZV9kaXJ8QWJzb2x1dGUgcGF0aCB0byB0aGUgY2Fj
aGUgZGlyZWN0b3J5IChtdXN0IGJlIHdyaXRhYmxlKXwgX2FyY190d2l0dGVyIHByZWZlcmVu
Y2VzX3wgfAp8Y2FjaGVfdGltZXxUaW1lIGluIG1pbnV0ZXMgdGhhdCB0aGUgY2FjaGUgZmls
ZXMgYXJlIHN0b3JlZCBiZWZvcmUgYmVpbmcgcmVmcmVzaGVkfDV8Y2FjaGVfdGltZT0mcXVv
dDszMCZxdW90O3wKCgpUaGUgYWRtaW4gc2lkZSBvZiB0aGlzIHBsdWdpbiBlbmZvcmNlcyBj
YWNoaW5nLCBhcGFydCBmcm9tIHdoZW4gaXQgaXMgcG9zdGluZyB0byBUd2l0dGVyIChfX2Uu
Zy5fXyB3aGVuIHBvc3Rpbmcgb3IgZGVsZXRpbmcgYW4gdXBkYXRlKS4KCgpoMihzZWN0aW9u
I2FyY190d2l0dGVyX3ByZWZzKS4gUHJlZmVyZW5jZXMKCllvdSBjYW4gYWNjZXNzIHRoZSBw
bHVnaW5zIGNvcmUgcHJlZmVyZW5jZXMgZnJvbSBlaXRoZXIgdGhlIFByZWZlcmVuY2VzIG9y
IFBsdWdpbnMgdGFicyBpbiBhZG1pbi4gU2V0dXAgeW91ciBUd2l0dGVyIGFjY291bnQgKHlv
dSB3aWxsIGJlIGFza2VkIHRvIGNvbm5lY3QgdmlhIFR3aXR0ZXIgYW5kIHRoaXMgbmVlZHMg
ZG9pbmcgYmVmb3JlIHlvdSBjYW4gdXNlIHRoZSBwbHVnaW4pIGFuZCBjaGFuZ2UgdGhlIGNh
Y2hlIGRpcmVjdG9yeSB1c2luZyBhcmNfdHdpdHRlcidzIHByZWZlcmVuY2VzLiBXaXRob3V0
IHByb3ZpZGluZyB5b3VyIGFjY291bnQgbG9naW4gZGV0YWlscyB0aGUgYWRtaW4gYXJlYSBm
ZWF0dXJlcyBvZiB0aGlzIHBsdWdpbiB3aWxsIGJlIGluYWN0aXZlLgoKWW91IGNhbiBzZWxl
Y3QgdGhlIFVSTCBzaG9ydGVuZXIgbWV0aG9kIHlvdSB3YW50IHRvIHVzZSB0byBsaW5rIGJh
Y2sgdG8geW91ciBhcnRpY2xlIG9uIFR3aXR0ZXIuIFBsZWFzZSBub3RlIHRoYXQgaWYgeW91
IHNlbGVjdCBzbWRfc2hvcnRfdXJsIHlvdSB3aWxsIG5lZWQgdG8gaGF2ZSBpbnN0YWxsZWQg
YW5kIGFjdGl2YXRlZCB0aGUgIiUodGFnKXNtZF9zaG9ydF91cmwlIHBsdWdpbiI6aHR0cDov
L3RleHRwYXR0ZXJuLm9yZy9wbHVnaW5zLzEwOTkvc21kX3Nob3J0X3VybCBkZXZlbG9wZWQg
YnkgU3RlZiBEYXdzb24uCgoKaDIoc2VjdGlvbiNhcmNfdHdpdHRlcl9hcnRpY2xlKS4gVHdl
ZXRpbmcgYXJ0aWNsZXMKCkJ5IGRlZmF1bHQgYXJjX3R3aXR0ZXIgd2lsbCBwb3N0IGFuIHVw
ZGF0ZSB0byBUd2l0dGVyIGluY2x1ZGluZyBhIHNob3J0ZW5lZCBVUkwgdG8geW91ciBhcnRp
Y2xlLiBPbmx5IGxpdmUgYW5kIGFjdGl2ZSBhcnRpY2xlcyB3aWxsIGJlIHNlbnQgdG8gVHdp
dHRlciwgX19pLmUuX18gYXJ0aWNsZXMgcG9zdGVkIGluIHRoZSBmdXR1cmUgb3IgYXMgc3Rp
Y2t5IGFydGljbGVzIHdpbGwgbm90IGJlIHNlbnQuIElmIHlvdXIgYXJ0aWNsZSBpcyBzdWNj
ZXNzZnVsbHkgc3VibWl0dGVkIHRvIFR3aXR0ZXIgdGhlIHVwZGF0ZSB3aWxsIGFwcGVhciBp
biBwbGFjZSBvZiB0aGUgVHdpdHRlciBvcHRpb24gb24gdGhlIHJpZ2h0LWhhbmQtc2lkZSBv
ZiB0aGUgYXJ0aWNsZSBlZGl0IHNjcmVlbi4KClR3ZWV0cyBhcmUgc2VudCBpbiB0aGUgZm9s
bG93aW5nIGZvcm1hdDogW19Ud2VldCBwcmVmaXhfXSBbX0FydGljbGUgdGl0bGVfXSBbX1No
b3J0ZW5lZCBVUkxfXSBbX1R3ZWV0IHN1ZmZpeF9dLiBZb3UgY2FuIGNoYW5nZSB0aGUgcHJl
Zml4IGFuZCBzdWZmaXggb24gYW4gYXJ0aWNsZS1ieS1hcnRpY2xlIGJhc2lzIGJ5IGNoYW5n
aW5nIHRoZSB0d2VldCBvcHRpb25zIHVuZGVyICdVcGRhdGUgVHdpdHRlcicgb24gdGhlIGFy
dGljbGUgZWRpdG9yIHNjcmVlbi4gVGhlIGRlZmF1bHQgX1R3ZWV0IHByZWZpeF8gY2FuIGJl
IHNldCB1bmRlciB0aGUgJSh0YWcpYXJjX3R3aXR0ZXIlIHByZWZlcmVuY2VzIHNjcmVlbiAo
dGhlIGRlZmF1bHQgb24gaW5zdGFsbGF0aW9uIGlzICJKdXN0IHBvc3RlZDoiKS4KClBsZWFz
ZSBub3RlIHRoYXQgb25jZSBhbiBhcnRpY2xlIGhhcyBiZWVuIHR3ZWV0ZWQgdGhlIHR3ZWV0
IGNhbm5vdCBiZSBlZGl0ZWQuCgoKaDIoc2VjdGlvbiNhcmNfdHdpdHRlcl9hZG1pbikuIFRo
ZSBUd2l0dGVyIHRhYgoKVW5kZXIgdGhlIEV4dGVuc2lvbnMgdGFiICh0aGlzIGNhbiBiZSBj
aGFuZ2VkIGZyb20gdGhlIHBsdWdpbidzIHByZWZlcmVuY2UgcGFnZSkgYSBuZXcgVHdpdHRl
ciB0YWIgc2hvdWxkIGFwcGVhciBvbmNlIHlvdSBoYXZlIGNvbm5lY3RlZCB5b3VyIHNpdGUg
dG8geW91ciBUd2l0dGVyIGFjY291bnQuIEZyb20gaGVyZSB5b3Ugd2lsbCBiZSBhYmxlIHRv
IHN1Ym1pdCBuZXcgVHdpdHRlciB1cGRhdGVzLCB2aWV3IGJhc2ljIGFjY291bnQgc3RhdGlz
dGljcywgYW5kIGNoZWNrIG91dCB5b3VyIHJlY2VudCB1cGRhdGVzIChpbmNsdWRpbmcgdGhl
IG9wdGlvbiB0byBkZWxldGUgeW91ciB0d2VldHMpLiI7czo0OiJjb2RlIjtzOjY3Mjg2OiJn
bG9iYWwgJHByZWZzLCR0eHBjZmcsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCRhcmNfdHdp
dHRlcl9jb25zdW1lclNlY3JldDsKCiRhcmNfdHdpdHRlciA9IGFycmF5KCk7CgokYXJjX3R3
aXR0ZXJfY29uc3VtZXJLZXkgPSAnbktjWHNsd3paaEJkMGtmS01ldG5QQSc7CiRhcmNfdHdp
dHRlcl9jb25zdW1lclNlY3JldCA9ICdDNm5TUENMM2VlSEdUQmhLQ2d3ZDlvY2xjdUQwc3JC
OFdWa2ZYUVlDNTQnOwoKYWRkX3ByaXZzKCdwbHVnaW5fcHJlZnMuYXJjX3R3aXR0ZXInLCcx
LDInKTsKcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY190d2l0dGVyX2luc3RhbGwnLCdwbHVnaW5f
bGlmZWN5Y2xlLmFyY190d2l0dGVyJywgJ2luc3RhbGxlZCcpOwpyZWdpc3Rlcl9jYWxsYmFj
aygnYXJjX3R3aXR0ZXJfdW5pbnN0YWxsJywncGx1Z2luX2xpZmVjeWNsZS5hcmNfdHdpdHRl
cicsICdkZWxldGVkJyk7CnJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfdHdpdHRlcl9wcmVmcycs
J3BsdWdpbl9wcmVmcy5hcmNfdHdpdHRlcicpOwoKCmlmICghaXNzZXQoJHByZWZzWydhcmNf
dHdpdHRlcl91c2VyJ10pKQogICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3VzZXInLCAnJywg
J2FyY190d2l0dGVyJywgMSwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3NldCgkcHJlZnNbJ2Fy
Y190d2l0dGVyX3ByZWZpeCddKSkKICBzZXRfcHJlZignYXJjX3R3aXR0ZXJfcHJlZml4Jywn
SnVzdCBwb3N0ZWQ6JywgJ2FyY190d2l0dGVyJywgMiwgJ3RleHRfaW5wdXQnKTsKaWYgKCFp
c3NldCgkcHJlZnNbJ2FyY190d2l0dGVyX2NhY2hlX2RpciddKSkKICBzZXRfcHJlZignYXJj
X3R3aXR0ZXJfY2FjaGVfZGlyJywkdHhwY2ZnWyd0eHBhdGgnXS4kcHJlZnNbJ3RlbXBkaXIn
XSwgJ2FyY190d2l0dGVyJywgMSwgJ3RleHRfaW5wdXQnKTsKaWYgKCFpc3NldCgkcHJlZnNb
J2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnXSkpCiAgc2V0X3ByZWYoJ2FyY190d2l0dGVy
X3R3ZWV0X2RlZmF1bHQnLCAxLCAnYXJjX3R3aXR0ZXInLCAyLCAneWVzbm9SYWRpbycpOwpp
ZiAoIWlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCddKSkKICBzZXRfcHJl
ZignYXJjX3R3aXR0ZXJfdXJsX21ldGhvZCcsICd0aW55dXJsJywgJ2FyY190d2l0dGVyJywg
MiwKICAgICdhcmNfdHdpdHRlcl91cmxfbWV0aG9kX3NlbGVjdCcpOwovLyBNYWtlIHN1cmUg
dGhhdCB0aGUgVHdpdHRlciB0YWIgaGFzIGJlZW4gZGVmaW5lZAppZiAoIWlzc2V0KCRwcmVm
c1snYXJjX3R3aXR0ZXJfdGFiJ10pKSB7CiAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3RhYics
ICdleHRlbnNpb25zJywgJ2FyY190d2l0dGVyJywgMiwKICAgICdhcmNfdHdpdHRlcl90YWJf
c2VsZWN0Jyk7CiAgICAkcHJlZnNbJ2FyY190d2l0dGVyX3RhYiddID0gJ2V4dGVuc2lvbnMn
Owp9CgppZiAoQHR4cGludGVyZmFjZSA9PSAnYWRtaW4nKSB7CiAgICBpZiAoIWVtcHR5KCRw
cmVmc1snYXJjX3R3aXR0ZXJfdXNlciddKQogICAgICAgICYmICFlbXB0eSgkcHJlZnNbJ2Fy
Y190d2l0dGVyX2FjY2Vzc1Rva2VuJ10pCiAgICAgICAgJiYgIWVtcHR5KCRwcmVmc1snYXJj
X3R3aXR0ZXJfYWNjZXNzVG9rZW5TZWNyZXQnXSkgKSB7CgogICAgICAgIGlmICgkcHJlZnNb
J2FyY190d2l0dGVyX3RhYiddKSB7CiAgICAgICAgICAgIGFkZF9wcml2cygnYXJjX2FkbWlu
X3R3aXR0ZXInLCAnMSwyLDMsNCcpOwogICAgICAgICAgICByZWdpc3Rlcl90YWIoJHByZWZz
WydhcmNfdHdpdHRlcl90YWInXSwgJ2FyY19hZG1pbl90d2l0dGVyJywgJ1R3aXR0ZXInKTsK
ICAgICAgICAgICAgcmVnaXN0ZXJfY2FsbGJhY2soJ2FyY19hZG1pbl90d2l0dGVyJywgJ2Fy
Y19hZG1pbl90d2l0dGVyJyk7CiAgICAgICAgfQoKICAgICAgICByZWdpc3Rlcl9jYWxsYmFj
aygnYXJjX2FydGljbGVfdHdlZXQnLCAncGluZycpOwogICAgICAgIHJlZ2lzdGVyX2NhbGxi
YWNrKCdhcmNfYXJ0aWNsZV90d2VldCcsICdhcnRpY2xlJywgJ2VkaXQnLCAxKTsKICAgICAg
ICByZWdpc3Rlcl9jYWxsYmFjaygnYXJjX2FwcGVuZF90d2l0dGVyJywgJ2FydGljbGVfdWkn
LCAnc3RhdHVzJyk7CiAgICB9Cn0KCi8qCiAgICBQdWJsaWMtc2lkZSBmdW5jdGlvbnMKICAg
ID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0KKi8KCmZ1bmN0aW9uIGFyY190d2l0dGVyKCRhdHRzKQp7CiAgZ2xvYmFs
ICRwcmVmcywkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXksICRhcmNfdHdpdHRlcl9jb25zdW1l
clNlY3JldDsKCiAgZXh0cmFjdChsQXR0cyhhcnJheSgKICAgICd1c2VyJyAgICAgID0+ICRw
cmVmc1snYXJjX3R3aXR0ZXJfdXNlciddLAogICAgJ3Bhc3N3b3JkJyAgPT4gJycsCiAgICAn
dGltZWxpbmUnICA9PiAndXNlcicsCiAgICAnbGltaXQnICAgICA9PiAnMTAnLAogICAgJ3Jl
dHdlZXRzJyAgPT4gZmFsc2UsCiAgICAnZGF0ZWZvcm1hdCc9PiAkcHJlZnNbJ2FyY2hpdmVf
ZGF0ZWZvcm1hdCddLAogICAgJ2NhY2hpbmcnICAgPT4gJzEnLAogICAgJ2NhY2hlX2Rpcicg
PT4gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXSwKICAgICdjYWNoZV90aW1lJz0+
ICc1JywKICAgICdsYWJlbCcgICAgID0+ICcnLAogICAgJ2xhYmVsdGFnJyAgPT4gJycsCiAg
ICAnYnJlYWsnICAgICA9PiAnbGknLAogICAgJ3dyYXB0YWcnICAgPT4gJycsCiAgICAnY2xh
c3MnICAgICA9PiBfX0ZVTkNUSU9OX18sCiAgICAnY2xhc3NfcG9zdGVkJyA9PiBfX0ZVTkNU
SU9OX18uJy1wb3N0ZWQnCiAgICApLCRhdHRzKSk7CgogICR0d2l0ID0gbmV3IGFyY19Ud2l0
dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2Vj
cmV0KTsKCiAgaWYgKCRjYWNoaW5nKSB7ICAvLyB0dXJuIG9uIGNhY2hpbmcsIHJlY29tbWVu
ZGVkIChkZWZhdWx0KQogICAgJHR3aXQtPnNldENhY2hpbmcodHJ1ZSk7CiAgICAkdHdpdC0+
Y2FjaGVEaXIoJGNhY2hlX2Rpcik7CiAgICAkdHdpdC0+Y2FjaGVUaW1lKCRjYWNoZV90aW1l
KTsKICB9IGVsc2UgeyAgLy8gdHVybiBvZmYgY2FjaGluZywgbm90IHJlY29tbWVuZGVkIG90
aGVyIHRoYW4gZm9yIHRlc3RpbmcKICAgICR0d2l0LT5zZXRDYWNoaW5nKGZhbHNlKTsKICB9
CgogIHN3aXRjaCAoJHRpbWVsaW5lKSB7CiAgICBjYXNlICdob21lJzogY2FzZSAnZnJpZW5k
cyc6CiAgICAgICR0aW1lbGluZSA9ICdzdGF0dXNlcy9mcmllbmRzX3RpbWVsaW5lJzsgYnJl
YWs7CiAgICBjYXNlICdtZW50aW9ucyc6CiAgICAgICR0aW1lbGluZSA9ICdzdGF0dXNlcy9t
ZW50aW9ucyc7IGJyZWFrOwogICAgY2FzZSAndXNlcic6IGRlZmF1bHQ6ICR0aW1lbGluZSA9
ICdzdGF0dXNlcy91c2VyX3RpbWVsaW5lJzsKICB9CgogICRvdXQgPSBhcnJheSgpOwogICR4
bWwgPSAkdHdpdC0+Z2V0KCR0aW1lbGluZQogICAgLCBhcnJheSgnc2NyZWVuX25hbWUnPT4k
dXNlciwnY291bnQnPT4kbGltaXQsJ2luY2x1ZGVfcnRzJz0+JHJldHdlZXRzKSk7CiAgaWYg
KCR4bWwpIHsKICAgICR0d2VldHMgPSBAJHhtbC0+eHBhdGgoJy9zdGF0dXNlcy9zdGF0dXMn
KTsKICAgIGlmICgkdHdlZXRzKSBmb3JlYWNoICgkdHdlZXRzIGFzICR0d2VldCkgewogICAg
ICAkdGltZSA9IHN0cnRvdGltZShodG1sZW50aXRpZXMoJHR3ZWV0LT5jcmVhdGVkX2F0KSk7
CiAgICAgICRkYXRlID0gc2FmZV9zdHJmdGltZSgkZGF0ZWZvcm1hdCwkdGltZSk7CiAgICAg
ICRvdXRbXSA9IGFyY19Ud2l0dGVyOjptYWtlTGlua3MoaHRtbGVudGl0aWVzKCR0d2VldC0+
dGV4dCwgRU5UX1FVT1RFUywnVVRGLTgnKSkKICAgICAgICAuJyAnLnRhZyhodG1sZW50aXRp
ZXMoJGRhdGUpLCdzcGFuJywnIGNsYXNzPSInLiRjbGFzc19wb3N0ZWQuJyInKTsKICAgIH0K
CiAgICByZXR1cm4gZG9MYWJlbCgkbGFiZWwsICRsYWJlbHRhZykuZG9XcmFwKCRvdXQsICR3
cmFwdGFnLCAkYnJlYWssICRjbGFzcyk7CiAgfQoKfQoKZnVuY3Rpb24gYXJjX3R3aXR0ZXJf
c2VhcmNoKCRhdHRzKQp7CiAgICBnbG9iYWwgJHByZWZzLCRhcmNfdHdpdHRlcl9jb25zdW1l
cktleSwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgIGV4dHJhY3QobEF0dHMo
YXJyYXkoCiAgICAgICAgJ3VzZXInICAgICAgPT4gJHByZWZzWydhcmNfdHdpdHRlcl91c2Vy
J10sCiAgICAgICAgJ3NlYXJjaCcgICAgPT4gJycsCiAgICAgICAgJ2hhc2h0YWdzJyAgPT4g
JycsCiAgICAgICAgJ3VzZXInICAgICAgPT4gJycsCiAgICAgICAgJ3JlcGx5JyAgICAgPT4g
JycsCiAgICAgICAgJ21lbnRpb24nICAgPT4gJycsCiAgICAgICAgJ2xpbWl0JyAgICAgPT4g
JzEwJywKICAgICAgICAnbGFuZycgICAgICA9PiAnJywKICAgICAgICAnZGF0ZWZvcm1hdCc9
PiAkcHJlZnNbJ2FyY2hpdmVfZGF0ZWZvcm1hdCddLAogICAgICAgICdjYWNoaW5nJyAgID0+
ICcxJywKICAgICAgICAnY2FjaGVfZGlyJyA9PiAkcHJlZnNbJ2FyY190d2l0dGVyX2NhY2hl
X2RpciddLAogICAgICAgICdjYWNoZV90aW1lJz0+ICc1JywKICAgICAgICAnbGFiZWwnICAg
ICA9PiAnJywKICAgICAgICAnbGFiZWx0YWcnICA9PiAnJywKICAgICAgICAnYnJlYWsnICAg
ICA9PiAnbGknLAogICAgICAgICd3cmFwdGFnJyAgID0+ICcnLAogICAgICAgICdjbGFzcycg
ICAgID0+IF9fRlVOQ1RJT05fXywKICAgICAgICAnY2xhc3NfcG9zdGVkJyA9PiBfX0ZVTkNU
SU9OX18uJy1wb3N0ZWQnLAogICAgICAgICdjbGFzc191c2VyJyAgID0+IF9fRlVOQ1RJT05f
Xy4nLXVzZXInCiAgICApLCRhdHRzKSk7CgogICAgICAgICR0d2l0ID0gbmV3IGFyY19Ud2l0
dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAsICRhcmNfdHdpdHRl
cl9jb25zdW1lclNlY3JldCk7CgogICAgICAgIGlmICgkY2FjaGluZykgeyAgLy8gdHVybiBv
biBjYWNoaW5nLCByZWNvbW1lbmRlZCAoZGVmYXVsdCkKICAgICAgICAgICAgJHR3aXQtPnNl
dENhY2hpbmcodHJ1ZSk7CiAgICAgICAgICAgICR0d2l0LT5jYWNoZURpcigkY2FjaGVfZGly
KTsKICAgICAgICAgICAgJHR3aXQtPmNhY2hlVGltZSgkY2FjaGVfdGltZSk7CiAgICAgICAg
fSBlbHNlIHsgIC8vIHR1cm4gb2ZmIGNhY2hpbmcsIG5vdCByZWNvbW1lbmRlZCBvdGhlciB0
aGFuIGZvciB0ZXN0aW5nCiAgICAgICAgICAgICR0d2l0LT5zZXRDYWNoaW5nKGZhbHNlKTsK
ICAgICAgICB9CgogICAgICAgIC8vIGNvbnN0cnVjdCBzZWFyY2ggcXVlcnkKICAgICAgICBp
ZiAoIWVtcHR5KCRzZWFyY2gpKSB7CiAgICAgICAgICAgICR0ZXJtcyA9IGV4cGxvZGUoJywn
LCRzZWFyY2gpOyAkdGVybXMgPSBhcnJheV9tYXAoJ3RyaW0nLCR0ZXJtcyk7CiAgICAgICAg
ICAgICRzZWFyY2ggPSBpbXBsb2RlKCcgJywkdGVybXMpOwogICAgICAgIH0KICAgICAgICBp
ZiAoJGhhc2h0YWdzKSB7CiAgICAgICAgICAgICRoYXNoZXMgPSBleHBsb2RlKCcsJywkaGFz
aHRhZ3MpOyAkaGFzaGVzID0gYXJyYXlfbWFwKCd0cmltJywkaGFzaGVzKTsKICAgICAgICAg
ICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/JyAnOicnKS4nIycuaW1wbG9kZSgnICMnLCRoYXNo
ZXMpOwogICAgICAgIH0KICAgICAgICBpZiAoJHJlcGx5KSB7CiAgICAgICAgICAgICRzZWFy
Y2guPSAoKCRzZWFyY2gpPycgJzonJykuJ3RvOicudHJpbSgkcmVwbHkpOwogICAgICAgIH0K
ICAgICAgICBpZiAoJHVzZXIpIHsKICAgICAgICAgICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/
JyAnOicnKS4nZnJvbTonLnRyaW0oJHVzZXIpOwogICAgICAgIH0KICAgICAgICBpZiAoJG1l
bnRpb24pIHsKICAgICAgICAgICAgJHNlYXJjaC49ICgoJHNlYXJjaCk/JyAnOicnKS4nQCcu
dHJpbSgkbWVudGlvbik7CiAgICAgICAgfQoKICAgICAgICBpZiAoZW1wdHkoJHNlYXJjaCkp
IHsKICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg
ICRzZWFyY2ggPSB1cmxlbmNvZGUoJHNlYXJjaCk7CiAgICAgICAgfQoKICAgICAgICAkb3V0
ID0gYXJyYXkoKTsKICAgICAgICAkdHdlZXRzID0gJHR3aXQtPmdldCgnaHR0cDovL3NlYXJj
aC50d2l0dGVyLmNvbS9zZWFyY2guYXRvbT9xPScuJHNlYXJjaAogICAgICAgICAgICAsIGFy
cmF5KCdycHAnPT4kbGltaXQsJ2xhbmcnPT4kbGFuZykpOwoKICAgICAgICBpZiAoJHR3ZWV0
cykgeyBmb3JlYWNoICgkdHdlZXRzLT5lbnRyeSBhcyAkdHdlZXQpIHsKICAgICAgICAgICAg
cHJlZ19tYXRjaCgiLyguKikgXCgoLiopXCkvIiwkdHdlZXQtPmF1dGhvci0+bmFtZSwkbWF0
Y2hlcyk7CiAgICAgICAgICAgIGxpc3QoJGF1dGhvciwkdW5hbWUsJG5hbWUpID0gJG1hdGNo
ZXM7CiAgICAgICAgICAgICR0aW1lID0gc3RydG90aW1lKGh0bWxlbnRpdGllcygkdHdlZXQt
PnB1Ymxpc2hlZCkpOwogICAgICAgICAgICAkZGF0ZSA9IHNhZmVfc3RyZnRpbWUoJGRhdGVm
b3JtYXQsJHRpbWUpOwogICAgICAgICAgICAkdGV4dCA9ICR0d2VldC0+dGl0bGU7CiAgICAg
ICAgICAgICRvdXRbXSA9IHRhZyhocmVmKGh0bWxlbnRpdGllcygkdW5hbWUpLCR0d2VldC0+
YXV0aG9yLT51cmksCiAgICAgICAgICAgICAgICAnIHRpdGxlPSInLmh0bWxlbnRpdGllcygk
bmFtZSkuJyInKS4nOiAnLCdzcGFuJwogICAgICAgICAgICAgICAgICAgICwnIGNsYXNzPSIn
LiRjbGFzc191c2VyLiciJykKICAgICAgICAgICAgICAgIC5hcmNfVHdpdHRlcjo6bWFrZUxp
bmtzKGh0bWxlbnRpdGllcygkdGV4dCwgRU5UX1FVT1RFUywnVVRGLTgnKSkKICAgICAgICAg
ICAgICAgIC4nICcudGFnKGh0bWxlbnRpdGllcygkZGF0ZSksJ3NwYW4nCiAgICAgICAgICAg
ICAgICAgICAgLCcgY2xhc3M9IicuJGNsYXNzX3Bvc3RlZC4nIicpOwogICAgICAgIH0gcmV0
dXJuIGRvTGFiZWwoJGxhYmVsLCAkbGFiZWx0YWcpCiAgICAgICAgICAgIC5kb1dyYXAoJG91
dCwgJHdyYXB0YWcsICRicmVhaywgJGNsYXNzKTsgfQoKfQoKZnVuY3Rpb24gYXJjX3R3aXR0
ZXJfdHdlZXQoJGF0dHMpIHsKICAgIGdsb2JhbCAkdGhpc2FydGljbGU7CgogICAgZXh0cmFj
dChsQXR0cyhhcnJheSgKICAgICAgJ2lkJyAgICAgICAgPT4gJHRoaXNhcnRpY2xlWyd0aGlz
aWQnXSwKICAgICAgJ2luY2x1ZGVfdXJsJyAgID0+IHRydWUKICAgICksJGF0dHMpKTsKCiAg
ICBpZiAoJGlkKSB7CiAgICAgIC8vIEZldGNoIGFyY190d2l0dGVyIHN0dWZmIHRvIGJ1aWxk
IHR3ZWV0IGZyb20KICAgICAgJHR3ZWV0ID0gKCRpbmNsdWRlX3VybCkgPyBzYWZlX3Jvdygi
dHdlZXQiLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlkfSIpCiAgICAgICAgOiBz
YWZlX3JvdygiUkVQTEFDRSh0d2VldCxDT05DQVQoJyAnLHRpbnl1cmwpLCcnKSBBUyB0d2Vl
dCIKICAgICAgICAgICwgJ2FyY190d2l0dGVyJywgImFydGljbGVfaWQ9eyRpZH0iKTsKICAg
IH0KCiAgICBpZiAoJHR3ZWV0Wyd0d2VldCddKSB7CiAgICAgIHJldHVybiBhcmNfVHdpdHRl
cjo6bWFrZUxpbmtzKAogICAgICAgIGh0bWxlbnRpdGllcygkdHdlZXRbJ3R3ZWV0J10sIEVO
VF9RVU9URVMsJ1VURi04JykpOwogICAgfQp9CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl90d2Vl
dF91cmwoJGF0dHMsICR0aGluZz1udWxsKSB7CiAgICBnbG9iYWwgJHRoaXNhcnRpY2xlLCRw
cmVmczsKCiAgICBleHRyYWN0KGxBdHRzKGFycmF5KAogICAgICAnaWQnICAgICAgPT4gJHRo
aXNhcnRpY2xlWyd0aGlzaWQnXSwKICAgICAgJ3RpdGxlJyAgID0+ICcnLAogICAgICAnY2xh
c3MnICAgPT4gJycKICAgICksJGF0dHMpKTsKCiAgICBpZiAoJGlkKSB7CiAgICAgIC8vIEZl
dGNoIGFyY190d2l0dGVyIHN0dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAgICAgJHR3ZWV0
ID0gc2FmZV9yb3coInR3ZWV0X2lkIgogICAgICAgICwgJ2FyY190d2l0dGVyJywgImFydGlj
bGVfaWQ9eyRpZH0iKTsKICAgIH0KCiAgICBpZiAoJHR3ZWV0Wyd0d2VldF9pZCddKSB7CiAg
ICAgICR1cmwgPSAiaHR0cDovL3R3aXR0ZXIuY29tLyIuJHByZWZzWydhcmNfdHdpdHRlcl91
c2VyJ10uIi9zdGF0dXMvIi4kdHdlZXRbJ3R3ZWV0X2lkJ107CiAgICAgIGlmICgkdGhpbmc9
PT1udWxsKSB7CiAgICAgICAgcmV0dXJuICR1cmw7CiAgICAgIH0KICAgICAgcmV0dXJuIGhy
ZWYocGFyc2UoJHRoaW5nKSwgJHVybCwKICAgICAgICAoJHRpdGxlID8gJyB0aXRsZT0iJy4k
dGl0bGUuJyInIDogJycpCiAgICAgICAgLigkY2xhc3MgPyAnIGNsYXNzPSInLiRjbGFzcy4n
IicgOiAnJykpOwogICAgfQp9CgpmdW5jdGlvbiBhcmNfdHdpdHRlcl90aW55dXJsKCRhdHRz
LCAkdGhpbmc9bnVsbCkgewogICAgZ2xvYmFsICR0aGlzYXJ0aWNsZTsKCiAgICBleHRyYWN0
KGxBdHRzKGFycmF5KAogICAgICAnaWQnICAgICAgPT4gJHRoaXNhcnRpY2xlWyd0aGlzaWQn
XSwKICAgICAgJ3RpdGxlJyAgID0+ICcnLAogICAgICAnY2xhc3MnICAgPT4gJycKICAgICks
JGF0dHMpKTsKCiAgICBpZiAoJGlkKSB7CiAgICAgIC8vIEZldGNoIGFyY190d2l0dGVyIHN0
dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAgICAgJHR3ZWV0ID0gc2FmZV9yb3coInRpbnl1
cmwiCiAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNsZV9pZD17JGlkfSIpOwogICAg
fQoKICAgIGlmICgkdHdlZXRbJ3Rpbnl1cmwnXSkgewogICAgICBpZiAoJHRoaW5nPT09bnVs
bCkgewogICAgICAgIHJldHVybiAkdHdlZXRbJ3Rpbnl1cmwnXTsKICAgICAgfQoKICAgICAg
cmV0dXJuIGhyZWYocGFyc2UoJHRoaW5nKSwgJHR3ZWV0Wyd0aW55dXJsJ10sCiAgICAgICAg
KCR0aXRsZSA/ICcgdGl0bGU9IicuJHRpdGxlLiciJyA6ICcnKQogICAgICAgIC4oJGNsYXNz
ID8gJyBjbGFzcz0iJy4kY2xhc3MuJyInIDogJycpKTsKICAgIH0KfQoKZnVuY3Rpb24gYXJj
X3R3aXR0ZXJfcmV0d2VldCgkYXR0cywgJHRoaW5nPW51bGwpCnsKICAgIGdsb2JhbCAkcHJl
ZnMsJGFyY190d2l0dGVyX2NvbnN1bWVyS2V5LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNy
ZXQ7CiAgICBnbG9iYWwgJHRoaXNhcnRpY2xlOwoKICAgIGV4dHJhY3QobEF0dHMoYXJyYXko
CiAgICAgICAgJ3VzZXInICAgICAgPT4gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10sIC8v
IHZpYSB1c2VyIGFjY291bnQKICAgICAgICAndXJsJyAgICAgICA9PiAnJywKICAgICAgICAn
dGV4dCcgICAgICA9PiAnJywKICAgICAgICAnZm9sbG93MScgICA9PiAnJywKICAgICAgICAn
Zm9sbG93MicgICA9PiAnJywKICAgICAgICAnbGFuZycgICAgICA9PiAnJywKICAgICAgICAn
Y291bnQnICAgICA9PiAnaG9yaXpvbnRhbCcsCiAgICAgICAgJ2luY2x1ZGVfanMnPT4gdHJ1
ZSwKICAgICAgICAnd3JhcHRhZycgICA9PiAnJywKICAgICAgICAnY2xhc3MnICAgICA9PiAn
dHdpdHRlci1zaGFyZS1idXR0b24nCiAgICApLCRhdHRzKSk7CgogICAgJHEgPSAnJzsgLy8g
cXVlcnkgc3RyaW5nCgogICAgaWYgKCRpZD0kdGhpc2FydGljbGVbJ3RoaXNpZCddKSB7CiAg
ICAgIC8vIEZldGNoIGFyY190d2l0dGVyIHN0dWZmIHRvIGJ1aWxkIHR3ZWV0IGZyb20KICAg
ICAgJHJvdyA9IHNhZmVfcm93KCJSRVBMQUNFKHR3ZWV0LENPTkNBVCgnICcsdGlueXVybCks
JycpIEFTIHR3ZWV0LHRpbnl1cmwiCiAgICAgICAgLCAnYXJjX3R3aXR0ZXInLCAiYXJ0aWNs
ZV9pZD17JGlkfSIpOwoKICAgICAgaWYgKCR1cmw9PScnKSB7CiAgICAgICAgJHVybCA9ICgk
dXJsKSA/ICR1cmwgOiBwZXJtbGlua3VybCgkdGhpc2FydGljbGUpOwogICAgICAgICRxID0g
J3VybD0nLnVybGVuY29kZSgkdXJsKTsKICAgICAgfQogICAgICBpZiAoJHRleHQ9PScnKSB7
CiAgICAgICAgJHRleHQgPSAoJHJvd1sndHdlZXQnXSkgPyAkcm93Wyd0d2VldCddIDogJHRo
aXNhcnRpY2xlWyd0aXRsZSddOwogICAgICB9CiAgICAgICRxIC49ICgkcSA/ICcmYW1wOycg
OiAnJykuJ3RleHQ9Jy51cmxlbmNvZGUoJHRleHQpOwogICAgfQogICAgaWYgKCR1c2VyKSB7
CiAgICAgICRxIC49ICgkcSA/ICcmYW1wOycgOiAnJykuJ3ZpYT0nLnVybGVuY29kZSgkdXNl
cik7CiAgICB9CiAgICBpZiAoJGZvbGxvdzEmJiRmb2xsb3cyKSB7CiAgICAgICRxIC49ICgk
cSA/ICcmYW1wOycgOiAnJykuJ3JlbGF0ZWQ9Jy51cmxlbmNvZGUoJGZvbGxvdzEuJzonLiRm
b2xsb3cyKTsKICAgIH0gZWxzZWlmICgkZm9sbG93MXx8JGZvbGxvdzIpIHsKICAgICAgJHEg
Lj0gKCRxID8gJyZhbXA7JyA6ICcnKS4ncmVsYXRlZD0nLnVybGVuY29kZSgkZm9sbG93MS4k
Zm9sbG93Mik7CiAgICB9CgogICAgc3dpdGNoICgkbGFuZykgewogICAgICBjYXNlICdmcic6
IGJyZWFrOyBjYXNlICdkZSc6IGJyZWFrOyBjYXNlICdlcyc6IGJyZWFrOyBjYXNlICdqcCc6
IGJyZWFrOwogICAgICBkZWZhdWx0OgogICAgICAgICRsYW5nID0gJ2VuJzsKICAgIH0KICAg
ICRxIC49ICgkcSA/ICcmYW1wOycgOiAnJykuJ2xhbmc9Jy51cmxlbmNvZGUoJGxhbmcpOwoK
ICAgIHN3aXRjaCAoJGNvdW50KSB7CiAgICAgIGNhc2UgJ25vbmUnOiBicmVhazsgY2FzZSAn
dmVydGljYWwnOiBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICAkY291bnQgPSAnaG9y
aXpvbnRhbCc7CiAgICB9CiAgICAkcSAuPSAoJHEgPyAnJmFtcDsnIDogJycpLidjb3VudD0n
LnVybGVuY29kZSgkY291bnQpOwoKICAgICR0aGluZyA9ICgkdGhpbmc9PT1udWxsKSA/ICdU
d2VldCcgOiBwYXJzZSgkdGhpbmcpOwoKICAgICRodG1sID0gaHJlZigkdGhpbmcsJ2h0dHA6
Ly90d2l0dGVyLmNvbS9zaGFyZT8nLiRxCiAgICAgICwgJyBjbGFzcz0iJy4kY2xhc3MuJyIn
KTsKCiAgICAkanMgPSAoJGluY2x1ZGVfanMpID8KICAgICAgJzxzY3JpcHQgc3JjPSJodHRw
Oi8vcGxhdGZvcm0udHdpdHRlci5jb20vd2lkZ2V0cy5qcyIgdHlwZT0idGV4dC9qYXZhc2Ny
aXB0Ij48L3NjcmlwdD4nCiAgICAgIDogJyc7CgogICAgcmV0dXJuICRqcy4kaHRtbDsKfQoK
LyoKICAgIEFkbWluLXNpZGUgZnVuY3Rpb25zCiAgICA9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiovCgovLyBJbnN0
YWxsYXRpb24gZnVuY3Rpb24gLSBidWlsZHMgTXlTUUwgdGFibGUKZnVuY3Rpb24gYXJjX3R3
aXR0ZXJfaW5zdGFsbCgpCnsKCiAgICAvLyBGb3IgZmlyc3QgaW5zdGFsbCwgY3JlYXRlIHRh
YmxlIGZvciB0d2VldHMKICAgICRzcWwgPSAiQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMg
Ii5QRlguImFyY190d2l0dGVyICI7CiAgICAkc3FsLj0gIihhcmNfdHdpdHRlcmlkIElOVEVH
RVIgQVVUT19JTkNSRU1FTlQgUFJJTUFSWSBLRVksCiAgICAgICAgYXJ0aWNsZV9pZCBJTlRF
R0VSKDExKSwKICAgICAgICB0d2VldF9pZCBCSUdJTlQoMjApLAogICAgICAgIHR3ZWV0IFZB
UkNIQVIoMTQwKSwKICAgICAgICB0aW55dXJsIFZBUkNIQVIoMzApKTsiOwoKICAgIGlmICgh
c2FmZV9xdWVyeSgkc3FsKSkgewogICAgICAgIHJldHVybiAnRXJyb3IgLSB1bmFibGUgdG8g
Y3JlYXRlIGFyY190d2l0dGVyIHRhYmxlJzsKICAgIH0KCn0KCi8vIFVuaW5zdGFsbCBmdW5j
dGlvbiAtIGRlbGV0ZXMgTXlTUUwgdGFibGUgYW5kIHJlbGF0ZWQgcHJlZmVyZW5jZXMKZnVu
Y3Rpb24gYXJjX3R3aXR0ZXJfdW5pbnN0YWxsKCkKewoKICAgICRzcWwgPSAiRFJPUCBUQUJM
RSBJRiBFWElTVFMgIi5QRlguImFyY190d2l0dGVyOyI7CiAgICBpZiAoIXNhZmVfcXVlcnko
JHNxbCkpIHsKICAgICAgICByZXR1cm4gJ0Vycm9yIC0gdW5hYmxlIHRvIGRlbGV0ZSBhcmNf
dHdpdHRlciB0YWJsZSc7CiAgICB9CgogICAgJHNxbCA9ICJERUxFVEUgRlJPTSAgIi5QRlgu
InR4cF9wcmVmcyBXSEVSRSBldmVudD0nYXJjX3R3aXR0ZXInOyI7CiAgICBpZiAoIXNhZmVf
cXVlcnkoJHNxbCkpIHsKICAgICAgICByZXR1cm4gJ0Vycm9yIC0gdW5hYmxlIHRvIGRlbGV0
ZSBhcmNfdHdpdHRlciBwcmVmZXJlbmNlcyc7CiAgICB9Cgp9CmZ1bmN0aW9uIGFyY190d2l0
dGVyX3VybF9tZXRob2Rfc2VsZWN0KCRuYW1lLCAkdmFsKQp7CiAgICAkbWV0aG9kcyA9IGFy
cmF5KCd0aW55dXJsJyA9PiAnVGlueXVybCcsICdpc2dkJyA9PiAnSXMuZ2QnLCAnc21kJyA9
PiAnc21kX3Nob3J0X3VybCcpOwogICAgcmV0dXJuIHNlbGVjdElucHV0KCRuYW1lLCAkbWV0
aG9kcywgJHZhbCk7Cn0KZnVuY3Rpb24gYXJjX3R3aXR0ZXJfdGFiX3NlbGVjdCgkbmFtZSwg
JHZhbCkKewogICAgJHRhYnMgPSBhcnJheSgnY29udGVudCcgPT4gJ0NvbnRlbnQnLAogICAg
ICAgICdleHRlbnNpb25zJyA9PiAnRXh0ZW5zaW9ucycsCiAgICAgICAgJycgPT4gJ0hpZGRl
bicpOwogICAgcmV0dXJuIHNlbGVjdElucHV0KCRuYW1lLCAkdGFicywgJHZhbCk7Cn0KLy8g
UHJvdmlkZSBpbnRlcmZhY2UgZm9yIHNldHRpbmcgcHJlZmVyZW5jZXMKZnVuY3Rpb24gYXJj
X3R3aXR0ZXJfcHJlZnMoJGV2ZW50LCRzdGVwKQp7CgogICAgZ2xvYmFsICRwcmVmcywkYXJj
X3R3aXR0ZXJfY29uc3VtZXJLZXksJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAg
ICR1c2VyICAgICAgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ107CiAgICAkcHJl
Zml4ICAgICAgICA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfcHJlZml4J107CiAgICAkdHdlZXRf
ZGVmYXVsdCA9ICRwcmVmc1snYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCddOwogICAgJHVy
bF9tZXRob2QgICAgPSAkcHJlZnNbJ2FyY190d2l0dGVyX3VybF9tZXRob2QnXTsKICAgICRj
YWNoZV9kaXIgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXTsKICAgICR0
YWIgICAgICAgICAgID0gJHByZWZzWydhcmNfdHdpdHRlcl90YWInXTsKCiAgICBzd2l0Y2gg
KCRzdGVwKSB7CiAgICAgICAgY2FzZSAncHJlZnNfc2F2ZSc6IHBhZ2V0b3AoJ1RYUCBUd2Vl
dCcsICdQcmVmZXJlbmNlcyBzYXZlZCcpOyBicmVhazsKICAgICAgICBjYXNlICdyZWdpc3Rl
cic6IHBhZ2V0b3AoJ1RYUCBUd2VldCcsJ0Nvbm5lY3QgdG8gVHdpdHRlcicpOyBicmVhazsK
ICAgICAgICBjYXNlICd2YWxpZGF0ZSc6CiAgICAgICAgZGVmYXVsdDogcGFnZXRvcCgnVFhQ
IFR3ZWV0Jyk7CiAgICB9CgogICAgJGh0bWwgPSAnJzsKCiAgICBpZiAoJHN0ZXA9PSdyZWdp
c3RlcicpIHsgLy8gT0F1dGggcmVnaXN0cmF0aW9uIHByb2Nlc3MKICAgICAgICAkdHdpdCA9
IG5ldyBhcmNfdHdpdHRlcigkYXJjX3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAg
LCAkYXJjX3R3aXR0ZXJfY29uc3VtZXJTZWNyZXQpOwoKICAgICAgICAvLyBCdWlsZCBhIGNh
bGxiYWNrIFVSTCBmb3IgVHdpdHRlciB0byByZXR1cm4gdG8gdGhlIG5leHQgc3RhZ2UKICAg
ICAgICAkY2FsbGJhY2tVUkwgPSAkdHdpdC0+Y2FsbGJhY2tVUkwoJGV2ZW50LCd2YWxpZGF0
ZScpOwoKICAgICAgICAkcmVxdWVzdCA9ICR0d2l0LT5nZXRSZXF1ZXN0VG9rZW4oJGNhbGxi
YWNrVVJMKTsKICAgICAgICAkcmVxdWVzdF90b2tlbiA9ICRyZXF1ZXN0WyJvYXV0aF90b2tl
biJdOwogICAgICAgICRyZXF1ZXN0X3Rva2VuX3NlY3JldCA9ICRyZXF1ZXN0WyJvYXV0aF90
b2tlbl9zZWNyZXQiXTsKCiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3JlcXVlc3RU
b2tlbicsJHJlcXVlc3RfdG9rZW4KICAgICAgICAgICAgLCAnYXJjX3R3aXR0ZXInLDIpOwog
ICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl9yZXF1ZXN0VG9rZW5TZWNyZXQnLCRyZXF1
ZXN0X3Rva2VuX3NlY3JldAogICAgICAgICAgICAsICdhcmNfdHdpdHRlcicsMik7CgogICAg
ICAgICRodG1sLj0gc3RhcnRUYWJsZSgnZWRpdCcpLgogICAgICAgICAgICAgICAgdHIodGQo
CiAgICAgICAgICAgICAgICAgICAgKCc8cD4nLmhyZWYoJ1NpZ24taW4gdG8gVHdpdHRlcicK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICwkdHdpdC0+Z2V0QXV0aG9yaXplVVJMKCRy
ZXF1ZXN0KSkKICAgICAgICAgICAgICAgICAgICAgICAgLicgYW5kIGZvbGxvdyB0aGUgaW5z
dHJ1Y3Rpb25zIHRvIGFsbG93IFRYUCBUd2VldCB0byB1c2UgeW91ciBhY2NvdW50LiBJZiB5
b3UgYXJlIGFscmVhZHkgc2lnbmVkIGluIHRvIFR3aXR0ZXIgdGhlbiB0aGF0IGFjY291bnQg
d2lsbCBiZSBhc3NvY2lhdGVkIHdpdGggVFhQIFR3ZWV0IHNvIHlvdSBtYXkgbmVlZCB0byBz
aWduIG91dCBmaXJzdCBpZiB5b3Ugd2FudCB0byB1c2UgYSBkaWZmZXJlbnQgYWNjb3VudC48
L3A+JykKICAgICAgICAgICAgICAgICkpLmVuZFRhYmxlKCk7CiAgICB9IGVsc2VpZiAoJHN0
ZXA9PSd2YWxpZGF0ZScpIHsKICAgICAgICAkdHdpdCA9IG5ldyBhcmNfdHdpdHRlcigkYXJj
X3R3aXR0ZXJfY29uc3VtZXJLZXkKICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJfY29uc3Vt
ZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfcmVxdWVzdFRva2VuJ10KICAgICAgICAg
ICAgLCAkcHJlZnNbJ2FyY190d2l0dGVyX3JlcXVlc3RUb2tlblNlY3JldCddKTsKICAgICAg
ICAvLyBBc2sgVHdpdHRlciBmb3IgYW4gYWNjZXNzIHRva2VuIChhbmQgYW4gYWNjZXNzIHRv
a2VuIHNlY3JldCkKICAgICAgICAkcmVxdWVzdCA9ICR0d2l0LT5nZXRBY2Nlc3NUb2tlbigg
Z3BzKCdvYXV0aF92ZXJpZmllcicpICk7CiAgICAgICAgJGFjY2Vzc190b2tlbiA9ICRyZXF1
ZXN0WydvYXV0aF90b2tlbiddOwogICAgICAgICRhY2Nlc3NfdG9rZW5fc2VjcmV0ID0gJHJl
cXVlc3RbJ29hdXRoX3Rva2VuX3NlY3JldCddOwogICAgICAgICR1c2VyID0gJHJlcXVlc3Rb
J3NjcmVlbl9uYW1lJ107CiAgICAgICAgLy8gU3RvcmUgdGhlIGFjY2VzcyB0b2tlbiBhbmQg
c2VjcmV0CiAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuJywkYWNj
ZXNzX3Rva2VuLCAnYXJjX3R3aXR0ZXInLDIpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdp
dHRlcl9hY2Nlc3NUb2tlblNlY3JldCcsJGFjY2Vzc190b2tlbl9zZWNyZXQKICAgICAgICAg
ICAgLCAnYXJjX3R3aXR0ZXInLDIpOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRlcl91
c2VyJywkdXNlcik7CiAgICAgICAgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbidd
ID0gJGFjY2Vzc190b2tlbjsKICAgICAgICAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rv
a2VuU2VjcmV0J10gPSAkYWNjZXNzX3Rva2VuX3NlY3JldDsKICAgICAgICB1bnNldCgkdHdp
dCk7CiAgICB9CgogICAgaWYgKCRzdGVwPT0icHJlZnNfc2F2ZSIpIHsKICAgICAgICAkcHJl
Zml4ID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3ByZWZpeCcpKTsKICAgICAgICAkdHdlZXRf
ZGVmYXVsdCA9IGdwcygnYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcpOwogICAgICAgICR1
cmxfbWV0aG9kID0gZ3BzKCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJyk7CiAgICAgICAgJGNh
Y2hlX2RpciA9IGdwcygnYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJyk7CiAgICAgICAgJHRhYiA9
IGdwcygnYXJjX3R3aXR0ZXJfdGFiJyk7CiAgICAgICAgaWYgKHN0cmxlbigkcHJlZml4KTw9
MjApIHsKICAgICAgICAgICAgc2V0X3ByZWYoJ2FyY190d2l0dGVyX3ByZWZpeCcsJHByZWZp
eCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJHByZWZpeCA9ICRwcmVmc1snYXJj
X3R3aXR0ZXJfcHJlZml4J107CiAgICAgICAgfQogICAgICAgICR0d2VldF9kZWZhdWx0ID0g
KCR0d2VldF9kZWZhdWx0KSA/IDEgOiAwOwogICAgICAgIHNldF9wcmVmKCdhcmNfdHdpdHRl
cl90d2VldF9kZWZhdWx0JywkdHdlZXRfZGVmYXVsdCk7CiAgICAgICAgc2V0X3ByZWYoJ2Fy
Y190d2l0dGVyX3VybF9tZXRob2QnLCR1cmxfbWV0aG9kKTsKICAgICAgICBzZXRfcHJlZign
YXJjX3R3aXR0ZXJfY2FjaGVfZGlyJywkY2FjaGVfZGlyKTsKICAgICAgICBzZXRfcHJlZign
YXJjX3R3aXR0ZXJfdGFiJywkdGFiKTsKICAgIH0KCiAgICBpZiAoICRzdGVwIT0ncmVnaXN0
ZXInICkgewogICAgICAgIGlmICggaXNzZXQoJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NU
b2tlbiddKQogICAgICAgICYmIGlzc2V0KCRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9r
ZW5TZWNyZXQnXSkgKSB7CiAgICAgICAgICAgICR0d2l0ID0gbmV3IGFyY190d2l0dGVyKCRh
cmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAgICAgLCAkYXJjX3R3aXR0ZXJf
Y29uc3VtZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4nXQogICAg
ICAgICAgICAgICAgLCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2VjcmV0J10p
OwogICAgICAgICAgICAkcmVnaXN0ZXJVUkwgPSAkdHdpdC0+Y2FsbGJhY2tVUkwoJGV2ZW50
LCdyZWdpc3RlcicpOwogICAgICAgICAgICAkaHRtbC49IHN0YXJ0VGFibGUoJ2xpc3QnKS5m
b3JtKAogICAgICAgICAgICAgICAgdHIoCiAgICAgICAgICAgICAgICAgICAgdGRjcyhoZWQo
J1R3aXR0ZXIgYWNjb3VudCBkZXRhaWxzJywgMiksMikKICAgICAgICAgICAgICAgICkKICAg
ICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9
ImFyY190d2l0dGVyX3VzZXIiPlR3aXR0ZXIgdXNlcm5hbWU8L2xhYmVsPicsCiAgICAgICAg
ICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1h
bGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50ZCgKICAgICAgICAgICAg
ICAgICAgICAgICAgKCRwcmVmc1snYXJjX3R3aXR0ZXJfdXNlciddKSA/CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAkdXNlci4nICgnLmhyZWYoJ1JlLWNvbm5lY3QnLCRyZWdpc3Rl
clVSTCkuJyknCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICc8ZW0+dW5rbm93bjwv
ZW0+JwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmhyZWYoJ0Nvbm5lY3QgdG8gVHdp
dHRlcicsJHJlZ2lzdGVyVVJMKSkKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAg
IC50cigKICAgICAgICAgICAgICAgICAgICB0ZGNzKGhlZCgnVHdlZXQgc2V0dGluZ3MnLCAy
KSwyKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLnRyKAogICAgICAgICAg
ICAgICAgICAgIHRkYSgnPGxhYmVsIGZvcj0iYXJjX3R3aXR0ZXJfY2FjaGVfZGlyIj5Ud2Vl
dCBwcmVmaXg8L2xhYmVsPicsCiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRl
eHQtYWxpZ246IHJpZ2h0OyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAg
ICAgICAgICAgIC50ZChmSW5wdXQoJ3RleHQnLCdhcmNfdHdpdHRlcl9wcmVmaXgnLCRwcmVm
aXgsJycsJycsJycsJycsJycsJ2FyY190d2l0dGVyX3ByZWZpeCcpKQogICAgICAgICAgICAg
ICAgKS50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0
dGVyX3R3ZWV0X2RlZmF1bHQiPlR3ZWV0IGFydGljbGVzIGJ5IGRlZmF1bHQ8L2xhYmVsPics
CiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2
ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50ZCh5ZXNu
b1JhZGlvKCdhcmNfdHdpdHRlcl90d2VldF9kZWZhdWx0JywgJHR3ZWV0X2RlZmF1bHQsICcn
LCAnYXJjX3R3aXR0ZXJfdHdlZXRfZGVmYXVsdCcpKQogICAgICAgICAgICAgICAgKS50cigK
ICAgICAgICAgICAgICAgICAgICB0ZGEoJzxsYWJlbCBmb3I9ImFyY190d2l0dGVyX3VybF9t
ZXRob2QiPlVSTCBzaG9ydG5lcjwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAg
JyBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7Iicp
CiAgICAgICAgICAgICAgICAgICAgLnRkKGFyY190d2l0dGVyX3VybF9tZXRob2Rfc2VsZWN0
KCdhcmNfdHdpdHRlcl91cmxfbWV0aG9kJywkdXJsX21ldGhvZCkpCiAgICAgICAgICAgICAg
ICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdUd2l0dGVyIHRhYicsIDIp
LDIpCiAgICAgICAgICAgICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkYSgnPGxh
YmVsIGZvcj0iYXJjX3R3aXR0ZXJfdGFiIj5Mb2NhdGlvbiBvZiBUd2l0dGVyIHRhYjwvbGFi
ZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHlsZT0idGV4dC1hbGlnbjogcmln
aHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAgICAgICAgICAgICAgICAgLnRk
KGFyY190d2l0dGVyX3RhYl9zZWxlY3QoJ2FyY190d2l0dGVyX3RhYicsJHRhYikpCiAgICAg
ICAgICAgICAgICApLnRyKAogICAgICAgICAgICAgICAgICAgIHRkY3MoaGVkKCdDYWNoZScs
IDIpLDIpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAg
ICAgICAgICAgICAgdGRhKCc8bGFiZWwgZm9yPSJhcmNfdHdpdHRlcl9jYWNoZV9kaXIiPkNh
Y2hlIGRpcmVjdG9yeTwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICAgICAgJyBzdHls
ZT0idGV4dC1hbGlnbjogcmlnaHQ7IHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7IicpCiAgICAg
ICAgICAgICAgICAgICAgLnRkKGZJbnB1dCgndGV4dCcsJ2FyY190d2l0dGVyX2NhY2hlX2Rp
cicsJGNhY2hlX2RpciwnJywnJywnJywnJywnJywnYXJjX3R3aXR0ZXJfY2FjaGVfZGlyJykp
CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAudHIoCiAgICAgICAgICAgICAg
ICAgICAgdGRhKAogICAgICAgICAgICAgICAgICAgICAgICBmSW5wdXQoJ3N1Ym1pdCcsICdT
dWJtaXQnLCBnVHh0KCdzYXZlX2J1dHRvbicpLCAncHVibGlzaCcpCiAgICAgICAgICAgICAg
ICAgICAgICAgIC5uLnNJbnB1dCgncHJlZnNfc2F2ZScpCiAgICAgICAgICAgICAgICAgICAg
ICAgIC5uLmVJbnB1dCgncGx1Z2luX3ByZWZzLmFyY190d2l0dGVyJykKICAgICAgICAgICAg
ICAgICAgICAsICcgY29sc3Bhbj0iMiIgY2xhc3M9Im5vbGluZSInKSkpCiAgICAgICAgICAg
ICAgICAuZW5kVGFibGUoKTsKICAgICAgICB9IGVsc2VpZiAoICRzdGVwIT0ncmVnaXN0ZXIn
ICkgewogICAgICAgICAgICAkcmVnaXN0ZXJVUkwgPSBhcmNfdHdpdHRlcjo6Y2FsbGJhY2tV
UkwoJGV2ZW50LCdyZWdpc3RlcicpOwogICAgICAgICAgICAkaHRtbC49IHN0YXJ0VGFibGUo
J2xpc3QnKS5mb3JtKAogICAgICAgICAgICAgICAgdHIoCiAgICAgICAgICAgICAgICAgICAg
dGRjcyhoZWQoJ1R3aXR0ZXIgYWNjb3VudCBkZXRhaWxzJywgMiksMikKICAgICAgICAgICAg
ICAgICkKICAgICAgICAgICAgICAgIC50cigKICAgICAgICAgICAgICAgICAgICB0ZGEoJzxs
YWJlbCBmb3I9ImFyY190d2l0dGVyX3VzZXIiPlR3aXR0ZXIgdXNlcm5hbWU8L2xhYmVsPics
CiAgICAgICAgICAgICAgICAgICAgICAgICcgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB2
ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyInKQogICAgICAgICAgICAgICAgICAgIC50ZCgKICAg
ICAgICAgICAgICAgICAgICAgICAgKCc8ZW0+dW5rbm93bjwvZW0+ICgnCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAuaHJlZignQ29ubmVjdCB0byBUd2l0dGVyJywkcmVnaXN0ZXJV
UkwpLicpJykKICAgICAgICAgICAgICAgICkpKQogICAgICAgICAgICAgICAgLmVuZFRhYmxl
KCk7CiAgICAgICAgfQogICAgfQoKICAgIGVjaG8gJGh0bWw7Cn0KCi8vIEFkZCBUd2l0dGVy
IHRhYiB0byBUZXh0cGF0dGVybgpmdW5jdGlvbiBhcmNfYWRtaW5fdHdpdHRlcigkZXZlbnQs
JHN0ZXApCnsKICAgIGdsb2JhbCAkcHJlZnMsICRhcmNfdHdpdHRlcl9jb25zdW1lcktleSwg
JGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgICR0d2l0ID0gbmV3IGFyY190d2l0
dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAsICRhcmNfdHdpdHRl
cl9jb25zdW1lclNlY3JldCwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlbiddCiAg
ICAgICAgICAgICwgJHByZWZzWydhcmNfdHdpdHRlcl9hY2Nlc3NUb2tlblNlY3JldCddKTsK
CiAgICAkdHdpdC0+Y2FjaGVEaXIoJHByZWZzWydhcmNfdHdpdHRlcl9jYWNoZV9kaXInXSk7
CgogICAgJHhtbCA9ICR0d2l0LT5nZXQoJ3VzZXJzL3Nob3cnCiAgICAgICAgLCBhcnJheSgn
c2NyZWVuX25hbWUnPT4kcHJlZnNbJ2FyY190d2l0dGVyX3VzZXInXSkpOwogICAgJHR3aXR0
ZXJVc2VyID0gQCR4bWwtPnhwYXRoKCcvdXNlcicpOwogICAgJHR3aXR0ZXJVc2VyID0gJHR3
aXR0ZXJVc2VyWzBdOwogICAgJHR3aXR0ZXJVc2VyVVJMID0gJ2h0dHA6Ly93d3cudHdpdHRl
ci5jb20vJy4kdHdpdHRlclVzZXItPnNjcmVlbl9uYW1lOwoKICAgIGlmICgkc3RlcD09InR3
ZWV0IikgeyAvLyBwb3N0IGFuIHVwZGF0ZSB0byBUd2l0dGVyCgogICAgICAgIC8vIGZldGNo
IGFuZCBjbGVhbiBtZXNzYWdlCiAgICAgICAgJG1lc3NhZ2UgPSBzdHJpcF90YWdzKGdwcygn
bWVzc2FnZScpKTsKICAgICAgICAkY291bnQgPSBzdHJsZW4oJG1lc3NhZ2UpOwoKICAgICAg
ICBpZiAoJGNvdW50PD0xNDAgJiYgJGNvdW50PjApIHsgLy8gcG9zdCB1cGRhdGUKICAgICAg
ICAgICAgJHJlc3VsdCA9ICR0d2l0LT5wb3N0KCdzdGF0dXNlcy91cGRhdGUnLCBhcnJheSgn
c3RhdHVzJyA9PiAkbWVzc2FnZSkpOwogICAgICAgIH0gZWxzZSB7IC8vIG1lc3NhZ2UgdG9v
IGxvbmcsIEphdmFTY3JpcHQgaW50ZXJmYWNlIHNob3VsZCBwcmV2ZW50IHRoaXMKICAgICAg
ICAgICAgJHJlc3VsdCA9IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgcGFnZXRvcCgnVHdp
dHRlcicsCiAgICAgICAgICAgICgoJHJlc3VsdCE9ZmFsc2UpPydUd2l0dGVyIHVwZGF0ZWQn
OidFcnJvciB1cGRhdGluZyBUd2l0dGVyJykpOwoKICAgIH0gZWxzZWlmICgkc3RlcD09ImRl
bGV0ZSIpIHsgLy8gZGVsZXRlIGFuIHVwZGF0ZSBmcm9tIFR3aXR0ZXIKCiAgICAgICAgJGlk
ID0gc3RyaXBfdGFncyhncHMoJ2lkJykpOwogICAgICAgIGlmICgkaWQpIHsKICAgICAgICAg
ICAgJHR3aXQtPmRlbGV0ZSgnc3RhdHVzZXMvZGVzdHJveScuJGlkKTsKICAgICAgICAgICAg
c2FmZV9kZWxldGUoJ2FyY190d2l0dGVyJywidHdlZXRfaWQgPSAkaWQiKTsKICAgICAgICB9
CgogICAgICAgIHBhZ2V0b3AoJ1R3aXR0ZXInLCdUd2l0dGVyIHVwZGF0ZWQnKTsKCiAgICB9
IGVsc2UgewoKICAgICAgICBwYWdldG9wKCdUd2l0dGVyJyk7CgogICAgfQoKICAgIC8vIFBy
ZXBhcmUgSmF2YVNjcmlwdCB0byBjcmVhdGUgVHdpdHRlciB1cGRhdGUgaW50ZXJmYWNlCgog
ICAgJGpzID0gJzxzY3JpcHQgbGFuZ3VhZ2U9ImphdmFzY3JpcHQiIHR5cGU9InRleHQvamF2
YXNjcmlwdCI+JzsKICAgICRqcy49ICIkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpewog
ICAgICAgICAgICB2YXIgY291bnRlclN0eWxlID0gJ2ZvbnQtd2VpZ2h0OmJvbGQ7ZmxvYXQ6
cmlnaHQ7Zm9udC1zaXplOjJlbTtsaW5lLWhlaWdodDoxLjJlbTsnOwogICAgICAgICAgICAk
KCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0eWxlJywgY291bnRlclN0eWxlKydjb2xvcjojY2Nj
OycpOwogICAgICAgICAgICAkKCcjbWVzc2FnZScpLmtleXVwKGZ1bmN0aW9uKCkgewogICAg
ICAgICAgICAgICAgdmFyIGNvdW50ID0gMTQwLSQoJyNtZXNzYWdlJykudmFsKCkubGVuZ3Ro
OwogICAgICAgICAgICAgICAgJCgnI3R3ZWV0Y291bnQnKS5odG1sKGNvdW50KycnKTsgLy8g
aGFjayB0byBmb3JjZSBvdXRwdXQgb2YgMAogICAgICAgICAgICAgICAgaWYgKGNvdW50PDAp
IHsKICAgICAgICAgICAgICAgICAgICAkKCdpbnB1dC5wdWJsaXNoJykuYXR0cignZGlzYWJs
ZWQnLCAnZGlzYWJsZWQnKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg
ICAgICAgICAgJCgnaW5wdXQucHVibGlzaCcpLmF0dHIoJ2Rpc2FibGVkJywgJycpOwogICAg
ICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGNvdW50PDApIHsKICAgICAgICAg
ICAgICAgICAgICAkKCcjdHdlZXRjb3VudCcpLmF0dHIoJ3N0eWxlJywgY291bnRlclN0eWxl
Kydjb2xvcjojZjAwOycpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb3VudDwxMCkg
ewogICAgICAgICAgICAgICAgICAgICQoJyN0d2VldGNvdW50JykuYXR0cignc3R5bGUnLCBj
b3VudGVyU3R5bGUrJ2NvbG9yOiMwMDA7Jyk7CiAgICAgICAgICAgICAgICB9IGVsc2Ugewog
ICAgICAgICAgICAgICAgICAgICQoJyN0d2VldGNvdW50JykuYXR0cignc3R5bGUnLCBjb3Vu
dGVyU3R5bGUrJ2NvbG9yOiNjY2M7Jyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg
IH0pCiAgICAgICAgfSk7IjsKICAgICRqcy49ICI8L3NjcmlwdD4iOwoKICAgICRvdXQgPSAn
JzsKICAgICR4bWwgPSAkdHdpdC0+Z2V0KCdzdGF0dXNlcy91c2VyX3RpbWVsaW5lJwogICAg
ICAgICwgYXJyYXkoJ3NjcmVlbl9uYW1lJz0+JHByZWZzWydhcmNfdHdpdHRlcl91c2VyJ10s
J2NvdW50Jz0+MjUpKTsKICAgICR0d2VldHMgPSBAJHhtbC0+eHBhdGgoJy9zdGF0dXNlcy9z
dGF0dXMnKTsKICAgIGlmICgkdHdlZXRzKSBmb3JlYWNoICgkdHdlZXRzIGFzICR0d2VldCkg
ewogICAgICAgICR0aW1lID0gc3RydG90aW1lKGh0bWxlbnRpdGllcygkdHdlZXQtPmNyZWF0
ZWRfYXQpKTsKICAgICAgICAkZGF0ZSA9IHNhZmVfc3RyZnRpbWUoJHByZWZzWydhcmNoaXZl
X2RhdGVmb3JtYXQnXSwkdGltZSk7CiAgICAgICAgJG91dC49IHRyKHRkKCRkYXRlLCdzcGFu
JykKICAgICAgICAgICAgLnRkKGFyY19Ud2l0dGVyOjptYWtlTGlua3MoaHRtbGVudGl0aWVz
KCR0d2VldC0+dGV4dAogICAgICAgICAgICAgICAgLCBFTlRfUVVPVEVTLCdVVEYtOCcpKSkK
ICAgICAgICAgICAgLnRkKGRMaW5rKCdhcmNfYWRtaW5fdHdpdHRlcicsJ2RlbGV0ZScsJ2lk
JywkdHdlZXQtPmlkLCcnKSkKICAgICAgICAgICAgKTsKICAgIH0KCiAgICAkaHRtbCA9IHN0
YXJ0VGFibGUoJ2VkaXQnKQogICAgICAgICAgICAudHIodGQoCiAgICAgICAgICAgIGdyYWYo
JzxpbWcgc3JjPSInLiR0d2l0dGVyVXNlci0+cHJvZmlsZV9pbWFnZV91cmwuJyIgYWx0PSJU
d2l0dGVyIGF2YXRhciIgLz4nCiAgICAgICAgICAgICwnIHN0eWxlPSJmbG9hdDpsZWZ0O3Bh
ZGRpbmc6MnB4OyInKQogICAgICAgICAgICAuZ3JhZihocmVmKCR0d2l0dGVyVXNlci0+bmFt
ZSwkdHdpdHRlclVzZXJVUkwpLCcgc3R5bGU9ImZvbnQtc2l6ZToxLjJlbTtmb250LXdlaWdo
dDpib2xkOyInKQogICAgICAgICAgICAuZ3JhZihocmVmKCR0d2l0dGVyVXNlci0+ZnJpZW5k
c19jb3VudC4nIGZvbGxvd2luZycsJHR3aXR0ZXJVc2VyVVJMLicvZm9sbG93aW5nJykKICAg
ICAgICAgICAgLicsICcuaHJlZigkdHdpdHRlclVzZXItPmZvbGxvd2Vyc19jb3VudC4nIGZv
bGxvd2VycycsJHR3aXR0ZXJVc2VyVVJMLicvZm9sbG93ZXJzJykKICAgICAgICAgICAgLics
ICcuaHJlZigkdHdpdHRlclVzZXItPnN0YXR1c2VzX2NvdW50LicgdXBkYXRlcycsJHR3aXR0
ZXJVc2VyVVJMKSkpKQogICAgICAgICAgICAudHIodGQoZm9ybSgKICAgICAgICAgICAgZ3Jh
ZigiVXBkYXRlIFR3aXR0ZXIuLi48c3BhbiBpZD0ndHdlZXRjb3VudCcgc3R5bGU9J2ZvbnQt
d2VpZ2h0OmJvbGQ7ZmxvYXQ6cmlnaHQ7Jz4xNDA8L3NwYW4+IikKICAgICAgICAgICAgLnRl
eHRfYXJlYSgnbWVzc2FnZScsJzUwJywnNTUwJywnJywnbWVzc2FnZScpCiAgICAgICAgICAg
IC5lSW5wdXQoJ2FyY19hZG1pbl90d2l0dGVyJykKICAgICAgICAgICAgLnNJbnB1dCgndHdl
ZXQnKS5icgogICAgICAgICAgICAuZklucHV0KCdzdWJtaXQnLCd1cGRhdGUnLGdUeHQoJ1Vw
ZGF0ZScpLCdwdWJsaXNoJykKICAgICAgICApKSkKICAgICAgICAuZW5kVGFibGUoKTsKCiAg
ICAvLyBBdHRhY2ggcmVjZW50IFR3aXR0ZXIgdXBkYXRlcwoKICAgICRodG1sLj0gc3RhcnRU
YWJsZSgnbGlzdCcsJycsJycsJycsJzkwJScpCiAgICAgICAgLiRvdXQKICAgICAgICAuZW5k
VGFibGUoKTsKCiAgICAvLyBPdXRwdXQgSmF2YVNjcmlwdCBhbmQgSFRNTAoKICAgIGVjaG8g
JGpzLiRodG1sOwp9CgovLyBBZGQgVHdpdHRlciBvcHRpb25zIHRvIGFydGljbGUgYXJ0aWNs
ZSBzY3JlZW4KZnVuY3Rpb24gYXJjX2FwcGVuZF90d2l0dGVyKCRldmVudCwgJHN0ZXAsICRk
YXRhLCAkcnMxKQp7CiAgICBnbG9iYWwgJHByZWZzLCAkYXJjX3R3aXR0ZXI7CiAgICAkcHJl
Zml4ID0gdHJpbShncHMoJ2FyY190d2l0dGVyX3ByZWZpeCcpKTsKICAgICRwcmVmaXggPSAo
JHByZWZpeCkgPyAkcHJlZml4IDogJHByZWZzWydhcmNfdHdpdHRlcl9wcmVmaXgnXTsKICAg
ICRzdWZmaXggPSB0cmltKGdwcygnYXJjX3R3aXR0ZXJfc3VmZml4JykpOwoKICAgIGlmICgk
cnMxWydJRCddKSB7CiAgICAgICAgJHNxbCA9ICJTRUxFQ1QgdHdlZXRfaWQsdHdlZXQgRlJP
TSAiLlBGWC4iYXJjX3R3aXR0ZXIgV0hFUkUgYXJ0aWNsZV9pZD0iLiRyczFbJ0lEJ10uIjsi
OwogICAgICAgICRyczIgPSBzYWZlX3F1ZXJ5KCRzcWwpOyAkcnMyID0gbmV4dFJvdygkcnMy
KTsKICAgIH0gZWxzZSB7IC8vIG5ldyBhcnRpY2xlCiAgICAgICAgJHJzMiA9ICcnOwogICAg
fQoKICAgIGlmICgkcnMxWydJRCddICYmICRyczJbJ3R3ZWV0X2lkJ10pIHsKICAgICAgICAk
Y29udGVudCA9IGFyY19Ud2l0dGVyOjptYWtlTGlua3MoJHJzMlsndHdlZXQnXSk7CiAgICAg
ICAgcmV0dXJuICRkYXRhLmZpZWxkc2V0KCRjb250ZW50LCAnVHdpdHRlciB1cGRhdGUnLCAn
YXJjX3R3aXR0ZXInKTsKICAgIH0gZWxzZSB7CiAgICAgICAgJHZhciA9ICgkcnMxWydJRCdd
KSA/IDAgOiAkcHJlZnNbJ2FyY190d2l0dGVyX3R3ZWV0X2RlZmF1bHQnXTsKICAgICAgICAk
Y29udGVudCAgPSB5ZXNub1JhZGlvKCdhcmNfdHdlZXRfdGhpcycsICR2YXIsICcnLCAnYXJj
X3R3ZWV0X3RoaXMnKTsKICAgICAgICAkY29udGVudCAuPSB0YWcoaHJlZignT3B0aW9ucycs
JyNhcmNfdHdpdHRlcl9vcHRpb25zJyksJ3AnLCcgY2xhc3M9InBsYWluIGxldmVyIiBzdHls
ZT0ibWFyZ2luLXRvcDo1cHg7IicpOwogICAgICAgICRjb250ZW50IC49IHRhZyh0YWcoJ1R3
ZWV0IHByZWZpeCcsJ2xhYmVsJywgJyBmb3I9ImFyY190d2l0dGVyX3ByZWZpeCInKQogICAg
ICAgICAgICAuZklucHV0KCd0ZXh0JywnYXJjX3R3aXR0ZXJfcHJlZml4JywkcHJlZml4LCdl
ZGl0JywnJywnJywnMjInLCcnLCdhcmNfdHdpdHRlcl9wcmVmaXgnKQogICAgICAgICAgICAu
dGFnKCdUd2VldCBzdWZmaXggKGVnICNoYXNodGFncyknLCdsYWJlbCcsICcgZm9yPSJhcmNf
dHdpdHRlcl9zdWZmaXgiJykKICAgICAgICAgICAgLmZJbnB1dCgndGV4dCcsJ2FyY190d2l0
dGVyX3N1ZmZpeCcsJHN1ZmZpeCwnZWRpdCcsJycsJycsJzIyJywnJywnYXJjX3R3aXR0ZXJf
c3VmZml4JykKICAgICAgICAgICAgLCdkaXYnLCcgaWQ9ImFyY190d2l0dGVyX29wdGlvbnMi
IGNsYXNzPSJ0b2dnbGUiIHN0eWxlPSJkaXNwbGF5Om5vbmUiJyk7CiAgICAgICAgaWYgKGlz
c2V0KCRhcmNfdHdpdHRlclsnZXJyb3InXSkpIHsKICAgICAgICAgICAgJGNvbnRlbnQgLj0g
JzxwPicuJGFyY190d2l0dGVyWydlcnJvciddLic8L3A+JzsKICAgICAgICB9CiAgICAgICAg
cmV0dXJuICRkYXRhLmZpZWxkc2V0KCRjb250ZW50LCAnVXBkYXRlIFR3aXR0ZXInLCAnYXJj
X3R3aXR0ZXInKTsKICAgIH0KCn0KCi8vIFVwZGF0ZSBUd2l0dGVyIHdpdGggcG9zdGVkIGFy
dGljbGUKZnVuY3Rpb24gYXJjX2FydGljbGVfdHdlZXQoJGV2ZW50LCRzdGVwKQp7CiAgICBn
bG9iYWwgJHByZWZzLCAkYXJjX3R3aXR0ZXIsICRhcmNfdHdpdHRlcl9jb25zdW1lcktleQog
ICAgICAgICwgJGFyY190d2l0dGVyX2NvbnN1bWVyU2VjcmV0OwoKICAgICRhcnRpY2xlX2lk
ID0gZW1wdHkoJEdMT0JBTFNbJ0lEJ10pID8gZ3BzKCdJRCcpIDogJEdMT0JBTFNbJ0lEJ107
CiAgICBpZiAoIWVtcHR5KCRhcnRpY2xlX2lkKSkgewoKICAgICAgICBpbmNsdWRlX29uY2Ug
dHhwYXRoLicvcHVibGlzaC90YWdoYW5kbGVycy5waHAnOwoKICAgICAgICAkYXJ0aWNsZSA9
IHNhZmVfcm93KCJJRCwgVGl0bGUsIFNlY3Rpb24sIFBvc3RlZCIsICd0ZXh0cGF0dGVybics
CiAgICAgICAgICAgICJJRD17JGFydGljbGVfaWR9IEFORCBTdGF0dXM9NCBBTkQgbm93KCk+
PVBvc3RlZCIpOwoKICAgICAgICBpZiAoJGFydGljbGUgJiYgZ3BzKCdhcmNfdHdlZXRfdGhp
cycpKSB7IC8vIHR3ZWV0IGFydGljbGUKCiAgICAgICAgICAgIC8vIE5lZWQgdG8gbWFudWFs
bHkgdXBkYXRlIHRoZSAnVVJMIG9ubHkgdGl0bGUnIGJlZm9yZSBidWlsZGluZyB0aGUKICAg
ICAgICAgICAgLy8gVVJMCiAgICAgICAgICAgICRhcnRpY2xlWyd1cmxfdGl0bGUnXSA9IGdw
cygndXJsX3RpdGxlJyk7CiAgICAgICAgICAgIC8vIE1ha2Ugc2hvcnQgVVJMCiAgICAgICAg
ICAgICR1cmwgPSBwZXJtbGlua3VybCgkYXJ0aWNsZSk7CiAgICAgICAgICAgICRzaG9ydF91
cmwgPSBhcmNfc2hvcnRlbl91cmwoJHVybCwkcHJlZnNbJ2FyY190d2l0dGVyX3VybF9tZXRo
b2QnXSwKICAgICAgICAgICAgICAgIGFycmF5KCdpZCc9PiRhcnRpY2xlX2lkKSk7CgogICAg
ICAgICAgICBpZiAoISRzaG9ydF91cmwpIHsgLy8gRmFpbGVkIHRvIG9idGFpbiBhIHNob3J0
ZW5lZCBVUkwsIGRvIG5vdCB0d2VldCEKICAgICAgICAgICAgICAgICRhcmNfdHdpdHRlclsn
ZXJyb3InXSA9ICdVbmFibGUgdG8gb2J0YWluIGEgc2hvcnQgVVJMIGZvciB0aGlzIGFydGlj
bGUuJzsKCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KCiAg
ICAgICAgICAgIC8vIENvbnN0cnVjdCBUd2l0dGVyIHVwZGF0ZQogICAgICAgICAgICAkcHJl
Zml4ICA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9wcmVmaXgnKSk7CiAgICAgICAgICAgICRw
cmVfbGVuID0gc3RybGVuKCRwcmVmaXgpOwogICAgICAgICAgICAkcHJlZml4ICA9ICgkcHJl
Zml4ICYmICRwcmVfbGVuPD0yMCkgPyAkcHJlZml4LicgJyA6ICcnOwogICAgICAgICAgICAk
c3VmZml4ICA9IHRyaW0oZ3BzKCdhcmNfdHdpdHRlcl9zdWZmaXgnKSk7CiAgICAgICAgICAg
ICRzdWZfbGVuID0gc3RybGVuKCRzdWZmaXgpOwogICAgICAgICAgICAkc3VmZml4ICA9ICgk
c3VmZml4ICYmICRzdWZfbGVuPD00MCkgPyAnICcuJHN1ZmZpeCA6ICcnOwogICAgICAgICAg
ICAkdXJsX2xlbiA9IHN0cmxlbigkc2hvcnRfdXJsKSsxOyAvLyBjb3VudCBVUkwgbGVuZ3Ro
ICsgMSBmb3IgcHJlZml4ZWQgc3BhY2UKICAgICAgICAgICAgaWYgKCRwcmVmaXgpICRwcmVf
bGVuICs9IDE7CiAgICAgICAgICAgIGlmICgkc3VmZml4KSAkc3VmX2xlbiArPSAxOwogICAg
ICAgICAgICBpZiAoKHN0cmxlbigkYXJ0aWNsZVsnVGl0bGUnXSkrJHVybF9sZW4rJHByZV9s
ZW4rJHN1Zl9sZW4pPjE0MCkgewogICAgICAgICAgICAgICAgJGFydGljbGVbJ1RpdGxlJ10g
PSBzdWJzdHIoJGFydGljbGVbJ1RpdGxlJ10sMCwxMzUtJHVybF9sZW4tJHByZV9sZW4tJHN1
Zl9sZW4pLicuLi4nOwogICAgICAgICAgICB9CiAgICAgICAgICAgICR0d2VldCA9ICRwcmVm
aXguJGFydGljbGVbJ1RpdGxlJ10uIiAiLiRzaG9ydF91cmwuJHN1ZmZpeDsKCiAgICAgICAg
ICAgIC8vIFVwZGF0ZSBUd2l0dGVyCiAgICAgICAgICAgICR0d2l0ID0gbmV3IGFyY190d2l0
dGVyKCRhcmNfdHdpdHRlcl9jb25zdW1lcktleQogICAgICAgICAgICAgICAgLCAkYXJjX3R3
aXR0ZXJfY29uc3VtZXJTZWNyZXQsICRwcmVmc1snYXJjX3R3aXR0ZXJfYWNjZXNzVG9rZW4n
XQogICAgICAgICAgICAgICAgLCAkcHJlZnNbJ2FyY190d2l0dGVyX2FjY2Vzc1Rva2VuU2Vj
cmV0J10pOwogICAgICAgICAgICAkcmVzdWx0ID0gJHR3aXQtPnBvc3QoJ3N0YXR1c2VzL3Vw
ZGF0ZScsIGFycmF5KCdzdGF0dXMnID0+ICR0d2VldCkpOwoKICAgICAgICAgICAgJHR3ZWV0
X2lkID0gKGlzX29iamVjdCgkcmVzdWx0KSkgPyAkcmVzdWx0WzBdLT5pZCA6IDA7CgogICAg
ICAgICAgICBpZiAoJHR3ZWV0X2lkKSB7CgogICAgICAgICAgICAgICAgJHR3ZWV0ID0gYWRk
c2xhc2hlcygkdHdlZXQpOwoKICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBhcmNfdHdpdHRl
ciB0YWJsZSB3aXRoIHR3ZWV0CiAgICAgICAgICAgICAgICAkc3FsID0gIklOU0VSVCBJTlRP
ICIuUEZYLiJhcmNfdHdpdHRlciAoYXJ0aWNsZV9pZCx0d2VldF9pZCx0d2VldCx0aW55dXJs
KSAiOwogICAgICAgICAgICAgICAgJHNxbC49ICJWQUxVRVMoJGFydGljbGVfaWQsJHR3ZWV0
X2lkLFwiJHR3ZWV0XCIsJyRzaG9ydF91cmwnKTsiOwogICAgICAgICAgICAgICAgc2FmZV9x
dWVyeSgkc3FsKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgICAgICAg
IH0gZWxzZSB7CgogICAgICAgICAgICAgICAgJGFyY190d2l0dGVyWydlcnJvciddID0gJ1R3
aXR0ZXIgcmVzcG9uc2U6ICcKICAgICAgICAgICAgICAgICAgICAuJHR3aXQtPmh0dHBfY29k
ZTsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgICAgIH0KCiAgICAg
ICAgfQoKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7Cgp9CgovKgogKiBTaG9ydGVuIFVSTHMg
dXNpbmcgdmFyaW91cyBtZXRob2RzCiAqLwoKZnVuY3Rpb24gYXJjX3Nob3J0ZW5fdXJsKCR1
cmwsICRtZXRob2Q9JycsICRhdHRzPWFycmF5KCkpCnsKICAkY2ggPSBjdXJsX2luaXQoKTsK
ICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfSEVBREVSLCAwKTsKICBjdXJsX3NldG9wdCgk
Y2gsIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIsIHRydWUpOwogIGN1cmxfc2V0b3B0KCRjaCwg
Q1VSTE9QVF9USU1FT1VULCAxMCk7CgogIHN3aXRjaCAoJG1ldGhvZCkgewogICAgY2FzZSAn
c21kJzogLy8gY3JlYXRlIGEgc2hvcnRlbmVkIFVSTCB1c2luZyBTTUQgU2hvcnQgVVJMCiAg
ICAgIHJldHVybiAoJGF0dHNbJ2lkJ10pID8gaHUuJGF0dHNbJ2lkJ10gOiBmYWxzZTsgYnJl
YWs7CiAgICBjYXNlICdpc2dkJzoKCiAgICAgICR1ID0gJ2h0dHA6Ly9pcy5nZC9hcGkucGhw
P2xvbmd1cmw9Jy51cmxlbmNvZGUoJHVybCk7CiAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VS
TE9QVF9VUkwsICR1KTsKCiAgICAgICR0aW55dXJsID0gY3VybF9leGVjKCRjaCk7CiAgICAg
IGlmICgkdGlueXVybCE9J0Vycm9yJyAmJiAkdGlueXVybCE9JycpIHsKICAgICAgICByZXR1
cm4gJHRpbnl1cmw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdHJpZ2dlcl9lcnJvcignYXJj
X3R3aXR0ZXIgZmFpbGVkIHRvIGdldCBhIGlzLmdkIFVSTCBmb3IgJwogICAgICAgICAgICAu
JHVybCxFX1VTRVJfV0FSTklORyk7CiAgICAgIH0KICAgICAgYnJlYWs7CgogICAgY2FzZSAn
dGlueXVybCc6IGRlZmF1bHQ6IC8vIGNyZWF0ZSBhIHNob3J0ZW5lZCBVUkwgdXNpbmcgVGlu
eVVSTAoKICAgICAgJHUgPSAnaHR0cDovL3Rpbnl1cmwuY29tL2FwaS1jcmVhdGUucGhwP3Vy
bD0nLnVybGVuY29kZSgkdXJsKTsKICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VS
TCwgJHUpOwogICAgICAkdGlueXVybCA9IGN1cmxfZXhlYygkY2gpOwogICAgICBpZiAoJHRp
bnl1cmwhPSdFcnJvcicgJiYgJHRpbnl1cmwhPScnKSB7CiAgICAgICAgcmV0dXJuICR0aW55
dXJsOwogICAgICB9IGVsc2UgewogICAgICAgIHRyaWdnZXJfZXJyb3IoJ2FyY190d2l0dGVy
IGZhaWxlZCB0byBnZXQgYSBUaW55VVJMIGZvciAnLiR1cmwsRV9VU0VSX1dBUk5JTkcpOwog
ICAgICB9CgogIH0KCiAgcmV0dXJuIGZhbHNlOyAvLyBmYWlsCgp9CgovKgogKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKgoqLwoKY2xhc3MgYXJjX3R3aXR0ZXIgZXh0ZW5kcyBUd2l0dGVy
T0F1dGggewogICAgLy8gQ2FjaGluZyB2YXJpYWJsZXMKICAgIHByaXZhdGUgJF9jYWNoZSA9
IHRydWU7CiAgICBwcml2YXRlICRfY2FjaGVfZGlyID0gJy4vdG1wJzsKICAgIHByaXZhdGUg
JF9jYWNoZV90aW1lID0gMTgwMDsgLy8gMzAgbWludXRlIGNhY2hlCgogICAgZnVuY3Rpb24g
X19jb25zdHJ1Y3QoJGNvbnN1bWVyX2tleSwgJGNvbnN1bWVyX3NlY3JldCwgJG9hdXRoX3Rv
a2VuID0gTlVMTAogICAgICAgICwgJG9hdXRoX3Rva2VuX3NlY3JldCA9IE5VTEwpCiAgICB7
CiAgICAgICAgcGFyZW50OjpfX2NvbnN0cnVjdCgkY29uc3VtZXJfa2V5LCAkY29uc3VtZXJf
c2VjcmV0LCAkb2F1dGhfdG9rZW4KICAgICAgICAgICAgLCAkb2F1dGhfdG9rZW5fc2VjcmV0
KTsKICAgICAgICAkdGhpcy0+Zm9ybWF0ID0gJ3htbCc7CiAgICAgICAgJHRoaXMtPnRpbWVv
dXQgPSAxNTsKICAgICAgICAkdGhpcy0+Y29ubmVjdHRpbWVvdXQgPSAxNTsKICAgIH0KCiAg
ICBwdWJsaWMgZnVuY3Rpb24gY2FsbGJhY2tVUkwoJGV2ZW50LCRzdGVwKQogICAgewogICAg
ICAgIHJldHVybiBodS4ndGV4dHBhdHRlcm4vaW5kZXgucGhwP2V2ZW50PScuJGV2ZW50Licm
YW1wO3N0ZXA9Jy4kc3RlcDsKICAgIH0KCiAgICAvLyBjcmVhdGUgVHdpdHRlciBhbmQgZXh0
ZXJuYWwgbGlua3MgaW4gdGV4dAogICAgcHVibGljIHN0YXRpYyBmdW5jdGlvbiBtYWtlTGlu
a3MoJHRleHQpCiAgICB7CiAgICAgICAgJHVybCA9ICcvXGIoaHR0cHxodHRwc3xmdHApOlwv
XC8oW0EtWjAtOV1bQS1aMC05Xy1dKig/OlwuW0EtWjAtOV1bQS1aMC05Xy1dKikrKTo/KFxk
Kyk/XC8/KFtcL1x3K1wuXSspXGIvaSc7CiAgICAgICAgJHRleHQgPSBwcmVnX3JlcGxhY2Uo
JHVybCwgIjxhIGhyZWY9JyQwJz4kMDwvYT4iLCAkdGV4dCk7CiAgICAgICAgJHVybCA9ICcv
XGIoXnxccyl3d3cuKFthLXpfQS1aMC05XSspKChcLlthLXpdKykrKVxiL2knOwogICAgICAg
ICR0ZXh0ID0gcHJlZ19yZXBsYWNlKCR1cmwsICI8YSBocmVmPSdodHRwOi8vd3d3LiQyJDMn
Pnd3dy4kMiQzPC9hPiIsICR0ZXh0KTsKICAgICAgICAkdGV4dCA9IHByZWdfcmVwbGFjZSgi
LyhefFxzKUAoW2Etel9BLVowLTldKykvIiwKICAgICAgICAgICAgIiQxQDxhIGhyZWY9J2h0
dHA6Ly90d2l0dGVyLmNvbS8kMic+JDI8L2E+IiwkdGV4dCk7CiAgICAgICAgJHRleHQgPSBw
cmVnX3JlcGxhY2UoIi8oXnxccykoXCMoW2Etel9BLVowLTk6Xy1dKykpLyIsCiAgICAgICAg
ICAgICIkMTxhIGhyZWY9J2h0dHA6Ly90d2l0dGVyLmNvbS9zZWFyY2g/cT0lMjMkMyc+JDI8
L2E+IiwkdGV4dCk7CiAgICAgICAgcmV0dXJuICR0ZXh0OwogIH0KCiAgICBwdWJsaWMgZnVu
Y3Rpb24gZ2V0KCR1cmwsICRwYXJhbXMgPSBhcnJheSgpKQogICAgewogICAgICAgICRhcGlf
dXJsID0gbWQ1KCR1cmwudXJsZW5jb2RlKHNlcmlhbGl6ZSgkcGFyYW1zKSkpOwogICAgICAg
ICRkYXRhID0gJyc7CgogICAgICAgIGlmICgkdGhpcy0+X2NhY2hlKSB7IC8vIGNoZWNrIGZv
ciBjYWNoZWQgeG1sCgogICAgICAgICAgICAkZGF0YSA9ICR0aGlzLT5fcmV0cmlldmVDYWNo
ZSgkYXBpX3VybCk7CgogICAgICAgIH0KICAgICAgICBpZiAoZW1wdHkoJGRhdGEpKSB7CiAg
ICAgICAgICAgICRkYXRhID0gcGFyZW50OjpnZXQoJHVybCwgJHBhcmFtcyk7CiAgICAgICAg
ICAgIGlmICgkdGhpcy0+aHR0cF9jb2RlPT09MjAwICYmICR4bWw9c2ltcGxleG1sX2xvYWRf
c3RyaW5nKCRkYXRhKSkgeyAvLyBzYXZlIGNhY2hlCiAgICAgICAgICAgICAgICAkZmlsZSA9
ICR0aGlzLT5fY2FjaGVfZGlyLicvJy4kYXBpX3VybDsKICAgICAgICAgICAgICAgIGZpbGVf
cHV0X2NvbnRlbnRzKCRmaWxlLCRkYXRhLExPQ0tfRVgpOwogICAgICAgICAgICAgICAgcmV0
dXJuICR4bWw7CiAgICAgICAgICAgIH0gZWxzZSB7IC8vIGZhaWxlZCB0byByZXRyaWV2ZSBk
YXRhIGZyb20gVHdpdHRlcgoKICAgICAgICAgICAgICAgIGlmICgkdGhpcy0+X2NhY2hlKSB7
IC8vIGF0dGVtcHQgdG8gZm9yY2UgY2FjaGVkIHhtbCByZXR1cm4KCiAgICAgICAgICAgICAg
ICAgICAgJGRhdGEgPSAkdGhpcy0+X3JldHJpZXZlQ2FjaGUoJGFwaV91cmwsdHJ1ZSk7CiAg
ICAgICAgICAgICAgICAgICAgaWYgKCRkYXRhKSByZXR1cm4gQHNpbXBsZXhtbF9sb2FkX3N0
cmluZygkZGF0YSk7CgogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVy
biBmYWxzZTsKCiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgeyAvLyByZXR1cm4gY2Fj
aGVkIHhtbAogICAgICAgICAgICByZXR1cm4gQHNpbXBsZXhtbF9sb2FkX3N0cmluZygkZGF0
YSk7CiAgICAgICAgfQogICAgfSAvL2VuZCBnZXQoKQoKICAgIGZ1bmN0aW9uIHBvc3QoJHVy
bCwgJHBhcmFtcyA9IGFycmF5KCkpCiAgICB7CiAgICAgICAgJGRhdGEgPSBwYXJlbnQ6OnBv
c3QoJHVybCwkcGFyYW1zKTsKICAgICAgICByZXR1cm4gc2ltcGxleG1sX2xvYWRfc3RyaW5n
KCRkYXRhKTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZWxldGUoJHVybCwgJHBhcmFtcyA9IGFy
cmF5KCkpCiAgICB7CiAgICAgICAgJGRhdGEgPSBwYXJlbnQ6OmRlbGV0ZSgkdXJsLCRwYXJh
bXMpOwogICAgICAgIHJldHVybiBzaW1wbGV4bWxfbG9hZF9zdHJpbmcoJGRhdGEpOwogICAg
fQoKICAgIC8vIENhY2hlIG1ldGhvZHMKCiAgICBwdWJsaWMgZnVuY3Rpb24gc2V0Q2FjaGlu
ZygkY2FjaGU9dHJ1ZSkKICAgIHsKICAgICAgICAkdGhpcy0+X2NhY2hlID0gKCRjYWNoZSkg
PyB0cnVlIDogZmFsc2U7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHVibGlj
IGZ1bmN0aW9uIGNhY2hlRGlyKCRsb2MpCiAgICB7CiAgICAgICAgJHRoaXMtPl9jYWNoZV9k
aXIgPSAkbG9jOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHB1YmxpYyBmdW5j
dGlvbiBjYWNoZVRpbWUoJG1pbnMpCiAgICB7CiAgICAgICAgJHRoaXMtPl9jYWNoZV90aW1l
ID0gJG1pbnMqNjA7IC8vIGNvbnZlcnQgbWludXRlcyBpbnRvIHNlY29uZHMKICAgICAgICBy
ZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcml2YXRlIGZ1bmN0aW9uIF9yZXRyaWV2ZUNhY2hl
KCR1cmwsJG92ZXJpZGVfdGltZW91dD1mYWxzZSkKICAgIHsKICAgICAgICAkZmlsZSA9ICR0
aGlzLT5fY2FjaGVfZGlyLicvJy4kdXJsOwogICAgICAgIGlmIChmaWxlX2V4aXN0cygkZmls
ZSkpIHsKCiAgICAgICAgICAgICRkaWZmID0gdGltZSgpIC0gZmlsZW10aW1lKCRmaWxlKTsK
ICAgICAgICAgICAgaWYgKCRvdmVyaWRlX3RpbWVvdXQgfHwgJGRpZmYgPCAkdGhpcy0+X2Nh
Y2hlX3RpbWUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmaWxlX2dldF9jb250ZW50cygk
ZmlsZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFs
c2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJu
IGZhbHNlOwogICAgICAgIH0KICAgIH0KfQoKLyoKICogQWJyYWhhbSBXaWxsaWFtcyAoYWJy
YWhhbUBhYnJhaC5hbSkgaHR0cDovL2FicmFoLmFtCiAqCiAqIFRoZSBmaXJzdCBQSFAgTGli
cmFyeSB0byBzdXBwb3J0IE9BdXRoIGZvciBUd2l0dGVyJ3MgUkVTVCBBUEkuCiAqLwoKLyoq
CiAqIFR3aXR0ZXIgT0F1dGggY2xhc3MKICovCmNsYXNzIFR3aXR0ZXJPQXV0aCB7CiAgLyog
Q29udGFpbnMgdGhlIGxhc3QgSFRUUCBzdGF0dXMgY29kZSByZXR1cm5lZC4gKi8KICBwdWJs
aWMgJGh0dHBfY29kZTsKICAvKiBDb250YWlucyB0aGUgbGFzdCBBUEkgY2FsbC4gKi8KICBw
dWJsaWMgJHVybDsKICAvKiBTZXQgdXAgdGhlIEFQSSByb290IFVSTC4gKi8KICBwdWJsaWMg
JGhvc3QgPSAiaHR0cHM6Ly9hcGkudHdpdHRlci5jb20vMS8iOwogIC8qIFNldCB0aW1lb3V0
IGRlZmF1bHQuICovCiAgcHVibGljICR0aW1lb3V0ID0gMzA7CiAgLyogU2V0IGNvbm5lY3Qg
dGltZW91dC4gKi8KICBwdWJsaWMgJGNvbm5lY3R0aW1lb3V0ID0gMzA7CiAgLyogVmVyaWZ5
IFNTTCBDZXJ0LiAqLwogIHB1YmxpYyAkc3NsX3ZlcmlmeXBlZXIgPSBGQUxTRTsKICAvKiBS
ZXNwb25zIGZvcm1hdC4gKi8KICBwdWJsaWMgJGZvcm1hdCA9ICdqc29uJzsKICAvKiBEZWNv
ZGUgcmV0dXJuZWQganNvbiBkYXRhLiAqLwogIHB1YmxpYyAkZGVjb2RlX2pzb24gPSBUUlVF
OwogIC8qIENvbnRhaW5zIHRoZSBsYXN0IEhUVFAgaGVhZGVycyByZXR1cm5lZC4gKi8KICBw
dWJsaWMgJGh0dHBfaW5mbzsKICAvKiBTZXQgdGhlIHVzZXJhZ25ldC4gKi8KICBwdWJsaWMg
JHVzZXJhZ2VudCA9ICdUd2l0dGVyT0F1dGggdjAuMi4wLWJldGEyJzsKICAvKiBJbW1lZGlh
dGVseSByZXRyeSB0aGUgQVBJIGNhbGwgaWYgdGhlIHJlc3BvbnNlIHdhcyBub3Qgc3VjY2Vz
c2Z1bC4gKi8KICAvL3B1YmxpYyAkcmV0cnkgPSBUUlVFOwoKCgoKICAvKioKICAgKiBTZXQg
QVBJIFVSTFMKICAgKi8KICBmdW5jdGlvbiBhY2Nlc3NUb2tlblVSTCgpICB7IHJldHVybiAn
aHR0cHM6Ly9hcGkudHdpdHRlci5jb20vb2F1dGgvYWNjZXNzX3Rva2VuJzsgfQogIGZ1bmN0
aW9uIGF1dGhlbnRpY2F0ZVVSTCgpIHsgcmV0dXJuICdodHRwczovL3R3aXR0ZXIuY29tL29h
dXRoL2F1dGhlbnRpY2F0ZSc7IH0KICBmdW5jdGlvbiBhdXRob3JpemVVUkwoKSAgICB7IHJl
dHVybiAnaHR0cHM6Ly90d2l0dGVyLmNvbS9vYXV0aC9hdXRob3JpemUnOyB9CiAgZnVuY3Rp
b24gcmVxdWVzdFRva2VuVVJMKCkgeyByZXR1cm4gJ2h0dHBzOi8vYXBpLnR3aXR0ZXIuY29t
L29hdXRoL3JlcXVlc3RfdG9rZW4nOyB9CgogIC8qKgogICAqIERlYnVnIGhlbHBlcnMKICAg
Ki8KICBmdW5jdGlvbiBsYXN0U3RhdHVzQ29kZSgpIHsgcmV0dXJuICR0aGlzLT5odHRwX3N0
YXR1czsgfQogIGZ1bmN0aW9uIGxhc3RBUElDYWxsKCkgeyByZXR1cm4gJHRoaXMtPmxhc3Rf
YXBpX2NhbGw7IH0KCiAgLyoqCiAgICogY29uc3RydWN0IFR3aXR0ZXJPQXV0aCBvYmplY3QK
ICAgKi8KICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkY29uc3VtZXJfa2V5LCAkY29uc3VtZXJf
c2VjcmV0LCAkb2F1dGhfdG9rZW4gPSBOVUxMLCAkb2F1dGhfdG9rZW5fc2VjcmV0ID0gTlVM
TCkgewogICAgJHRoaXMtPnNoYTFfbWV0aG9kID0gbmV3IE9BdXRoU2lnbmF0dXJlTWV0aG9k
X0hNQUNfU0hBMSgpOwogICAgJHRoaXMtPmNvbnN1bWVyID0gbmV3IE9BdXRoQ29uc3VtZXIo
JGNvbnN1bWVyX2tleSwgJGNvbnN1bWVyX3NlY3JldCk7CiAgICBpZiAoIWVtcHR5KCRvYXV0
aF90b2tlbikgJiYgIWVtcHR5KCRvYXV0aF90b2tlbl9zZWNyZXQpKSB7CiAgICAgICR0aGlz
LT50b2tlbiA9IG5ldyBPQXV0aENvbnN1bWVyKCRvYXV0aF90b2tlbiwgJG9hdXRoX3Rva2Vu
X3NlY3JldCk7CiAgICB9IGVsc2UgewogICAgICAkdGhpcy0+dG9rZW4gPSBOVUxMOwogICAg
fQogIH0KCgogIC8qKgogICAqIEdldCBhIHJlcXVlc3RfdG9rZW4gZnJvbSBUd2l0dGVyCiAg
ICoKICAgKiBAcmV0dXJucyBhIGtleS92YWx1ZSBhcnJheSBjb250YWluaW5nIG9hdXRoX3Rv
a2VuIGFuZCBvYXV0aF90b2tlbl9zZWNyZXQKICAgKi8KICBmdW5jdGlvbiBnZXRSZXF1ZXN0
VG9rZW4oJG9hdXRoX2NhbGxiYWNrID0gTlVMTCkgewogICAgJHBhcmFtZXRlcnMgPSBhcnJh
eSgpOwogICAgaWYgKCFlbXB0eSgkb2F1dGhfY2FsbGJhY2spKSB7CiAgICAgICRwYXJhbWV0
ZXJzWydvYXV0aF9jYWxsYmFjayddID0gJG9hdXRoX2NhbGxiYWNrOwogICAgfQogICAgJHJl
cXVlc3QgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR0aGlzLT5yZXF1ZXN0VG9rZW5VUkwoKSwg
J0dFVCcsICRwYXJhbWV0ZXJzKTsKICAgICR0b2tlbiA9IE9BdXRoVXRpbDo6cGFyc2VfcGFy
YW1ldGVycygkcmVxdWVzdCk7CiAgICAkdGhpcy0+dG9rZW4gPSBuZXcgT0F1dGhDb25zdW1l
cigkdG9rZW5bJ29hdXRoX3Rva2VuJ10sICR0b2tlblsnb2F1dGhfdG9rZW5fc2VjcmV0J10p
OwogICAgcmV0dXJuICR0b2tlbjsKICB9CgogIC8qKgogICAqIEdldCB0aGUgYXV0aG9yaXpl
IFVSTAogICAqCiAgICogQHJldHVybnMgYSBzdHJpbmcKICAgKi8KICBmdW5jdGlvbiBnZXRB
dXRob3JpemVVUkwoJHRva2VuLCAkc2lnbl9pbl93aXRoX3R3aXR0ZXIgPSBUUlVFKSB7CiAg
ICBpZiAoaXNfYXJyYXkoJHRva2VuKSkgewogICAgICAkdG9rZW4gPSAkdG9rZW5bJ29hdXRo
X3Rva2VuJ107CiAgICB9CiAgICBpZiAoZW1wdHkoJHNpZ25faW5fd2l0aF90d2l0dGVyKSkg
ewogICAgICByZXR1cm4gJHRoaXMtPmF1dGhvcml6ZVVSTCgpIC4gIj9vYXV0aF90b2tlbj17
JHRva2VufSI7CiAgICB9IGVsc2UgewogICAgICAgcmV0dXJuICR0aGlzLT5hdXRoZW50aWNh
dGVVUkwoKSAuICI/b2F1dGhfdG9rZW49eyR0b2tlbn0iOwogICAgfQogIH0KCiAgLyoqCiAg
ICogRXhjaGFuZ2UgcmVxdWVzdCB0b2tlbiBhbmQgc2VjcmV0IGZvciBhbiBhY2Nlc3MgdG9r
ZW4gYW5kCiAgICogc2VjcmV0LCB0byBzaWduIEFQSSBjYWxscy4KICAgKgogICAqIEByZXR1
cm5zIGFycmF5KCJvYXV0aF90b2tlbiIgPT4gInRoZS1hY2Nlc3MtdG9rZW4iLAogICAqICAg
ICAgICAgICAgICAgICJvYXV0aF90b2tlbl9zZWNyZXQiID0+ICJ0aGUtYWNjZXNzLXNlY3Jl
dCIsCiAgICogICAgICAgICAgICAgICAgInVzZXJfaWQiID0+ICI5NDM2OTkyIiwKICAgKiAg
ICAgICAgICAgICAgICAic2NyZWVuX25hbWUiID0+ICJhYnJhaGFtIikKICAgKi8KICBmdW5j
dGlvbiBnZXRBY2Nlc3NUb2tlbigkb2F1dGhfdmVyaWZpZXIgPSBGQUxTRSkgewogICAgJHBh
cmFtZXRlcnMgPSBhcnJheSgpOwogICAgaWYgKCFlbXB0eSgkb2F1dGhfdmVyaWZpZXIpKSB7
CiAgICAgICRwYXJhbWV0ZXJzWydvYXV0aF92ZXJpZmllciddID0gJG9hdXRoX3ZlcmlmaWVy
OwogICAgfQogICAgJHJlcXVlc3QgPSAkdGhpcy0+b0F1dGhSZXF1ZXN0KCR0aGlzLT5hY2Nl
c3NUb2tlblVSTCgpLCAnR0VUJywgJHBhcmFtZXRlcnMpOwogICAgJHRva2VuID0gT0F1dGhV
dGlsOjpwYXJzZV9wYXJhbWV0ZXJzKCRyZXF1ZXN0KTsKICAgICR0aGlzLT50b2tlbiA9IG5l
dyBPQXV0aENvbnN1bWVyKCR0b2tlblsnb2F1dGhfdG9rZW4nXSwgJHRva2VuWydvYXV0aF90
b2tlbl9zZWNyZXQnXSk7CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAgLyoqCiAgICogT25l
IHRpbWUgZXhjaGFuZ2Ugb2YgdXNlcm5hbWUgYW5kIHBhc3N3b3JkIGZvciBhY2Nlc3MgdG9r
ZW4gYW5kIHNlY3JldC4KICAgKgogICAqIEByZXR1cm5zIGFycmF5KCJvYXV0aF90b2tlbiIg
PT4gInRoZS1hY2Nlc3MtdG9rZW4iLAogICAqICAgICAgICAgICAgICAgICJvYXV0aF90b2tl
bl9zZWNyZXQiID0+ICJ0aGUtYWNjZXNzLXNlY3JldCIsCiAgICogICAgICAgICAgICAgICAg
InVzZXJfaWQiID0+ICI5NDM2OTkyIiwKICAgKiAgICAgICAgICAgICAgICAic2NyZWVuX25h
bWUiID0+ICJhYnJhaGFtIiwKICAgKiAgICAgICAgICAgICAgICAieF9hdXRoX2V4cGlyZXMi
ID0+ICIwIikKICAgKi8KICBmdW5jdGlvbiBnZXRYQXV0aFRva2VuKCR1c2VybmFtZSwgJHBh
c3N3b3JkKSB7CiAgICAkcGFyYW1ldGVycyA9IGFycmF5KCk7CiAgICAkcGFyYW1ldGVyc1sn
eF9hdXRoX3VzZXJuYW1lJ10gPSAkdXNlcm5hbWU7CiAgICAkcGFyYW1ldGVyc1sneF9hdXRo
X3Bhc3N3b3JkJ10gPSAkcGFzc3dvcmQ7CiAgICAkcGFyYW1ldGVyc1sneF9hdXRoX21vZGUn
XSA9ICdjbGllbnRfYXV0aCc7CiAgICAkcmVxdWVzdCA9ICR0aGlzLT5vQXV0aFJlcXVlc3Qo
JHRoaXMtPmFjY2Vzc1Rva2VuVVJMKCksICdQT1NUJywgJHBhcmFtZXRlcnMpOwogICAgJHRv
a2VuID0gT0F1dGhVdGlsOjpwYXJzZV9wYXJhbWV0ZXJzKCRyZXF1ZXN0KTsKICAgICR0aGlz
LT50b2tlbiA9IG5ldyBPQXV0aENvbnN1bWVyKCR0b2tlblsnb2F1dGhfdG9rZW4nXSwgJHRv
a2VuWydvYXV0aF90b2tlbl9zZWNyZXQnXSk7CiAgICByZXR1cm4gJHRva2VuOwogIH0KCiAg
LyoqCiAgICogR0VUIHdyYXBwZXIgZm9yIG9BdXRoUmVxdWVzdC4KICAgKi8KICBmdW5jdGlv
biBnZXQoJHVybCwgJHBhcmFtZXRlcnMgPSBhcnJheSgpKSB7CiAgICAkcmVzcG9uc2UgPSAk
dGhpcy0+b0F1dGhSZXF1ZXN0KCR1cmwsICdHRVQnLCAkcGFyYW1ldGVycyk7CiAgICBpZiAo
JHRoaXMtPmZvcm1hdCA9PT0gJ2pzb24nICYmICR0aGlzLT5kZWNvZGVfanNvbikgewogICAg
ICByZXR1cm4ganNvbl9kZWNvZGUoJHJlc3BvbnNlKTsKICAgIH0KICAgIHJldHVybiAkcmVz
cG9uc2U7CiAgfQoKICAvKioKICAgKiBQT1NUIHdyYXBwZXIgZm9yIG9BdXRoUmVxdWVzdC4K
ICAgKi8KICBmdW5jdGlvbiBwb3N0KCR1cmwsICRwYXJhbWV0ZXJzID0gYXJyYXkoKSkgewog
ICAgJHJlc3BvbnNlID0gJHRoaXMtPm9BdXRoUmVxdWVzdCgkdXJsLCAnUE9TVCcsICRwYXJh
bWV0ZXJzKTsKICAgIGlmICgkdGhpcy0+Zm9ybWF0ID09PSAnanNvbicgJiYgJHRoaXMtPmRl
Y29kZV9qc29uKSB7CiAgICAgIHJldHVybiBqc29uX2RlY29kZSgkcmVzcG9uc2UpOwogICAg
fQogICAgcmV0dXJuICRyZXNwb25zZTsKICB9CgogIC8qKgogICAqIERFTEVURSB3cmFwcGVy
IGZvciBvQXV0aFJlcWV1c3QuCiAgICovCiAgZnVuY3Rpb24gZGVsZXRlKCR1cmwsICRwYXJh
bWV0ZXJzID0gYXJyYXkoKSkgewogICAgJHJlc3BvbnNlID0gJHRoaXMtPm9BdXRoUmVxdWVz
dCgkdXJsLCAnREVMRVRFJywgJHBhcmFtZXRlcnMpOwogICAgaWYgKCR0aGlzLT5mb3JtYXQg
PT09ICdqc29uJyAmJiAkdGhpcy0+ZGVjb2RlX2pzb24pIHsKICAgICAgcmV0dXJuIGpzb25f
ZGVjb2RlKCRyZXNwb25zZSk7CiAgICB9CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAg
LyoqCiAgICogRm9ybWF0IGFuZCBzaWduIGFuIE9BdXRoIC8gQVBJIHJlcXVlc3QKICAgKi8K
ICBmdW5jdGlvbiBvQXV0aFJlcXVlc3QoJHVybCwgJG1ldGhvZCwgJHBhcmFtZXRlcnMpIHsK
ICAgIGlmIChzdHJycG9zKCR1cmwsICdodHRwczovLycpICE9PSAwICYmIHN0cnJwb3MoJHVy
bCwgJ2h0dHA6Ly8nKSAhPT0gMCkgewogICAgICAkdXJsID0gInskdGhpcy0+aG9zdH17JHVy
bH0ueyR0aGlzLT5mb3JtYXR9IjsKICAgIH0KICAgICRyZXF1ZXN0ID0gT0F1dGhSZXF1ZXN0
Ojpmcm9tX2NvbnN1bWVyX2FuZF90b2tlbigkdGhpcy0+Y29uc3VtZXIsICR0aGlzLT50b2tl
biwgJG1ldGhvZCwgJHVybCwgJHBhcmFtZXRlcnMpOwogICAgJHJlcXVlc3QtPnNpZ25fcmVx
dWVzdCgkdGhpcy0+c2hhMV9tZXRob2QsICR0aGlzLT5jb25zdW1lciwgJHRoaXMtPnRva2Vu
KTsKICAgIHN3aXRjaCAoJG1ldGhvZCkgewogICAgY2FzZSAnR0VUJzoKICAgICAgcmV0dXJu
ICR0aGlzLT5odHRwKCRyZXF1ZXN0LT50b191cmwoKSwgJ0dFVCcpOwogICAgZGVmYXVsdDoK
ICAgICAgcmV0dXJuICR0aGlzLT5odHRwKCRyZXF1ZXN0LT5nZXRfbm9ybWFsaXplZF9odHRw
X3VybCgpLCAkbWV0aG9kLCAkcmVxdWVzdC0+dG9fcG9zdGRhdGEoKSk7CiAgICB9CiAgfQoK
ICAvKioKICAgKiBNYWtlIGFuIEhUVFAgcmVxdWVzdAogICAqCiAgICogQHJldHVybiBBUEkg
cmVzdWx0cwogICAqLwogIGZ1bmN0aW9uIGh0dHAoJHVybCwgJG1ldGhvZCwgJHBvc3RmaWVs
ZHMgPSBOVUxMKSB7CiAgICAkdGhpcy0+aHR0cF9pbmZvID0gYXJyYXkoKTsKICAgICRjaSA9
IGN1cmxfaW5pdCgpOwogICAgLyogQ3VybCBzZXR0aW5ncyAqLwogICAgY3VybF9zZXRvcHQo
JGNpLCBDVVJMT1BUX1VTRVJBR0VOVCwgJHRoaXMtPnVzZXJhZ2VudCk7CiAgICBjdXJsX3Nl
dG9wdCgkY2ksIENVUkxPUFRfQ09OTkVDVFRJTUVPVVQsICR0aGlzLT5jb25uZWN0dGltZW91
dCk7CiAgICBjdXJsX3NldG9wdCgkY2ksIENVUkxPUFRfVElNRU9VVCwgJHRoaXMtPnRpbWVv
dXQpOwogICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCBUUlVF
KTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9IVFRQSEVBREVSLCBhcnJheSgnRXhw
ZWN0OicpKTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9TU0xfVkVSSUZZUEVFUiwg
JHRoaXMtPnNzbF92ZXJpZnlwZWVyKTsKICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9QVF9I
RUFERVJGVU5DVElPTiwgYXJyYXkoJHRoaXMsICdnZXRIZWFkZXInKSk7CiAgICBjdXJsX3Nl
dG9wdCgkY2ksIENVUkxPUFRfSEVBREVSLCBGQUxTRSk7CgogICAgc3dpdGNoICgkbWV0aG9k
KSB7CiAgICAgIGNhc2UgJ1BPU1QnOgogICAgICAgIGN1cmxfc2V0b3B0KCRjaSwgQ1VSTE9Q
VF9QT1NULCBUUlVFKTsKICAgICAgICBpZiAoIWVtcHR5KCRwb3N0ZmllbGRzKSkgewogICAg
ICAgICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX1BPU1RGSUVMRFMsICRwb3N0ZmllbGRz
KTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ0RFTEVURSc6CiAgICAg
ICAgY3VybF9zZXRvcHQoJGNpLCBDVVJMT1BUX0NVU1RPTVJFUVVFU1QsICdERUxFVEUnKTsK
ICAgICAgICBpZiAoIWVtcHR5KCRwb3N0ZmllbGRzKSkgewogICAgICAgICAgJHVybCA9ICJ7
JHVybH0/eyRwb3N0ZmllbGRzfSI7CiAgICAgICAgfQogICAgfQoKICAgIGN1cmxfc2V0b3B0
KCRjaSwgQ1VSTE9QVF9VUkwsICR1cmwpOwogICAgJHJlc3BvbnNlID0gY3VybF9leGVjKCRj
aSk7CiAgICAkdGhpcy0+aHR0cF9jb2RlID0gY3VybF9nZXRpbmZvKCRjaSwgQ1VSTElORk9f
SFRUUF9DT0RFKTsKICAgICR0aGlzLT5odHRwX2luZm8gPSBhcnJheV9tZXJnZSgkdGhpcy0+
aHR0cF9pbmZvLCBjdXJsX2dldGluZm8oJGNpKSk7CiAgICAkdGhpcy0+dXJsID0gJHVybDsK
ICAgIGN1cmxfY2xvc2UgKCRjaSk7CiAgICByZXR1cm4gJHJlc3BvbnNlOwogIH0KCiAgLyoq
CiAgICogR2V0IHRoZSBoZWFkZXIgaW5mbyB0byBzdG9yZS4KICAgKi8KICBmdW5jdGlvbiBn
ZXRIZWFkZXIoJGNoLCAkaGVhZGVyKSB7CiAgICAkaSA9IHN0cnBvcygkaGVhZGVyLCAnOicp
OwogICAgaWYgKCFlbXB0eSgkaSkpIHsKICAgICAgJGtleSA9IHN0cl9yZXBsYWNlKCctJywg
J18nLCBzdHJ0b2xvd2VyKHN1YnN0cigkaGVhZGVyLCAwLCAkaSkpKTsKICAgICAgJHZhbHVl
ID0gdHJpbShzdWJzdHIoJGhlYWRlciwgJGkgKyAyKSk7CiAgICAgICR0aGlzLT5odHRwX2hl
YWRlclska2V5XSA9ICR2YWx1ZTsKICAgIH0KICAgIHJldHVybiBzdHJsZW4oJGhlYWRlcik7
CiAgfQp9CgpjbGFzcyBPQXV0aEV4Y2VwdGlvbiBleHRlbmRzIEV4Y2VwdGlvbiB7CiAgLy8g
cGFzcwp9CgpjbGFzcyBPQXV0aENvbnN1bWVyIHsKICBwdWJsaWMgJGtleTsKICBwdWJsaWMg
JHNlY3JldDsKCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGtleSwgJHNlY3JldCwgJGNhbGxi
YWNrX3VybD1OVUxMKSB7CiAgICAkdGhpcy0+a2V5ID0gJGtleTsKICAgICR0aGlzLT5zZWNy
ZXQgPSAkc2VjcmV0OwogICAgJHRoaXMtPmNhbGxiYWNrX3VybCA9ICRjYWxsYmFja191cmw7
CiAgfQoKICBmdW5jdGlvbiBfX3RvU3RyaW5nKCkgewogICAgcmV0dXJuICJPQXV0aENvbnN1
bWVyW2tleT0kdGhpcy0+a2V5LHNlY3JldD0kdGhpcy0+c2VjcmV0XSI7CiAgfQp9CgpjbGFz
cyBPQXV0aFRva2VuIHsKICAvLyBhY2Nlc3MgdG9rZW5zIGFuZCByZXF1ZXN0IHRva2Vucwog
IHB1YmxpYyAka2V5OwogIHB1YmxpYyAkc2VjcmV0OwoKICAvKioKICAgKiBrZXkgPSB0aGUg
dG9rZW4KICAgKiBzZWNyZXQgPSB0aGUgdG9rZW4gc2VjcmV0CiAgICovCiAgZnVuY3Rpb24g
X19jb25zdHJ1Y3QoJGtleSwgJHNlY3JldCkgewogICAgJHRoaXMtPmtleSA9ICRrZXk7CiAg
ICAkdGhpcy0+c2VjcmV0ID0gJHNlY3JldDsKICB9CgogIC8qKgogICAqIGdlbmVyYXRlcyB0
aGUgYmFzaWMgc3RyaW5nIHNlcmlhbGl6YXRpb24gb2YgYSB0b2tlbiB0aGF0IGEgc2VydmVy
CiAgICogd291bGQgcmVzcG9uZCB0byByZXF1ZXN0X3Rva2VuIGFuZCBhY2Nlc3NfdG9rZW4g
Y2FsbHMgd2l0aAogICAqLwogIGZ1bmN0aW9uIHRvX3N0cmluZygpIHsKICAgIHJldHVybiAi
b2F1dGhfdG9rZW49IiAuCiAgICAgICAgICAgT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4
NigkdGhpcy0+a2V5KSAuCiAgICAgICAgICAgIiZvYXV0aF90b2tlbl9zZWNyZXQ9IiAuCiAg
ICAgICAgICAgT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkdGhpcy0+c2VjcmV0KTsK
ICB9CgogIGZ1bmN0aW9uIF9fdG9TdHJpbmcoKSB7CiAgICByZXR1cm4gJHRoaXMtPnRvX3N0
cmluZygpOwogIH0KfQoKLyoqCiAqIEEgY2xhc3MgZm9yIGltcGxlbWVudGluZyBhIFNpZ25h
dHVyZSBNZXRob2QKICogU2VlIHNlY3Rpb24gOSAoIlNpZ25pbmcgUmVxdWVzdHMiKSBpbiB0
aGUgc3BlYwogKi8KYWJzdHJhY3QgY2xhc3MgT0F1dGhTaWduYXR1cmVNZXRob2QgewogIC8q
KgogICAqIE5lZWRzIHRvIHJldHVybiB0aGUgbmFtZSBvZiB0aGUgU2lnbmF0dXJlIE1ldGhv
ZCAoaWUgSE1BQy1TSEExKQogICAqIEByZXR1cm4gc3RyaW5nCiAgICovCiAgYWJzdHJhY3Qg
cHVibGljIGZ1bmN0aW9uIGdldF9uYW1lKCk7CgogIC8qKgogICAqIEJ1aWxkIHVwIHRoZSBz
aWduYXR1cmUKICAgKiBOT1RFOiBUaGUgb3V0cHV0IG9mIHRoaXMgZnVuY3Rpb24gTVVTVCBO
T1QgYmUgdXJsZW5jb2RlZC4KICAgKiB0aGUgZW5jb2RpbmcgaXMgaGFuZGxlZCBpbiBPQXV0
aFJlcXVlc3Qgd2hlbiB0aGUgZmluYWwKICAgKiByZXF1ZXN0IGlzIHNlcmlhbGl6ZWQKICAg
KiBAcGFyYW0gT0F1dGhSZXF1ZXN0ICRyZXF1ZXN0CiAgICogQHBhcmFtIE9BdXRoQ29uc3Vt
ZXIgJGNvbnN1bWVyCiAgICogQHBhcmFtIE9BdXRoVG9rZW4gJHRva2VuCiAgICogQHJldHVy
biBzdHJpbmcKICAgKi8KICBhYnN0cmFjdCBwdWJsaWMgZnVuY3Rpb24gYnVpbGRfc2lnbmF0
dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7CgogIC8qKgogICAqIFZlcmlmaWVz
IHRoYXQgYSBnaXZlbiBzaWduYXR1cmUgaXMgY29ycmVjdAogICAqIEBwYXJhbSBPQXV0aFJl
cXVlc3QgJHJlcXVlc3QKICAgKiBAcGFyYW0gT0F1dGhDb25zdW1lciAkY29uc3VtZXIKICAg
KiBAcGFyYW0gT0F1dGhUb2tlbiAkdG9rZW4KICAgKiBAcGFyYW0gc3RyaW5nICRzaWduYXR1
cmUKICAgKiBAcmV0dXJuIGJvb2wKICAgKi8KICBwdWJsaWMgZnVuY3Rpb24gY2hlY2tfc2ln
bmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbiwgJHNpZ25hdHVyZSkgewogICAg
JGJ1aWx0ID0gJHRoaXMtPmJ1aWxkX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAk
dG9rZW4pOwogICAgcmV0dXJuICRidWlsdCA9PSAkc2lnbmF0dXJlOwogIH0KfQoKLyoqCiAq
IFRoZSBITUFDLVNIQTEgc2lnbmF0dXJlIG1ldGhvZCB1c2VzIHRoZSBITUFDLVNIQTEgc2ln
bmF0dXJlIGFsZ29yaXRobSBhcyBkZWZpbmVkIGluIFtSRkMyMTA0XQogKiB3aGVyZSB0aGUg
U2lnbmF0dXJlIEJhc2UgU3RyaW5nIGlzIHRoZSB0ZXh0IGFuZCB0aGUga2V5IGlzIHRoZSBj
b25jYXRlbmF0ZWQgdmFsdWVzIChlYWNoIGZpcnN0CiAqIGVuY29kZWQgcGVyIFBhcmFtZXRl
ciBFbmNvZGluZykgb2YgdGhlIENvbnN1bWVyIFNlY3JldCBhbmQgVG9rZW4gU2VjcmV0LCBz
ZXBhcmF0ZWQgYnkgYW4gJyYnCiAqIGNoYXJhY3RlciAoQVNDSUkgY29kZSAzOCkgZXZlbiBp
ZiBlbXB0eS4KICogICAtIENoYXB0ZXIgOS4yICgiSE1BQy1TSEExIikKICovCmNsYXNzIE9B
dXRoU2lnbmF0dXJlTWV0aG9kX0hNQUNfU0hBMSBleHRlbmRzIE9BdXRoU2lnbmF0dXJlTWV0
aG9kIHsKICBmdW5jdGlvbiBnZXRfbmFtZSgpIHsKICAgIHJldHVybiAiSE1BQy1TSEExIjsK
ICB9CgogIHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25z
dW1lciwgJHRva2VuKSB7CiAgICAkYmFzZV9zdHJpbmcgPSAkcmVxdWVzdC0+Z2V0X3NpZ25h
dHVyZV9iYXNlX3N0cmluZygpOwogICAgJHJlcXVlc3QtPmJhc2Vfc3RyaW5nID0gJGJhc2Vf
c3RyaW5nOwoKICAgICRrZXlfcGFydHMgPSBhcnJheSgKICAgICAgJGNvbnN1bWVyLT5zZWNy
ZXQsCiAgICAgICgkdG9rZW4pID8gJHRva2VuLT5zZWNyZXQgOiAiIgogICAgKTsKCiAgICAk
a2V5X3BhcnRzID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4Nigka2V5X3BhcnRzKTsK
ICAgICRrZXkgPSBpbXBsb2RlKCcmJywgJGtleV9wYXJ0cyk7CgogICAgcmV0dXJuIGJhc2U2
NF9lbmNvZGUoaGFzaF9obWFjKCdzaGExJywgJGJhc2Vfc3RyaW5nLCAka2V5LCB0cnVlKSk7
CiAgfQp9CgovKioKICogVGhlIFBMQUlOVEVYVCBtZXRob2QgZG9lcyBub3QgcHJvdmlkZSBh
bnkgc2VjdXJpdHkgcHJvdGVjdGlvbiBhbmQgU0hPVUxEIG9ubHkgYmUgdXNlZAogKiBvdmVy
IGEgc2VjdXJlIGNoYW5uZWwgc3VjaCBhcyBIVFRQUy4gSXQgZG9lcyBub3QgdXNlIHRoZSBT
aWduYXR1cmUgQmFzZSBTdHJpbmcuCiAqICAgLSBDaGFwdGVyIDkuNCAoIlBMQUlOVEVYVCIp
CiAqLwpjbGFzcyBPQXV0aFNpZ25hdHVyZU1ldGhvZF9QTEFJTlRFWFQgZXh0ZW5kcyBPQXV0
aFNpZ25hdHVyZU1ldGhvZCB7CiAgcHVibGljIGZ1bmN0aW9uIGdldF9uYW1lKCkgewogICAg
cmV0dXJuICJQTEFJTlRFWFQiOwogIH0KCiAgLyoqCiAgICogb2F1dGhfc2lnbmF0dXJlIGlz
IHNldCB0byB0aGUgY29uY2F0ZW5hdGVkIGVuY29kZWQgdmFsdWVzIG9mIHRoZSBDb25zdW1l
ciBTZWNyZXQgYW5kCiAgICogVG9rZW4gU2VjcmV0LCBzZXBhcmF0ZWQgYnkgYSAnJicgY2hh
cmFjdGVyIChBU0NJSSBjb2RlIDM4KSwgZXZlbiBpZiBlaXRoZXIgc2VjcmV0IGlzCiAgICog
ZW1wdHkuIFRoZSByZXN1bHQgTVVTVCBiZSBlbmNvZGVkIGFnYWluLgogICAqICAgLSBDaGFw
dGVyIDkuNC4xICgiR2VuZXJhdGluZyBTaWduYXR1cmVzIikKICAgKgogICAqIFBsZWFzZSBu
b3RlIHRoYXQgdGhlIHNlY29uZCBlbmNvZGluZyBNVVNUIE5PVCBoYXBwZW4gaW4gdGhlIFNp
Z25hdHVyZU1ldGhvZCwgYXMKICAgKiBPQXV0aFJlcXVlc3QgaGFuZGxlcyB0aGlzIQogICAq
LwogIHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1l
ciwgJHRva2VuKSB7CiAgICAka2V5X3BhcnRzID0gYXJyYXkoCiAgICAgICRjb25zdW1lci0+
c2VjcmV0LAogICAgICAoJHRva2VuKSA/ICR0b2tlbi0+c2VjcmV0IDogIiIKICAgICk7Cgog
ICAgJGtleV9wYXJ0cyA9IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYoJGtleV9wYXJ0
cyk7CiAgICAka2V5ID0gaW1wbG9kZSgnJicsICRrZXlfcGFydHMpOwogICAgJHJlcXVlc3Qt
PmJhc2Vfc3RyaW5nID0gJGtleTsKCiAgICByZXR1cm4gJGtleTsKICB9Cn0KCi8qKgogKiBU
aGUgUlNBLVNIQTEgc2lnbmF0dXJlIG1ldGhvZCB1c2VzIHRoZSBSU0FTU0EtUEtDUzEtdjFf
NSBzaWduYXR1cmUgYWxnb3JpdGhtIGFzIGRlZmluZWQgaW4KICogW1JGQzM0NDddIHNlY3Rp
b24gOC4yIChtb3JlIHNpbXBseSBrbm93biBhcyBQS0NTIzEpLCB1c2luZyBTSEEtMSBhcyB0
aGUgaGFzaCBmdW5jdGlvbiBmb3IKICogRU1TQS1QS0NTMS12MV81LiBJdCBpcyBhc3N1bWVk
IHRoYXQgdGhlIENvbnN1bWVyIGhhcyBwcm92aWRlZCBpdHMgUlNBIHB1YmxpYyBrZXkgaW4g
YQogKiB2ZXJpZmllZCB3YXkgdG8gdGhlIFNlcnZpY2UgUHJvdmlkZXIsIGluIGEgbWFubmVy
IHdoaWNoIGlzIGJleW9uZCB0aGUgc2NvcGUgb2YgdGhpcwogKiBzcGVjaWZpY2F0aW9uLgog
KiAgIC0gQ2hhcHRlciA5LjMgKCJSU0EtU0hBMSIpCiAqLwphYnN0cmFjdCBjbGFzcyBPQXV0
aFNpZ25hdHVyZU1ldGhvZF9SU0FfU0hBMSBleHRlbmRzIE9BdXRoU2lnbmF0dXJlTWV0aG9k
IHsKICBwdWJsaWMgZnVuY3Rpb24gZ2V0X25hbWUoKSB7CiAgICByZXR1cm4gIlJTQS1TSEEx
IjsKICB9CgogIC8vIFVwIHRvIHRoZSBTUCB0byBpbXBsZW1lbnQgdGhpcyBsb29rdXAgb2Yg
a2V5cy4gUG9zc2libGUgaWRlYXMgYXJlOgogIC8vICgxKSBkbyBhIGxvb2t1cCBpbiBhIHRh
YmxlIG9mIHRydXN0ZWQgY2VydHMga2V5ZWQgb2ZmIG9mIGNvbnN1bWVyCiAgLy8gKDIpIGZl
dGNoIHZpYSBodHRwIHVzaW5nIGEgdXJsIHByb3ZpZGVkIGJ5IHRoZSByZXF1ZXN0ZXIKICAv
LyAoMykgc29tZSBzb3J0IG9mIHNwZWNpZmljIGRpc2NvdmVyeSBjb2RlIGJhc2VkIG9uIHJl
cXVlc3QKICAvLwogIC8vIEVpdGhlciB3YXkgc2hvdWxkIHJldHVybiBhIHN0cmluZyByZXBy
ZXNlbnRhdGlvbiBvZiB0aGUgY2VydGlmaWNhdGUKICBwcm90ZWN0ZWQgYWJzdHJhY3QgZnVu
Y3Rpb24gZmV0Y2hfcHVibGljX2NlcnQoJiRyZXF1ZXN0KTsKCiAgLy8gVXAgdG8gdGhlIFNQ
IHRvIGltcGxlbWVudCB0aGlzIGxvb2t1cCBvZiBrZXlzLiBQb3NzaWJsZSBpZGVhcyBhcmU6
CiAgLy8gKDEpIGRvIGEgbG9va3VwIGluIGEgdGFibGUgb2YgdHJ1c3RlZCBjZXJ0cyBrZXll
ZCBvZmYgb2YgY29uc3VtZXIKICAvLwogIC8vIEVpdGhlciB3YXkgc2hvdWxkIHJldHVybiBh
IHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgY2VydGlmaWNhdGUKICBwcm90ZWN0ZWQg
YWJzdHJhY3QgZnVuY3Rpb24gZmV0Y2hfcHJpdmF0ZV9jZXJ0KCYkcmVxdWVzdCk7CgogIHB1
YmxpYyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHJlcXVlc3QsICRjb25zdW1lciwgJHRv
a2VuKSB7CiAgICAkYmFzZV9zdHJpbmcgPSAkcmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9iYXNl
X3N0cmluZygpOwogICAgJHJlcXVlc3QtPmJhc2Vfc3RyaW5nID0gJGJhc2Vfc3RyaW5nOwoK
ICAgIC8vIEZldGNoIHRoZSBwcml2YXRlIGtleSBjZXJ0IGJhc2VkIG9uIHRoZSByZXF1ZXN0
CiAgICAkY2VydCA9ICR0aGlzLT5mZXRjaF9wcml2YXRlX2NlcnQoJHJlcXVlc3QpOwoKICAg
IC8vIFB1bGwgdGhlIHByaXZhdGUga2V5IElEIGZyb20gdGhlIGNlcnRpZmljYXRlCiAgICAk
cHJpdmF0ZWtleWlkID0gb3BlbnNzbF9nZXRfcHJpdmF0ZWtleSgkY2VydCk7CgogICAgLy8g
U2lnbiB1c2luZyB0aGUga2V5CiAgICAkb2sgPSBvcGVuc3NsX3NpZ24oJGJhc2Vfc3RyaW5n
LCAkc2lnbmF0dXJlLCAkcHJpdmF0ZWtleWlkKTsKCiAgICAvLyBSZWxlYXNlIHRoZSBrZXkg
cmVzb3VyY2UKICAgIG9wZW5zc2xfZnJlZV9rZXkoJHByaXZhdGVrZXlpZCk7CgogICAgcmV0
dXJuIGJhc2U2NF9lbmNvZGUoJHNpZ25hdHVyZSk7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24g
Y2hlY2tfc2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbiwgJHNpZ25hdHVy
ZSkgewogICAgJGRlY29kZWRfc2lnID0gYmFzZTY0X2RlY29kZSgkc2lnbmF0dXJlKTsKCiAg
ICAkYmFzZV9zdHJpbmcgPSAkcmVxdWVzdC0+Z2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygp
OwoKICAgIC8vIEZldGNoIHRoZSBwdWJsaWMga2V5IGNlcnQgYmFzZWQgb24gdGhlIHJlcXVl
c3QKICAgICRjZXJ0ID0gJHRoaXMtPmZldGNoX3B1YmxpY19jZXJ0KCRyZXF1ZXN0KTsKCiAg
ICAvLyBQdWxsIHRoZSBwdWJsaWMga2V5IElEIGZyb20gdGhlIGNlcnRpZmljYXRlCiAgICAk
cHVibGlja2V5aWQgPSBvcGVuc3NsX2dldF9wdWJsaWNrZXkoJGNlcnQpOwoKICAgIC8vIENo
ZWNrIHRoZSBjb21wdXRlZCBzaWduYXR1cmUgYWdhaW5zdCB0aGUgb25lIHBhc3NlZCBpbiB0
aGUgcXVlcnkKICAgICRvayA9IG9wZW5zc2xfdmVyaWZ5KCRiYXNlX3N0cmluZywgJGRlY29k
ZWRfc2lnLCAkcHVibGlja2V5aWQpOwoKICAgIC8vIFJlbGVhc2UgdGhlIGtleSByZXNvdXJj
ZQogICAgb3BlbnNzbF9mcmVlX2tleSgkcHVibGlja2V5aWQpOwoKICAgIHJldHVybiAkb2sg
PT0gMTsKICB9Cn0KCmNsYXNzIE9BdXRoUmVxdWVzdCB7CiAgcHJpdmF0ZSAkcGFyYW1ldGVy
czsKICBwcml2YXRlICRodHRwX21ldGhvZDsKICBwcml2YXRlICRodHRwX3VybDsKICAvLyBm
b3IgZGVidWcgcHVycG9zZXMKICBwdWJsaWMgJGJhc2Vfc3RyaW5nOwogIHB1YmxpYyBzdGF0
aWMgJHZlcnNpb24gPSAnMS4wJzsKICBwdWJsaWMgc3RhdGljICRQT1NUX0lOUFVUID0gJ3Bo
cDovL2lucHV0JzsKCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGh0dHBfbWV0aG9kLCAkaHR0
cF91cmwsICRwYXJhbWV0ZXJzPU5VTEwpIHsKICAgIEAkcGFyYW1ldGVycyBvciAkcGFyYW1l
dGVycyA9IGFycmF5KCk7CiAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCBPQXV0aFV0
aWw6OnBhcnNlX3BhcmFtZXRlcnMocGFyc2VfdXJsKCRodHRwX3VybCwgUEhQX1VSTF9RVUVS
WSkpLCAkcGFyYW1ldGVycyk7CiAgICAkdGhpcy0+cGFyYW1ldGVycyA9ICRwYXJhbWV0ZXJz
OwogICAgJHRoaXMtPmh0dHBfbWV0aG9kID0gJGh0dHBfbWV0aG9kOwogICAgJHRoaXMtPmh0
dHBfdXJsID0gJGh0dHBfdXJsOwogIH0KCgogIC8qKgogICAqIGF0dGVtcHQgdG8gYnVpbGQg
dXAgYSByZXF1ZXN0IGZyb20gd2hhdCB3YXMgcGFzc2VkIHRvIHRoZSBzZXJ2ZXIKICAgKi8K
ICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIGZyb21fcmVxdWVzdCgkaHR0cF9tZXRob2Q9TlVM
TCwgJGh0dHBfdXJsPU5VTEwsICRwYXJhbWV0ZXJzPU5VTEwpIHsKICAgICRzY2hlbWUgPSAo
IWlzc2V0KCRfU0VSVkVSWydIVFRQUyddKSB8fCAkX1NFUlZFUlsnSFRUUFMnXSAhPSAib24i
KQogICAgICAgICAgICAgID8gJ2h0dHAnCiAgICAgICAgICAgICAgOiAnaHR0cHMnOwogICAg
QCRodHRwX3VybCBvciAkaHR0cF91cmwgPSAkc2NoZW1lIC4KICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgJzovLycgLiAkX1NFUlZFUlsnSFRUUF9IT1NUJ10gLgogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAnOicgLgogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAkX1NFUlZFUlsnU0VSVkVSX1BPUlQnXSAuCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICRfU0VSVkVSWydSRVFVRVNUX1VSSSddOwogICAgQCRodHRwX21ldGhvZCBvciAkaHR0
cF9tZXRob2QgPSAkX1NFUlZFUlsnUkVRVUVTVF9NRVRIT0QnXTsKCiAgICAvLyBXZSB3ZXJl
bid0IGhhbmRlZCBhbnkgcGFyYW1ldGVycywgc28gbGV0J3MgZmluZCB0aGUgb25lcyByZWxl
dmFudCB0bwogICAgLy8gdGhpcyByZXF1ZXN0LgogICAgLy8gSWYgeW91IHJ1biBYTUwtUlBD
IG9yIHNpbWlsYXIgeW91IHNob3VsZCB1c2UgdGhpcyB0byBwcm92aWRlIHlvdXIgb3duCiAg
ICAvLyBwYXJzZWQgcGFyYW1ldGVyLWxpc3QKICAgIGlmICghJHBhcmFtZXRlcnMpIHsKICAg
ICAgLy8gRmluZCByZXF1ZXN0IGhlYWRlcnMKICAgICAgJHJlcXVlc3RfaGVhZGVycyA9IE9B
dXRoVXRpbDo6Z2V0X2hlYWRlcnMoKTsKCiAgICAgIC8vIFBhcnNlIHRoZSBxdWVyeS1zdHJp
bmcgdG8gZmluZCBHRVQgcGFyYW1ldGVycwogICAgICAkcGFyYW1ldGVycyA9IE9BdXRoVXRp
bDo6cGFyc2VfcGFyYW1ldGVycygkX1NFUlZFUlsnUVVFUllfU1RSSU5HJ10pOwoKICAgICAg
Ly8gSXQncyBhIFBPU1QgcmVxdWVzdCBvZiB0aGUgcHJvcGVyIGNvbnRlbnQtdHlwZSwgc28g
cGFyc2UgUE9TVAogICAgICAvLyBwYXJhbWV0ZXJzIGFuZCBhZGQgdGhvc2Ugb3ZlcnJpZGlu
ZyBhbnkgZHVwbGljYXRlcyBmcm9tIEdFVAogICAgICBpZiAoJGh0dHBfbWV0aG9kID09ICJQ
T1NUIgogICAgICAgICAgJiYgQHN0cnN0cigkcmVxdWVzdF9oZWFkZXJzWyJDb250ZW50LVR5
cGUiXSwKICAgICAgICAgICAgICAgICAgICAgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJs
ZW5jb2RlZCIpCiAgICAgICAgICApIHsKICAgICAgICAkcG9zdF9kYXRhID0gT0F1dGhVdGls
OjpwYXJzZV9wYXJhbWV0ZXJzKAogICAgICAgICAgZmlsZV9nZXRfY29udGVudHMoc2VsZjo6
JFBPU1RfSU5QVVQpCiAgICAgICAgKTsKICAgICAgICAkcGFyYW1ldGVycyA9IGFycmF5X21l
cmdlKCRwYXJhbWV0ZXJzLCAkcG9zdF9kYXRhKTsKICAgICAgfQoKICAgICAgLy8gV2UgaGF2
ZSBhIEF1dGhvcml6YXRpb24taGVhZGVyIHdpdGggT0F1dGggZGF0YS4gUGFyc2UgdGhlIGhl
YWRlcgogICAgICAvLyBhbmQgYWRkIHRob3NlIG92ZXJyaWRpbmcgYW55IGR1cGxpY2F0ZXMg
ZnJvbSBHRVQgb3IgUE9TVAogICAgICBpZiAoQHN1YnN0cigkcmVxdWVzdF9oZWFkZXJzWydB
dXRob3JpemF0aW9uJ10sIDAsIDYpID09ICJPQXV0aCAiKSB7CiAgICAgICAgJGhlYWRlcl9w
YXJhbWV0ZXJzID0gT0F1dGhVdGlsOjpzcGxpdF9oZWFkZXIoCiAgICAgICAgICAkcmVxdWVz
dF9oZWFkZXJzWydBdXRob3JpemF0aW9uJ10KICAgICAgICApOwogICAgICAgICRwYXJhbWV0
ZXJzID0gYXJyYXlfbWVyZ2UoJHBhcmFtZXRlcnMsICRoZWFkZXJfcGFyYW1ldGVycyk7CiAg
ICAgIH0KCiAgICB9CgogICAgcmV0dXJuIG5ldyBPQXV0aFJlcXVlc3QoJGh0dHBfbWV0aG9k
LCAkaHR0cF91cmwsICRwYXJhbWV0ZXJzKTsKICB9CgogIC8qKgogICAqIHByZXR0eSBtdWNo
IGEgaGVscGVyIGZ1bmN0aW9uIHRvIHNldCB1cCB0aGUgcmVxdWVzdAogICAqLwogIHB1Ymxp
YyBzdGF0aWMgZnVuY3Rpb24gZnJvbV9jb25zdW1lcl9hbmRfdG9rZW4oJGNvbnN1bWVyLCAk
dG9rZW4sICRodHRwX21ldGhvZCwgJGh0dHBfdXJsLCAkcGFyYW1ldGVycz1OVUxMKSB7CiAg
ICBAJHBhcmFtZXRlcnMgb3IgJHBhcmFtZXRlcnMgPSBhcnJheSgpOwogICAgJGRlZmF1bHRz
ID0gYXJyYXkoIm9hdXRoX3ZlcnNpb24iID0+IE9BdXRoUmVxdWVzdDo6JHZlcnNpb24sCiAg
ICAgICAgICAgICAgICAgICAgICAib2F1dGhfbm9uY2UiID0+IE9BdXRoUmVxdWVzdDo6Z2Vu
ZXJhdGVfbm9uY2UoKSwKICAgICAgICAgICAgICAgICAgICAgICJvYXV0aF90aW1lc3RhbXAi
ID0+IE9BdXRoUmVxdWVzdDo6Z2VuZXJhdGVfdGltZXN0YW1wKCksCiAgICAgICAgICAgICAg
ICAgICAgICAib2F1dGhfY29uc3VtZXJfa2V5IiA9PiAkY29uc3VtZXItPmtleSk7CiAgICBp
ZiAoJHRva2VuKQogICAgICAkZGVmYXVsdHNbJ29hdXRoX3Rva2VuJ10gPSAkdG9rZW4tPmtl
eTsKCiAgICAkcGFyYW1ldGVycyA9IGFycmF5X21lcmdlKCRkZWZhdWx0cywgJHBhcmFtZXRl
cnMpOwoKICAgIHJldHVybiBuZXcgT0F1dGhSZXF1ZXN0KCRodHRwX21ldGhvZCwgJGh0dHBf
dXJsLCAkcGFyYW1ldGVycyk7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gc2V0X3BhcmFtZXRl
cigkbmFtZSwgJHZhbHVlLCAkYWxsb3dfZHVwbGljYXRlcyA9IHRydWUpIHsKICAgIGlmICgk
YWxsb3dfZHVwbGljYXRlcyAmJiBpc3NldCgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pKSB7
CiAgICAgIC8vIFdlIGhhdmUgYWxyZWFkeSBhZGRlZCBwYXJhbWV0ZXIocykgd2l0aCB0aGlz
IG5hbWUsIHNvIGFkZCB0byB0aGUgbGlzdAogICAgICBpZiAoaXNfc2NhbGFyKCR0aGlzLT5w
YXJhbWV0ZXJzWyRuYW1lXSkpIHsKICAgICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCBkdXBs
aWNhdGUsIHNvIHRyYW5zZm9ybSBzY2FsYXIgKHN0cmluZykKICAgICAgICAvLyBpbnRvIGFu
IGFycmF5IHNvIHdlIGNhbiBhZGQgdGhlIGR1cGxpY2F0ZXMKICAgICAgICAkdGhpcy0+cGFy
YW1ldGVyc1skbmFtZV0gPSBhcnJheSgkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV0pOwogICAg
ICB9CgogICAgICAkdGhpcy0+cGFyYW1ldGVyc1skbmFtZV1bXSA9ICR2YWx1ZTsKICAgIH0g
ZWxzZSB7CiAgICAgICR0aGlzLT5wYXJhbWV0ZXJzWyRuYW1lXSA9ICR2YWx1ZTsKICAgIH0K
ICB9CgogIHB1YmxpYyBmdW5jdGlvbiBnZXRfcGFyYW1ldGVyKCRuYW1lKSB7CiAgICByZXR1
cm4gaXNzZXQoJHRoaXMtPnBhcmFtZXRlcnNbJG5hbWVdKSA/ICR0aGlzLT5wYXJhbWV0ZXJz
WyRuYW1lXSA6IG51bGw7CiAgfQoKICBwdWJsaWMgZnVuY3Rpb24gZ2V0X3BhcmFtZXRlcnMo
KSB7CiAgICByZXR1cm4gJHRoaXMtPnBhcmFtZXRlcnM7CiAgfQoKICBwdWJsaWMgZnVuY3Rp
b24gdW5zZXRfcGFyYW1ldGVyKCRuYW1lKSB7CiAgICB1bnNldCgkdGhpcy0+cGFyYW1ldGVy
c1skbmFtZV0pOwogIH0KCiAgLyoqCiAgICogVGhlIHJlcXVlc3QgcGFyYW1ldGVycywgc29y
dGVkIGFuZCBjb25jYXRlbmF0ZWQgaW50byBhIG5vcm1hbGl6ZWQgc3RyaW5nLgogICAqIEBy
ZXR1cm4gc3RyaW5nCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGdldF9zaWduYWJsZV9wYXJh
bWV0ZXJzKCkgewogICAgLy8gR3JhYiBhbGwgcGFyYW1ldGVycwogICAgJHBhcmFtcyA9ICR0
aGlzLT5wYXJhbWV0ZXJzOwoKICAgIC8vIFJlbW92ZSBvYXV0aF9zaWduYXR1cmUgaWYgcHJl
c2VudAogICAgLy8gUmVmOiBTcGVjOiA5LjEuMSAoIlRoZSBvYXV0aF9zaWduYXR1cmUgcGFy
YW1ldGVyIE1VU1QgYmUgZXhjbHVkZWQuIikKICAgIGlmIChpc3NldCgkcGFyYW1zWydvYXV0
aF9zaWduYXR1cmUnXSkpIHsKICAgICAgdW5zZXQoJHBhcmFtc1snb2F1dGhfc2lnbmF0dXJl
J10pOwogICAgfQoKICAgIHJldHVybiBPQXV0aFV0aWw6OmJ1aWxkX2h0dHBfcXVlcnkoJHBh
cmFtcyk7CiAgfQoKICAvKioKICAgKiBSZXR1cm5zIHRoZSBiYXNlIHN0cmluZyBvZiB0aGlz
IHJlcXVlc3QKICAgKgogICAqIFRoZSBiYXNlIHN0cmluZyBkZWZpbmVkIGFzIHRoZSBtZXRo
b2QsIHRoZSB1cmwKICAgKiBhbmQgdGhlIHBhcmFtZXRlcnMgKG5vcm1hbGl6ZWQpLCBlYWNo
IHVybGVuY29kZWQKICAgKiBhbmQgdGhlIGNvbmNhdGVkIHdpdGggJi4KICAgKi8KICBwdWJs
aWMgZnVuY3Rpb24gZ2V0X3NpZ25hdHVyZV9iYXNlX3N0cmluZygpIHsKICAgICRwYXJ0cyA9
IGFycmF5KAogICAgICAkdGhpcy0+Z2V0X25vcm1hbGl6ZWRfaHR0cF9tZXRob2QoKSwKICAg
ICAgJHRoaXMtPmdldF9ub3JtYWxpemVkX2h0dHBfdXJsKCksCiAgICAgICR0aGlzLT5nZXRf
c2lnbmFibGVfcGFyYW1ldGVycygpCiAgICApOwoKICAgICRwYXJ0cyA9IE9BdXRoVXRpbDo6
dXJsZW5jb2RlX3JmYzM5ODYoJHBhcnRzKTsKCiAgICByZXR1cm4gaW1wbG9kZSgnJicsICRw
YXJ0cyk7CiAgfQoKICAvKioKICAgKiBqdXN0IHVwcGVyY2FzZXMgdGhlIGh0dHAgbWV0aG9k
CiAgICovCiAgcHVibGljIGZ1bmN0aW9uIGdldF9ub3JtYWxpemVkX2h0dHBfbWV0aG9kKCkg
ewogICAgcmV0dXJuIHN0cnRvdXBwZXIoJHRoaXMtPmh0dHBfbWV0aG9kKTsKICB9CgogIC8q
KgogICAqIHBhcnNlcyB0aGUgdXJsIGFuZCByZWJ1aWxkcyBpdCB0byBiZQogICAqIHNjaGVt
ZTovL2hvc3QvcGF0aAogICAqLwogIHB1YmxpYyBmdW5jdGlvbiBnZXRfbm9ybWFsaXplZF9o
dHRwX3VybCgpIHsKICAgICRwYXJ0cyA9IHBhcnNlX3VybCgkdGhpcy0+aHR0cF91cmwpOwoK
ICAgICRwb3J0ID0gQCRwYXJ0c1sncG9ydCddOwogICAgJHNjaGVtZSA9ICRwYXJ0c1snc2No
ZW1lJ107CiAgICAkaG9zdCA9ICRwYXJ0c1snaG9zdCddOwogICAgJHBhdGggPSBAJHBhcnRz
WydwYXRoJ107CgogICAgJHBvcnQgb3IgJHBvcnQgPSAoJHNjaGVtZSA9PSAnaHR0cHMnKSA/
ICc0NDMnIDogJzgwJzsKCiAgICBpZiAoKCRzY2hlbWUgPT0gJ2h0dHBzJyAmJiAkcG9ydCAh
PSAnNDQzJykKICAgICAgICB8fCAoJHNjaGVtZSA9PSAnaHR0cCcgJiYgJHBvcnQgIT0gJzgw
JykpIHsKICAgICAgJGhvc3QgPSAiJGhvc3Q6JHBvcnQiOwogICAgfQogICAgcmV0dXJuICIk
c2NoZW1lOi8vJGhvc3QkcGF0aCI7CiAgfQoKICAvKioKICAgKiBidWlsZHMgYSB1cmwgdXNh
YmxlIGZvciBhIEdFVCByZXF1ZXN0CiAgICovCiAgcHVibGljIGZ1bmN0aW9uIHRvX3VybCgp
IHsKICAgICRwb3N0X2RhdGEgPSAkdGhpcy0+dG9fcG9zdGRhdGEoKTsKICAgICRvdXQgPSAk
dGhpcy0+Z2V0X25vcm1hbGl6ZWRfaHR0cF91cmwoKTsKICAgIGlmICgkcG9zdF9kYXRhKSB7
CiAgICAgICRvdXQgLj0gJz8nLiRwb3N0X2RhdGE7CiAgICB9CiAgICByZXR1cm4gJG91dDsK
ICB9CgogIC8qKgogICAqIGJ1aWxkcyB0aGUgZGF0YSBvbmUgd291bGQgc2VuZCBpbiBhIFBP
U1QgcmVxdWVzdAogICAqLwogIHB1YmxpYyBmdW5jdGlvbiB0b19wb3N0ZGF0YSgpIHsKICAg
IHJldHVybiBPQXV0aFV0aWw6OmJ1aWxkX2h0dHBfcXVlcnkoJHRoaXMtPnBhcmFtZXRlcnMp
OwogIH0KCiAgLyoqCiAgICogYnVpbGRzIHRoZSBBdXRob3JpemF0aW9uOiBoZWFkZXIKICAg
Ki8KICBwdWJsaWMgZnVuY3Rpb24gdG9faGVhZGVyKCRyZWFsbT1udWxsKSB7CiAgICAkZmly
c3QgPSB0cnVlOwogIGlmKCRyZWFsbSkgewogICAgICAkb3V0ID0gJ0F1dGhvcml6YXRpb246
IE9BdXRoIHJlYWxtPSInIC4gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NigkcmVhbG0p
IC4gJyInOwogICAgICAkZmlyc3QgPSBmYWxzZTsKICAgIH0gZWxzZQogICAgICAkb3V0ID0g
J0F1dGhvcml6YXRpb246IE9BdXRoJzsKCiAgICAkdG90YWwgPSBhcnJheSgpOwogICAgZm9y
ZWFjaCAoJHRoaXMtPnBhcmFtZXRlcnMgYXMgJGsgPT4gJHYpIHsKICAgICAgaWYgKHN1YnN0
cigkaywgMCwgNSkgIT0gIm9hdXRoIikgY29udGludWU7CiAgICAgIGlmIChpc19hcnJheSgk
dikpIHsKICAgICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oJ0FycmF5cyBub3Qgc3Vw
cG9ydGVkIGluIGhlYWRlcnMnKTsKICAgICAgfQogICAgICAkb3V0IC49ICgkZmlyc3QpID8g
JyAnIDogJywnOwogICAgICAkb3V0IC49IE9BdXRoVXRpbDo6dXJsZW5jb2RlX3JmYzM5ODYo
JGspIC4KICAgICAgICAgICAgICAnPSInIC4KICAgICAgICAgICAgICBPQXV0aFV0aWw6OnVy
bGVuY29kZV9yZmMzOTg2KCR2KSAuCiAgICAgICAgICAgICAgJyInOwogICAgICAkZmlyc3Qg
PSBmYWxzZTsKICAgIH0KICAgIHJldHVybiAkb3V0OwogIH0KCiAgcHVibGljIGZ1bmN0aW9u
IF9fdG9TdHJpbmcoKSB7CiAgICByZXR1cm4gJHRoaXMtPnRvX3VybCgpOwogIH0KCgogIHB1
YmxpYyBmdW5jdGlvbiBzaWduX3JlcXVlc3QoJHNpZ25hdHVyZV9tZXRob2QsICRjb25zdW1l
ciwgJHRva2VuKSB7CiAgICAkdGhpcy0+c2V0X3BhcmFtZXRlcigKICAgICAgIm9hdXRoX3Np
Z25hdHVyZV9tZXRob2QiLAogICAgICAkc2lnbmF0dXJlX21ldGhvZC0+Z2V0X25hbWUoKSwK
ICAgICAgZmFsc2UKICAgICk7CiAgICAkc2lnbmF0dXJlID0gJHRoaXMtPmJ1aWxkX3NpZ25h
dHVyZSgkc2lnbmF0dXJlX21ldGhvZCwgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAgJHRoaXMt
PnNldF9wYXJhbWV0ZXIoIm9hdXRoX3NpZ25hdHVyZSIsICRzaWduYXR1cmUsIGZhbHNlKTsK
ICB9CgogIHB1YmxpYyBmdW5jdGlvbiBidWlsZF9zaWduYXR1cmUoJHNpZ25hdHVyZV9tZXRo
b2QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAkc2lnbmF0dXJlID0gJHNpZ25hdHVyZV9t
ZXRob2QtPmJ1aWxkX3NpZ25hdHVyZSgkdGhpcywgJGNvbnN1bWVyLCAkdG9rZW4pOwogICAg
cmV0dXJuICRzaWduYXR1cmU7CiAgfQoKICAvKioKICAgKiB1dGlsIGZ1bmN0aW9uOiBjdXJy
ZW50IHRpbWVzdGFtcAogICAqLwogIHByaXZhdGUgc3RhdGljIGZ1bmN0aW9uIGdlbmVyYXRl
X3RpbWVzdGFtcCgpIHsKICAgIHJldHVybiB0aW1lKCk7CiAgfQoKICAvKioKICAgKiB1dGls
IGZ1bmN0aW9uOiBjdXJyZW50IG5vbmNlCiAgICovCiAgcHJpdmF0ZSBzdGF0aWMgZnVuY3Rp
b24gZ2VuZXJhdGVfbm9uY2UoKSB7CiAgICAkbXQgPSBtaWNyb3RpbWUoKTsKICAgICRyYW5k
ID0gbXRfcmFuZCgpOwoKICAgIHJldHVybiBtZDUoJG10IC4gJHJhbmQpOyAvLyBtZDVzIGxv
b2sgbmljZXIgdGhhbiBudW1iZXJzCiAgfQp9CgpjbGFzcyBPQXV0aFNlcnZlciB7CiAgcHJv
dGVjdGVkICR0aW1lc3RhbXBfdGhyZXNob2xkID0gMzAwOyAvLyBpbiBzZWNvbmRzLCBmaXZl
IG1pbnV0ZXMKICBwcm90ZWN0ZWQgJHZlcnNpb24gPSAnMS4wJzsgICAgICAgICAgICAgLy8g
aGkgYmxhaW5lCiAgcHJvdGVjdGVkICRzaWduYXR1cmVfbWV0aG9kcyA9IGFycmF5KCk7Cgog
IHByb3RlY3RlZCAkZGF0YV9zdG9yZTsKCiAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGRhdGFf
c3RvcmUpIHsKICAgICR0aGlzLT5kYXRhX3N0b3JlID0gJGRhdGFfc3RvcmU7CiAgfQoKICBw
dWJsaWMgZnVuY3Rpb24gYWRkX3NpZ25hdHVyZV9tZXRob2QoJHNpZ25hdHVyZV9tZXRob2Qp
IHsKICAgICR0aGlzLT5zaWduYXR1cmVfbWV0aG9kc1skc2lnbmF0dXJlX21ldGhvZC0+Z2V0
X25hbWUoKV0gPQogICAgICAkc2lnbmF0dXJlX21ldGhvZDsKICB9CgogIC8vIGhpZ2ggbGV2
ZWwgZnVuY3Rpb25zCgogIC8qKgogICAqIHByb2Nlc3MgYSByZXF1ZXN0X3Rva2VuIHJlcXVl
c3QKICAgKiByZXR1cm5zIHRoZSByZXF1ZXN0IHRva2VuIG9uIHN1Y2Nlc3MKICAgKi8KICBw
dWJsaWMgZnVuY3Rpb24gZmV0Y2hfcmVxdWVzdF90b2tlbigmJHJlcXVlc3QpIHsKICAgICR0
aGlzLT5nZXRfdmVyc2lvbigkcmVxdWVzdCk7CgogICAgJGNvbnN1bWVyID0gJHRoaXMtPmdl
dF9jb25zdW1lcigkcmVxdWVzdCk7CgogICAgLy8gbm8gdG9rZW4gcmVxdWlyZWQgZm9yIHRo
ZSBpbml0aWFsIHRva2VuIHJlcXVlc3QKICAgICR0b2tlbiA9IE5VTEw7CgogICAgJHRoaXMt
PmNoZWNrX3NpZ25hdHVyZSgkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW4pOwoKICAgIC8v
IFJldiBBIGNoYW5nZQogICAgJGNhbGxiYWNrID0gJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIo
J29hdXRoX2NhbGxiYWNrJyk7CiAgICAkbmV3X3Rva2VuID0gJHRoaXMtPmRhdGFfc3RvcmUt
Pm5ld19yZXF1ZXN0X3Rva2VuKCRjb25zdW1lciwgJGNhbGxiYWNrKTsKCiAgICByZXR1cm4g
JG5ld190b2tlbjsKICB9CgogIC8qKgogICAqIHByb2Nlc3MgYW4gYWNjZXNzX3Rva2VuIHJl
cXVlc3QKICAgKiByZXR1cm5zIHRoZSBhY2Nlc3MgdG9rZW4gb24gc3VjY2VzcwogICAqLwog
IHB1YmxpYyBmdW5jdGlvbiBmZXRjaF9hY2Nlc3NfdG9rZW4oJiRyZXF1ZXN0KSB7CiAgICAk
dGhpcy0+Z2V0X3ZlcnNpb24oJHJlcXVlc3QpOwoKICAgICRjb25zdW1lciA9ICR0aGlzLT5n
ZXRfY29uc3VtZXIoJHJlcXVlc3QpOwoKICAgIC8vIHJlcXVpcmVzIGF1dGhvcml6ZWQgcmVx
dWVzdCB0b2tlbgogICAgJHRva2VuID0gJHRoaXMtPmdldF90b2tlbigkcmVxdWVzdCwgJGNv
bnN1bWVyLCAicmVxdWVzdCIpOwoKICAgICR0aGlzLT5jaGVja19zaWduYXR1cmUoJHJlcXVl
c3QsICRjb25zdW1lciwgJHRva2VuKTsKCiAgICAvLyBSZXYgQSBjaGFuZ2UKICAgICR2ZXJp
ZmllciA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF92ZXJpZmllcicpOwogICAg
JG5ld190b2tlbiA9ICR0aGlzLT5kYXRhX3N0b3JlLT5uZXdfYWNjZXNzX3Rva2VuKCR0b2tl
biwgJGNvbnN1bWVyLCAkdmVyaWZpZXIpOwoKICAgIHJldHVybiAkbmV3X3Rva2VuOwogIH0K
CiAgLyoqCiAgICogdmVyaWZ5IGFuIGFwaSBjYWxsLCBjaGVja3MgYWxsIHRoZSBwYXJhbWV0
ZXJzCiAgICovCiAgcHVibGljIGZ1bmN0aW9uIHZlcmlmeV9yZXF1ZXN0KCYkcmVxdWVzdCkg
ewogICAgJHRoaXMtPmdldF92ZXJzaW9uKCRyZXF1ZXN0KTsKICAgICRjb25zdW1lciA9ICR0
aGlzLT5nZXRfY29uc3VtZXIoJHJlcXVlc3QpOwogICAgJHRva2VuID0gJHRoaXMtPmdldF90
b2tlbigkcmVxdWVzdCwgJGNvbnN1bWVyLCAiYWNjZXNzIik7CiAgICAkdGhpcy0+Y2hlY2tf
c2lnbmF0dXJlKCRyZXF1ZXN0LCAkY29uc3VtZXIsICR0b2tlbik7CiAgICByZXR1cm4gYXJy
YXkoJGNvbnN1bWVyLCAkdG9rZW4pOwogIH0KCiAgLy8gSW50ZXJuYWxzIGZyb20gaGVyZQog
IC8qKgogICAqIHZlcnNpb24gMQogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X3ZlcnNp
b24oJiRyZXF1ZXN0KSB7CiAgICAkdmVyc2lvbiA9ICRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVy
KCJvYXV0aF92ZXJzaW9uIik7CiAgICBpZiAoISR2ZXJzaW9uKSB7CiAgICAgIC8vIFNlcnZp
Y2UgUHJvdmlkZXJzIE1VU1QgYXNzdW1lIHRoZSBwcm90b2NvbCB2ZXJzaW9uIHRvIGJlIDEu
MCBpZiB0aGlzIHBhcmFtZXRlciBpcyBub3QgcHJlc2VudC4KICAgICAgLy8gQ2hhcHRlciA3
LjAgKCJBY2Nlc3NpbmcgUHJvdGVjdGVkIFJlc3NvdXJjZXMiKQogICAgICAkdmVyc2lvbiA9
ICcxLjAnOwogICAgfQogICAgaWYgKCR2ZXJzaW9uICE9PSAkdGhpcy0+dmVyc2lvbikgewog
ICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIk9BdXRoIHZlcnNpb24gJyR2ZXJzaW9u
JyBub3Qgc3VwcG9ydGVkIik7CiAgICB9CiAgICByZXR1cm4gJHZlcnNpb247CiAgfQoKICAv
KioKICAgKiBmaWd1cmUgb3V0IHRoZSBzaWduYXR1cmUgd2l0aCBzb21lIGRlZmF1bHRzCiAg
ICovCiAgcHJpdmF0ZSBmdW5jdGlvbiBnZXRfc2lnbmF0dXJlX21ldGhvZCgmJHJlcXVlc3Qp
IHsKICAgICRzaWduYXR1cmVfbWV0aG9kID0KICAgICAgICBAJHJlcXVlc3QtPmdldF9wYXJh
bWV0ZXIoIm9hdXRoX3NpZ25hdHVyZV9tZXRob2QiKTsKCiAgICBpZiAoISRzaWduYXR1cmVf
bWV0aG9kKSB7CiAgICAgIC8vIEFjY29yZGluZyB0byBjaGFwdGVyIDcgKCJBY2Nlc3Npbmcg
UHJvdGVjdGVkIFJlc3NvdXJjZXMiKSB0aGUgc2lnbmF0dXJlLW1ldGhvZAogICAgICAvLyBw
YXJhbWV0ZXIgaXMgcmVxdWlyZWQsIGFuZCB3ZSBjYW4ndCBqdXN0IGZhbGxiYWNrIHRvIFBM
QUlOVEVYVAogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oJ05vIHNpZ25hdHVyZSBt
ZXRob2QgcGFyYW1ldGVyLiBUaGlzIHBhcmFtZXRlciBpcyByZXF1aXJlZCcpOwogICAgfQoK
ICAgIGlmICghaW5fYXJyYXkoJHNpZ25hdHVyZV9tZXRob2QsCiAgICAgICAgICAgICAgICAg
IGFycmF5X2tleXMoJHRoaXMtPnNpZ25hdHVyZV9tZXRob2RzKSkpIHsKICAgICAgdGhyb3cg
bmV3IE9BdXRoRXhjZXB0aW9uKAogICAgICAgICJTaWduYXR1cmUgbWV0aG9kICckc2lnbmF0
dXJlX21ldGhvZCcgbm90IHN1cHBvcnRlZCAiIC4KICAgICAgICAidHJ5IG9uZSBvZiB0aGUg
Zm9sbG93aW5nOiAiIC4KICAgICAgICBpbXBsb2RlKCIsICIsIGFycmF5X2tleXMoJHRoaXMt
PnNpZ25hdHVyZV9tZXRob2RzKSkKICAgICAgKTsKICAgIH0KICAgIHJldHVybiAkdGhpcy0+
c2lnbmF0dXJlX21ldGhvZHNbJHNpZ25hdHVyZV9tZXRob2RdOwogIH0KCiAgLyoqCiAgICog
dHJ5IHRvIGZpbmQgdGhlIGNvbnN1bWVyIGZvciB0aGUgcHJvdmlkZWQgcmVxdWVzdCdzIGNv
bnN1bWVyIGtleQogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gZ2V0X2NvbnN1bWVyKCYkcmVx
dWVzdCkgewogICAgJGNvbnN1bWVyX2tleSA9IEAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcigi
b2F1dGhfY29uc3VtZXJfa2V5Iik7CiAgICBpZiAoISRjb25zdW1lcl9rZXkpIHsKICAgICAg
dGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJbnZhbGlkIGNvbnN1bWVyIGtleSIpOwogICAg
fQoKICAgICRjb25zdW1lciA9ICR0aGlzLT5kYXRhX3N0b3JlLT5sb29rdXBfY29uc3VtZXIo
JGNvbnN1bWVyX2tleSk7CiAgICBpZiAoISRjb25zdW1lcikgewogICAgICB0aHJvdyBuZXcg
T0F1dGhFeGNlcHRpb24oIkludmFsaWQgY29uc3VtZXIiKTsKICAgIH0KCiAgICByZXR1cm4g
JGNvbnN1bWVyOwogIH0KCiAgLyoqCiAgICogdHJ5IHRvIGZpbmQgdGhlIHRva2VuIGZvciB0
aGUgcHJvdmlkZWQgcmVxdWVzdCdzIHRva2VuIGtleQogICAqLwogIHByaXZhdGUgZnVuY3Rp
b24gZ2V0X3Rva2VuKCYkcmVxdWVzdCwgJGNvbnN1bWVyLCAkdG9rZW5fdHlwZT0iYWNjZXNz
IikgewogICAgJHRva2VuX2ZpZWxkID0gQCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0
aF90b2tlbicpOwogICAgJHRva2VuID0gJHRoaXMtPmRhdGFfc3RvcmUtPmxvb2t1cF90b2tl
bigKICAgICAgJGNvbnN1bWVyLCAkdG9rZW5fdHlwZSwgJHRva2VuX2ZpZWxkCiAgICApOwog
ICAgaWYgKCEkdG9rZW4pIHsKICAgICAgdGhyb3cgbmV3IE9BdXRoRXhjZXB0aW9uKCJJbnZh
bGlkICR0b2tlbl90eXBlIHRva2VuOiAkdG9rZW5fZmllbGQiKTsKICAgIH0KICAgIHJldHVy
biAkdG9rZW47CiAgfQoKICAvKioKICAgKiBhbGwtaW4tb25lIGZ1bmN0aW9uIHRvIGNoZWNr
IHRoZSBzaWduYXR1cmUgb24gYSByZXF1ZXN0CiAgICogc2hvdWxkIGd1ZXNzIHRoZSBzaWdu
YXR1cmUgbWV0aG9kIGFwcHJvcHJpYXRlbHkKICAgKi8KICBwcml2YXRlIGZ1bmN0aW9uIGNo
ZWNrX3NpZ25hdHVyZSgmJHJlcXVlc3QsICRjb25zdW1lciwgJHRva2VuKSB7CiAgICAvLyB0
aGlzIHNob3VsZCBwcm9iYWJseSBiZSBpbiBhIGRpZmZlcmVudCBtZXRob2QKICAgICR0aW1l
c3RhbXAgPSBAJHJlcXVlc3QtPmdldF9wYXJhbWV0ZXIoJ29hdXRoX3RpbWVzdGFtcCcpOwog
ICAgJG5vbmNlID0gQCRyZXF1ZXN0LT5nZXRfcGFyYW1ldGVyKCdvYXV0aF9ub25jZScpOwoK
ICAgICR0aGlzLT5jaGVja190aW1lc3RhbXAoJHRpbWVzdGFtcCk7CiAgICAkdGhpcy0+Y2hl
Y2tfbm9uY2UoJGNvbnN1bWVyLCAkdG9rZW4sICRub25jZSwgJHRpbWVzdGFtcCk7CgogICAg
JHNpZ25hdHVyZV9tZXRob2QgPSAkdGhpcy0+Z2V0X3NpZ25hdHVyZV9tZXRob2QoJHJlcXVl
c3QpOwoKICAgICRzaWduYXR1cmUgPSAkcmVxdWVzdC0+Z2V0X3BhcmFtZXRlcignb2F1dGhf
c2lnbmF0dXJlJyk7CiAgICAkdmFsaWRfc2lnID0gJHNpZ25hdHVyZV9tZXRob2QtPmNoZWNr
X3NpZ25hdHVyZSgKICAgICAgJHJlcXVlc3QsCiAgICAgICRjb25zdW1lciwKICAgICAgJHRv
a2VuLAogICAgICAkc2lnbmF0dXJlCiAgICApOwoKICAgIGlmICghJHZhbGlkX3NpZykgewog
ICAgICB0aHJvdyBuZXcgT0F1dGhFeGNlcHRpb24oIkludmFsaWQgc2lnbmF0dXJlIik7CiAg
ICB9CiAgfQoKICAvKioKICAgKiBjaGVjayB0aGF0IHRoZSB0aW1lc3RhbXAgaXMgbmV3IGVu
b3VnaAogICAqLwogIHByaXZhdGUgZnVuY3Rpb24gY2hlY2tfdGltZXN0YW1wKCR0aW1lc3Rh
bXApIHsKICAgIGlmKCAhICR0aW1lc3RhbXAgKQogICAgICB0aHJvdyBuZXcgT0F1dGhFeGNl
cHRpb24oCiAgICAgICAgJ01pc3NpbmcgdGltZXN0YW1wIHBhcmFtZXRlci4gVGhlIHBhcmFt
ZXRlciBpcyByZXF1aXJlZCcKICAgICAgKTsKCiAgICAvLyB2ZXJpZnkgdGhhdCB0aW1lc3Rh
bXAgaXMgcmVjZW50aXNoCiAgICAkbm93ID0gdGltZSgpOwogICAgaWYgKGFicygkbm93IC0g
JHRpbWVzdGFtcCkgPiAkdGhpcy0+dGltZXN0YW1wX3RocmVzaG9sZCkgewogICAgICB0aHJv
dyBuZXcgT0F1dGhFeGNlcHRpb24oCiAgICAgICAgIkV4cGlyZWQgdGltZXN0YW1wLCB5b3Vy
cyAkdGltZXN0YW1wLCBvdXJzICRub3ciCiAgICAgICk7CiAgICB9CiAgfQoKICAvKioKICAg
KiBjaGVjayB0aGF0IHRoZSBub25jZSBpcyBub3QgcmVwZWF0ZWQKICAgKi8KICBwcml2YXRl
IGZ1bmN0aW9uIGNoZWNrX25vbmNlKCRjb25zdW1lciwgJHRva2VuLCAkbm9uY2UsICR0aW1l
c3RhbXApIHsKICAgIGlmKCAhICRub25jZSApCiAgICAgIHRocm93IG5ldyBPQXV0aEV4Y2Vw
dGlvbigKICAgICAgICAnTWlzc2luZyBub25jZSBwYXJhbWV0ZXIuIFRoZSBwYXJhbWV0ZXIg
aXMgcmVxdWlyZWQnCiAgICAgICk7CgogICAgLy8gdmVyaWZ5IHRoYXQgdGhlIG5vbmNlIGlz
IHVuaXF1ZWlzaAogICAgJGZvdW5kID0gJHRoaXMtPmRhdGFfc3RvcmUtPmxvb2t1cF9ub25j
ZSgKICAgICAgJGNvbnN1bWVyLAogICAgICAkdG9rZW4sCiAgICAgICRub25jZSwKICAgICAg
JHRpbWVzdGFtcAogICAgKTsKICAgIGlmICgkZm91bmQpIHsKICAgICAgdGhyb3cgbmV3IE9B
dXRoRXhjZXB0aW9uKCJOb25jZSBhbHJlYWR5IHVzZWQ6ICRub25jZSIpOwogICAgfQogIH0K
Cn0KCmNsYXNzIE9BdXRoRGF0YVN0b3JlIHsKICBmdW5jdGlvbiBsb29rdXBfY29uc3VtZXIo
JGNvbnN1bWVyX2tleSkgewogICAgLy8gaW1wbGVtZW50IG1lCiAgfQoKICBmdW5jdGlvbiBs
b29rdXBfdG9rZW4oJGNvbnN1bWVyLCAkdG9rZW5fdHlwZSwgJHRva2VuKSB7CiAgICAvLyBp
bXBsZW1lbnQgbWUKICB9CgogIGZ1bmN0aW9uIGxvb2t1cF9ub25jZSgkY29uc3VtZXIsICR0
b2tlbiwgJG5vbmNlLCAkdGltZXN0YW1wKSB7CiAgICAvLyBpbXBsZW1lbnQgbWUKICB9Cgog
IGZ1bmN0aW9uIG5ld19yZXF1ZXN0X3Rva2VuKCRjb25zdW1lciwgJGNhbGxiYWNrID0gbnVs
bCkgewogICAgLy8gcmV0dXJuIGEgbmV3IHRva2VuIGF0dGFjaGVkIHRvIHRoaXMgY29uc3Vt
ZXIKICB9CgogIGZ1bmN0aW9uIG5ld19hY2Nlc3NfdG9rZW4oJHRva2VuLCAkY29uc3VtZXIs
ICR2ZXJpZmllciA9IG51bGwpIHsKICAgIC8vIHJldHVybiBhIG5ldyBhY2Nlc3MgdG9rZW4g
YXR0YWNoZWQgdG8gdGhpcyBjb25zdW1lcgogICAgLy8gZm9yIHRoZSB1c2VyIGFzc29jaWF0
ZWQgd2l0aCB0aGlzIHRva2VuIGlmIHRoZSByZXF1ZXN0IHRva2VuCiAgICAvLyBpcyBhdXRo
b3JpemVkCiAgICAvLyBzaG91bGQgYWxzbyBpbnZhbGlkYXRlIHRoZSByZXF1ZXN0IHRva2Vu
CiAgfQoKfQoKY2xhc3MgT0F1dGhVdGlsIHsKICBwdWJsaWMgc3RhdGljIGZ1bmN0aW9uIHVy
bGVuY29kZV9yZmMzOTg2KCRpbnB1dCkgewogIGlmIChpc19hcnJheSgkaW5wdXQpKSB7CiAg
ICByZXR1cm4gYXJyYXlfbWFwKGFycmF5KCdPQXV0aFV0aWwnLCAndXJsZW5jb2RlX3JmYzM5
ODYnKSwgJGlucHV0KTsKICB9IGVsc2UgaWYgKGlzX3NjYWxhcigkaW5wdXQpKSB7CiAgICBy
ZXR1cm4gc3RyX3JlcGxhY2UoCiAgICAgICcrJywKICAgICAgJyAnLAogICAgICBzdHJfcmVw
bGFjZSgnJTdFJywgJ34nLCByYXd1cmxlbmNvZGUoJGlucHV0KSkKICAgICk7CiAgfSBlbHNl
IHsKICAgIHJldHVybiAnJzsKICB9Cn0KCgogIC8vIFRoaXMgZGVjb2RlIGZ1bmN0aW9uIGlz
bid0IHRha2luZyBpbnRvIGNvbnNpZGVyYXRpb24gdGhlIGFib3ZlCiAgLy8gbW9kaWZpY2F0
aW9ucyB0byB0aGUgZW5jb2RpbmcgcHJvY2Vzcy4gSG93ZXZlciwgdGhpcyBtZXRob2QgZG9l
c24ndAogIC8vIHNlZW0gdG8gYmUgdXNlZCBhbnl3aGVyZSBzbyBsZWF2aW5nIGl0IGFzIGlz
LgogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gdXJsZGVjb2RlX3JmYzM5ODYoJHN0cmluZykg
ewogICAgcmV0dXJuIHVybGRlY29kZSgkc3RyaW5nKTsKICB9CgogIC8vIFV0aWxpdHkgZnVu
Y3Rpb24gZm9yIHR1cm5pbmcgdGhlIEF1dGhvcml6YXRpb246IGhlYWRlciBpbnRvCiAgLy8g
cGFyYW1ldGVycywgaGFzIHRvIGRvIHNvbWUgdW5lc2NhcGluZwogIC8vIENhbiBmaWx0ZXIg
b3V0IGFueSBub24tb2F1dGggcGFyYW1ldGVycyBpZiBuZWVkZWQgKGRlZmF1bHQgYmVoYXZp
b3VyKQogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gc3BsaXRfaGVhZGVyKCRoZWFkZXIsICRv
bmx5X2FsbG93X29hdXRoX3BhcmFtZXRlcnMgPSB0cnVlKSB7CiAgICAkcGF0dGVybiA9ICcv
KChbLV9hLXpdKik9KCIoW14iXSopInwoW14sXSopKSw/KS8nOwogICAgJG9mZnNldCA9IDA7
CiAgICAkcGFyYW1zID0gYXJyYXkoKTsKICAgIHdoaWxlIChwcmVnX21hdGNoKCRwYXR0ZXJu
LCAkaGVhZGVyLCAkbWF0Y2hlcywgUFJFR19PRkZTRVRfQ0FQVFVSRSwgJG9mZnNldCkgPiAw
KSB7CiAgICAgICRtYXRjaCA9ICRtYXRjaGVzWzBdOwogICAgICAkaGVhZGVyX25hbWUgPSAk
bWF0Y2hlc1syXVswXTsKICAgICAgJGhlYWRlcl9jb250ZW50ID0gKGlzc2V0KCRtYXRjaGVz
WzVdKSkgPyAkbWF0Y2hlc1s1XVswXSA6ICRtYXRjaGVzWzRdWzBdOwogICAgICBpZiAocHJl
Z19tYXRjaCgnL15vYXV0aF8vJywgJGhlYWRlcl9uYW1lKSB8fCAhJG9ubHlfYWxsb3dfb2F1
dGhfcGFyYW1ldGVycykgewogICAgICAgICRwYXJhbXNbJGhlYWRlcl9uYW1lXSA9IE9BdXRo
VXRpbDo6dXJsZGVjb2RlX3JmYzM5ODYoJGhlYWRlcl9jb250ZW50KTsKICAgICAgfQogICAg
ICAkb2Zmc2V0ID0gJG1hdGNoWzFdICsgc3RybGVuKCRtYXRjaFswXSk7CiAgICB9CgogICAg
aWYgKGlzc2V0KCRwYXJhbXNbJ3JlYWxtJ10pKSB7CiAgICAgIHVuc2V0KCRwYXJhbXNbJ3Jl
YWxtJ10pOwogICAgfQoKICAgIHJldHVybiAkcGFyYW1zOwogIH0KCiAgLy8gaGVscGVyIHRv
IHRyeSB0byBzb3J0IG91dCBoZWFkZXJzIGZvciBwZW9wbGUgd2hvIGFyZW4ndCBydW5uaW5n
IGFwYWNoZQogIHB1YmxpYyBzdGF0aWMgZnVuY3Rpb24gZ2V0X2hlYWRlcnMoKSB7CiAgICBp
ZiAoZnVuY3Rpb25fZXhpc3RzKCdhcGFjaGVfcmVxdWVzdF9oZWFkZXJzJykpIHsKICAgICAg
Ly8gd2UgbmVlZCB0aGlzIHRvIGdldCB0aGUgYWN0dWFsIEF1dGhvcml6YXRpb246IGhlYWRl
cgogICAgICAvLyBiZWNhdXNlIGFwYWNoZSB0ZW5kcyB0byB0ZWxsIHVzIGl0IGRvZXNuJ3Qg
ZXhpc3QKICAgICAgJGhlYWRlcnMgPSBhcGFjaGVfcmVxdWVzdF9oZWFkZXJzKCk7CgogICAg
ICAvLyBzYW5pdGl6ZSB0aGUgb3V0cHV0IG9mIGFwYWNoZV9yZXF1ZXN0X2hlYWRlcnMgYmVj
YXVzZQogICAgICAvLyB3ZSBhbHdheXMgd2FudCB0aGUga2V5cyB0byBiZSBDYXNlZC1MaWtl
LVRoaXMgYW5kIGFyaCgpCiAgICAgIC8vIHJldHVybnMgdGhlIGhlYWRlcnMgaW4gdGhlIHNh
bWUgY2FzZSBhcyB0aGV5IGFyZSBpbiB0aGUKICAgICAgLy8gcmVxdWVzdAogICAgICAkb3V0
ID0gYXJyYXkoKTsKICAgICAgZm9yZWFjaCggJGhlYWRlcnMgQVMgJGtleSA9PiAkdmFsdWUg
KSB7CiAgICAgICAgJGtleSA9IHN0cl9yZXBsYWNlKAogICAgICAgICAgICAiICIsCiAgICAg
ICAgICAgICItIiwKICAgICAgICAgICAgdWN3b3JkcyhzdHJ0b2xvd2VyKHN0cl9yZXBsYWNl
KCItIiwgIiAiLCAka2V5KSkpCiAgICAgICAgICApOwogICAgICAgICRvdXRbJGtleV0gPSAk
dmFsdWU7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIC8vIG90aGVyd2lzZSB3ZSBkb24n
dCBoYXZlIGFwYWNoZSBhbmQgYXJlIGp1c3QgZ29pbmcgdG8gaGF2ZSB0byBob3BlCiAgICAg
IC8vIHRoYXQgJF9TRVJWRVIgYWN0dWFsbHkgY29udGFpbnMgd2hhdCB3ZSBuZWVkCiAgICAg
ICRvdXQgPSBhcnJheSgpOwogICAgICBpZiggaXNzZXQoJF9TRVJWRVJbJ0NPTlRFTlRfVFlQ
RSddKSApCiAgICAgICAgJG91dFsnQ29udGVudC1UeXBlJ10gPSAkX1NFUlZFUlsnQ09OVEVO
VF9UWVBFJ107CiAgICAgIGlmKCBpc3NldCgkX0VOVlsnQ09OVEVOVF9UWVBFJ10pICkKICAg
ICAgICAkb3V0WydDb250ZW50LVR5cGUnXSA9ICRfRU5WWydDT05URU5UX1RZUEUnXTsKCiAg
ICAgIGZvcmVhY2ggKCRfU0VSVkVSIGFzICRrZXkgPT4gJHZhbHVlKSB7CiAgICAgICAgaWYg
KHN1YnN0cigka2V5LCAwLCA1KSA9PSAiSFRUUF8iKSB7CiAgICAgICAgICAvLyB0aGlzIGlz
IGNoYW9zLCBiYXNpY2FsbHkgaXQgaXMganVzdCB0aGVyZSB0byBjYXBpdGFsaXplIHRoZSBm
aXJzdAogICAgICAgICAgLy8gbGV0dGVyIG9mIGV2ZXJ5IHdvcmQgdGhhdCBpcyBub3QgYW4g
aW5pdGlhbCBIVFRQIGFuZCBzdHJpcCBIVFRQCiAgICAgICAgICAvLyBjb2RlIGZyb20gcHJ6
ZW1lawogICAgICAgICAgJGtleSA9IHN0cl9yZXBsYWNlKAogICAgICAgICAgICAiICIsCiAg
ICAgICAgICAgICItIiwKICAgICAgICAgICAgdWN3b3JkcyhzdHJ0b2xvd2VyKHN0cl9yZXBs
YWNlKCJfIiwgIiAiLCBzdWJzdHIoJGtleSwgNSkpKSkKICAgICAgICAgICk7CiAgICAgICAg
ICAkb3V0WyRrZXldID0gJHZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0
dXJuICRvdXQ7CiAgfQoKICAvLyBUaGlzIGZ1bmN0aW9uIHRha2VzIGEgaW5wdXQgbGlrZSBh
PWImYT1jJmQ9ZSBhbmQgcmV0dXJucyB0aGUgcGFyc2VkCiAgLy8gcGFyYW1ldGVycyBsaWtl
IHRoaXMKICAvLyBhcnJheSgnYScgPT4gYXJyYXkoJ2InLCdjJyksICdkJyA9PiAnZScpCiAg
cHVibGljIHN0YXRpYyBmdW5jdGlvbiBwYXJzZV9wYXJhbWV0ZXJzKCAkaW5wdXQgKSB7CiAg
ICBpZiAoIWlzc2V0KCRpbnB1dCkgfHwgISRpbnB1dCkgcmV0dXJuIGFycmF5KCk7CgogICAg
JHBhaXJzID0gZXhwbG9kZSgnJicsICRpbnB1dCk7CgogICAgJHBhcnNlZF9wYXJhbWV0ZXJz
ID0gYXJyYXkoKTsKICAgIGZvcmVhY2ggKCRwYWlycyBhcyAkcGFpcikgewogICAgICAkc3Bs
aXQgPSBleHBsb2RlKCc9JywgJHBhaXIsIDIpOwogICAgICAkcGFyYW1ldGVyID0gT0F1dGhV
dGlsOjp1cmxkZWNvZGVfcmZjMzk4Nigkc3BsaXRbMF0pOwogICAgICAkdmFsdWUgPSBpc3Nl
dCgkc3BsaXRbMV0pID8gT0F1dGhVdGlsOjp1cmxkZWNvZGVfcmZjMzk4Nigkc3BsaXRbMV0p
IDogJyc7CgogICAgICBpZiAoaXNzZXQoJHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJd
KSkgewogICAgICAgIC8vIFdlIGhhdmUgYWxyZWFkeSByZWNpZXZlZCBwYXJhbWV0ZXIocykg
d2l0aCB0aGlzIG5hbWUsIHNvIGFkZCB0byB0aGUgbGlzdAogICAgICAgIC8vIG9mIHBhcmFt
ZXRlcnMgd2l0aCB0aGlzIG5hbWUKCiAgICAgICAgaWYgKGlzX3NjYWxhcigkcGFyc2VkX3Bh
cmFtZXRlcnNbJHBhcmFtZXRlcl0pKSB7CiAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBmaXJz
dCBkdXBsaWNhdGUsIHNvIHRyYW5zZm9ybSBzY2FsYXIgKHN0cmluZykgaW50byBhbiBhcnJh
eQogICAgICAgICAgLy8gc28gd2UgY2FuIGFkZCB0aGUgZHVwbGljYXRlcwogICAgICAgICAg
JHBhcnNlZF9wYXJhbWV0ZXJzWyRwYXJhbWV0ZXJdID0gYXJyYXkoJHBhcnNlZF9wYXJhbWV0
ZXJzWyRwYXJhbWV0ZXJdKTsKICAgICAgICB9CgogICAgICAgICRwYXJzZWRfcGFyYW1ldGVy
c1skcGFyYW1ldGVyXVtdID0gJHZhbHVlOwogICAgICB9IGVsc2UgewogICAgICAgICRwYXJz
ZWRfcGFyYW1ldGVyc1skcGFyYW1ldGVyXSA9ICR2YWx1ZTsKICAgICAgfQogICAgfQogICAg
cmV0dXJuICRwYXJzZWRfcGFyYW1ldGVyczsKICB9CgogIHB1YmxpYyBzdGF0aWMgZnVuY3Rp
b24gYnVpbGRfaHR0cF9xdWVyeSgkcGFyYW1zKSB7CiAgICBpZiAoISRwYXJhbXMpIHJldHVy
biAnJzsKCiAgICAvLyBVcmxlbmNvZGUgYm90aCBrZXlzIGFuZCB2YWx1ZXMKICAgICRrZXlz
ID0gT0F1dGhVdGlsOjp1cmxlbmNvZGVfcmZjMzk4NihhcnJheV9rZXlzKCRwYXJhbXMpKTsK
ICAgICR2YWx1ZXMgPSBPQXV0aFV0aWw6OnVybGVuY29kZV9yZmMzOTg2KGFycmF5X3ZhbHVl
cygkcGFyYW1zKSk7CiAgICAkcGFyYW1zID0gYXJyYXlfY29tYmluZSgka2V5cywgJHZhbHVl
cyk7CgogICAgLy8gUGFyYW1ldGVycyBhcmUgc29ydGVkIGJ5IG5hbWUsIHVzaW5nIGxleGlj
b2dyYXBoaWNhbCBieXRlIHZhbHVlIG9yZGVyaW5nLgogICAgLy8gUmVmOiBTcGVjOiA5LjEu
MSAoMSkKICAgIHVrc29ydCgkcGFyYW1zLCAnc3RyY21wJyk7CgogICAgJHBhaXJzID0gYXJy
YXkoKTsKICAgIGZvcmVhY2ggKCRwYXJhbXMgYXMgJHBhcmFtZXRlciA9PiAkdmFsdWUpIHsK
ICAgICAgaWYgKGlzX2FycmF5KCR2YWx1ZSkpIHsKICAgICAgICAvLyBJZiB0d28gb3IgbW9y
ZSBwYXJhbWV0ZXJzIHNoYXJlIHRoZSBzYW1lIG5hbWUsIHRoZXkgYXJlIHNvcnRlZCBieSB0
aGVpciB2YWx1ZQogICAgICAgIC8vIFJlZjogU3BlYzogOS4xLjEgKDEpCiAgICAgICAgbmF0
c29ydCgkdmFsdWUpOwogICAgICAgIGZvcmVhY2ggKCR2YWx1ZSBhcyAkZHVwbGljYXRlX3Zh
bHVlKSB7CiAgICAgICAgICAkcGFpcnNbXSA9ICRwYXJhbWV0ZXIgLiAnPScgLiAkZHVwbGlj
YXRlX3ZhbHVlOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAkcGFpcnNbXSA9
ICRwYXJhbWV0ZXIgLiAnPScgLiAkdmFsdWU7CiAgICAgIH0KICAgIH0KICAgIC8vIEZvciBl
YWNoIHBhcmFtZXRlciwgdGhlIG5hbWUgaXMgc2VwYXJhdGVkIGZyb20gdGhlIGNvcnJlc3Bv
bmRpbmcgdmFsdWUgYnkgYW4gJz0nIGNoYXJhY3RlciAoQVNDSUkgY29kZSA2MSkKICAgIC8v
IEVhY2ggbmFtZS12YWx1ZSBwYWlyIGlzIHNlcGFyYXRlZCBieSBhbiAnJicgY2hhcmFjdGVy
IChBU0NJSSBjb2RlIDM4KQogICAgcmV0dXJuIGltcGxvZGUoJyYnLCAkcGFpcnMpOwogIH0K
fSI7czozOiJtZDUiO3M6MzI6IjliNGJjODQzZDVlYzE5YjZmZDQ2ZTY3MDcwM2E0MjAxIjt9
